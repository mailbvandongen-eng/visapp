const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-B8K4w06l.js","assets/GeoJSON-BK8ovLVC.js","assets/iconStyles-B3IiBRE2.js","assets/boothellingenOL-DHiXYbkx.js","assets/viswaterOL-DFX3eKoM.js","assets/hillshadeLayers-DeU3260L.js","assets/common-DpNHzTjJ.js","assets/pdokWaterOL-DXphsWxD.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Dv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Q0={exports:{}},Ah={},J0={exports:{}},He={};var iS;function rL(){if(iS)return He;iS=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function _(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,I={};function w(W,G,re){this.props=W,this.context=G,this.refs=I,this.updater=re||v}w.prototype.isReactComponent={},w.prototype.setState=function(W,G){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,G,"setState")},w.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function R(){}R.prototype=w.prototype;function M(W,G,re){this.props=W,this.context=G,this.refs=I,this.updater=re||v}var D=M.prototype=new R;D.constructor=M,S(D,w.prototype),D.isPureReactComponent=!0;var L=Array.isArray,N=Object.prototype.hasOwnProperty,V={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function b(W,G,re){var ge,_e={},Ce=null,Ne=null;if(G!=null)for(ge in G.ref!==void 0&&(Ne=G.ref),G.key!==void 0&&(Ce=""+G.key),G)N.call(G,ge)&&!A.hasOwnProperty(ge)&&(_e[ge]=G[ge]);var be=arguments.length-2;if(be===1)_e.children=re;else if(1<be){for(var Le=Array(be),Ge=0;Ge<be;Ge++)Le[Ge]=arguments[Ge+2];_e.children=Le}if(W&&W.defaultProps)for(ge in be=W.defaultProps,be)_e[ge]===void 0&&(_e[ge]=be[ge]);return{$$typeof:n,type:W,key:Ce,ref:Ne,props:_e,_owner:V.current}}function P(W,G){return{$$typeof:n,type:W.type,key:G,ref:W.ref,props:W.props,_owner:W._owner}}function j(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function z(W){var G={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(re){return G[re]})}var B=/\/+/g;function O(W,G){return typeof W=="object"&&W!==null&&W.key!=null?z(""+W.key):G.toString(36)}function se(W,G,re,ge,_e){var Ce=typeof W;(Ce==="undefined"||Ce==="boolean")&&(W=null);var Ne=!1;if(W===null)Ne=!0;else switch(Ce){case"string":case"number":Ne=!0;break;case"object":switch(W.$$typeof){case n:case e:Ne=!0}}if(Ne)return Ne=W,_e=_e(Ne),W=ge===""?"."+O(Ne,0):ge,L(_e)?(re="",W!=null&&(re=W.replace(B,"$&/")+"/"),se(_e,G,re,"",function(Ge){return Ge})):_e!=null&&(j(_e)&&(_e=P(_e,re+(!_e.key||Ne&&Ne.key===_e.key?"":(""+_e.key).replace(B,"$&/")+"/")+W)),G.push(_e)),1;if(Ne=0,ge=ge===""?".":ge+":",L(W))for(var be=0;be<W.length;be++){Ce=W[be];var Le=ge+O(Ce,be);Ne+=se(Ce,G,re,Le,_e)}else if(Le=_(W),typeof Le=="function")for(W=Le.call(W),be=0;!(Ce=W.next()).done;)Ce=Ce.value,Le=ge+O(Ce,be++),Ne+=se(Ce,G,re,Le,_e);else if(Ce==="object")throw G=String(W),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.");return Ne}function me(W,G,re){if(W==null)return W;var ge=[],_e=0;return se(W,ge,"","",function(Ce){return G.call(re,Ce,_e++)}),ge}function pe(W){if(W._status===-1){var G=W._result;G=G(),G.then(function(re){(W._status===0||W._status===-1)&&(W._status=1,W._result=re)},function(re){(W._status===0||W._status===-1)&&(W._status=2,W._result=re)}),W._status===-1&&(W._status=0,W._result=G)}if(W._status===1)return W._result.default;throw W._result}var ue={current:null},H={transition:null},X={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:H,ReactCurrentOwner:V};function ne(){throw Error("act(...) is not supported in production builds of React.")}return He.Children={map:me,forEach:function(W,G,re){me(W,function(){G.apply(this,arguments)},re)},count:function(W){var G=0;return me(W,function(){G++}),G},toArray:function(W){return me(W,function(G){return G})||[]},only:function(W){if(!j(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},He.Component=w,He.Fragment=t,He.Profiler=r,He.PureComponent=M,He.StrictMode=i,He.Suspense=u,He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,He.act=ne,He.cloneElement=function(W,G,re){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var ge=S({},W.props),_e=W.key,Ce=W.ref,Ne=W._owner;if(G!=null){if(G.ref!==void 0&&(Ce=G.ref,Ne=V.current),G.key!==void 0&&(_e=""+G.key),W.type&&W.type.defaultProps)var be=W.type.defaultProps;for(Le in G)N.call(G,Le)&&!A.hasOwnProperty(Le)&&(ge[Le]=G[Le]===void 0&&be!==void 0?be[Le]:G[Le])}var Le=arguments.length-2;if(Le===1)ge.children=re;else if(1<Le){be=Array(Le);for(var Ge=0;Ge<Le;Ge++)be[Ge]=arguments[Ge+2];ge.children=be}return{$$typeof:n,type:W.type,key:_e,ref:Ce,props:ge,_owner:Ne}},He.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},He.createElement=b,He.createFactory=function(W){var G=b.bind(null,W);return G.type=W,G},He.createRef=function(){return{current:null}},He.forwardRef=function(W){return{$$typeof:l,render:W}},He.isValidElement=j,He.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:pe}},He.memo=function(W,G){return{$$typeof:h,type:W,compare:G===void 0?null:G}},He.startTransition=function(W){var G=H.transition;H.transition={};try{W()}finally{H.transition=G}},He.unstable_act=ne,He.useCallback=function(W,G){return ue.current.useCallback(W,G)},He.useContext=function(W){return ue.current.useContext(W)},He.useDebugValue=function(){},He.useDeferredValue=function(W){return ue.current.useDeferredValue(W)},He.useEffect=function(W,G){return ue.current.useEffect(W,G)},He.useId=function(){return ue.current.useId()},He.useImperativeHandle=function(W,G,re){return ue.current.useImperativeHandle(W,G,re)},He.useInsertionEffect=function(W,G){return ue.current.useInsertionEffect(W,G)},He.useLayoutEffect=function(W,G){return ue.current.useLayoutEffect(W,G)},He.useMemo=function(W,G){return ue.current.useMemo(W,G)},He.useReducer=function(W,G,re){return ue.current.useReducer(W,G,re)},He.useRef=function(W){return ue.current.useRef(W)},He.useState=function(W){return ue.current.useState(W)},He.useSyncExternalStore=function(W,G,re){return ue.current.useSyncExternalStore(W,G,re)},He.useTransition=function(){return ue.current.useTransition()},He.version="18.3.1",He}var rS;function rf(){return rS||(rS=1,J0.exports=rL()),J0.exports}var sS;function sL(){if(sS)return Ah;sS=1;var n=rf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},_=null,v=null;h!==void 0&&(_=""+h),u.key!==void 0&&(_=""+u.key),u.ref!==void 0&&(v=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:_,ref:v,props:p,_owner:r.current}}return Ah.Fragment=t,Ah.jsx=o,Ah.jsxs=o,Ah}var oS;function oL(){return oS||(oS=1,Q0.exports=sL()),Q0.exports}var g=oL(),Fg={},e_={exports:{}},ri={},t_={exports:{}},n_={};var aS;function aL(){return aS||(aS=1,(function(n){function e(H,X){var ne=H.length;H.push(X);e:for(;0<ne;){var W=ne-1>>>1,G=H[W];if(0<r(G,X))H[W]=X,H[ne]=G,ne=W;else break e}}function t(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var X=H[0],ne=H.pop();if(ne!==X){H[0]=ne;e:for(var W=0,G=H.length,re=G>>>1;W<re;){var ge=2*(W+1)-1,_e=H[ge],Ce=ge+1,Ne=H[Ce];if(0>r(_e,ne))Ce<G&&0>r(Ne,_e)?(H[W]=Ne,H[Ce]=ne,W=Ce):(H[W]=_e,H[ge]=ne,W=ge);else if(Ce<G&&0>r(Ne,ne))H[W]=Ne,H[Ce]=ne,W=Ce;else break e}}return X}function r(H,X){var ne=H.sortIndex-X.sortIndex;return ne!==0?ne:H.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,_=3,v=!1,S=!1,I=!1,w=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(H){for(var X=t(h);X!==null;){if(X.callback===null)i(h);else if(X.startTime<=H)i(h),X.sortIndex=X.expirationTime,e(u,X);else break;X=t(h)}}function L(H){if(I=!1,D(H),!S)if(t(u)!==null)S=!0,pe(N);else{var X=t(h);X!==null&&ue(L,X.startTime-H)}}function N(H,X){S=!1,I&&(I=!1,R(b),b=-1),v=!0;var ne=_;try{for(D(X),p=t(u);p!==null&&(!(p.expirationTime>X)||H&&!z());){var W=p.callback;if(typeof W=="function"){p.callback=null,_=p.priorityLevel;var G=W(p.expirationTime<=X);X=n.unstable_now(),typeof G=="function"?p.callback=G:p===t(u)&&i(u),D(X)}else i(u);p=t(u)}if(p!==null)var re=!0;else{var ge=t(h);ge!==null&&ue(L,ge.startTime-X),re=!1}return re}finally{p=null,_=ne,v=!1}}var V=!1,A=null,b=-1,P=5,j=-1;function z(){return!(n.unstable_now()-j<P)}function B(){if(A!==null){var H=n.unstable_now();j=H;var X=!0;try{X=A(!0,H)}finally{X?O():(V=!1,A=null)}}else V=!1}var O;if(typeof M=="function")O=function(){M(B)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,me=se.port2;se.port1.onmessage=B,O=function(){me.postMessage(null)}}else O=function(){w(B,0)};function pe(H){A=H,V||(V=!0,O())}function ue(H,X){b=w(function(){H(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_continueExecution=function(){S||v||(S=!0,pe(N))},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(H){switch(_){case 1:case 2:case 3:var X=3;break;default:X=_}var ne=_;_=X;try{return H()}finally{_=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(H,X){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ne=_;_=H;try{return X()}finally{_=ne}},n.unstable_scheduleCallback=function(H,X,ne){var W=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,H){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=ne+G,H={id:f++,callback:X,priorityLevel:H,startTime:ne,expirationTime:G,sortIndex:-1},ne>W?(H.sortIndex=ne,e(h,H),t(u)===null&&H===t(h)&&(I?(R(b),b=-1):I=!0,ue(L,ne-W))):(H.sortIndex=G,e(u,H),S||v||(S=!0,pe(N))),H},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(H){var X=_;return function(){var ne=_;_=X;try{return H.apply(this,arguments)}finally{_=ne}}}})(n_)),n_}var lS;function lL(){return lS||(lS=1,t_.exports=aL()),t_.exports}var cS;function cL(){if(cS)return ri;cS=1;var n=rf(),e=lL();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function _(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function v(a,c,d,y){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,c,d,y){if(c===null||typeof c>"u"||v(a,c,d,y))return!0;if(y)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,y,x,E,k){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=x,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=E,this.removeEmptyString=k}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){w[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];w[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){w[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){w[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){w[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){w[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){w[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){w[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){w[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function M(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(R,M);w[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(R,M);w[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(R,M);w[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){w[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),w.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){w[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function D(a,c,d,y){var x=w.hasOwnProperty(c)?w[c]:null;(x!==null?x.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,d,x,y)&&(d=null),y||x===null?_(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):x.mustUseProperty?a[x.propertyName]=d===null?x.type===3?!1:"":d:(c=x.attributeName,y=x.attributeNamespace,d===null?a.removeAttribute(c):(x=x.type,d=x===3||x===4&&d===!0?"":""+d,y?a.setAttributeNS(y,c,d):a.setAttribute(c,d))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),V=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),z=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),H=Symbol.iterator;function X(a){return a===null||typeof a!="object"?null:(a=H&&a[H]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,W;function G(a){if(W===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var re=!1;function ge(a,c){if(!a||re)return"";re=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ee){var y=ee}Reflect.construct(a,[],c)}else{try{c.call()}catch(ee){y=ee}a.call(c.prototype)}else{try{throw Error()}catch(ee){y=ee}a()}}catch(ee){if(ee&&y&&typeof ee.stack=="string"){for(var x=ee.stack.split(`
`),E=y.stack.split(`
`),k=x.length-1,U=E.length-1;1<=k&&0<=U&&x[k]!==E[U];)U--;for(;1<=k&&0<=U;k--,U--)if(x[k]!==E[U]){if(k!==1||U!==1)do if(k--,U--,0>U||x[k]!==E[U]){var $=`
`+x[k].replace(" at new "," at ");return a.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",a.displayName)),$}while(1<=k&&0<=U);break}}}finally{re=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?G(a):""}function _e(a){switch(a.tag){case 5:return G(a.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return a=ge(a.type,!1),a;case 11:return a=ge(a.type.render,!1),a;case 1:return a=ge(a.type,!0),a;default:return""}}function Ce(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case A:return"Fragment";case V:return"Portal";case P:return"Profiler";case b:return"StrictMode";case O:return"Suspense";case se:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case z:return(a.displayName||"Context")+".Consumer";case j:return(a._context.displayName||"Context")+".Provider";case B:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case me:return c=a.displayName||null,c!==null?c:Ce(a.type)||"Memo";case pe:c=a._payload,a=a._init;try{return Ce(a(c))}catch{}}return null}function Ne(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ce(c);case 8:return c===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function be(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Le(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Ge(a){var c=Le(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),y=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,E=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return x.call(this)},set:function(k){y=""+k,E.call(this,k)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return y},setValue:function(k){y=""+k},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Wt(a){a._valueTracker||(a._valueTracker=Ge(a))}function Wn(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),y="";return a&&(y=Le(a)?a.checked?"true":"false":a.value),a=y,a!==d?(c.setValue(a),!0):!1}function Zt(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Pn(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function gn(a,c){var d=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;d=be(c.value!=null?c.value:d),a._wrapperState={initialChecked:y,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function mn(a,c){c=c.checked,c!=null&&D(a,"checked",c,!1)}function Qn(a,c){mn(a,c);var d=be(c.value),y=c.type;if(d!=null)y==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(y==="submit"||y==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?_t(a,c.type,d):c.hasOwnProperty("defaultValue")&&_t(a,c.type,be(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Ni(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function _t(a,c,d){(c!=="number"||Zt(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ut=Array.isArray;function on(a,c,d,y){if(a=a.options,c){c={};for(var x=0;x<d.length;x++)c["$"+d[x]]=!0;for(d=0;d<a.length;d++)x=c.hasOwnProperty("$"+a[d].value),a[d].selected!==x&&(a[d].selected=x),x&&y&&(a[d].defaultSelected=!0)}else{for(d=""+be(d),c=null,x=0;x<a.length;x++){if(a[x].value===d){a[x].selected=!0,y&&(a[x].defaultSelected=!0);return}c!==null||a[x].disabled||(c=a[x])}c!==null&&(c.selected=!0)}}function Di(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ut(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:be(d)}}function io(a,c){var d=be(c.value),y=be(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),y!=null&&(a.defaultValue=""+y)}function Mi(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function kr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?kr(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Nr,ha=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,y,x){MSApp.execUnsafeLocalFunction(function(){return a(c,d,y,x)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Nr=Nr||document.createElement("div"),Nr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Nr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Dr(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Li={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vl=["Webkit","ms","Moz","O"];Object.keys(Li).forEach(function(a){Vl.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Li[c]=Li[a]})});function Mr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Li.hasOwnProperty(a)&&Li[a]?(""+c).trim():c+"px"}function ys(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var y=d.indexOf("--")===0,x=Mr(d,c[d],y);d==="float"&&(d="cssFloat"),y?a.setProperty(d,x):a[d]=x}}var ro=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gn(a,c){if(c){if(ro[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function _s(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lr=null;function Or(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var $n=null,Hn=null,gt=null;function so(a){if(a=gh(a)){if(typeof $n!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Jf(c),$n(a.stateNode,a.type,c))}}function sr(a){Hn?gt?gt.push(a):gt=[a]:Hn=a}function jt(){if(Hn){var a=Hn,c=gt;if(gt=Hn=null,so(a),c)for(a=0;a<c.length;a++)so(c[a])}}function Oi(a,c){return a(c)}function pn(){}var Ft=!1;function yn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return Oi(a,c,d)}finally{Ft=!1,(Hn!==null||gt!==null)&&(pn(),jt())}}function _n(a,c){var d=a.stateNode;if(d===null)return null;var y=Jf(d);if(y===null)return null;d=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var an=!1;if(l)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){an=!0}}),window.addEventListener("test",ot,ot),window.removeEventListener("test",ot,ot)}catch{an=!1}function Gt(a,c,d,y,x,E,k,U,$){var ee=Array.prototype.slice.call(arguments,3);try{c.apply(d,ee)}catch(ae){this.onError(ae)}}var Qt=!1,ji=null,zl=!1,Fi=null,kf={onError:function(a){Qt=!0,ji=a}};function Nf(a,c,d,y,x,E,k,U,$){Qt=!1,ji=null,Gt.apply(kf,arguments)}function Bu(a,c,d,y,x,E,k,U,$){if(Nf.apply(this,arguments),Qt){if(Qt){var ee=ji;Qt=!1,ji=null}else throw Error(t(198));zl||(zl=!0,Fi=ee)}}function or(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Wu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function Df(a){if(or(a)!==a)throw Error(t(188))}function Mf(a){var c=a.alternate;if(!c){if(c=or(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,y=c;;){var x=d.return;if(x===null)break;var E=x.alternate;if(E===null){if(y=x.return,y!==null){d=y;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===d)return Df(x),a;if(E===y)return Df(x),c;E=E.sibling}throw Error(t(188))}if(d.return!==y.return)d=x,y=E;else{for(var k=!1,U=x.child;U;){if(U===d){k=!0,d=x,y=E;break}if(U===y){k=!0,y=x,d=E;break}U=U.sibling}if(!k){for(U=E.child;U;){if(U===d){k=!0,d=E,y=x;break}if(U===y){k=!0,y=E,d=x;break}U=U.sibling}if(!k)throw Error(t(189))}}if(d.alternate!==y)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Lf(a){return a=Mf(a),a!==null?da(a):null}function da(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=da(a);if(c!==null)return c;a=a.sibling}return null}var Gu=e.unstable_scheduleCallback,Ul=e.unstable_cancelCallback,fa=e.unstable_shouldYield,xs=e.unstable_requestPaint,vt=e.unstable_now,Ay=e.unstable_getCurrentPriorityLevel,Bl=e.unstable_ImmediatePriority,$u=e.unstable_UserBlockingPriority,ga=e.unstable_NormalPriority,Hu=e.unstable_LowPriority,Wl=e.unstable_IdlePriority,ma=null,mi=null;function Of(a){if(mi&&typeof mi.onCommitFiberRoot=="function")try{mi.onCommitFiberRoot(ma,a,void 0,(a.current.flags&128)===128)}catch{}}var pi=Math.clz32?Math.clz32:pa,jr=Math.log,Vi=Math.LN2;function pa(a){return a>>>=0,a===0?32:31-(jr(a)/Vi|0)|0}var Fr=64,oo=4194304;function at(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function vs(a,c){var d=a.pendingLanes;if(d===0)return 0;var y=0,x=a.suspendedLanes,E=a.pingedLanes,k=d&268435455;if(k!==0){var U=k&~x;U!==0?y=at(U):(E&=k,E!==0&&(y=at(E)))}else k=d&~x,k!==0?y=at(k):E!==0&&(y=at(E));if(y===0)return 0;if(c!==0&&c!==y&&(c&x)===0&&(x=y&-y,E=c&-c,x>=E||x===16&&(E&4194240)!==0))return c;if((y&4)!==0&&(y|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=y;0<c;)d=31-pi(c),x=1<<d,y|=a[d],c&=~x;return y}function ya(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _a(a,c){for(var d=a.suspendedLanes,y=a.pingedLanes,x=a.expirationTimes,E=a.pendingLanes;0<E;){var k=31-pi(E),U=1<<k,$=x[k];$===-1?((U&d)===0||(U&y)!==0)&&(x[k]=ya(U,c)):$<=c&&(a.expiredLanes|=U),E&=~U}}function Ku(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function qu(){var a=Fr;return Fr<<=1,(Fr&4194240)===0&&(Fr=64),a}function Xu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function xa(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-pi(c),a[c]=d}function Py(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var y=a.eventTimes;for(a=a.expirationTimes;0<d;){var x=31-pi(d),E=1<<x;c[x]=0,y[x]=-1,a[x]=-1,d&=~E}}function Yu(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var y=31-pi(d),x=1<<y;x&c|a[y]&c&&(a[y]|=c),d&=~x}}var Ye=0;function Vr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Zu,Gl,Qu,Ju,eh,zr=!1,$l=[],Ur=null,Br=null,xn=null,va=new Map,ws=new Map,yi=[],jf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ao(a,c){switch(a){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":va.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ws.delete(c.pointerId)}}function ar(a,c,d,y,x,E){return a===null||a.nativeEvent!==E?(a={blockedOn:c,domEventName:d,eventSystemFlags:y,nativeEvent:E,targetContainers:[x]},c!==null&&(c=gh(c),c!==null&&Gl(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,x!==null&&c.indexOf(x)===-1&&c.push(x),a)}function Ff(a,c,d,y,x){switch(c){case"focusin":return Ur=ar(Ur,a,c,d,y,x),!0;case"dragenter":return Br=ar(Br,a,c,d,y,x),!0;case"mouseover":return xn=ar(xn,a,c,d,y,x),!0;case"pointerover":var E=x.pointerId;return va.set(E,ar(va.get(E)||null,a,c,d,y,x)),!0;case"gotpointercapture":return E=x.pointerId,ws.set(E,ar(ws.get(E)||null,a,c,d,y,x)),!0}return!1}function Hl(a){var c=Sa(a.target);if(c!==null){var d=or(c);if(d!==null){if(c=d.tag,c===13){if(c=Wu(d),c!==null){a.blockedOn=c,eh(a.priority,function(){Qu(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Kl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var y=new d.constructor(d.type,d);Lr=y,d.target.dispatchEvent(y),Lr=null}else return c=gh(d),c!==null&&Gl(c),a.blockedOn=d,!1;c.shift()}return!0}function Vf(a,c,d){pt(a)&&d.delete(c)}function ky(){zr=!1,Ur!==null&&pt(Ur)&&(Ur=null),Br!==null&&pt(Br)&&(Br=null),xn!==null&&pt(xn)&&(xn=null),va.forEach(Vf),ws.forEach(Vf)}function lo(a,c){a.blockedOn===c&&(a.blockedOn=null,zr||(zr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ky)))}function co(a){function c(x){return lo(x,a)}if(0<$l.length){lo($l[0],a);for(var d=1;d<$l.length;d++){var y=$l[d];y.blockedOn===a&&(y.blockedOn=null)}}for(Ur!==null&&lo(Ur,a),Br!==null&&lo(Br,a),xn!==null&&lo(xn,a),va.forEach(c),ws.forEach(c),d=0;d<yi.length;d++)y=yi[d],y.blockedOn===a&&(y.blockedOn=null);for(;0<yi.length&&(d=yi[0],d.blockedOn===null);)Hl(d),d.blockedOn===null&&yi.shift()}var Es=L.ReactCurrentBatchConfig,Ts=!0;function Wr(a,c,d,y){var x=Ye,E=Es.transition;Es.transition=null;try{Ye=1,th(a,c,d,y)}finally{Ye=x,Es.transition=E}}function zf(a,c,d,y){var x=Ye,E=Es.transition;Es.transition=null;try{Ye=4,th(a,c,d,y)}finally{Ye=x,Es.transition=E}}function th(a,c,d,y){if(Ts){var x=Kl(a,c,d,y);if(x===null)By(a,c,y,Gr,d),ao(a,y);else if(Ff(x,a,c,d,y))y.stopPropagation();else if(ao(a,y),c&4&&-1<jf.indexOf(a)){for(;x!==null;){var E=gh(x);if(E!==null&&Zu(E),E=Kl(a,c,d,y),E===null&&By(a,c,y,Gr,d),E===x)break;x=E}x!==null&&y.stopPropagation()}else By(a,c,y,null,d)}}var Gr=null;function Kl(a,c,d,y){if(Gr=null,a=Or(y),a=Sa(a),a!==null)if(c=or(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Wu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return Gr=a,null}function ql(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ay()){case Bl:return 1;case $u:return 4;case ga:case Hu:return 16;case Wl:return 536870912;default:return 16}default:return 16}}var _i=null,Xl=null,Ss=null;function Uf(){if(Ss)return Ss;var a,c=Xl,d=c.length,y,x="value"in _i?_i.value:_i.textContent,E=x.length;for(a=0;a<d&&c[a]===x[a];a++);var k=d-a;for(y=1;y<=k&&c[d-y]===x[E-y];y++);return Ss=x.slice(a,1<y?1-y:void 0)}function wa(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function $r(){return!0}function nh(){return!1}function kn(a){function c(d,y,x,E,k){this._reactName=d,this._targetInst=x,this.type=y,this.nativeEvent=E,this.target=k,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(E):E[U]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?$r:nh,this.isPropagationStopped=nh,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=$r)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=$r)},persist:function(){},isPersistent:$r}),c}var Hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ea=kn(Hr),uo=ne({},Hr,{view:0,detail:0}),Yl=kn(uo),Zl,Ql,xi,Ta=ne({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Be,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==xi&&(xi&&a.type==="mousemove"?(Zl=a.screenX-xi.screenX,Ql=a.screenY-xi.screenY):Ql=Zl=0,xi=a),Zl)},movementY:function(a){return"movementY"in a?a.movementY:Ql}}),ih=kn(Ta),Bf=ne({},Ta,{dataTransfer:0}),Wf=kn(Bf),Jl=ne({},uo,{relatedTarget:0}),vn=kn(Jl),Gf=ne({},Hr,{animationName:0,elapsedTime:0,pseudoElement:0}),$f=kn(Gf),ho=ne({},Hr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),m=kn(ho),T=ne({},Hr,{data:0}),C=kn(T),F={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},te={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=te[a])?!!c[a]:!1}function Be(){return de}var Vt=ne({},uo,{key:function(a){if(a.key){var c=F[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=wa(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Z[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Be,charCode:function(a){return a.type==="keypress"?wa(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?wa(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ht=kn(Vt),$t=ne({},Ta,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vi=kn($t),Is=ne({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Be}),Kr=kn(Is),qr=ne({},Hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),ec=kn(qr),rh=ne({},Ta,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),QD=kn(rh),JD=[9,13,27,32],Ny=l&&"CompositionEvent"in window,sh=null;l&&"documentMode"in document&&(sh=document.documentMode);var eM=l&&"TextEvent"in window&&!sh,Xw=l&&(!Ny||sh&&8<sh&&11>=sh),Yw=" ",Zw=!1;function Qw(a,c){switch(a){case"keyup":return JD.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var tc=!1;function tM(a,c){switch(a){case"compositionend":return Jw(c);case"keypress":return c.which!==32?null:(Zw=!0,Yw);case"textInput":return a=c.data,a===Yw&&Zw?null:a;default:return null}}function nM(a,c){if(tc)return a==="compositionend"||!Ny&&Qw(a,c)?(a=Uf(),Ss=Xl=_i=null,tc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Xw&&c.locale!=="ko"?null:c.data;default:return null}}var iM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eE(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!iM[a.type]:c==="textarea"}function tE(a,c,d,y){sr(y),c=Yf(c,"onChange"),0<c.length&&(d=new Ea("onChange","change",null,d,y),a.push({event:d,listeners:c}))}var oh=null,ah=null;function rM(a){xE(a,0)}function Hf(a){var c=oc(a);if(Wn(c))return a}function sM(a,c){if(a==="change")return c}var nE=!1;if(l){var Dy;if(l){var My="oninput"in document;if(!My){var iE=document.createElement("div");iE.setAttribute("oninput","return;"),My=typeof iE.oninput=="function"}Dy=My}else Dy=!1;nE=Dy&&(!document.documentMode||9<document.documentMode)}function rE(){oh&&(oh.detachEvent("onpropertychange",sE),ah=oh=null)}function sE(a){if(a.propertyName==="value"&&Hf(ah)){var c=[];tE(c,ah,a,Or(a)),yn(rM,c)}}function oM(a,c,d){a==="focusin"?(rE(),oh=c,ah=d,oh.attachEvent("onpropertychange",sE)):a==="focusout"&&rE()}function aM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Hf(ah)}function lM(a,c){if(a==="click")return Hf(c)}function cM(a,c){if(a==="input"||a==="change")return Hf(c)}function uM(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var lr=typeof Object.is=="function"?Object.is:uM;function lh(a,c){if(lr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),y=Object.keys(c);if(d.length!==y.length)return!1;for(y=0;y<d.length;y++){var x=d[y];if(!u.call(c,x)||!lr(a[x],c[x]))return!1}return!0}function oE(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function aE(a,c){var d=oE(a);a=0;for(var y;d;){if(d.nodeType===3){if(y=a+d.textContent.length,a<=c&&y>=c)return{node:d,offset:c-a};a=y}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=oE(d)}}function lE(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?lE(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function cE(){for(var a=window,c=Zt();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Zt(a.document)}return c}function Ly(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function hM(a){var c=cE(),d=a.focusedElem,y=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&lE(d.ownerDocument.documentElement,d)){if(y!==null&&Ly(d)){if(c=y.start,a=y.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var x=d.textContent.length,E=Math.min(y.start,x);y=y.end===void 0?E:Math.min(y.end,x),!a.extend&&E>y&&(x=y,y=E,E=x),x=aE(d,E);var k=aE(d,y);x&&k&&(a.rangeCount!==1||a.anchorNode!==x.node||a.anchorOffset!==x.offset||a.focusNode!==k.node||a.focusOffset!==k.offset)&&(c=c.createRange(),c.setStart(x.node,x.offset),a.removeAllRanges(),E>y?(a.addRange(c),a.extend(k.node,k.offset)):(c.setEnd(k.node,k.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var dM=l&&"documentMode"in document&&11>=document.documentMode,nc=null,Oy=null,ch=null,jy=!1;function uE(a,c,d){var y=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;jy||nc==null||nc!==Zt(y)||(y=nc,"selectionStart"in y&&Ly(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),ch&&lh(ch,y)||(ch=y,y=Yf(Oy,"onSelect"),0<y.length&&(c=new Ea("onSelect","select",null,c,d),a.push({event:c,listeners:y}),c.target=nc)))}function Kf(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var ic={animationend:Kf("Animation","AnimationEnd"),animationiteration:Kf("Animation","AnimationIteration"),animationstart:Kf("Animation","AnimationStart"),transitionend:Kf("Transition","TransitionEnd")},Fy={},hE={};l&&(hE=document.createElement("div").style,"AnimationEvent"in window||(delete ic.animationend.animation,delete ic.animationiteration.animation,delete ic.animationstart.animation),"TransitionEvent"in window||delete ic.transitionend.transition);function qf(a){if(Fy[a])return Fy[a];if(!ic[a])return a;var c=ic[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in hE)return Fy[a]=c[d];return a}var dE=qf("animationend"),fE=qf("animationiteration"),gE=qf("animationstart"),mE=qf("transitionend"),pE=new Map,yE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fo(a,c){pE.set(a,c),s(c,[a])}for(var Vy=0;Vy<yE.length;Vy++){var zy=yE[Vy],fM=zy.toLowerCase(),gM=zy[0].toUpperCase()+zy.slice(1);fo(fM,"on"+gM)}fo(dE,"onAnimationEnd"),fo(fE,"onAnimationIteration"),fo(gE,"onAnimationStart"),fo("dblclick","onDoubleClick"),fo("focusin","onFocus"),fo("focusout","onBlur"),fo(mE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mM=new Set("cancel close invalid load scroll toggle".split(" ").concat(uh));function _E(a,c,d){var y=a.type||"unknown-event";a.currentTarget=d,Bu(y,c,void 0,a),a.currentTarget=null}function xE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var y=a[d],x=y.event;y=y.listeners;e:{var E=void 0;if(c)for(var k=y.length-1;0<=k;k--){var U=y[k],$=U.instance,ee=U.currentTarget;if(U=U.listener,$!==E&&x.isPropagationStopped())break e;_E(x,U,ee),E=$}else for(k=0;k<y.length;k++){if(U=y[k],$=U.instance,ee=U.currentTarget,U=U.listener,$!==E&&x.isPropagationStopped())break e;_E(x,U,ee),E=$}}}if(zl)throw a=Fi,zl=!1,Fi=null,a}function wt(a,c){var d=c[qy];d===void 0&&(d=c[qy]=new Set);var y=a+"__bubble";d.has(y)||(vE(c,a,2,!1),d.add(y))}function Uy(a,c,d){var y=0;c&&(y|=4),vE(d,a,y,c)}var Xf="_reactListening"+Math.random().toString(36).slice(2);function hh(a){if(!a[Xf]){a[Xf]=!0,i.forEach(function(d){d!=="selectionchange"&&(mM.has(d)||Uy(d,!1,a),Uy(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Xf]||(c[Xf]=!0,Uy("selectionchange",!1,c))}}function vE(a,c,d,y){switch(ql(c)){case 1:var x=Wr;break;case 4:x=zf;break;default:x=th}d=x.bind(null,c,d,a),x=void 0,!an||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(x=!0),y?x!==void 0?a.addEventListener(c,d,{capture:!0,passive:x}):a.addEventListener(c,d,!0):x!==void 0?a.addEventListener(c,d,{passive:x}):a.addEventListener(c,d,!1)}function By(a,c,d,y,x){var E=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var k=y.tag;if(k===3||k===4){var U=y.stateNode.containerInfo;if(U===x||U.nodeType===8&&U.parentNode===x)break;if(k===4)for(k=y.return;k!==null;){var $=k.tag;if(($===3||$===4)&&($=k.stateNode.containerInfo,$===x||$.nodeType===8&&$.parentNode===x))return;k=k.return}for(;U!==null;){if(k=Sa(U),k===null)return;if($=k.tag,$===5||$===6){y=E=k;continue e}U=U.parentNode}}y=y.return}yn(function(){var ee=E,ae=Or(d),ce=[];e:{var oe=pE.get(a);if(oe!==void 0){var ye=Ea,ve=a;switch(a){case"keypress":if(wa(d)===0)break e;case"keydown":case"keyup":ye=ht;break;case"focusin":ve="focus",ye=vn;break;case"focusout":ve="blur",ye=vn;break;case"beforeblur":case"afterblur":ye=vn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=ih;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Wf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Kr;break;case dE:case fE:case gE:ye=$f;break;case mE:ye=ec;break;case"scroll":ye=Yl;break;case"wheel":ye=QD;break;case"copy":case"cut":case"paste":ye=m;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=vi}var we=(c&4)!==0,zt=!we&&a==="scroll",Y=we?oe!==null?oe+"Capture":null:oe;we=[];for(var q=ee,Q;q!==null;){Q=q;var he=Q.stateNode;if(Q.tag===5&&he!==null&&(Q=he,Y!==null&&(he=_n(q,Y),he!=null&&we.push(dh(q,he,Q)))),zt)break;q=q.return}0<we.length&&(oe=new ye(oe,ve,null,d,ae),ce.push({event:oe,listeners:we}))}}if((c&7)===0){e:{if(oe=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",oe&&d!==Lr&&(ve=d.relatedTarget||d.fromElement)&&(Sa(ve)||ve[bs]))break e;if((ye||oe)&&(oe=ae.window===ae?ae:(oe=ae.ownerDocument)?oe.defaultView||oe.parentWindow:window,ye?(ve=d.relatedTarget||d.toElement,ye=ee,ve=ve?Sa(ve):null,ve!==null&&(zt=or(ve),ve!==zt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(ye=null,ve=ee),ye!==ve)){if(we=ih,he="onMouseLeave",Y="onMouseEnter",q="mouse",(a==="pointerout"||a==="pointerover")&&(we=vi,he="onPointerLeave",Y="onPointerEnter",q="pointer"),zt=ye==null?oe:oc(ye),Q=ve==null?oe:oc(ve),oe=new we(he,q+"leave",ye,d,ae),oe.target=zt,oe.relatedTarget=Q,he=null,Sa(ae)===ee&&(we=new we(Y,q+"enter",ve,d,ae),we.target=Q,we.relatedTarget=zt,he=we),zt=he,ye&&ve)t:{for(we=ye,Y=ve,q=0,Q=we;Q;Q=rc(Q))q++;for(Q=0,he=Y;he;he=rc(he))Q++;for(;0<q-Q;)we=rc(we),q--;for(;0<Q-q;)Y=rc(Y),Q--;for(;q--;){if(we===Y||Y!==null&&we===Y.alternate)break t;we=rc(we),Y=rc(Y)}we=null}else we=null;ye!==null&&wE(ce,oe,ye,we,!1),ve!==null&&zt!==null&&wE(ce,zt,ve,we,!0)}}e:{if(oe=ee?oc(ee):window,ye=oe.nodeName&&oe.nodeName.toLowerCase(),ye==="select"||ye==="input"&&oe.type==="file")var Se=sM;else if(eE(oe))if(nE)Se=cM;else{Se=aM;var De=oM}else(ye=oe.nodeName)&&ye.toLowerCase()==="input"&&(oe.type==="checkbox"||oe.type==="radio")&&(Se=lM);if(Se&&(Se=Se(a,ee))){tE(ce,Se,d,ae);break e}De&&De(a,oe,ee),a==="focusout"&&(De=oe._wrapperState)&&De.controlled&&oe.type==="number"&&_t(oe,"number",oe.value)}switch(De=ee?oc(ee):window,a){case"focusin":(eE(De)||De.contentEditable==="true")&&(nc=De,Oy=ee,ch=null);break;case"focusout":ch=Oy=nc=null;break;case"mousedown":jy=!0;break;case"contextmenu":case"mouseup":case"dragend":jy=!1,uE(ce,d,ae);break;case"selectionchange":if(dM)break;case"keydown":case"keyup":uE(ce,d,ae)}var Me;if(Ny)e:{switch(a){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else tc?Qw(a,d)&&(Fe="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Fe="onCompositionStart");Fe&&(Xw&&d.locale!=="ko"&&(tc||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&tc&&(Me=Uf()):(_i=ae,Xl="value"in _i?_i.value:_i.textContent,tc=!0)),De=Yf(ee,Fe),0<De.length&&(Fe=new C(Fe,a,null,d,ae),ce.push({event:Fe,listeners:De}),Me?Fe.data=Me:(Me=Jw(d),Me!==null&&(Fe.data=Me)))),(Me=eM?tM(a,d):nM(a,d))&&(ee=Yf(ee,"onBeforeInput"),0<ee.length&&(ae=new C("onBeforeInput","beforeinput",null,d,ae),ce.push({event:ae,listeners:ee}),ae.data=Me))}xE(ce,c)})}function dh(a,c,d){return{instance:a,listener:c,currentTarget:d}}function Yf(a,c){for(var d=c+"Capture",y=[];a!==null;){var x=a,E=x.stateNode;x.tag===5&&E!==null&&(x=E,E=_n(a,d),E!=null&&y.unshift(dh(a,E,x)),E=_n(a,c),E!=null&&y.push(dh(a,E,x))),a=a.return}return y}function rc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function wE(a,c,d,y,x){for(var E=c._reactName,k=[];d!==null&&d!==y;){var U=d,$=U.alternate,ee=U.stateNode;if($!==null&&$===y)break;U.tag===5&&ee!==null&&(U=ee,x?($=_n(d,E),$!=null&&k.unshift(dh(d,$,U))):x||($=_n(d,E),$!=null&&k.push(dh(d,$,U)))),d=d.return}k.length!==0&&a.push({event:c,listeners:k})}var pM=/\r\n?/g,yM=/\u0000|\uFFFD/g;function EE(a){return(typeof a=="string"?a:""+a).replace(pM,`
`).replace(yM,"")}function Zf(a,c,d){if(c=EE(c),EE(a)!==c&&d)throw Error(t(425))}function Qf(){}var Wy=null,Gy=null;function $y(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Hy=typeof setTimeout=="function"?setTimeout:void 0,_M=typeof clearTimeout=="function"?clearTimeout:void 0,TE=typeof Promise=="function"?Promise:void 0,xM=typeof queueMicrotask=="function"?queueMicrotask:typeof TE<"u"?function(a){return TE.resolve(null).then(a).catch(vM)}:Hy;function vM(a){setTimeout(function(){throw a})}function Ky(a,c){var d=c,y=0;do{var x=d.nextSibling;if(a.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"){if(y===0){a.removeChild(x),co(c);return}y--}else d!=="$"&&d!=="$?"&&d!=="$!"||y++;d=x}while(d);co(c)}function go(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function SE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var sc=Math.random().toString(36).slice(2),Xr="__reactFiber$"+sc,fh="__reactProps$"+sc,bs="__reactContainer$"+sc,qy="__reactEvents$"+sc,wM="__reactListeners$"+sc,EM="__reactHandles$"+sc;function Sa(a){var c=a[Xr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[bs]||d[Xr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=SE(a);a!==null;){if(d=a[Xr])return d;a=SE(a)}return c}a=d,d=a.parentNode}return null}function gh(a){return a=a[Xr]||a[bs],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function oc(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Jf(a){return a[fh]||null}var Xy=[],ac=-1;function mo(a){return{current:a}}function Et(a){0>ac||(a.current=Xy[ac],Xy[ac]=null,ac--)}function xt(a,c){ac++,Xy[ac]=a.current,a.current=c}var po={},Nn=mo(po),Jn=mo(!1),Ia=po;function lc(a,c){var d=a.type.contextTypes;if(!d)return po;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var x={},E;for(E in d)x[E]=c[E];return y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=x),x}function ei(a){return a=a.childContextTypes,a!=null}function eg(){Et(Jn),Et(Nn)}function IE(a,c,d){if(Nn.current!==po)throw Error(t(168));xt(Nn,c),xt(Jn,d)}function bE(a,c,d){var y=a.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return d;y=y.getChildContext();for(var x in y)if(!(x in c))throw Error(t(108,Ne(a)||"Unknown",x));return ne({},d,y)}function tg(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||po,Ia=Nn.current,xt(Nn,a),xt(Jn,Jn.current),!0}function CE(a,c,d){var y=a.stateNode;if(!y)throw Error(t(169));d?(a=bE(a,c,Ia),y.__reactInternalMemoizedMergedChildContext=a,Et(Jn),Et(Nn),xt(Nn,a)):Et(Jn),xt(Jn,d)}var Cs=null,ng=!1,Yy=!1;function RE(a){Cs===null?Cs=[a]:Cs.push(a)}function TM(a){ng=!0,RE(a)}function yo(){if(!Yy&&Cs!==null){Yy=!0;var a=0,c=Ye;try{var d=Cs;for(Ye=1;a<d.length;a++){var y=d[a];do y=y(!0);while(y!==null)}Cs=null,ng=!1}catch(x){throw Cs!==null&&(Cs=Cs.slice(a+1)),Gu(Bl,yo),x}finally{Ye=c,Yy=!1}}return null}var cc=[],uc=0,ig=null,rg=0,zi=[],Ui=0,ba=null,Rs=1,As="";function Ca(a,c){cc[uc++]=rg,cc[uc++]=ig,ig=a,rg=c}function AE(a,c,d){zi[Ui++]=Rs,zi[Ui++]=As,zi[Ui++]=ba,ba=a;var y=Rs;a=As;var x=32-pi(y)-1;y&=~(1<<x),d+=1;var E=32-pi(c)+x;if(30<E){var k=x-x%5;E=(y&(1<<k)-1).toString(32),y>>=k,x-=k,Rs=1<<32-pi(c)+x|d<<x|y,As=E+a}else Rs=1<<E|d<<x|y,As=a}function Zy(a){a.return!==null&&(Ca(a,1),AE(a,1,0))}function Qy(a){for(;a===ig;)ig=cc[--uc],cc[uc]=null,rg=cc[--uc],cc[uc]=null;for(;a===ba;)ba=zi[--Ui],zi[Ui]=null,As=zi[--Ui],zi[Ui]=null,Rs=zi[--Ui],zi[Ui]=null}var wi=null,Ei=null,bt=!1,cr=null;function PE(a,c){var d=$i(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function kE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,wi=a,Ei=go(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,wi=a,Ei=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=ba!==null?{id:Rs,overflow:As}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=$i(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,wi=a,Ei=null,!0):!1;default:return!1}}function Jy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function e0(a){if(bt){var c=Ei;if(c){var d=c;if(!kE(a,c)){if(Jy(a))throw Error(t(418));c=go(d.nextSibling);var y=wi;c&&kE(a,c)?PE(y,d):(a.flags=a.flags&-4097|2,bt=!1,wi=a)}}else{if(Jy(a))throw Error(t(418));a.flags=a.flags&-4097|2,bt=!1,wi=a}}}function NE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;wi=a}function sg(a){if(a!==wi)return!1;if(!bt)return NE(a),bt=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!$y(a.type,a.memoizedProps)),c&&(c=Ei)){if(Jy(a))throw DE(),Error(t(418));for(;c;)PE(a,c),c=go(c.nextSibling)}if(NE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){Ei=go(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}Ei=null}}else Ei=wi?go(a.stateNode.nextSibling):null;return!0}function DE(){for(var a=Ei;a;)a=go(a.nextSibling)}function hc(){Ei=wi=null,bt=!1}function t0(a){cr===null?cr=[a]:cr.push(a)}var SM=L.ReactCurrentBatchConfig;function mh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var y=d.stateNode}if(!y)throw Error(t(147,a));var x=y,E=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===E?c.ref:(c=function(k){var U=x.refs;k===null?delete U[E]:U[E]=k},c._stringRef=E,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function og(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function ME(a){var c=a._init;return c(a._payload)}function LE(a){function c(Y,q){if(a){var Q=Y.deletions;Q===null?(Y.deletions=[q],Y.flags|=16):Q.push(q)}}function d(Y,q){if(!a)return null;for(;q!==null;)c(Y,q),q=q.sibling;return null}function y(Y,q){for(Y=new Map;q!==null;)q.key!==null?Y.set(q.key,q):Y.set(q.index,q),q=q.sibling;return Y}function x(Y,q){return Y=Io(Y,q),Y.index=0,Y.sibling=null,Y}function E(Y,q,Q){return Y.index=Q,a?(Q=Y.alternate,Q!==null?(Q=Q.index,Q<q?(Y.flags|=2,q):Q):(Y.flags|=2,q)):(Y.flags|=1048576,q)}function k(Y){return a&&Y.alternate===null&&(Y.flags|=2),Y}function U(Y,q,Q,he){return q===null||q.tag!==6?(q=H0(Q,Y.mode,he),q.return=Y,q):(q=x(q,Q),q.return=Y,q)}function $(Y,q,Q,he){var Se=Q.type;return Se===A?ae(Y,q,Q.props.children,he,Q.key):q!==null&&(q.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===pe&&ME(Se)===q.type)?(he=x(q,Q.props),he.ref=mh(Y,q,Q),he.return=Y,he):(he=Pg(Q.type,Q.key,Q.props,null,Y.mode,he),he.ref=mh(Y,q,Q),he.return=Y,he)}function ee(Y,q,Q,he){return q===null||q.tag!==4||q.stateNode.containerInfo!==Q.containerInfo||q.stateNode.implementation!==Q.implementation?(q=K0(Q,Y.mode,he),q.return=Y,q):(q=x(q,Q.children||[]),q.return=Y,q)}function ae(Y,q,Q,he,Se){return q===null||q.tag!==7?(q=La(Q,Y.mode,he,Se),q.return=Y,q):(q=x(q,Q),q.return=Y,q)}function ce(Y,q,Q){if(typeof q=="string"&&q!==""||typeof q=="number")return q=H0(""+q,Y.mode,Q),q.return=Y,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case N:return Q=Pg(q.type,q.key,q.props,null,Y.mode,Q),Q.ref=mh(Y,null,q),Q.return=Y,Q;case V:return q=K0(q,Y.mode,Q),q.return=Y,q;case pe:var he=q._init;return ce(Y,he(q._payload),Q)}if(ut(q)||X(q))return q=La(q,Y.mode,Q,null),q.return=Y,q;og(Y,q)}return null}function oe(Y,q,Q,he){var Se=q!==null?q.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Se!==null?null:U(Y,q,""+Q,he);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case N:return Q.key===Se?$(Y,q,Q,he):null;case V:return Q.key===Se?ee(Y,q,Q,he):null;case pe:return Se=Q._init,oe(Y,q,Se(Q._payload),he)}if(ut(Q)||X(Q))return Se!==null?null:ae(Y,q,Q,he,null);og(Y,Q)}return null}function ye(Y,q,Q,he,Se){if(typeof he=="string"&&he!==""||typeof he=="number")return Y=Y.get(Q)||null,U(q,Y,""+he,Se);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case N:return Y=Y.get(he.key===null?Q:he.key)||null,$(q,Y,he,Se);case V:return Y=Y.get(he.key===null?Q:he.key)||null,ee(q,Y,he,Se);case pe:var De=he._init;return ye(Y,q,Q,De(he._payload),Se)}if(ut(he)||X(he))return Y=Y.get(Q)||null,ae(q,Y,he,Se,null);og(q,he)}return null}function ve(Y,q,Q,he){for(var Se=null,De=null,Me=q,Fe=q=0,un=null;Me!==null&&Fe<Q.length;Fe++){Me.index>Fe?(un=Me,Me=null):un=Me.sibling;var nt=oe(Y,Me,Q[Fe],he);if(nt===null){Me===null&&(Me=un);break}a&&Me&&nt.alternate===null&&c(Y,Me),q=E(nt,q,Fe),De===null?Se=nt:De.sibling=nt,De=nt,Me=un}if(Fe===Q.length)return d(Y,Me),bt&&Ca(Y,Fe),Se;if(Me===null){for(;Fe<Q.length;Fe++)Me=ce(Y,Q[Fe],he),Me!==null&&(q=E(Me,q,Fe),De===null?Se=Me:De.sibling=Me,De=Me);return bt&&Ca(Y,Fe),Se}for(Me=y(Y,Me);Fe<Q.length;Fe++)un=ye(Me,Y,Fe,Q[Fe],he),un!==null&&(a&&un.alternate!==null&&Me.delete(un.key===null?Fe:un.key),q=E(un,q,Fe),De===null?Se=un:De.sibling=un,De=un);return a&&Me.forEach(function(bo){return c(Y,bo)}),bt&&Ca(Y,Fe),Se}function we(Y,q,Q,he){var Se=X(Q);if(typeof Se!="function")throw Error(t(150));if(Q=Se.call(Q),Q==null)throw Error(t(151));for(var De=Se=null,Me=q,Fe=q=0,un=null,nt=Q.next();Me!==null&&!nt.done;Fe++,nt=Q.next()){Me.index>Fe?(un=Me,Me=null):un=Me.sibling;var bo=oe(Y,Me,nt.value,he);if(bo===null){Me===null&&(Me=un);break}a&&Me&&bo.alternate===null&&c(Y,Me),q=E(bo,q,Fe),De===null?Se=bo:De.sibling=bo,De=bo,Me=un}if(nt.done)return d(Y,Me),bt&&Ca(Y,Fe),Se;if(Me===null){for(;!nt.done;Fe++,nt=Q.next())nt=ce(Y,nt.value,he),nt!==null&&(q=E(nt,q,Fe),De===null?Se=nt:De.sibling=nt,De=nt);return bt&&Ca(Y,Fe),Se}for(Me=y(Y,Me);!nt.done;Fe++,nt=Q.next())nt=ye(Me,Y,Fe,nt.value,he),nt!==null&&(a&&nt.alternate!==null&&Me.delete(nt.key===null?Fe:nt.key),q=E(nt,q,Fe),De===null?Se=nt:De.sibling=nt,De=nt);return a&&Me.forEach(function(iL){return c(Y,iL)}),bt&&Ca(Y,Fe),Se}function zt(Y,q,Q,he){if(typeof Q=="object"&&Q!==null&&Q.type===A&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case N:e:{for(var Se=Q.key,De=q;De!==null;){if(De.key===Se){if(Se=Q.type,Se===A){if(De.tag===7){d(Y,De.sibling),q=x(De,Q.props.children),q.return=Y,Y=q;break e}}else if(De.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===pe&&ME(Se)===De.type){d(Y,De.sibling),q=x(De,Q.props),q.ref=mh(Y,De,Q),q.return=Y,Y=q;break e}d(Y,De);break}else c(Y,De);De=De.sibling}Q.type===A?(q=La(Q.props.children,Y.mode,he,Q.key),q.return=Y,Y=q):(he=Pg(Q.type,Q.key,Q.props,null,Y.mode,he),he.ref=mh(Y,q,Q),he.return=Y,Y=he)}return k(Y);case V:e:{for(De=Q.key;q!==null;){if(q.key===De)if(q.tag===4&&q.stateNode.containerInfo===Q.containerInfo&&q.stateNode.implementation===Q.implementation){d(Y,q.sibling),q=x(q,Q.children||[]),q.return=Y,Y=q;break e}else{d(Y,q);break}else c(Y,q);q=q.sibling}q=K0(Q,Y.mode,he),q.return=Y,Y=q}return k(Y);case pe:return De=Q._init,zt(Y,q,De(Q._payload),he)}if(ut(Q))return ve(Y,q,Q,he);if(X(Q))return we(Y,q,Q,he);og(Y,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,q!==null&&q.tag===6?(d(Y,q.sibling),q=x(q,Q),q.return=Y,Y=q):(d(Y,q),q=H0(Q,Y.mode,he),q.return=Y,Y=q),k(Y)):d(Y,q)}return zt}var dc=LE(!0),OE=LE(!1),ag=mo(null),lg=null,fc=null,n0=null;function i0(){n0=fc=lg=null}function r0(a){var c=ag.current;Et(ag),a._currentValue=c}function s0(a,c,d){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===d)break;a=a.return}}function gc(a,c){lg=a,n0=fc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(ti=!0),a.firstContext=null)}function Bi(a){var c=a._currentValue;if(n0!==a)if(a={context:a,memoizedValue:c,next:null},fc===null){if(lg===null)throw Error(t(308));fc=a,lg.dependencies={lanes:0,firstContext:a}}else fc=fc.next=a;return c}var Ra=null;function o0(a){Ra===null?Ra=[a]:Ra.push(a)}function jE(a,c,d,y){var x=c.interleaved;return x===null?(d.next=d,o0(c)):(d.next=x.next,x.next=d),c.interleaved=d,Ps(a,y)}function Ps(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var _o=!1;function a0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function FE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ks(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function xo(a,c,d){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,(tt&2)!==0){var x=y.pending;return x===null?c.next=c:(c.next=x.next,x.next=c),y.pending=c,Ps(a,d)}return x=y.interleaved,x===null?(c.next=c,o0(y)):(c.next=x.next,x.next=c),y.interleaved=c,Ps(a,d)}function cg(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var y=c.lanes;y&=a.pendingLanes,d|=y,c.lanes=d,Yu(a,d)}}function VE(a,c){var d=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,d===y)){var x=null,E=null;if(d=d.firstBaseUpdate,d!==null){do{var k={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};E===null?x=E=k:E=E.next=k,d=d.next}while(d!==null);E===null?x=E=c:E=E.next=c}else x=E=c;d={baseState:y.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:y.shared,effects:y.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function ug(a,c,d,y){var x=a.updateQueue;_o=!1;var E=x.firstBaseUpdate,k=x.lastBaseUpdate,U=x.shared.pending;if(U!==null){x.shared.pending=null;var $=U,ee=$.next;$.next=null,k===null?E=ee:k.next=ee,k=$;var ae=a.alternate;ae!==null&&(ae=ae.updateQueue,U=ae.lastBaseUpdate,U!==k&&(U===null?ae.firstBaseUpdate=ee:U.next=ee,ae.lastBaseUpdate=$))}if(E!==null){var ce=x.baseState;k=0,ae=ee=$=null,U=E;do{var oe=U.lane,ye=U.eventTime;if((y&oe)===oe){ae!==null&&(ae=ae.next={eventTime:ye,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ve=a,we=U;switch(oe=c,ye=d,we.tag){case 1:if(ve=we.payload,typeof ve=="function"){ce=ve.call(ye,ce,oe);break e}ce=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=we.payload,oe=typeof ve=="function"?ve.call(ye,ce,oe):ve,oe==null)break e;ce=ne({},ce,oe);break e;case 2:_o=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,oe=x.effects,oe===null?x.effects=[U]:oe.push(U))}else ye={eventTime:ye,lane:oe,tag:U.tag,payload:U.payload,callback:U.callback,next:null},ae===null?(ee=ae=ye,$=ce):ae=ae.next=ye,k|=oe;if(U=U.next,U===null){if(U=x.shared.pending,U===null)break;oe=U,U=oe.next,oe.next=null,x.lastBaseUpdate=oe,x.shared.pending=null}}while(!0);if(ae===null&&($=ce),x.baseState=$,x.firstBaseUpdate=ee,x.lastBaseUpdate=ae,c=x.shared.interleaved,c!==null){x=c;do k|=x.lane,x=x.next;while(x!==c)}else E===null&&(x.shared.lanes=0);ka|=k,a.lanes=k,a.memoizedState=ce}}function zE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var y=a[c],x=y.callback;if(x!==null){if(y.callback=null,y=d,typeof x!="function")throw Error(t(191,x));x.call(y)}}}var ph={},Yr=mo(ph),yh=mo(ph),_h=mo(ph);function Aa(a){if(a===ph)throw Error(t(174));return a}function l0(a,c){switch(xt(_h,c),xt(yh,a),xt(Yr,ph),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:rr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=rr(c,a)}Et(Yr),xt(Yr,c)}function mc(){Et(Yr),Et(yh),Et(_h)}function UE(a){Aa(_h.current);var c=Aa(Yr.current),d=rr(c,a.type);c!==d&&(xt(yh,a),xt(Yr,d))}function c0(a){yh.current===a&&(Et(Yr),Et(yh))}var At=mo(0);function hg(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var u0=[];function h0(){for(var a=0;a<u0.length;a++)u0[a]._workInProgressVersionPrimary=null;u0.length=0}var dg=L.ReactCurrentDispatcher,d0=L.ReactCurrentBatchConfig,Pa=0,Pt=null,Jt=null,ln=null,fg=!1,xh=!1,vh=0,IM=0;function Dn(){throw Error(t(321))}function f0(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!lr(a[d],c[d]))return!1;return!0}function g0(a,c,d,y,x,E){if(Pa=E,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,dg.current=a===null||a.memoizedState===null?AM:PM,a=d(y,x),xh){E=0;do{if(xh=!1,vh=0,25<=E)throw Error(t(301));E+=1,ln=Jt=null,c.updateQueue=null,dg.current=kM,a=d(y,x)}while(xh)}if(dg.current=pg,c=Jt!==null&&Jt.next!==null,Pa=0,ln=Jt=Pt=null,fg=!1,c)throw Error(t(300));return a}function m0(){var a=vh!==0;return vh=0,a}function Zr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?Pt.memoizedState=ln=a:ln=ln.next=a,ln}function Wi(){if(Jt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=Jt.next;var c=ln===null?Pt.memoizedState:ln.next;if(c!==null)ln=c,Jt=a;else{if(a===null)throw Error(t(310));Jt=a,a={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},ln===null?Pt.memoizedState=ln=a:ln=ln.next=a}return ln}function wh(a,c){return typeof c=="function"?c(a):c}function p0(a){var c=Wi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var y=Jt,x=y.baseQueue,E=d.pending;if(E!==null){if(x!==null){var k=x.next;x.next=E.next,E.next=k}y.baseQueue=x=E,d.pending=null}if(x!==null){E=x.next,y=y.baseState;var U=k=null,$=null,ee=E;do{var ae=ee.lane;if((Pa&ae)===ae)$!==null&&($=$.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),y=ee.hasEagerState?ee.eagerState:a(y,ee.action);else{var ce={lane:ae,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};$===null?(U=$=ce,k=y):$=$.next=ce,Pt.lanes|=ae,ka|=ae}ee=ee.next}while(ee!==null&&ee!==E);$===null?k=y:$.next=U,lr(y,c.memoizedState)||(ti=!0),c.memoizedState=y,c.baseState=k,c.baseQueue=$,d.lastRenderedState=y}if(a=d.interleaved,a!==null){x=a;do E=x.lane,Pt.lanes|=E,ka|=E,x=x.next;while(x!==a)}else x===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function y0(a){var c=Wi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var y=d.dispatch,x=d.pending,E=c.memoizedState;if(x!==null){d.pending=null;var k=x=x.next;do E=a(E,k.action),k=k.next;while(k!==x);lr(E,c.memoizedState)||(ti=!0),c.memoizedState=E,c.baseQueue===null&&(c.baseState=E),d.lastRenderedState=E}return[E,y]}function BE(){}function WE(a,c){var d=Pt,y=Wi(),x=c(),E=!lr(y.memoizedState,x);if(E&&(y.memoizedState=x,ti=!0),y=y.queue,_0(HE.bind(null,d,y,a),[a]),y.getSnapshot!==c||E||ln!==null&&ln.memoizedState.tag&1){if(d.flags|=2048,Eh(9,$E.bind(null,d,y,x,c),void 0,null),cn===null)throw Error(t(349));(Pa&30)!==0||GE(d,c,x)}return x}function GE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function $E(a,c,d,y){c.value=d,c.getSnapshot=y,KE(c)&&qE(a)}function HE(a,c,d){return d(function(){KE(c)&&qE(a)})}function KE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!lr(a,d)}catch{return!0}}function qE(a){var c=Ps(a,1);c!==null&&fr(c,a,1,-1)}function XE(a){var c=Zr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wh,lastRenderedState:a},c.queue=a,a=a.dispatch=RM.bind(null,Pt,a),[c.memoizedState,a]}function Eh(a,c,d,y){return a={tag:a,create:c,destroy:d,deps:y,next:null},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(y=d.next,d.next=a,a.next=y,c.lastEffect=a)),a}function YE(){return Wi().memoizedState}function gg(a,c,d,y){var x=Zr();Pt.flags|=a,x.memoizedState=Eh(1|c,d,void 0,y===void 0?null:y)}function mg(a,c,d,y){var x=Wi();y=y===void 0?null:y;var E=void 0;if(Jt!==null){var k=Jt.memoizedState;if(E=k.destroy,y!==null&&f0(y,k.deps)){x.memoizedState=Eh(c,d,E,y);return}}Pt.flags|=a,x.memoizedState=Eh(1|c,d,E,y)}function ZE(a,c){return gg(8390656,8,a,c)}function _0(a,c){return mg(2048,8,a,c)}function QE(a,c){return mg(4,2,a,c)}function JE(a,c){return mg(4,4,a,c)}function eT(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function tT(a,c,d){return d=d!=null?d.concat([a]):null,mg(4,4,eT.bind(null,c,a),d)}function x0(){}function nT(a,c){var d=Wi();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&f0(c,y[1])?y[0]:(d.memoizedState=[a,c],a)}function iT(a,c){var d=Wi();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&f0(c,y[1])?y[0]:(a=a(),d.memoizedState=[a,c],a)}function rT(a,c,d){return(Pa&21)===0?(a.baseState&&(a.baseState=!1,ti=!0),a.memoizedState=d):(lr(d,c)||(d=qu(),Pt.lanes|=d,ka|=d,a.baseState=!0),c)}function bM(a,c){var d=Ye;Ye=d!==0&&4>d?d:4,a(!0);var y=d0.transition;d0.transition={};try{a(!1),c()}finally{Ye=d,d0.transition=y}}function sT(){return Wi().memoizedState}function CM(a,c,d){var y=To(a);if(d={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null},oT(a))aT(c,d);else if(d=jE(a,c,d,y),d!==null){var x=qn();fr(d,a,y,x),lT(d,c,y)}}function RM(a,c,d){var y=To(a),x={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null};if(oT(a))aT(c,x);else{var E=a.alternate;if(a.lanes===0&&(E===null||E.lanes===0)&&(E=c.lastRenderedReducer,E!==null))try{var k=c.lastRenderedState,U=E(k,d);if(x.hasEagerState=!0,x.eagerState=U,lr(U,k)){var $=c.interleaved;$===null?(x.next=x,o0(c)):(x.next=$.next,$.next=x),c.interleaved=x;return}}catch{}d=jE(a,c,x,y),d!==null&&(x=qn(),fr(d,a,y,x),lT(d,c,y))}}function oT(a){var c=a.alternate;return a===Pt||c!==null&&c===Pt}function aT(a,c){xh=fg=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function lT(a,c,d){if((d&4194240)!==0){var y=c.lanes;y&=a.pendingLanes,d|=y,c.lanes=d,Yu(a,d)}}var pg={readContext:Bi,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},AM={readContext:Bi,useCallback:function(a,c){return Zr().memoizedState=[a,c===void 0?null:c],a},useContext:Bi,useEffect:ZE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,gg(4194308,4,eT.bind(null,c,a),d)},useLayoutEffect:function(a,c){return gg(4194308,4,a,c)},useInsertionEffect:function(a,c){return gg(4,2,a,c)},useMemo:function(a,c){var d=Zr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var y=Zr();return c=d!==void 0?d(c):c,y.memoizedState=y.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},y.queue=a,a=a.dispatch=CM.bind(null,Pt,a),[y.memoizedState,a]},useRef:function(a){var c=Zr();return a={current:a},c.memoizedState=a},useState:XE,useDebugValue:x0,useDeferredValue:function(a){return Zr().memoizedState=a},useTransition:function(){var a=XE(!1),c=a[0];return a=bM.bind(null,a[1]),Zr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var y=Pt,x=Zr();if(bt){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),cn===null)throw Error(t(349));(Pa&30)!==0||GE(y,c,d)}x.memoizedState=d;var E={value:d,getSnapshot:c};return x.queue=E,ZE(HE.bind(null,y,E,a),[a]),y.flags|=2048,Eh(9,$E.bind(null,y,E,d,c),void 0,null),d},useId:function(){var a=Zr(),c=cn.identifierPrefix;if(bt){var d=As,y=Rs;d=(y&~(1<<32-pi(y)-1)).toString(32)+d,c=":"+c+"R"+d,d=vh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=IM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},PM={readContext:Bi,useCallback:nT,useContext:Bi,useEffect:_0,useImperativeHandle:tT,useInsertionEffect:QE,useLayoutEffect:JE,useMemo:iT,useReducer:p0,useRef:YE,useState:function(){return p0(wh)},useDebugValue:x0,useDeferredValue:function(a){var c=Wi();return rT(c,Jt.memoizedState,a)},useTransition:function(){var a=p0(wh)[0],c=Wi().memoizedState;return[a,c]},useMutableSource:BE,useSyncExternalStore:WE,useId:sT,unstable_isNewReconciler:!1},kM={readContext:Bi,useCallback:nT,useContext:Bi,useEffect:_0,useImperativeHandle:tT,useInsertionEffect:QE,useLayoutEffect:JE,useMemo:iT,useReducer:y0,useRef:YE,useState:function(){return y0(wh)},useDebugValue:x0,useDeferredValue:function(a){var c=Wi();return Jt===null?c.memoizedState=a:rT(c,Jt.memoizedState,a)},useTransition:function(){var a=y0(wh)[0],c=Wi().memoizedState;return[a,c]},useMutableSource:BE,useSyncExternalStore:WE,useId:sT,unstable_isNewReconciler:!1};function ur(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function v0(a,c,d,y){c=a.memoizedState,d=d(y,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var yg={isMounted:function(a){return(a=a._reactInternals)?or(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var y=qn(),x=To(a),E=ks(y,x);E.payload=c,d!=null&&(E.callback=d),c=xo(a,E,x),c!==null&&(fr(c,a,x,y),cg(c,a,x))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var y=qn(),x=To(a),E=ks(y,x);E.tag=1,E.payload=c,d!=null&&(E.callback=d),c=xo(a,E,x),c!==null&&(fr(c,a,x,y),cg(c,a,x))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=qn(),y=To(a),x=ks(d,y);x.tag=2,c!=null&&(x.callback=c),c=xo(a,x,y),c!==null&&(fr(c,a,y,d),cg(c,a,y))}};function cT(a,c,d,y,x,E,k){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,E,k):c.prototype&&c.prototype.isPureReactComponent?!lh(d,y)||!lh(x,E):!0}function uT(a,c,d){var y=!1,x=po,E=c.contextType;return typeof E=="object"&&E!==null?E=Bi(E):(x=ei(c)?Ia:Nn.current,y=c.contextTypes,E=(y=y!=null)?lc(a,x):po),c=new c(d,E),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=yg,a.stateNode=c,c._reactInternals=a,y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=x,a.__reactInternalMemoizedMaskedChildContext=E),c}function hT(a,c,d,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,y),c.state!==a&&yg.enqueueReplaceState(c,c.state,null)}function w0(a,c,d,y){var x=a.stateNode;x.props=d,x.state=a.memoizedState,x.refs={},a0(a);var E=c.contextType;typeof E=="object"&&E!==null?x.context=Bi(E):(E=ei(c)?Ia:Nn.current,x.context=lc(a,E)),x.state=a.memoizedState,E=c.getDerivedStateFromProps,typeof E=="function"&&(v0(a,c,E,d),x.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(c=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),c!==x.state&&yg.enqueueReplaceState(x,x.state,null),ug(a,d,x,y),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308)}function pc(a,c){try{var d="",y=c;do d+=_e(y),y=y.return;while(y);var x=d}catch(E){x=`
Error generating stack: `+E.message+`
`+E.stack}return{value:a,source:c,stack:x,digest:null}}function E0(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function T0(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var NM=typeof WeakMap=="function"?WeakMap:Map;function dT(a,c,d){d=ks(-1,d),d.tag=3,d.payload={element:null};var y=c.value;return d.callback=function(){Sg||(Sg=!0,F0=y),T0(a,c)},d}function fT(a,c,d){d=ks(-1,d),d.tag=3;var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var x=c.value;d.payload=function(){return y(x)},d.callback=function(){T0(a,c)}}var E=a.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(d.callback=function(){T0(a,c),typeof y!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})}),d}function gT(a,c,d){var y=a.pingCache;if(y===null){y=a.pingCache=new NM;var x=new Set;y.set(c,x)}else x=y.get(c),x===void 0&&(x=new Set,y.set(c,x));x.has(d)||(x.add(d),a=HM.bind(null,a,c,d),c.then(a,a))}function mT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function pT(a,c,d,y,x){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=ks(-1,1),c.tag=2,xo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=x,a)}var DM=L.ReactCurrentOwner,ti=!1;function Kn(a,c,d,y){c.child=a===null?OE(c,null,d,y):dc(c,a.child,d,y)}function yT(a,c,d,y,x){d=d.render;var E=c.ref;return gc(c,x),y=g0(a,c,d,y,E,x),d=m0(),a!==null&&!ti?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~x,Ns(a,c,x)):(bt&&d&&Zy(c),c.flags|=1,Kn(a,c,y,x),c.child)}function _T(a,c,d,y,x){if(a===null){var E=d.type;return typeof E=="function"&&!$0(E)&&E.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=E,xT(a,c,E,y,x)):(a=Pg(d.type,null,y,c,c.mode,x),a.ref=c.ref,a.return=c,c.child=a)}if(E=a.child,(a.lanes&x)===0){var k=E.memoizedProps;if(d=d.compare,d=d!==null?d:lh,d(k,y)&&a.ref===c.ref)return Ns(a,c,x)}return c.flags|=1,a=Io(E,y),a.ref=c.ref,a.return=c,c.child=a}function xT(a,c,d,y,x){if(a!==null){var E=a.memoizedProps;if(lh(E,y)&&a.ref===c.ref)if(ti=!1,c.pendingProps=y=E,(a.lanes&x)!==0)(a.flags&131072)!==0&&(ti=!0);else return c.lanes=a.lanes,Ns(a,c,x)}return S0(a,c,d,y,x)}function vT(a,c,d){var y=c.pendingProps,x=y.children,E=a!==null?a.memoizedState:null;if(y.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(_c,Ti),Ti|=d;else{if((d&1073741824)===0)return a=E!==null?E.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,xt(_c,Ti),Ti|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=E!==null?E.baseLanes:d,xt(_c,Ti),Ti|=y}else E!==null?(y=E.baseLanes|d,c.memoizedState=null):y=d,xt(_c,Ti),Ti|=y;return Kn(a,c,x,d),c.child}function wT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function S0(a,c,d,y,x){var E=ei(d)?Ia:Nn.current;return E=lc(c,E),gc(c,x),d=g0(a,c,d,y,E,x),y=m0(),a!==null&&!ti?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~x,Ns(a,c,x)):(bt&&y&&Zy(c),c.flags|=1,Kn(a,c,d,x),c.child)}function ET(a,c,d,y,x){if(ei(d)){var E=!0;tg(c)}else E=!1;if(gc(c,x),c.stateNode===null)xg(a,c),uT(c,d,y),w0(c,d,y,x),y=!0;else if(a===null){var k=c.stateNode,U=c.memoizedProps;k.props=U;var $=k.context,ee=d.contextType;typeof ee=="object"&&ee!==null?ee=Bi(ee):(ee=ei(d)?Ia:Nn.current,ee=lc(c,ee));var ae=d.getDerivedStateFromProps,ce=typeof ae=="function"||typeof k.getSnapshotBeforeUpdate=="function";ce||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(U!==y||$!==ee)&&hT(c,k,y,ee),_o=!1;var oe=c.memoizedState;k.state=oe,ug(c,y,k,x),$=c.memoizedState,U!==y||oe!==$||Jn.current||_o?(typeof ae=="function"&&(v0(c,d,ae,y),$=c.memoizedState),(U=_o||cT(c,d,U,y,oe,$,ee))?(ce||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(c.flags|=4194308)):(typeof k.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=$),k.props=y,k.state=$,k.context=ee,y=U):(typeof k.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{k=c.stateNode,FE(a,c),U=c.memoizedProps,ee=c.type===c.elementType?U:ur(c.type,U),k.props=ee,ce=c.pendingProps,oe=k.context,$=d.contextType,typeof $=="object"&&$!==null?$=Bi($):($=ei(d)?Ia:Nn.current,$=lc(c,$));var ye=d.getDerivedStateFromProps;(ae=typeof ye=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(U!==ce||oe!==$)&&hT(c,k,y,$),_o=!1,oe=c.memoizedState,k.state=oe,ug(c,y,k,x);var ve=c.memoizedState;U!==ce||oe!==ve||Jn.current||_o?(typeof ye=="function"&&(v0(c,d,ye,y),ve=c.memoizedState),(ee=_o||cT(c,d,ee,y,oe,ve,$)||!1)?(ae||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(y,ve,$),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(y,ve,$)),typeof k.componentDidUpdate=="function"&&(c.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof k.componentDidUpdate!="function"||U===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=ve),k.props=y,k.state=ve,k.context=$,y=ee):(typeof k.componentDidUpdate!="function"||U===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),y=!1)}return I0(a,c,d,y,E,x)}function I0(a,c,d,y,x,E){wT(a,c);var k=(c.flags&128)!==0;if(!y&&!k)return x&&CE(c,d,!1),Ns(a,c,E);y=c.stateNode,DM.current=c;var U=k&&typeof d.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,a!==null&&k?(c.child=dc(c,a.child,null,E),c.child=dc(c,null,U,E)):Kn(a,c,U,E),c.memoizedState=y.state,x&&CE(c,d,!0),c.child}function TT(a){var c=a.stateNode;c.pendingContext?IE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&IE(a,c.context,!1),l0(a,c.containerInfo)}function ST(a,c,d,y,x){return hc(),t0(x),c.flags|=256,Kn(a,c,d,y),c.child}var b0={dehydrated:null,treeContext:null,retryLane:0};function C0(a){return{baseLanes:a,cachePool:null,transitions:null}}function IT(a,c,d){var y=c.pendingProps,x=At.current,E=!1,k=(c.flags&128)!==0,U;if((U=k)||(U=a!==null&&a.memoizedState===null?!1:(x&2)!==0),U?(E=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(x|=1),xt(At,x&1),a===null)return e0(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(k=y.children,a=y.fallback,E?(y=c.mode,E=c.child,k={mode:"hidden",children:k},(y&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=k):E=kg(k,y,0,null),a=La(a,y,d,null),E.return=c,a.return=c,E.sibling=a,c.child=E,c.child.memoizedState=C0(d),c.memoizedState=b0,a):R0(c,k));if(x=a.memoizedState,x!==null&&(U=x.dehydrated,U!==null))return MM(a,c,k,y,U,x,d);if(E){E=y.fallback,k=c.mode,x=a.child,U=x.sibling;var $={mode:"hidden",children:y.children};return(k&1)===0&&c.child!==x?(y=c.child,y.childLanes=0,y.pendingProps=$,c.deletions=null):(y=Io(x,$),y.subtreeFlags=x.subtreeFlags&14680064),U!==null?E=Io(U,E):(E=La(E,k,d,null),E.flags|=2),E.return=c,y.return=c,y.sibling=E,c.child=y,y=E,E=c.child,k=a.child.memoizedState,k=k===null?C0(d):{baseLanes:k.baseLanes|d,cachePool:null,transitions:k.transitions},E.memoizedState=k,E.childLanes=a.childLanes&~d,c.memoizedState=b0,y}return E=a.child,a=E.sibling,y=Io(E,{mode:"visible",children:y.children}),(c.mode&1)===0&&(y.lanes=d),y.return=c,y.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=y,c.memoizedState=null,y}function R0(a,c){return c=kg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function _g(a,c,d,y){return y!==null&&t0(y),dc(c,a.child,null,d),a=R0(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function MM(a,c,d,y,x,E,k){if(d)return c.flags&256?(c.flags&=-257,y=E0(Error(t(422))),_g(a,c,k,y)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(E=y.fallback,x=c.mode,y=kg({mode:"visible",children:y.children},x,0,null),E=La(E,x,k,null),E.flags|=2,y.return=c,E.return=c,y.sibling=E,c.child=y,(c.mode&1)!==0&&dc(c,a.child,null,k),c.child.memoizedState=C0(k),c.memoizedState=b0,E);if((c.mode&1)===0)return _g(a,c,k,null);if(x.data==="$!"){if(y=x.nextSibling&&x.nextSibling.dataset,y)var U=y.dgst;return y=U,E=Error(t(419)),y=E0(E,y,void 0),_g(a,c,k,y)}if(U=(k&a.childLanes)!==0,ti||U){if(y=cn,y!==null){switch(k&-k){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=(x&(y.suspendedLanes|k))!==0?0:x,x!==0&&x!==E.retryLane&&(E.retryLane=x,Ps(a,x),fr(y,a,x,-1))}return G0(),y=E0(Error(t(421))),_g(a,c,k,y)}return x.data==="$?"?(c.flags|=128,c.child=a.child,c=KM.bind(null,a),x._reactRetry=c,null):(a=E.treeContext,Ei=go(x.nextSibling),wi=c,bt=!0,cr=null,a!==null&&(zi[Ui++]=Rs,zi[Ui++]=As,zi[Ui++]=ba,Rs=a.id,As=a.overflow,ba=c),c=R0(c,y.children),c.flags|=4096,c)}function bT(a,c,d){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),s0(a.return,c,d)}function A0(a,c,d,y,x){var E=a.memoizedState;E===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:d,tailMode:x}:(E.isBackwards=c,E.rendering=null,E.renderingStartTime=0,E.last=y,E.tail=d,E.tailMode=x)}function CT(a,c,d){var y=c.pendingProps,x=y.revealOrder,E=y.tail;if(Kn(a,c,y.children,d),y=At.current,(y&2)!==0)y=y&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&bT(a,d,c);else if(a.tag===19)bT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}if(xt(At,y),(c.mode&1)===0)c.memoizedState=null;else switch(x){case"forwards":for(d=c.child,x=null;d!==null;)a=d.alternate,a!==null&&hg(a)===null&&(x=d),d=d.sibling;d=x,d===null?(x=c.child,c.child=null):(x=d.sibling,d.sibling=null),A0(c,!1,x,d,E);break;case"backwards":for(d=null,x=c.child,c.child=null;x!==null;){if(a=x.alternate,a!==null&&hg(a)===null){c.child=x;break}a=x.sibling,x.sibling=d,d=x,x=a}A0(c,!0,d,null,E);break;case"together":A0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function xg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function Ns(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),ka|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=Io(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=Io(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function LM(a,c,d){switch(c.tag){case 3:TT(c),hc();break;case 5:UE(c);break;case 1:ei(c.type)&&tg(c);break;case 4:l0(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,x=c.memoizedProps.value;xt(ag,y._currentValue),y._currentValue=x;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(xt(At,At.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?IT(a,c,d):(xt(At,At.current&1),a=Ns(a,c,d),a!==null?a.sibling:null);xt(At,At.current&1);break;case 19:if(y=(d&c.childLanes)!==0,(a.flags&128)!==0){if(y)return CT(a,c,d);c.flags|=128}if(x=c.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),xt(At,At.current),y)break;return null;case 22:case 23:return c.lanes=0,vT(a,c,d)}return Ns(a,c,d)}var RT,P0,AT,PT;RT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},P0=function(){},AT=function(a,c,d,y){var x=a.memoizedProps;if(x!==y){a=c.stateNode,Aa(Yr.current);var E=null;switch(d){case"input":x=Pn(a,x),y=Pn(a,y),E=[];break;case"select":x=ne({},x,{value:void 0}),y=ne({},y,{value:void 0}),E=[];break;case"textarea":x=Di(a,x),y=Di(a,y),E=[];break;default:typeof x.onClick!="function"&&typeof y.onClick=="function"&&(a.onclick=Qf)}Gn(d,y);var k;d=null;for(ee in x)if(!y.hasOwnProperty(ee)&&x.hasOwnProperty(ee)&&x[ee]!=null)if(ee==="style"){var U=x[ee];for(k in U)U.hasOwnProperty(k)&&(d||(d={}),d[k]="")}else ee!=="dangerouslySetInnerHTML"&&ee!=="children"&&ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(r.hasOwnProperty(ee)?E||(E=[]):(E=E||[]).push(ee,null));for(ee in y){var $=y[ee];if(U=x?.[ee],y.hasOwnProperty(ee)&&$!==U&&($!=null||U!=null))if(ee==="style")if(U){for(k in U)!U.hasOwnProperty(k)||$&&$.hasOwnProperty(k)||(d||(d={}),d[k]="");for(k in $)$.hasOwnProperty(k)&&U[k]!==$[k]&&(d||(d={}),d[k]=$[k])}else d||(E||(E=[]),E.push(ee,d)),d=$;else ee==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,U=U?U.__html:void 0,$!=null&&U!==$&&(E=E||[]).push(ee,$)):ee==="children"?typeof $!="string"&&typeof $!="number"||(E=E||[]).push(ee,""+$):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&(r.hasOwnProperty(ee)?($!=null&&ee==="onScroll"&&wt("scroll",a),E||U===$||(E=[])):(E=E||[]).push(ee,$))}d&&(E=E||[]).push("style",d);var ee=E;(c.updateQueue=ee)&&(c.flags|=4)}},PT=function(a,c,d,y){d!==y&&(c.flags|=4)};function Th(a,c){if(!bt)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function Mn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,y=0;if(c)for(var x=a.child;x!==null;)d|=x.lanes|x.childLanes,y|=x.subtreeFlags&14680064,y|=x.flags&14680064,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)d|=x.lanes|x.childLanes,y|=x.subtreeFlags,y|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=y,a.childLanes=d,c}function OM(a,c,d){var y=c.pendingProps;switch(Qy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mn(c),null;case 1:return ei(c.type)&&eg(),Mn(c),null;case 3:return y=c.stateNode,mc(),Et(Jn),Et(Nn),h0(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(a===null||a.child===null)&&(sg(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,cr!==null&&(U0(cr),cr=null))),P0(a,c),Mn(c),null;case 5:c0(c);var x=Aa(_h.current);if(d=c.type,a!==null&&c.stateNode!=null)AT(a,c,d,y,x),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(t(166));return Mn(c),null}if(a=Aa(Yr.current),sg(c)){y=c.stateNode,d=c.type;var E=c.memoizedProps;switch(y[Xr]=c,y[fh]=E,a=(c.mode&1)!==0,d){case"dialog":wt("cancel",y),wt("close",y);break;case"iframe":case"object":case"embed":wt("load",y);break;case"video":case"audio":for(x=0;x<uh.length;x++)wt(uh[x],y);break;case"source":wt("error",y);break;case"img":case"image":case"link":wt("error",y),wt("load",y);break;case"details":wt("toggle",y);break;case"input":gn(y,E),wt("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!E.multiple},wt("invalid",y);break;case"textarea":It(y,E),wt("invalid",y)}Gn(d,E),x=null;for(var k in E)if(E.hasOwnProperty(k)){var U=E[k];k==="children"?typeof U=="string"?y.textContent!==U&&(E.suppressHydrationWarning!==!0&&Zf(y.textContent,U,a),x=["children",U]):typeof U=="number"&&y.textContent!==""+U&&(E.suppressHydrationWarning!==!0&&Zf(y.textContent,U,a),x=["children",""+U]):r.hasOwnProperty(k)&&U!=null&&k==="onScroll"&&wt("scroll",y)}switch(d){case"input":Wt(y),Ni(y,E,!0);break;case"textarea":Wt(y),Mi(y);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(y.onclick=Qf)}y=x,c.updateQueue=y,y!==null&&(c.flags|=4)}else{k=x.nodeType===9?x:x.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=k.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof y.is=="string"?a=k.createElement(d,{is:y.is}):(a=k.createElement(d),d==="select"&&(k=a,y.multiple?k.multiple=!0:y.size&&(k.size=y.size))):a=k.createElementNS(a,d),a[Xr]=c,a[fh]=y,RT(a,c,!1,!1),c.stateNode=a;e:{switch(k=_s(d,y),d){case"dialog":wt("cancel",a),wt("close",a),x=y;break;case"iframe":case"object":case"embed":wt("load",a),x=y;break;case"video":case"audio":for(x=0;x<uh.length;x++)wt(uh[x],a);x=y;break;case"source":wt("error",a),x=y;break;case"img":case"image":case"link":wt("error",a),wt("load",a),x=y;break;case"details":wt("toggle",a),x=y;break;case"input":gn(a,y),x=Pn(a,y),wt("invalid",a);break;case"option":x=y;break;case"select":a._wrapperState={wasMultiple:!!y.multiple},x=ne({},y,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,y),x=Di(a,y),wt("invalid",a);break;default:x=y}Gn(d,x),U=x;for(E in U)if(U.hasOwnProperty(E)){var $=U[E];E==="style"?ys(a,$):E==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&ha(a,$)):E==="children"?typeof $=="string"?(d!=="textarea"||$!=="")&&Dr(a,$):typeof $=="number"&&Dr(a,""+$):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(r.hasOwnProperty(E)?$!=null&&E==="onScroll"&&wt("scroll",a):$!=null&&D(a,E,$,k))}switch(d){case"input":Wt(a),Ni(a,y,!1);break;case"textarea":Wt(a),Mi(a);break;case"option":y.value!=null&&a.setAttribute("value",""+be(y.value));break;case"select":a.multiple=!!y.multiple,E=y.value,E!=null?on(a,!!y.multiple,E,!1):y.defaultValue!=null&&on(a,!!y.multiple,y.defaultValue,!0);break;default:typeof x.onClick=="function"&&(a.onclick=Qf)}switch(d){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Mn(c),null;case 6:if(a&&c.stateNode!=null)PT(a,c,a.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(t(166));if(d=Aa(_h.current),Aa(Yr.current),sg(c)){if(y=c.stateNode,d=c.memoizedProps,y[Xr]=c,(E=y.nodeValue!==d)&&(a=wi,a!==null))switch(a.tag){case 3:Zf(y.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Zf(y.nodeValue,d,(a.mode&1)!==0)}E&&(c.flags|=4)}else y=(d.nodeType===9?d:d.ownerDocument).createTextNode(y),y[Xr]=c,c.stateNode=y}return Mn(c),null;case 13:if(Et(At),y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(bt&&Ei!==null&&(c.mode&1)!==0&&(c.flags&128)===0)DE(),hc(),c.flags|=98560,E=!1;else if(E=sg(c),y!==null&&y.dehydrated!==null){if(a===null){if(!E)throw Error(t(318));if(E=c.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[Xr]=c}else hc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Mn(c),E=!1}else cr!==null&&(U0(cr),cr=null),E=!0;if(!E)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(y=y!==null,y!==(a!==null&&a.memoizedState!==null)&&y&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(At.current&1)!==0?en===0&&(en=3):G0())),c.updateQueue!==null&&(c.flags|=4),Mn(c),null);case 4:return mc(),P0(a,c),a===null&&hh(c.stateNode.containerInfo),Mn(c),null;case 10:return r0(c.type._context),Mn(c),null;case 17:return ei(c.type)&&eg(),Mn(c),null;case 19:if(Et(At),E=c.memoizedState,E===null)return Mn(c),null;if(y=(c.flags&128)!==0,k=E.rendering,k===null)if(y)Th(E,!1);else{if(en!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(k=hg(a),k!==null){for(c.flags|=128,Th(E,!1),y=k.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=d,d=c.child;d!==null;)E=d,a=y,E.flags&=14680066,k=E.alternate,k===null?(E.childLanes=0,E.lanes=a,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=k.childLanes,E.lanes=k.lanes,E.child=k.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=k.memoizedProps,E.memoizedState=k.memoizedState,E.updateQueue=k.updateQueue,E.type=k.type,a=k.dependencies,E.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return xt(At,At.current&1|2),c.child}a=a.sibling}E.tail!==null&&vt()>xc&&(c.flags|=128,y=!0,Th(E,!1),c.lanes=4194304)}else{if(!y)if(a=hg(k),a!==null){if(c.flags|=128,y=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),Th(E,!0),E.tail===null&&E.tailMode==="hidden"&&!k.alternate&&!bt)return Mn(c),null}else 2*vt()-E.renderingStartTime>xc&&d!==1073741824&&(c.flags|=128,y=!0,Th(E,!1),c.lanes=4194304);E.isBackwards?(k.sibling=c.child,c.child=k):(d=E.last,d!==null?d.sibling=k:c.child=k,E.last=k)}return E.tail!==null?(c=E.tail,E.rendering=c,E.tail=c.sibling,E.renderingStartTime=vt(),c.sibling=null,d=At.current,xt(At,y?d&1|2:d&1),c):(Mn(c),null);case 22:case 23:return W0(),y=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==y&&(c.flags|=8192),y&&(c.mode&1)!==0?(Ti&1073741824)!==0&&(Mn(c),c.subtreeFlags&6&&(c.flags|=8192)):Mn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function jM(a,c){switch(Qy(c),c.tag){case 1:return ei(c.type)&&eg(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return mc(),Et(Jn),Et(Nn),h0(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return c0(c),null;case 13:if(Et(At),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));hc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Et(At),null;case 4:return mc(),null;case 10:return r0(c.type._context),null;case 22:case 23:return W0(),null;case 24:return null;default:return null}}var vg=!1,Ln=!1,FM=typeof WeakSet=="function"?WeakSet:Set,xe=null;function yc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(y){Mt(a,c,y)}else d.current=null}function k0(a,c,d){try{d()}catch(y){Mt(a,c,y)}}var kT=!1;function VM(a,c){if(Wy=Ts,a=cE(),Ly(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var y=d.getSelection&&d.getSelection();if(y&&y.rangeCount!==0){d=y.anchorNode;var x=y.anchorOffset,E=y.focusNode;y=y.focusOffset;try{d.nodeType,E.nodeType}catch{d=null;break e}var k=0,U=-1,$=-1,ee=0,ae=0,ce=a,oe=null;t:for(;;){for(var ye;ce!==d||x!==0&&ce.nodeType!==3||(U=k+x),ce!==E||y!==0&&ce.nodeType!==3||($=k+y),ce.nodeType===3&&(k+=ce.nodeValue.length),(ye=ce.firstChild)!==null;)oe=ce,ce=ye;for(;;){if(ce===a)break t;if(oe===d&&++ee===x&&(U=k),oe===E&&++ae===y&&($=k),(ye=ce.nextSibling)!==null)break;ce=oe,oe=ce.parentNode}ce=ye}d=U===-1||$===-1?null:{start:U,end:$}}else d=null}d=d||{start:0,end:0}}else d=null;for(Gy={focusedElem:a,selectionRange:d},Ts=!1,xe=c;xe!==null;)if(c=xe,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,xe=a;else for(;xe!==null;){c=xe;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var we=ve.memoizedProps,zt=ve.memoizedState,Y=c.stateNode,q=Y.getSnapshotBeforeUpdate(c.elementType===c.type?we:ur(c.type,we),zt);Y.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var Q=c.stateNode.containerInfo;Q.nodeType===1?Q.textContent="":Q.nodeType===9&&Q.documentElement&&Q.removeChild(Q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Mt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,xe=a;break}xe=c.return}return ve=kT,kT=!1,ve}function Sh(a,c,d){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var x=y=y.next;do{if((x.tag&a)===a){var E=x.destroy;x.destroy=void 0,E!==void 0&&k0(c,d,E)}x=x.next}while(x!==y)}}function wg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var y=d.create;d.destroy=y()}d=d.next}while(d!==c)}}function N0(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function NT(a){var c=a.alternate;c!==null&&(a.alternate=null,NT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Xr],delete c[fh],delete c[qy],delete c[wM],delete c[EM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function DT(a){return a.tag===5||a.tag===3||a.tag===4}function MT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||DT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function D0(a,c,d){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Qf));else if(y!==4&&(a=a.child,a!==null))for(D0(a,c,d),a=a.sibling;a!==null;)D0(a,c,d),a=a.sibling}function M0(a,c,d){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(y!==4&&(a=a.child,a!==null))for(M0(a,c,d),a=a.sibling;a!==null;)M0(a,c,d),a=a.sibling}var wn=null,hr=!1;function vo(a,c,d){for(d=d.child;d!==null;)LT(a,c,d),d=d.sibling}function LT(a,c,d){if(mi&&typeof mi.onCommitFiberUnmount=="function")try{mi.onCommitFiberUnmount(ma,d)}catch{}switch(d.tag){case 5:Ln||yc(d,c);case 6:var y=wn,x=hr;wn=null,vo(a,c,d),wn=y,hr=x,wn!==null&&(hr?(a=wn,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):wn.removeChild(d.stateNode));break;case 18:wn!==null&&(hr?(a=wn,d=d.stateNode,a.nodeType===8?Ky(a.parentNode,d):a.nodeType===1&&Ky(a,d),co(a)):Ky(wn,d.stateNode));break;case 4:y=wn,x=hr,wn=d.stateNode.containerInfo,hr=!0,vo(a,c,d),wn=y,hr=x;break;case 0:case 11:case 14:case 15:if(!Ln&&(y=d.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){x=y=y.next;do{var E=x,k=E.destroy;E=E.tag,k!==void 0&&((E&2)!==0||(E&4)!==0)&&k0(d,c,k),x=x.next}while(x!==y)}vo(a,c,d);break;case 1:if(!Ln&&(yc(d,c),y=d.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=d.memoizedProps,y.state=d.memoizedState,y.componentWillUnmount()}catch(U){Mt(d,c,U)}vo(a,c,d);break;case 21:vo(a,c,d);break;case 22:d.mode&1?(Ln=(y=Ln)||d.memoizedState!==null,vo(a,c,d),Ln=y):vo(a,c,d);break;default:vo(a,c,d)}}function OT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new FM),c.forEach(function(y){var x=qM.bind(null,a,y);d.has(y)||(d.add(y),y.then(x,x))})}}function dr(a,c){var d=c.deletions;if(d!==null)for(var y=0;y<d.length;y++){var x=d[y];try{var E=a,k=c,U=k;e:for(;U!==null;){switch(U.tag){case 5:wn=U.stateNode,hr=!1;break e;case 3:wn=U.stateNode.containerInfo,hr=!0;break e;case 4:wn=U.stateNode.containerInfo,hr=!0;break e}U=U.return}if(wn===null)throw Error(t(160));LT(E,k,x),wn=null,hr=!1;var $=x.alternate;$!==null&&($.return=null),x.return=null}catch(ee){Mt(x,c,ee)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)jT(c,a),c=c.sibling}function jT(a,c){var d=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(dr(c,a),Qr(a),y&4){try{Sh(3,a,a.return),wg(3,a)}catch(we){Mt(a,a.return,we)}try{Sh(5,a,a.return)}catch(we){Mt(a,a.return,we)}}break;case 1:dr(c,a),Qr(a),y&512&&d!==null&&yc(d,d.return);break;case 5:if(dr(c,a),Qr(a),y&512&&d!==null&&yc(d,d.return),a.flags&32){var x=a.stateNode;try{Dr(x,"")}catch(we){Mt(a,a.return,we)}}if(y&4&&(x=a.stateNode,x!=null)){var E=a.memoizedProps,k=d!==null?d.memoizedProps:E,U=a.type,$=a.updateQueue;if(a.updateQueue=null,$!==null)try{U==="input"&&E.type==="radio"&&E.name!=null&&mn(x,E),_s(U,k);var ee=_s(U,E);for(k=0;k<$.length;k+=2){var ae=$[k],ce=$[k+1];ae==="style"?ys(x,ce):ae==="dangerouslySetInnerHTML"?ha(x,ce):ae==="children"?Dr(x,ce):D(x,ae,ce,ee)}switch(U){case"input":Qn(x,E);break;case"textarea":io(x,E);break;case"select":var oe=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!E.multiple;var ye=E.value;ye!=null?on(x,!!E.multiple,ye,!1):oe!==!!E.multiple&&(E.defaultValue!=null?on(x,!!E.multiple,E.defaultValue,!0):on(x,!!E.multiple,E.multiple?[]:"",!1))}x[fh]=E}catch(we){Mt(a,a.return,we)}}break;case 6:if(dr(c,a),Qr(a),y&4){if(a.stateNode===null)throw Error(t(162));x=a.stateNode,E=a.memoizedProps;try{x.nodeValue=E}catch(we){Mt(a,a.return,we)}}break;case 3:if(dr(c,a),Qr(a),y&4&&d!==null&&d.memoizedState.isDehydrated)try{co(c.containerInfo)}catch(we){Mt(a,a.return,we)}break;case 4:dr(c,a),Qr(a);break;case 13:dr(c,a),Qr(a),x=a.child,x.flags&8192&&(E=x.memoizedState!==null,x.stateNode.isHidden=E,!E||x.alternate!==null&&x.alternate.memoizedState!==null||(j0=vt())),y&4&&OT(a);break;case 22:if(ae=d!==null&&d.memoizedState!==null,a.mode&1?(Ln=(ee=Ln)||ae,dr(c,a),Ln=ee):dr(c,a),Qr(a),y&8192){if(ee=a.memoizedState!==null,(a.stateNode.isHidden=ee)&&!ae&&(a.mode&1)!==0)for(xe=a,ae=a.child;ae!==null;){for(ce=xe=ae;xe!==null;){switch(oe=xe,ye=oe.child,oe.tag){case 0:case 11:case 14:case 15:Sh(4,oe,oe.return);break;case 1:yc(oe,oe.return);var ve=oe.stateNode;if(typeof ve.componentWillUnmount=="function"){y=oe,d=oe.return;try{c=y,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(we){Mt(y,d,we)}}break;case 5:yc(oe,oe.return);break;case 22:if(oe.memoizedState!==null){zT(ce);continue}}ye!==null?(ye.return=oe,xe=ye):zT(ce)}ae=ae.sibling}e:for(ae=null,ce=a;;){if(ce.tag===5){if(ae===null){ae=ce;try{x=ce.stateNode,ee?(E=x.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(U=ce.stateNode,$=ce.memoizedProps.style,k=$!=null&&$.hasOwnProperty("display")?$.display:null,U.style.display=Mr("display",k))}catch(we){Mt(a,a.return,we)}}}else if(ce.tag===6){if(ae===null)try{ce.stateNode.nodeValue=ee?"":ce.memoizedProps}catch(we){Mt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;ae===ce&&(ae=null),ce=ce.return}ae===ce&&(ae=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:dr(c,a),Qr(a),y&4&&OT(a);break;case 21:break;default:dr(c,a),Qr(a)}}function Qr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(DT(d)){var y=d;break e}d=d.return}throw Error(t(160))}switch(y.tag){case 5:var x=y.stateNode;y.flags&32&&(Dr(x,""),y.flags&=-33);var E=MT(a);M0(a,E,x);break;case 3:case 4:var k=y.stateNode.containerInfo,U=MT(a);D0(a,U,k);break;default:throw Error(t(161))}}catch($){Mt(a,a.return,$)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function zM(a,c,d){xe=a,FT(a)}function FT(a,c,d){for(var y=(a.mode&1)!==0;xe!==null;){var x=xe,E=x.child;if(x.tag===22&&y){var k=x.memoizedState!==null||vg;if(!k){var U=x.alternate,$=U!==null&&U.memoizedState!==null||Ln;U=vg;var ee=Ln;if(vg=k,(Ln=$)&&!ee)for(xe=x;xe!==null;)k=xe,$=k.child,k.tag===22&&k.memoizedState!==null?UT(x):$!==null?($.return=k,xe=$):UT(x);for(;E!==null;)xe=E,FT(E),E=E.sibling;xe=x,vg=U,Ln=ee}VT(a)}else(x.subtreeFlags&8772)!==0&&E!==null?(E.return=x,xe=E):VT(a)}}function VT(a){for(;xe!==null;){var c=xe;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Ln||wg(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!Ln)if(d===null)y.componentDidMount();else{var x=c.elementType===c.type?d.memoizedProps:ur(c.type,d.memoizedProps);y.componentDidUpdate(x,d.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var E=c.updateQueue;E!==null&&zE(c,E,y);break;case 3:var k=c.updateQueue;if(k!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}zE(c,k,d)}break;case 5:var U=c.stateNode;if(d===null&&c.flags&4){d=U;var $=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&d.focus();break;case"img":$.src&&(d.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ee=c.alternate;if(ee!==null){var ae=ee.memoizedState;if(ae!==null){var ce=ae.dehydrated;ce!==null&&co(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ln||c.flags&512&&N0(c)}catch(oe){Mt(c,c.return,oe)}}if(c===a){xe=null;break}if(d=c.sibling,d!==null){d.return=c.return,xe=d;break}xe=c.return}}function zT(a){for(;xe!==null;){var c=xe;if(c===a){xe=null;break}var d=c.sibling;if(d!==null){d.return=c.return,xe=d;break}xe=c.return}}function UT(a){for(;xe!==null;){var c=xe;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{wg(4,c)}catch($){Mt(c,d,$)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var x=c.return;try{y.componentDidMount()}catch($){Mt(c,x,$)}}var E=c.return;try{N0(c)}catch($){Mt(c,E,$)}break;case 5:var k=c.return;try{N0(c)}catch($){Mt(c,k,$)}}}catch($){Mt(c,c.return,$)}if(c===a){xe=null;break}var U=c.sibling;if(U!==null){U.return=c.return,xe=U;break}xe=c.return}}var UM=Math.ceil,Eg=L.ReactCurrentDispatcher,L0=L.ReactCurrentOwner,Gi=L.ReactCurrentBatchConfig,tt=0,cn=null,Ht=null,En=0,Ti=0,_c=mo(0),en=0,Ih=null,ka=0,Tg=0,O0=0,bh=null,ni=null,j0=0,xc=1/0,Ds=null,Sg=!1,F0=null,wo=null,Ig=!1,Eo=null,bg=0,Ch=0,V0=null,Cg=-1,Rg=0;function qn(){return(tt&6)!==0?vt():Cg!==-1?Cg:Cg=vt()}function To(a){return(a.mode&1)===0?1:(tt&2)!==0&&En!==0?En&-En:SM.transition!==null?(Rg===0&&(Rg=qu()),Rg):(a=Ye,a!==0||(a=window.event,a=a===void 0?16:ql(a.type)),a)}function fr(a,c,d,y){if(50<Ch)throw Ch=0,V0=null,Error(t(185));xa(a,d,y),((tt&2)===0||a!==cn)&&(a===cn&&((tt&2)===0&&(Tg|=d),en===4&&So(a,En)),ii(a,y),d===1&&tt===0&&(c.mode&1)===0&&(xc=vt()+500,ng&&yo()))}function ii(a,c){var d=a.callbackNode;_a(a,c);var y=vs(a,a===cn?En:0);if(y===0)d!==null&&Ul(d),a.callbackNode=null,a.callbackPriority=0;else if(c=y&-y,a.callbackPriority!==c){if(d!=null&&Ul(d),c===1)a.tag===0?TM(WT.bind(null,a)):RE(WT.bind(null,a)),xM(function(){(tt&6)===0&&yo()}),d=null;else{switch(Vr(y)){case 1:d=Bl;break;case 4:d=$u;break;case 16:d=ga;break;case 536870912:d=Wl;break;default:d=ga}d=ZT(d,BT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function BT(a,c){if(Cg=-1,Rg=0,(tt&6)!==0)throw Error(t(327));var d=a.callbackNode;if(vc()&&a.callbackNode!==d)return null;var y=vs(a,a===cn?En:0);if(y===0)return null;if((y&30)!==0||(y&a.expiredLanes)!==0||c)c=Ag(a,y);else{c=y;var x=tt;tt|=2;var E=$T();(cn!==a||En!==c)&&(Ds=null,xc=vt()+500,Da(a,c));do try{GM();break}catch(U){GT(a,U)}while(!0);i0(),Eg.current=E,tt=x,Ht!==null?c=0:(cn=null,En=0,c=en)}if(c!==0){if(c===2&&(x=Ku(a),x!==0&&(y=x,c=z0(a,x))),c===1)throw d=Ih,Da(a,0),So(a,y),ii(a,vt()),d;if(c===6)So(a,y);else{if(x=a.current.alternate,(y&30)===0&&!BM(x)&&(c=Ag(a,y),c===2&&(E=Ku(a),E!==0&&(y=E,c=z0(a,E))),c===1))throw d=Ih,Da(a,0),So(a,y),ii(a,vt()),d;switch(a.finishedWork=x,a.finishedLanes=y,c){case 0:case 1:throw Error(t(345));case 2:Ma(a,ni,Ds);break;case 3:if(So(a,y),(y&130023424)===y&&(c=j0+500-vt(),10<c)){if(vs(a,0)!==0)break;if(x=a.suspendedLanes,(x&y)!==y){qn(),a.pingedLanes|=a.suspendedLanes&x;break}a.timeoutHandle=Hy(Ma.bind(null,a,ni,Ds),c);break}Ma(a,ni,Ds);break;case 4:if(So(a,y),(y&4194240)===y)break;for(c=a.eventTimes,x=-1;0<y;){var k=31-pi(y);E=1<<k,k=c[k],k>x&&(x=k),y&=~E}if(y=x,y=vt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*UM(y/1960))-y,10<y){a.timeoutHandle=Hy(Ma.bind(null,a,ni,Ds),y);break}Ma(a,ni,Ds);break;case 5:Ma(a,ni,Ds);break;default:throw Error(t(329))}}}return ii(a,vt()),a.callbackNode===d?BT.bind(null,a):null}function z0(a,c){var d=bh;return a.current.memoizedState.isDehydrated&&(Da(a,c).flags|=256),a=Ag(a,c),a!==2&&(c=ni,ni=d,c!==null&&U0(c)),a}function U0(a){ni===null?ni=a:ni.push.apply(ni,a)}function BM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var y=0;y<d.length;y++){var x=d[y],E=x.getSnapshot;x=x.value;try{if(!lr(E(),x))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function So(a,c){for(c&=~O0,c&=~Tg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-pi(c),y=1<<d;a[d]=-1,c&=~y}}function WT(a){if((tt&6)!==0)throw Error(t(327));vc();var c=vs(a,0);if((c&1)===0)return ii(a,vt()),null;var d=Ag(a,c);if(a.tag!==0&&d===2){var y=Ku(a);y!==0&&(c=y,d=z0(a,y))}if(d===1)throw d=Ih,Da(a,0),So(a,c),ii(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Ma(a,ni,Ds),ii(a,vt()),null}function B0(a,c){var d=tt;tt|=1;try{return a(c)}finally{tt=d,tt===0&&(xc=vt()+500,ng&&yo())}}function Na(a){Eo!==null&&Eo.tag===0&&(tt&6)===0&&vc();var c=tt;tt|=1;var d=Gi.transition,y=Ye;try{if(Gi.transition=null,Ye=1,a)return a()}finally{Ye=y,Gi.transition=d,tt=c,(tt&6)===0&&yo()}}function W0(){Ti=_c.current,Et(_c)}function Da(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,_M(d)),Ht!==null)for(d=Ht.return;d!==null;){var y=d;switch(Qy(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&eg();break;case 3:mc(),Et(Jn),Et(Nn),h0();break;case 5:c0(y);break;case 4:mc();break;case 13:Et(At);break;case 19:Et(At);break;case 10:r0(y.type._context);break;case 22:case 23:W0()}d=d.return}if(cn=a,Ht=a=Io(a.current,null),En=Ti=c,en=0,Ih=null,O0=Tg=ka=0,ni=bh=null,Ra!==null){for(c=0;c<Ra.length;c++)if(d=Ra[c],y=d.interleaved,y!==null){d.interleaved=null;var x=y.next,E=d.pending;if(E!==null){var k=E.next;E.next=x,y.next=k}d.pending=y}Ra=null}return a}function GT(a,c){do{var d=Ht;try{if(i0(),dg.current=pg,fg){for(var y=Pt.memoizedState;y!==null;){var x=y.queue;x!==null&&(x.pending=null),y=y.next}fg=!1}if(Pa=0,ln=Jt=Pt=null,xh=!1,vh=0,L0.current=null,d===null||d.return===null){en=1,Ih=c,Ht=null;break}e:{var E=a,k=d.return,U=d,$=c;if(c=En,U.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var ee=$,ae=U,ce=ae.tag;if((ae.mode&1)===0&&(ce===0||ce===11||ce===15)){var oe=ae.alternate;oe?(ae.updateQueue=oe.updateQueue,ae.memoizedState=oe.memoizedState,ae.lanes=oe.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var ye=mT(k);if(ye!==null){ye.flags&=-257,pT(ye,k,U,E,c),ye.mode&1&&gT(E,ee,c),c=ye,$=ee;var ve=c.updateQueue;if(ve===null){var we=new Set;we.add($),c.updateQueue=we}else ve.add($);break e}else{if((c&1)===0){gT(E,ee,c),G0();break e}$=Error(t(426))}}else if(bt&&U.mode&1){var zt=mT(k);if(zt!==null){(zt.flags&65536)===0&&(zt.flags|=256),pT(zt,k,U,E,c),t0(pc($,U));break e}}E=$=pc($,U),en!==4&&(en=2),bh===null?bh=[E]:bh.push(E),E=k;do{switch(E.tag){case 3:E.flags|=65536,c&=-c,E.lanes|=c;var Y=dT(E,$,c);VE(E,Y);break e;case 1:U=$;var q=E.type,Q=E.stateNode;if((E.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(wo===null||!wo.has(Q)))){E.flags|=65536,c&=-c,E.lanes|=c;var he=fT(E,U,c);VE(E,he);break e}}E=E.return}while(E!==null)}KT(d)}catch(Se){c=Se,Ht===d&&d!==null&&(Ht=d=d.return);continue}break}while(!0)}function $T(){var a=Eg.current;return Eg.current=pg,a===null?pg:a}function G0(){(en===0||en===3||en===2)&&(en=4),cn===null||(ka&268435455)===0&&(Tg&268435455)===0||So(cn,En)}function Ag(a,c){var d=tt;tt|=2;var y=$T();(cn!==a||En!==c)&&(Ds=null,Da(a,c));do try{WM();break}catch(x){GT(a,x)}while(!0);if(i0(),tt=d,Eg.current=y,Ht!==null)throw Error(t(261));return cn=null,En=0,en}function WM(){for(;Ht!==null;)HT(Ht)}function GM(){for(;Ht!==null&&!fa();)HT(Ht)}function HT(a){var c=YT(a.alternate,a,Ti);a.memoizedProps=a.pendingProps,c===null?KT(a):Ht=c,L0.current=null}function KT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=OM(d,c,Ti),d!==null){Ht=d;return}}else{if(d=jM(d,c),d!==null){d.flags&=32767,Ht=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{en=6,Ht=null;return}}if(c=c.sibling,c!==null){Ht=c;return}Ht=c=a}while(c!==null);en===0&&(en=5)}function Ma(a,c,d){var y=Ye,x=Gi.transition;try{Gi.transition=null,Ye=1,$M(a,c,d,y)}finally{Gi.transition=x,Ye=y}return null}function $M(a,c,d,y){do vc();while(Eo!==null);if((tt&6)!==0)throw Error(t(327));d=a.finishedWork;var x=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var E=d.lanes|d.childLanes;if(Py(a,E),a===cn&&(Ht=cn=null,En=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Ig||(Ig=!0,ZT(ga,function(){return vc(),null})),E=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||E){E=Gi.transition,Gi.transition=null;var k=Ye;Ye=1;var U=tt;tt|=4,L0.current=null,VM(a,d),jT(d,a),hM(Gy),Ts=!!Wy,Gy=Wy=null,a.current=d,zM(d),xs(),tt=U,Ye=k,Gi.transition=E}else a.current=d;if(Ig&&(Ig=!1,Eo=a,bg=x),E=a.pendingLanes,E===0&&(wo=null),Of(d.stateNode),ii(a,vt()),c!==null)for(y=a.onRecoverableError,d=0;d<c.length;d++)x=c[d],y(x.value,{componentStack:x.stack,digest:x.digest});if(Sg)throw Sg=!1,a=F0,F0=null,a;return(bg&1)!==0&&a.tag!==0&&vc(),E=a.pendingLanes,(E&1)!==0?a===V0?Ch++:(Ch=0,V0=a):Ch=0,yo(),null}function vc(){if(Eo!==null){var a=Vr(bg),c=Gi.transition,d=Ye;try{if(Gi.transition=null,Ye=16>a?16:a,Eo===null)var y=!1;else{if(a=Eo,Eo=null,bg=0,(tt&6)!==0)throw Error(t(331));var x=tt;for(tt|=4,xe=a.current;xe!==null;){var E=xe,k=E.child;if((xe.flags&16)!==0){var U=E.deletions;if(U!==null){for(var $=0;$<U.length;$++){var ee=U[$];for(xe=ee;xe!==null;){var ae=xe;switch(ae.tag){case 0:case 11:case 15:Sh(8,ae,E)}var ce=ae.child;if(ce!==null)ce.return=ae,xe=ce;else for(;xe!==null;){ae=xe;var oe=ae.sibling,ye=ae.return;if(NT(ae),ae===ee){xe=null;break}if(oe!==null){oe.return=ye,xe=oe;break}xe=ye}}}var ve=E.alternate;if(ve!==null){var we=ve.child;if(we!==null){ve.child=null;do{var zt=we.sibling;we.sibling=null,we=zt}while(we!==null)}}xe=E}}if((E.subtreeFlags&2064)!==0&&k!==null)k.return=E,xe=k;else e:for(;xe!==null;){if(E=xe,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:Sh(9,E,E.return)}var Y=E.sibling;if(Y!==null){Y.return=E.return,xe=Y;break e}xe=E.return}}var q=a.current;for(xe=q;xe!==null;){k=xe;var Q=k.child;if((k.subtreeFlags&2064)!==0&&Q!==null)Q.return=k,xe=Q;else e:for(k=q;xe!==null;){if(U=xe,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:wg(9,U)}}catch(Se){Mt(U,U.return,Se)}if(U===k){xe=null;break e}var he=U.sibling;if(he!==null){he.return=U.return,xe=he;break e}xe=U.return}}if(tt=x,yo(),mi&&typeof mi.onPostCommitFiberRoot=="function")try{mi.onPostCommitFiberRoot(ma,a)}catch{}y=!0}return y}finally{Ye=d,Gi.transition=c}}return!1}function qT(a,c,d){c=pc(d,c),c=dT(a,c,1),a=xo(a,c,1),c=qn(),a!==null&&(xa(a,1,c),ii(a,c))}function Mt(a,c,d){if(a.tag===3)qT(a,a,d);else for(;c!==null;){if(c.tag===3){qT(c,a,d);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(wo===null||!wo.has(y))){a=pc(d,a),a=fT(c,a,1),c=xo(c,a,1),a=qn(),c!==null&&(xa(c,1,a),ii(c,a));break}}c=c.return}}function HM(a,c,d){var y=a.pingCache;y!==null&&y.delete(c),c=qn(),a.pingedLanes|=a.suspendedLanes&d,cn===a&&(En&d)===d&&(en===4||en===3&&(En&130023424)===En&&500>vt()-j0?Da(a,0):O0|=d),ii(a,c)}function XT(a,c){c===0&&((a.mode&1)===0?c=1:(c=oo,oo<<=1,(oo&130023424)===0&&(oo=4194304)));var d=qn();a=Ps(a,c),a!==null&&(xa(a,c,d),ii(a,d))}function KM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),XT(a,d)}function qM(a,c){var d=0;switch(a.tag){case 13:var y=a.stateNode,x=a.memoizedState;x!==null&&(d=x.retryLane);break;case 19:y=a.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(c),XT(a,d)}var YT;YT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Jn.current)ti=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return ti=!1,LM(a,c,d);ti=(a.flags&131072)!==0}else ti=!1,bt&&(c.flags&1048576)!==0&&AE(c,rg,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;xg(a,c),a=c.pendingProps;var x=lc(c,Nn.current);gc(c,d),x=g0(null,c,y,a,x,d);var E=m0();return c.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,ei(y)?(E=!0,tg(c)):E=!1,c.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,a0(c),x.updater=yg,c.stateNode=x,x._reactInternals=c,w0(c,y,a,d),c=I0(null,c,y,!0,E,d)):(c.tag=0,bt&&E&&Zy(c),Kn(null,c,x,d),c=c.child),c;case 16:y=c.elementType;e:{switch(xg(a,c),a=c.pendingProps,x=y._init,y=x(y._payload),c.type=y,x=c.tag=YM(y),a=ur(y,a),x){case 0:c=S0(null,c,y,a,d);break e;case 1:c=ET(null,c,y,a,d);break e;case 11:c=yT(null,c,y,a,d);break e;case 14:c=_T(null,c,y,ur(y.type,a),d);break e}throw Error(t(306,y,""))}return c;case 0:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:ur(y,x),S0(a,c,y,x,d);case 1:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:ur(y,x),ET(a,c,y,x,d);case 3:e:{if(TT(c),a===null)throw Error(t(387));y=c.pendingProps,E=c.memoizedState,x=E.element,FE(a,c),ug(c,y,null,d);var k=c.memoizedState;if(y=k.element,E.isDehydrated)if(E={element:y,isDehydrated:!1,cache:k.cache,pendingSuspenseBoundaries:k.pendingSuspenseBoundaries,transitions:k.transitions},c.updateQueue.baseState=E,c.memoizedState=E,c.flags&256){x=pc(Error(t(423)),c),c=ST(a,c,y,d,x);break e}else if(y!==x){x=pc(Error(t(424)),c),c=ST(a,c,y,d,x);break e}else for(Ei=go(c.stateNode.containerInfo.firstChild),wi=c,bt=!0,cr=null,d=OE(c,null,y,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(hc(),y===x){c=Ns(a,c,d);break e}Kn(a,c,y,d)}c=c.child}return c;case 5:return UE(c),a===null&&e0(c),y=c.type,x=c.pendingProps,E=a!==null?a.memoizedProps:null,k=x.children,$y(y,x)?k=null:E!==null&&$y(y,E)&&(c.flags|=32),wT(a,c),Kn(a,c,k,d),c.child;case 6:return a===null&&e0(c),null;case 13:return IT(a,c,d);case 4:return l0(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=dc(c,null,y,d):Kn(a,c,y,d),c.child;case 11:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:ur(y,x),yT(a,c,y,x,d);case 7:return Kn(a,c,c.pendingProps,d),c.child;case 8:return Kn(a,c,c.pendingProps.children,d),c.child;case 12:return Kn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(y=c.type._context,x=c.pendingProps,E=c.memoizedProps,k=x.value,xt(ag,y._currentValue),y._currentValue=k,E!==null)if(lr(E.value,k)){if(E.children===x.children&&!Jn.current){c=Ns(a,c,d);break e}}else for(E=c.child,E!==null&&(E.return=c);E!==null;){var U=E.dependencies;if(U!==null){k=E.child;for(var $=U.firstContext;$!==null;){if($.context===y){if(E.tag===1){$=ks(-1,d&-d),$.tag=2;var ee=E.updateQueue;if(ee!==null){ee=ee.shared;var ae=ee.pending;ae===null?$.next=$:($.next=ae.next,ae.next=$),ee.pending=$}}E.lanes|=d,$=E.alternate,$!==null&&($.lanes|=d),s0(E.return,d,c),U.lanes|=d;break}$=$.next}}else if(E.tag===10)k=E.type===c.type?null:E.child;else if(E.tag===18){if(k=E.return,k===null)throw Error(t(341));k.lanes|=d,U=k.alternate,U!==null&&(U.lanes|=d),s0(k,d,c),k=E.sibling}else k=E.child;if(k!==null)k.return=E;else for(k=E;k!==null;){if(k===c){k=null;break}if(E=k.sibling,E!==null){E.return=k.return,k=E;break}k=k.return}E=k}Kn(a,c,x.children,d),c=c.child}return c;case 9:return x=c.type,y=c.pendingProps.children,gc(c,d),x=Bi(x),y=y(x),c.flags|=1,Kn(a,c,y,d),c.child;case 14:return y=c.type,x=ur(y,c.pendingProps),x=ur(y.type,x),_T(a,c,y,x,d);case 15:return xT(a,c,c.type,c.pendingProps,d);case 17:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:ur(y,x),xg(a,c),c.tag=1,ei(y)?(a=!0,tg(c)):a=!1,gc(c,d),uT(c,y,x),w0(c,y,x,d),I0(null,c,y,!0,a,d);case 19:return CT(a,c,d);case 22:return vT(a,c,d)}throw Error(t(156,c.tag))};function ZT(a,c){return Gu(a,c)}function XM(a,c,d,y){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $i(a,c,d,y){return new XM(a,c,d,y)}function $0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function YM(a){if(typeof a=="function")return $0(a)?1:0;if(a!=null){if(a=a.$$typeof,a===B)return 11;if(a===me)return 14}return 2}function Io(a,c){var d=a.alternate;return d===null?(d=$i(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function Pg(a,c,d,y,x,E){var k=2;if(y=a,typeof a=="function")$0(a)&&(k=1);else if(typeof a=="string")k=5;else e:switch(a){case A:return La(d.children,x,E,c);case b:k=8,x|=8;break;case P:return a=$i(12,d,c,x|2),a.elementType=P,a.lanes=E,a;case O:return a=$i(13,d,c,x),a.elementType=O,a.lanes=E,a;case se:return a=$i(19,d,c,x),a.elementType=se,a.lanes=E,a;case ue:return kg(d,x,E,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case j:k=10;break e;case z:k=9;break e;case B:k=11;break e;case me:k=14;break e;case pe:k=16,y=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=$i(k,d,c,x),c.elementType=a,c.type=y,c.lanes=E,c}function La(a,c,d,y){return a=$i(7,a,y,c),a.lanes=d,a}function kg(a,c,d,y){return a=$i(22,a,y,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function H0(a,c,d){return a=$i(6,a,null,c),a.lanes=d,a}function K0(a,c,d){return c=$i(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function ZM(a,c,d,y,x){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xu(0),this.expirationTimes=Xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xu(0),this.identifierPrefix=y,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function q0(a,c,d,y,x,E,k,U,$){return a=new ZM(a,c,d,U,$),c===1?(c=1,E===!0&&(c|=8)):c=0,E=$i(3,null,null,c),a.current=E,E.stateNode=a,E.memoizedState={element:y,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},a0(E),a}function QM(a,c,d){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:V,key:y==null?null:""+y,children:a,containerInfo:c,implementation:d}}function QT(a){if(!a)return po;a=a._reactInternals;e:{if(or(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(ei(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(ei(d))return bE(a,d,c)}return c}function JT(a,c,d,y,x,E,k,U,$){return a=q0(d,y,!0,a,x,E,k,U,$),a.context=QT(null),d=a.current,y=qn(),x=To(d),E=ks(y,x),E.callback=c??null,xo(d,E,x),a.current.lanes=x,xa(a,x,y),ii(a,y),a}function Ng(a,c,d,y){var x=c.current,E=qn(),k=To(x);return d=QT(d),c.context===null?c.context=d:c.pendingContext=d,c=ks(E,k),c.payload={element:a},y=y===void 0?null:y,y!==null&&(c.callback=y),a=xo(x,c,k),a!==null&&(fr(a,x,k,E),cg(a,x,k)),k}function Dg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function eS(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function X0(a,c){eS(a,c),(a=a.alternate)&&eS(a,c)}function JM(){return null}var tS=typeof reportError=="function"?reportError:function(a){console.error(a)};function Y0(a){this._internalRoot=a}Mg.prototype.render=Y0.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Ng(a,c,null,null)},Mg.prototype.unmount=Y0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Na(function(){Ng(null,a,null,null)}),c[bs]=null}};function Mg(a){this._internalRoot=a}Mg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Ju();a={blockedOn:null,target:a,priority:c};for(var d=0;d<yi.length&&c!==0&&c<yi[d].priority;d++);yi.splice(d,0,a),d===0&&Hl(a)}};function Z0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Lg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function nS(){}function eL(a,c,d,y,x){if(x){if(typeof y=="function"){var E=y;y=function(){var ee=Dg(k);E.call(ee)}}var k=JT(c,y,a,0,null,!1,!1,"",nS);return a._reactRootContainer=k,a[bs]=k.current,hh(a.nodeType===8?a.parentNode:a),Na(),k}for(;x=a.lastChild;)a.removeChild(x);if(typeof y=="function"){var U=y;y=function(){var ee=Dg($);U.call(ee)}}var $=q0(a,0,!1,null,null,!1,!1,"",nS);return a._reactRootContainer=$,a[bs]=$.current,hh(a.nodeType===8?a.parentNode:a),Na(function(){Ng(c,$,d,y)}),$}function Og(a,c,d,y,x){var E=d._reactRootContainer;if(E){var k=E;if(typeof x=="function"){var U=x;x=function(){var $=Dg(k);U.call($)}}Ng(c,k,a,x)}else k=eL(d,c,a,x,y);return Dg(k)}Zu=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=at(c.pendingLanes);d!==0&&(Yu(c,d|1),ii(c,vt()),(tt&6)===0&&(xc=vt()+500,yo()))}break;case 13:Na(function(){var y=Ps(a,1);if(y!==null){var x=qn();fr(y,a,1,x)}}),X0(a,1)}},Gl=function(a){if(a.tag===13){var c=Ps(a,134217728);if(c!==null){var d=qn();fr(c,a,134217728,d)}X0(a,134217728)}},Qu=function(a){if(a.tag===13){var c=To(a),d=Ps(a,c);if(d!==null){var y=qn();fr(d,a,c,y)}X0(a,c)}},Ju=function(){return Ye},eh=function(a,c){var d=Ye;try{return Ye=a,c()}finally{Ye=d}},$n=function(a,c,d){switch(c){case"input":if(Qn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var y=d[c];if(y!==a&&y.form===a.form){var x=Jf(y);if(!x)throw Error(t(90));Wn(y),Qn(y,x)}}}break;case"textarea":io(a,d);break;case"select":c=d.value,c!=null&&on(a,!!d.multiple,c,!1)}},Oi=B0,pn=Na;var tL={usingClientEntryPoint:!1,Events:[gh,oc,Jf,sr,jt,B0]},Rh={findFiberByHostInstance:Sa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nL={bundleType:Rh.bundleType,version:Rh.version,rendererPackageName:Rh.rendererPackageName,rendererConfig:Rh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Lf(a),a===null?null:a.stateNode},findFiberByHostInstance:Rh.findFiberByHostInstance||JM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jg.isDisabled&&jg.supportsFiber)try{ma=jg.inject(nL),mi=jg}catch{}}return ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tL,ri.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z0(c))throw Error(t(200));return QM(a,c,null,d)},ri.createRoot=function(a,c){if(!Z0(a))throw Error(t(299));var d=!1,y="",x=tS;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(x=c.onRecoverableError)),c=q0(a,1,!1,null,null,d,!1,y,x),a[bs]=c.current,hh(a.nodeType===8?a.parentNode:a),new Y0(c)},ri.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Lf(c),a=a===null?null:a.stateNode,a},ri.flushSync=function(a){return Na(a)},ri.hydrate=function(a,c,d){if(!Lg(c))throw Error(t(200));return Og(null,a,c,!0,d)},ri.hydrateRoot=function(a,c,d){if(!Z0(a))throw Error(t(405));var y=d!=null&&d.hydratedSources||null,x=!1,E="",k=tS;if(d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(E=d.identifierPrefix),d.onRecoverableError!==void 0&&(k=d.onRecoverableError)),c=JT(c,null,a,1,d??null,x,!1,E,k),a[bs]=c.current,hh(a),y)for(a=0;a<y.length;a++)d=y[a],x=d._getVersion,x=x(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,x]:c.mutableSourceEagerHydrationData.push(d,x);return new Mg(c)},ri.render=function(a,c,d){if(!Lg(c))throw Error(t(200));return Og(null,a,c,!1,d)},ri.unmountComponentAtNode=function(a){if(!Lg(a))throw Error(t(40));return a._reactRootContainer?(Na(function(){Og(null,null,a,!1,function(){a._reactRootContainer=null,a[bs]=null})}),!0):!1},ri.unstable_batchedUpdates=B0,ri.unstable_renderSubtreeIntoContainer=function(a,c,d,y){if(!Lg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Og(a,c,d,!1,y)},ri.version="18.3.1-next-f1338f8080-20240426",ri}var uS;function uL(){if(uS)return e_.exports;uS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),e_.exports=cL(),e_.exports}var hS;function hL(){if(hS)return Fg;hS=1;var n=uL();return Fg.createRoot=n.createRoot,Fg.hydrateRoot=n.hydrateRoot,Fg}var dL=hL();const fL=Dv(dL);var K=rf();const gL=Dv(K),Mv=K.createContext({});function Lv(n){const e=K.useRef(null);return e.current===null&&(e.current=n()),e.current}const kp=K.createContext(null),Ov=K.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class mL extends K.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function pL({children:n,isPresent:e}){const t=K.useId(),i=K.useRef(null),r=K.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=K.useContext(Ov);return K.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),g.jsx(mL,{isPresent:e,childRef:i,sizeRef:r,children:K.cloneElement(n,{ref:i})})}const yL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Lv(_L),u=K.useId(),h=K.useCallback(p=>{l.set(p,!0);for(const _ of l.values())if(!_)return;i&&i()},[l,i]),f=K.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return K.useMemo(()=>{l.forEach((p,_)=>l.set(_,!1))},[t]),K.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=g.jsx(pL,{isPresent:t,children:n})),g.jsx(kp.Provider,{value:f,children:n})};function _L(){return new Map}function H2(n=!0){const e=K.useContext(kp);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=K.useId();K.useEffect(()=>{n&&r(s)},[n]);const o=K.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Vg=n=>n.key||"";function dS(n){const e=[];return K.Children.forEach(n,t=>{K.isValidElement(t)&&e.push(t)}),e}const jv=typeof window<"u",K2=jv?K.useLayoutEffect:K.useEffect,Xt=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=H2(o),h=K.useMemo(()=>dS(n),[n]),f=o&&!l?[]:h.map(Vg),p=K.useRef(!0),_=K.useRef(h),v=Lv(()=>new Map),[S,I]=K.useState(h),[w,R]=K.useState(h);K2(()=>{p.current=!1,_.current=h;for(let L=0;L<w.length;L++){const N=Vg(w[L]);f.includes(N)?v.delete(N):v.get(N)!==!0&&v.set(N,!1)}},[w,f.length,f.join("-")]);const M=[];if(h!==S){let L=[...h];for(let N=0;N<w.length;N++){const V=w[N],A=Vg(V);f.includes(A)||(L.splice(N,0,V),M.push(V))}s==="wait"&&M.length&&(L=M),R(dS(L)),I(h);return}const{forceRender:D}=K.useContext(Mv);return g.jsx(g.Fragment,{children:w.map(L=>{const N=Vg(L),V=o&&!l?!1:h===w||f.includes(N),A=()=>{if(v.has(N))v.set(N,!0);else return;let b=!0;v.forEach(P=>{P||(b=!1)}),b&&(D?.(),R(_.current),o&&u?.(),i&&i())};return g.jsx(yL,{isPresent:V,initial:!p.current||t?void 0:!1,custom:V?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:V?void 0:A,children:L},N)})})},Ri=n=>n;let q2=Ri;function Fv(n){let e;return()=>(e===void 0&&(e=n()),e)}const ou=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},Ws=n=>n*1e3,Gs=n=>n/1e3,xL={useManualTiming:!1};function vL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const v=p&&i?e:t;return f&&s.add(h),v.has(h)||v.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const zg=["read","resolveKeyframes","update","preRender","render","postRender"],wL=40;function X2(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=zg.reduce((R,M)=>(R[M]=vL(s),R),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:_}=o,v=()=>{const R=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(R-r.timestamp,wL),1),r.timestamp=R,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),_.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(v))},S=()=>{t=!0,i=!0,r.isProcessing||n(v)};return{schedule:zg.reduce((R,M)=>{const D=o[M];return R[M]=(L,N=!1,V=!1)=>(t||S(),D.schedule(L,N,V)),R},{}),cancel:R=>{for(let M=0;M<zg.length;M++)o[zg[M]].cancel(R)},state:r,steps:o}}const{schedule:Tt,cancel:ta,state:Tn,steps:i_}=X2(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ri,!0),Y2=K.createContext({strict:!1}),fS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},au={};for(const n in fS)au[n]={isEnabled:e=>fS[n].some(t=>!!e[t])};function EL(n){for(const e in n)au[e]={...au[e],...n[e]}}const TL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Nm(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||TL.has(n)}let Z2=n=>!Nm(n);function SL(n){n&&(Z2=e=>e.startsWith("on")?!Nm(e):n(e))}try{SL(require("@emotion/is-prop-valid").default)}catch{}function IL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(Z2(r)||t===!0&&Nm(r)||!e&&!Nm(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function bL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const Np=K.createContext({});function wd(n){return typeof n=="string"||Array.isArray(n)}function Dp(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Vv=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],zv=["initial",...Vv];function Mp(n){return Dp(n.animate)||zv.some(e=>wd(n[e]))}function Q2(n){return!!(Mp(n)||n.variants)}function CL(n,e){if(Mp(n)){const{initial:t,animate:i}=n;return{initial:t===!1||wd(t)?t:void 0,animate:wd(i)?i:void 0}}return n.inherit!==!1?e:{}}function RL(n){const{initial:e,animate:t}=CL(n,K.useContext(Np));return K.useMemo(()=>({initial:e,animate:t}),[gS(e),gS(t)])}function gS(n){return Array.isArray(n)?n.join(" "):n}const AL=Symbol.for("motionComponentSymbol");function Gc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function PL(n,e,t){return K.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Gc(t)&&(t.current=i))},[e])}const Uv=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),kL="framerAppearId",J2="data-"+Uv(kL),{schedule:Bv}=X2(queueMicrotask,!1),eR=K.createContext({});function NL(n,e,t,i,r){var s,o;const{visualElement:l}=K.useContext(Np),u=K.useContext(Y2),h=K.useContext(kp),f=K.useContext(Ov).reducedMotion,p=K.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const _=p.current,v=K.useContext(eR);_&&!_.projection&&r&&(_.type==="html"||_.type==="svg")&&DL(p.current,t,r,v);const S=K.useRef(!1);K.useInsertionEffect(()=>{_&&S.current&&_.update(t,h)});const I=t[J2],w=K.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return K2(()=>{_&&(S.current=!0,window.MotionIsMounted=!0,_.updateFeatures(),Bv.render(_.render),w.current&&_.animationState&&_.animationState.animateChanges())}),K.useEffect(()=>{_&&(!w.current&&_.animationState&&_.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var R;(R=window.MotionHandoffMarkAsComplete)===null||R===void 0||R.call(window,I)}),w.current=!1))}),_}function DL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:tR(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&Gc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function tR(n){if(n)return n.options.allowProjection!==!1?n.projection:tR(n.parent)}function ML({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&EL(n);function l(h,f){let p;const _={...K.useContext(Ov),...h,layoutId:LL(h)},{isStatic:v}=_,S=RL(h),I=i(h,v);if(!v&&jv){OL();const w=jL(_);p=w.MeasureLayout,S.visualElement=NL(r,I,_,e,w.ProjectionNode)}return g.jsxs(Np.Provider,{value:S,children:[p&&S.visualElement?g.jsx(p,{visualElement:S.visualElement,..._}):null,t(r,h,PL(I,S.visualElement,f),I,v,S.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=K.forwardRef(l);return u[AL]=r,u}function LL({layoutId:n}){const e=K.useContext(Mv).id;return e&&n!==void 0?e+"-"+n:n}function OL(n,e){K.useContext(Y2).strict}function jL(n){const{drag:e,layout:t}=au;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const FL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Wv(n){return typeof n!="string"||n.includes("-")?!1:!!(FL.indexOf(n)>-1||/[A-Z]/u.test(n))}function mS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Gv(n,e,t,i){if(typeof e=="function"){const[r,s]=mS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=mS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const hx=n=>Array.isArray(n),VL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),zL=n=>hx(n)?n[n.length-1]||0:n,Bn=n=>!!(n&&n.getVelocity);function fm(n){const e=Bn(n)?n.get():n;return VL(e)?e.toValue():e}function UL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:BL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const nR=n=>(e,t)=>{const i=K.useContext(Np),r=K.useContext(kp),s=()=>UL(n,e,i,r);return t?s():Lv(s)};function BL(n,e,t,i){const r={},s=i(n,{});for(const _ in s)r[_]=fm(s[_]);let{initial:o,animate:l}=n;const u=Mp(n),h=Q2(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!Dp(p)){const _=Array.isArray(p)?p:[p];for(let v=0;v<_.length;v++){const S=Gv(n,_[v]);if(S){const{transitionEnd:I,transition:w,...R}=S;for(const M in R){let D=R[M];if(Array.isArray(D)){const L=f?D.length-1:0;D=D[L]}D!==null&&(r[M]=D)}for(const M in I)r[M]=I[M]}}}return r}const Mu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Nl=new Set(Mu),iR=n=>e=>typeof e=="string"&&e.startsWith(n),rR=iR("--"),WL=iR("var(--"),$v=n=>WL(n)?GL.test(n.split("/*")[0].trim()):!1,GL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,sR=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Xs=(n,e,t)=>t>e?e:t<n?n:t,Lu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Ed={...Lu,transform:n=>Xs(0,1,n)},Ug={...Lu,default:1},sf=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),jo=sf("deg"),os=sf("%"),Oe=sf("px"),$L=sf("vh"),HL=sf("vw"),pS={...os,parse:n=>os.parse(n)/100,transform:n=>os.transform(n*100)},KL={borderWidth:Oe,borderTopWidth:Oe,borderRightWidth:Oe,borderBottomWidth:Oe,borderLeftWidth:Oe,borderRadius:Oe,radius:Oe,borderTopLeftRadius:Oe,borderTopRightRadius:Oe,borderBottomRightRadius:Oe,borderBottomLeftRadius:Oe,width:Oe,maxWidth:Oe,height:Oe,maxHeight:Oe,top:Oe,right:Oe,bottom:Oe,left:Oe,padding:Oe,paddingTop:Oe,paddingRight:Oe,paddingBottom:Oe,paddingLeft:Oe,margin:Oe,marginTop:Oe,marginRight:Oe,marginBottom:Oe,marginLeft:Oe,backgroundPositionX:Oe,backgroundPositionY:Oe},qL={rotate:jo,rotateX:jo,rotateY:jo,rotateZ:jo,scale:Ug,scaleX:Ug,scaleY:Ug,scaleZ:Ug,skew:jo,skewX:jo,skewY:jo,distance:Oe,translateX:Oe,translateY:Oe,translateZ:Oe,x:Oe,y:Oe,z:Oe,perspective:Oe,transformPerspective:Oe,opacity:Ed,originX:pS,originY:pS,originZ:Oe},yS={...Lu,transform:Math.round},Hv={...KL,...qL,zIndex:yS,size:Oe,fillOpacity:Ed,strokeOpacity:Ed,numOctaves:yS},XL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},YL=Mu.length;function ZL(n,e,t){let i="",r=!0;for(let s=0;s<YL;s++){const o=Mu[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=sR(l,Hv[o]);if(!u){r=!1;const f=XL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Kv(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Nl.has(u)){o=!0;continue}else if(rR(u)){r[u]=h;continue}else{const f=sR(h,Hv[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=ZL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const QL={offset:"stroke-dashoffset",array:"stroke-dasharray"},JL={offset:"strokeDashoffset",array:"strokeDasharray"};function eO(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?QL:JL;n[s.offset]=Oe.transform(-i);const o=Oe.transform(e),l=Oe.transform(t);n[s.array]=`${o} ${l}`}function _S(n,e,t){return typeof n=="string"?n:Oe.transform(e+t*n)}function tO(n,e,t){const i=_S(e,n.x,n.width),r=_S(t,n.y,n.height);return`${i} ${r}`}function qv(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if(Kv(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:_,style:v,dimensions:S}=n;_.transform&&(S&&(v.transform=_.transform),delete _.transform),S&&(r!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=tO(S,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(_.x=e),t!==void 0&&(_.y=t),i!==void 0&&(_.scale=i),o!==void 0&&eO(_,o,l,u,!1)}const Xv=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),oR=()=>({...Xv(),attrs:{}}),Yv=n=>typeof n=="string"&&n.toLowerCase()==="svg";function aR(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const lR=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function cR(n,e,t,i){aR(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(lR.has(r)?r:Uv(r),e.attrs[r])}const Dm={};function nO(n){Object.assign(Dm,n)}function uR(n,{layout:e,layoutId:t}){return Nl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Dm[n]||n==="opacity")}function Zv(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Bn(r[o])||e.style&&Bn(e.style[o])||uR(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function hR(n,e,t){const i=Zv(n,e,t);for(const r in n)if(Bn(n[r])||Bn(e[r])){const s=Mu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function iO(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const xS=["x","y","width","height","cx","cy","r"],rO={useVisualState:nR({scrapeMotionValuesFromProps:hR,createRenderState:oR,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Nl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<xS.length;l++){const u=xS[l];n[u]!==e[u]&&(o=!0)}o&&Tt.read(()=>{iO(t,i),Tt.render(()=>{qv(i,r,Yv(t.tagName),n.transformTemplate),cR(t,i)})})}})},sO={useVisualState:nR({scrapeMotionValuesFromProps:Zv,createRenderState:Xv})};function dR(n,e,t){for(const i in e)!Bn(e[i])&&!uR(i,t)&&(n[i]=e[i])}function oO({transformTemplate:n},e){return K.useMemo(()=>{const t=Xv();return Kv(t,e,n),Object.assign({},t.vars,t.style)},[e])}function aO(n,e){const t=n.style||{},i={};return dR(i,t,n),Object.assign(i,oO(n,e)),i}function lO(n,e){const t={},i=aO(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function cO(n,e,t,i){const r=K.useMemo(()=>{const s=oR();return qv(s,e,Yv(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};dR(s,n.style,n),r.style={...s,...r.style}}return r}function uO(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(Wv(t)?cO:lO)(i,s,o,t),h=IL(i,typeof t=="string",n),f=t!==K.Fragment?{...h,...u,ref:r}:{},{children:p}=i,_=K.useMemo(()=>Bn(p)?p.get():p,[p]);return K.createElement(t,{...f,children:_})}}function hO(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Wv(i)?rO:sO,preloadedFeatures:n,useRender:uO(r),createVisualElement:e,Component:i};return ML(o)}}function fR(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Lp(n,e,t){const i=n.getProps();return Gv(i,e,t!==void 0?t:i.custom,n)}const dO=Fv(()=>window.ScrollTimeline!==void 0);class fO{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(dO()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class gO extends fO{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Qv(n,e){return n?n[e]||n.default||n:void 0}const dx=2e4;function gR(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<dx;)e+=t,i=n.next(e);return e>=dx?1/0:e}function Jv(n){return typeof n=="function"}function vS(n,e){n.timeline=e,n.onfinish=null}const e1=n=>Array.isArray(n)&&typeof n[0]=="number",mO={linearEasing:void 0};function pO(n,e){const t=Fv(n);return()=>{var i;return(i=mO[e])!==null&&i!==void 0?i:t()}}const Mm=pO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),mR=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(ou(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function pR(n){return!!(typeof n=="function"&&Mm()||!n||typeof n=="string"&&(n in fx||Mm())||e1(n)||Array.isArray(n)&&n.every(pR))}const Gh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,fx={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Gh([0,.65,.55,1]),circOut:Gh([.55,0,1,.45]),backIn:Gh([.31,.01,.66,-.59]),backOut:Gh([.33,1.53,.69,.99])};function yR(n,e){if(n)return typeof n=="function"&&Mm()?mR(n,e):e1(n)?Gh(n):Array.isArray(n)?n.map(t=>yR(t,e)||fx.easeOut):fx[n]}const mr={x:!1,y:!1};function _R(){return mr.x||mr.y}function yO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function xR(n,e){const t=yO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function wS(n){return e=>{e.pointerType==="touch"||_R()||n(e)}}function _O(n,e,t={}){const[i,r,s]=xR(n,t),o=wS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=wS(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const vR=(n,e)=>e?n===e?!0:vR(n,e.parentElement):!1,t1=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,xO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function vO(n){return xO.has(n.tagName)||n.tabIndex!==-1}const $h=new WeakSet;function ES(n){return e=>{e.key==="Enter"&&n(e)}}function r_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const wO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=ES(()=>{if($h.has(t))return;r_(t,"down");const r=ES(()=>{r_(t,"up")}),s=()=>r_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function TS(n){return t1(n)&&!_R()}function EO(n,e,t={}){const[i,r,s]=xR(n,t),o=l=>{const u=l.currentTarget;if(!TS(l)||$h.has(u))return;$h.add(u);const h=e(l),f=(v,S)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",_),!(!TS(v)||!$h.has(u))&&($h.delete(u),typeof h=="function"&&h(v,{success:S}))},p=v=>{f(v,t.useGlobalTarget||vR(u,v.target))},_=v=>{f(v,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",_,r)};return i.forEach(l=>{!vO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>wO(h,r),r)}),s}function TO(n){return n==="x"||n==="y"?mr[n]?null:(mr[n]=!0,()=>{mr[n]=!1}):mr.x||mr.y?null:(mr.x=mr.y=!0,()=>{mr.x=mr.y=!1})}const wR=new Set(["width","height","top","left","right","bottom",...Mu]);let gm;function SO(){gm=void 0}const as={now:()=>(gm===void 0&&as.set(Tn.isProcessing||xL.useManualTiming?Tn.timestamp:performance.now()),gm),set:n=>{gm=n,queueMicrotask(SO)}};function n1(n,e){n.indexOf(e)===-1&&n.push(e)}function i1(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class r1{constructor(){this.subscriptions=[]}add(e){return n1(this.subscriptions,e),()=>i1(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function ER(n,e){return e?n*(1e3/e):0}const SS=30,IO=n=>!isNaN(parseFloat(n));class bO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=as.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=as.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=IO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new r1);const i=this.events[e].add(t);return e==="change"?()=>{i(),Tt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=as.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>SS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,SS);return ER(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Td(n,e){return new bO(n,e)}function CO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Td(t))}function RO(n,e){const t=Lp(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=zL(s[o]);CO(n,o,l)}}function AO(n){return!!(Bn(n)&&n.add)}function gx(n,e){const t=n.getValue("willChange");if(AO(t))return t.add(e)}function TR(n){return n.props[J2]}const SR=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,PO=1e-7,kO=12;function NO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=SR(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>PO&&++l<kO);return o}function of(n,e,t,i){if(n===e&&t===i)return Ri;const r=s=>NO(s,0,1,n,t);return s=>s===0||s===1?s:SR(r(s),e,i)}const IR=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,bR=n=>e=>1-n(1-e),CR=of(.33,1.53,.69,.99),s1=bR(CR),RR=IR(s1),AR=n=>(n*=2)<1?.5*s1(n):.5*(2-Math.pow(2,-10*(n-1))),o1=n=>1-Math.sin(Math.acos(n)),PR=bR(o1),kR=IR(o1),NR=n=>/^0[^.\s]+$/u.test(n);function DO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||NR(n):!0}const id=n=>Math.round(n*1e5)/1e5,a1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function MO(n){return n==null}const LO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,l1=(n,e)=>t=>!!(typeof t=="string"&&LO.test(t)&&t.startsWith(n)||e&&!MO(t)&&Object.prototype.hasOwnProperty.call(t,e)),DR=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(a1);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},OO=n=>Xs(0,255,n),s_={...Lu,transform:n=>Math.round(OO(n))},Qa={test:l1("rgb","red"),parse:DR("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+s_.transform(n)+", "+s_.transform(e)+", "+s_.transform(t)+", "+id(Ed.transform(i))+")"};function jO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const mx={test:l1("#"),parse:jO,transform:Qa.transform},$c={test:l1("hsl","hue"),parse:DR("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+os.transform(id(e))+", "+os.transform(id(t))+", "+id(Ed.transform(i))+")"},Fn={test:n=>Qa.test(n)||mx.test(n)||$c.test(n),parse:n=>Qa.test(n)?Qa.parse(n):$c.test(n)?$c.parse(n):mx.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Qa.transform(n):$c.transform(n)},FO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function VO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(a1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(FO))===null||t===void 0?void 0:t.length)||0)>0}const MR="number",LR="color",zO="var",UO="var(",IS="${}",BO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Sd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(BO,u=>(Fn.test(u)?(i.color.push(s),r.push(LR),t.push(Fn.parse(u))):u.startsWith(UO)?(i.var.push(s),r.push(zO),t.push(u)):(i.number.push(s),r.push(MR),t.push(parseFloat(u))),++s,IS)).split(IS);return{values:t,split:l,indexes:i,types:r}}function OR(n){return Sd(n).values}function jR(n){const{split:e,types:t}=Sd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===MR?s+=id(r[o]):l===LR?s+=Fn.transform(r[o]):s+=r[o]}return s}}const WO=n=>typeof n=="number"?0:n;function GO(n){const e=OR(n);return jR(n)(e.map(WO))}const na={test:VO,parse:OR,createTransformer:jR,getAnimatableNone:GO},$O=new Set(["brightness","contrast","saturate","opacity"]);function HO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(a1)||[];if(!i)return n;const r=t.replace(i,"");let s=$O.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const KO=/\b([a-z-]*)\(.*?\)/gu,px={...na,getAnimatableNone:n=>{const e=n.match(KO);return e?e.map(HO).join(" "):n}},qO={...Hv,color:Fn,backgroundColor:Fn,outlineColor:Fn,fill:Fn,stroke:Fn,borderColor:Fn,borderTopColor:Fn,borderRightColor:Fn,borderBottomColor:Fn,borderLeftColor:Fn,filter:px,WebkitFilter:px},c1=n=>qO[n];function FR(n,e){let t=c1(n);return t!==px&&(t=na),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const XO=new Set(["auto","none","0"]);function YO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!XO.has(s)&&Sd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=FR(t,r)}const bS=n=>n===Lu||n===Oe,CS=(n,e)=>parseFloat(n.split(", ")[e]),RS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return CS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?CS(s[1],n):0}},ZO=new Set(["x","y","z"]),QO=Mu.filter(n=>!ZO.has(n));function JO(n){const e=[];return QO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const lu={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:RS(4,13),y:RS(5,14)};lu.translateX=lu.x;lu.translateY=lu.y;const ol=new Set;let yx=!1,_x=!1;function VR(){if(_x){const n=Array.from(ol).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=JO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}_x=!1,yx=!1,ol.forEach(n=>n.complete()),ol.clear()}function zR(){ol.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(_x=!0)})}function ej(){zR(),VR()}class u1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ol.add(this),yx||(yx=!0,Tt.read(zR),Tt.resolveKeyframes(VR))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ol.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ol.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const UR=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),tj=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function nj(n){const e=tj.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function BR(n,e,t=1){const[i,r]=nj(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return UR(o)?parseFloat(o):o}return $v(r)?BR(r,e,t+1):r}const WR=n=>e=>e.test(n),ij={test:n=>n==="auto",parse:n=>n},GR=[Lu,Oe,os,jo,HL,$L,ij],AS=n=>GR.find(WR(n));class $R extends u1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),$v(h))){const f=BR(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!wR.has(i)||e.length!==2)return;const[r,s]=e,o=AS(r),l=AS(s);if(o!==l)if(bS(o)&&bS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)DO(e[r])&&i.push(r);i.length&&YO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=lu[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=lu[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const PS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(na.test(n)||n==="0")&&!n.startsWith("url("));function rj(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function sj(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=PS(r,e),l=PS(s,e);return!o||!l?!1:rj(n)||(t==="spring"||Jv(t))&&i}const oj=n=>n!==null;function Op(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(oj),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const aj=40;class HR{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=as.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>aj?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&ej(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=as.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!sj(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Op(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Nt=(n,e,t)=>n+(e-n)*t;function o_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function lj({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=o_(u,l,n+1/3),s=o_(u,l,n),o=o_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Lm(n,e){return t=>t>0?e:n}const a_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},cj=[mx,Qa,$c],uj=n=>cj.find(e=>e.test(n));function kS(n){const e=uj(n);if(!e)return!1;let t=e.parse(n);return e===$c&&(t=lj(t)),t}const NS=(n,e)=>{const t=kS(n),i=kS(e);if(!t||!i)return Lm(n,e);const r={...t};return s=>(r.red=a_(t.red,i.red,s),r.green=a_(t.green,i.green,s),r.blue=a_(t.blue,i.blue,s),r.alpha=Nt(t.alpha,i.alpha,s),Qa.transform(r))},hj=(n,e)=>t=>e(n(t)),af=(...n)=>n.reduce(hj),xx=new Set(["none","hidden"]);function dj(n,e){return xx.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function fj(n,e){return t=>Nt(n,e,t)}function h1(n){return typeof n=="number"?fj:typeof n=="string"?$v(n)?Lm:Fn.test(n)?NS:pj:Array.isArray(n)?KR:typeof n=="object"?Fn.test(n)?NS:gj:Lm}function KR(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>h1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function gj(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=h1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function mj(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const pj=(n,e)=>{const t=na.createTransformer(e),i=Sd(n),r=Sd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?xx.has(n)&&!r.values.length||xx.has(e)&&!i.values.length?dj(n,e):af(KR(mj(i,r),r.values),t):Lm(n,e)};function qR(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Nt(n,e,t):h1(n)(n,e)}const yj=5;function XR(n,e,t){const i=Math.max(e-yj,0);return ER(t-n(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},l_=.001;function _j({duration:n=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:i=Ot.mass}){let r,s,o=1-e;o=Xs(Ot.minDamping,Ot.maxDamping,o),n=Xs(Ot.minDuration,Ot.maxDuration,Gs(n)),o<1?(r=h=>{const f=h*o,p=f*n,_=f-t,v=vx(h,o),S=Math.exp(-p);return l_-_/v*S},s=h=>{const p=h*o*n,_=p*t+t,v=Math.pow(o,2)*Math.pow(h,2)*n,S=Math.exp(-p),I=vx(Math.pow(h,2),o);return(-r(h)+l_>0?-1:1)*((_-v)*S)/I}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-l_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=vj(r,s,l);if(n=Ws(n),isNaN(u))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const xj=12;function vj(n,e,t){let i=t;for(let r=1;r<xj;r++)i=i-n(i)/e(i);return i}function vx(n,e){return n*Math.sqrt(1-e*e)}const wj=["duration","bounce"],Ej=["stiffness","damping","mass"];function DS(n,e){return e.some(t=>n[t]!==void 0)}function Tj(n){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...n};if(!DS(n,Ej)&&DS(n,wj))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Xs(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=_j(n);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function YR(n=Ot.visualDuration,e=Ot.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:_,isResolvedFromDuration:v}=Tj({...t,velocity:-Gs(t.velocity||0)}),S=_||0,I=h/(2*Math.sqrt(u*f)),w=o-s,R=Gs(Math.sqrt(u/f)),M=Math.abs(w)<5;i||(i=M?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=M?Ot.restDelta.granular:Ot.restDelta.default);let D;if(I<1){const N=vx(R,I);D=V=>{const A=Math.exp(-I*R*V);return o-A*((S+I*R*w)/N*Math.sin(N*V)+w*Math.cos(N*V))}}else if(I===1)D=N=>o-Math.exp(-R*N)*(w+(S+R*w)*N);else{const N=R*Math.sqrt(I*I-1);D=V=>{const A=Math.exp(-I*R*V),b=Math.min(N*V,300);return o-A*((S+I*R*w)*Math.sinh(b)+N*w*Math.cosh(b))/N}}const L={calculatedDuration:v&&p||null,next:N=>{const V=D(N);if(v)l.done=N>=p;else{let A=0;I<1&&(A=N===0?Ws(S):XR(D,N,V));const b=Math.abs(A)<=i,P=Math.abs(o-V)<=r;l.done=b&&P}return l.value=l.done?o:V,l},toString:()=>{const N=Math.min(gR(L),dx),V=mR(A=>L.next(N*A).value,N,30);return N+"ms "+V}};return L}function MS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],_={done:!1,value:p},v=b=>l!==void 0&&b<l||u!==void 0&&b>u,S=b=>l===void 0?u:u===void 0||Math.abs(l-b)<Math.abs(u-b)?l:u;let I=t*e;const w=p+I,R=o===void 0?w:o(w);R!==w&&(I=R-p);const M=b=>-I*Math.exp(-b/i),D=b=>R+M(b),L=b=>{const P=M(b),j=D(b);_.done=Math.abs(P)<=h,_.value=_.done?R:j};let N,V;const A=b=>{v(_.value)&&(N=b,V=YR({keyframes:[_.value,S(_.value)],velocity:XR(D,b,_.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return A(0),{calculatedDuration:null,next:b=>{let P=!1;return!V&&N===void 0&&(P=!0,L(b),A(b)),N!==void 0&&b>=N?V.next(b-N):(!P&&L(b),_)}}}const Sj=of(.42,0,1,1),Ij=of(0,0,.58,1),ZR=of(.42,0,.58,1),bj=n=>Array.isArray(n)&&typeof n[0]!="number",Cj={linear:Ri,easeIn:Sj,easeInOut:ZR,easeOut:Ij,circIn:o1,circInOut:kR,circOut:PR,backIn:s1,backInOut:RR,backOut:CR,anticipate:AR},LS=n=>{if(e1(n)){q2(n.length===4);const[e,t,i,r]=n;return of(e,t,i,r)}else if(typeof n=="string")return Cj[n];return n};function Rj(n,e,t){const i=[],r=t||qR,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ri:e;l=af(u,l)}i.push(l)}return i}function Aj(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(q2(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=Rj(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const _=ou(n[p],n[p+1],f);return l[p](_)};return t?f=>h(Xs(n[0],n[s-1],f)):h}function Pj(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=ou(0,e,i);n.push(Nt(t,1,r))}}function kj(n){const e=[0];return Pj(e,n.length-1),e}function Nj(n,e){return n.map(t=>t*e)}function Dj(n,e){return n.map(()=>e||ZR).splice(0,n.length-1)}function Om({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=bj(i)?i.map(LS):LS(i),s={done:!1,value:e[0]},o=Nj(t&&t.length===e.length?t:kj(e),n),l=Aj(o,e,{ease:Array.isArray(r)?r:Dj(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const Mj=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Tt.update(e,!0),stop:()=>ta(e),now:()=>Tn.isProcessing?Tn.timestamp:as.now()}},Lj={decay:MS,inertia:MS,tween:Om,keyframes:Om,spring:YR},Oj=n=>n/100;class d1 extends HR{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||u1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Jv(t)?t:Lj[t]||Om;let u,h;l!==Om&&typeof e[0]!="number"&&(u=af(Oj,qR(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=gR(f));const{calculatedDuration:p}=f,_=p+r,v=_*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:_,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:b}=this.options;return{done:!0,value:b[b.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:_,repeat:v,repeatType:S,repeatDelay:I,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const R=this.currentTime-_*(this.speed>=0?1:-1),M=this.speed>=0?R<0:R>f;this.currentTime=Math.max(R,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let D=this.currentTime,L=s;if(v){const b=Math.min(this.currentTime,f)/p;let P=Math.floor(b),j=b%1;!j&&b>=1&&(j=1),j===1&&P--,P=Math.min(P,v+1),P%2&&(S==="reverse"?(j=1-j,I&&(j-=I/p)):S==="mirror"&&(L=o)),D=Xs(0,1,j)*p}const N=M?{done:!1,value:u[0]}:L.next(D);l&&(N.value=l(N.value));let{done:V}=N;!M&&h!==null&&(V=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return A&&r!==void 0&&(N.value=Op(u,this.options,r)),w&&w(N.value),A&&this.finish(),N}get duration(){const{resolved:e}=this;return e?Gs(e.calculatedDuration):0}get time(){return Gs(this.currentTime)}set time(e){e=Ws(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Gs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Mj,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const jj=new Set(["opacity","clipPath","filter","transform"]);function Fj(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=yR(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const Vj=Fv(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),jm=10,zj=2e4;function Uj(n){return Jv(n.type)||n.type==="spring"||!pR(n.ease)}function Bj(n,e){const t=new d1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<zj;)i=t.sample(s),r.push(i.value),s+=jm;return{times:void 0,keyframes:r,duration:s-jm,ease:"linear"}}const QR={anticipate:AR,backInOut:RR,circInOut:kR};function Wj(n){return n in QR}class OS extends HR{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new $R(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Mm()&&Wj(s)&&(s=QR[s]),Uj(this.options)){const{onComplete:p,onUpdate:_,motionValue:v,element:S,...I}=this.options,w=Bj(e,I);e=w.keyframes,e.length===1&&(e[1]=e[0]),i=w.duration,r=w.times,s=w.ease,o="keyframes"}const f=Fj(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(vS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(Op(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Gs(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Gs(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=Ws(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ri;const{animation:i}=t;vS(i,e)}return Ri}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:_,...v}=this.options,S=new d1({...v,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=Ws(this.time);h.setWithVelocity(S.sample(I-jm).value,S.sample(I).value,jm)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return Vj()&&i&&jj.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const Gj={type:"spring",stiffness:500,damping:25,restSpeed:10},$j=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Hj={type:"keyframes",duration:.8},Kj={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},qj=(n,{keyframes:e})=>e.length>2?Hj:Nl.has(n)?n.startsWith("scale")?$j(e[1]):Gj:Kj;function Xj({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const f1=(n,e,t,i={},r,s)=>o=>{const l=Qv(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-Ws(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:_=>{e.set(_),l.onUpdate&&l.onUpdate(_)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};Xj(l)||(f={...f,...qj(n,f)}),f.duration&&(f.duration=Ws(f.duration)),f.repeatDelay&&(f.repeatDelay=Ws(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const _=Op(f.keyframes,l);if(_!==void 0)return Tt.update(()=>{f.onUpdate(_),f.onComplete()}),new gO([])}return!s&&OS.supports(f)?new OS(f):new d1(f)};function Yj({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function JR(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const _=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),v=u[p];if(v===void 0||f&&Yj(f,p))continue;const S={delay:t,...Qv(o||{},p)};let I=!1;if(window.MotionHandoffAnimation){const R=TR(n);if(R){const M=window.MotionHandoffAnimation(R,p,Tt);M!==null&&(S.startTime=M,I=!0)}}gx(n,p),_.start(f1(p,_,v,n.shouldReduceMotion&&wR.has(p)?{type:!1}:S,n,I));const w=_.animation;w&&h.push(w)}return l&&Promise.all(h).then(()=>{Tt.update(()=>{l&&RO(n,l)})}),h}function wx(n,e,t={}){var i;const r=Lp(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(JR(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:_}=s;return Zj(n,e,f+h,p,_,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function Zj(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(Qj).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(wx(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function Qj(n,e){return n.sortNodePosition(e)}function Jj(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>wx(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=wx(n,e,t);else{const r=typeof e=="function"?Lp(n,e,t.custom):e;i=Promise.all(JR(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const e5=zv.length;function eA(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?eA(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<e5;t++){const i=zv[t],r=n.props[i];(wd(r)||r===!1)&&(e[i]=r)}return e}const t5=[...Vv].reverse(),n5=Vv.length;function i5(n){return e=>Promise.all(e.map(({animation:t,options:i})=>Jj(n,t,i)))}function r5(n){let e=i5(n),t=jS(),i=!0;const r=u=>(h,f)=>{var p;const _=Lp(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(_){const{transition:v,transitionEnd:S,...I}=_;h={...h,...I,...S}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=eA(n.parent)||{},p=[],_=new Set;let v={},S=1/0;for(let w=0;w<n5;w++){const R=t5[w],M=t[R],D=h[R]!==void 0?h[R]:f[R],L=wd(D),N=R===u?M.isActive:null;N===!1&&(S=w);let V=D===f[R]&&D!==h[R]&&L;if(V&&i&&n.manuallyAnimateOnMount&&(V=!1),M.protectedKeys={...v},!M.isActive&&N===null||!D&&!M.prevProp||Dp(D)||typeof D=="boolean")continue;const A=s5(M.prevProp,D);let b=A||R===u&&M.isActive&&!V&&L||w>S&&L,P=!1;const j=Array.isArray(D)?D:[D];let z=j.reduce(r(R),{});N===!1&&(z={});const{prevResolvedValues:B={}}=M,O={...B,...z},se=ue=>{b=!0,_.has(ue)&&(P=!0,_.delete(ue)),M.needsAnimating[ue]=!0;const H=n.getValue(ue);H&&(H.liveStyle=!1)};for(const ue in O){const H=z[ue],X=B[ue];if(v.hasOwnProperty(ue))continue;let ne=!1;hx(H)&&hx(X)?ne=!fR(H,X):ne=H!==X,ne?H!=null?se(ue):_.add(ue):H!==void 0&&_.has(ue)?se(ue):M.protectedKeys[ue]=!0}M.prevProp=D,M.prevResolvedValues=z,M.isActive&&(v={...v,...z}),i&&n.blockInitialAnimation&&(b=!1),b&&(!(V&&A)||P)&&p.push(...j.map(ue=>({animation:ue,options:{type:R}})))}if(_.size){const w={};_.forEach(R=>{const M=n.getBaseTarget(R),D=n.getValue(R);D&&(D.liveStyle=!0),w[R]=M??null}),p.push({animation:w})}let I=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(_=>{var v;return(v=_.animationState)===null||v===void 0?void 0:v.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const _ in t)t[_].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=jS(),i=!0}}}function s5(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!fR(e,n):!1}function Oa(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function jS(){return{animate:Oa(!0),whileInView:Oa(),whileHover:Oa(),whileTap:Oa(),whileDrag:Oa(),whileFocus:Oa(),exit:Oa()}}let la=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class o5 extends la{constructor(e){super(e),e.animationState||(e.animationState=r5(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Dp(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let a5=0;class l5 extends la{constructor(){super(...arguments),this.id=a5++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const c5={animation:{Feature:o5},exit:{Feature:l5}};function Id(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function lf(n){return{point:{x:n.pageX,y:n.pageY}}}const u5=n=>e=>t1(e)&&n(e,lf(e));function rd(n,e,t,i){return Id(n,e,u5(t),i)}const FS=(n,e)=>Math.abs(n-e);function h5(n,e){const t=FS(n.x,e.x),i=FS(n.y,e.y);return Math.sqrt(t**2+i**2)}class tA{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=u_(this.lastMoveEventInfo,this.history),_=this.startEvent!==null,v=h5(p.offset,{x:0,y:0})>=3;if(!_&&!v)return;const{point:S}=p,{timestamp:I}=Tn;this.history.push({...S,timestamp:I});const{onStart:w,onMove:R}=this.handlers;_||(w&&w(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),R&&R(this.lastMoveEvent,p)},this.handlePointerMove=(p,_)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=c_(_,this.transformPagePoint),Tt.update(this.updatePoint,!0)},this.handlePointerUp=(p,_)=>{this.end();const{onEnd:v,onSessionEnd:S,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=u_(p.type==="pointercancel"?this.lastMoveEventInfo:c_(_,this.transformPagePoint),this.history);this.startEvent&&v&&v(p,w),S&&S(p,w)},!t1(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=lf(e),l=c_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=Tn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,u_(l,this.history)),this.removeListeners=af(rd(this.contextWindow,"pointermove",this.handlePointerMove),rd(this.contextWindow,"pointerup",this.handlePointerUp),rd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ta(this.updatePoint)}}function c_(n,e){return e?{point:e(n.point)}:n}function VS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function u_({point:n},e){return{point:n,delta:VS(n,nA(e)),offset:VS(n,d5(e)),velocity:f5(e,.1)}}function d5(n){return n[0]}function nA(n){return n[n.length-1]}function f5(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=nA(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>Ws(e)));)t--;if(!i)return{x:0,y:0};const s=Gs(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const iA=1e-4,g5=1-iA,m5=1+iA,rA=.01,p5=0-rA,y5=0+rA;function Ai(n){return n.max-n.min}function _5(n,e,t){return Math.abs(n-e)<=t}function zS(n,e,t,i=.5){n.origin=i,n.originPoint=Nt(e.min,e.max,n.origin),n.scale=Ai(t)/Ai(e),n.translate=Nt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=g5&&n.scale<=m5||isNaN(n.scale))&&(n.scale=1),(n.translate>=p5&&n.translate<=y5||isNaN(n.translate))&&(n.translate=0)}function sd(n,e,t,i){zS(n.x,e.x,t.x,i?i.originX:void 0),zS(n.y,e.y,t.y,i?i.originY:void 0)}function US(n,e,t){n.min=t.min+e.min,n.max=n.min+Ai(e)}function x5(n,e,t){US(n.x,e.x,t.x),US(n.y,e.y,t.y)}function BS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ai(e)}function od(n,e,t){BS(n.x,e.x,t.x),BS(n.y,e.y,t.y)}function v5(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Nt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Nt(t,n,i.max):Math.min(n,t)),n}function WS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function w5(n,{top:e,left:t,bottom:i,right:r}){return{x:WS(n.x,t,r),y:WS(n.y,e,i)}}function GS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function E5(n,e){return{x:GS(n.x,e.x),y:GS(n.y,e.y)}}function T5(n,e){let t=.5;const i=Ai(n),r=Ai(e);return r>i?t=ou(e.min,e.max-i,n.min):i>r&&(t=ou(n.min,n.max-r,e.min)),Xs(0,1,t)}function S5(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const Ex=.35;function I5(n=Ex){return n===!1?n=0:n===!0&&(n=Ex),{x:$S(n,"left","right"),y:$S(n,"top","bottom")}}function $S(n,e,t){return{min:HS(n,e),max:HS(n,t)}}function HS(n,e){return typeof n=="number"?n:n[e]||0}const KS=()=>({translate:0,scale:1,origin:0,originPoint:0}),Hc=()=>({x:KS(),y:KS()}),qS=()=>({min:0,max:0}),Ut=()=>({x:qS(),y:qS()});function qi(n){return[n("x"),n("y")]}function sA({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function b5({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function C5(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function h_(n){return n===void 0||n===1}function Tx({scale:n,scaleX:e,scaleY:t}){return!h_(n)||!h_(e)||!h_(t)}function za(n){return Tx(n)||oA(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function oA(n){return XS(n.x)||XS(n.y)}function XS(n){return n&&n!=="0%"}function Fm(n,e,t){const i=n-t,r=e*i;return t+r}function YS(n,e,t,i,r){return r!==void 0&&(n=Fm(n,r,i)),Fm(n,t,i)+e}function Sx(n,e=0,t=1,i,r){n.min=YS(n.min,e,t,i,r),n.max=YS(n.max,e,t,i,r)}function aA(n,{x:e,y:t}){Sx(n.x,e.translate,e.scale,e.originPoint),Sx(n.y,t.translate,t.scale,t.originPoint)}const ZS=.999999999999,QS=1.0000000000001;function R5(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&qc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,aA(n,o)),i&&za(s.latestValues)&&qc(n,s.latestValues))}e.x<QS&&e.x>ZS&&(e.x=1),e.y<QS&&e.y>ZS&&(e.y=1)}function Kc(n,e){n.min=n.min+e,n.max=n.max+e}function JS(n,e,t,i,r=.5){const s=Nt(n.min,n.max,r);Sx(n,e,t,s,i)}function qc(n,e){JS(n.x,e.x,e.scaleX,e.scale,e.originX),JS(n.y,e.y,e.scaleY,e.scale,e.originY)}function lA(n,e){return sA(C5(n.getBoundingClientRect(),e))}function A5(n,e,t){const i=lA(n,t),{scroll:r}=e;return r&&(Kc(i.x,r.offset.x),Kc(i.y,r.offset.y)),i}const cA=({current:n})=>n?n.ownerDocument.defaultView:null,P5=new WeakMap;class k5{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(lf(f).point)},s=(f,p)=>{const{drag:_,dragPropagation:v,onDragStart:S}=this.getProps();if(_&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=TO(_),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),qi(w=>{let R=this.getAxisMotionValue(w).get()||0;if(os.test(R)){const{projection:M}=this.visualElement;if(M&&M.layout){const D=M.layout.layoutBox[w];D&&(R=Ai(D)*(parseFloat(R)/100))}}this.originPoint[w]=R}),S&&Tt.postRender(()=>S(f,p)),gx(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:_,dragDirectionLock:v,onDirectionLock:S,onDrag:I}=this.getProps();if(!_&&!this.openDragLock)return;const{offset:w}=p;if(v&&this.currentDirection===null){this.currentDirection=N5(w),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",p.point,w),this.updateAxis("y",p.point,w),this.visualElement.render(),I&&I(f,p)},l=(f,p)=>this.stop(f,p),u=()=>qi(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new tA(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:cA(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Tt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Bg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=v5(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Gc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=w5(r.layoutBox,t):this.constraints=!1,this.elastic=I5(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&qi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=S5(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Gc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=A5(i,r.root,this.visualElement.getTransformPagePoint());let o=E5(r.layout.layoutBox,s);if(t){const l=t(b5(o));this.hasMutatedConstraints=!!l,l&&(o=sA(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=qi(f=>{if(!Bg(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const _=r?200:1e6,v=r?40:1e7,S={type:"inertia",velocity:i?e[f]:0,bounceStiffness:_,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,S)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return gx(this.visualElement,e),i.start(f1(e,i,0,t,this.visualElement,!1))}stopAnimation(){qi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){qi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){qi(t=>{const{drag:i}=this.getProps();if(!Bg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-Nt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Gc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};qi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=T5({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),qi(o=>{if(!Bg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Nt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;P5.set(this.visualElement,this);const e=this.visualElement.current,t=rd(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();Gc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Tt.read(i);const o=Id(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(qi(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=Ex,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Bg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function N5(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class D5 extends la{constructor(e){super(e),this.removeGroupControls=Ri,this.removeListeners=Ri,this.controls=new k5(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ri}unmount(){this.removeGroupControls(),this.removeListeners()}}const eI=n=>(e,t)=>{n&&Tt.postRender(()=>n(e,t))};class M5 extends la{constructor(){super(...arguments),this.removePointerDownListener=Ri}onPointerDown(e){this.session=new tA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:cA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:eI(e),onStart:eI(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Tt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=rd(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const mm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function tI(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ph={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Oe.test(n))n=parseFloat(n);else return n;const t=tI(n,e.target.x),i=tI(n,e.target.y);return`${t}% ${i}%`}},L5={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=na.parse(n);if(r.length>5)return i;const s=na.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=Nt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class O5 extends K.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;nO(j5),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),mm.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Tt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Bv.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function uA(n){const[e,t]=H2(),i=K.useContext(Mv);return g.jsx(O5,{...n,layoutGroup:i,switchLayoutGroup:K.useContext(eR),isPresent:e,safeToRemove:t})}const j5={borderRadius:{...Ph,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ph,borderTopRightRadius:Ph,borderBottomLeftRadius:Ph,borderBottomRightRadius:Ph,boxShadow:L5};function F5(n,e,t){const i=Bn(n)?n:Td(n);return i.start(f1("",i,e,t)),i.animation}function V5(n){return n instanceof SVGElement&&n.tagName!=="svg"}const z5=(n,e)=>n.depth-e.depth;class U5{constructor(){this.children=[],this.isDirty=!1}add(e){n1(this.children,e),this.isDirty=!0}remove(e){i1(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(z5),this.isDirty=!1,this.children.forEach(e)}}function B5(n,e){const t=as.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(ta(i),n(s-e))};return Tt.read(i,!0),()=>ta(i)}const hA=["TopLeft","TopRight","BottomLeft","BottomRight"],W5=hA.length,nI=n=>typeof n=="string"?parseFloat(n):n,iI=n=>typeof n=="number"||Oe.test(n);function G5(n,e,t,i,r,s){r?(n.opacity=Nt(0,t.opacity!==void 0?t.opacity:1,$5(i)),n.opacityExit=Nt(e.opacity!==void 0?e.opacity:1,0,H5(i))):s&&(n.opacity=Nt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<W5;o++){const l=`border${hA[o]}Radius`;let u=rI(e,l),h=rI(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||iI(u)===iI(h)?(n[l]=Math.max(Nt(nI(u),nI(h),i),0),(os.test(h)||os.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=Nt(e.rotate||0,t.rotate||0,i))}function rI(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const $5=dA(0,.5,PR),H5=dA(.5,.95,Ri);function dA(n,e,t){return i=>i<n?0:i>e?1:t(ou(n,e,i))}function sI(n,e){n.min=e.min,n.max=e.max}function Hi(n,e){sI(n.x,e.x),sI(n.y,e.y)}function oI(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function aI(n,e,t,i,r){return n-=e,n=Fm(n,1/t,i),r!==void 0&&(n=Fm(n,1/r,i)),n}function K5(n,e=0,t=1,i=.5,r,s=n,o=n){if(os.test(e)&&(e=parseFloat(e),e=Nt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Nt(s.min,s.max,i);n===s&&(l-=e),n.min=aI(n.min,e,t,l,r),n.max=aI(n.max,e,t,l,r)}function lI(n,e,[t,i,r],s,o){K5(n,e[t],e[i],e[r],e.scale,s,o)}const q5=["x","scaleX","originX"],X5=["y","scaleY","originY"];function cI(n,e,t,i){lI(n.x,e,q5,t?t.x:void 0,i?i.x:void 0),lI(n.y,e,X5,t?t.y:void 0,i?i.y:void 0)}function uI(n){return n.translate===0&&n.scale===1}function fA(n){return uI(n.x)&&uI(n.y)}function hI(n,e){return n.min===e.min&&n.max===e.max}function Y5(n,e){return hI(n.x,e.x)&&hI(n.y,e.y)}function dI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function gA(n,e){return dI(n.x,e.x)&&dI(n.y,e.y)}function fI(n){return Ai(n.x)/Ai(n.y)}function gI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Z5{constructor(){this.members=[]}add(e){n1(this.members,e),e.scheduleRender()}remove(e){if(i1(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Q5(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:_,skewX:v,skewY:S}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),_&&(i+=`rotateY(${_}deg) `),v&&(i+=`skewX(${v}deg) `),S&&(i+=`skewY(${S}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const Ua={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Hh=typeof window<"u"&&window.MotionDebug!==void 0,d_=["","X","Y","Z"],J5={visibility:"hidden"},mI=1e3;let e4=0;function f_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function mA(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=TR(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Tt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&mA(i)}function pA({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=e4++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Hh&&(Ua.totalNodes=Ua.resolvedTargetDeltas=Ua.recalculatedProjection=0),this.nodes.forEach(i4),this.nodes.forEach(l4),this.nodes.forEach(c4),this.nodes.forEach(r4),Hh&&window.MotionDebug.record(Ua)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new U5)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new r1),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=V5(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const _=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=B5(_,250),mm.hasAnimatedSinceResize&&(mm.hasAnimatedSinceResize=!1,this.nodes.forEach(yI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:_,hasRelativeTargetChanged:v,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||g4,{onLayoutAnimationStart:w,onLayoutAnimationComplete:R}=f.getProps(),M=!this.targetLayout||!gA(this.targetLayout,S)||v,D=!_&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||D||_&&(M||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,D);const L={...Qv(I,"layout"),onPlay:w,onComplete:R};(f.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else _||yI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ta(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(u4),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&mA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(pI);return}this.isUpdating||this.nodes.forEach(o4),this.isUpdating=!1,this.nodes.forEach(a4),this.nodes.forEach(t4),this.nodes.forEach(n4),this.clearAllSnapshots();const l=as.now();Tn.delta=Xs(0,1e3/60,l-Tn.timestamp),Tn.timestamp=l,Tn.isProcessing=!0,i_.update.process(Tn),i_.preRender.process(Tn),i_.render.process(Tn),Tn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Bv.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(s4),this.sharedNodes.forEach(h4)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Tt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Tt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!fA(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||za(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),m4(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(p4))){const{scroll:f}=this.root;f&&(Kc(u.x,f.offset.x),Kc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(Hi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:_}=f;f!==this.root&&p&&_.layoutScroll&&(p.wasRoot&&Hi(u,o),Kc(u.x,p.offset.x),Kc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();Hi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&qc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),za(f.latestValues)&&qc(u,f.latestValues)}return za(this.latestValues)&&qc(u,this.latestValues),u}removeTransform(o){const l=Ut();Hi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!za(h.latestValues))continue;Tx(h.latestValues)&&h.updateSnapshot();const f=Ut(),p=h.measurePageBox();Hi(f,p),cI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return za(this.latestValues)&&cI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Tn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:_}=this.options;if(!(!this.layout||!(p||_))){if(this.resolvedRelativeTargetAt=Tn.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),od(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),Hi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),x5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Hi(this.target,this.layout.layoutBox),aA(this.target,this.targetDelta)):Hi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),od(this.relativeTargetOrigin,this.target,v.target),Hi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Hh&&Ua.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Tx(this.parent.latestValues)||oA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===Tn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;Hi(this.layoutCorrected,this.layout.layoutBox);const _=this.treeScale.x,v=this.treeScale.y;R5(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:S}=l;if(!S){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(oI(this.prevProjectionDelta.x,this.projectionDelta.x),oI(this.prevProjectionDelta.y,this.projectionDelta.y)),sd(this.projectionDelta,this.layoutCorrected,S,this.latestValues),(this.treeScale.x!==_||this.treeScale.y!==v||!gI(this.projectionDelta.x,this.prevProjectionDelta.x)||!gI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",S)),Hh&&Ua.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Hc(),this.projectionDelta=Hc(),this.projectionDeltaWithTransform=Hc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=Hc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const _=Ut(),v=u?u.source:void 0,S=this.layout?this.layout.source:void 0,I=v!==S,w=this.getStack(),R=!w||w.members.length<=1,M=!!(I&&!R&&this.options.crossfade===!0&&!this.path.some(f4));this.animationProgress=0;let D;this.mixTargetDelta=L=>{const N=L/1e3;_I(p.x,o.x,N),_I(p.y,o.y,N),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(od(_,this.layout.layoutBox,this.relativeParent.layout.layoutBox),d4(this.relativeTarget,this.relativeTargetOrigin,_,N),D&&Y5(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=Ut()),Hi(D,this.relativeTarget)),I&&(this.animationValues=f,G5(f,h,this.latestValues,N,M,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ta(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Tt.update(()=>{mm.hasAnimatedSinceResize=!0,this.currentAnimation=F5(0,mI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(mI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&yA(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const p=Ai(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const _=Ai(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+_}Hi(l,u),qc(l,f),sd(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Z5),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&f_("z",o,h,this.animationValues);for(let f=0;f<d_.length;f++)f_(`rotate${d_[f]}`,o,h,this.animationValues),f_(`skew${d_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return J5;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=fm(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=fm(o?.pointerEvents)||""),this.hasProjected&&!za(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const _=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=Q5(this.projectionDeltaWithTransform,this.treeScale,_),f&&(h.transform=f(_,h.transform));const{x:v,y:S}=this.projectionDelta;h.transformOrigin=`${v.origin*100}% ${S.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=_.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:_.opacityExit:h.opacity=p===this?_.opacity!==void 0?_.opacity:"":_.opacityExit!==void 0?_.opacityExit:0;for(const I in Dm){if(_[I]===void 0)continue;const{correct:w,applyTo:R}=Dm[I],M=h.transform==="none"?_[I]:w(_[I],p);if(R){const D=R.length;for(let L=0;L<D;L++)h[R[L]]=M}else h[I]=M}return this.options.layoutId&&(h.pointerEvents=p===this?fm(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(pI),this.root.sharedNodes.clear()}}}function t4(n){n.updateLayout()}function n4(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?qi(p=>{const _=o?t.measuredBox[p]:t.layoutBox[p],v=Ai(_);_.min=i[p].min,_.max=_.min+v}):yA(s,t.layoutBox,i)&&qi(p=>{const _=o?t.measuredBox[p]:t.layoutBox[p],v=Ai(i[p]);_.max=_.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+v)});const l=Hc();sd(l,i,t.layoutBox);const u=Hc();o?sd(u,n.applyTransform(r,!0),t.measuredBox):sd(u,i,t.layoutBox);const h=!fA(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:_,layout:v}=p;if(_&&v){const S=Ut();od(S,t.layoutBox,_.layoutBox);const I=Ut();od(I,i,v.layoutBox),gA(S,I)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=S,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function i4(n){Hh&&Ua.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function r4(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function s4(n){n.clearSnapshot()}function pI(n){n.clearMeasurements()}function o4(n){n.isLayoutDirty=!1}function a4(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function yI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function l4(n){n.resolveTargetDelta()}function c4(n){n.calcProjection()}function u4(n){n.resetSkewAndRotation()}function h4(n){n.removeLeadSnapshot()}function _I(n,e,t){n.translate=Nt(e.translate,0,t),n.scale=Nt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function xI(n,e,t,i){n.min=Nt(e.min,t.min,i),n.max=Nt(e.max,t.max,i)}function d4(n,e,t,i){xI(n.x,e.x,t.x,i),xI(n.y,e.y,t.y,i)}function f4(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const g4={duration:.45,ease:[.4,0,.1,1]},vI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),wI=vI("applewebkit/")&&!vI("chrome/")?Math.round:Ri;function EI(n){n.min=wI(n.min),n.max=wI(n.max)}function m4(n){EI(n.x),EI(n.y)}function yA(n,e,t){return n==="position"||n==="preserve-aspect"&&!_5(fI(e),fI(t),.2)}function p4(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const y4=pA({attachResizeListener:(n,e)=>Id(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),g_={current:void 0},_A=pA({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!g_.current){const n=new y4({});n.mount(window),n.setOptions({layoutScroll:!0}),g_.current=n}return g_.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),_4={pan:{Feature:M5},drag:{Feature:D5,ProjectionNode:_A,MeasureLayout:uA}};function TI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Tt.postRender(()=>s(e,lf(e)))}class x4 extends la{mount(){const{current:e}=this.node;e&&(this.unmount=_O(e,t=>(TI(this.node,t,"Start"),i=>TI(this.node,i,"End"))))}unmount(){}}class v4 extends la{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=af(Id(this.node.current,"focus",()=>this.onFocus()),Id(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function SI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Tt.postRender(()=>s(e,lf(e)))}class w4 extends la{mount(){const{current:e}=this.node;e&&(this.unmount=EO(e,t=>(SI(this.node,t,"Start"),(i,{success:r})=>SI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ix=new WeakMap,m_=new WeakMap,E4=n=>{const e=Ix.get(n.target);e&&e(n)},T4=n=>{n.forEach(E4)};function S4({root:n,...e}){const t=n||document;m_.has(t)||m_.set(t,{});const i=m_.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(T4,{root:n,...e})),i[r]}function I4(n,e,t){const i=S4(e);return Ix.set(n,t),i.observe(n),()=>{Ix.delete(n),i.unobserve(n)}}const b4={some:0,all:1};class C4 extends la{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:b4[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),_=h?f:p;_&&_(u)};return I4(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(R4(e,t))&&this.startObserver()}unmount(){}}function R4({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const A4={inView:{Feature:C4},tap:{Feature:w4},focus:{Feature:v4},hover:{Feature:x4}},P4={layout:{ProjectionNode:_A,MeasureLayout:uA}},bx={current:null},xA={current:!1};function k4(){if(xA.current=!0,!!jv)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>bx.current=n.matches;n.addListener(e),e()}else bx.current=!1}const N4=[...GR,Fn,na],D4=n=>N4.find(WR(n)),II=new WeakMap;function M4(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Bn(r))n.addValue(i,r);else if(Bn(s))n.addValue(i,Td(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,Td(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const bI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class L4{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=u1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=as.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Tt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=Mp(t),this.isVariantNode=Q2(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,..._}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in _){const S=_[v];u[v]!==void 0&&Bn(S)&&S.set(u[v],!1)}}mount(e){this.current=e,II.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),xA.current||k4(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:bx.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){II.delete(this.current),this.projection&&this.projection.unmount(),ta(this.notifyUpdate),ta(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Nl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Tt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in au){const t=au[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<bI.length;i++){const r=bI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=M4(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=Td(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(UR(r)||NR(r))?r=parseFloat(r):!D4(r)&&na.test(t)&&(r=FR(e,t)),this.setBaseTarget(e,Bn(r)?r.get():r)),Bn(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Gv(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Bn(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new r1),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class vA extends L4{constructor(){super(...arguments),this.KeyframeResolver=$R}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Bn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function O4(n){return window.getComputedStyle(n)}class j4 extends vA{constructor(){super(...arguments),this.type="html",this.renderInstance=aR}readValueFromInstance(e,t){if(Nl.has(t)){const i=c1(t);return i&&i.default||0}else{const i=O4(e),r=(rR(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return lA(e,t)}build(e,t,i){Kv(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return Zv(e,t,i)}}class F4 extends vA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Nl.has(t)){const i=c1(t);return i&&i.default||0}return t=lR.has(t)?t:Uv(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return hR(e,t,i)}build(e,t,i){qv(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){cR(e,t,i,r)}mount(e){this.isSVGTag=Yv(e.tagName),super.mount(e)}}const V4=(n,e)=>Wv(n)?new F4(e):new j4(e,{allowProjection:n!==K.Fragment}),z4=hO({...c5,...A4,..._4,...P4},V4),ke=bL(z4),oi={ADD:"add",REMOVE:"remove"},cu={PROPERTYCHANGE:"propertychange"},We={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class jp{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function U4(n,e,t){let i,r;t=t||$s;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function $s(n,e){return n>e?1:n<e?-1:0}function B4(n,e){return n<e?1:n>e?-1:0}function g1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function W4(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function m1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function ca(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function G4(n,e,t){const i=e||$s;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function bd(){return!0}function Fp(){return!1}function Cd(){}function wA(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!ca(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function EA(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function cf(n){for(const e in n)delete n[e]}function uu(n){let e;for(e in n)return!1;return!e}class eo{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class uf extends jp{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new eo(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,Cd);delete o[i]}return u}disposeInternal(){this.listeners_&&cf(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Cd,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function rt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Vm(n,e,t,i){return rt(n,e,t,i,!0)}function Rt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),cf(n))}class hf extends uf{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(We.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=rt(this,e[s],t);return r}return rt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Vm(this,e[s],t)}else i=Vm(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)$4(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}hf.prototype.on;hf.prototype.once;hf.prototype.un;function $4(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Rt(n[e]);else Rt(n)}function it(){throw new Error("Unimplemented abstract method.")}let H4=0;function st(n){return n.ol_uid||(n.ol_uid=String(++H4))}class CI extends eo{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class fs extends hf{constructor(e){super(),this.on,this.once,this.un,st(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new CI(i,e,t)),i=cu.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new CI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],uu(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const RI={LENGTH:"length"};class Wg extends eo{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Zi extends fs{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(RI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Wg(oi.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Wg(oi.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Wg(oi.REMOVE,r,e)),this.dispatchEvent(new Wg(oi.ADD,t,e))}updateLength_(){this.set(RI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function ct(n,e){if(!n)throw new Error(e)}class hu extends fs{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new hu(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=rt(e,We.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?K4(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function K4(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(ct(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const hn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function AI(n){const e=nr();for(let t=0,i=n.length;t<i;++t)ad(e,n[t]);return e}function p1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function TA(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function SA(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function du(n,e){return IA(n,e[0],e[1])}function Kh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function IA(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Cx(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=hn.UNKNOWN;return o<t?u=u|hn.LEFT:o>r&&(u=u|hn.RIGHT),l<i?u=u|hn.BELOW:l>s&&(u=u|hn.ABOVE),u===hn.UNKNOWN&&(u=hn.INTERSECTING),u}function nr(){return[1/0,1/0,-1/0,-1/0]}function ia(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Vp(n){return ia(1/0,1/0,-1/0,-1/0,n)}function bA(n,e){const t=n[0],i=n[1];return ia(t,i,t,i,e)}function y1(n,e,t,i,r){const s=Vp(r);return CA(s,n,e,t,i)}function Rd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function q4(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function ad(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function CA(n,e,t,i,r){for(;t<i;t+=r)X4(n,e[t],e[t+1]);return n}function X4(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function RA(n,e){let t;return t=e(zp(n)),t||(t=e(Up(n)),t)||(t=e(Bp(n)),t)||(t=e(Dl(n)),t)?t:!1}function Rx(n){let e=0;return Wp(n)||(e=ft(n)*Yn(n)),e}function zp(n){return[n[0],n[1]]}function Up(n){return[n[2],n[1]]}function ml(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function Y4(n,e){let t;if(e==="bottom-left")t=zp(n);else if(e==="bottom-right")t=Up(n);else if(e==="top-left")t=Dl(n);else if(e==="top-right")t=Bp(n);else throw new Error("Invalid corner");return t}function Ax(n,e,t,i,r){const[s,o,l,u,h,f,p,_]=AA(n,e,t,i);return ia(Math.min(s,l,h,p),Math.min(o,u,f,_),Math.max(s,l,h,p),Math.max(o,u,f,_),r)}function AA(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,_=n[0],v=n[1];return[_-u+p,v-h-f,_-u-p,v-h+f,_+u-p,v+h+f,_+u+p,v+h-f,_-u+p,v-h-f]}function Yn(n){return n[3]-n[1]}function al(n,e,t){const i=t||nr();return ci(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Vp(i),i}function Dl(n){return[n[0],n[3]]}function Bp(n){return[n[2],n[3]]}function ft(n){return n[2]-n[0]}function ci(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Wp(n){return n[2]<n[0]||n[3]<n[1]}function Z4(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function Q4(n,e,t){let i=!1;const r=Cx(n,e),s=Cx(n,t);if(r===hn.INTERSECTING||s===hn.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],_=t[0],v=t[1],S=(v-p)/(_-f);let I,w;s&hn.ABOVE&&!(r&hn.ABOVE)&&(I=_-(v-h)/S,i=I>=o&&I<=u),!i&&s&hn.RIGHT&&!(r&hn.RIGHT)&&(w=v-(_-u)*S,i=w>=l&&w<=h),!i&&s&hn.BELOW&&!(r&hn.BELOW)&&(I=_-(v-l)/S,i=I>=o&&I<=u),!i&&s&hn.LEFT&&!(r&hn.LEFT)&&(w=v-(_-o)*S,i=w>=l&&w<=h)}return i}function PA(n,e){const t=e.getExtent(),i=ml(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ft(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function kA(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];PA(n,e);const r=ft(i);if(ft(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function J4(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Qc(n,e,t,i)}function Qc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function eF(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function PI(n){return n*180/Math.PI}function Yo(n){return n*Math.PI/180}function ll(n,e){const t=n%e;return t*e<0?t+e:t}function Ii(n,e,t){return n+t*(e-n)}function df(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function Jq(n,e){return Math.round(df(n,e))}function Gg(n,e){return Math.floor(df(n,e))}function $g(n,e){return Math.ceil(df(n,e))}function Px(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function tF(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function zm(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function _1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function nF(n,e){return n[0]*=e,n[1]*=e,n}function NA(n,e){if(e.canWrapX()){const t=ft(e.getExtent()),i=iF(n,e,t);i&&(n[0]-=i*t)}return n}function iF(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ft(i),r=Math.floor((n[0]-i[0])/t)),r}function DA(...n){console.warn(...n)}const fu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class x1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||fu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const ff=6378137,Xc=Math.PI*ff,rF=[-Xc,-Xc,Xc,Xc],sF=[-180,-85,180,85],Hg=ff*Math.log(Math.tan(Math.PI/2));class wc extends x1{constructor(e){super({code:e,units:"m",extent:rF,global:!0,worldExtent:sF,getPointResolution:function(t,i){return t/Math.cosh(i[1]/ff)}})}}const kI=[new wc("EPSG:3857"),new wc("EPSG:102100"),new wc("EPSG:102113"),new wc("EPSG:900913"),new wc("http://www.opengis.net/def/crs/EPSG/0/3857"),new wc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function oF(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Xc*n[s]/180;let o=ff*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Hg?o=Hg:o<-Hg&&(o=-Hg),e[s+1]=o}return e}function aF(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Xc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/ff))/Math.PI-90;return e}const lF=6378137,NI=[-180,-90,180,90],cF=Math.PI*lF/180;class ja extends x1{constructor(e,t){super({code:e,units:"degrees",extent:NI,axisOrientation:t,global:!0,metersPerUnit:cF,worldExtent:NI})}}const DI=[new ja("CRS:84"),new ja("EPSG:4326","neu"),new ja("urn:ogc:def:crs:OGC:1.3:CRS84"),new ja("urn:ogc:def:crs:OGC:2:84"),new ja("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ja("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ja("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let kx={};function uF(n){return kx[n]||kx[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function hF(n,e){kx[n]=e}let Jc={};function Ad(n,e,t){const i=n.getCode(),r=e.getCode();i in Jc||(Jc[i]={}),Jc[i][r]=t}function p_(n,e){return n in Jc&&e in Jc[n]?Jc[n][e]:null}const Um=.9996,er=.00669438,Gp=er*er,$p=Gp*er,Ja=er/(1-er),MI=Math.sqrt(1-er),gu=(1-MI)/(1+MI),MA=gu*gu,v1=MA*gu,w1=v1*gu,LA=w1*gu,OA=1-er/4-3*Gp/64-5*$p/256,dF=3*er/8+3*Gp/32+45*$p/1024,fF=15*Gp/256+45*$p/1024,gF=35*$p/3072,mF=3/2*gu-27/32*v1+269/512*LA,pF=21/16*MA-55/32*w1,yF=151/96*v1-417/128*LA,_F=1097/512*w1,Bm=6378137;function xF(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Um/(Bm*OA),l=o+mF*Math.sin(2*o)+pF*Math.sin(4*o)+yF*Math.sin(6*o)+_F*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,_=p*p,v=_*_,S=1-er*h,I=Math.sqrt(1-er*h),w=Bm/I,R=(1-er)/S,M=Ja*f**2,D=M*M,L=i/(w*Um),N=L*L,V=N*L,A=V*L,b=A*L,P=b*L,j=l-p/R*(N/2-A/24*(5+3*_+10*M-4*D-9*Ja))+P/720*(61+90*_+298*M+45*v-252*Ja-3*D);let z=(L-V/6*(1+2*_+M)+b/120*(5-2*M+28*_-3*D+8*Ja+24*v))/f;return z=Px(z+Yo(jA(t.number)),-Math.PI,Math.PI),[PI(z),PI(j)]}const LI=-80,OI=84,vF=-180,wF=180;function EF(n,e,t){n=Px(n,vF,wF),e<LI?e=LI:e>OI&&(e=OI);const i=Yo(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Yo(n),f=jA(t.number),p=Yo(f),_=Bm/Math.sqrt(1-er*r**2),v=Ja*s**2,S=s*Px(h-p,-Math.PI,Math.PI),I=S*S,w=I*S,R=w*S,M=R*S,D=M*S,L=Bm*(OA*i-dF*Math.sin(2*i)+fF*Math.sin(4*i)-gF*Math.sin(6*i)),N=Um*_*(S+w/6*(1-l+v)+M/120*(5-18*l+u+72*v-58*Ja))+5e5;let V=Um*(L+_*o*(I/2+R/24*(5-l+9*v+4*v**2)+D/720*(61-58*l+u+600*v-330*Ja)));return t.north||(V+=1e7),[N,V]}function jA(n){return(n-1)*6-180+3}const TF=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function FA(n){let e=0;for(const r of TF){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function jI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function SF(n){return FA(n)?new x1({code:n,units:"m"}):null}function IF(n){const e=FA(n.getCode());return e?{forward:jI(EF,e),inverse:jI(xF,e)}:null}const bF=63710088e-1;function FI(n,e,t){t=t||bF;const i=Yo(n[1]),r=Yo(e[1]),s=(r-i)/2,o=Yo(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const CF=[IF],RF=[SF];let Nx=!0;function VA(n){Nx=!1}function E1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Dx(n){hF(n.getCode(),n),Ad(n,n,E1)}function AF(n){n.forEach(Dx)}function di(n){if(typeof n!="string")return n;const e=uF(n);if(e)return e;for(const t of RF){const i=t(n);if(i)return i}return null}function Wm(n,e,t,i){n=di(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/fu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=S1(n,di("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=FI(h.slice(0,2),h.slice(2,4)),p=FI(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?fu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function VI(n){AF(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Ad(e,t,E1)})})}function PF(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Ad(r,s,t),Ad(s,r,i)})})}function T1(n,e){return n?typeof n=="string"?di(n):n:di(e)}function kF(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function pl(n,e){return VA(),Hp(n,"EPSG:4326","EPSG:3857")}function Mx(n,e){const t=Hp(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=ll(i+180,360)-180),t}function pm(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||S1(n,e)===E1)&&t}function S1(n,e){const t=n.getCode(),i=e.getCode();let r=p_(t,i);if(r)return r;let s=null,o=null;for(const u of CF)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=y_(s.inverse,o.forward);else{const u=p_(t,l);u&&(r=y_(u,o.forward))}else{const u=p_(l,i);u&&(r=y_(s.inverse,u))}return r&&(Dx(n),Dx(e),Ad(n,e,r)),r}function y_(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Gm(n,e){const t=di(n),i=di(e);return S1(t,i)}function Hp(n,e,t){const i=Gm(e,t);if(!i){const r=di(e).getCode(),s=di(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Lx(n,e){return n}function Os(n,e){return Nx&&!zm(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Nx=!1,DA("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function zA(n,e){return n}function $o(n,e){return n}function NF(){VI(kI),VI(DI),PF(DI,kI,oF,aF)}NF();new Array(6);function Ir(){return[1,0,0,1,0,0]}function DF(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function fn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Ys(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function UA(n,e){const t=MF(e);ct(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function MF(n){return n[0]*n[3]-n[1]*n[2]}const LF=[1e5,1e5,1e5,1e5,2,2];function OF(n){return"matrix("+n.join(", ")+")"}function Ox(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function jF(n,e){const t=Ox(n),i=Ox(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*LF[r])!==0)return!1;return!0}function Zo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function BA(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let _=e;_<t;_+=i){const v=n[_]-h,S=n[_+1]-f;o[p++]=h+v*l-S*u,o[p++]=f+v*u+S*l;for(let I=_+2;I<_+i;++I)o[p++]=n[I]}return o&&o.length!=p&&(o.length=p),o}function FF(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const _=n[p]-u,v=n[p+1]-h;l[f++]=u+r*_,l[f++]=h+s*v;for(let S=p+2;S<p+i;++S)l[f++]=n[S]}return l&&l.length!=f&&(l.length=f),l}function VF(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const zI=Ir(),zF=[NaN,NaN];class UF extends fs{constructor(){super(),this.extent_=nr(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=wA((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return it()}closestPointXY(e,t,i,r){return it()}containsXY(e,t){return this.closestPointXY(e,t,zF,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return it()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Vp(t),this.extentRevision_=this.getRevision()}return Z4(this.extent_,e)}rotate(e,t){it()}scale(e,t,i){it()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return it()}getType(){return it()}applyTransform(e){it()}intersectsExtent(e){return it()}translate(e,t){it()}transform(e,t){const i=di(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Yn(h)/Yn(u);Ys(zI,h[0],h[3],f,-f,0,0,0);const p=Zo(s,0,s.length,l,zI,o),_=Gm(i,t);return _?_(p,p,l):p}:Gm(i,t);return this.applyTransform(r),this}}class I1 extends UF{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return y1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return it()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=UI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){it()}setLayout(e,t,i){let r;if(e)r=UI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=BF(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();BA(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=ml(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();FF(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();VF(i,0,i.length,r,e,t,i),this.changed()}}}function BF(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function UI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function WF(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Zo(i,0,i.length,r,e,t)}function BI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const _=((r-l)*h+(s-u)*f)/(h*h+f*f);if(_>1)p=t;else if(_>0){for(let v=0;v<i;++v)o[v]=Ii(n[e+v],n[t+v],_);o.length=i;return}else p=e}for(let _=0;_<i;++_)o[_]=n[p+_];o.length=i}function WA(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Qc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function GA(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=WA(n,e,l,i,r),e=l}return r}function eX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=GA(n,e,l,i,r),e=l[l.length-1]}return r}function $A(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,_;if(r===0){if(_=Qc(o,l,n[e],n[e+1]),_<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,_}return h}f=f||[NaN,NaN];let v=e+i;for(;v<t;)if(BI(n,v-i,v,i,o,l,f),_=Qc(o,l,f[0],f[1]),_<h){for(h=_,p=0;p<i;++p)u[p]=f[p];u.length=i,v+=i}else v+=i*Math.max((Math.sqrt(_)-Math.sqrt(h))/r|0,1);if(s&&(BI(n,t-i,e,i,o,l,f),_=Qc(o,l,f[0],f[1]),_<h)){for(h=_,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function HA(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,_=t.length;p<_;++p){const v=t[p];h=$A(n,e,v,i,r,s,o,l,u,h,f),e=v}return h}function tX(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,_=t.length;p<_;++p){const v=t[p];h=HA(n,e,v,i,r,s,o,l,u,h,f),e=v[v.length-1]}return h}function GF(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function KA(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function qA(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=KA(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function nX(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=qA(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Yc(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function $m(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=Yc(n,e,u,i,r[s]),e=u}return r.length=s,r}function WI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:$m(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function GI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],_=0;const v=[0];for(let w=e+i;w<t;w+=i){const R=n[w],M=n[w+1];_+=Math.sqrt((R-f)*(R-f)+(M-p)*(M-p)),v.push(_),f=R,p=M}const S=r*_,I=U4(v,S);I<0?(u=(S-v[-I-2])/(v[-I-1]-v[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:Ii(n[l+f],n[l+i+f],u);return s}function $I(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const _=l+u>>1;r<n[(_+1)*i-1]?u=_:l=_+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let _=0;_<i-1;++_)o.push(Ii(n[(l-1)*i+_],n[l*i+_],p));return o.push(r),o}function iX(n,e,t,i,r,s,o){if(o)return $I(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return $I(n,e,f,i,r,!1);e=f}}return null}function $F(n,e,t,i,r){return!RA(r,function(o){return!el(n,e,t,i,o[0],o[1])})}function el(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function b1(n,e,t,i,r,s){if(t.length===0||!el(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(el(n,t[o-1],t[o],i,r,s))return!1;return!0}function rX(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(b1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function HF(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function C1(n,e,t,i,r,s){return s=s??CA(nr(),n,e,t,i),ci(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:HF(n,e,t,i,function(o,l){return Q4(r,o,l)}):!1}function sX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(C1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function XA(n,e,t,i,r){return!!(C1(n,e,t,i,r)||el(n,e,t,i,r[0],r[1])||el(n,e,t,i,r[0],r[3])||el(n,e,t,i,r[2],r[1])||el(n,e,t,i,r[2],r[3]))}function YA(n,e,t,i,r){if(!XA(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if($F(n,t[s-1],t[s],i,r)&&!C1(n,t[s-1],t[s],i,r))return!1;return!0}function oX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(YA(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function KF(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function R1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),_=h.pop();let v=0;const S=n[_],I=n[_+1],w=n[p],R=n[p+1];for(let M=_+i;M<p;M+=i){const D=n[M],L=n[M+1],N=J4(D,L,S,I,w,R);N>v&&(f=M,v=N)}v>r&&(u[(f-e)/i]=1,_+i<f&&h.push(_,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function qF(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=R1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ba(n,e){return e*Math.round(n/e)}function XF(n,e,t,i,r,s,o){if(e==t)return o;let l=Ba(n[e],r),u=Ba(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ba(n[e],r),f=Ba(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=Ba(n[e],r),_=Ba(n[e+1],r);if(e+=i,p==h&&_==f)continue;const v=h-l,S=f-u,I=p-l,w=_-u;if(v*w==S*I&&(v<0&&I<v||v==I||v>0&&I>v)&&(S<0&&w<S||S==w||S>0&&w>S)){h=p,f=_;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=_}return s[o++]=h,s[o++]=f,o}function A1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=XF(n,e,f,i,r,s,o),l.push(o),e=f}return o}function aX(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=A1(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class yl extends I1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new yl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Qc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return bA(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return IA(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=GF(this.flatCoordinates,0,e,this.stride),this.changed()}}const Qi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},_l=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",YF=_l.includes("safari")&&!_l.includes("chrom");YF&&(_l.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(_l));const ZF=_l.includes("webkit")&&!_l.includes("edge"),ZA=_l.includes("macintosh"),QF=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ci=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,P1=typeof Image<"u"&&Image.prototype.decode,QA=typeof createImageBitmap=="function",JA=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ue={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function nn(n,e,t,i){let r;return t&&t.length?r=t.shift():Ci?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let __;function Hm(){return __||(__=nn(1,1)),__}function Kp(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function HI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function JF(n){for(;n.lastChild;)n.lastChild.remove()}function eV(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function eP(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Ho(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const k1=[NaN,NaN,NaN,0];let x_;function tV(){return x_||(x_=nn(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),x_}const nV=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,iV=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,rV=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,sV=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Kg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ld(n){throw new Error('failed to parse "'+n+'" as color')}function tP(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(iV)||n.match(nV)||n.match(rV);if(s){const o=s[4],l=100/255;return[Dt(Kg(s[1],l)+.5|0,0,255),Dt(Kg(s[2],l)+.5|0,0,255),Dt(Kg(s[3],l)+.5|0,0,255),o!==void 0?Dt(Kg(o,100),0,1):1]}ld(n)}if(n.startsWith("#")){if(sV.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}ld(n)}const e=tV();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ld(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return tP(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=df(r[3]/255,3),r}function oV(n){return typeof n=="string"?n:D1(n)}const aV=1024,kh={};let v_=0;function lV(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function w_(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function E_(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function T_(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function S_(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function KI(n){const e=T_(n[0]),t=T_(n[1]),i=T_(n[2]),r=S_(e*.222488403+t*.716873169+i*.06060791),s=500*(S_(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-S_(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function cV(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=E_(e),s=E_(e+t/500*Math.cos(i)),o=E_(e-t/200*Math.sin(i)),l=w_(s*3.021973625-r*1.617392459-o*.404875592),u=w_(s*-.943766287+r*1.916279586+o*.027607165),h=w_(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(u+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function N1(n){if(n==="none")return k1;if(kh.hasOwnProperty(n))return kh[n];if(v_>=aV){let t=0;for(const i in kh)(t++&3)===0&&(delete kh[i],--v_)}const e=tP(n);e.length!==4&&ld(n);for(const t of e)isNaN(t)&&ld(n);return kh[n]=e,++v_,e}function mu(n){return Array.isArray(n)?n:N1(n)}function D1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class lX extends uf{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?Ue.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(We.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Ue.IDLE&&this.loader){this.state=Ue.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;EA(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||QA&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=Ue.LOADED}).catch(i=>{this.state=Ue.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function uV(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Vm(i,We.LOAD,function(){o=!0,s||e()})];return i.src&&P1?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(Vm(i,We.ERROR,t)),function(){r=!1,l.forEach(Rt)}}function hV(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function nP(n,e){return e&&(n.src=e),n.src&&P1?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):hV(n)}function cX(n,e){return e&&(n.src=e),n.src&&P1&&QA?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):nP(n)}class dV{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=I_(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=I_(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=I_(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ue.IDLE&&r.load(),r.getImageState()===Ue.LOADING?r.ready().then(()=>{this.patternCache_[o]=Hm().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Hm().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function I_(n,e,t){const i=t?mu(t):"null";return e+":"+n+":"+i}const Ji=new dV;let Nh=null;class iP extends uf{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ue.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ue.LOADED){Nh||(Nh=nn(1,1,void 0,{willReadFrequently:!0})),Nh.drawImage(this.image_,0,0);try{Nh.getImageData(0,0,1,1),this.tainted_=!1}catch{Nh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(We.CHANGE)}handleImageError_(){this.imageState_=Ue.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ue.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=nn(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ue.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ue.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&nP(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ue.LOADED)return;const t=this.image_,i=nn(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=oV(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)e();else{const t=()=>{(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)&&(this.removeEventListener(We.CHANGE,t),e())};this.addEventListener(We.CHANGE,t)}})),this.ready_}}function Km(n,e,t,i,r,s){let o=e===void 0?void 0:Ji.get(e,t,r);return o||(o=new iP(n,n&&"src"in n?n.src||void 0:e,t,i,r),Ji.set(e,t,r,o,s)),s&&o&&!Ji.getPattern(e,t,r)&&Ji.set(e,t,r,o,s),o}function ns(n){return n?Array.isArray(n)?D1(n):typeof n=="object"&&"src"in n?fV(n):n:null}function fV(n){if(!n.offset||!n.size)return Ji.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Ji.getPattern(e,void 0,n.color);if(t)return t;const i=Ji.get(n.src,"anonymous",null);if(i.getImageState()!==Ue.LOADED)return null;const r=nn(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Km(r.canvas,e,void 0,Ue.LOADED,n.color,!0),Ji.getPattern(e,void 0,n.color)}class rP{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const qg="ol-hidden",gf="ol-unselectable",M1="ol-control",qI="ol-collapsed",gV=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),XI=["style","variant","weight","size","lineHeight","family"],jx={normal:400,bold:700},Fx=function(n){const e=n.match(gV);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=XI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[XI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in jx&&(t.weight=jx[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},sP="10px sans-serif",ai="#000",pu="round",Hs=[],Ks=0,yu="round",Pd=10,kd="#000",Nd="center",qm="middle",tl=[0,0,0,0],Dd=1,Oc=new fs;let Dh=null,YI;const Vx={},mV=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function pV(n,e,t){return`${n} ${e} 16px "${t}"`}const yV=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Fx(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),_=jx[f.weight]||f.weight;return p===u&&f.style===l.style&&_==h})}async function r(){await t.ready;let s=!0;const o=Oc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(cf(Vx),Oc.set(h,100)):(f+=10,Oc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ci?self.fonts:document.fonts);const o=Fx(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(mV.has(h))continue;const f=pV(o.style,o.weight,h);Oc.get(f)===void 0&&(Oc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),_V=(function(){let n;return function(e){let t=Vx[e];if(t==null){if(Ci){const i=Fx(e),r=oP(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Vx[e]=t}return t}})();function oP(n,e){return Dh||(Dh=nn(1,1)),n!=YI&&(Dh.font=n,YI=Dh.font),Dh.measureText(e)}function aP(n,e){return oP(n,e).width}function ZI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,aP(n,s)),0);return t[e]=i,i}function xV(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const _=e[h+1]||n.font,v=aP(_,p);t.push(v),o+=v;const S=_V(_);i.push(S),u=Math.max(u,S)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function vV(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),wV(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function wV(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class EV extends rP{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?df(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Ir()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Zo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const _=s[f]-this.imageAnchorX_,v=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const S=_+this.imageAnchorX_,I=v+this.imageAnchorY_;Ys(l,S,I,1,1,h,-S,-I),o.save(),o.transform.apply(o,l),o.translate(S,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,_,v,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Zo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Zo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ci(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=WF(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ci(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ci(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ci(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ci(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),ca(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Nd;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:ns(i||ai)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Hs;this.strokeState_={lineCap:r!==void 0?r:pu,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Ks)*this.pixelRatio_,lineJoin:l!==void 0?l:yu,lineWidth:(u!==void 0?u:Dd)*this.pixelRatio_,miterLimit:h!==void 0?h:Pd,strokeStyle:ns(i||kd)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const v=t.getColor();this.textFillState_={fillStyle:ns(v||ai)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const v=i.getColor(),S=i.getLineCap(),I=i.getLineDash(),w=i.getLineDashOffset(),R=i.getLineJoin(),M=i.getWidth(),D=i.getMiterLimit();this.textStrokeState_={lineCap:S!==void 0?S:pu,lineDash:I||Hs,lineDashOffset:w||Ks,lineJoin:R!==void 0?R:yu,lineWidth:M!==void 0?M:Dd,miterLimit:D!==void 0?D:Pd,strokeStyle:ns(v||kd)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),_=e.getTextBaseline();this.textState_={font:r!==void 0?r:sP,textAlign:p!==void 0?p:Nd,textBaseline:_!==void 0?_:qm},this.text_=f!==void 0?Array.isArray(f)?f.reduce((v,S,I)=>v+=I%2?" ":S,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const TV=.5,lP={Point:kV,LineString:RV,Polygon:DV,MultiPoint:NV,MultiLineString:AV,MultiPolygon:PV,GeometryCollection:CV,Circle:IV};function SV(n,e){return parseInt(st(n),10)-parseInt(st(e),10)}function QI(n,e){const t=cP(n,e);return t*t}function cP(n,e){return TV*n/e}function IV(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function JI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let _=!0;const v=h.getImageState();v==Ue.LOADED||v==Ue.ERROR?_=!1:v==Ue.IDLE&&h.load(),_&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),bV(n,e,t,i,s,o,l),p}function bV(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())uP(n,u,t,e,o);else{const f=lP[u.getType()];f(n,u,t,e,o,s)}}function uP(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)uP(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function CV(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=lP[o[l].getType()];h(n,o[l],t,i,r,s)}}function RV(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function AV(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function PV(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function kV(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Ue.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function NV(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Ue.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function DV(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let MV=!1;function LV(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=MV,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function eb(n,e){return function(t,i,r,s,o){LV(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function OV(n,e){return[[-1/0,-1/0,1/0,1/0]]}function jV(n,e,t,i){const r=[];let s=nr();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=y1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function L1(n,e,t,i,r,s,o){let l,u,h,f,p,_,v;const S=r[s+1],I=[];for(let M=0,D=t.length;M<D;++M){const L=t[M];for(f=n[L-i],_=n[L-i+1],l=e;l<L;l+=i)p=n[l],v=n[l+1],(S<=_&&v<=S||_<=S&&S<=v)&&(h=(S-_)/(v-_)*(p-f)+f,I.push(h)),f=p,_=v}let w=NaN,R=-1/0;for(I.sort($s),f=I[0],l=1,u=I.length;l<u;++l){p=I[l];const M=Math.abs(p-f);M>R&&(h=(f+p)/2,b1(n,e,t,i,h,S)&&(w=h,R=M)),f=p}return isNaN(w)&&(w=r[s]),o?(o.push(w,S,R),o):[w,S,R]}function FV(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=L1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function VV(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function O1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function hP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=O1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function uX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!hP(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function zx(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=O1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&VV(n,e,l,i),e=l}return e}function hX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=zx(n,e,t[s],i,r);return e}function zV(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=O1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function dP(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function fP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=dP(n,e,l,i),e=l}return r}function dX(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=fP(n,e,l,i),e=l[l.length-1]}return r}class Md extends I1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Md(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<SA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(WA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$A(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return dP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Yc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=R1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Md(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=KA(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ld extends I1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?m1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ld(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<SA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(GA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),HA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return b1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return fP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),zx(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,$m(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=ml(this.getExtent());this.flatInteriorPoint_=L1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new yl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Md(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Md(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;hP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=zx(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=A1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Ld(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return YA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=qA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function tb(n){if(Wp(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Ld(s,"XY",[s.length])}const nb=Ir();class yr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?bA(this.flatCoordinates_):y1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=ml(this.getExtent());this.flatInteriorPoints_=L1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=zV(this.flatCoordinates_,this.ends_),t=jV(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=FV(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=GI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=GI(e,t,o,2,.5);m1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=di(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Yn(i)/Yn(t);Ys(nb,i[0],i[3],r,-r,0,0,0),Zo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,nb,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new yr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=wA((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=R1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=qF(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=A1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new yr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}yr.prototype.getFlatCoordinates=yr.prototype.getOrientedFlatCoordinates;function gP(n,e,t=0,i=n.length-1,r=UV){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),_=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),v=Math.max(t,Math.floor(e-h*p/u+_)),S=Math.min(i,Math.floor(e+(u-h)*p/u+_));gP(n,e,v,S,r)}const s=n[e];let o=t,l=i;for(Mh(n,t,e),r(n[i],s)>0&&Mh(n,t,i);o<l;){for(Mh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Mh(n,t,l):(l++,Mh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Mh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function UV(n,e){return n<e?-1:n>e?1:0}let mP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Yg(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;Yg(e,u)&&(t.leaf?i.push(l):C_(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!Yg(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Yg(e,o)){if(t.leaf||C_(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=jc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=BV(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&C_(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=jc(e.slice(t,i+1)),Ec(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=jc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));ib(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);ib(e,f,p,u,this.compareMinY);for(let _=f;_<=p;_+=u){const v=Math.min(_+u-1,p);l.children.push(this._build(e,_,v,r-1))}}return Ec(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=b_(h),p=$V(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Xh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=jc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,Ec(i,this.toBBox),Ec(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=jc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Ec(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=qh(e,0,l,this.toBBox),h=qh(e,l,i,this.toBBox),f=HV(u,h),p=b_(u)+b_(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:WV,s=e.leaf?this.compareMinY:GV,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=qh(e,0,t,s),l=qh(e,i-t,i,s);let u=Xg(o)+Xg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Xh(o,e.leaf?s(f):f),u+=Xg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Xh(l,e.leaf?s(f):f),u+=Xg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Xh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():Ec(e[t],this.toBBox)}};function BV(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function Ec(n,e){qh(n,0,n.children.length,e,n)}function qh(n,e,t,i,r){r||(r=jc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Xh(r,n.leaf?i(o):o)}return r}function Xh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function WV(n,e){return n.minX-e.minX}function GV(n,e){return n.minY-e.minY}function b_(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Xg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function $V(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function HV(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function C_(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Yg(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function jc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ib(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;gP(n,o,e,t,r),s.push(e,o,o,t)}}class rb{constructor(e){this.rbush_=new mP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[st(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[st(l)]=u}this.rbush_.load(i)}remove(e){const t=st(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[st(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Rd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return uu(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ia(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class pP extends fs{constructor(e){super(),this.projection=di(e.projection),this.attributions_=sb(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=sb(e),this.changed()}setState(e){this.state_=e,this.changed()}}function sb(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Ki={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Co extends eo{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class j1 extends pP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Cd,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(ct(this.format_,"`format` must be set when `url` is set"),this.loader_=eb(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:OV;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new rb:null,this.loadedExtentsRtree_=new rb,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Zi(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=st(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Co(Ki.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof yr||(this.featureChangeKeys_[e]=[rt(t,We.CHANGE,this.handleFeatureChange_,this),rt(t,cu.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof yr){const s=this.idIndex_[r];s instanceof yr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(ct(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=st(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=st(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Ki.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Co(Ki.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Ki.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Ki.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(oi.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(oi.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Co(Ki.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof yr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof yr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),uu(this.nullGeometryFeatures_)||m1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=kA(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||bd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof yr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const _=Math.sqrt(l);u[0]=i-_,u[1]=r-_,u[2]=i+_,u[3]=r+_}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=st(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Co(Ki.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:st(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&uu(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Kh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Co(Ki.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Co(Ki.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Co(Ki.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Rd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=st(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Rt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Ki.REMOVEFEATURE)&&this.dispatchEvent(new Co(Ki.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){ct(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(eb(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Rr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Rr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Km(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ue.IDLE&&t.load(),t.getImageState()===Ue.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?st(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:mu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Ou{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Ou({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function ob(n){return n[0]>0&&n[1]>0}function KV(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function hi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class qp{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=hi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new qp({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return it()}getImage(e){return it()}getHitDetectionImage(){return it()}getPixelRatio(e){return 1}getImageState(){return it()}getImageSize(){return it()}getOrigin(){return it()}getSize(){return it()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=hi(e)}listenImageChange(e){it()}load(){it()}unlistenImageChange(e){it()}ready(){return Promise.resolve()}}class Xp extends qp{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ue.LOADING:Ue.LOADED,this.imageState_===Ue.LOADING&&this.ready().then(()=>this.imageState_=Ue.LOADED),this.render()}clone(){const e=this.getScale(),t=new Xp({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Ji.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=nn(o,o);this.draw_(s,l,e),r=l.canvas,Ji.set(i,null,null,new iP(r,void 0,null,Ue.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const V=r;r=s,s=V}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),_=p/u;if(e==="miter"&&_<=i)return _*t;const v=t/2/_,S=t/2*(f/p),w=Math.sqrt((r+v)*(r+v)+S*S)-r;if(this.radius2_===void 0||e==="bevel")return w*2;const R=r*Math.sin(l),M=Math.sqrt(r*r-R*R),D=s-M,N=Math.sqrt(R*R+D*D)/R;if(N<=i){const V=N*t/2-s-r;return 2*Math.max(w,V)}return w*2}createRenderOptions(){let e=pu,t=yu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=ns(this.stroke_.getColor()??kd),l=this.stroke_.getWidth()??Dd,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??yu,e=this.stroke_.getLineCap()??pu,i=this.stroke_.getMiterLimit()??Pd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ai),t.fillStyle=ns(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=mu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=nn(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ai,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Ml extends Xp{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Ml({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class tr{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=ab,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new tr({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=ab,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function qV(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(ct(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let R_=null;function yP(n,e){if(!R_){const t=new Rr({color:"rgba(255,255,255,0.4)"}),i=new Ou({color:"#3399CC",width:1.25});R_=[new tr({image:new Ml({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return R_}function ab(n){return n.getGeometry()}const XV="#333";class mf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=hi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Rr({color:XV}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new mf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Rr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=hi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Vn={ANIMATING:0,INTERACTING:1},Re={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Zg=[Re.FILL],Ko=[Re.STROKE],nl=[Re.BEGIN_PATH],lb=[Re.CLOSE_PATH];class pf extends rP{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],du(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const _=this.tmpCoordinate_;let v=!0,S,I,w;for(S=t+r;S<i;S+=r)_[0]=e[S],_[1]=e[S+1],w=Cx(h,_),w!==I?(v&&(l[u++]=f,l[u++]=p,v=!1),l[u++]=_[0],l[u++]=_[1]):w===hn.INTERSECTING?(l[u++]=_[0],l[u++]=_[1],v=!1):v=!0,f=_[0],p=_[1],I=w;return(s&&v||S===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,_,v;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),_=[];const S=e.getEndss();v=0;for(let I=0,w=S.length;I<w;++I){const R=[];v=this.drawCustomCoordinates_(h,v,S[I],l,R),_.push(R)}this.instructions.push([Re.CUSTOM,u,_,e,i,WI,s]),this.hitDetectionInstructions.push([Re.CUSTOM,u,_,e,r||i,WI,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),v=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([Re.CUSTOM,u,p,e,i,$m,s]),this.hitDetectionInstructions.push([Re.CUSTOM,u,p,e,r||i,$m,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Re.CUSTOM,u,f,e,i,Yc,s]),this.hitDetectionInstructions.push([Re.CUSTOM,u,f,e,r||i,Yc,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Re.CUSTOM,u,f,e,i,Yc,s]),this.hitDetectionInstructions.push([Re.CUSTOM,u,f,e,r||i,Yc,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Re.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Re.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Re.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Re.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Re.END_GEOMETRY?o=t:s==Re.BEGIN_GEOMETRY&&(r[2]=t,W4(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=ns(i||ai)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=ns(i||kd);const r=e.getLineCap();t.lineCap=r!==void 0?r:pu;const s=e.getLineDash();t.lineDash=s?s.slice():Hs;const o=e.getLineDashOffset();t.lineDashOffset=o||Ks;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:yu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Dd;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Pd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Re.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Re.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!ca(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Re.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=TA(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;p1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class YV extends pf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!du(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Re.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Re.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||du(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Re.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Re.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class ZV extends pf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Re.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Re.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Hs,Ks],nl);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Re.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Hs,Ks],nl);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,_=l.length;p<_;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Ko),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Ko),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(nl)}}class cb extends pf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(nl),this.hitDetectionInstructions.push(nl);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,_=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),v=[Re.MOVE_TO_LINE_TO,p,_];this.instructions.push(v),this.hitDetectionInstructions.push(v),l&&(this.instructions.push(lb),this.hitDetectionInstructions.push(lb)),t=f}return o&&(this.instructions.push(Zg),this.hitDetectionInstructions.push(Zg)),l&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Re.SET_FILL_STYLE,ai]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Re.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Hs,Ks]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Re.CIRCLE,h];this.instructions.push(nl,f),this.hitDetectionInstructions.push(nl,f),r.fillStyle!==void 0&&(this.instructions.push(Zg),this.hitDetectionInstructions.push(Zg)),r.strokeStyle!==void 0&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Re.SET_FILL_STYLE,ai]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Re.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Hs,Ks]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Re.SET_FILL_STYLE,ai]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Re.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Hs,Ks]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,_=l.length;p<_;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ba(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function QV(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],_=e[o+r+1],v=Math.sqrt((p-h)*(p-h)+(_-f)*(_-f));if(l+=v,l>=n){const S=(n-l+v)/v,I=Ii(h,p,S),w=Ii(f,_,S);u.push(I,w),s.push(u),u=[I,w],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const S=v-l,I=Ii(h,p,S/v),w=Ii(f,_,S/v);u.push(I,w),s.push(u),u=[I,w],l=0,o+=r}}return l>0&&s.push(u),s}function JV(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,_,v,S,I,w,R,M,D;for(p=t;p<i;p+=r){const L=e[p],N=e[p+1];S!==void 0&&(M=L-S,D=N-I,v=Math.sqrt(M*M+D*D),w!==void 0&&(u+=_,f=Math.acos((w*M+R*D)/(_*v)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),_=v,w=M,R=D),S=L,I=N}return u+=v,u>l?[h,p]:[s,o]}const Xm={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class e3 extends pf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ai]={fillStyle:ai},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ci(this.maxExtent,e.getExtent()))return;let _;if(f=e.getFlatCoordinates(),h=="LineString")_=[f.length];else if(h=="MultiLineString")_=e.getEnds();else if(h=="Polygon")_=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const w=e.getEndss();_=[];for(let R=0,M=w.length;R<M;++R)_.push(w[R][0])}this.beginGeometry(e,t,i);const v=o.repeat,S=v?void 0:o.textAlign;let I=0;for(let w=0,R=_.length;w<R;++w){let M;v?M=QV(v*this.resolution,f,I,_[w],p):M=[f.slice(I,_[w])];for(let D=0,L=M.length;D<L;++D){const N=M[D];let V=0,A=N.length;if(S==null){const P=JV(o.maxAngle,N,0,N.length,2);V=P[0],A=P[1]}for(let P=V;P<A;P+=p)l.push(N[P],N[P+1]);const b=l.length;I=_[w],this.drawChars_(u,b),u=b}}this.endGeometry(t)}else{let _=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||_.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();f=[];for(let N=0,V=L.length;N<V;N+=3)o.overflow||_.push(L[N+2]/this.resolution),f.push(L[N],L[N+1]);if(f.length===0)return;p=2;break}const v=this.appendFlatPointCoordinates(f,p);if(v===u)return;if(_&&(v-u)/2!==f.length/p){let L=u/2;_=_.filter((N,V)=>{const A=l[(L+V)*2]===f[V*p]&&l[(L+V)*2+1]===f[V*p+1];return A||--L,A})}this.saveTextStates_();const S=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let w=o.padding;if(w!=tl&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],N=o.padding[1],V=o.padding[2],A=o.padding[3];o.scale[0]<0&&(N=-N,A=-A),o.scale[1]<0&&(L=-L,V=-V),w=[L,N,V,A]}const R=this.pixelRatio;this.instructions.push([Re.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==tl?tl:w.map(function(L){return L*R}),S,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]);const M=1/R,D=S?S.slice(0):null;D&&(D[1]=ai),this.hitDetectionInstructions.push([Re.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[M,M],NaN,this.declutterMode_,this.declutterImageWithText_,w,D,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ai:this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Nd,justify:t.justify,textBaseline:t.textBaseline||qm,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Xm[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,_=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Re.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,_*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Re.DRAW_CHARS,e,t,h,r.overflow,l&&ai,r.maxAngle,u,f,s,_*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=ns(o.getColor()||ai)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),w=l.getLineDashOffset(),R=l.getWidth(),M=l.getMiterLimit();s.lineCap=l.getLineCap()||pu,s.lineDash=I?I.slice():Hs,s.lineDashOffset=w===void 0?Ks:w,s.lineJoin=l.getLineJoin()||yu,s.lineWidth=R===void 0?Dd:R,s.miterLimit=M===void 0?Pd:M,s.strokeStyle=ns(l.getColor()||kd)}i=this.textState_;const u=e.getFont()||sP;yV(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||qm,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||tl,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),_=e.getRotateWithView(),v=e.getKeepUpright(),S=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=_===void 0?!1:_,this.textKeepUpright_=v===void 0?!0:v,this.textRotation_=S===void 0?0:S,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:st(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+st(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const t3={Circle:cb,Default:pf,Image:YV,LineString:ZV,Polygon:cb,Text:e3};class n3{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=t3[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function i3(n,e,t,i,r,s,o,l,u,h,f,p,_=!0){let v=n[e],S=n[e+1],I=0,w=0,R=0,M=0;function D(){I=v,w=S,e+=i,v=n[e],S=n[e+1],M+=R,R=Math.sqrt((v-I)*(v-I)+(S-w)*(S-w))}do D();while(e<t-i&&M+R<s);let L=R===0?0:(s-M)/R;const N=Ii(I,v,L),V=Ii(w,S,L),A=e-i,b=M,P=s+l*u(h,r,f);for(;e<t-i&&M+R<P;)D();L=R===0?0:(P-M)/R;const j=Ii(I,v,L),z=Ii(w,S,L);let B=!1;if(_)if(p){const ue=[N,V,j,z];BA(ue,0,4,2,p,ue,ue),B=ue[0]>ue[2]}else B=N>j;const O=Math.PI,se=[],me=A+i===e;e=A,R=0,M=b,v=n[e],S=n[e+1];let pe;if(me){D(),pe=Math.atan2(S-w,v-I),B&&(pe+=pe>0?-O:O);const ue=(j+N)/2,H=(z+V)/2;return se[0]=[ue,H,(P-s)/2,pe,r],se}r=r.replace(/\n/g," ");for(let ue=0,H=r.length;ue<H;){D();let X=Math.atan2(S-w,v-I);if(B&&(X+=X>0?-O:O),pe!==void 0){let _e=X-pe;if(_e+=_e>O?-2*O:_e<-O?2*O:0,Math.abs(_e)>o)return null}pe=X;const ne=ue;let W=0;for(;ue<H;++ue){const _e=B?H-ue-1:ue,Ce=l*u(h,r[_e],f);if(e+i<t&&M+R<s+W+Ce/2)break;W+=Ce}if(ue===ne)continue;const G=B?r.substring(H-ne,H-ue):r.substring(ne,ue);L=R===0?0:(s+W/2-M)/R;const re=Ii(I,v,L),ge=Ii(w,S,L);se.push([re,ge,W/2,X,G]),s+=W}return se}class _P{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Hm(),{get:(e,t)=>{if(typeof Hm()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Tc=nr(),Ro=[],Ms=[],Ls=[],Ao=[];function ub(n){return n[3].declutterBox}const hb=new RegExp("[-----]");function A_(n,e){return e==="start"?e=hb.test(n)?"right":"left":e==="end"&&(e=hb.test(n)?"left":"right"),Xm[e]}function r3(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function s3(n,e,t){return t%2===0&&(n+=e),n}class o3{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Ir(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new _P:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?Xm[u.justify]:A_(Array.isArray(e)?e[0]:e,u.textAlign||Nd),_=r&&o.lineWidth?o.lineWidth:0,v=Array.isArray(e)?e:String(e).split(`
`).reduce(r3,[]),{width:S,height:I,widths:w,heights:R,lineWidths:M}=xV(u,v),D=S+_,L=[],N=(D+2)*f[0],V=(I+_)*f[1],A={width:N<0?Math.floor(N):Math.ceil(N),height:V<0?Math.floor(V):Math.ceil(V),contextInstructions:L};(f[0]!=1||f[1]!=1)&&L.push("scale",f),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",_),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",l.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const b=.5-p;let P=p*D+b*_;const j=[],z=[];let B=0,O=0,se=0,me=0,pe;for(let ue=0,H=v.length;ue<H;ue+=2){const X=v[ue];if(X===`
`){O+=B,B=0,P=p*D+b*_,++me;continue}const ne=v[ue+1]||u.font;ne!==pe&&(r&&j.push("font",ne),i&&z.push("font",ne),pe=ne),B=Math.max(B,R[se]);const W=[X,P+b*w[se]+p*(w[se]-M[me]),.5*(_+B)+O];P+=w[se],r&&j.push("strokeText",W),i&&z.push("fillText",W),++se}return Array.prototype.push.apply(L,j),Array.prototype.push.apply(L,z),this.labels_[s]=A,A}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,_,v,S,I,w){l*=_[0],u*=_[1];let R=i-l,M=r-u;const D=s+h>e?e-h:s,L=o+f>t?t-f:o,N=S[3]+D*_[0]+S[1],V=S[0]+L*_[1]+S[2],A=R-S[3],b=M-S[0];(I||p!==0)&&(Ro[0]=A,Ao[0]=A,Ro[1]=b,Ms[1]=b,Ms[0]=A+N,Ls[0]=Ms[0],Ls[1]=b+V,Ao[1]=Ls[1]);let P;return p!==0?(P=Ys(Ir(),i,r,1,1,p,-i,-r),fn(P,Ro),fn(P,Ms),fn(P,Ls),fn(P,Ao),ia(Math.min(Ro[0],Ms[0],Ls[0],Ao[0]),Math.min(Ro[1],Ms[1],Ls[1],Ao[1]),Math.max(Ro[0],Ms[0],Ls[0],Ao[0]),Math.max(Ro[1],Ms[1],Ls[1],Ao[1]),Tc)):ia(Math.min(A,A+N),Math.min(b,b+V),Math.max(A,A+N),Math.max(b,b+V),Tc),v&&(R=Math.round(R),M=Math.round(M)),{drawImageX:R,drawImageY:M,drawImageW:D,drawImageH:L,originX:h,originY:f,declutterBox:{minX:Tc[0],minY:Tc[1],maxX:Tc[2],maxY:Tc[3],value:w},canvasTransform:P,scale:_}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Ro,Ms,Ls,Ao,o,l),vV(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=fn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=A_(Array.isArray(e)?e[0]:e,s.textAlign||Nd),f=Xm[s.textBaseline||qm],p=l&&l.lineWidth?l.lineWidth:0,_=o.width/u-2*s.scale[0],v=h*_+2*(.5-h)*p,S=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:v,anchorY:S}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&ca(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Zo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),DF(this.renderedTransform_,i));let p=0;const _=r.length;let v=0,S,I,w,R,M,D,L,N,V,A,b,P,j,z=0,B=0;const O=this.coordinateCache_,se=this.viewRotation_,me=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,pe={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:se},ue=this.instructions!=r||this.overlaps?0:200;let H,X,ne,W;for(;p<_;){const G=r[p];switch(G[0]){case Re.BEGIN_GEOMETRY:H=G[1],W=G[3],H.getGeometry()?l!==void 0&&!ci(l,W.getExtent())?p=G[2]+1:++p:p=G[2],h&&(h.zIndex=G[4]);break;case Re.BEGIN_PATH:z>ue&&(this.fill_(e),z=0),B>ue&&(e.stroke(),B=0),!z&&!B&&(e.beginPath(),M=NaN,D=NaN),++p;break;case Re.CIRCLE:v=G[1];const ge=f[v],_e=f[v+1],Ce=f[v+2],Ne=f[v+3],be=Ce-ge,Le=Ne-_e,Ge=Math.sqrt(be*be+Le*Le);e.moveTo(ge+Ge,_e),e.arc(ge,_e,Ge,0,2*Math.PI,!0),++p;break;case Re.CLOSE_PATH:e.closePath(),++p;break;case Re.CUSTOM:v=G[1],S=G[2];const Wt=G[3],Wn=G[4],Zt=G[5];pe.geometry=Wt,pe.feature=H,p in O||(O[p]=[]);const Pn=O[p];Zt?Zt(f,v,S,2,Pn):(Pn[0]=f[v],Pn[1]=f[v+1],Pn.length=2),h&&(h.zIndex=G[6]),Wn(Pn,pe),++p;break;case Re.DRAW_IMAGE:v=G[1],S=G[2],V=G[3],I=G[4],w=G[5];let gn=G[6];const mn=G[7],Qn=G[8],Ni=G[9],_t=G[10];let ut=G[11];const on=G[12];let Di=G[13];R=G[14]||"declutter";const It=G[15];if(!V&&G.length>=20){A=G[19],b=G[20],P=G[21],j=G[22];const jt=this.drawLabelWithPointPlacement_(A,b,P,j);V=jt.label,G[3]=V;const Oi=G[23];I=(jt.anchorX-Oi)*this.pixelRatio,G[4]=I;const pn=G[24];w=(jt.anchorY-pn)*this.pixelRatio,G[5]=w,gn=V.height,G[6]=gn,Di=V.width,G[13]=Di}let io;G.length>25&&(io=G[25]);let Mi,kr,rr;G.length>17?(Mi=G[16],kr=G[17],rr=G[18]):(Mi=tl,kr=null,rr=null),_t&&me?ut+=se:!_t&&!me&&(ut-=se);let Nr=0;for(;v<S;v+=2){if(io&&io[Nr++]<Di/this.pixelRatio)continue;const jt=this.calculateImageOrLabelDimensions_(V.width,V.height,f[v],f[v+1],Di,gn,I,w,Qn,Ni,ut,on,s,Mi,!!kr||!!rr,H),Oi=[e,t,V,jt,mn,kr,rr];if(u){let pn,Ft,yn;if(It){const ot=S-v;if(!It[ot]){It[ot]={args:Oi,declutterMode:R};continue}const Gt=It[ot];pn=Gt.args,Ft=Gt.declutterMode,delete It[ot],yn=ub(pn)}let _n,an;if(pn&&(Ft!=="declutter"||!u.collides(yn))&&(_n=!0),(R!=="declutter"||!u.collides(jt.declutterBox))&&(an=!0),Ft==="declutter"&&R==="declutter"){const ot=_n&&an;_n=ot,an=ot}_n&&(Ft!=="none"&&u.insert(yn),this.replayImageOrLabel_.apply(this,pn)),an&&(R!=="none"&&u.insert(jt.declutterBox),this.replayImageOrLabel_.apply(this,Oi))}else this.replayImageOrLabel_.apply(this,Oi)}++p;break;case Re.DRAW_CHARS:const ha=G[1],Dr=G[2],Li=G[3],Vl=G[4];j=G[5];const Mr=G[6],ys=G[7],ro=G[8];P=G[9];const Gn=G[10];A=G[11],Array.isArray(A)&&(A=A.reduce(s3,"")),b=G[12];const _s=[G[13],G[13]];R=G[14]||"declutter";const Lr=G[15],Or=this.textStates[b],$n=Or.font,Hn=[Or.scale[0]*ys,Or.scale[1]*ys];let gt;$n in this.widths_?gt=this.widths_[$n]:(gt={},this.widths_[$n]=gt);const so=KF(f,ha,Dr,2),sr=Math.abs(Hn[0])*ZI($n,A,gt);if(Vl||sr<=so){const jt=this.textStates[b].textAlign,Oi=(so-sr)*A_(A,jt),pn=i3(f,ha,Dr,2,A,Oi,Mr,Math.abs(Hn[0]),ZI,$n,gt,me?0:this.viewRotation_,Lr);e:if(pn){const Ft=[];let yn,_n,an,ot,Gt;if(P)for(yn=0,_n=pn.length;yn<_n;++yn){Gt=pn[yn],an=Gt[4],ot=this.createLabel(an,b,"",P),I=Gt[2]+(Hn[0]<0?-Gn:Gn),w=Li*ot.height+(.5-Li)*2*Gn*Hn[1]/Hn[0]-ro;const Qt=this.calculateImageOrLabelDimensions_(ot.width,ot.height,Gt[0],Gt[1],ot.width,ot.height,I,w,0,0,Gt[3],_s,!1,tl,!1,H);if(u&&R==="declutter"&&u.collides(Qt.declutterBox))break e;Ft.push([e,t,ot,Qt,1,null,null])}if(j)for(yn=0,_n=pn.length;yn<_n;++yn){Gt=pn[yn],an=Gt[4],ot=this.createLabel(an,b,j,""),I=Gt[2],w=Li*ot.height-ro;const Qt=this.calculateImageOrLabelDimensions_(ot.width,ot.height,Gt[0],Gt[1],ot.width,ot.height,I,w,0,0,Gt[3],_s,!1,tl,!1,H);if(u&&R==="declutter"&&u.collides(Qt.declutterBox))break e;Ft.push([e,t,ot,Qt,1,null,null])}u&&R!=="none"&&u.load(Ft.map(ub));for(let Qt=0,ji=Ft.length;Qt<ji;++Qt)this.replayImageOrLabel_.apply(this,Ft[Qt])}}++p;break;case Re.END_GEOMETRY:if(o!==void 0){H=G[1];const jt=o(H,W,R);if(jt)return jt}++p;break;case Re.FILL:ue?z++:this.fill_(e),++p;break;case Re.MOVE_TO_LINE_TO:for(v=G[1],S=G[2],X=f[v],ne=f[v+1],e.moveTo(X,ne),M=X+.5|0,D=ne+.5|0,v+=2;v<S;v+=2)X=f[v],ne=f[v+1],L=X+.5|0,N=ne+.5|0,(v==S-2||L!==M||N!==D)&&(e.lineTo(X,ne),M=L,D=N);++p;break;case Re.SET_FILL_STYLE:this.alignAndScaleFill_=G[2],z&&(this.fill_(e),z=0,B&&(e.stroke(),B=0)),e.fillStyle=G[1],++p;break;case Re.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,G),++p;break;case Re.STROKE:ue?B++:e.stroke(),++p;break;default:++p;break}}z&&this.fill_(e),B&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ka=["Polygon","Circle","LineString","Image","Text","Default"],xP=["Image","Text"],a3=Ka.filter(n=>!xP.includes(n));class l3{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Ir(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new o3(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Ys(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=nn(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=nr(),ad(p,e),p1(p,t*(this.renderBuffer_+r),p));const _=c3(r);let v;function S(N,V,A){const b=f.getImageData(0,0,l,l).data;for(let P=0,j=_.length;P<j;P++)if(b[_[P]]>0){if(!o||A==="none"||v!=="Image"&&v!=="Text"||o.includes(N)){const z=(_[P]-3)/4,B=r-z%l,O=r-(z/l|0),se=s(N,V,B*B+O*O);if(se)return se}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort($s);let w,R,M,D,L;for(w=I.length-1;w>=0;--w){const N=I[w].toString();for(M=this.executorsByZIndex_[N],R=Ka.length-1;R>=0;--R)if(v=Ka[R],D=M[v],D!==void 0&&(L=D.executeHitDetection(f,u,i,S,p),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Zo(l,0,8,2,e,l),l}isEmpty(){return uu(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?B4:$s),o=o||Ka;const h=Ka.length;for(let f=0,p=u.length;f<p;++f){const _=u[f].toString(),v=this.executorsByZIndex_[_];for(let S=0,I=o.length;S<I;++S){const w=o[S],R=v[w];if(R!==void 0){const M=l===null?void 0:R.getZIndexContext(),D=M?M.getContext():e,L=this.maxExtent_&&w!=="Image"&&w!=="Text";if(L&&(D.save(),this.clip(D,i)),!M||w==="Text"||w==="Image"?R.execute(D,t,i,r,s,l):M.pushFunction(N=>R.execute(N,t,i,r,s,l)),L&&D.restore(),M){M.offset();const N=u[f]*h+Ka.indexOf(w);this.deferredZIndexContexts_[N]||(this.deferredZIndexContexts_[N]=[]),this.deferredZIndexContexts_[N].push(M)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort($s);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const P_={};function c3(n){if(P_[n]!==void 0)return P_[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return P_[n]=r,r}function db(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let F1=class vP extends qp{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;ct(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||st(o)),ct(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),ct(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Ue.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Ue.LOADED:Ue.IDLE:u=Ue.LOADING:u=Ue.LOADED),this.color_=e.color!==void 0?mu(e.color):null,this.iconImage_=Km(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const _=()=>{if(this.unlistenImageChange(_),!this.initialOptions_)return;const v=this.iconImage_.getSize();this.setScale(db(v[0],v[1],e.width,e.height))};this.listenImageChange(_);return}}h!==void 0&&this.setScale(db(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new vP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Km(null,e,this.crossOrigin_,Ue.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(We.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(We.CHANGE,e)}ready(){return this.iconImage_.ready()}};const es=.5;function u3(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*es,p=n[1]*es,_=nn(f,p);_.imageSmoothingEnabled=!1;const v=_.canvas,S=new EV(_,es,r,null,o,l,null),I=t.length,w=Math.floor((256*256*256-1)/I),R={};for(let D=1;D<=I;++D){const L=t[D-1],N=L.getStyleFunction()||i;if(!N)continue;let V=N(L,s);if(!V)continue;Array.isArray(V)||(V=[V]);const b=(D*w).toString(16).padStart(7,"#00000");for(let P=0,j=V.length;P<j;++P){const z=V[P],B=z.getGeometryFunction()(L);if(!B||!ci(h,B.getExtent()))continue;const O=z.clone(),se=O.getFill();se&&se.setColor(b);const me=O.getStroke();me&&(me.setColor(b),me.setLineDash(null)),O.setText(void 0);const pe=z.getImage();if(pe){const ne=pe.getImageSize();if(!ne)continue;const W=nn(ne[0],ne[1],void 0,{alpha:!1}),G=W.canvas;W.fillStyle=b,W.fillRect(0,0,G.width,G.height),O.setImage(new F1({img:G,anchor:pe.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:pe.getOrigin(),opacity:1,size:pe.getSize(),scale:pe.getScale(),rotation:pe.getRotation(),rotateWithView:pe.getRotateWithView()}))}const ue=O.getZIndex()||0;let H=R[ue];H||(H={},R[ue]=H,H.Polygon=[],H.Circle=[],H.LineString=[],H.Point=[]);const X=B.getType();if(X==="GeometryCollection"){const ne=B.getGeometriesArrayRecursive();for(let W=0,G=ne.length;W<G;++W){const re=ne[W];H[re.getType().replace("Multi","")].push(re,O)}}else H[X.replace("Multi","")].push(B,O)}}const M=Object.keys(R).map(Number).sort($s);for(let D=0,L=M.length;D<L;++D){const N=R[M[D]];for(const V in N){const A=N[V];for(let b=0,P=A.length;b<P;b+=2){S.setStyle(A[b+1]);for(let j=0,z=e.length;j<z;++j)S.setTransform(e[j]),S.drawGeometry(A[b])}}}return _.getImageData(0,0,v.width,v.height)}function h3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*es),s=Math.floor(Math.round(n[1])*es),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class wP extends eo{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const d3=5;class f3 extends hf{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=d3}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return it()}getData(e){return null}prepareFrame(e){return it()}renderFrame(e,t){return it()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ue.LOADED||t.getState()===Ue.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ue.LOADED&&t!=Ue.ERROR&&e.addEventListener(We.CHANGE,this.boundHandleImageChange_),t==Ue.IDLE&&(e.load(),t=e.getState()),t==Ue.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const fb=[];let Fc=null;function g3(){Fc=nn(1,1,void 0,{willReadFrequently:!0})}class EP extends f3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Ir(),this.pixelTransform=Ir(),this.inversePixelTransform=Ir(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Fc||g3(),Fc.clearRect(0,0,1,1);let r;try{Fc.drawImage(e,t,i,1,1,0,0,1,1),r=Fc.getImageData(0,0,1,1).data}catch{return Fc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&ca(mu(e.style.backgroundColor),mu(i)))){const l=e.firstElementChild;Ho(l)&&(o=l.getContext("2d"))}if(o&&jF(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ci?eP():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=nn();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Dl(i),s=Bp(i),o=Up(i),l=zp(i);fn(t.coordinateToPixelTransform,r),fn(t.coordinateToPixelTransform,s),fn(t.coordinateToPixelTransform,o),fn(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;fn(u,r),fn(u,s),fn(u,o),fn(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(ft(i)/r*o),u=Math.round(Yn(i)/r*o);Ys(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),UA(this.inversePixelTransform,this.pixelTransform);const h=OF(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new wP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Qi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Qi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new _P),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Qi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Qi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,_=-e[0]+l,v=-e[1];return Ys(this.tempTransform,u,h,f,p,-i,_,v)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class m3 extends EP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=nr(),this.wrappedRenderedExtent_=nr(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),_=this.getLayer().getDeclutter(),v=t.pixelRatio,S=t.viewHints,I=!(S[Vn.ANIMATING]||S[Vn.INTERACTING]),w=this.context,R=Math.round(ft(r)/l*v),M=Math.round(Yn(r)/l*v),D=p.getWrapX()&&u.canWrapX(),L=D?ft(f):null,N=D?Math.ceil((r[2]-f[2])/L)+1:1;let V=D?Math.floor((r[0]-f[0])/L):0;do{let A=this.getRenderTransform(o,l,0,v,R,M,V*L);t.declutter&&(A=A.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],A,h,I,i===void 0?Ka:i?xP:a3,i?_&&t.declutter[_]:void 0)}while(++V<N)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=nn(this.context.canvas.width,this.context.canvas.height,fb))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Kp(this.context),fb.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Qi.PRERENDER)||this.getLayer().hasListener(Qi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=$o(i.extent);l=ci(u,e.extent),this.clipped_=l&&!Kh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*es,_=i[1]*es;f.push(this.getRenderTransform(r,s,o,es,p,_,0).slice());const v=h.getSource(),S=l.getExtent();if(v.getWrapX()&&l.canWrapX()&&!Kh(S,u)){let I=u[0];const w=ft(S);let R=0,M;for(;I<S[0];)--R,M=w*R,f.push(this.getRenderTransform(r,s,o,es,p,_,M).slice()),I+=w;for(R=0,I=u[2];I>S[2];)++R,M=w*R,f.push(this.getRenderTransform(r,s,o,es,p,_,M).slice()),I-=w}this.hitDetectionImageData_=u3(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,QI(s,this.renderedPixelRatio_))}t(h3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(_,v,S){const I=st(_),w=h[I];if(w){if(w!==!0&&S<w.distanceSq){if(S===0)return h[I]=!0,s.splice(s.lastIndexOf(w),1),r(_,u,v);w.geometry=v,w.distanceSq=S}}else{if(S===0)return h[I]=!0,r(_,u,v);s.push(h[I]={feature:_,layer:u,geometry:v,distanceSq:S,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(_=>_.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Vn.ANIMATING],s=e.viewHints[Vn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,_=e.pixelRatio,v=t.getRevision(),S=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=SV);const w=h.center.slice(),R=p1(u,S*p),M=R.slice(),D=[R.slice()],L=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Kh(L,e.extent)){const se=ft(L),me=Math.max(ft(R)/2,se);R[0]=L[0]-me,R[2]=L[2]+me,NA(w,f);const pe=PA(D[0],f);pe[0]<L[0]&&pe[2]<L[2]?D.push([pe[0]+se,pe[1],pe[2]+se,pe[3]]):pe[0]>L[0]&&pe[2]>L[2]&&D.push([pe[0]-se,pe[1],pe[2]-se,pe[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==v&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Kh(this.wrappedRenderedExtent_,R))return ca(this.renderedExtent_,M)||(this.hitDetectionImageData_=null,this.renderedExtent_=M),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const N=new n3(cP(p,_),R,p,_);let V;for(let se=0,me=D.length;se<me;++se)i.loadFeatures(D[se],p,f);const A=QI(p,_);let b=!0;const P=(se,me)=>{let pe;const ue=se.getStyleFunction()||t.getStyleFunction();if(ue&&(pe=ue(se,p)),pe){const H=this.renderFeature(se,A,pe,N,V,this.getLayer().getDeclutter(),me);b=b&&!H}},j=zA(R),z=i.getFeaturesInExtent(j);I&&z.sort(I);for(let se=0,me=z.length;se<me;++se)P(z[se],se);this.renderedFeatures_=z,this.ready=b;const B=N.finish(),O=new l3(R,p,_,i.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=v,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=M,this.wrappedRenderedExtent_=R,this.renderedCenter_=w,this.renderedProjection_=f,this.renderedPixelRatio_=_,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=JI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=JI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Ll=0;const Xn=1<<Ll++,Ze=1<<Ll++,li=1<<Ll++,_r=1<<Ll++,xl=1<<Ll++,Yh=1<<Ll++,Qg=Math.pow(2,Ll)-1,V1={[Xn]:"boolean",[Ze]:"number",[li]:"string",[_r]:"color",[xl]:"number[]",[Yh]:"size"},p3=Object.keys(V1).map(Number).sort($s);function y3(n){return n in V1}function Zh(n){const e=[];for(const t of p3)Qh(n,t)&&e.push(V1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Qh(n,e){return(n&e)===e}function Po(n,e){return n===e}class tn{constructor(e,t){if(!y3(e))throw new Error(`literal expressions must have a specific type, got ${Zh(e)}`);this.type=e,this.value=t}}class _3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function TP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Rn(n,e,t){switch(typeof n){case"boolean":{if(Po(e,li))return new tn(li,n?"true":"false");if(!Qh(e,Xn))throw new Error(`got a boolean, but expected ${Zh(e)}`);return new tn(Xn,n)}case"number":{if(Po(e,Yh))return new tn(Yh,hi(n));if(Po(e,Xn))return new tn(Xn,!!n);if(Po(e,li))return new tn(li,n.toString());if(!Qh(e,Ze))throw new Error(`got a number, but expected ${Zh(e)}`);return new tn(Ze,n)}case"string":{if(Po(e,_r))return new tn(_r,N1(n));if(Po(e,Xn))return new tn(Xn,!!n);if(!Qh(e,li))throw new Error(`got a string, but expected ${Zh(e)}`);return new tn(li,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return A3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Po(e,Yh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new tn(Yh,n)}if(Po(e,_r)){if(n.length===3)return new tn(_r,[...n,1]);if(n.length===4)return new tn(_r,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Qh(e,xl))throw new Error(`got an array of numbers, but expected ${Zh(e)}`);return new tn(xl,n)}const ie={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},x3={[ie.Get]:Ve($e(1,1/0),gb),[ie.Var]:Ve($e(1,1),v3),[ie.Has]:Ve($e(1,1/0),gb),[ie.Id]:Ve(w3,Sc),[ie.Concat]:Ve($e(2,1/0),lt(li)),[ie.GeometryType]:Ve(E3,Sc),[ie.LineMetric]:Ve(Sc),[ie.Resolution]:Ve(k_,Sc),[ie.Zoom]:Ve(k_,Sc),[ie.Time]:Ve(k_,Sc),[ie.Any]:Ve($e(2,1/0),lt(Xn)),[ie.All]:Ve($e(2,1/0),lt(Xn)),[ie.Not]:Ve($e(1,1),lt(Xn)),[ie.Equal]:Ve($e(2,2),lt(Qg)),[ie.NotEqual]:Ve($e(2,2),lt(Qg)),[ie.GreaterThan]:Ve($e(2,2),lt(Ze)),[ie.GreaterThanOrEqualTo]:Ve($e(2,2),lt(Ze)),[ie.LessThan]:Ve($e(2,2),lt(Ze)),[ie.LessThanOrEqualTo]:Ve($e(2,2),lt(Ze)),[ie.Multiply]:Ve($e(2,1/0),mb),[ie.Coalesce]:Ve($e(2,1/0),mb),[ie.Divide]:Ve($e(2,2),lt(Ze)),[ie.Add]:Ve($e(2,1/0),lt(Ze)),[ie.Subtract]:Ve($e(2,2),lt(Ze)),[ie.Clamp]:Ve($e(3,3),lt(Ze)),[ie.Mod]:Ve($e(2,2),lt(Ze)),[ie.Pow]:Ve($e(2,2),lt(Ze)),[ie.Abs]:Ve($e(1,1),lt(Ze)),[ie.Floor]:Ve($e(1,1),lt(Ze)),[ie.Ceil]:Ve($e(1,1),lt(Ze)),[ie.Round]:Ve($e(1,1),lt(Ze)),[ie.Sin]:Ve($e(1,1),lt(Ze)),[ie.Cos]:Ve($e(1,1),lt(Ze)),[ie.Atan]:Ve($e(1,2),lt(Ze)),[ie.Sqrt]:Ve($e(1,1),lt(Ze)),[ie.Match]:Ve($e(4,1/0),pb,S3),[ie.Between]:Ve($e(3,3),lt(Ze)),[ie.Interpolate]:Ve($e(6,1/0),pb,I3),[ie.Case]:Ve($e(3,1/0),T3,b3),[ie.In]:Ve($e(2,2),C3),[ie.Number]:Ve($e(1,1/0),lt(Qg)),[ie.String]:Ve($e(1,1/0),lt(Qg)),[ie.Array]:Ve($e(1,1/0),lt(Ze)),[ie.Color]:Ve($e(1,4),lt(Ze)),[ie.Band]:Ve($e(1,3),lt(Ze)),[ie.Palette]:Ve($e(2,2),R3),[ie.ToString]:Ve($e(1,1),lt(Xn|Ze|li|_r))};function gb(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new tn(Ze,o);break}case"string":{r[s]=new tn(li,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function v3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new tn(li,i)]}function w3(n,e,t){t.featureId=!0}function E3(n,e,t){t.geometryType=!0}function k_(n,e,t){t.mapState=!0}function Sc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function $e(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function mb(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Rn(n[s+1],e,t);r[s]=o}return r}function lt(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=Rn(e[o+1],n,i);s[o]=l}return s}}function T3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function pb(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function S3(n,e,t){const i=n.length-1,r=li|Ze|Xn,s=Rn(n[1],r,t),o=Rn(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=Rn(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Rn(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function I3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new tn(Ze,r);let o;try{o=Rn(n[2],Ze,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=Rn(n[u+3],Ze,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Rn(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function b3(n,e,t){const i=Rn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Rn(n[s+1],Xn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Rn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function C3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=li}else r=Ze;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=Rn(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[Rn(n[1],r,t),...s]}function R3(n,e,t){let i;try{i=Rn(n[1],Ze,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=Rn(r[o],_r,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof tn))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Ve(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new _3(t,r,...s)}}function A3(n,e,t){const i=n[0],r=x3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function SP(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return SP(n.getGeometries()[0]);default:return""}}function IP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function to(n,e,t){const i=Rn(n,e,t);return Ar(i)}function Ar(n,e){if(n instanceof tn){if(n.type===_r&&typeof n.value=="string"){const i=N1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case ie.Number:case ie.String:case ie.Coalesce:return P3(n);case ie.Get:case ie.Var:case ie.Has:return k3(n);case ie.Id:return i=>i.featureId;case ie.GeometryType:return i=>i.geometryType;case ie.Concat:{const i=n.args.map(r=>Ar(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case ie.Resolution:return i=>i.resolution;case ie.Any:case ie.All:case ie.Between:case ie.In:case ie.Not:return D3(n);case ie.Equal:case ie.NotEqual:case ie.LessThan:case ie.LessThanOrEqualTo:case ie.GreaterThan:case ie.GreaterThanOrEqualTo:return N3(n);case ie.Multiply:case ie.Divide:case ie.Add:case ie.Subtract:case ie.Clamp:case ie.Mod:case ie.Pow:case ie.Abs:case ie.Floor:case ie.Ceil:case ie.Round:case ie.Sin:case ie.Cos:case ie.Atan:case ie.Sqrt:return M3(n);case ie.Case:return L3(n);case ie.Match:return O3(n);case ie.Interpolate:return j3(n);case ie.ToString:return F3(n);default:throw new Error(`Unsupported operator ${t}`)}}function P3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ar(n.args[s]);switch(t){case ie.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case ie.Number:case ie.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function k3(n,e){const i=n.args[0].value;switch(n.operator){case ie.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case ie.Var:return r=>r.variables[i];case ie.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function N3(n,e){const t=n.operator,i=Ar(n.args[0]),r=Ar(n.args[1]);switch(t){case ie.Equal:return s=>i(s)===r(s);case ie.NotEqual:return s=>i(s)!==r(s);case ie.LessThan:return s=>i(s)<r(s);case ie.LessThanOrEqualTo:return s=>i(s)<=r(s);case ie.GreaterThan:return s=>i(s)>r(s);case ie.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function D3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ar(n.args[s]);switch(t){case ie.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case ie.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case ie.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case ie.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case ie.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function M3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ar(n.args[s]);switch(t){case ie.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case ie.Divide:return s=>r[0](s)/r[1](s);case ie.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case ie.Subtract:return s=>r[0](s)-r[1](s);case ie.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case ie.Mod:return s=>r[0](s)%r[1](s);case ie.Pow:return s=>Math.pow(r[0](s),r[1](s));case ie.Abs:return s=>Math.abs(r[0](s));case ie.Floor:return s=>Math.floor(r[0](s));case ie.Ceil:return s=>Math.ceil(r[0](s));case ie.Round:return s=>Math.round(r[0](s));case ie.Sin:return s=>Math.sin(r[0](s));case ie.Cos:return s=>Math.cos(r[0](s));case ie.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case ie.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function L3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ar(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function O3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ar(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function j3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ar(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const _=Array.isArray(p);if(_&&(p=lV(p)),f>=o)return h===2?p:_?V3(s,o,l,u,f,p):Jh(s,o,l,u,f,p);l=f,u=p}return u}}function F3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ar(n.args[s]);if(t===ie.ToString)return s=>{const o=r[0](s);return n.args[0].type===_r?D1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Jh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function V3(n,e,t,i,r,s){if(r-t===0)return i;const l=KI(i),u=KI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Jh(n,e,t,l[0],r,u[0]),Jh(n,e,t,l[1],r,u[1]),l[2]+Jh(n,e,t,0,r,h),Jh(n,e,t,i[3],r,s[3])];return cV(f)}function z3(n){return!0}function U3(n){const e=TP(),t=B3(n,e),i=IP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=SP(r.getGeometry())),t(i)}}function yb(n){const e=TP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Ux(n[o],e);const r=IP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function B3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?to(s.filter,Xn,e):z3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Ux(s.style[h],e)}else l=[Ux(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Ux(n,e){const t=Od(n,"",e),i=jd(n,"",e),r=W3(n,e),s=G3(n,e),o=ui(n,"z-index",e);if(!t&&!i&&!r&&!s&&!uu(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new tr;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Od(n,e,t){let i;if(e+"fill-pattern-src"in n)i=q3(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=z1(n,e+"fill-color",t)}if(!i)return null;const r=new Rr;return function(s){const o=i(s);return o===k1?null:(r.setColor(o),r)}}function jd(n,e,t){const i=ui(n,e+"stroke-width",t),r=z1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=js(n,e+"stroke-line-cap",t),o=js(n,e+"stroke-line-join",t),l=bP(n,e+"stroke-line-dash",t),u=ui(n,e+"stroke-line-dash-offset",t),h=ui(n,e+"stroke-miter-limit",t),f=new Ou;return function(p){if(r){const _=r(p);if(_===k1)return null;f.setColor(_)}if(i&&f.setWidth(i(p)),s){const _=s(p);if(_!=="butt"&&_!=="round"&&_!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(_)}if(o){const _=o(p);if(_!=="bevel"&&_!=="round"&&_!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(_)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function W3(n,e){const t="text-",i=js(n,t+"value",e);if(!i)return null;const r=Od(n,t,e),s=Od(n,t+"background-",e),o=jd(n,t,e),l=jd(n,t+"background-",e),u=js(n,t+"font",e),h=ui(n,t+"max-angle",e),f=ui(n,t+"offset-x",e),p=ui(n,t+"offset-y",e),_=eu(n,t+"overflow",e),v=js(n,t+"placement",e),S=ui(n,t+"repeat",e),I=Yp(n,t+"scale",e),w=eu(n,t+"rotate-with-view",e),R=ui(n,t+"rotation",e),M=js(n,t+"align",e),D=js(n,t+"justify",e),L=js(n,t+"baseline",e),N=eu(n,t+"keep-upright",e),V=bP(n,t+"padding",e),A=Zp(n,t+"declutter-mode"),b=new mf({declutterMode:A});return function(P){if(b.setText(i(P)),r&&b.setFill(r(P)),s&&b.setBackgroundFill(s(P)),o&&b.setStroke(o(P)),l&&b.setBackgroundStroke(l(P)),u&&b.setFont(u(P)),h&&b.setMaxAngle(h(P)),f&&b.setOffsetX(f(P)),p&&b.setOffsetY(p(P)),_&&b.setOverflow(_(P)),v){const j=v(P);if(j!=="point"&&j!=="line")throw new Error("Expected point or line for text-placement");b.setPlacement(j)}if(S&&b.setRepeat(S(P)),I&&b.setScale(I(P)),w&&b.setRotateWithView(w(P)),R&&b.setRotation(R(P)),M){const j=M(P);if(j!=="left"&&j!=="center"&&j!=="right"&&j!=="end"&&j!=="start")throw new Error("Expected left, right, center, start, or end for text-align");b.setTextAlign(j)}if(D){const j=D(P);if(j!=="left"&&j!=="right"&&j!=="center")throw new Error("Expected left, right, or center for text-justify");b.setJustify(j)}if(L){const j=L(P);if(j!=="bottom"&&j!=="top"&&j!=="middle"&&j!=="alphabetic"&&j!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");b.setTextBaseline(j)}return V&&b.setPadding(V(P)),N&&b.setKeepUpright(N(P)),b}}function G3(n,e){return"icon-src"in n?$3(n,e):"shape-points"in n?H3(n,e):"circle-radius"in n?K3(n,e):null}function $3(n,e){const t="icon-",i=t+"src",r=CP(n[i],i),s=Ym(n,t+"anchor",e),o=Yp(n,t+"scale",e),l=ui(n,t+"opacity",e),u=Ym(n,t+"displacement",e),h=ui(n,t+"rotation",e),f=eu(n,t+"rotate-with-view",e),p=xb(n,t+"anchor-origin"),_=vb(n,t+"anchor-x-units"),v=vb(n,t+"anchor-y-units"),S=Q3(n,t+"color"),I=Y3(n,t+"cross-origin"),w=Z3(n,t+"offset"),R=xb(n,t+"offset-origin"),M=Zm(n,t+"width"),D=Zm(n,t+"height"),L=X3(n,t+"size"),N=Zp(n,t+"declutter-mode"),V=new F1({src:r,anchorOrigin:p,anchorXUnits:_,anchorYUnits:v,color:S,crossOrigin:I,offset:w,offsetOrigin:R,height:D,width:M,size:L,declutterMode:N});return function(A){return l&&V.setOpacity(l(A)),u&&V.setDisplacement(u(A)),h&&V.setRotation(h(A)),f&&V.setRotateWithView(f(A)),o&&V.setScale(o(A)),s&&V.setAnchor(s(A)),V}}function H3(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Bx(n[i],i),o=Bx(n[r],r),l=Od(n,t,e),u=jd(n,t,e),h=Yp(n,t+"scale",e),f=Ym(n,t+"displacement",e),p=ui(n,t+"rotation",e),_=eu(n,t+"rotate-with-view",e),v=Zm(n,t+"radius2"),S=Zm(n,t+"angle"),I=Zp(n,t+"declutter-mode"),w=new Xp({points:s,radius:o,radius2:v,angle:S,declutterMode:I});return function(R){return l&&w.setFill(l(R)),u&&w.setStroke(u(R)),f&&w.setDisplacement(f(R)),p&&w.setRotation(p(R)),_&&w.setRotateWithView(_(R)),h&&w.setScale(h(R)),w}}function K3(n,e){const t="circle-",i=Od(n,t,e),r=jd(n,t,e),s=ui(n,t+"radius",e),o=Yp(n,t+"scale",e),l=Ym(n,t+"displacement",e),u=ui(n,t+"rotation",e),h=eu(n,t+"rotate-with-view",e),f=Zp(n,t+"declutter-mode"),p=new Ml({radius:5,declutterMode:f});return function(_){return s&&p.setRadius(s(_)),i&&p.setFill(i(_)),r&&p.setStroke(r(_)),l&&p.setDisplacement(l(_)),u&&p.setRotation(u(_)),h&&p.setRotateWithView(h(_)),o&&p.setScale(o(_)),p}}function ui(n,e,t){if(!(e in n))return;const i=to(n[e],Ze,t);return function(r){return Bx(i(r),e)}}function js(n,e,t){if(!(e in n))return null;const i=to(n[e],li,t);return function(r){return CP(i(r),e)}}function q3(n,e,t){const i=js(n,e+"pattern-src",t),r=_b(n,e+"pattern-offset",t),s=_b(n,e+"pattern-size",t),o=z1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function eu(n,e,t){if(!(e in n))return null;const i=to(n[e],Xn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function z1(n,e,t){if(!(e in n))return null;const i=to(n[e],_r,t);return function(r){return RP(i(r),e)}}function bP(n,e,t){if(!(e in n))return null;const i=to(n[e],xl,t);return function(r){return yf(i(r),e)}}function Ym(n,e,t){if(!(e in n))return null;const i=to(n[e],xl,t);return function(r){const s=yf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function _b(n,e,t){if(!(e in n))return null;const i=to(n[e],xl,t);return function(r){return AP(i(r),e)}}function Yp(n,e,t){if(!(e in n))return null;const i=to(n[e],xl|Ze,t);return function(r){return J3(i(r),e)}}function Zm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function X3(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return hi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function Y3(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function xb(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function vb(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function Z3(n,e){const t=n[e];if(t!==void 0)return yf(t,e)}function Zp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function Q3(n,e){const t=n[e];if(t!==void 0)return RP(t,e)}function yf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function CP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Bx(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function RP(n,e){if(typeof n=="string")return n;const t=yf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function AP(n,e){const t=yf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function J3(n,e){return typeof n=="number"?n:AP(n,e)}const gr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function wb(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let _=n[0]+u/2+f,v=n[2]-u/2+f,S=n[1]+h/2+p,I=n[3]-h/2+p;_>v&&(_=(v+_)/2,v=_),S>I&&(S=(I+S)/2,I=S);let w=Dt(i[0],_,v),R=Dt(i[1],S,I);if(o&&t&&r){const M=30*r;w+=-M*Math.log(1+Math.max(0,_-i[0])/M)+M*Math.log(1+Math.max(0,i[0]-v)/M),R+=-M*Math.log(1+Math.max(0,S-i[1])/M)+M*Math.log(1+Math.max(0,i[1]-I)/M)}return[w,R]})}function e6(n){return n}function PP(n){return Math.pow(n,3)}function ju(n){return 1-PP(1-n)}function t6(n){return 3*n*n-2*n*n*n}function n6(n){return n}function U1(n,e,t,i){const r=ft(e)/t[0],s=Yn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function B1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function i6(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?U1(u,t,o,i):u;if(l)return e?B1(r,f,h):Dt(r,h,f);const p=Math.min(f,r),_=Math.floor(g1(n,p,s));return n[_]>f&&_<n.length-1?n[_+1]:n[_]}})}function r6(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?U1(e,r,u,s):e;if(h)return i?B1(o,f,t):Dt(o,t,f);const p=1e-9,_=Math.ceil(Math.log(e/f)/Math.log(n)-p),v=-l*(.5-p)+.5,S=Math.min(f,o),I=Math.floor(Math.log(e/S)/Math.log(n)+v),w=Math.max(_,I),R=e/Math.pow(n,w);return Dt(R,t,f)}})}function Eb(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?U1(n,i,l,r):n;return!t||!u?Dt(s,e,h):B1(s,h,e)}})}function W1(n){if(n!==void 0)return 0}function Tb(n){if(n!==void 0)return n}function s6(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function o6(n){const e=Yo(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const a6=42,G1=256,N_=0;class ts extends fs{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=T1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&VA(),e.center&&(e.center=Os(e.center,this.projection_)),e.extent&&(e.extent=$o(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in gr)delete t[l];this.setProperties(t,!0);const i=c6(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=l6(e),s=i.constraint,o=u6(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Os(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Os(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&Jg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||t6,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const _=ll(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+_,u=p.targetRotation}h6(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Vn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Vn.ANIMATING]>0}getInteracting(){return this.hints_[Vn.INTERACTING]>0}cancelAnimations(){this.setHint(Vn.ANIMATING,-this.hints_[Vn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Jg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const _=u.sourceCenter[0],v=u.sourceCenter[1],S=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const w=_+p*(S-_),R=v+p*(I-v);this.targetCenter_=[w,R]}if(u.sourceResolution&&u.targetResolution){const _=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const v=this.getViewportSize_(this.getRotation()),S=this.constraints_.resolution(_,0,v,!0);this.targetCenter_=this.calculateCenterZoom(S,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=_,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const _=p===1?ll(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const v=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(v,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=_}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Vn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Jg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],_1(i,e-this.getRotation()),tF(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Lx(e,this.getProjection())}getCenterInternal(){return this.get(gr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return zA(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();ct(t,"The view center is not defined");const i=this.getResolution();ct(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return ct(r!==void 0,"The view rotation is not defined"),Ax(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(gr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal($o(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ft(e)/t[0],r=Yn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(gr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=D_(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=g1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(ct(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){ct(!Wp(e),"Cannot fit empty extent provided as `geometry`");const r=$o(e,this.getProjection());i=tb(r)}else if(e.getType()==="Circle"){const r=$o(e.getExtent(),this.getProjection());i=tb(r),i.rotate(this.getRotation(),ml(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,_=s.length;p<_;p+=o){const v=s[p]*i-s[p+1]*r,S=s[p]*r+s[p+1]*i;l=Math.min(l,v),u=Math.min(u,S),h=Math.max(h,v),f=Math.max(f,S)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),_=ml(l);_[0]+=(r[1]-r[3])/2*u,_[1]+=(r[0]-r[2])/2*u;const v=_[0]*p-_[1]*f,S=_[1]*p+_[0]*f,I=this.getConstrainedCenter([v,S],u),w=t.callback?t.callback:Cd;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},w):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),Jg(w,!0))}centerOn(e,t,i){this.centerOnInternal(Os(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(D_(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=D_(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Lx(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Os(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Os(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Os(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(gr.ROTATION)!==r&&this.set(gr.ROTATION,r),this.get(gr.RESOLUTION)!==o&&(this.set(gr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(gr.CENTER)||!zm(this.get(gr.CENTER),l))&&this.set(gr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!zm(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:ju,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Vn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Os(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Vn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Jg(n,e){setTimeout(function(){n(e)},0)}function l6(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return wb(n.extent,n.constrainOnlyCenter,t)}const e=T1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,wb(t,!1,!1)}return e6}function c6(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:N_,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,_=T1(n.projection,"EPSG:3857"),v=_.getExtent();let S=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&_.isGlobal()&&(S=!1,I=v),n.resolutions!==void 0){const w=n.resolutions;t=w[o],i=w[l]!==void 0?w[l]:w[w.length-1],n.constrainResolution?e=i6(w,f,!S&&I,p):e=Eb(t,i,f,!S&&I,p)}else{const R=(v?Math.max(ft(v),Yn(v)):360*fu.degrees/_.getMetersPerUnit())/G1/Math.pow(2,N_),M=R/Math.pow(2,28-N_);t=n.maxResolution,t!==void 0?o=0:t=R/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=R/Math.pow(u,l):i=M),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=r6(u,t,i,f,!S&&I,p):e=Eb(t,i,f,!S&&I,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function u6(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?o6():t===!1?Tb:typeof t=="number"?s6(t):Tb}return W1}function h6(n){return!(n.sourceCenter&&n.targetCenter&&!zm(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function D_(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const dt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class kP extends fs{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[dt.OPACITY]=e.opacity!==void 0?e.opacity:1,ct(typeof t[dt.OPACITY]=="number","Layer opacity must be a number"),t[dt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[dt.Z_INDEX]=e.zIndex,t[dt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[dt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[dt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[dt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return it()}getLayerStatesArray(e){return it()}getExtent(){return this.get(dt.EXTENT)}getMaxResolution(){return this.get(dt.MAX_RESOLUTION)}getMinResolution(){return this.get(dt.MIN_RESOLUTION)}getMinZoom(){return this.get(dt.MIN_ZOOM)}getMaxZoom(){return this.get(dt.MAX_ZOOM)}getOpacity(){return this.get(dt.OPACITY)}getSourceState(){return it()}getVisible(){return this.get(dt.VISIBLE)}getZIndex(){return this.get(dt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(dt.EXTENT,e)}setMaxResolution(e){this.set(dt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(dt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(dt.MAX_ZOOM,e)}setMinZoom(e){this.set(dt.MIN_ZOOM,e)}setOpacity(e){ct(typeof e=="number","Layer opacity must be a number"),this.set(dt.OPACITY,e)}setVisible(e){this.set(dt.VISIBLE,e)}setZIndex(e){this.set(dt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Qp extends kP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(dt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(dt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=rt(e,We.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof ts?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return $1(r,t.viewState)&&(!s||ci(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof ts?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(dt.MAP,e)}getMapInternal(){return this.get(dt.MAP)}setMap(e){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=rt(e,Qi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=rt(this,We.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);ct(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(dt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function $1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const Sb={RENDER_ORDER:"renderOrder"};class NP extends Qp{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Sb.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new mP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(Sb.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?yP:e;const t=d6(e);this.styleFunction_=e===null?void 0:qV(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function d6(n){if(n===void 0)return yP;if(!n)return null;if(typeof n=="function"||n instanceof tr)return n;if(!Array.isArray(n))return yb([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof tr){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof tr))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return U3(r)}return yb(n)}class H1 extends NP{constructor(e){super(e)}createRenderer(){return new m3(this)}}const ko={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class zo extends eo{constructor(e,t){super(e),this.layer=t}}const M_={LAYERS:"layers"};class Fu extends kP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(M_.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Zi(i.slice(),{unique:!0}):ct(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Zi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(rt(e,oi.ADD,this.handleLayersAdd_,this),rt(e,oi.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Rt);cf(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new zo(ko.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[rt(e,cu.PROPERTYCHANGE,this.handleLayerChange_,this),rt(e,We.CHANGE,this.handleLayerChange_,this)];e instanceof Fu&&t.push(rt(e,ko.ADDLAYER,this.handleLayerGroupAdd_,this),rt(e,ko.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[st(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new zo(ko.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new zo(ko.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new zo(ko.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=st(t);this.listenerKeys_[i].forEach(Rt),delete this.listenerKeys_[i],this.dispatchEvent(new zo(ko.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(M_.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new zo(ko.REMOVELAYER,i[r]))}this.set(M_.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=al(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Ae={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class K1 extends uf{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(We.CHANGE)}release(){this.setState(Ae.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ae.EMPTY){if(this.state!==Ae.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){it()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:PP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Wx(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const f6=new Error("disposed"),g6=[256,256];class Ib extends K1{constructor(e){const t=Ae.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Wx(this.data_);return e?[e.width,e.height]:g6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ae.IDLE&&this.state!==Ae.ERROR)return;this.state=Ae.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ae.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ae.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(f6),this.controller_=null),super.disposeInternal()}}class DP extends K1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ci?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ae.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ae.ERROR,this.unlistenImage_(),this.image_=m6(),this.changed()}handleImageLoad_(){if(Ci)this.state=Ae.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ae.LOADED:this.state=Ae.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ae.ERROR&&(this.state=Ae.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ae.IDLE&&(this.state=Ae.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=uV(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function m6(){const n=nn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let L_;const tu=[];function bb(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function O_(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function p6(){if(L_===void 0){const n=nn(6,6,tu);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",bb(n,4,5,4,0),bb(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;L_=O_(e,0)||O_(e,4)||O_(e,8),Kp(n),tu.push(n.canvas)}return L_}function Cb(n,e,t,i){const r=Hp(t,e,n);let s=Wm(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||du(u,r)){const h=Wm(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function y6(n,e,t,i){const r=ml(t);let s=Cb(n,e,r,i);return(!isFinite(s)||s<=0)&&RA(t,function(o){return s=Cb(n,e,o,i),isFinite(s)&&s>0}),s}function _6(n,e,t,i,r,s,o,l,u,h,f,p,_,v){const S=nn(Math.round(t*n),Math.round(t*e),tu);if(p||(S.imageSmoothingEnabled=!1),u.length===0)return S.canvas;S.scale(t,t);function I(N){return Math.round(N*t)/t}S.globalCompositeOperation="lighter";const w=nr();u.forEach(function(N,V,A){q4(w,N.extent)});let R;const M=t/i,D=(p?1:1+Math.pow(2,-24))/M;(!_||u.length!==1||h!==0)&&(R=nn(Math.round(ft(w)*M),Math.round(Yn(w)*M),tu),p||(R.imageSmoothingEnabled=!1),u.forEach(function(N,V,A){if(N.image.width>0&&N.image.height>0){if(N.clipExtent){R.save();const B=(N.clipExtent[0]-w[0])*M,O=-(N.clipExtent[3]-w[3])*M,se=ft(N.clipExtent)*M,me=Yn(N.clipExtent)*M;R.rect(p?B:Math.round(B),p?O:Math.round(O),p?se:Math.round(B+se)-Math.round(B),p?me:Math.round(O+me)-Math.round(O)),R.clip()}const b=(N.extent[0]-w[0])*M,P=-(N.extent[3]-w[3])*M,j=ft(N.extent)*M,z=Yn(N.extent)*M;R.drawImage(N.image,h,h,N.image.width-2*h,N.image.height-2*h,p?b:Math.round(b),p?P:Math.round(P),p?j:Math.round(b+j)-Math.round(b),p?z:Math.round(P+z)-Math.round(P)),N.clipExtent&&R.restore()}}));const L=Dl(o);return l.getTriangles().forEach(function(N,V,A){const b=N.source,P=N.target;let j=b[0][0],z=b[0][1],B=b[1][0],O=b[1][1],se=b[2][0],me=b[2][1];const pe=I((P[0][0]-L[0])/s),ue=I(-(P[0][1]-L[1])/s),H=I((P[1][0]-L[0])/s),X=I(-(P[1][1]-L[1])/s),ne=I((P[2][0]-L[0])/s),W=I(-(P[2][1]-L[1])/s),G=j,re=z;j=0,z=0,B-=G,O-=re,se-=G,me-=re;const ge=[[B,O,0,0,H-pe],[se,me,0,0,ne-pe],[0,0,B,O,X-ue],[0,0,se,me,W-ue]],_e=eF(ge);if(!_e)return;if(S.save(),S.beginPath(),p6()||!p){S.moveTo(H,X);const Ne=4,be=pe-H,Le=ue-X;for(let Ge=0;Ge<Ne;Ge++)S.lineTo(H+I((Ge+1)*be/Ne),X+I(Ge*Le/(Ne-1))),Ge!=Ne-1&&S.lineTo(H+I((Ge+1)*be/Ne),X+I((Ge+1)*Le/(Ne-1)));S.lineTo(ne,W)}else S.moveTo(H,X),S.lineTo(pe,ue),S.lineTo(ne,W);S.clip(),S.transform(_e[0],_e[2],_e[1],_e[3],pe,ue),S.translate(w[0]-G,w[3]-re);let Ce;if(R)Ce=R.canvas,S.scale(D,-D);else{const Ne=u[0],be=Ne.extent;Ce=Ne.image,S.scale(ft(be)/Ce.width,-Yn(be)/Ce.height)}S.drawImage(Ce,0,0),S.restore()}),R&&(Kp(R),tu.push(R.canvas)),f&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,l.getTriangles().forEach(function(N,V,A){const b=N.target,P=(b[0][0]-L[0])/s,j=-(b[0][1]-L[1])/s,z=(b[1][0]-L[0])/s,B=-(b[1][1]-L[1])/s,O=(b[2][0]-L[0])/s,se=-(b[2][1]-L[1])/s;S.beginPath(),S.moveTo(z,B),S.lineTo(P,j),S.lineTo(O,se),S.closePath(),S.stroke()}),S.restore()),S.canvas}const x6=10,Rb=.25;class v6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?kF(D=>fn(l,Hp(D,this.targetProj_,this.sourceProj_))):Gm(this.targetProj_,this.sourceProj_);this.transformInv_=function(D){const L=D[0]+"/"+D[1];return u[L]||(u[L]=h(D)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ft(r)>=ft(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ft(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ft(this.targetProj_.getExtent()):null;const f=Dl(i),p=Bp(i),_=Up(i),v=zp(i),S=this.transformInv_(f),I=this.transformInv_(p),w=this.transformInv_(_),R=this.transformInv_(v),M=x6+(o?Math.max(0,Math.ceil(Math.log2(Rx(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,_,v,S,I,w,R,M),this.wrapsXInSource_){let D=1/0;this.triangles_.forEach(function(L,N,V){D=Math.min(D,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-D>this.sourceWorldWidth_/2){const N=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];N[0][0]-D>this.sourceWorldWidth_/2&&(N[0][0]-=this.sourceWorldWidth_),N[1][0]-D>this.sourceWorldWidth_/2&&(N[1][0]-=this.sourceWorldWidth_),N[2][0]-D>this.sourceWorldWidth_/2&&(N[2][0]-=this.sourceWorldWidth_);const V=Math.min(N[0][0],N[1][0],N[2][0]);Math.max(N[0][0],N[1][0],N[2][0])-V<this.sourceWorldWidth_/2&&(L.source=N)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=AI([s,o,l,u]),p=this.sourceWorldWidth_?ft(f)/this.sourceWorldWidth_:null,_=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&p>.5&&p<1;let S=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=AI([e,t,i,r]);S=ft(w)/this.targetWorldWidth_>Rb||S}!v&&this.sourceProj_.isGlobal()&&p&&(S=p>Rb||S)}if(!S&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ci(f,this.maxSourceExtent_))return;let I=0;if(!S&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)S=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!S){const w=[(e[0]+i[0])/2,(e[1]+i[1])/2],R=this.transformInv_(w);let M;v?M=(ll(s[0],_)+ll(l[0],_))/2-ll(R[0],_):M=(s[0]+l[0])/2-R[0];const D=(s[1]+l[1])/2-R[1];S=M*M+D*D>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const w=[(t[0]+i[0])/2,(t[1]+i[1])/2],R=this.transformInv_(w),M=[(r[0]+e[0])/2,(r[1]+e[1])/2],D=this.transformInv_(M);this.addQuad_(e,t,w,M,s,o,R,D,h-1),this.addQuad_(M,w,i,r,D,R,l,u,h-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],R=this.transformInv_(w),M=[(i[0]+r[0])/2,(i[1]+r[1])/2],D=this.transformInv_(M);this.addQuad_(e,w,M,r,s,R,D,u,h-1),this.addQuad_(w,t,i,M,R,o,l,D,h-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=nr();return this.triangles_.forEach(function(t,i,r){const s=t.source;ad(e,s[0]),ad(e,s[1]),ad(e,s[2])}),e}getTriangles(){return this.triangles_}}const w6=.5;class MP extends K1{constructor(e,t,i,r,s,o,l,u,h,f,p,_){super(s,Ae.IDLE,_),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const v=r.getTileCoordExtent(this.wrappedTileCoord_),S=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const w=S?al(v,S):v;if(Rx(w)===0){this.state=Ae.EMPTY;return}const R=e.getExtent();R&&(I?I=al(I,R):I=R);const M=r.getResolution(this.wrappedTileCoord_[0]),D=y6(e,i,w,M);if(!isFinite(D)||D<=0){this.state=Ae.EMPTY;return}const L=f!==void 0?f:w6;if(this.triangulation_=new v6(e,i,w,I,D*L,M),this.triangulation_.getTriangles().length===0){this.state=Ae.EMPTY;return}this.sourceZ_=t.getZForResolution(D);let N=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(N[1]=Dt(N[1],I[1],I[3]),N[3]=Dt(N[3],I[1],I[3])):N=al(N,I)),!Rx(N))this.state=Ae.EMPTY;else{let V=0,A=0;e.canWrapX()&&(V=ft(R),A=Math.floor((N[0]-R[0])/V)),kA(N.slice(),e,!0).forEach(P=>{const j=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let z=j.minX;z<=j.maxX;z++)for(let B=j.minY;B<=j.maxY;B++){const O=h(this.sourceZ_,z,B,l);if(O){const se=A*V;this.sourceTiles_.push({tile:O,offset:se})}}++A}),this.sourceTiles_.length===0&&(this.state=Ae.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ae.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ae.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=_6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ae.LOADED}this.changed()}load(){if(this.state==Ae.IDLE){this.state=Ae.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ae.IDLE||i==Ae.LOADING){e++;const r=rt(t,We.CHANGE,s=>{const o=t.getState();(o==Ae.LOADED||o==Ae.ERROR||o==Ae.EMPTY)&&(Rt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ae.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Rt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Kp(this.canvas_.getContext("2d")),tu.push(this.canvas_),this.canvas_=null),super.release()}}class q1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ic(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new q1(n,e,t,i)}class Ab{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof jp&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return ct(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return ct(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){ct(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Qm(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function E6(n,e,t){return n+"/"+e+"/"+t}function ym(n,e,t,i,r){return`${st(n)},${e},${E6(t,i,r)}`}function T6(n){return S6(n[0],n[1],n[2])}function S6(n,e,t){return(e<<n)+t}function I6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function j_(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function b6(n,e,t){const i=n[t];return i?i.delete(e):!1}function Pb(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=al(e,$o(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=al(e,r))}return e}class C6 extends EP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=nr(),this.tempTileRange_=new q1(0,0,0,0),this.tempTileCoord_=Qm(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new Ab(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new Ab(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=ym(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||pm(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=fn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!du(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),_=this.getTile(f,p[1],p[2],t);if(!_||_.getState()!==Ae.LOADED)continue;const v=u.getOrigin(f),S=hi(u.getTileSize(f)),I=u.getResolution(f);let w;if(_ instanceof DP||_ instanceof MP)w=_.getImage();else if(_ instanceof Ib){if(w=Wx(_.getData()),!w)continue}else continue;const R=Math.floor(h*((r[0]-v[0])/I-p[1]*S[0])),M=Math.floor(h*((v[1]-r[1])/I-p[2]*S[1])),D=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(w,R+D,M+D)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=st(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],_=l.getMapInternal(),v=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),_?_.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),S=o.rotation,I=S?AA(o.center,o.resolution,S,e.size):void 0;for(let w=i;w>=v;--w){const R=h.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),M=h.getResolution(w);for(let D=R.minX;D<=R.maxX;++D)for(let L=R.minY;L<=R.maxY;++L){if(S&&!h.tileCoordIntersectsViewport([w,D,L],I))continue;const N=this.getTile(w,D,L,e);if(!N||!j_(r,N,w))continue;const A=N.getKey();if(p[A]=!0,N.getState()===Ae.IDLE&&!e.tileQueue.isKeyQueued(A)){const b=Qm(w,D,L,this.tempTileCoord_);e.tileQueue.enqueue([N,f,h.getTileCoordCenter(b),M])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=ym(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ae.LOADED)return f.endTransition(st(this)),j_(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const _=ym(u,h,i,f,p);let v=!1;if(l.containsKey(_)){const S=l.peek(_);S.getState()===Ae.LOADED&&(j_(r,S,i),v=!0)}v||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),_=p.getZForResolution(o,f.zDirection),v=p.getResolution(_),S=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==S&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=S):this.renderedSourceKey_=S;let I=e.extent;const w=f.getTilePixelRatio(u);this.prepareContainer(e,t);const R=this.context.canvas.width,M=this.context.canvas.height,D=i.extent&&$o(i.extent);D&&(I=al(I,$o(i.extent)));const L=v*R/2/w,N=v*M/2/w,V=[l[0]-L,l[1]-N,l[0]+L,l[1]+N],A={};this.renderedTiles.length=0;const b=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const H=p.getZForResolution(r.nextResolution,f.zDirection),X=Pb(e,e.nextExtent);this.enqueueTiles(e,X,H,A,b)}const P=Pb(e,I);if(this.enqueueTiles(e,P,_,A,0),b>0&&setTimeout(()=>{this.enqueueTiles(e,P,_-1,A,b-1)},0),!(_ in A))return this.container;const j=st(this),z=e.time;for(const H of A[_]){const X=H.getState();if(X===Ae.EMPTY)continue;const ne=H.tileCoord;if(X===Ae.LOADED&&H.getAlpha(j,z)===1){H.endTransition(j);continue}if(X!==Ae.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,A)){b6(A,H,_),e.animate=!0;continue}if(this.findAltTiles_(p,ne,_+1,A))continue;const re=p.getMinZoom();for(let ge=_-1;ge>=re&&!this.findAltTiles_(p,ne,ge,A);--ge);}const B=v/o*u/w,O=this.getRenderContext(e);Ys(this.tempTransform,R/2,M/2,B,B,0,-R/2,-M/2),i.extent&&this.clipUnrotated(O,e,D),f.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e);const se=Object.keys(A).map(Number);se.sort($s);let me;const pe=[],ue=[];for(let H=se.length-1;H>=0;--H){const X=se[H],ne=f.getTilePixelSize(X,u,s),G=p.getResolution(X)/v,re=ne[0]*G*B,ge=ne[1]*G*B,_e=p.getTileCoordForCoordAndZ(Dl(V),X),Ce=p.getTileCoordExtent(_e),Ne=fn(this.tempTransform,[w*(Ce[0]-V[0])/v,w*(V[3]-Ce[3])/v]),be=w*f.getGutterForProjection(s);for(const Le of A[X]){if(Le.getState()!==Ae.LOADED)continue;const Ge=Le.tileCoord,Wt=_e[1]-Ge[1],Wn=Math.round(Ne[0]-(Wt-1)*re),Zt=_e[2]-Ge[2],Pn=Math.round(Ne[1]-(Zt-1)*ge),gn=Math.round(Ne[0]-Wt*re),mn=Math.round(Ne[1]-Zt*ge),Qn=Wn-gn,Ni=Pn-mn,_t=se.length===1;let ut=!1;me=[gn,mn,gn+Qn,mn,gn+Qn,mn+Ni,gn,mn+Ni];for(let on=0,Di=pe.length;on<Di;++on)if(!_t&&X<ue[on]){const It=pe[on];ci([gn,mn,gn+Qn,mn+Ni],[It[0],It[3],It[4],It[7]])&&(ut||(O.save(),ut=!0),O.beginPath(),O.moveTo(me[0],me[1]),O.lineTo(me[2],me[3]),O.lineTo(me[4],me[5]),O.lineTo(me[6],me[7]),O.moveTo(It[6],It[7]),O.lineTo(It[4],It[5]),O.lineTo(It[2],It[3]),O.lineTo(It[0],It[1]),O.clip())}pe.push(me),ue.push(X),this.drawTile(Le,e,gn,mn,Qn,Ni,be,_t),ut&&O.restore(),this.renderedTiles.unshift(Le),this.updateUsedTiles(e.usedTiles,f,Le)}}if(this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!Rd(this.renderedExtent_,V),this.renderedExtent_=V,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,this.renderComplete){const H=(X,ne)=>{const W=st(f),G=ne.wantedTiles[W],re=G?Object.keys(G).length:0;this.updateCacheSize(re),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(H)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof Ib){if(h=Wx(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=st(this),_=t.layerStatesArray[t.layerIndex],v=_.opacity*(u?e.getAlpha(p,t.time):1),S=v!==f.globalAlpha;S&&(f.save(),f.globalAlpha=v),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),S&&f.restore(),v!==_.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=st(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const em={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class R6 extends Qp{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(em.PRELOAD)}setPreload(e){this.set(em.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(em.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(em.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Lh extends R6{constructor(e){super(e)}createRenderer(){return new C6(this,{cacheSize:this.getCacheSize()})}}const bc=[0,0,0],No=5;class LP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,ct(G4(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,ct(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Dl(i)),ct(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,ct(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:G1,ct(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new q1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Ic(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ic(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ic(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Ic(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,_=Math.floor(u*(o+1))-1;return Ic(h,p,f,_,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,bc);const r=bc[1],s=bc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,bc);const o=bc[1],l=bc[2];return Ic(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=hi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=hi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return ia(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=hi(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=$g(f,No)-1,p=$g(p,No)-1):(f=Gg(f,No),p=Gg(p,No)),Qm(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=hi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=$g(h,No)-1,f=$g(f,No)-1):(h=Gg(h,No),f=Gg(f,No)),Qm(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=g1(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return XA(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function OP(n){let e=n.getDefaultTileGrid();return e||(e=N6(n),n.setDefaultTileGrid(e)),e}function A6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=X1(t);if(!du(s,r)){const o=ft(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function P6(n,e,t,i){i=i!==void 0?i:"top-left";const r=jP(n,e,t);return new LP({extent:n,origin:Y4(n,i),resolutions:r,tileSize:t})}function k6(n){const e=n||{},t=e.extent||di("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:jP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new LP(i)}function jP(n,e,t,i){e=e!==void 0?e:a6,t=hi(t!==void 0?t:G1);const r=Yn(n),s=ft(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function N6(n,e,t,i){const r=X1(n);return P6(r,e,t,i)}function X1(n){n=di(n);let e=n.getExtent();if(!e){const t=180*fu.degrees/n.getMetersPerUnit();e=ia(-t,-t,t,t)}return e}function gX(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const D6=/\{z\}/g,M6=/\{x\}/g,L6=/\{y\}/g,O6=/\{-y\}/g;function j6(n,e,t,i,r){return n.replace(D6,e.toString()).replace(M6,t.toString()).replace(L6,i.toString()).replace(O6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function F6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function V6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return j6(n,o,t[1],t[2],s)})}function z6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=V6(n[r],e);return U6(i)}function U6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=T6(e),s=ll(r,n.length);return n[s](e,t,i)})}class B6 extends pP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&hi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||st(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return it()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:OP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=hi(r.getTileSize(e),this.tmpSize);return s==1?o:KV(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=A6(r,e,i)),I6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class W6 extends eo{constructor(e,t){super(e),this.tile=t}}const F_={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class Y1 extends B6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Y1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=st(t),r=t.getState();let s;r==Ae.LOADING?(this.tileLoadingKeys_[i]=!0,s=F_.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ae.ERROR?F_.TILELOADERROR:r==Ae.LOADED?F_.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new W6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=F6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(z6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class G6 extends Y1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:FP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:DP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!pm(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||pm(t,e)))return this.tileGrid;const i=st(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=OP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ae.IDLE:Ae.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(We.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||pm(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),_=this.getTileCoordForTileUrlFunction(u,s),v=new MP(l,f,s,p,u,_,this.getTilePixelRatio(r),this.getGutter(),(S,I,w,R)=>this.getTileInternal(S,I,w,R,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=h,v}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=ym(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=di(e);if(i){const r=st(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function FP(n,e){if(Ci){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class ed extends G6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:k6({extent:X1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const $6="modulepreload",H6=function(n){return"/visapp/"+n},kb={},Cc=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=H6(h),h in kb)return;kb[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":$6,f||(_.as="script"),_.crossOrigin="",_.href=h,l&&_.setAttribute("nonce",l),document.head.appendChild(_),f)return new Promise((v,S)=>{_.addEventListener("load",v),_.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},K6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class q6 extends ed{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[K6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ci&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||FP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Jm=1/0;class X6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,cf(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){ct(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Jm?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Jm?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class Y6 extends X6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(We.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ae.LOADED||i===Ae.ERROR||i===Ae.EMPTY){i!==Ae.ERROR&&t.removeEventListener(We.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ae.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function Z6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Jm;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Vc extends eo{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Fo extends Vc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lt={SINGLECLICK:"singleclick",CLICK:We.CLICK,DBLCLICK:We.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Gx={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class Q6 extends uf{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=rt(i,Gx.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=rt(i,Gx.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(We.TOUCHMOVE,this.boundHandleTouchMove_,JA?{passive:!1}:!1)}emulateClick_(e){let t=new Fo(Lt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Fo(Lt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Fo(Lt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Lt.POINTERUP||t.type==Lt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Lt.POINTERDOWN||t.type==Lt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Fo(Lt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Fo(Lt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(rt(i,Lt.POINTERMOVE,this.handlePointerMove_,this),rt(i,Lt.POINTERUP,this.handlePointerUp_,this),rt(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(rt(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Fo(Lt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Fo(Lt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(We.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Vo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},jn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Jp extends fs{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Rt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Cd&&this.listenerKeys.push(rt(e,Vo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class J6 extends Jp{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(We.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+gf+" "+M1+(this.collapsed_&&this.collapsible_?" "+qI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>EA(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!ca(t,this.renderedAttributions_)){JF(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(qI),this.collapsed_?HI(this.collapseLabel_,this.label_):HI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class e9 extends Jp{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(We.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+gf+" "+M1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(qg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ju}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(qg);!s&&i===0?this.element.classList.add(qg):s&&i!==0&&this.element.classList.remove(qg)}this.label_.style.transform=r}this.rotation_=i}}class t9 extends Jp{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(We.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(We.CLICK,this.handleClick_.bind(this,-i),!1);const _=t+" "+gf+" "+M1,v=this.element;v.className=_,v.appendChild(f),v.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:ju})):i.setZoom(s)}}}function n9(n){n=n||{};const e=new Zi;return(n.zoom===void 0||n.zoom)&&e.push(new t9(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new e9(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new J6(n.attributionOptions)),e}class i9{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Nb={ACTIVE:"active"};class _f extends fs{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Nb.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(Nb.ACTIVE,e)}setMap(e){this.map_=e}}function r9(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:n6,center:n.getConstrainedCenter(r)})}}function Z1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:ju})}class s9 extends _f{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();Z1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function $x(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const o9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},a9=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},VP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?a9(n):!0},l9=bd,zP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(ZF&&ZA&&e.ctrlKey)},UP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},c9=function(n){const e=n.originalEvent;return ZA?e.metaKey:e.ctrlKey},u9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},BP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},V_=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},h9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class xf extends _f{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Lt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Lt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Q1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class d9 extends xf{constructor(e){super({stopDown:Fp}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:$x(UP,h9);this.condition_=e.onFocusOnly?$x(VP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(Q1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();nF(s,l.getResolution()),_1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:ju})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class f9 extends xf{constructor(e){e=e||{},super({stopDown:Fp}),this.condition_=e.condition?e.condition:o9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!V_(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===W1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return V_(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return V_(e)&&zP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class g9 extends jp{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Ld([r])}getGeometry(){return this.geometry_}}const Rc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Oh extends eo{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class m9 extends xf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new g9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??zP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Oh(Rc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Oh(t?Rc.BOXEND:Rc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Oh(Rc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Oh(Rc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Oh(Rc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class p9 extends m9{constructor(e){e=e||{};const t=e.condition?e.condition:u9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:ju})}}const Fa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class y9 extends _f{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return UP(t)&&BP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==We.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Fa.DOWN||r==Fa.LEFT||r==Fa.RIGHT||r==Fa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Fa.DOWN?h=-l:r==Fa.LEFT?u=-l:r==Fa.RIGHT?u=l:h=l;const f=[u,h];_1(f,o.getRotation()),r9(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class _9 extends _f{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!c9(t)&&BP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==We.KEYDOWN||e.type==We.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();Z1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const x9=40,v9=300;class w9 extends _f{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:l9;this.condition_=e.onFocusOnly?$x(VP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==We.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=x9;break;case WheelEvent.DOM_DELTA_PAGE:s*=v9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Z1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class E9 extends xf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Fp),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==W1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Q1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class T9 extends xf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Fp),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(Q1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function S9(n){n=n||{};const e=new Zi,t=new i9(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new f9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new s9({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new d9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new E9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new T9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new y9),e.push(new _9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new w9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new p9({duration:n.zoomDuration})),e}class I9 extends jp{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){it()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Ys(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),UA(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(L,N,V,A){return s.call(o,N,L?V:null,A)}const _=f.projection,v=NA(e.slice(),_),S=[[0,0]];if(_.canWrapX()&&r){const L=_.getExtent(),N=ft(L);S.push([-N,0],[N,0])}const I=t.layerStatesArray,w=I.length,R=[],M=[];for(let L=0;L<S.length;L++)for(let N=w-1;N>=0;--N){const V=I[N],A=V.layer;if(A.hasRenderer()&&$1(V,f)&&l.call(u,A)){const b=A.getRenderer(),P=A.getSource();if(b&&P){const j=P.getWrapX()?v:e,z=p.bind(null,V.managed);M[0]=j[0]+S[L][0],M[1]=j[1]+S[L][1],h=b.forEachFeatureAtCoordinate(M,t,i,z,R)}if(h)return h}}if(R.length===0)return;const D=1/R.length;return R.forEach((L,N)=>L.distanceSq+=N*D),R.sort((L,N)=>L.distanceSq-N.distanceSq),R.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,bd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){it()}scheduleExpireIconCache(e){Ji.canExpireCache()&&e.postRenderFunctions.push(b9)}}function b9(n,e){Ji.expire()}class C9 extends I9{constructor(e){super(e),this.fontChangeListenerKey_=rt(Oc,cu.PROPERTYCHANGE,e.redrawText,e),this.element_=Ci?eP():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=gf+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new wP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Qi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof NP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const _=p.layer,v=_.getSourceState();if(!$1(p,r)||v!="ready"&&v!="undefined"){_.unrender();continue}const S=_.render(e,o);S&&(S!==o&&(this.children_.push(S),o=S),s.push(p))}this.declutter(e,s),eV(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Ho(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,_=f.style.backgroundColor;if(_&&(!Ho(p)||p.width>0)&&(h.fillStyle=_,h.fillRect(0,0,u.width,u.height)),Ho(p)&&p.width>0){const v=f.style.opacity||p.style.opacity;h.globalAlpha=v===""?1:Number(v);const S=p.style.transform;if(S)h.setTransform(...Ox(S));else{const I=parseFloat(p.style.width)/p.width,w=parseFloat(p.style.height)/p.height;h.setTransform(I,0,0,w,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Qi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function WP(n){if(n instanceof Qp){n.setMapInternal(null);return}n instanceof Fu&&n.getLayers().forEach(WP)}function GP(n,e){if(n instanceof Qp){n.setMapInternal(e);return}if(n instanceof Fu){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)GP(t[i],e)}}let R9=class extends fs{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=A9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:QF,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Ir(),this.pixelToCoordinateTransform_=Ir(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ci||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ci||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ci?new Zi:n9()),this.interactions=t.interactions||(Ci?new Zi:S9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Y6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(jn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(jn.VIEW,this.handleViewChanged_),this.addChangeListener(jn.SIZE,this.handleSizeChanged_),this.addChangeListener(jn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof ts)&&e.view.then(function(r){i.setView(new ts(r))}),this.controls.addEventListener(oi.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(oi.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(oi.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(oi.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(oi.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(oi.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){GP(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:bd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Fu?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:bd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(jn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Lx(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?fn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(jn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Zi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Os(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?fn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(jn.SIZE)}getView(){return this.get(jn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return Z6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Fo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Gx.POINTERDOWN||i===We.WHEEL||i===We.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Vn.ANIMATING]||o[Vn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Qi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Qi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Vc(Vo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Vc(Vo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Rt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(We.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(We.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ho(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ho(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new C9(this)),!Ho(t)){this.mapBrowserEventHandler_=new Q6(this,this.moveTolerance_);for(const r in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(We.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(We.WHEEL,this.boundHandleBrowserEvent_,JA?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[rt(i,We.KEYDOWN,this.handleBrowserEvent,this),rt(i,We.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=rt(e,cu.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=rt(e,We.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new zo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[rt(e,cu.PROPERTYCHANGE,this.render,this),rt(e,We.CHANGE,this.render,this),rt(e,"addlayer",this.handleLayerAdd_,this),rt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){WP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&ob(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Ax(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:st(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Ax(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Wp(this.previousExtent_)&&!Rd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Vc(Vo.MOVESTART,this,r)),this.previousExtent_=Vp(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Vn.ANIMATING]&&!s.viewHints[Vn.INTERACTING]&&!Rd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Vc(Vo.MOVEEND,this,s)),TA(s.extent,this.previousExtent_))),this.dispatchEvent(new Vc(Vo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Vo.LOADSTART)||this.hasListener(Vo.LOADEND)||this.hasListener(Qi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new zo("removelayer",t)),this.set(jn.LAYERGROUP,e)}setSize(e){this.set(jn.SIZE,e)}setTarget(e){this.set(jn.TARGET,e)}setView(e){if(!e||e instanceof ts){this.set(jn.VIEW,e);return}this.set(jn.VIEW,new ts);const t=this;e.then(function(i){t.setView(new ts(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Ho(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!ob(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&DA("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!ca(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function A9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Fu({layers:n.layers});t[jn.LAYERGROUP]=i,t[jn.TARGET]=n.target,t[jn.VIEW]=n.view instanceof ts?n.view:new ts;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Zi(n.controls.slice()):(ct(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Zi(n.interactions.slice()):(ct(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Zi(n.overlays.slice()):(ct(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Zi,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const z_="units",P9=[1,2,5],jh=25.4/.28;class k9 extends Jp{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+gf,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(z_,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(z_)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(z_,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Wm(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||jh)/jh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||jh)/jh:void 0;let h=l*o,f="";if(r=="degrees"){const D=fu.degrees;h*=D,h<D/60?(f="",o*=3600):h<D?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),_,v,S,I=0,w,R;for(;;){S=Math.floor(p/3);const D=Math.pow(10,S);if(_=P9[(p%3+3)%3]*D,v=Math.round(_/o),isNaN(v)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&v>=u){_=I,v=w,S=R;break}else if(v>=l)break;I=_,w=v,R=S,++p}const M=this.scaleBar_?this.createScaleBar(v,_,f):_.toFixed(S<0?-S:0)+" "+f;this.renderedHTML_!=M&&(this.innerElement_.innerHTML=M,this.renderedHTML_=M),this.renderedWidth_!=v&&(this.innerElement_.style.width=v+"px",this.renderedWidth_=v),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Wm(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||jh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const N9={},Db=n=>{let e;const t=new Set,i=(f,p)=>{const _=typeof f=="function"?f(e):f;if(!Object.is(_,e)){const v=e;e=p??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(S=>S(e,v))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(N9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},D9=n=>n?Db(n):Db;var U_={exports:{}},B_={},W_={exports:{}},G_={};var Mb;function M9(){if(Mb)return G_;Mb=1;var n=rf();function e(p,_){return p===_&&(p!==0||1/p===1/_)||p!==p&&_!==_}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,_){var v=_(),S=i({inst:{value:v,getSnapshot:_}}),I=S[0].inst,w=S[1];return s(function(){I.value=v,I.getSnapshot=_,u(I)&&w({inst:I})},[p,v,_]),r(function(){return u(I)&&w({inst:I}),p(function(){u(I)&&w({inst:I})})},[p]),o(v),v}function u(p){var _=p.getSnapshot;p=p.value;try{var v=_();return!t(p,v)}catch{return!0}}function h(p,_){return _()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return G_.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,G_}var Lb;function L9(){return Lb||(Lb=1,W_.exports=M9()),W_.exports}var Ob;function O9(){if(Ob)return B_;Ob=1;var n=rf(),e=L9();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return B_.useSyncExternalStoreWithSelector=function(h,f,p,_,v){var S=s(null);if(S.current===null){var I={hasValue:!1,value:null};S.current=I}else I=S.current;S=l(function(){function R(V){if(!M){if(M=!0,D=V,V=_(V),v!==void 0&&I.hasValue){var A=I.value;if(v(A,V))return L=A}return L=V}if(A=L,i(D,V))return A;var b=_(V);return v!==void 0&&v(A,b)?(D=V,A):(D=V,L=b)}var M=!1,D,L,N=p===void 0?null:p;return[function(){return R(f())},N===null?void 0:function(){return R(N())}]},[f,p,_,v]);var w=r(h,S[0],S[1]);return o(function(){I.hasValue=!0,I.value=w},[w]),u(w),w},B_}var jb;function j9(){return jb||(jb=1,U_.exports=O9()),U_.exports}var F9=j9();const V9=Dv(F9),$P={},{useDebugValue:z9}=gL,{useSyncExternalStoreWithSelector:U9}=V9;let Fb=!1;const B9=n=>n;function W9(n,e=B9,t){($P?"production":void 0)!=="production"&&t&&!Fb&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Fb=!0);const i=U9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return z9(i),i}const Vb=n=>{($P?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?D9(n):n,t=(i,r)=>W9(e,i,r);return Object.assign(t,e),t},Pr=n=>n?Vb(n):Vb;var HP=Symbol.for("immer-nothing"),zb=Symbol.for("immer-draftable"),Pi=Symbol.for("immer-state");function xr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Fd=Object.getPrototypeOf;function _u(n){return!!n&&!!n[Pi]}function vl(n){return n?KP(n)||Array.isArray(n)||!!n[zb]||!!n.constructor?.[zb]||vf(n)||ty(n):!1}var G9=Object.prototype.constructor.toString(),Ub=new WeakMap;function KP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=Ub.get(t);return i===void 0&&(i=Function.toString.call(t),Ub.set(t,i)),i===G9}function ep(n,e,t=!0){ey(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function ey(n){const e=n[Pi];return e?e.type_:Array.isArray(n)?1:vf(n)?2:ty(n)?3:0}function Hx(n,e){return ey(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function qP(n,e,t){const i=ey(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function $9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function vf(n){return n instanceof Map}function ty(n){return n instanceof Set}function Wa(n){return n.copy_||n.base_}function Kx(n,e){if(vf(n))return new Map(n);if(ty(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=KP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Pi];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Fd(n),i)}else{const i=Fd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function J1(n,e=!1){return ny(n)||_u(n)||!vl(n)||(ey(n)>1&&Object.defineProperties(n,{set:tm,add:tm,clear:tm,delete:tm}),Object.freeze(n),e&&Object.values(n).forEach(t=>J1(t,!0))),n}function H9(){xr(2)}var tm={value:H9};function ny(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var K9={};function wl(n){const e=K9[n];return e||xr(0,n),e}var Vd;function XP(){return Vd}function q9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Bb(n,e){e&&(wl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function qx(n){Xx(n),n.drafts_.forEach(X9),n.drafts_=null}function Xx(n){n===Vd&&(Vd=n.parent_)}function Wb(n){return Vd=q9(Vd,n)}function X9(n){const e=n[Pi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Gb(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Pi].modified_&&(qx(e),xr(4)),vl(n)&&(n=tp(e,n),e.parent_||np(e,n)),e.patches_&&wl("Patches").generateReplacementPatches_(t[Pi].base_,n,e.patches_,e.inversePatches_)):n=tp(e,t,[]),qx(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==HP?n:void 0}function tp(n,e,t){if(ny(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Pi];if(!r)return ep(e,(s,o)=>$b(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return np(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),ep(o,(u,h)=>$b(n,r,s,u,h,t,l),i),np(n,s,!1),t&&n.patches_&&wl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function $b(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=ny(r);if(!(l&&!o)){if(_u(r)){const u=s&&e&&e.type_!==3&&!Hx(e.assigned_,i)?s.concat(i):void 0,h=tp(n,r,u);if(qP(t,i,h),_u(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(vl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;tp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(vf(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&np(n,r)}}}function np(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&J1(e,t)}function Y9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:XP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=ew;t&&(r=[i],s=zd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var ew={get(n,e){if(e===Pi)return n;const t=Wa(n);if(!Hx(t,e))return Z9(n,t,e);const i=t[e];return n.finalized_||!vl(i)?i:i===$_(n.base_,e)?(H_(n),n.copy_[e]=Zx(i,n)):i},has(n,e){return e in Wa(n)},ownKeys(n){return Reflect.ownKeys(Wa(n))},set(n,e,t){const i=YP(Wa(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=$_(Wa(n),e),s=r?.[Pi];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if($9(t,r)&&(t!==void 0||Hx(n.base_,e)))return!0;H_(n),Yx(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return $_(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,H_(n),Yx(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Wa(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){xr(11)},getPrototypeOf(n){return Fd(n.base_)},setPrototypeOf(){xr(12)}},zd={};ep(ew,(n,e)=>{zd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});zd.deleteProperty=function(n,e){return zd.set.call(this,n,e,void 0)};zd.set=function(n,e,t){return ew.set.call(this,n[0],e,t,n[0])};function $_(n,e){const t=n[Pi];return(t?Wa(t):n)[e]}function Z9(n,e,t){const i=YP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function YP(n,e){if(!(e in n))return;let t=Fd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Fd(t)}}function Yx(n){n.modified_||(n.modified_=!0,n.parent_&&Yx(n.parent_))}function H_(n){n.copy_||(n.copy_=Kx(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Q9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&xr(6),i!==void 0&&typeof i!="function"&&xr(7);let r;if(vl(e)){const s=Wb(this),o=Zx(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?qx(s):Xx(s)}return Bb(s,i),Gb(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===HP&&(r=void 0),this.autoFreeze_&&J1(r,!0),i){const s=[],o=[];wl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else xr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){vl(n)||xr(8),_u(n)&&(n=J9(n));const e=Wb(this),t=Zx(n,void 0);return t[Pi].isManual_=!0,Xx(e),t}finishDraft(n,e){const t=n&&n[Pi];(!t||!t.isManual_)&&xr(9);const{scope_:i}=t;return Bb(i,e),Gb(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=wl("Patches").applyPatches_;return _u(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Zx(n,e){const t=vf(n)?wl("MapSet").proxyMap_(n,e):ty(n)?wl("MapSet").proxySet_(n,e):Y9(n,e);return(e?e.scope_:XP()).drafts_.push(t),t}function J9(n){return _u(n)||xr(10,n),ZP(n)}function ZP(n){if(!vl(n)||ny(n))return n;const e=n[Pi];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Kx(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Kx(n,!0);return ep(t,(r,s)=>{qP(t,r,ZP(s))},i),e&&(e.finalized_=!1),t}var ez=new Q9,tz=ez.produce;const nz=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?tz(r):r;return e(l,s,...o)},n(i.setState,t,i)),iy=nz,zn=Pr()(iy((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),QP={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Cc(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-B8K4w06l.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1,2]));return n()},immediateLoad:!1},Trailerhellingen:{name:"Trailerhellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Cc(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-DHiXYbkx.js");return{createBoothellingenLayer:e}},__vite__mapDeps([3,1,2]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Cc(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-BVWk8p83.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Cc(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-DFX3eKoM.js");return{createViswaterLayer:e}},__vite__mapDeps([4,1]));return n()},immediateLoad:!1},"AHN4 Hillshade":{name:"AHN4 Hillshade",factory:async()=>{const{createAHN4MultiHillshadeLayer:n}=await Cc(async()=>{const{createAHN4MultiHillshadeLayer:e}=await import("./hillshadeLayers-DeU3260L.js");return{createAHN4MultiHillshadeLayer:e}},__vite__mapDeps([5,6]));return n()},immediateLoad:!0},"PDOK Water NL":{name:"PDOK Water NL",factory:async()=>{const{createPDOKWaterLayer:n}=await Cc(async()=>{const{createPDOKWaterLayer:e}=await import("./pdokWaterOL-DXphsWxD.js");return{createPDOKWaterLayer:e}},__vite__mapDeps([7,6]));return n()},immediateLoad:!0}};function iz(){return Object.values(QP).filter(n=>n.immediateLoad)}const gs=Pr()(iy((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Xi=Pr()(iy((n,e)=>({visible:{"CartoDB Light":!0,OpenStreetMap:!1,Luchtfoto:!1,Terrein:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Trailerhellingen:!1,Dieptekaart:!1,Viswater:!1,"PDOK Water NL":!0,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5,"PDOK Water NL":1},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=QP[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=gs.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),Un=Pr()(iy(n=>({layerControlOpen:!1,layerPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleLayerPanel:()=>{n(e=>{const t=e.layerPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.layerPanelOpen=!0)})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),rz={};function sz(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Ud=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Ud(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Ud(i)(t)}}}},oz=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,R)=>({...R,...w}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},i,r);const f=Ud(s.serialize),p=()=>{const w=s.partialize({...i()});let R;const M=f({state:w,version:s.version}).then(D=>h.setItem(s.name,D)).catch(D=>{R=D});if(R)throw R;return M},_=r.setState;r.setState=(w,R)=>{_(w,R),p()};const v=n((...w)=>{t(...w),p()},i,r);let S;const I=()=>{var w;if(!h)return;o=!1,l.forEach(M=>M(i()));const R=((w=s.onRehydrateStorage)==null?void 0:w.call(s,i()))||void 0;return Ud(h.getItem.bind(h))(s.name).then(M=>{if(M)return s.deserialize(M)}).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return s.migrate(M.state,M.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return M.state}).then(M=>{var D;return S=s.merge(M,(D=i())!=null?D:v),t(S,!0),p()}).then(()=>{R?.(S,void 0),o=!0,u.forEach(M=>M(S))}).catch(M=>{R?.(void 0,M)})};return r.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(h=w.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},I(),S||v},az=(n,e)=>(t,i,r)=>{let s={storage:sz(()=>localStorage),partialize:I=>I,version:0,merge:(I,w)=>({...w,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},p=r.setState;r.setState=(I,w)=>{p(I,w),f()};const _=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>_;let v;const S=()=>{var I,w;if(!h)return;o=!1,l.forEach(M=>{var D;return M((D=i())!=null?D:_)});const R=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(I=i())!=null?I:_))||void 0;return Ud(h.getItem.bind(h))(s.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return[!0,s.migrate(M.state,M.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var D;const[L,N]=M;if(v=s.merge(N,(D=i())!=null?D:_),t(v,!0),L)return f()}).then(()=>{R?.(v,void 0),v=i(),o=!0,u.forEach(M=>M(v))}).catch(M=>{R?.(void 0,M)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||S(),v||_},lz=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((rz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oz(n,e)):az(n,e),wf=lz,qe=Pr()(wf(n=>({defaultBackground:"CartoDB Light",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showBuienradarWidget:!1,showWaterflowWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,widgetOrder:["weather","wind","tide","buienradar","waterflow","forecast","waterData"],fontScale:100,showFontSliders:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowBuienradarWidget:e=>n({showBuienradarWidget:e}),setShowWaterflowWidget:e=>n({showWaterflowWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e}),setWidgetOrder:e=>n({widgetOrder:e}),setFontScale:e=>n({fontScale:e}),setShowFontSliders:e=>n({showFontSliders:e})}),{name:"visapp-settings",version:3,migrate:(n,e)=>{const t=n;return e<3?{...t,defaultBackground:"CartoDB Light"}:t}})),JP=Pr()(wf((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),ek=Pr((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],precipitation15min:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code,precipitation",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code,precipitation_probability,precipitation",minutely_15:"precipitation",past_hours:"24",forecast_hours:"48",past_minutely_15:"0",forecast_minutely_15:"8",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[],h=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((f,p)=>({time:f,pressure:o.hourly.surface_pressure[p]})),u=o.hourly.time.map((f,p)=>({time:f,temperature:o.hourly.temperature_2m[p],windSpeed:o.hourly.wind_speed_10m[p],windDirection:o.hourly.wind_direction_10m[p],pressure:o.hourly.surface_pressure[p],weatherCode:o.hourly.weather_code[p],precipitationProbability:o.hourly.precipitation_probability?.[p]||0,precipitation:o.hourly.precipitation?.[p]||0}))),o.minutely_15?.time&&o.minutely_15?.precipitation&&(h=o.minutely_15.time.map((f,p)=>({time:f,precipitation:o.minutely_15.precipitation[p]||0}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,precipitation15min:h,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),tk=Pr()(wf(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),Hb=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],Kb=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],cz=Pr()(wf((n,e)=>({presets:Hb,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Xi.getState().setLayerVisibility;Kb.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Xi.getState().visible,r=Kb.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:Hb})}}),{name:"visapp-presets"})),uz=()=>{};var qb={};const nk=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},hz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},ik={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,v=h&63;u||(v=64,o||(_=64)),i.push(t[f],t[p],t[_],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(nk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):hz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new dz;const _=s<<2|l>>4;if(i.push(_),h!==64){const v=l<<4&240|h>>2;if(i.push(v),p!==64){const S=h<<6&192|p;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class dz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fz=function(n){const e=nk(n);return ik.encodeByteArray(e,!0)},ip=function(n){return fz(n).replace(/\./g,"")},rk=function(n){try{return ik.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function sk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const gz=()=>sk().__FIREBASE_DEFAULTS__,mz=()=>{if(typeof process>"u"||typeof qb>"u")return;const n=qb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},pz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&rk(n[1]);return e&&JSON.parse(e)},ry=()=>{try{return uz()||gz()||mz()||pz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ok=n=>ry()?.emulatorHosts?.[n],ak=n=>{const e=ok(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},lk=()=>ry()?.config,ck=n=>ry()?.[`_${n}`];class yz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ol(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tw(n){return(await fetch(n,{credentials:"include"})).ok}function uk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ip(JSON.stringify(t)),ip(JSON.stringify(o)),""].join(".")}const cd={};function _z(){const n={prod:[],emulator:[]};for(const e of Object.keys(cd))cd[e]?n.emulator.push(e):n.prod.push(e);return n}function xz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Xb=!1;function nw(n,e){if(typeof window>"u"||typeof document>"u"||!Ol(window.location.host)||cd[n]===e||cd[n]||Xb)return;cd[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",s=_z().prod.length>0;function o(){const _=document.getElementById(i);_&&_.remove()}function l(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,v){_.setAttribute("width","24"),_.setAttribute("id",v),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Xb=!0,o()},_}function f(_,v){_.setAttribute("id",v),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function p(){const _=xz(i),v=t("text"),S=document.getElementById(v)||document.createElement("span"),I=t("learnmore"),w=document.getElementById(I)||document.createElement("a"),R=t("preprendIcon"),M=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const D=_.element;l(D),f(w,I);const L=h();u(M,R),D.append(M,S,w,L),document.body.appendChild(D)}s?(S.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rn())}function hk(){const n=ry()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ez(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Tz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Sz(){const n=rn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function dk(){return!hk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fk(){return!hk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function gk(){try{return typeof indexedDB=="object"}catch{return!1}}function Iz(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const bz="FirebaseError";class ms extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=bz,Object.setPrototypeOf(this,ms.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ef.prototype.create)}}class Ef{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Cz(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new ms(r,l,i)}}function Cz(n,e){return n.replace(Rz,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const Rz=/\{\$([^}]+)}/g;function Az(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function El(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(Yb(s)&&Yb(o)){if(!El(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function Yb(n){return n!==null&&typeof n=="object"}function Tf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Pz(n,e){const t=new kz(n,e);return t.subscribe.bind(t)}class kz{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Nz(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=K_),r.error===void 0&&(r.error=K_),r.complete===void 0&&(r.complete=K_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Nz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function K_(){}function no(n){return n&&n._delegate?n._delegate:n}class ra{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ga="[DEFAULT]";class Dz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new yz;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Lz(e))try{this.getOrInitializeService({instanceIdentifier:Ga})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ga){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ga){return this.instances.has(e)}getOptions(e=Ga){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Mz(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ga){return this.component?this.component.multipleInstances?e:Ga:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Mz(n){return n===Ga?void 0:n}function Lz(n){return n.instantiationMode==="EAGER"}class Oz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Dz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Xe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Xe||(Xe={}));const jz={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},Fz=Xe.INFO,Vz={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},zz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=Vz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class iw{constructor(e){this.name=e,this._logLevel=Fz,this._logHandler=zz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}}const Uz=(n,e)=>e.some(t=>n instanceof t);let Zb,Qb;function Bz(){return Zb||(Zb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wz(){return Qb||(Qb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mk=new WeakMap,Qx=new WeakMap,pk=new WeakMap,q_=new WeakMap,rw=new WeakMap;function Gz(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Qo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&mk.set(t,n)}).catch(()=>{}),rw.set(e,n),e}function $z(n){if(Qx.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Qx.set(n,e)}let Jx={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Qx.get(n);if(e==="objectStoreNames")return n.objectStoreNames||pk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Hz(n){Jx=n(Jx)}function Kz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(X_(this),e,...t);return pk.set(i,e.sort?e.sort():[e]),Qo(i)}:Wz().includes(n)?function(...e){return n.apply(X_(this),e),Qo(mk.get(this))}:function(...e){return Qo(n.apply(X_(this),e))}}function qz(n){return typeof n=="function"?Kz(n):(n instanceof IDBTransaction&&$z(n),Uz(n,Bz())?new Proxy(n,Jx):n)}function Qo(n){if(n instanceof IDBRequest)return Gz(n);if(q_.has(n))return q_.get(n);const e=qz(n);return e!==n&&(q_.set(n,e),rw.set(e,n)),e}const X_=n=>rw.get(n);function Xz(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Qo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Qo(o.result),u.oldVersion,u.newVersion,Qo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const Yz=["get","getKey","getAll","getAllKeys","count"],Zz=["put","add","delete","clear"],Y_=new Map;function Jb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Y_.get(e))return Y_.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Zz.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Yz.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return Y_.set(e,s),s}Hz(n=>({...n,get:(e,t,i)=>Jb(e,t)||n.get(e,t,i),has:(e,t)=>!!Jb(e,t)||n.has(e,t)}));class Qz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Jz(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Jz(n){return n.getComponent()?.type==="VERSION"}const ev="@firebase/app",eC="0.14.6";const Zs=new iw("@firebase/app"),eU="@firebase/app-compat",tU="@firebase/analytics-compat",nU="@firebase/analytics",iU="@firebase/app-check-compat",rU="@firebase/app-check",sU="@firebase/auth",oU="@firebase/auth-compat",aU="@firebase/database",lU="@firebase/data-connect",cU="@firebase/database-compat",uU="@firebase/functions",hU="@firebase/functions-compat",dU="@firebase/installations",fU="@firebase/installations-compat",gU="@firebase/messaging",mU="@firebase/messaging-compat",pU="@firebase/performance",yU="@firebase/performance-compat",_U="@firebase/remote-config",xU="@firebase/remote-config-compat",vU="@firebase/storage",wU="@firebase/storage-compat",EU="@firebase/firestore",TU="@firebase/ai",SU="@firebase/firestore-compat",IU="firebase",bU="12.6.0";const tv="[DEFAULT]",CU={[ev]:"fire-core",[eU]:"fire-core-compat",[nU]:"fire-analytics",[tU]:"fire-analytics-compat",[rU]:"fire-app-check",[iU]:"fire-app-check-compat",[sU]:"fire-auth",[oU]:"fire-auth-compat",[aU]:"fire-rtdb",[lU]:"fire-data-connect",[cU]:"fire-rtdb-compat",[uU]:"fire-fn",[hU]:"fire-fn-compat",[dU]:"fire-iid",[fU]:"fire-iid-compat",[gU]:"fire-fcm",[mU]:"fire-fcm-compat",[pU]:"fire-perf",[yU]:"fire-perf-compat",[_U]:"fire-rc",[xU]:"fire-rc-compat",[vU]:"fire-gcs",[wU]:"fire-gcs-compat",[EU]:"fire-fst",[SU]:"fire-fst-compat",[TU]:"fire-vertex","fire-js":"fire-js",[IU]:"fire-js-all"};const rp=new Map,RU=new Map,nv=new Map;function tC(n,e){try{n.container.addComponent(e)}catch(t){Zs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Tl(n){const e=n.name;if(nv.has(e))return Zs.debug(`There were multiple attempts to register component ${e}.`),!1;nv.set(e,n);for(const t of rp.values())tC(t,n);for(const t of RU.values())tC(t,n);return!0}function sy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Yi(n){return n==null?!1:n.settings!==void 0}const AU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Jo=new Ef("app","Firebase",AU);class PU{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ra("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jo.create("app-deleted",{appName:this._name})}}const jl=bU;function yk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:tv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Jo.create("bad-app-name",{appName:String(r)});if(t||(t=lk()),!t)throw Jo.create("no-options");const s=rp.get(r);if(s){if(El(t,s.options)&&El(i,s.config))return s;throw Jo.create("duplicate-app",{appName:r})}const o=new Oz(r);for(const u of nv.values())o.addComponent(u);const l=new PU(t,i,o);return rp.set(r,l),l}function sw(n=tv){const e=rp.get(n);if(!e&&n===tv&&lk())return yk();if(!e)throw Jo.create("no-app",{appName:n});return e}function ls(n,e,t){let i=CU[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zs.warn(o.join(" "));return}Tl(new ra(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const kU="firebase-heartbeat-database",NU=1,Bd="firebase-heartbeat-store";let Z_=null;function _k(){return Z_||(Z_=Xz(kU,NU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Bd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Jo.create("idb-open",{originalErrorMessage:n.message})})),Z_}async function DU(n){try{const t=(await _k()).transaction(Bd),i=await t.objectStore(Bd).get(xk(n));return await t.done,i}catch(e){if(e instanceof ms)Zs.warn(e.message);else{const t=Jo.create("idb-get",{originalErrorMessage:e?.message});Zs.warn(t.message)}}}async function nC(n,e){try{const i=(await _k()).transaction(Bd,"readwrite");await i.objectStore(Bd).put(e,xk(n)),await i.done}catch(t){if(t instanceof ms)Zs.warn(t.message);else{const i=Jo.create("idb-set",{originalErrorMessage:t?.message});Zs.warn(i.message)}}}function xk(n){return`${n.name}!${n.options.appId}`}const MU=1024,LU=30;class OU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new FU(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=iC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>LU){const r=VU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Zs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=iC(),{heartbeatsToSend:t,unsentEntries:i}=jU(this._heartbeatsCache.heartbeats),r=ip(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Zs.warn(e),""}}}function iC(){return new Date().toISOString().substring(0,10)}function jU(n,e=MU){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),rC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),rC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class FU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gk()?Iz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await DU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return nC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return nC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function rC(n){return ip(JSON.stringify({version:2,heartbeats:n})).length}function VU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function zU(n){Tl(new ra("platform-logger",e=>new Qz(e),"PRIVATE")),Tl(new ra("heartbeat",e=>new OU(e),"PRIVATE")),ls(ev,eC,n),ls(ev,eC,"esm2020"),ls("fire-js","")}zU("");function vk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const UU=vk,wk=new Ef("auth","Firebase",vk());const sp=new iw("@firebase/auth");function BU(n,...e){sp.logLevel<=Xe.WARN&&sp.warn(`Auth (${jl}): ${n}`,...e)}function _m(n,...e){sp.logLevel<=Xe.ERROR&&sp.error(`Auth (${jl}): ${n}`,...e)}function us(n,...e){throw aw(n,...e)}function br(n,...e){return aw(n,...e)}function ow(n,e,t){const i={...UU(),[e]:t};return new Ef("auth","Firebase",i).create(e,{appName:n.name})}function cl(n){return ow(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function WU(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&us(n,"argument-error"),ow(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function aw(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return wk.create(n,...e)}function ze(n,e,...t){if(!n)throw aw(e,...t)}function zs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw _m(e),new Error(e)}function Qs(n,e){n||zs(e)}function iv(){return typeof self<"u"&&self.location?.href||""}function GU(){return sC()==="http:"||sC()==="https:"}function sC(){return typeof self<"u"&&self.location?.protocol||null}function $U(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GU()||Ez()||"connection"in navigator)?navigator.onLine:!0}function HU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Sf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qs(t>e,"Short delay should be less than long delay!"),this.isMobile=vz()||Tz()}get(){return $U()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function lw(n,e){Qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Ek{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const KU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const qU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],XU=new Sf(3e4,6e4);function cw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Vu(n,e,t,i,r={}){return Tk(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=Tf({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return wz()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ol(n.emulatorConfig.host)&&(h.credentials="include"),Ek.fetch()(await Sk(n,n.config.apiHost,t,l),h)})}async function Tk(n,e,t){n._canInitEmulator=!1;const i={...KU,...e};try{const r=new ZU(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw nm(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw nm(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw nm(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw nm(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw ow(n,f,h);us(n,f)}}catch(r){if(r instanceof ms)throw r;us(n,"network-request-failed",{message:String(r)})}}async function YU(n,e,t,i,r={}){const s=await Vu(n,e,t,i,r);return"mfaPendingCredential"in s&&us(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Sk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?lw(n.config,r):`${n.config.apiScheme}://${r}`;return qU.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class ZU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(br(this.auth,"network-request-failed")),XU.get())})}}function nm(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=br(n,e,i);return r.customData._tokenResponse=t,r}async function QU(n,e){return Vu(n,"POST","/v1/accounts:delete",e)}async function op(n,e){return Vu(n,"POST","/v1/accounts:lookup",e)}function ud(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JU(n,e=!1){const t=no(n),i=await t.getIdToken(e),r=uw(i);ze(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:ud(Q_(r.auth_time)),issuedAtTime:ud(Q_(r.iat)),expirationTime:ud(Q_(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Q_(n){return Number(n)*1e3}function uw(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return _m("JWT malformed, contained fewer than 3 sections"),null;try{const r=rk(t);return r?JSON.parse(r):(_m("Failed to decode base64 JWT payload"),null)}catch(r){return _m("Caught error parsing JWT payload as JSON",r?.toString()),null}}function oC(n){const e=uw(n);return ze(e,"internal-error"),ze(typeof e.exp<"u","internal-error"),ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Wd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ms&&eB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function eB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class tB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class rv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ud(this.lastLoginAt),this.creationTime=ud(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ap(n){const e=n.auth,t=await n.getIdToken(),i=await Wd(n,op(e,{idToken:t}));ze(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?Ik(r.providerUserInfo):[],o=iB(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new rv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function nB(n){const e=no(n);await ap(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Ik(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function rB(n,e){const t=await Tk(n,{},async()=>{const i=Tf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await Sk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Ol(n.emulatorConfig.host)&&(u.credentials="include"),Ek.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function sB(n,e){return Vu(n,"POST","/v2/accounts:revokeToken",cw(n,e))}class nu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ze(e.idToken,"internal-error"),ze(typeof e.idToken<"u","internal-error"),ze(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ze(e.length!==0,"internal-error");const t=oC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await rB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new nu;return i&&(ze(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(ze(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(ze(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nu,this.toJSON())}_performRefresh(){return zs("not implemented")}}function Do(n,e){ze(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class wr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new tB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new rv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Wd(this,this.stsTokenManager.getToken(this.auth,e));return ze(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return JU(this,e)}reload(){return nB(this)}_assign(e){this!==e&&(ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await ap(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yi(this.auth.app))return Promise.reject(cl(this.auth));const e=await this.getIdToken();return await Wd(this,QU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:_,isAnonymous:v,providerData:S,stsTokenManager:I}=t;ze(p&&I,e,"internal-error");const w=nu.fromJSON(this.name,I);ze(typeof p=="string",e,"internal-error"),Do(i,e.name),Do(r,e.name),ze(typeof _=="boolean",e,"internal-error"),ze(typeof v=="boolean",e,"internal-error"),Do(s,e.name),Do(o,e.name),Do(l,e.name),Do(u,e.name),Do(h,e.name),Do(f,e.name);const R=new wr({uid:p,auth:e,email:r,emailVerified:_,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:w,createdAt:h,lastLoginAt:f});return S&&Array.isArray(S)&&(R.providerData=S.map(M=>({...M}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(e,t,i=!1){const r=new nu;r.updateFromServerResponse(t);const s=new wr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await ap(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];ze(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?Ik(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new nu;l.updateFromIdToken(i);const u=new wr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new rv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const aC=new Map;function Us(n){Qs(n instanceof Function,"Expected a class definition");let e=aC.get(n);return e?(Qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,aC.set(n,e),e)}class bk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bk.type="NONE";const lC=bk;function xm(n,e,t){return`firebase:${n}:${e}:${t}`}class iu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=xm(this.userKey,r.apiKey,s),this.fullPersistenceKey=xm("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await op(this.auth,{idToken:e}).catch(()=>{});return t?wr._fromGetAccountInfoResponse(this.auth,t,e):null}return wr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new iu(Us(lC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Us(lC);const o=xm(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const _=await op(e,{idToken:f}).catch(()=>{});if(!_)break;p=await wr._fromGetAccountInfoResponse(e,_,f)}else p=wr._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new iu(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new iu(s,e,i))}}function cC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Pk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ck(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Nk(e))return"Blackberry";if(Dk(e))return"Webos";if(Rk(e))return"Safari";if((e.includes("chrome/")||Ak(e))&&!e.includes("edge/"))return"Chrome";if(kk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Ck(n=rn()){return/firefox\//i.test(n)}function Rk(n=rn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ak(n=rn()){return/crios\//i.test(n)}function Pk(n=rn()){return/iemobile/i.test(n)}function kk(n=rn()){return/android/i.test(n)}function Nk(n=rn()){return/blackberry/i.test(n)}function Dk(n=rn()){return/webos/i.test(n)}function hw(n=rn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function oB(n=rn()){return hw(n)&&!!window.navigator?.standalone}function aB(){return Sz()&&document.documentMode===10}function Mk(n=rn()){return hw(n)||kk(n)||Dk(n)||Nk(n)||/windows phone/i.test(n)||Pk(n)}function Lk(n,e=[]){let t;switch(n){case"Browser":t=cC(rn());break;case"Worker":t=`${cC(rn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jl}/${i}`}class lB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function cB(n,e={}){return Vu(n,"GET","/v2/passwordPolicy",cw(n,e))}const uB=6;class hB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??uB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class dB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uC(this),this.idTokenSubscription=new uC(this),this.beforeStateQueue=new lB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Us(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await iu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await op(this,{idToken:e}),i=await wr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Yi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ap(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=HU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yi(this.app))return Promise.reject(cl(this));const t=e?no(e):null;return t&&ze(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yi(this.app)?Promise.reject(cl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yi(this.app)?Promise.reject(cl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Us(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await cB(this),t=new hB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ef("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await sB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Us(e)||this._popupRedirectResolver;ze(t,this,"argument-error"),this.redirectPersistenceManager=await iu.create(this,[Us(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ze(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Lk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Yi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&BU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function oy(n){return no(n)}class uC{constructor(e){this.auth=e,this.observer=null,this.addObserver=Pz(t=>this.observer=t)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let dw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fB(n){dw=n}function gB(n){return dw.loadJS(n)}function mB(){return dw.gapiScript}function pB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function yB(n,e){const t=sy(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(El(s,e??{}))return r;us(r,"already-initialized")}return t.initialize({options:e})}function _B(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Us);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function xB(n,e,t){const i=oy(n);ze(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=Ok(e),{host:o,port:l}=vB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){ze(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ze(El(h,i.config.emulator)&&El(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Ol(o)?(tw(`${s}//${o}${u}`),nw("Auth",!0)):wB()}function Ok(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function vB(n){const e=Ok(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:hC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:hC(o)}}}function hC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function wB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class jk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return zs("not implemented")}_getIdTokenResponse(e){return zs("not implemented")}_linkToIdToken(e,t){return zs("not implemented")}_getReauthenticationResolver(e){return zs("not implemented")}}async function ru(n,e){return YU(n,"POST","/v1/accounts:signInWithIdp",cw(n,e))}const EB="http://localhost";class Sl extends jk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Sl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):us("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Sl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ru(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ru(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ru(e,t)}buildRequest(){const e={requestUri:EB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Tf(t)}return e}}class fw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class If extends fw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uo extends If{constructor(){super("facebook.com")}static credential(e){return Sl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";class Fs extends If{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Sl._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Fs.credential(t,i)}catch{return null}}}Fs.GOOGLE_SIGN_IN_METHOD="google.com";Fs.PROVIDER_ID="google.com";class Bo extends If{constructor(){super("github.com")}static credential(e){return Sl._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bo.credential(e.oauthAccessToken)}catch{return null}}}Bo.GITHUB_SIGN_IN_METHOD="github.com";Bo.PROVIDER_ID="github.com";class Wo extends If{constructor(){super("twitter.com")}static credential(e,t){return Sl._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Wo.credential(t,i)}catch{return null}}}Wo.TWITTER_SIGN_IN_METHOD="twitter.com";Wo.PROVIDER_ID="twitter.com";class xu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await wr._fromIdTokenResponse(e,i,r),o=dC(i);return new xu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=dC(i);return new xu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function dC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class lp extends ms{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,lp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new lp(e,t,i,r)}}function Fk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?lp._fromErrorAndOperation(n,s,e,i):s})}async function TB(n,e,t=!1){const i=await Wd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xu._forOperation(n,"link",i)}async function SB(n,e,t=!1){const{auth:i}=n;if(Yi(i.app))return Promise.reject(cl(i));const r="reauthenticate";try{const s=await Wd(n,Fk(i,r,e,n),t);ze(s.idToken,i,"internal-error");const o=uw(s.idToken);ze(o,i,"internal-error");const{sub:l}=o;return ze(n.uid===l,i,"user-mismatch"),xu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&us(i,"user-mismatch"),s}}async function IB(n,e,t=!1){if(Yi(n.app))return Promise.reject(cl(n));const i="signIn",r=await Fk(n,i,e),s=await xu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function bB(n,e,t,i){return no(n).onIdTokenChanged(e,t,i)}function CB(n,e,t){return no(n).beforeAuthStateChanged(e,t)}function RB(n,e,t,i){return no(n).onAuthStateChanged(e,t,i)}function AB(n){return no(n).signOut()}const cp="__sak";class Vk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cp,"1"),this.storage.removeItem(cp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const PB=1e3,kB=10;class zk extends Vk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);aB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,kB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},PB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}zk.type="LOCAL";const NB=zk;class Uk extends Vk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Uk.type="SESSION";const Bk=Uk;function DB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ay{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new ay(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await DB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ay.receivers=[];function gw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class MB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=gw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const _=p;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(_.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function cs(){return window}function LB(n){cs().location.href=n}function Wk(){return typeof cs().WorkerGlobalScope<"u"&&typeof cs().importScripts=="function"}async function OB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jB(){return navigator?.serviceWorker?.controller||null}function FB(){return Wk()?self:null}const Gk="firebaseLocalStorageDb",VB=1,up="firebaseLocalStorage",$k="fbase_key";class bf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ly(n,e){return n.transaction([up],e?"readwrite":"readonly").objectStore(up)}function zB(){const n=indexedDB.deleteDatabase(Gk);return new bf(n).toPromise()}function sv(){const n=indexedDB.open(Gk,VB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(up,{keyPath:$k})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(up)?e(i):(i.close(),await zB(),e(await sv()))})})}async function fC(n,e,t){const i=ly(n,!0).put({[$k]:e,value:t});return new bf(i).toPromise()}async function UB(n,e){const t=ly(n,!1).get(e),i=await new bf(t).toPromise();return i===void 0?null:i.value}function gC(n,e){const t=ly(n,!0).delete(e);return new bf(t).toPromise()}const BB=800,WB=3;class Hk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>WB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Wk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ay._getInstance(FB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await OB(),!this.activeServiceWorker)return;this.sender=new MB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sv();return await fC(e,cp,"1"),await gC(e,cp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>fC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>UB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ly(r,!1).getAll();return new bf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),BB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hk.type="LOCAL";const GB=Hk;new Sf(3e4,6e4);function Kk(n,e){return e?Us(e):(ze(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class mw extends jk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ru(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ru(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ru(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $B(n){return IB(n.auth,new mw(n),n.bypassAuthState)}function HB(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),SB(t,new mw(n),n.bypassAuthState)}async function KB(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),TB(t,new mw(n),n.bypassAuthState)}class qk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $B;case"linkViaPopup":case"linkViaRedirect":return KB;case"reauthViaPopup":case"reauthViaRedirect":return HB;default:us(this.auth,"internal-error")}}resolve(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const qB=new Sf(2e3,1e4);async function XB(n,e,t){if(Yi(n.app))return Promise.reject(br(n,"operation-not-supported-in-this-environment"));const i=oy(n);WU(n,e,fw);const r=Kk(i,t);return new il(i,"signInViaPopup",e,r).executeNotNull()}class il extends qk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,il.currentPopupAction&&il.currentPopupAction.cancel(),il.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ze(e,this.auth,"internal-error"),e}async onExecution(){Qs(this.filter.length===1,"Popup operations only handle one event");const e=gw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,il.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,qB.get())};e()}}il.currentPopupAction=null;const YB="pendingRedirect",vm=new Map;class ZB extends qk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=vm.get(this.auth._key());if(!e){try{const i=await QB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}vm.set(this.auth._key(),e)}return this.bypassAuthState||vm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function QB(n,e){const t=t8(e),i=e8(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function JB(n,e){vm.set(n._key(),e)}function e8(n){return Us(n._redirectPersistence)}function t8(n){return xm(YB,n.config.apiKey,n.name)}async function n8(n,e,t=!1){if(Yi(n.app))return Promise.reject(cl(n));const i=oy(n),r=Kk(i,e),o=await new ZB(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const i8=600*1e3;class r8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!s8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Xk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(br(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i8&&this.cachedEventUids.clear(),this.cachedEventUids.has(mC(e))}saveEventToCache(e){this.cachedEventUids.add(mC(e)),this.lastProcessedEventTime=Date.now()}}function mC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Xk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function s8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Xk(n);default:return!1}}async function o8(n,e={}){return Vu(n,"GET","/v1/projects",e)}const a8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,l8=/^https?/;async function c8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await o8(n);for(const t of e)try{if(u8(t))return}catch{}us(n,"unauthorized-domain")}function u8(n){const e=iv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!l8.test(t))return!1;if(a8.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const h8=new Sf(3e4,6e4);function pC(){const n=cs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function d8(n){return new Promise((e,t)=>{function i(){pC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pC(),t(br(n,"network-request-failed"))},timeout:h8.get()})}if(cs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(cs().gapi?.load)i();else{const r=pB("iframefcb");return cs()[r]=()=>{gapi.load?i():t(br(n,"network-request-failed"))},gB(`${mB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw wm=null,e})}let wm=null;function f8(n){return wm=wm||d8(n),wm}const g8=new Sf(5e3,15e3),m8="__/auth/iframe",p8="emulator/auth/iframe",y8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function x8(n){const e=n.config;ze(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?lw(e,p8):`https://${n.config.authDomain}/${m8}`,i={apiKey:e.apiKey,appName:n.name,v:jl},r=_8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Tf(i).slice(1)}`}async function v8(n){const e=await f8(n),t=cs().gapi;return ze(t,n,"internal-error"),e.open({where:document.body,url:x8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:y8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=br(n,"network-request-failed"),l=cs().setTimeout(()=>{s(o)},g8.get());function u(){cs().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const w8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},E8=500,T8=600,S8="_blank",I8="http://localhost";class yC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b8(n,e,t,i=E8,r=T8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...w8,width:i.toString(),height:r.toString(),top:s,left:o},h=rn().toLowerCase();t&&(l=Ak(h)?S8:t),Ck(h)&&(e=e||I8,u.scrollbars="yes");const f=Object.entries(u).reduce((_,[v,S])=>`${_}${v}=${S},`,"");if(oB(h)&&l!=="_self")return C8(e||"",l),new yC(null);const p=window.open(e||"",l,f);ze(p,n,"popup-blocked");try{p.focus()}catch{}return new yC(p)}function C8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const R8="__/auth/handler",A8="emulator/auth/handler",P8=encodeURIComponent("fac");async function _C(n,e,t,i,r,s){ze(n.config.authDomain,n,"auth-domain-config-required"),ze(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:jl,eventId:r};if(e instanceof fw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Az(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof If){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${P8}=${encodeURIComponent(u)}`:"";return`${k8(n)}?${Tf(l).slice(1)}${h}`}function k8({config:n}){return n.emulator?lw(n,A8):`https://${n.authDomain}/${R8}`}const J_="webStorageSupport";class N8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Bk,this._completeRedirectFn=n8,this._overrideRedirectResult=JB}async _openPopup(e,t,i,r){Qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await _C(e,t,i,iv(),r);return b8(e,s,gw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await _C(e,t,i,iv(),r);return LB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Qs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await v8(e),i=new r8(e);return t.register("authEvent",r=>(ze(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(J_,{type:J_},r=>{const s=r?.[0]?.[J_];s!==void 0&&t(!!s),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=c8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mk()||Rk()||hw()}}const D8=N8;var xC="@firebase/auth",vC="1.12.0";class M8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function L8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function O8(n){Tl(new ra("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;ze(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Lk(n)},h=new dB(i,r,s,u);return _B(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Tl(new ra("auth-internal",e=>{const t=oy(e.getProvider("auth").getImmediate());return(i=>new M8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ls(xC,vC,L8(n)),ls(xC,vC,"esm2020")}const j8=300,F8=ck("authIdTokenMaxAge")||j8;let wC=null;const V8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>F8)return;const r=t?.token;wC!==r&&(wC=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function z8(n=sw()){const e=sy(n,"auth");if(e.isInitialized())return e.getImmediate();const t=yB(n,{popupRedirectResolver:D8,persistence:[GB,NB,Bk]}),i=ck("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=V8(s.toString());CB(t,o,()=>o(t.currentUser)),bB(t,l=>o(l))}}const r=ok("auth");return r&&xB(t,`http://${r}`),t}function U8(){return document.getElementsByTagName("head")?.[0]??document}fB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=br("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",U8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});O8("Browser");var B8="firebase",W8="12.7.0";ls(B8,W8,"app");var EC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var pw;(function(){var n;function e(A,b){function P(){}P.prototype=b.prototype,A.F=b.prototype,A.prototype=new P,A.prototype.constructor=A,A.D=function(j,z,B){for(var O=Array(arguments.length-2),se=2;se<arguments.length;se++)O[se-2]=arguments[se];return b.prototype[z].apply(j,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(A,b,P){P||(P=0);const j=Array(16);if(typeof b=="string")for(var z=0;z<16;++z)j[z]=b.charCodeAt(P++)|b.charCodeAt(P++)<<8|b.charCodeAt(P++)<<16|b.charCodeAt(P++)<<24;else for(z=0;z<16;++z)j[z]=b[P++]|b[P++]<<8|b[P++]<<16|b[P++]<<24;b=A.g[0],P=A.g[1],z=A.g[2];let B=A.g[3],O;O=b+(B^P&(z^B))+j[0]+3614090360&4294967295,b=P+(O<<7&4294967295|O>>>25),O=B+(z^b&(P^z))+j[1]+3905402710&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(P^B&(b^P))+j[2]+606105819&4294967295,z=B+(O<<17&4294967295|O>>>15),O=P+(b^z&(B^b))+j[3]+3250441966&4294967295,P=z+(O<<22&4294967295|O>>>10),O=b+(B^P&(z^B))+j[4]+4118548399&4294967295,b=P+(O<<7&4294967295|O>>>25),O=B+(z^b&(P^z))+j[5]+1200080426&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(P^B&(b^P))+j[6]+2821735955&4294967295,z=B+(O<<17&4294967295|O>>>15),O=P+(b^z&(B^b))+j[7]+4249261313&4294967295,P=z+(O<<22&4294967295|O>>>10),O=b+(B^P&(z^B))+j[8]+1770035416&4294967295,b=P+(O<<7&4294967295|O>>>25),O=B+(z^b&(P^z))+j[9]+2336552879&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(P^B&(b^P))+j[10]+4294925233&4294967295,z=B+(O<<17&4294967295|O>>>15),O=P+(b^z&(B^b))+j[11]+2304563134&4294967295,P=z+(O<<22&4294967295|O>>>10),O=b+(B^P&(z^B))+j[12]+1804603682&4294967295,b=P+(O<<7&4294967295|O>>>25),O=B+(z^b&(P^z))+j[13]+4254626195&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(P^B&(b^P))+j[14]+2792965006&4294967295,z=B+(O<<17&4294967295|O>>>15),O=P+(b^z&(B^b))+j[15]+1236535329&4294967295,P=z+(O<<22&4294967295|O>>>10),O=b+(z^B&(P^z))+j[1]+4129170786&4294967295,b=P+(O<<5&4294967295|O>>>27),O=B+(P^z&(b^P))+j[6]+3225465664&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^P&(B^b))+j[11]+643717713&4294967295,z=B+(O<<14&4294967295|O>>>18),O=P+(B^b&(z^B))+j[0]+3921069994&4294967295,P=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(P^z))+j[5]+3593408605&4294967295,b=P+(O<<5&4294967295|O>>>27),O=B+(P^z&(b^P))+j[10]+38016083&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^P&(B^b))+j[15]+3634488961&4294967295,z=B+(O<<14&4294967295|O>>>18),O=P+(B^b&(z^B))+j[4]+3889429448&4294967295,P=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(P^z))+j[9]+568446438&4294967295,b=P+(O<<5&4294967295|O>>>27),O=B+(P^z&(b^P))+j[14]+3275163606&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^P&(B^b))+j[3]+4107603335&4294967295,z=B+(O<<14&4294967295|O>>>18),O=P+(B^b&(z^B))+j[8]+1163531501&4294967295,P=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(P^z))+j[13]+2850285829&4294967295,b=P+(O<<5&4294967295|O>>>27),O=B+(P^z&(b^P))+j[2]+4243563512&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^P&(B^b))+j[7]+1735328473&4294967295,z=B+(O<<14&4294967295|O>>>18),O=P+(B^b&(z^B))+j[12]+2368359562&4294967295,P=z+(O<<20&4294967295|O>>>12),O=b+(P^z^B)+j[5]+4294588738&4294967295,b=P+(O<<4&4294967295|O>>>28),O=B+(b^P^z)+j[8]+2272392833&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^P)+j[11]+1839030562&4294967295,z=B+(O<<16&4294967295|O>>>16),O=P+(z^B^b)+j[14]+4259657740&4294967295,P=z+(O<<23&4294967295|O>>>9),O=b+(P^z^B)+j[1]+2763975236&4294967295,b=P+(O<<4&4294967295|O>>>28),O=B+(b^P^z)+j[4]+1272893353&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^P)+j[7]+4139469664&4294967295,z=B+(O<<16&4294967295|O>>>16),O=P+(z^B^b)+j[10]+3200236656&4294967295,P=z+(O<<23&4294967295|O>>>9),O=b+(P^z^B)+j[13]+681279174&4294967295,b=P+(O<<4&4294967295|O>>>28),O=B+(b^P^z)+j[0]+3936430074&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^P)+j[3]+3572445317&4294967295,z=B+(O<<16&4294967295|O>>>16),O=P+(z^B^b)+j[6]+76029189&4294967295,P=z+(O<<23&4294967295|O>>>9),O=b+(P^z^B)+j[9]+3654602809&4294967295,b=P+(O<<4&4294967295|O>>>28),O=B+(b^P^z)+j[12]+3873151461&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^P)+j[15]+530742520&4294967295,z=B+(O<<16&4294967295|O>>>16),O=P+(z^B^b)+j[2]+3299628645&4294967295,P=z+(O<<23&4294967295|O>>>9),O=b+(z^(P|~B))+j[0]+4096336452&4294967295,b=P+(O<<6&4294967295|O>>>26),O=B+(P^(b|~z))+j[7]+1126891415&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~P))+j[14]+2878612391&4294967295,z=B+(O<<15&4294967295|O>>>17),O=P+(B^(z|~b))+j[5]+4237533241&4294967295,P=z+(O<<21&4294967295|O>>>11),O=b+(z^(P|~B))+j[12]+1700485571&4294967295,b=P+(O<<6&4294967295|O>>>26),O=B+(P^(b|~z))+j[3]+2399980690&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~P))+j[10]+4293915773&4294967295,z=B+(O<<15&4294967295|O>>>17),O=P+(B^(z|~b))+j[1]+2240044497&4294967295,P=z+(O<<21&4294967295|O>>>11),O=b+(z^(P|~B))+j[8]+1873313359&4294967295,b=P+(O<<6&4294967295|O>>>26),O=B+(P^(b|~z))+j[15]+4264355552&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~P))+j[6]+2734768916&4294967295,z=B+(O<<15&4294967295|O>>>17),O=P+(B^(z|~b))+j[13]+1309151649&4294967295,P=z+(O<<21&4294967295|O>>>11),O=b+(z^(P|~B))+j[4]+4149444226&4294967295,b=P+(O<<6&4294967295|O>>>26),O=B+(P^(b|~z))+j[11]+3174756917&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~P))+j[2]+718787259&4294967295,z=B+(O<<15&4294967295|O>>>17),O=P+(B^(z|~b))+j[9]+3951481745&4294967295,A.g[0]=A.g[0]+b&4294967295,A.g[1]=A.g[1]+(z+(O<<21&4294967295|O>>>11))&4294967295,A.g[2]=A.g[2]+z&4294967295,A.g[3]=A.g[3]+B&4294967295}i.prototype.v=function(A,b){b===void 0&&(b=A.length);const P=b-this.blockSize,j=this.C;let z=this.h,B=0;for(;B<b;){if(z==0)for(;B<=P;)r(this,A,B),B+=this.blockSize;if(typeof A=="string"){for(;B<b;)if(j[z++]=A.charCodeAt(B++),z==this.blockSize){r(this,j),z=0;break}}else for(;B<b;)if(j[z++]=A[B++],z==this.blockSize){r(this,j),z=0;break}}this.h=z,this.o+=b},i.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var b=1;b<A.length-8;++b)A[b]=0;b=this.o*8;for(var P=A.length-8;P<A.length;++P)A[P]=b&255,b/=256;for(this.v(A),A=Array(16),b=0,P=0;P<4;++P)for(let j=0;j<32;j+=8)A[b++]=this.g[P]>>>j&255;return A};function s(A,b){var P=l;return Object.prototype.hasOwnProperty.call(P,A)?P[A]:P[A]=b(A)}function o(A,b){this.h=b;const P=[];let j=!0;for(let z=A.length-1;z>=0;z--){const B=A[z]|0;j&&B==b||(P[z]=B,j=!1)}this.g=P}var l={};function u(A){return-128<=A&&A<128?s(A,function(b){return new o([b|0],b<0?-1:0)}):new o([A|0],A<0?-1:0)}function h(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return w(h(-A));const b=[];let P=1;for(let j=0;A>=P;j++)b[j]=A/P|0,P*=4294967296;return new o(b,0)}function f(A,b){if(A.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(A.charAt(0)=="-")return w(f(A.substring(1),b));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=h(Math.pow(b,8));let j=p;for(let B=0;B<A.length;B+=8){var z=Math.min(8,A.length-B);const O=parseInt(A.substring(B,B+z),b);z<8?(z=h(Math.pow(b,z)),j=j.j(z).add(h(O))):(j=j.j(P),j=j.add(h(O)))}return j}var p=u(0),_=u(1),v=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-w(this).m();let A=0,b=1;for(let P=0;P<this.g.length;P++){const j=this.i(P);A+=(j>=0?j:4294967296+j)*b,b*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(S(this))return"0";if(I(this))return"-"+w(this).toString(A);const b=h(Math.pow(A,6));var P=this;let j="";for(;;){const z=L(P,b).g;P=R(P,z.j(b));let B=((P.g.length>0?P.g[0]:P.h)>>>0).toString(A);if(P=z,S(P))return B+j;for(;B.length<6;)B="0"+B;j=B+j}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function S(A){if(A.h!=0)return!1;for(let b=0;b<A.g.length;b++)if(A.g[b]!=0)return!1;return!0}function I(A){return A.h==-1}n.l=function(A){return A=R(this,A),I(A)?-1:S(A)?0:1};function w(A){const b=A.g.length,P=[];for(let j=0;j<b;j++)P[j]=~A.g[j];return new o(P,~A.h).add(_)}n.abs=function(){return I(this)?w(this):this},n.add=function(A){const b=Math.max(this.g.length,A.g.length),P=[];let j=0;for(let z=0;z<=b;z++){let B=j+(this.i(z)&65535)+(A.i(z)&65535),O=(B>>>16)+(this.i(z)>>>16)+(A.i(z)>>>16);j=O>>>16,B&=65535,O&=65535,P[z]=O<<16|B}return new o(P,P[P.length-1]&-2147483648?-1:0)};function R(A,b){return A.add(w(b))}n.j=function(A){if(S(this)||S(A))return p;if(I(this))return I(A)?w(this).j(w(A)):w(w(this).j(A));if(I(A))return w(this.j(w(A)));if(this.l(v)<0&&A.l(v)<0)return h(this.m()*A.m());const b=this.g.length+A.g.length,P=[];for(var j=0;j<2*b;j++)P[j]=0;for(j=0;j<this.g.length;j++)for(let z=0;z<A.g.length;z++){const B=this.i(j)>>>16,O=this.i(j)&65535,se=A.i(z)>>>16,me=A.i(z)&65535;P[2*j+2*z]+=O*me,M(P,2*j+2*z),P[2*j+2*z+1]+=B*me,M(P,2*j+2*z+1),P[2*j+2*z+1]+=O*se,M(P,2*j+2*z+1),P[2*j+2*z+2]+=B*se,M(P,2*j+2*z+2)}for(A=0;A<b;A++)P[A]=P[2*A+1]<<16|P[2*A];for(A=b;A<2*b;A++)P[A]=0;return new o(P,0)};function M(A,b){for(;(A[b]&65535)!=A[b];)A[b+1]+=A[b]>>>16,A[b]&=65535,b++}function D(A,b){this.g=A,this.h=b}function L(A,b){if(S(b))throw Error("division by zero");if(S(A))return new D(p,p);if(I(A))return b=L(w(A),b),new D(w(b.g),w(b.h));if(I(b))return b=L(A,w(b)),new D(w(b.g),b.h);if(A.g.length>30){if(I(A)||I(b))throw Error("slowDivide_ only works with positive integers.");for(var P=_,j=b;j.l(A)<=0;)P=N(P),j=N(j);var z=V(P,1),B=V(j,1);for(j=V(j,2),P=V(P,2);!S(j);){var O=B.add(j);O.l(A)<=0&&(z=z.add(P),B=O),j=V(j,1),P=V(P,1)}return b=R(A,z.j(b)),new D(z,b)}for(z=p;A.l(b)>=0;){for(P=Math.max(1,Math.floor(A.m()/b.m())),j=Math.ceil(Math.log(P)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),B=h(P),O=B.j(b);I(O)||O.l(A)>0;)P-=j,B=h(P),O=B.j(b);S(B)&&(B=_),z=z.add(B),A=R(A,O)}return new D(z,A)}n.B=function(A){return L(this,A).h},n.and=function(A){const b=Math.max(this.g.length,A.g.length),P=[];for(let j=0;j<b;j++)P[j]=this.i(j)&A.i(j);return new o(P,this.h&A.h)},n.or=function(A){const b=Math.max(this.g.length,A.g.length),P=[];for(let j=0;j<b;j++)P[j]=this.i(j)|A.i(j);return new o(P,this.h|A.h)},n.xor=function(A){const b=Math.max(this.g.length,A.g.length),P=[];for(let j=0;j<b;j++)P[j]=this.i(j)^A.i(j);return new o(P,this.h^A.h)};function N(A){const b=A.g.length+1,P=[];for(let j=0;j<b;j++)P[j]=A.i(j)<<1|A.i(j-1)>>>31;return new o(P,A.h)}function V(A,b){const P=b>>5;b%=32;const j=A.g.length-P,z=[];for(let B=0;B<j;B++)z[B]=b>0?A.i(B+P)>>>b|A.i(B+P+1)<<32-b:A.i(B+P);return new o(z,A.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,pw=o}).apply(typeof EC<"u"?EC:typeof self<"u"?self:typeof window<"u"?window:{});var im=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Yk,td,Zk,Em,ov,Qk,Jk,eN;(function(){var n,e=Object.defineProperty;function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof im=="object"&&im];for(var T=0;T<m.length;++T){var C=m[T];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(m,T){if(T)e:{var C=i;m=m.split(".");for(var F=0;F<m.length-1;F++){var Z=m[F];if(!(Z in C))break e;C=C[Z]}m=m[m.length-1],F=C[m],T=T(F),T!=F&&T!=null&&e(C,m,{configurable:!0,writable:!0,value:T})}}r("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(m){return m||function(T){var C=[],F;for(F in T)Object.prototype.hasOwnProperty.call(T,F)&&C.push([F,T[F]]);return C}});var s=s||{},o=this||self;function l(m){var T=typeof m;return T=="object"&&m!=null||T=="function"}function u(m,T,C){return m.call.apply(m.bind,arguments)}function h(m,T,C){return h=u,h.apply(null,arguments)}function f(m,T){var C=Array.prototype.slice.call(arguments,1);return function(){var F=C.slice();return F.push.apply(F,arguments),m.apply(this,F)}}function p(m,T){function C(){}C.prototype=T.prototype,m.Z=T.prototype,m.prototype=new C,m.prototype.constructor=m,m.Ob=function(F,Z,te){for(var de=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)de[Be-2]=arguments[Be];return T.prototype[Z].apply(F,de)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function v(m){const T=m.length;if(T>0){const C=Array(T);for(let F=0;F<T;F++)C[F]=m[F];return C}return[]}function S(m,T){for(let F=1;F<arguments.length;F++){const Z=arguments[F];var C=typeof Z;if(C=C!="object"?C:Z?Array.isArray(Z)?"array":C:"null",C=="array"||C=="object"&&typeof Z.length=="number"){C=m.length||0;const te=Z.length||0;m.length=C+te;for(let de=0;de<te;de++)m[C+de]=Z[de]}else m.push(Z)}}class I{constructor(T,C){this.i=T,this.j=C,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function w(m){o.setTimeout(()=>{throw m},0)}function R(){var m=A;let T=null;return m.g&&(T=m.g,m.g=m.g.next,m.g||(m.h=null),T.next=null),T}class M{constructor(){this.h=this.g=null}add(T,C){const F=D.get();F.set(T,C),this.h?this.h.next=F:this.g=F,this.h=F}}var D=new I(()=>new L,m=>m.reset());class L{constructor(){this.next=this.g=this.h=null}set(T,C){this.h=T,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let N,V=!1,A=new M,b=()=>{const m=Promise.resolve(void 0);N=()=>{m.then(P)}};function P(){for(var m;m=R();){try{m.h.call(m.g)}catch(C){w(C)}var T=D;T.j(m),T.h<100&&(T.h++,m.next=T.g,T.g=m)}V=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(m,T){this.type=m,this.g=this.target=T,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var m=!1,T=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const C=()=>{};o.addEventListener("test",C,T),o.removeEventListener("test",C,T)}catch{}return m})();function O(m){return/^[\s\xa0]*$/.test(m)}function se(m,T){z.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,T)}p(se,z),se.prototype.init=function(m,T){const C=this.type=m.type,F=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=T,T=m.relatedTarget,T||(C=="mouseover"?T=m.fromElement:C=="mouseout"&&(T=m.toElement)),this.relatedTarget=T,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),pe=0;function ue(m,T,C,F,Z){this.listener=m,this.proxy=null,this.src=T,this.type=C,this.capture=!!F,this.ha=Z,this.key=++pe,this.da=this.fa=!1}function H(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function X(m,T,C){for(const F in m)T.call(C,m[F],F,m)}function ne(m,T){for(const C in m)T.call(void 0,m[C],C,m)}function W(m){const T={};for(const C in m)T[C]=m[C];return T}const G="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function re(m,T){let C,F;for(let Z=1;Z<arguments.length;Z++){F=arguments[Z];for(C in F)m[C]=F[C];for(let te=0;te<G.length;te++)C=G[te],Object.prototype.hasOwnProperty.call(F,C)&&(m[C]=F[C])}}function ge(m){this.src=m,this.g={},this.h=0}ge.prototype.add=function(m,T,C,F,Z){const te=m.toString();m=this.g[te],m||(m=this.g[te]=[],this.h++);const de=Ce(m,T,F,Z);return de>-1?(T=m[de],C||(T.fa=!1)):(T=new ue(T,this.src,te,!!F,Z),T.fa=C,m.push(T)),T};function _e(m,T){const C=T.type;if(C in m.g){var F=m.g[C],Z=Array.prototype.indexOf.call(F,T,void 0),te;(te=Z>=0)&&Array.prototype.splice.call(F,Z,1),te&&(H(T),m.g[C].length==0&&(delete m.g[C],m.h--))}}function Ce(m,T,C,F){for(let Z=0;Z<m.length;++Z){const te=m[Z];if(!te.da&&te.listener==T&&te.capture==!!C&&te.ha==F)return Z}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),be={};function Le(m,T,C,F,Z){if(Array.isArray(T)){for(let te=0;te<T.length;te++)Le(m,T[te],C,F,Z);return null}return C=Ni(C),m&&m[me]?m.J(T,C,l(F)?!!F.capture:!1,Z):Ge(m,T,C,!1,F,Z)}function Ge(m,T,C,F,Z,te){if(!T)throw Error("Invalid event type");const de=l(Z)?!!Z.capture:!!Z;let Be=mn(m);if(Be||(m[Ne]=Be=new ge(m)),C=Be.add(T,C,F,de,te),C.proxy)return C;if(F=Wt(),C.proxy=F,F.src=m,F.listener=C,m.addEventListener)B||(Z=de),Z===void 0&&(Z=!1),m.addEventListener(T.toString(),F,Z);else if(m.attachEvent)m.attachEvent(Pn(T.toString()),F);else if(m.addListener&&m.removeListener)m.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Wt(){function m(C){return T.call(m.src,m.listener,C)}const T=gn;return m}function Wn(m,T,C,F,Z){if(Array.isArray(T))for(var te=0;te<T.length;te++)Wn(m,T[te],C,F,Z);else F=l(F)?!!F.capture:!!F,C=Ni(C),m&&m[me]?(m=m.i,te=String(T).toString(),te in m.g&&(T=m.g[te],C=Ce(T,C,F,Z),C>-1&&(H(T[C]),Array.prototype.splice.call(T,C,1),T.length==0&&(delete m.g[te],m.h--)))):m&&(m=mn(m))&&(T=m.g[T.toString()],m=-1,T&&(m=Ce(T,C,F,Z)),(C=m>-1?T[m]:null)&&Zt(C))}function Zt(m){if(typeof m!="number"&&m&&!m.da){var T=m.src;if(T&&T[me])_e(T.i,m);else{var C=m.type,F=m.proxy;T.removeEventListener?T.removeEventListener(C,F,m.capture):T.detachEvent?T.detachEvent(Pn(C),F):T.addListener&&T.removeListener&&T.removeListener(F),(C=mn(T))?(_e(C,m),C.h==0&&(C.src=null,T[Ne]=null)):H(m)}}}function Pn(m){return m in be?be[m]:be[m]="on"+m}function gn(m,T){if(m.da)m=!0;else{T=new se(T,this);const C=m.listener,F=m.ha||m.src;m.fa&&Zt(m),m=C.call(F,T)}return m}function mn(m){return m=m[Ne],m instanceof ge?m:null}var Qn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ni(m){return typeof m=="function"?m:(m[Qn]||(m[Qn]=function(T){return m.handleEvent(T)}),m[Qn])}function _t(){j.call(this),this.i=new ge(this),this.M=this,this.G=null}p(_t,j),_t.prototype[me]=!0,_t.prototype.removeEventListener=function(m,T,C,F){Wn(this,m,T,C,F)};function ut(m,T){var C,F=m.G;if(F)for(C=[];F;F=F.G)C.push(F);if(m=m.M,F=T.type||T,typeof T=="string")T=new z(T,m);else if(T instanceof z)T.target=T.target||m;else{var Z=T;T=new z(F,m),re(T,Z)}Z=!0;let te,de;if(C)for(de=C.length-1;de>=0;de--)te=T.g=C[de],Z=on(te,F,!0,T)&&Z;if(te=T.g=m,Z=on(te,F,!0,T)&&Z,Z=on(te,F,!1,T)&&Z,C)for(de=0;de<C.length;de++)te=T.g=C[de],Z=on(te,F,!1,T)&&Z}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var m=this.i;for(const T in m.g){const C=m.g[T];for(let F=0;F<C.length;F++)H(C[F]);delete m.g[T],m.h--}}this.G=null},_t.prototype.J=function(m,T,C,F){return this.i.add(String(m),T,!1,C,F)},_t.prototype.K=function(m,T,C,F){return this.i.add(String(m),T,!0,C,F)};function on(m,T,C,F){if(T=m.i.g[String(T)],!T)return!0;T=T.concat();let Z=!0;for(let te=0;te<T.length;++te){const de=T[te];if(de&&!de.da&&de.capture==C){const Be=de.listener,Vt=de.ha||de.src;de.fa&&_e(m.i,de),Z=Be.call(Vt,F)!==!1&&Z}}return Z&&!F.defaultPrevented}function Di(m,T){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=h(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:o.setTimeout(m,T||0)}function It(m){m.g=Di(()=>{m.g=null,m.i&&(m.i=!1,It(m))},m.l);const T=m.h;m.h=null,m.m.apply(null,T)}class io extends j{constructor(T,C){super(),this.m=T,this.l=C,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mi(m){j.call(this),this.h=m,this.g={}}p(Mi,j);var kr=[];function rr(m){X(m.g,function(T,C){this.g.hasOwnProperty(C)&&Zt(T)},m),m.g={}}Mi.prototype.N=function(){Mi.Z.N.call(this),rr(this)},Mi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nr=o.JSON.stringify,ha=o.JSON.parse,Dr=class{stringify(m){return o.JSON.stringify(m,void 0)}parse(m){return o.JSON.parse(m,void 0)}};function Li(){}function Vl(){}var Mr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ys(){z.call(this,"d")}p(ys,z);function ro(){z.call(this,"c")}p(ro,z);var Gn={},_s=null;function Lr(){return _s=_s||new _t}Gn.Ia="serverreachability";function Or(m){z.call(this,Gn.Ia,m)}p(Or,z);function $n(m){const T=Lr();ut(T,new Or(T))}Gn.STAT_EVENT="statevent";function Hn(m,T){z.call(this,Gn.STAT_EVENT,m),this.stat=T}p(Hn,z);function gt(m){const T=Lr();ut(T,new Hn(T,m))}Gn.Ja="timingevent";function so(m,T){z.call(this,Gn.Ja,m),this.size=T}p(so,z);function sr(m,T){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){m()},T)}function jt(){this.g=!0}jt.prototype.ua=function(){this.g=!1};function Oi(m,T,C,F,Z,te){m.info(function(){if(m.g)if(te){var de="",Be=te.split("&");for(let ht=0;ht<Be.length;ht++){var Vt=Be[ht].split("=");if(Vt.length>1){const $t=Vt[0];Vt=Vt[1];const vi=$t.split("_");de=vi.length>=2&&vi[1]=="type"?de+($t+"="+Vt+"&"):de+($t+"=redacted&")}}}else de=null;else de=te;return"XMLHTTP REQ ("+F+") [attempt "+Z+"]: "+T+`
`+C+`
`+de})}function pn(m,T,C,F,Z,te,de){m.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+Z+"]: "+T+`
`+C+`
`+te+" "+de})}function Ft(m,T,C,F){m.info(function(){return"XMLHTTP TEXT ("+T+"): "+_n(m,C)+(F?" "+F:"")})}function yn(m,T){m.info(function(){return"TIMEOUT: "+T})}jt.prototype.info=function(){};function _n(m,T){if(!m.g)return T;if(!T)return null;try{const te=JSON.parse(T);if(te){for(m=0;m<te.length;m++)if(Array.isArray(te[m])){var C=te[m];if(!(C.length<2)){var F=C[1];if(Array.isArray(F)&&!(F.length<1)){var Z=F[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let de=1;de<F.length;de++)F[de]=""}}}}return Nr(te)}catch{return T}}var an={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ot={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function Qt(){}p(Qt,Li),Qt.prototype.g=function(){return new XMLHttpRequest},Gt=new Qt;function ji(m){return encodeURIComponent(String(m))}function zl(m){var T=1;m=m.split(":");const C=[];for(;T>0&&m.length;)C.push(m.shift()),T--;return m.length&&C.push(m.join(":")),C}function Fi(m,T,C,F){this.j=m,this.i=T,this.l=C,this.S=F||1,this.V=new Mi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new kf}function kf(){this.i=null,this.g="",this.h=!1}var Nf={},Bu={};function or(m,T,C){m.M=1,m.A=vs(Vi(T)),m.u=C,m.R=!0,Wu(m,null)}function Wu(m,T){m.F=Date.now(),da(m),m.B=Vi(m.A);var C=m.B,F=m.S;Array.isArray(F)||(F=[String(F)]),Ju(C.i,"t",F),m.C=0,C=m.j.L,m.h=new kf,m.g=Bf(m.j,C?T:null,!m.u),m.P>0&&(m.O=new io(h(m.Y,m,m.g),m.P)),T=m.V,C=m.g,F=m.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(kr[0]=Z.toString()),Z=kr);for(let te=0;te<Z.length;te++){const de=Le(C,Z[te],F||T.handleEvent,!1,T.h||T);if(!de)break;T.g[de.key]=de}T=m.J?W(m.J):{},m.u?(m.v||(m.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,T)):(m.v="GET",m.g.ea(m.B,m.v,null,T)),$n(),Oi(m.i,m.v,m.B,m.l,m.S,m.u)}Fi.prototype.ba=function(m){m=m.target;const T=this.O;T&&Wr(m)==3?T.j():this.Y(m)},Fi.prototype.Y=function(m){try{if(m==this.g)e:{const Be=Wr(this.g),Vt=this.g.ya(),ht=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||zf(this.g)))){this.K||Be!=4||Vt==7||(Vt==8||ht<=0?$n(3):$n(2)),Ul(this);var T=this.g.ca();this.X=T;var C=Df(this);if(this.o=T==200,pn(this.i,this.v,this.B,this.l,this.S,Be,T),this.o){if(this.U&&!this.L){t:{if(this.g){var F,Z=this.g;if((F=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(F)){var te=F;break t}}te=null}if(m=te)Ft(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,m);else{this.o=!1,this.m=3,gt(12),xs(this),fa(this);break e}}if(this.R){m=!0;let $t;for(;!this.K&&this.C<C.length;)if($t=Lf(this,C),$t==Bu){Be==4&&(this.m=4,gt(14),m=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if($t==Nf){this.m=4,gt(15),Ft(this.i,this.l,C,"[Invalid Chunk]"),m=!1;break}else Ft(this.i,this.l,$t,null),vt(this,$t);if(Mf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||C.length!=0||this.h.h||(this.m=1,gt(16),m=!1),this.o=this.o&&m,!m)Ft(this.i,this.l,C,"[Invalid Chunked Response]"),xs(this),fa(this);else if(C.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Ea(de),de.P=!0,gt(11))}}else Ft(this.i,this.l,C,null),vt(this,C);Be==4&&xs(this),this.o&&!this.K&&(Be==4?Zl(this.j,this):(this.o=!1,da(this)))}else th(this.g),T==400&&C.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),xs(this),fa(this)}}}catch{}};function Df(m){if(!Mf(m))return m.g.la();const T=zf(m.g);if(T==="")return"";let C="";const F=T.length,Z=Wr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return xs(m),fa(m),"";m.h.i=new o.TextDecoder}for(let te=0;te<F;te++)m.h.h=!0,C+=m.h.i.decode(T[te],{stream:!(Z&&te==F-1)});return T.length=0,m.h.g+=C,m.C=0,m.h.g}function Mf(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function Lf(m,T){var C=m.C,F=T.indexOf(`
`,C);return F==-1?Bu:(C=Number(T.substring(C,F)),isNaN(C)?Nf:(F+=1,F+C>T.length?Bu:(T=T.slice(F,F+C),m.C=F+C,T)))}Fi.prototype.cancel=function(){this.K=!0,xs(this)};function da(m){m.T=Date.now()+m.H,Gu(m,m.H)}function Gu(m,T){if(m.D!=null)throw Error("WatchDog timer not null");m.D=sr(h(m.aa,m),T)}function Ul(m){m.D&&(o.clearTimeout(m.D),m.D=null)}Fi.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(yn(this.i,this.B),this.M!=2&&($n(),gt(17)),xs(this),this.m=2,fa(this)):Gu(this,this.T-m)};function fa(m){m.j.I==0||m.K||Zl(m.j,m)}function xs(m){Ul(m);var T=m.O;T&&typeof T.dispose=="function"&&T.dispose(),m.O=null,rr(m.V),m.g&&(T=m.g,m.g=null,T.abort(),T.dispose())}function vt(m,T){try{var C=m.j;if(C.I!=0&&(C.g==m||Hu(C.h,m))){if(!m.L&&Hu(C.h,m)&&C.I==3){try{var F=C.Ba.g.parse(T)}catch{F=null}if(Array.isArray(F)&&F.length==3){var Z=F;if(Z[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<m.F)Yl(C),_i(C);else break e;Hr(C),gt(18)}}else C.xa=Z[1],0<C.xa-C.K&&Z[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=sr(h(C.Va,C),6e3));ga(C.h)<=1&&C.ta&&(C.ta=void 0)}else xi(C,11)}else if((m.L||C.g==m)&&Yl(C),!O(T))for(Z=C.Ba.g.parse(T),T=0;T<Z.length;T++){let ht=Z[T];const $t=ht[0];if(!($t<=C.K))if(C.K=$t,ht=ht[1],C.I==2)if(ht[0]=="c"){C.M=ht[1],C.ba=ht[2];const vi=ht[3];vi!=null&&(C.ka=vi,C.j.info("VER="+C.ka));const Is=ht[4];Is!=null&&(C.za=Is,C.j.info("SVER="+C.za));const Kr=ht[5];Kr!=null&&typeof Kr=="number"&&Kr>0&&(F=1.5*Kr,C.O=F,C.j.info("backChannelRequestTimeoutMs_="+F)),F=C;const qr=m.g;if(qr){const ec=qr.g?qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var te=F.h;te.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Wl(te,te.h),te.h=null))}if(F.G){const rh=qr.g?qr.g.getResponseHeader("X-HTTP-Session-Id"):null;rh&&(F.wa=rh,at(F.J,F.G,rh))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-m.F,C.j.info("Handshake RTT: "+C.T+"ms")),F=C;var de=m;if(F.na=ih(F,F.L?F.ba:null,F.W),de.L){ma(F.h,de);var Be=de,Vt=F.O;Vt&&(Be.H=Vt),Be.D&&(Ul(Be),da(Be)),F.g=de}else kn(F);C.i.length>0&&Ss(C)}else ht[0]!="stop"&&ht[0]!="close"||xi(C,7);else C.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?xi(C,7):ql(C):ht[0]!="noop"&&C.l&&C.l.qa(ht),C.A=0)}}$n(4)}catch{}}var Ay=class{constructor(m,T){this.g=m,this.map=T}};function Bl(m){this.l=m||10,o.PerformanceNavigationTiming?(m=o.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $u(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function ga(m){return m.h?1:m.g?m.g.size:0}function Hu(m,T){return m.h?m.h==T:m.g?m.g.has(T):!1}function Wl(m,T){m.g?m.g.add(T):m.h=T}function ma(m,T){m.h&&m.h==T?m.h=null:m.g&&m.g.has(T)&&m.g.delete(T)}Bl.prototype.cancel=function(){if(this.i=mi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function mi(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let T=m.i;for(const C of m.g.values())T=T.concat(C.G);return T}return v(m.i)}var Of=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pi(m,T){if(m){m=m.split("&");for(let C=0;C<m.length;C++){const F=m[C].indexOf("=");let Z,te=null;F>=0?(Z=m[C].substring(0,F),te=m[C].substring(F+1)):Z=m[C],T(Z,te?decodeURIComponent(te.replace(/\+/g," ")):"")}}}function jr(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;m instanceof jr?(this.l=m.l,pa(this,m.j),this.o=m.o,this.g=m.g,Fr(this,m.u),this.h=m.h,oo(this,eh(m.i)),this.m=m.m):m&&(T=String(m).match(Of))?(this.l=!1,pa(this,T[1]||"",!0),this.o=ya(T[2]||""),this.g=ya(T[3]||"",!0),Fr(this,T[4]),this.h=ya(T[5]||"",!0),oo(this,T[6]||"",!0),this.m=ya(T[7]||"")):(this.l=!1,this.i=new Ye(null,this.l))}jr.prototype.toString=function(){const m=[];var T=this.j;T&&m.push(_a(T,qu,!0),":");var C=this.g;return(C||T=="file")&&(m.push("//"),(T=this.o)&&m.push(_a(T,qu,!0),"@"),m.push(ji(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&m.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&m.push("/"),m.push(_a(C,C.charAt(0)=="/"?xa:Xu,!0))),(C=this.i.toString())&&m.push("?",C),(C=this.m)&&m.push("#",_a(C,Yu)),m.join("")},jr.prototype.resolve=function(m){const T=Vi(this);let C=!!m.j;C?pa(T,m.j):C=!!m.o,C?T.o=m.o:C=!!m.g,C?T.g=m.g:C=m.u!=null;var F=m.h;if(C)Fr(T,m.u);else if(C=!!m.h){if(F.charAt(0)!="/")if(this.g&&!this.h)F="/"+F;else{var Z=T.h.lastIndexOf("/");Z!=-1&&(F=T.h.slice(0,Z+1)+F)}if(Z=F,Z==".."||Z==".")F="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){F=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const te=[];for(let de=0;de<Z.length;){const Be=Z[de++];Be=="."?F&&de==Z.length&&te.push(""):Be==".."?((te.length>1||te.length==1&&te[0]!="")&&te.pop(),F&&de==Z.length&&te.push("")):(te.push(Be),F=!0)}F=te.join("/")}else F=Z}return C?T.h=F:C=m.i.toString()!=="",C?oo(T,eh(m.i)):C=!!m.m,C&&(T.m=m.m),T};function Vi(m){return new jr(m)}function pa(m,T,C){m.j=C?ya(T,!0):T,m.j&&(m.j=m.j.replace(/:$/,""))}function Fr(m,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);m.u=T}else m.u=null}function oo(m,T,C){T instanceof Ye?(m.i=T,$l(m.i,m.l)):(C||(T=_a(T,Py)),m.i=new Ye(T,m.l))}function at(m,T,C){m.i.set(T,C)}function vs(m){return at(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function ya(m,T){return m?T?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function _a(m,T,C){return typeof m=="string"?(m=encodeURI(m).replace(T,Ku),C&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Ku(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var qu=/[#\/\?@]/g,Xu=/[#\?:]/g,xa=/[#\?]/g,Py=/[#\?@]/g,Yu=/#/g;function Ye(m,T){this.h=this.g=null,this.i=m||null,this.j=!!T}function Vr(m){m.g||(m.g=new Map,m.h=0,m.i&&pi(m.i,function(T,C){m.add(decodeURIComponent(T.replace(/\+/g," ")),C)}))}n=Ye.prototype,n.add=function(m,T){Vr(this),this.i=null,m=zr(this,m);let C=this.g.get(m);return C||this.g.set(m,C=[]),C.push(T),this.h+=1,this};function Zu(m,T){Vr(m),T=zr(m,T),m.g.has(T)&&(m.i=null,m.h-=m.g.get(T).length,m.g.delete(T))}function Gl(m,T){return Vr(m),T=zr(m,T),m.g.has(T)}n.forEach=function(m,T){Vr(this),this.g.forEach(function(C,F){C.forEach(function(Z){m.call(T,Z,F,this)},this)},this)};function Qu(m,T){Vr(m);let C=[];if(typeof T=="string")Gl(m,T)&&(C=C.concat(m.g.get(zr(m,T))));else for(m=Array.from(m.g.values()),T=0;T<m.length;T++)C=C.concat(m[T]);return C}n.set=function(m,T){return Vr(this),this.i=null,m=zr(this,m),Gl(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[T]),this.h+=1,this},n.get=function(m,T){return m?(m=Qu(this,m),m.length>0?String(m[0]):T):T};function Ju(m,T,C){Zu(m,T),C.length>0&&(m.i=null,m.g.set(zr(m,T),v(C)),m.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],T=Array.from(this.g.keys());for(let F=0;F<T.length;F++){var C=T[F];const Z=ji(C);C=Qu(this,C);for(let te=0;te<C.length;te++){let de=Z;C[te]!==""&&(de+="="+ji(C[te])),m.push(de)}}return this.i=m.join("&")};function eh(m){const T=new Ye;return T.i=m.i,m.g&&(T.g=new Map(m.g),T.h=m.h),T}function zr(m,T){return T=String(T),m.j&&(T=T.toLowerCase()),T}function $l(m,T){T&&!m.j&&(Vr(m),m.i=null,m.g.forEach(function(C,F){const Z=F.toLowerCase();F!=Z&&(Zu(this,F),Ju(this,Z,C))},m)),m.j=T}function Ur(m,T){const C=new jt;if(o.Image){const F=new Image;F.onload=f(xn,C,"TestLoadImage: loaded",!0,T,F),F.onerror=f(xn,C,"TestLoadImage: error",!1,T,F),F.onabort=f(xn,C,"TestLoadImage: abort",!1,T,F),F.ontimeout=f(xn,C,"TestLoadImage: timeout",!1,T,F),o.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=m}else T(!1)}function Br(m,T){const C=new jt,F=new AbortController,Z=setTimeout(()=>{F.abort(),xn(C,"TestPingServer: timeout",!1,T)},1e4);fetch(m,{signal:F.signal}).then(te=>{clearTimeout(Z),te.ok?xn(C,"TestPingServer: ok",!0,T):xn(C,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(Z),xn(C,"TestPingServer: error",!1,T)})}function xn(m,T,C,F,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),F(C)}catch{}}function va(){this.g=new Dr}function ws(m){this.i=m.Sb||null,this.h=m.ab||!1}p(ws,Li),ws.prototype.g=function(){return new yi(this.i,this.h)};function yi(m,T){_t.call(this),this.H=m,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(yi,_t),n=yi.prototype,n.open=function(m,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=T,this.readyState=1,ar(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(T.body=m),(this.H||o).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},n.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,ar(this)),this.g&&(this.readyState=3,ar(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;jf(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function jf(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}n.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var T=m.value?m.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!m.done}))&&(this.response=this.responseText+=T)}m.done?ao(this):ar(this),this.readyState==3&&jf(this)}},n.Oa=function(m){this.g&&(this.response=this.responseText=m,ao(this))},n.Na=function(m){this.g&&(this.response=m,ao(this))},n.ga=function(){this.g&&ao(this)};function ao(m){m.readyState=4,m.l=null,m.j=null,m.B=null,ar(m)}n.setRequestHeader=function(m,T){this.A.append(m,T)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],T=this.h.entries();for(var C=T.next();!C.done;)C=C.value,m.push(C[0]+": "+C[1]),C=T.next();return m.join(`\r
`)};function ar(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Ff(m){let T="";return X(m,function(C,F){T+=F,T+=":",T+=C,T+=`\r
`}),T}function Hl(m,T,C){e:{for(F in C){var F=!1;break e}F=!0}F||(C=Ff(C),typeof m=="string"?C!=null&&ji(C):at(m,T,C))}function pt(m){_t.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(pt,_t);var Vf=/^https?$/i,ky=["POST","PUT"];n=pt.prototype,n.Fa=function(m){this.H=m},n.ea=function(m,T,C,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);T=T?T.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(T,String(m),!0),this.B=!1}catch(te){lo(this,te);return}if(m=C||"",C=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var Z in F)C.set(Z,F[Z]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const te of F.keys())C.set(te,F.get(te));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(C.keys()).find(te=>te.toLowerCase()=="content-type"),Z=o.FormData&&m instanceof o.FormData,!(Array.prototype.indexOf.call(ky,T,void 0)>=0)||F||Z||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,de]of C)this.g.setRequestHeader(te,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(te){lo(this,te)}};function lo(m,T){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=T,m.o=5,co(m),Ts(m)}function co(m){m.A||(m.A=!0,ut(m,"complete"),ut(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,ut(this,"complete"),ut(this,"abort"),Ts(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ts(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Es(this):this.Xa())},n.Xa=function(){Es(this)};function Es(m){if(m.h&&typeof s<"u"){if(m.v&&Wr(m)==4)setTimeout(m.Ca.bind(m),0);else if(ut(m,"readystatechange"),Wr(m)==4){m.h=!1;try{const te=m.ca();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var C;if(!(C=T)){var F;if(F=te===0){let de=String(m.D).match(Of)[1]||null;!de&&o.self&&o.self.location&&(de=o.self.location.protocol.slice(0,-1)),F=!Vf.test(de?de.toLowerCase():"")}C=F}if(C)ut(m,"complete"),ut(m,"success");else{m.o=6;try{var Z=Wr(m)>2?m.g.statusText:""}catch{Z=""}m.l=Z+" ["+m.ca()+"]",co(m)}}finally{Ts(m)}}}}function Ts(m,T){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const C=m.g;m.g=null,T||ut(m,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Wr(m){return m.g?m.g.readyState:0}n.ca=function(){try{return Wr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(m){if(this.g){var T=this.g.responseText;return m&&T.indexOf(m)==0&&(T=T.substring(m.length)),ha(T)}};function zf(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function th(m){const T={};m=(m.g&&Wr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<m.length;F++){if(O(m[F]))continue;var C=zl(m[F]);const Z=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const te=T[Z]||[];T[Z]=te,te.push(C)}ne(T,function(F){return F.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gr(m,T,C){return C&&C.internalChannelParams&&C.internalChannelParams[m]||T}function Kl(m){this.za=0,this.i=[],this.j=new jt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Gr("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Gr("baseRetryDelayMs",5e3,m),this.Za=Gr("retryDelaySeedMs",1e4,m),this.Ta=Gr("forwardChannelMaxRetries",2,m),this.va=Gr("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Bl(m&&m.concurrentRequestLimit),this.Ba=new va,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Kl.prototype,n.ka=8,n.I=1,n.connect=function(m,T,C,F){gt(0),this.W=m,this.H=T||{},C&&F!==void 0&&(this.H.OSID=C,this.H.OAID=F),this.F=this.X,this.J=ih(this,null,this.W),Ss(this)};function ql(m){if(Xl(m),m.I==3){var T=m.V++,C=Vi(m.J);if(at(C,"SID",m.M),at(C,"RID",T),at(C,"TYPE","terminate"),$r(m,C),T=new Fi(m,m.j,T),T.M=2,T.A=vs(Vi(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(T.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=T.A,C=!0),C||(T.g=Bf(T.j,null),T.g.ea(T.A)),T.F=Date.now(),da(T)}Ta(m)}function _i(m){m.g&&(Ea(m),m.g.cancel(),m.g=null)}function Xl(m){_i(m),m.v&&(o.clearTimeout(m.v),m.v=null),Yl(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&o.clearTimeout(m.m),m.m=null)}function Ss(m){if(!$u(m.h)&&!m.m){m.m=!0;var T=m.Ea;N||b(),V||(N(),V=!0),A.add(T,m),m.D=0}}function Uf(m,T){return ga(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=T.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=sr(h(m.Ea,m,T),Ql(m,m.D)),m.D++,!0)}n.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const Z=new Fi(this,this.j,m);let te=this.o;if(this.U&&(te?(te=W(te),re(te,this.U)):te=this.U),this.u!==null||this.R||(Z.J=te,te=null),this.S)e:{for(var T=0,C=0;C<this.i.length;C++){t:{var F=this.i[C];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(T+=F,T>4096){T=C;break e}if(T===4096||C===this.i.length-1){T=C+1;break e}}T=1e3}else T=1e3;T=nh(this,Z,T),C=Vi(this.J),at(C,"RID",m),at(C,"CVER",22),this.G&&at(C,"X-HTTP-Session-Id",this.G),$r(this,C),te&&(this.R?T="headers="+ji(Ff(te))+"&"+T:this.u&&Hl(C,this.u,te)),Wl(this.h,Z),this.Ra&&at(C,"TYPE","init"),this.S?(at(C,"$req",T),at(C,"SID","null"),Z.U=!0,or(Z,C,null)):or(Z,C,T),this.I=2}}else this.I==3&&(m?wa(this,m):this.i.length==0||$u(this.h)||wa(this))};function wa(m,T){var C;T?C=T.l:C=m.V++;const F=Vi(m.J);at(F,"SID",m.M),at(F,"RID",C),at(F,"AID",m.K),$r(m,F),m.u&&m.o&&Hl(F,m.u,m.o),C=new Fi(m,m.j,C,m.D+1),m.u===null&&(C.J=m.o),T&&(m.i=T.G.concat(m.i)),T=nh(m,C,1e3),C.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),Wl(m.h,C),or(C,F,T)}function $r(m,T){m.H&&X(m.H,function(C,F){at(T,F,C)}),m.l&&X({},function(C,F){at(T,F,C)})}function nh(m,T,C){C=Math.min(m.i.length,C);const F=m.l?h(m.l.Ka,m.l,m):null;e:{var Z=m.i;let Be=-1;for(;;){const Vt=["count="+C];Be==-1?C>0?(Be=Z[0].g,Vt.push("ofs="+Be)):Be=0:Vt.push("ofs="+Be);let ht=!0;for(let $t=0;$t<C;$t++){var te=Z[$t].g;const vi=Z[$t].map;if(te-=Be,te<0)Be=Math.max(0,Z[$t].g-100),ht=!1;else try{te="req"+te+"_"||"";try{var de=vi instanceof Map?vi:Object.entries(vi);for(const[Is,Kr]of de){let qr=Kr;l(Kr)&&(qr=Nr(Kr)),Vt.push(te+Is+"="+encodeURIComponent(qr))}}catch(Is){throw Vt.push(te+"type="+encodeURIComponent("_badmap")),Is}}catch{F&&F(vi)}}if(ht){de=Vt.join("&");break e}}de=void 0}return m=m.i.splice(0,C),T.G=m,de}function kn(m){if(!m.g&&!m.v){m.Y=1;var T=m.Da;N||b(),V||(N(),V=!0),A.add(T,m),m.A=0}}function Hr(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=sr(h(m.Da,m),Ql(m,m.A)),m.A++,!0)}n.Da=function(){if(this.v=null,uo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=sr(h(this.Wa,this),m)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),_i(this),uo(this))};function Ea(m){m.B!=null&&(o.clearTimeout(m.B),m.B=null)}function uo(m){m.g=new Fi(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var T=Vi(m.na);at(T,"RID","rpc"),at(T,"SID",m.M),at(T,"AID",m.K),at(T,"CI",m.F?"0":"1"),!m.F&&m.ia&&at(T,"TO",m.ia),at(T,"TYPE","xmlhttp"),$r(m,T),m.u&&m.o&&Hl(T,m.u,m.o),m.O&&(m.g.H=m.O);var C=m.g;m=m.ba,C.M=1,C.A=vs(Vi(T)),C.u=null,C.R=!0,Wu(C,m)}n.Va=function(){this.C!=null&&(this.C=null,_i(this),Hr(this),gt(19))};function Yl(m){m.C!=null&&(o.clearTimeout(m.C),m.C=null)}function Zl(m,T){var C=null;if(m.g==T){Yl(m),Ea(m),m.g=null;var F=2}else if(Hu(m.h,T))C=T.G,ma(m.h,T),F=1;else return;if(m.I!=0){if(T.o)if(F==1){C=T.u?T.u.length:0,T=Date.now()-T.F;var Z=m.D;F=Lr(),ut(F,new so(F,C)),Ss(m)}else kn(m);else if(Z=T.m,Z==3||Z==0&&T.X>0||!(F==1&&Uf(m,T)||F==2&&Hr(m)))switch(C&&C.length>0&&(T=m.h,T.i=T.i.concat(C)),Z){case 1:xi(m,5);break;case 4:xi(m,10);break;case 3:xi(m,6);break;default:xi(m,2)}}}function Ql(m,T){let C=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(C*=2),C*T}function xi(m,T){if(m.j.info("Error code "+T),T==2){var C=h(m.bb,m),F=m.Ua;const Z=!F;F=new jr(F||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||pa(F,"https"),vs(F),Z?Ur(F.toString(),C):Br(F.toString(),C)}else gt(2);m.I=0,m.l&&m.l.pa(T),Ta(m),Xl(m)}n.bb=function(m){m?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Ta(m){if(m.I=0,m.ja=[],m.l){const T=mi(m.h);(T.length!=0||m.i.length!=0)&&(S(m.ja,T),S(m.ja,m.i),m.h.i.length=0,v(m.i),m.i.length=0),m.l.oa()}}function ih(m,T,C){var F=C instanceof jr?Vi(C):new jr(C);if(F.g!="")T&&(F.g=T+"."+F.g),Fr(F,F.u);else{var Z=o.location;F=Z.protocol,T=T?T+"."+Z.hostname:Z.hostname,Z=+Z.port;const te=new jr(null);F&&pa(te,F),T&&(te.g=T),Z&&Fr(te,Z),C&&(te.h=C),F=te}return C=m.G,T=m.wa,C&&T&&at(F,C,T),at(F,"VER",m.ka),$r(m,F),F}function Bf(m,T,C){if(T&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=m.Aa&&!m.ma?new pt(new ws({ab:C})):new pt(m.ma),T.Fa(m.L),T}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wf(){}n=Wf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Jl(){}Jl.prototype.g=function(m,T){return new vn(m,T)};function vn(m,T){_t.call(this),this.g=new Kl(T),this.l=m,this.h=T&&T.messageUrlParams||null,m=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(m?m["X-WebChannel-Content-Type"]=T.messageContentType:m={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(m?m["X-WebChannel-Client-Profile"]=T.sa:m={"X-WebChannel-Client-Profile":T.sa}),this.g.U=m,(m=T&&T.Qb)&&!O(m)&&(this.g.u=m),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!O(T)&&(this.g.G=T,m=this.h,m!==null&&T in m&&(m=this.h,T in m&&delete m[T])),this.j=new ho(this)}p(vn,_t),vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){ql(this.g)},vn.prototype.o=function(m){var T=this.g;if(typeof m=="string"){var C={};C.__data__=m,m=C}else this.v&&(C={},C.__data__=Nr(m),m=C);T.i.push(new Ay(T.Ya++,m)),T.I==3&&Ss(T)},vn.prototype.N=function(){this.g.l=null,delete this.j,ql(this.g),delete this.g,vn.Z.N.call(this)};function Gf(m){ys.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var T=m.__sm__;if(T){e:{for(const C in T){m=C;break e}m=void 0}(this.i=m)&&(m=this.i,T=T!==null&&m in T?T[m]:void 0),this.data=T}else this.data=m}p(Gf,ys);function $f(){ro.call(this),this.status=1}p($f,ro);function ho(m){this.g=m}p(ho,Wf),ho.prototype.ra=function(){ut(this.g,"a")},ho.prototype.qa=function(m){ut(this.g,new Gf(m))},ho.prototype.pa=function(m){ut(this.g,new $f)},ho.prototype.oa=function(){ut(this.g,"b")},Jl.prototype.createWebChannel=Jl.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,eN=function(){return new Jl},Jk=function(){return Lr()},Qk=Gn,ov={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},an.NO_ERROR=0,an.TIMEOUT=8,an.HTTP_ERROR=6,Em=an,ot.COMPLETE="complete",Zk=ot,Vl.EventType=Mr,Mr.OPEN="a",Mr.CLOSE="b",Mr.ERROR="c",Mr.MESSAGE="d",_t.prototype.listen=_t.prototype.J,td=Vl,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Yk=pt}).apply(typeof im<"u"?im:typeof self<"u"?self:typeof window<"u"?window:{});const TC="@firebase/firestore",SC="4.9.3";let Sn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");let zu="12.7.0";const Il=new iw("@firebase/firestore");function zc(){return Il.logLevel}function fe(n,...e){if(Il.logLevel<=Xe.DEBUG){const t=e.map(yw);Il.debug(`Firestore (${zu}): ${n}`,...t)}}function bi(n,...e){if(Il.logLevel<=Xe.ERROR){const t=e.map(yw);Il.error(`Firestore (${zu}): ${n}`,...t)}}function cy(n,...e){if(Il.logLevel<=Xe.WARN){const t=e.map(yw);Il.warn(`Firestore (${zu}): ${n}`,...t)}}function yw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Pe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,tN(n,i,t)}function tN(n,e,t){let i=`FIRESTORE (${zu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw bi(i),new Error(i)}function je(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||tN(e,r,i)}function St(n,e){return n}const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends ms{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ul{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class nN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class G8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Sn.UNAUTHENTICATED)))}shutdown(){}}class $8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class H8{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){je(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new ul;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ul,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ul)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(je(typeof i.accessToken=="string",31837,{l:i}),new nN(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string",2055,{h:e}),new Sn(e)}}class K8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class q8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new K8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Sn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class IC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class X8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Yi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){je(this.o===void 0,3512);const i=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new IC(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new IC(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Y8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class iN{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=Y8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Ke(n,e){return n<e?-1:n>e?1:0}function av(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return ex(r)===ex(s)?Ke(r,s):ex(r)?1:-1}return Ke(n.length,e.length)}const Z8=55296,Q8=57343;function ex(n){const e=n.charCodeAt(0);return e>=Z8&&e<=Q8}function vu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function rN(n){return n+"\0"}const bC="__name__";class Jr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Pe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Pe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Jr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Jr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Jr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Ke(e.length,t.length)}static compareSegments(e,t){const i=Jr.isNumericId(e),r=Jr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Jr.extractNumericId(e).compare(Jr.extractNumericId(t)):av(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pw.fromString(e.substring(4,e.length-2))}}class Ct extends Jr{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ie(le.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const J8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends Jr{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return J8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bC}static keyField(){return new Bt([bC])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Ie(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ie(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ie(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Ie(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Ct.fromString(e))}static fromName(e){return new Ee(Ct.fromString(e).popFirst(5))}static empty(){return new Ee(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Ct(e.slice()))}}function e7(n,e,t,i){if(e===!0&&i===!0)throw new Ie(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function t7(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function n7(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Pe(12329,{type:typeof n})}function sN(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=n7(n);throw new Ie(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Yt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Cf(n,e){if(!t7(n))throw new Ie(le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Ie(le.INVALID_ARGUMENT,t);return!0}const CC=-62135596800,RC=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*RC);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<CC)throw new Ie(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/RC}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cf(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-CC;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:Yt("string",kt._jsonSchemaVersion),seconds:Yt("number"),nanoseconds:Yt("number")};class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new kt(0,0))}static max(){return new et(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Gd=-1;class hp{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function lv(n){return n.fields.find((e=>e.kind===2))}function $a(n){return n.fields.filter((e=>e.kind!==2))}hp.UNKNOWN_ID=-1;class Tm{constructor(e,t){this.fieldPath=e,this.kind=t}}class $d{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new $d(0,ki.min())}}function i7(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=et.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new ki(r,Ee.empty(),e)}function oN(n){return new ki(n.readTime,n.key,Gd)}class ki{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ki(et.min(),Ee.empty(),Gd)}static max(){return new ki(et.max(),Ee.empty(),Gd)}}function _w(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:Ke(n.largestBatchId,e.largestBatchId))}const aN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function uy(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==aN)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new J(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof J?t:J.resolve(t)}catch(t){return J.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):J.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):J.reject(t)}static resolve(e){return new J(((t,i)=>{t(e)}))}static reject(e){return new J(((t,i)=>{i(e)}))}static waitFor(e){return new J(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=J.resolve(!1);for(const i of e)t=t.next((r=>r?J.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new J(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new J(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const Si="SimpleDb";class hy{static open(e,t,i,r){try{return new hy(t,e.transaction(r,i))}catch(s){throw new hd(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ul,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new hd(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=xw(i.target.error);this.S.reject(new hd(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(Si,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new s7(t)}}class ea{static delete(e){return fe(Si,"Removing database:",e),qa(sk().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!gk())return!1;if(ea.F())return!0;const e=rn(),t=ea.M(e),i=0<t&&t<10,r=cN(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,ea.M(rn())===12.2&&bi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(Si,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new hd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Ie(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Ie(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new hd(e,o))},r.onupgradeneeded=s=>{fe(Si,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{fe(Si,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=hy.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),J.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(fe(Si,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class r7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return qa(this.U.delete())}}class hd extends Ie{constructor(e,t){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fl(n){return n.name==="IndexedDbTransactionError"}class s7{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(fe(Si,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(fe(Si,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),qa(i)}add(e){return fe(Si,"ADD",this.store.name,e,e),qa(this.store.add(e))}get(e){return qa(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(Si,"GET",this.store.name,e,t),t)))}delete(e){return fe(Si,"DELETE",this.store.name,e),qa(this.store.delete(e))}count(){return fe(Si,"COUNT",this.store.name),qa(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new J(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new J(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){fe(Si,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new J(((i,r)=>{t.onerror=s=>{const o=xw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new J(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new r7(l),h=t(l.primaryKey,l.value,u);if(h instanceof J){const f=h.catch((p=>(u.done(),J.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>J.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function qa(n){return new J(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=xw(i.target.error);t(r)}}))}let AC=!1;function xw(n){const e=ea.M(rn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return AC||(AC=!0,setTimeout((()=>{throw i}),0)),i}}return n}const dd="IndexBackfiller";class o7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(dd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(dd,`Documents written: ${t}`)}catch(t){Fl(t)?fe(dd,"Ignoring IndexedDB error during index backfill: ",t):await uy(t)}await this.re(6e4)}))}}class a7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return J.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return fe(dd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(fe(dd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=oN(s);_w(o,i)>0&&(i=o)})),new ki(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Er{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Er.ce=-1;const hl=-1;function dy(n){return n==null}function dp(n){return n===0&&1/n==-1/0}const fp="";function Zn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=PC(e)),e=l7(n.get(t),e);return PC(e)}function l7(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case fp:t+="";break;default:t+=s}}return t}function PC(n){return n+fp+""}function is(n){const e=n.length;if(je(e>=2,64408,{path:n}),e===2)return je(n.charAt(0)===fp&&n.charAt(1)==="",56145,{path:n}),Ct.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(fp,s);switch((o<0||o>t)&&Pe(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Pe(61167,{path:n})}s=o+2}return new Ct(i)}const Ha="remoteDocuments",Rf="owner",Ac="owner",Hd="mutationQueues",c7="userId",pr="mutations",kC="batchId",rl="userMutationsIndex",NC=["userId","batchId"];function Sm(n,e){return[n,Zn(e)]}function uN(n,e,t){return[n,Zn(e),t]}const u7={},wu="documentMutations",gp="remoteDocumentsV14",h7=["prefixPath","collectionGroup","readTime","documentId"],Im="documentKeyIndex",d7=["prefixPath","collectionGroup","documentId"],hN="collectionGroupIndex",f7=["collectionGroup","readTime","prefixPath","documentId"],Kd="remoteDocumentGlobal",cv="remoteDocumentGlobalKey",Eu="targets",dN="queryTargetsIndex",g7=["canonicalId","targetId"],Tu="targetDocuments",m7=["targetId","path"],vw="documentTargetsIndex",p7=["path","targetId"],mp="targetGlobalKey",dl="targetGlobal",qd="collectionParents",y7=["collectionId","parent"],Su="clientMetadata",_7="clientId",fy="bundles",x7="bundleId",gy="namedQueries",v7="name",ww="indexConfiguration",w7="indexId",uv="collectionGroupIndex",E7="collectionGroup",fd="indexState",T7=["indexId","uid"],fN="sequenceNumberIndex",S7=["uid","sequenceNumber"],gd="indexEntries",I7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gN="documentKeyIndex",b7=["indexId","uid","orderedDocumentKey"],my="documentOverlays",C7=["userId","collectionPath","documentId"],hv="collectionPathOverlayIndex",R7=["userId","collectionPath","largestBatchId"],mN="collectionGroupOverlayIndex",A7=["userId","collectionGroup","largestBatchId"],Ew="globals",P7="name",pN=[Hd,pr,wu,Ha,Eu,Rf,dl,Tu,Su,Kd,qd,fy,gy],k7=[...pN,my],yN=[Hd,pr,wu,gp,Eu,Rf,dl,Tu,Su,Kd,qd,fy,gy,my],_N=yN,Tw=[..._N,ww,fd,gd],N7=Tw,xN=[...Tw,Ew],D7=xN;class dv extends lN{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function sn(n,e){const t=St(n);return ea.O(t.le,e)}function DC(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Sw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function M7(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class fi{constructor(e,t){this.comparator=e,this.root=t||In.EMPTY}insert(e,t){return new fi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,In.BLACK,null,null))}remove(e){return new fi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,In.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rm(this.root,e,this.comparator,!1)}getReverseIterator(){return new rm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rm(this.root,e,this.comparator,!0)}}class rm{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class In{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??In.RED,this.left=r??In.EMPTY,this.right=s??In.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new In(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return In.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return In.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,In.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,In.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}In.EMPTY=null,In.RED=!0,In.BLACK=!1;In.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new In(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yt{constructor(e){this.comparator=e,this.data=new fi(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new MC(this.data.getIterator())}getIteratorFrom(e){return new MC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class MC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Pc(n){return n.hasNext()?n.getNext():void 0}class Bs{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new Bs([])}unionWith(e){let t=new yt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Bs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class L7 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class gi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new L7("Invalid base64 string: "+s):s}})(e);return new gi(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new gi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gi.EMPTY_BYTE_STRING=new gi("");const O7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sa(n){if(je(!!n,39018),typeof n=="string"){let e=0;const t=O7.exec(n);if(je(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qt(n.seconds),nanos:qt(n.nanos)}}function qt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Iu(n){return typeof n=="string"?gi.fromBase64String(n):gi.fromUint8Array(n)}const vN="server_timestamp",wN="__type__",EN="__previous_value__",TN="__local_write_time__";function Iw(n){return(n?.mapValue?.fields||{})[wN]?.stringValue===vN}function SN(n){const e=n.mapValue.fields[EN];return Iw(e)?SN(e):e}function pp(n){const e=sa(n.mapValue.fields[TN].timestampValue);return new kt(e.seconds,e.nanos)}class j7{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const yp="(default)";class bu{constructor(e,t){this.projectId=e,this.database=t||yp}static empty(){return new bu("","")}get isDefaultDatabase(){return this.database===yp}isEqual(e){return e instanceof bu&&e.projectId===this.projectId&&e.database===this.database}}const IN="__type__",bN="__max__",qo={mapValue:{fields:{__type__:{stringValue:bN}}}},CN="__vector__",_p="value",bm={nullValue:"NULL_VALUE"};function Cu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Iw(n)?4:RN(n)?9007199254740991:py(n)?10:11:Pe(28295,{value:n})}function hs(n,e){if(n===e)return!0;const t=Cu(n);if(t!==Cu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return pp(n).isEqual(pp(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=sa(r.timestampValue),l=sa(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Iu(r.bytesValue).isEqual(Iu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return qt(r.geoPointValue.latitude)===qt(s.geoPointValue.latitude)&&qt(r.geoPointValue.longitude)===qt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return qt(r.integerValue)===qt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=qt(r.doubleValue),l=qt(s.doubleValue);return o===l?dp(o)===dp(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return vu(n.arrayValue.values||[],e.arrayValue.values||[],hs);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(DC(o)!==DC(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!hs(o[u],l[u])))return!1;return!0})(n,e);default:return Pe(52216,{left:n})}}function Xd(n,e){return(n.values||[]).find((t=>hs(t,e)))!==void 0}function oa(n,e){if(n===e)return 0;const t=Cu(n),i=Cu(e);if(t!==i)return Ke(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ke(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=qt(s.integerValue||s.doubleValue),u=qt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return LC(n.timestampValue,e.timestampValue);case 4:return LC(pp(n),pp(e));case 5:return av(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=Iu(s),u=Iu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=Ke(l[h],u[h]);if(f!==0)return f}return Ke(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=Ke(qt(s.latitude),qt(o.latitude));return l!==0?l:Ke(qt(s.longitude),qt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return OC(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[_p]?.arrayValue,f=u[_p]?.arrayValue,p=Ke(h?.values?.length||0,f?.values?.length||0);return p!==0?p:OC(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===qo.mapValue&&o===qo.mapValue)return 0;if(s===qo.mapValue)return 1;if(o===qo.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const _=av(u[p],f[p]);if(_!==0)return _;const v=oa(l[u[p]],h[f[p]]);if(v!==0)return v}return Ke(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Pe(23264,{he:t})}}function LC(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ke(n,e);const t=sa(n),i=sa(e),r=Ke(t.seconds,i.seconds);return r!==0?r:Ke(t.nanos,i.nanos)}function OC(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=oa(t[r],i[r]);if(s)return s}return Ke(t.length,i.length)}function Ru(n){return fv(n)}function fv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=sa(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Iu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=fv(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${fv(t.fields[o])}`;return r+"}"})(n.mapValue):Pe(61005,{value:n})}function bw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gv(n){return!!n&&"integerValue"in n}function Yd(n){return!!n&&"arrayValue"in n}function jC(n){return!!n&&"nullValue"in n}function FC(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function tx(n){return!!n&&"mapValue"in n}function py(n){return(n?.mapValue?.fields||{})[IN]?.stringValue===CN}function md(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Sw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=md(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=md(n.arrayValue.values[t]);return e}return{...n}}function RN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===bN}const AN={mapValue:{fields:{[IN]:{stringValue:CN},[_p]:{arrayValue:{}}}}};function F7(n){return"nullValue"in n?bm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?bw(bu.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?py(n)?AN:{mapValue:{}}:Pe(35942,{value:n})}function V7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?bw(bu.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?AN:"mapValue"in n?py(n)?{mapValue:{}}:qo:Pe(61959,{value:n})}function VC(n,e){const t=oa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function zC(n,e){const t=oa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class vr{constructor(e){this.value=e}static empty(){return new vr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!tx(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=md(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=md(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());tx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];tx(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Sw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new vr(md(this.value))}}class bn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new bn(e,0,et.min(),et.min(),et.min(),vr.empty(),0)}static newFoundDocument(e,t,i,r){return new bn(e,1,t,et.min(),i,r,0)}static newNoDocument(e,t){return new bn(e,2,t,et.min(),et.min(),vr.empty(),0)}static newUnknownDocument(e,t){return new bn(e,3,t,et.min(),et.min(),vr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Au{constructor(e,t){this.position=e,this.inclusive=t}}function UC(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=oa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function BC(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!hs(n.position[t],e.position[t]))return!1;return!0}class xp{constructor(e,t="asc"){this.field=e,this.dir=t}}function z7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class PN{}class Qe extends PN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new U7(e,t,i):t==="array-contains"?new G7(e,i):t==="in"?new ON(e,i):t==="not-in"?new $7(e,i):t==="array-contains-any"?new H7(e,i):new Qe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new B7(e,i):new W7(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(oa(t,this.value)):t!==null&&Cu(this.value)===Cu(t)&&this.matchesComparison(oa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mt extends PN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new mt(e,t)}matches(e){return Pu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Pu(n){return n.op==="and"}function mv(n){return n.op==="or"}function Cw(n){return kN(n)&&Pu(n)}function kN(n){for(const e of n.filters)if(e instanceof mt)return!1;return!0}function pv(n){if(n instanceof Qe)return n.field.canonicalString()+n.op.toString()+Ru(n.value);if(Cw(n))return n.filters.map((e=>pv(e))).join(",");{const e=n.filters.map((t=>pv(t))).join(",");return`${n.op}(${e})`}}function NN(n,e){return n instanceof Qe?(function(i,r){return r instanceof Qe&&i.op===r.op&&i.field.isEqual(r.field)&&hs(i.value,r.value)})(n,e):n instanceof mt?(function(i,r){return r instanceof mt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&NN(o,r.filters[l])),!0):!1})(n,e):void Pe(19439)}function DN(n,e){const t=n.filters.concat(e);return mt.create(t,n.op)}function MN(n){return n instanceof Qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ru(t.value)}`})(n):n instanceof mt?(function(t){return t.op.toString()+" {"+t.getFilters().map(MN).join(" ,")+"}"})(n):"Filter"}class U7 extends Qe{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class B7 extends Qe{constructor(e,t){super(e,"in",t),this.keys=LN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class W7 extends Qe{constructor(e,t){super(e,"not-in",t),this.keys=LN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function LN(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class G7 extends Qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yd(t)&&Xd(t.arrayValue,this.value)}}class ON extends Qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xd(this.value.arrayValue,t)}}class $7 extends Qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xd(this.value.arrayValue,t)}}class H7 extends Qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Xd(this.value.arrayValue,i)))}}class K7{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function yv(n,e=null,t=[],i=[],r=null,s=null,o=null){return new K7(n,e,t,i,r,s,o)}function bl(n){const e=St(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>pv(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),dy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ru(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ru(i))).join(",")),e.Te=t}return e.Te}function Af(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!z7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!NN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!BC(n.startAt,e.startAt)&&BC(n.endAt,e.endAt)}function q7(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function vp(n,e){return n.filters.filter((t=>t instanceof Qe&&t.field.isEqual(e)))}function WC(n,e,t){let i=bm,r=!0;for(const s of vp(n,e)){let o=bm,l=!0;switch(s.op){case"<":case"<=":o=F7(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=bm}VC({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];VC({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function GC(n,e,t){let i=qo,r=!0;for(const s of vp(n,e)){let o=qo,l=!0;switch(s.op){case">=":case">":o=V7(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=qo}zC({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];zC({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class yy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function X7(n,e,t,i,r,s,o,l){return new yy(n,e,t,i,r,s,o,l)}function jN(n){return new yy(n)}function $C(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Y7(n){return n.collectionGroup!==null}function pd(n){const e=St(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new yt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new xp(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new xp(Bt.keyField(),i))}return e.Ie}function qs(n){const e=St(n);return e.Ee||(e.Ee=Z7(e,pd(n))),e.Ee}function Z7(n,e){if(n.limitType==="F")return yv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new xp(r.field,s)}));const t=n.endAt?new Au(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Au(n.startAt.position,n.startAt.inclusive):null;return yv(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function _v(n,e,t){return new yy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function FN(n,e){return Af(qs(n),qs(e))&&n.limitType===e.limitType}function VN(n){return`${bl(qs(n))}|lt:${n.limitType}`}function Fh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>MN(r))).join(", ")}]`),dy(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Ru(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Ru(r))).join(",")),`Target(${i})`})(qs(n))}; limitType=${n.limitType})`}function _y(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of pd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=UC(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,pd(i),r)||i.endAt&&!(function(o,l,u){const h=UC(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,pd(i),r))})(n,e)}function Q7(n){return(e,t)=>{let i=!1;for(const r of pd(n)){const s=J7(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function J7(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?oa(u,h):Pe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Pe(19790,{direction:n.dir})}}class ua{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Sw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return M7(this.inner)}size(){return this.innerSize}}const eW=new fi(Ee.comparator);function sl(){return eW}const zN=new fi(Ee.comparator);function sm(...n){let e=zN;for(const t of n)e=e.insert(t.key,t);return e}function tW(n){let e=zN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function rs(){return yd()}function UN(){return yd()}function yd(){return new ua((n=>n.toString()),((n,e)=>n.isEqual(e)))}const nW=new fi(Ee.comparator),iW=new yt(Ee.comparator);function Cn(...n){let e=iW;for(const t of n)e=e.add(t);return e}const rW=new yt(Ke);function sW(){return rW}function oW(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dp(e)?"-0":e}}function aW(n){return{integerValue:""+n}}class xy{constructor(){this._=void 0}}function lW(n,e,t){return n instanceof Zd?(function(r,s){const o={fields:{[wN]:{stringValue:vN},[TN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Iw(s)&&(s=SN(s)),s&&(o.fields[EN]=s),{mapValue:o}})(t,e):n instanceof ku?BN(n,e):n instanceof Nu?WN(n,e):(function(r,s){const o=uW(r,s),l=HC(o)+HC(r.Ae);return gv(o)&&gv(r.Ae)?aW(l):oW(r.serializer,l)})(n,e)}function cW(n,e,t){return n instanceof ku?BN(n,e):n instanceof Nu?WN(n,e):t}function uW(n,e){return n instanceof Qd?(function(i){return gv(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Zd extends xy{}class ku extends xy{constructor(e){super(),this.elements=e}}function BN(n,e){const t=GN(e);for(const i of n.elements)t.some((r=>hs(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Nu extends xy{constructor(e){super(),this.elements=e}}function WN(n,e){let t=GN(e);for(const i of n.elements)t=t.filter((r=>!hs(r,i)));return{arrayValue:{values:t}}}class Qd extends xy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function HC(n){return qt(n.integerValue||n.doubleValue)}function GN(n){return Yd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class hW{constructor(e,t){this.field=e,this.transform=t}}function dW(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof ku&&r instanceof ku||i instanceof Nu&&r instanceof Nu?vu(i.elements,r.elements,hs):i instanceof Qd&&r instanceof Qd?hs(i.Ae,r.Ae):i instanceof Zd&&r instanceof Zd})(n.transform,e.transform)}class fW{constructor(e,t){this.version=e,this.transformResults=t}}class Tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Tr}static exists(e){return new Tr(void 0,e)}static updateTime(e){return new Tr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class vy{}function $N(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rw(n.key,Tr.none()):new Pf(n.key,n.data,Tr.none());{const t=n.data,i=vr.empty();let r=new yt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Uu(n.key,i,new Bs(r.toArray()),Tr.none())}}function gW(n,e,t){n instanceof Pf?(function(r,s,o){const l=r.value.clone(),u=qC(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Uu?(function(r,s,o){if(!Cm(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=qC(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(HN(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function _d(n,e,t,i){return n instanceof Pf?(function(s,o,l,u){if(!Cm(s.precondition,o))return l;const h=s.value.clone(),f=XC(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Uu?(function(s,o,l,u){if(!Cm(s.precondition,o))return l;const h=XC(s.fieldTransforms,u,o),f=o.data;return f.setAll(HN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return Cm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function KC(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&vu(i,r,((s,o)=>dW(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Pf extends vy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Uu extends vy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function HN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function qC(n,e,t){const i=new Map;je(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,cW(o,l,t[r]))}return i}function XC(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,lW(s,o,e))}return i}class Rw extends vy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KN extends vy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Aw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&gW(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=_d(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=_d(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=UN();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=$N(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(et.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Cn())}isEqual(e){return this.batchId===e.batchId&&vu(this.mutations,e.mutations,((t,i)=>KC(t,i)))&&vu(this.baseMutations,e.baseMutations,((t,i)=>KC(t,i)))}}class Pw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){je(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return nW})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Pw(e,t,i,r)}}class kw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Je;function mW(n){switch(n){case le.OK:return Pe(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Pe(15467,{code:n})}}function pW(n){if(n===void 0)return bi("GRPC error has no .code"),le.UNKNOWN;switch(n){case Kt.OK:return le.OK;case Kt.CANCELLED:return le.CANCELLED;case Kt.UNKNOWN:return le.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return le.INTERNAL;case Kt.UNAVAILABLE:return le.UNAVAILABLE;case Kt.UNAUTHENTICATED:return le.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case Kt.NOT_FOUND:return le.NOT_FOUND;case Kt.ALREADY_EXISTS:return le.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return le.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case Kt.ABORTED:return le.ABORTED;case Kt.OUT_OF_RANGE:return le.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return le.UNIMPLEMENTED;case Kt.DATA_LOSS:return le.DATA_LOSS;default:return Pe(39323,{code:n})}}(Je=Kt||(Kt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";new pw([4294967295,4294967295],0);const yW={asc:"ASCENDING",desc:"DESCENDING"},_W={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xW={and:"AND",or:"OR"};class vW{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wW(n,e){return n.useProto3Json||dy(e)?e:{value:e}}function xv(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function EW(n,e){return xv(n,e.toTimestamp())}function Cr(n){return je(!!n,49232),et.fromTimestamp((function(t){const i=sa(t);return new kt(i.seconds,i.nanos)})(n))}function qN(n,e){return vv(n,e).canonicalString()}function vv(n,e){const t=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function XN(n){const e=Ct.fromString(n);return je(NW(e),10190,{key:e.toString()}),e}function wp(n,e){return qN(n.databaseId,e.path)}function Rm(n,e){const t=XN(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(QN(t))}function YN(n,e){return qN(n.databaseId,e)}function ZN(n){const e=XN(n);return e.length===4?Ct.emptyPath():QN(e)}function TW(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function QN(n){return je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function YC(n,e,t){return{name:wp(n,e),fields:t.value.mapValue.fields}}function SW(n,e,t){const i=Rm(n,e.name),r=Cr(e.updateTime),s=e.createTime?Cr(e.createTime):et.min(),o=new vr({mapValue:{fields:e.fields}}),l=bn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function Ep(n,e){let t;if(e instanceof Pf)t={update:YC(n,e.key,e.value)};else if(e instanceof Rw)t={delete:wp(n,e.key)};else if(e instanceof Uu)t={update:YC(n,e.key,e.data),updateMask:kW(e.fieldMask)};else{if(!(e instanceof KN))return Pe(16599,{Vt:e.type});t={verify:wp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Zd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ku)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Nu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Qd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Pe(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:EW(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Pe(27497)})(n,e.precondition)),t}function wv(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Tr.updateTime(Cr(s.updateTime)):s.exists!==void 0?Tr.exists(s.exists):Tr.none()})(e.currentDocument):Tr.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)je(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Zd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new ku(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Nu(f)}else"increment"in l?u=new Qd(o,l.increment):Pe(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new hW(h,u)})(n,r))):[];if(e.update){e.update.name;const r=Rm(n,e.update.name),s=new vr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new Bs(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new Uu(r,s,o,t,i)}return new Pf(r,s,t,i)}if(e.delete){const r=Rm(n,e.delete);return new Rw(r,t)}if(e.verify){const r=Rm(n,e.verify);return new KN(r,t)}return Pe(1463,{proto:e})}function IW(n,e){return n&&n.length>0?(je(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Cr(r.updateTime):Cr(s);return o.isEqual(et.min())&&(o=Cr(s)),new fW(o,r.transformResults||[])})(t,e)))):[]}function bW(n,e){return{documents:[YN(n,e.path)]}}function CW(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=YN(n,r);const s=(function(h){if(h.length!==0)return tD(mt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(_){return{field:Uc(_.field),direction:RW(_.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=wW(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function JN(n){let e=ZN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){je(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const _=eD(p);return _ instanceof mt&&Cw(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((_=>(function(S){return new xp(Bc(S.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(_)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let _;return _=typeof p=="object"?p.value:p,dy(_)?null:_})(t.limit));let u=null;t.startAt&&(u=(function(p){const _=!!p.before,v=p.values||[];return new Au(v,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const _=!p.before,v=p.values||[];return new Au(v,_)})(t.endAt)),X7(e,r,o,s,l,"F",u,h)}function eD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Bc(t.unaryFilter.field);return Qe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Bc(t.unaryFilter.field);return Qe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Bc(t.unaryFilter.field);return Qe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bc(t.unaryFilter.field);return Qe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Qe.create(Bc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return mt.create(t.compositeFilter.filters.map((i=>eD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}})(t.compositeFilter.op))})(n):Pe(30097,{filter:n})}function RW(n){return yW[n]}function AW(n){return _W[n]}function PW(n){return xW[n]}function Uc(n){return{fieldPath:n.canonicalString()}}function Bc(n){return Bt.fromServerFormat(n.fieldPath)}function tD(n){return n instanceof Qe?(function(t){if(t.op==="=="){if(FC(t.value))return{unaryFilter:{field:Uc(t.field),op:"IS_NAN"}};if(jC(t.value))return{unaryFilter:{field:Uc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(FC(t.value))return{unaryFilter:{field:Uc(t.field),op:"IS_NOT_NAN"}};if(jC(t.value))return{unaryFilter:{field:Uc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uc(t.field),op:AW(t.op),value:t.value}}})(n):n instanceof mt?(function(t){const i=t.getFilters().map((r=>tD(r)));return i.length===1?i[0]:{compositeFilter:{op:PW(t.op),filters:i}}})(n):Pe(54877,{filter:n})}function kW(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function NW(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Zc{constructor(e,t,i,r,s=et.min(),o=et.min(),l=gi.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Zc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class nD{constructor(e){this.yt=e}}function DW(n,e){let t;if(e.document)t=SW(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Rl(e.noDocument.readTime);t=bn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Pe(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Rl(e.unknownDocument.version);t=bn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new kt(r[0],r[1]);return et.fromTimestamp(s)})(e.readTime)),t}function ZC(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Tp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:wp(s,o.key),fields:o.data.value.mapValue.fields,updateTime:xv(s,o.version.toTimestamp()),createTime:xv(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cl(e.version)};else{if(!e.isUnknownDocument())return Pe(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cl(e.version)}}return i}function Tp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rl(n){const e=new kt(n.seconds,n.nanoseconds);return et.fromTimestamp(e)}function Xa(n,e){const t=(e.baseMutations||[]).map((s=>wv(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>wv(n.yt,s))),r=kt.fromMillis(e.localWriteTimeMs);return new Aw(e.batchId,r,t,i)}function nd(n){const e=Rl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Rl(n.lastLimboFreeSnapshotVersion):et.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return je(o===1,1966,{count:o}),qs(jN(ZN(s.documents[0])))})(n.query):(function(s){return qs(JN(s))})(n.query),new Zc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,gi.fromBase64String(n.resumeToken))}function iD(n,e){const t=Cl(e.snapshotVersion),i=Cl(e.lastLimboFreeSnapshotVersion);let r;r=q7(e.target)?bW(n.yt,e.target):CW(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:bl(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function rD(n){const e=JN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?_v(e,e.limit,"L"):e}function nx(n,e){return new kw(e.largestBatchId,wv(n.yt,e.overlayMutation))}function QC(n,e){const t=e.path.lastSegment();return[n,Zn(e.path.popLast()),t]}function JC(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cl(i.readTime),documentKey:Zn(i.documentKey.path),largestBatchId:i.largestBatchId}}class MW{getBundleMetadata(e,t){return e2(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Rl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return e2(e).put((function(r){return{bundleId:r.id,createTime:Cl(Cr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return t2(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:rD(s.bundledQuery),readTime:Rl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return t2(e).put((function(r){return{name:r.name,readTime:Cl(Cr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function e2(n){return sn(n,fy)}function t2(n){return sn(n,gy)}class wy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new wy(e,i)}getOverlay(e,t){return Vh(e).get(QC(this.userId,t)).next((i=>i?nx(this.serializer,i):null))}getOverlays(e,t){const i=rs();return J.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new kw(t,o);r.push(this.St(e,l))})),J.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Zn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Vh(e).Z(hv,l))})),J.waitFor(s)}getOverlaysForCollection(e,t,i){const r=rs(),s=Zn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Vh(e).J(hv,o).next((l=>{for(const u of l){const h=nx(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=rs();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Vh(e).ee({index:mN,range:l},((u,h,f)=>{const p=nx(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Vh(e).put((function(r,s,o){const[l,u,h]=QC(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ep(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Vh(n){return sn(n,my)}class LW{bt(e){return sn(e,Ew)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?gi.fromUint8Array(i):gi.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Ya{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(qt(e.integerValue));else if("doubleValue"in e){const i=qt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),dp(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=sa(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Iu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?RN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):py(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Pe(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=_p,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(qt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ya.Kt=new Ya;const kc=255;function OW(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function n2(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=OW(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class jW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=n2(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=n2(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(kc),this.sn(255)}_n(){this.an(kc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===kc?(this.sn(kc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===kc?(this.an(kc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class FW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class VW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class zh{constructor(){this.cn=new jW,this.ln=new FW(this.cn),this.hn=new VW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Za{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Za(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Am(this.En),directionalValue:Am(this.dn),orderedDocumentKey:Am(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Mo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=i2(n.En,e.En),t!==0?t:(t=i2(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function i2(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Am(n){return fk()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function r2(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class s2{constructor(e){this.mn=new yt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(je(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=lv(e);if(t!==void 0&&!this.wn(t))return!1;const i=$a(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new yt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Tm(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Tm(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Tm(i.field,i.dir==="asc"?0:1)));return new hp(hp.UNKNOWN_ID,this.collectionId,t,$d.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function sD(n){if(je(n instanceof Qe||n instanceof mt,20012),n instanceof Qe){if(n instanceof ON){const t=n.value.arrayValue?.values?.map((i=>Qe.create(n.field,"==",i)))||[];return mt.create(t,"or")}return n}const e=n.filters.map((t=>sD(t)));return mt.create(e,n.op)}function zW(n){if(n.getFilters().length===0)return[];const e=Sv(sD(n));return je(oD(e),7391),Ev(e)||Tv(e)?[e]:e.getFilters()}function Ev(n){return n instanceof Qe}function Tv(n){return n instanceof mt&&Cw(n)}function oD(n){return Ev(n)||Tv(n)||(function(t){if(t instanceof mt&&mv(t)){for(const i of t.getFilters())if(!Ev(i)&&!Tv(i))return!1;return!0}return!1})(n)}function Sv(n){if(je(n instanceof Qe||n instanceof mt,34018),n instanceof Qe)return n;if(n.filters.length===1)return Sv(n.filters[0]);const e=n.filters.map((i=>Sv(i)));let t=mt.create(e,n.op);return t=Sp(t),oD(t)?t:(je(t instanceof mt,64498),je(Pu(t),40251),je(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Nw(i,r))))}function Nw(n,e){let t;return je(n instanceof Qe||n instanceof mt,38388),je(e instanceof Qe||e instanceof mt,25473),t=n instanceof Qe?e instanceof Qe?(function(r,s){return mt.create([r,s],"and")})(n,e):o2(n,e):e instanceof Qe?o2(e,n):(function(r,s){if(je(r.filters.length>0&&s.filters.length>0,48005),Pu(r)&&Pu(s))return DN(r,s.getFilters());const o=mv(r)?r:s,l=mv(r)?s:r,u=o.filters.map((h=>Nw(h,l)));return mt.create(u,"or")})(n,e),Sp(t)}function o2(n,e){if(Pu(e))return DN(e,n.getFilters());{const t=e.filters.map((i=>Nw(n,i)));return mt.create(t,"or")}}function Sp(n){if(je(n instanceof Qe||n instanceof mt,11850),n instanceof Qe)return n;const e=n.getFilters();if(e.length===1)return Sp(e[0]);if(kN(n))return n;const t=e.map((r=>Sp(r))),i=[];return t.forEach((r=>{r instanceof Qe?i.push(r):r instanceof mt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:mt.create(i,n.op)}class UW{constructor(){this.Cn=new Dw}addToCollectionParentIndex(e,t){return this.Cn.add(t),J.resolve()}getCollectionParents(e,t){return J.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return J.resolve()}deleteFieldIndex(e,t){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,t){return J.resolve()}getDocumentsMatchingTarget(e,t){return J.resolve(null)}getIndexType(e,t){return J.resolve(0)}getFieldIndexes(e,t){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,t){return J.resolve(ki.min())}getMinOffsetFromCollectionGroup(e,t){return J.resolve(ki.min())}updateCollectionGroup(e,t,i){return J.resolve()}updateIndexEntries(e,t){return J.resolve()}}class Dw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new yt(Ct.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new yt(Ct.comparator)).toArray()}}const a2="IndexedDbIndexManager",om=new Uint8Array(0);class BW{constructor(e,t){this.databaseId=t,this.vn=new Dw,this.Fn=new ua((i=>bl(i)),((i,r)=>Af(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Zn(r)};return l2(e).put(s)}return J.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[rN(t),""],!1,!0);return l2(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(is(o.parent))}return i}))}addFieldIndex(e,t){const i=Uh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Dc(e);return s.next((l=>{o.put(JC(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Uh(e),r=Dc(e),s=Nc(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Uh(e),i=Nc(e),r=Dc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return J.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new s2(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Nc(e);let r=!0;const s=new Map;return J.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Cn();const l=[];return J.forEach(s,((u,h)=>{fe(a2,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${bl(t)}`);const f=(function(D,L){const N=lv(L);if(N===void 0)return null;for(const V of vp(D,N.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null})(h,u),p=(function(D,L){const N=new Map;for(const V of $a(L))for(const A of vp(D,V.fieldPath))switch(A.op){case"==":case"in":N.set(V.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return N.set(V.fieldPath.canonicalString(),A.value),Array.from(N.values())}return null})(h,u),_=(function(D,L){const N=[];let V=!0;for(const A of $a(L)){const b=A.kind===0?WC(D,A.fieldPath,D.startAt):GC(D,A.fieldPath,D.startAt);N.push(b.value),V&&(V=b.inclusive)}return new Au(N,V)})(h,u),v=(function(D,L){const N=[];let V=!0;for(const A of $a(L)){const b=A.kind===0?GC(D,A.fieldPath,D.endAt):WC(D,A.fieldPath,D.endAt);N.push(b.value),V&&(V=b.inclusive)}return new Au(N,V)})(h,u),S=this.On(u,h,_),I=this.On(u,h,v),w=this.Nn(u,h,p),R=this.Bn(u.indexId,f,S,_.inclusive,I,v.inclusive,w);return J.forEach(R,(M=>i.Y(M,t.limit).next((D=>{D.forEach((L=>{const N=Ee.fromSegments(L.documentKey);o.has(N)||(o=o.add(N),l.push(N))}))}))))})).next((()=>l))}return J.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=zW(mt.create(e.filters,"and")).map((i=>yv(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const _=t?this.Ln(t[p/h]):om,v=this.kn(e,_,i[p%h],r),S=this.qn(e,_,s[p%h],o),I=l.map((w=>this.kn(e,_,w,!0)));f.push(...this.createRange(v,S,I))}return f}kn(e,t,i,r){const s=new Za(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Za(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new s2(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return J.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new yt(Bt.comparator),f=!1;for(const p of u.filters)for(const _ of p.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?f=!0:h=h.add(_.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new zh;for(const r of $a(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Ya.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new zh;return Ya.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new zh;return Ya.Kt.Dt(bw(this.databaseId,t),i.Pn((function(s){const o=$a(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new zh);let s=0;for(const o of $a(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Yd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);Ya.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new zh;u.seed(l.un()),Ya.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Qe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Uh(e),r=Dc(e);return(t?i.J(uv,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return J.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const _=p?new $d(p.sequenceNumber,new ki(Rl(p.readTime),new Ee(is(p.documentKey)),p.largestBatchId)):$d.empty(),v=f.fields.map((([S,I])=>new Tm(Bt.fromServerFormat(S),I)));return new hp(f.indexId,f.collectionGroup,v,_)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Ke(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Uh(e),s=Dc(e);return this.Gn(e).next((o=>r.J(uv,IDBKeyRange.bound(t,t)).next((l=>J.forEach(l,(u=>s.put(JC(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return J.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?J.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),J.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?J.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Nc(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Nc(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Nc(e);let s=new yt(Mo);return r.ee({index:gN,range:IDBKeyRange.only([i.indexId,this.uid,Am(this.$n(i,t))])},((o,l)=>{s=s.add(new Za(i.indexId,t,r2(l.arrayValue),r2(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new yt(Mo);const r=this.Qn(t,e);if(r==null)return i;const s=lv(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Yd(o))for(const l of o.arrayValue.values||[])i=i.add(new Za(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Za(t.indexId,e.key,om,r));return i}Jn(e,t,i,r,s){fe(a2,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,_){const v=u.getIterator(),S=h.getIterator();let I=Pc(v),w=Pc(S);for(;I||w;){let R=!1,M=!1;if(I&&w){const D=f(I,w);D<0?M=!0:D>0&&(R=!0)}else I!=null?M=!0:R=!0;R?(p(w),w=Pc(S)):M?(_(I),I=Pc(v)):(I=Pc(v),w=Pc(S))}})(r,s,Mo,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),J.waitFor(o)}Gn(e){let t=1;return Dc(e).ee({index:fN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>Mo(o,l))).filter(((o,l,u)=>!l||Mo(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=Mo(o,e),u=Mo(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,om,Ee.empty()),u=r[o+1].Vn(this.uid,om,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(c2)}getMinOffset(e,t){return J.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Pe(44426))))).next(c2)}}function l2(n){return sn(n,qd)}function Nc(n){return sn(n,gd)}function Uh(n){return sn(n,ww)}function Dc(n){return sn(n,fd)}function c2(n){je(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;_w(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ki(e.readTime,e.documentKey,t)}const u2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aD=41943040;class si{static withCacheSize(e){return new si(e,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function lD(n,e,t){const i=n.store(pr),r=n.store(wu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,_)=>(l++,_.delete())));s.push(u.next((()=>{je(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=uN(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return J.waitFor(s).next((()=>h))}function Ip(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Pe(14731);e=n.noDocument}return JSON.stringify(e).length}si.DEFAULT_COLLECTION_PERCENTILE=10,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,si.DEFAULT=new si(aD,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),si.DISABLED=new si(-1,0,0);class Ey{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){je(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Ey(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Lo(e).ee({index:rl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Wc(e),o=Lo(e);return o.add({}).next((l=>{je(typeof l=="number",49019);const u=new Aw(l,t,i,r),h=(function(v,S,I){const w=I.baseMutations.map((M=>Ep(v.yt,M))),R=I.mutations.map((M=>Ep(v.yt,M)));return{userId:S,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:w,mutations:R}})(this.serializer,this.userId,u),f=[];let p=new yt(((_,v)=>Ke(_.canonicalString(),v.canonicalString())));for(const _ of r){const v=uN(this.userId,_.key.path,l);p=p.add(_.key.path.popLast()),f.push(o.put(h)),f.push(s.put(v,u7))}return p.forEach((_=>{f.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),J.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Lo(e).get(t).next((i=>i?(je(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Xa(this.serializer,i)):null))}er(e,t){return this.Xn[t]?J.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Lo(e).ee({index:rl,range:r},((o,l,u)=>{l.userId===this.userId&&(je(l.batchId>=i,47524,{tr:i}),s=Xa(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=hl;return Lo(e).ee({index:rl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,hl],[this.userId,Number.POSITIVE_INFINITY]);return Lo(e).J(rl,t).next((i=>i.map((r=>Xa(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Sm(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Wc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,_=is(f);if(h===this.userId&&t.path.isEqual(_))return Lo(e).get(p).next((v=>{if(!v)throw Pe(61480,{nr:o,batchId:p});je(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:p}),s.push(Xa(this.serializer,v))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);const r=[];return t.forEach((s=>{const o=Sm(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Wc(e).ee({range:l},((h,f,p)=>{const[_,v,S]=h,I=is(v);_===this.userId&&s.path.isEqual(I)?i=i.add(S):p.done()}));r.push(u)})),J.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=Sm(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new yt(Ke);return Wc(e).ee({range:o},((u,h,f)=>{const[p,_,v]=u,S=is(_);p===this.userId&&i.isPrefixOf(S)?S.length===r&&(l=l.add(v)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Lo(e).get(s).next((o=>{if(o===null)throw Pe(35274,{batchId:s});je(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Xa(this.serializer,o))})))})),J.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return lD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),J.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return J.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Wc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=is(s[1]);r.push(u)}else l.done()})).next((()=>{je(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return cD(e,this.userId,t)}_r(e){return uD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:hl,lastStreamToken:""}))}}function cD(n,e,t){const i=Sm(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Wc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,_]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function Lo(n){return sn(n,pr)}function Wc(n){return sn(n,wu)}function uD(n){return sn(n,Hd)}class Al{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Al(0)}static cr(){return new Al(-1)}}class WW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Al(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>et.fromTimestamp(new kt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Mc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(je(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Mc(e).ee(((o,l)=>{const u=nd(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>J.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Mc(e).ee(((i,r)=>{const s=nd(r);t(s)}))}lr(e){return h2(e).get(mp).next((t=>(je(t!==null,2888),t)))}hr(e,t){return h2(e).put(mp,t)}Pr(e,t){return Mc(e).put(iD(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=bl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Mc(e).ee({range:r,index:dN},((o,l,u)=>{const h=nd(l);Af(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Go(e);return t.forEach((o=>{const l=Zn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),J.waitFor(r)}removeMatchingKeys(e,t,i){const r=Go(e);return J.forEach(t,(s=>{const o=Zn(s.path);return J.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Go(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Go(e);let s=Cn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=is(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Zn(t.path),r=IDBKeyRange.bound([i],[rN(i)],!1,!0);let s=0;return Go(e).ee({index:vw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Mc(e).get(t).next((i=>i?nd(i):null))}}function Mc(n){return sn(n,Eu)}function h2(n){return sn(n,dl)}function Go(n){return sn(n,Tu)}const d2="LruGarbageCollector",GW=1048576;function f2([n,e],[t,i]){const r=Ke(n,t);return r===0?Ke(e,i):r}class $W{constructor(e){this.Ir=e,this.buffer=new yt(f2),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();f2(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class HW{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(d2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fl(t)?fe(d2,"Ignoring IndexedDB error during garbage collection: ",t):await uy(t)}await this.Vr(3e5)}))}}class KW{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return J.resolve(Er.ce);const i=new $W(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),J.resolve(u2)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),u2):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),zc()<=Xe.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),J.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function qW(n,e){return new KW(n,e)}class XW{constructor(e,t){this.db=e,this.garbageCollector=qW(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return am(e,i)}removeReference(e,t,i){return am(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return am(e,t)}br(e,t){return(function(r,s){let o=!1;return uD(r).te((l=>cD(r,l,s).next((u=>(u&&(o=!0),J.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,et.min()),Go(e).delete((function(p){return[0,Zn(p.path)]})(o)))))}));r.push(u)}})).next((()=>J.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return am(e,t)}Sr(e,t){const i=Go(e);let r,s=Er.ce;return i.ee({index:vw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==Er.ce&&t(new Ee(is(r)),s),s=h,r=u):s=Er.ce})).next((()=>{s!==Er.ce&&t(new Ee(is(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function am(n,e){return Go(n).put((function(i,r){return{targetId:0,path:Zn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class hD{constructor(){this.changes=new ua((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?J.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class YW{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Va(e).put(i)}removeEntry(e,t,i){return Va(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Tp(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=bn.newInvalidDocument(t);return Va(e).ee({index:Im,range:IDBKeyRange.only(Bh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:bn.newInvalidDocument(t)};return Va(e).ee({index:Im,range:IDBKeyRange.only(Bh(t))},((r,s)=>{i={document:this.Cr(t,s),size:Ip(s)}})).next((()=>i))}getEntries(e,t){let i=sl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=sl(),r=new fi(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,Ip(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return J.resolve();let r=new yt(p2);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Bh(r.first()),Bh(r.last())),o=r.getIterator();let l=o.getNext();return Va(e).ee({index:Im,range:s},((u,h,f)=>{const p=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&p2(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Bh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Tp(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Va(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=sl();for(const p of h){const _=this.Cr(Ee.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);_.isFoundDocument()&&(_y(t,_)||r.has(_.key))&&(f=f.insert(_.key,_))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=sl();const o=m2(t,i),l=m2(t,ki.max());return Va(e).ee({index:hN,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new ZW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return g2(e).get(cv).next((t=>(je(!!t,20021),t)))}Dr(e,t){return g2(e).put(cv,t)}Cr(e,t){if(t){const i=DW(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(et.min())))return i}return bn.newInvalidDocument(e)}}function dD(n){return new YW(n)}class ZW extends hD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ua((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new yt(((s,o)=>Ke(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=ZC(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=Ip(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=ZC(this.Nr.serializer,o.convertToNoDocument(et.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),J.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function g2(n){return sn(n,Kd)}function Va(n){return sn(n,gp)}function Bh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function m2(n,e){const t=e.documentKey.path.toArray();return[n,Tp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function p2(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Ke(t[s],i[s]),r)return r;return r=Ke(t.length,i.length),r||(r=Ke(t[t.length-2],i[i.length-2]),r||Ke(t[t.length-1],i[i.length-1]))}class QW{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class fD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&_d(i.mutation,r,Bs.empty(),kt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Cn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Cn()){const r=rs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=sm();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=rs();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Cn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=sl();const o=yd(),l=(function(){return yd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Uu)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),_d(f.mutation,h,f.mutation.getFieldMask(),kt.now())):o.set(h.key,Bs.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new QW(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=yd();let r=new fi(((o,l)=>o-l)),s=Cn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||Bs.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||Cn()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=UN();f.forEach((_=>{if(!s.has(_)){const v=$N(t.get(_),i.get(_));v!==null&&p.set(_,v),s=s.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return J.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Y7(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):J.resolve(rs());let l=Gd,u=s;return o.next((h=>J.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?J.resolve():this.remoteDocumentCache.getEntry(e,f).next((_=>{u=u.insert(f,_)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Cn()))).next((f=>({batchId:l,changes:tW(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=sm();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=sm();return this.indexManager.getCollectionParents(e,s).next((l=>J.forEach(l,(u=>{const h=(function(p,_){return new yy(_,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,_)=>{o=o.insert(p,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,bn.newInvalidDocument(f)))}));let l=sm();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&_d(f.mutation,h,Bs.empty(),kt.now()),_y(t,h)&&(l=l.insert(u,h))})),l}))}}class JW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return J.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Cr(r.createTime)}})(t)),J.resolve()}getNamedQuery(e,t){return J.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:rD(r.bundledQuery),readTime:Cr(r.readTime)}})(t)),J.resolve()}}class eG{constructor(){this.overlays=new fi(Ee.comparator),this.qr=new Map}getOverlay(e,t){return J.resolve(this.overlays.get(t))}getOverlays(e,t){const i=rs();return J.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),J.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),J.resolve()}getOverlaysForCollection(e,t,i){const r=rs(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return J.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new fi(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=rs(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=rs(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return J.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new kw(t,i));let s=this.qr.get(t);s===void 0&&(s=Cn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class tG{constructor(){this.sessionToken=gi.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,J.resolve()}}class Mw{constructor(){this.Qr=new yt(dn.$r),this.Ur=new yt(dn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new dn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new dn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Ct([])),i=new dn(t,e),r=new dn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Ct([])),i=new dn(t,e),r=new dn(t,e+1);let s=Cn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new dn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class dn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||Ke(e.Yr,t.Yr)}static Kr(e,t){return Ke(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class nG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yt(dn.$r)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Aw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new dn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return J.resolve(o)}lookupMutationBatch(e,t){return J.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return J.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?hl:this.tr-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new dn(t,0),r=new dn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),J.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);return t.forEach((r=>{const s=new dn(r,0),o=new dn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),J.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new dn(new Ee(s),0);let l=new yt(Ke);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),J.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){je(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return J.forEach(t.mutations,(r=>{const s=new dn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new dn(t,0),r=this.Zr.firstAfterOrEqual(i);return J.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class iG{constructor(e){this.ri=e,this.docs=(function(){return new fi(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return J.resolve(i?i.document.mutableCopy():bn.newInvalidDocument(t))}getEntries(e,t){let i=sl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():bn.newInvalidDocument(r))})),J.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=sl();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||_w(oN(f),i)<=0||(r.has(f.key)||_y(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return J.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Pe(9500)}ii(e,t){return J.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new rG(this)}getSize(e){return J.resolve(this.size)}}class rG extends hD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),J.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class sG{constructor(e){this.persistence=e,this.si=new ua((t=>bl(t)),Af),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.oi=0,this._i=new Mw,this.targetCount=0,this.ai=Al.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),J.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Al(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,J.resolve()}updateTargetData(e,t){return this.Pr(t),J.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),J.waitFor(s).next((()=>r))}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return J.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),J.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),J.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),J.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return J.resolve(i)}containsKey(e,t){return J.resolve(this._i.containsKey(t))}}class gD{constructor(e,t){this.ui={},this.overlays={},this.ci=new Er(0),this.li=!1,this.li=!0,this.hi=new tG,this.referenceDelegate=e(this),this.Pi=new sG(this),this.indexManager=new UW,this.remoteDocumentCache=(function(r){return new iG(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new nD(t),this.Ii=new JW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new eG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new nG(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe("MemoryPersistence","Starting transaction:",e);const r=new oG(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return J.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class oG extends lN{constructor(e){super(),this.currentSequenceNumber=e}}class Ty{constructor(e){this.persistence=e,this.Ri=new Mw,this.Vi=null}static mi(e){return new Ty(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),J.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),J.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),J.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,et.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return J.or([()=>J.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class aG{constructor(e){this.serializer=e}k(e,t,i,r){const s=new hy("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(Rf)})(e),(function(u){u.createObjectStore(Hd,{keyPath:c7}),u.createObjectStore(pr,{keyPath:kC,autoIncrement:!0}).createIndex(rl,NC,{unique:!0}),u.createObjectStore(wu)})(e),y2(e),(function(u){u.createObjectStore(Ha)})(e));let o=J.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(Tu),u.deleteObjectStore(Eu),u.deleteObjectStore(dl)})(e),y2(e)),o=o.next((()=>(function(u){const h=u.store(dl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:et.min().toTimestamp(),targetCount:0};return h.put(mp,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(pr).J().next((p=>{u.deleteObjectStore(pr),u.createObjectStore(pr,{keyPath:kC,autoIncrement:!0}).createIndex(rl,NC,{unique:!0});const _=h.store(pr),v=p.map((S=>_.put(S)));return J.waitFor(v)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(Su,{keyPath:_7})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Kd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(fy,{keyPath:x7})})(e),(function(u){u.createObjectStore(gy,{keyPath:v7})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(my,{keyPath:C7});h.createIndex(hv,R7,{unique:!1}),h.createIndex(mN,A7,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(gp,{keyPath:h7});h.createIndex(Im,d7),h.createIndex(hN,f7)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ha)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(ww,{keyPath:w7,autoIncrement:!0}).createIndex(uv,E7,{unique:!1}),u.createObjectStore(fd,{keyPath:T7}).createIndex(fN,S7,{unique:!1}),u.createObjectStore(gd,{keyPath:I7}).createIndex(gN,b7,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(fd).clear()})).next((()=>{t.objectStore(gd).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Ew,{keyPath:P7})})(e)}))),i<18&&r>=18&&fk()&&(o=o.next((()=>{t.objectStore(fd).clear()})).next((()=>{t.objectStore(gd).clear()}))),o}wi(e){let t=0;return e.store(Ha).ee(((i,r)=>{t+=Ip(r)})).next((()=>{const i={byteSize:t};return e.store(Kd).put(cv,i)}))}yi(e){const t=e.store(Hd),i=e.store(pr);return t.J().next((r=>J.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,hl],[s.userId,s.lastAcknowledgedBatchId]);return i.J(rl,o).next((l=>J.forEach(l,(u=>{je(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Xa(this.serializer,u);return lD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(Tu),i=e.store(Ha);return e.store(dl).get(mp).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Ct(o),h=(function(p){return[0,Zn(p)]})(u);s.push(t.get(h).next((f=>f?J.resolve():(p=>t.put({targetId:0,path:Zn(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>J.waitFor(s)))}))}bi(e,t){e.createObjectStore(qd,{keyPath:y7});const i=t.store(qd),r=new Dw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Zn(u)})}};return t.store(Ha).ee({X:!0},((o,l)=>{const u=new Ct(o);return s(u.popLast())})).next((()=>t.store(wu).ee({X:!0},(([o,l,u],h)=>{const f=is(l);return s(f.popLast())}))))}Di(e){const t=e.store(Eu);return t.ee(((i,r)=>{const s=nd(r),o=iD(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Ha),r=[];return i.ee(((s,o)=>{const l=t.store(gp),u=(function(p){return p.document?new Ee(Ct.fromString(p.document.name).popFirst(5)):p.noDocument?Ee.fromSegments(p.noDocument.path):p.unknownDocument?Ee.fromSegments(p.unknownDocument.path):Pe(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>J.waitFor(r)))}Fi(e,t){const i=t.store(pr),r=dD(this.serializer),s=new gD(Ty.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Cn();Xa(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),J.forEach(l,((u,h)=>{const f=new Sn(h),p=wy.wt(this.serializer,f),_=s.getIndexManager(f),v=Ey.wt(f,this.serializer,_,s.referenceDelegate);return new fD(r,v,p,_).recalculateAndSaveOverlaysForDocumentKeys(new dv(t,Er.ce),u).next()}))}))}}function y2(n){n.createObjectStore(Tu,{keyPath:m7}).createIndex(vw,p7,{unique:!0}),n.createObjectStore(Eu,{keyPath:"targetId"}).createIndex(dN,g7,{unique:!0}),n.createObjectStore(dl)}const Oo="IndexedDbPersistence",ix=18e5,rx=5e3,sx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",lG="main";class Lw{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!Lw.v())throw new Ie(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new XW(this,r),this.$i=t+lG,this.serializer=new nD(u),this.Ui=new ea(this.$i,this.Ni,new aG(this.serializer)),this.hi=new LW,this.Pi=new WW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=dD(this.serializer),this.Ii=new MW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&bi(Oo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ie(le.FAILED_PRECONDITION,sx);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Er(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>lm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Fl(e))return fe(Oo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(Oo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Wh(e).get(Ac).next((t=>J.resolve(this.es(t))))}ts(e){return lm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,ix)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=sn(t,Su);return i.J().next((r=>{const s=this.ss(r,ix),o=r.filter((l=>s.indexOf(l)===-1));return J.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?J.resolve(!0):Wh(e).get(Ac).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,rx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ie(le.FAILED_PRECONDITION,sx);return!1}}return!(!this.networkEnabled||!this.inForeground)||lm(e).J().next((i=>this.ss(i,rx).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(Oo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Rf,Su],(e=>{const t=new dv(e,Er.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>lm(e).J().next((t=>this.ss(t,ix).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Ey.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new BW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return wy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe(Oo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?D7:u===17?xN:u===16?N7:u===15?Tw:u===14?_N:u===13?yN:u===12?k7:u===11?pN:void Pe(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new dv(l,this.ci?this.ci.next():Er.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw bi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ie(le.FAILED_PRECONDITION,aN);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Wh(e).get(Ac).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,rx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ie(le.FAILED_PRECONDITION,sx)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wh(e).put(Ac,t)}static v(){return ea.v()}Zi(e){const t=Wh(e);return t.get(Ac).next((i=>this.es(i)?(fe(Oo,"Releasing primary lease."),t.delete(Ac)):J.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(bi(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;dk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(Oo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return bi(Oo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){bi("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Wh(n){return sn(n,Rf)}function lm(n){return sn(n,Su)}function cG(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Ow{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Cn(),r=Cn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Ow(e,t.fromCache,i,r)}}class uG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class mD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return dk()?8:cN(rn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new uG;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(zc()<=Xe.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",Fh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),J.resolve()):(zc()<=Xe.DEBUG&&fe("QueryEngine","Query:",Fh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(zc()<=Xe.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",Fh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qs(t))):J.resolve())}ys(e,t){if($C(t))return J.resolve(null);let i=qs(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=_v(t,null,"F"),i=qs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Cn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,_v(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return $C(t)||r.isEqual(et.min())?J.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?J.resolve(null):(zc()<=Xe.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Fh(t)),this.vs(e,o,t,i7(r,Gd)).next((l=>l)))}))}Ds(e,t){let i=new yt(Q7(e));return t.forEach(((r,s)=>{_y(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return zc()<=Xe.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",Fh(t)),this.ps.getDocumentsMatchingQuery(e,t,ki.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const hG="LocalStore";class dG{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new fi(Ke),this.xs=new ua((s=>bl(s)),Af),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function pD(n,e,t,i){return new dG(n,e,t,i)}async function fG(n,e){const t=St(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Cn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function gG(n,e){const t=St(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,_=p.keys();let v=J.resolve();return _.forEach((S=>{v=v.next((()=>f.getEntry(u,S))).next((I=>{const w=h.docVersions.get(S);je(w!==null,48541),I.version.compareTo(w)<0&&(p.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),v.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Cn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function mG(n){const e=St(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function pG(n,e){const t=St(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=hl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class _2{constructor(){this.activeTargetIds=sW()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yD{constructor(){this.Mo=new _2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _2,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class yG{Oo(e){}shutdown(){}}const x2="ConnectivityMonitor";class v2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(x2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(x2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let cm=null;function Iv(){return cm===null?cm=(function(){return 268435456+Math.round(2147483648*Math.random())})():cm++,"0x"+cm.toString(16)}const ox="RestConnection",_G={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xG{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===yp?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=Iv(),l=this.zo(e,t.toUriEncodedString());fe(ox,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Ol(h);return this.Jo(e,l,u,i,f).then((p=>(fe(ox,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw cy(ox,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=_G[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class vG{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const On="WebChannelConnection";class wG extends xG{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=Iv();return new Promise(((l,u)=>{const h=new Yk;h.setWithCredentials(!0),h.listenOnce(Zk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Em.NO_ERROR:const p=h.getResponseJson();fe(On,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case Em.TIMEOUT:fe(On,`RPC '${e}' ${o} timed out`),u(new Ie(le.DEADLINE_EXCEEDED,"Request time out"));break;case Em.HTTP_ERROR:const _=h.getStatus();if(fe(On,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const S=v?.error;if(S&&S.status&&S.message){const I=(function(R){const M=R.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(M)>=0?M:le.UNKNOWN})(S.status);u(new Ie(I,S.message))}else u(new Ie(le.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Ie(le.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{fe(On,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);fe(On,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=Iv(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=eN(),l=Jk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");fe(On,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let _=!1,v=!1;const S=new vG({Yo:w=>{v?fe(On,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(_||(fe(On,`Opening RPC '${e}' stream ${r} transport.`),p.open(),_=!0),fe(On,`RPC '${e}' stream ${r} sending:`,w),p.send(w))},Zo:()=>p.close()}),I=(w,R,M)=>{w.listen(R,(D=>{try{M(D)}catch(L){setTimeout((()=>{throw L}),0)}}))};return I(p,td.EventType.OPEN,(()=>{v||(fe(On,`RPC '${e}' stream ${r} transport opened.`),S.o_())})),I(p,td.EventType.CLOSE,(()=>{v||(v=!0,fe(On,`RPC '${e}' stream ${r} transport closed`),S.a_(),this.E_(p))})),I(p,td.EventType.ERROR,(w=>{v||(v=!0,cy(On,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),S.a_(new Ie(le.UNAVAILABLE,"The operation could not be completed")))})),I(p,td.EventType.MESSAGE,(w=>{if(!v){const R=w.data[0];je(!!R,16349);const M=R,D=M?.error||M[0]?.error;if(D){fe(On,`RPC '${e}' stream ${r} received error:`,D);const L=D.status;let N=(function(b){const P=Kt[b];if(P!==void 0)return pW(P)})(L),V=D.message;N===void 0&&(N=le.INTERNAL,V="Unknown error status: "+L+" with message "+D.message),v=!0,S.a_(new Ie(N,V)),p.close()}else fe(On,`RPC '${e}' stream ${r} received:`,R),S.u_(R)}})),I(l,Qk.STAT_EVENT,(w=>{w.stat===ov.PROXY?fe(On,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===ov.NOPROXY&&fe(On,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function EG(){return typeof window<"u"?window:null}function Pm(){return typeof document<"u"?document:null}function _D(n){return new vW(n,!0)}class xD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const w2="PersistentStream";class TG{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new xD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(bi(t.toString()),bi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ie(le.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(w2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(w2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class SG extends TG{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=IW(e.writeResults,e.commitTime),i=Cr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=TW(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Ep(this.serializer,i)))};this.q_(t)}}class IG{}class bG extends IG{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ie(le.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,vv(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ie(le.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,vv(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ie(le.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class CG{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(bi(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Sy="RemoteStore";class RG{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{by(this)&&(fe(Sy,"Restarting streams for network reachability change."),await(async function(u){const h=St(u);h.Ea.add(4),await Iy(h),h.Ra.set("Unknown"),h.Ea.delete(4),await jw(h)})(this))}))})),this.Ra=new CG(i,r)}}async function jw(n){if(by(n))for(const e of n.da)await e(!0)}async function Iy(n){for(const e of n.da)await e(!1)}function by(n){return St(n).Ea.size===0}async function vD(n,e,t){if(!Fl(e))throw e;n.Ea.add(1),await Iy(n),n.Ra.set("Offline"),t||(t=()=>mG(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(Sy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await jw(n)}))}function wD(n,e){return e().catch((t=>vD(n,t,e)))}async function Cy(n){const e=St(n),t=aa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:hl;for(;AG(e);)try{const r=await pG(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,PG(e,r)}catch(r){await vD(e,r)}ED(e)&&TD(e)}function AG(n){return by(n)&&n.Ta.length<10}function PG(n,e){n.Ta.push(e);const t=aa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function ED(n){return by(n)&&!aa(n).x_()&&n.Ta.length>0}function TD(n){aa(n).start()}async function kG(n){aa(n).ra()}async function NG(n){const e=aa(n);for(const t of n.Ta)e.ea(t.mutations)}async function DG(n,e,t){const i=n.Ta.shift(),r=Pw.from(i,e,t);await wD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Cy(n)}async function MG(n,e){e&&aa(n).X_&&await(async function(i,r){if((function(o){return mW(o)&&o!==le.ABORTED})(r.code)){const s=i.Ta.shift();aa(i).B_(),await wD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Cy(i)}})(n,e),ED(n)&&TD(n)}async function LG(n,e){const t=St(n);e?(t.Ea.delete(2),await jw(t)):e||(t.Ea.add(2),await Iy(t),t.Ra.set("Unknown"))}function aa(n){return n.fa||(n.fa=(function(t,i,r){const s=St(t);return s.sa(),new SG(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:kG.bind(null,n),r_:MG.bind(null,n),ta:NG.bind(null,n),na:DG.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Cy(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(Sy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Fw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ul,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Fw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function OG(n,e){if(bi("AsyncQueue",`${e}: ${n}`),Fl(n))return new Ie(le.UNAVAILABLE,`${e}: ${n}`);throw n}class jG{constructor(){this.queries=E2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=St(t),s=r.queries;r.queries=E2(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Ie(le.ABORTED,"Firestore shutting down"))}}function E2(){return new ua((n=>VN(n)),FN)}function FG(n){n.Ca.forEach((e=>{e.next()}))}var T2,S2;(S2=T2||(T2={})).Ma="default",S2.Cache="cache";const VG="SyncEngine";class zG{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ua((l=>VN(l)),FN),this.Iu=new Map,this.Eu=new Set,this.du=new fi(Ee.comparator),this.Au=new Map,this.Ru=new Mw,this.Vu={},this.mu=new Map,this.fu=Al.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function I2(n,e,t){const i=St(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=St(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const _ of p.Sa)_.va(l)&&(h=!0)})),h&&FG(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function UG(n,e){const t=St(n),i=e.batch.batchId;try{const r=await gG(t.localStore,e);ID(t,i,null),SD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Vw(t,r)}catch(r){await uy(r)}}async function BG(n,e,t){const i=St(n);try{const r=await(function(o,l){const u=St(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(je(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);ID(i,e,t),SD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Vw(i,r)}catch(r){await uy(r)}}function SD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ID(n,e,t){const i=St(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Vw(n,e,t){const i=St(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Ow.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=St(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>J.forEach(h,(_=>J.forEach(_.Es,(v=>f.persistence.referenceDelegate.addReference(p,_.targetId,v))).next((()=>J.forEach(_.ds,(v=>f.persistence.referenceDelegate.removeReference(p,_.targetId,v)))))))))}catch(p){if(!Fl(p))throw p;fe(hG,"Failed to update sequence numbers: "+p)}for(const p of h){const _=p.targetId;if(!p.fromCache){const v=f.Ms.get(_),S=v.snapshotVersion,I=v.withLastLimboFreeSnapshotVersion(S);f.Ms=f.Ms.insert(_,I)}}})(i.localStore,s))}async function WG(n,e){const t=St(n);if(!t.currentUser.isEqual(e)){fe(VG,"User change. New user:",e.toKey());const i=await fG(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Ie(le.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Vw(t,i.Ls)}}function GG(n){const e=St(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=UG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BG.bind(null,e),e}class bv{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_D(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return pD(this.persistence,new mD,e.initialUser,this.serializer)}Cu(e){return new gD(Ty.mi,this.serializer)}Du(e){return new yD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bv.provider={build:()=>new bv};class $G extends bv{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await GG(this.xu.syncEngine),await Cy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return pD(this.persistence,new mD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new HW(i,e.asyncQueue,t)}Mu(e,t){const i=new a7(t,this.persistence);return new o7(e.asyncQueue,i)}Cu(e){const t=cG(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?si.withCacheSize(this.cacheSizeBytes):si.DEFAULT;return new Lw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,EG(),Pm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new yD}}class Cv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>I2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=WG.bind(null,this.syncEngine),await LG(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new jG})()}createDatastore(e){const t=_D(e.databaseInfo.databaseId),i=(function(s){return new wG(s)})(e.databaseInfo);return(function(s,o,l,u){return new bG(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new RG(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>I2(this.syncEngine,t,0)),(function(){return v2.v()?new v2:new yG})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new zG(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=St(t);fe(Sy,"RemoteStore shutting down."),i.Ea.add(5),await Iy(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cv.provider={build:()=>new Cv};const b2="FirestoreClient";class HG{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Sn.UNAUTHENTICATED,this.clientId=iN.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{fe(b2,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(fe(b2,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ul;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=OG(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function bD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const C2=new Map;const CD="firestore.googleapis.com",R2=!0;class A2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=CD,this.ssl=R2}else this.host=e.host,this.ssl=e.ssl??R2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<GW)throw new Ie(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}e7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class RD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new A2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new A2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new G8;switch(i.type){case"firstParty":return new q8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ie(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=C2.get(t);i&&(fe("ComponentProvider","Removing Datastore"),C2.delete(t),i.terminate())})(this),Promise.resolve()}}function KG(n,e,t,i={}){n=sN(n,RD);const r=Ol(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(tw(`https://${l}`),nw("Firestore",!0)),s.host!==CD&&s.host!==l&&cy("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!El(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=Sn.MOCK_USER;else{h=uk(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Ie(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Sn(p)}n._authCredentials=new $8(new nN(h,f))}}class zw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new zw(this.firestore,e,this._query)}}class ss{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Uw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ss(this.firestore,e,this._key)}toJSON(){return{type:ss._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Cf(t,ss._jsonSchema))return new ss(e,i||null,new Ee(Ct.fromString(t.referencePath)))}}ss._jsonSchemaVersion="firestore/documentReference/1.0",ss._jsonSchema={type:Yt("string",ss._jsonSchemaVersion),referencePath:Yt("string")};class Uw extends zw{constructor(e,t,i){super(e,t,jN(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ss(this.firestore,null,new Ee(e))}withConverter(e){return new Uw(this.firestore,e,this._path)}}const P2="AsyncQueue";class k2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new xD(this,"async_queue_retry"),this._c=()=>{const i=Pm();i&&fe(P2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Pm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Pm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ul;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Fl(e))throw e;fe(P2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,bi("INTERNAL UNHANDLED ERROR: ",N2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Fw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Pe(47125,{Pc:N2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function N2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class AD extends RD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new k2,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new k2(e),this._firestoreClient=void 0,await e}}}function qG(n,e){const t=typeof n=="object"?n:sw(),i=typeof n=="string"?n:yp,r=sy(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=ak("firestore");s&&KG(r,...s)}return r}function XG(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new j7(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,bD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new HG(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function YG(n,e){cy("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return ZG(n,Cv.provider,{build:i=>new $G(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function ZG(n,e,t){if((n=sN(n,AD))._firestoreClient||n._terminated)throw new Ie(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ie(le.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},XG(n)}class Vs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vs(gi.fromBase64String(e))}catch(t){throw new Ie(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vs(gi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cf(e,Vs._jsonSchema))return Vs.fromBase64String(e.bytes)}}Vs._jsonSchemaVersion="firestore/bytes/1.0",Vs._jsonSchema={type:Yt("string",Vs._jsonSchemaVersion),bytes:Yt("string")};class PD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class fl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:fl._jsonSchemaVersion}}static fromJSON(e){if(Cf(e,fl._jsonSchema))return new fl(e.latitude,e.longitude)}}fl._jsonSchemaVersion="firestore/geoPoint/1.0",fl._jsonSchema={type:Yt("string",fl._jsonSchemaVersion),latitude:Yt("number"),longitude:Yt("number")};class gl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:gl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cf(e,gl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new gl(e.vectorValues);throw new Ie(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}gl._jsonSchemaVersion="firestore/vectorValue/1.0",gl._jsonSchema={type:Yt("string",gl._jsonSchemaVersion),vectorValues:Yt("object")};const QG=new RegExp("[~\\*/\\[\\]]");function JG(n,e,t){if(e.search(QG)>=0)throw D2(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new PD(...e.split("."))._internalPath}catch{throw D2(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function D2(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Ie(le.INVALID_ARGUMENT,s+n+o)}class kD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ss(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new e$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ND("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class e$ extends kD{data(){return super.data()}}function ND(n,e){return typeof e=="string"?JG(n,e):e instanceof PD?e._internalPath:e._delegate._internalPath}class um{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class su extends kD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new km(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(ND("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=su._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}su._jsonSchemaVersion="firestore/documentSnapshot/1.0",su._jsonSchema={type:Yt("string",su._jsonSchemaVersion),bundleSource:Yt("string","DocumentSnapshot"),bundleName:Yt("string"),bundle:Yt("string")};class km extends su{data(e={}){return super.data(e)}}class xd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new um(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new km(this._firestore,this._userDataWriter,i.key,i,new um(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new km(r._firestore,r._userDataWriter,l.doc.key,l.doc,new um(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new km(r._firestore,r._userDataWriter,l.doc.key,l.doc,new um(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:t$(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=xd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iN.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function t$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:n})}}xd._jsonSchemaVersion="firestore/querySnapshot/1.0",xd._jsonSchema={type:Yt("string",xd._jsonSchemaVersion),bundleSource:Yt("string","QuerySnapshot"),bundleName:Yt("string"),bundle:Yt("string")};(function(e,t=!0){(function(r){zu=r})(jl),Tl(new ra("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new AD(new H8(i.getProvider("auth-internal")),new X8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ie(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),ls(TC,SC,e),ls(TC,SC,"esm2020")})();const DD="firebasestorage.googleapis.com",n$="storageBucket",i$=120*1e3,r$=600*1e3;class ps extends ms{constructor(e,t,i=0){super(ax(e),`Firebase Storage: ${t} (${ax(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ps.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ax(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ds;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ds||(ds={}));function ax(n){return"storage/"+n}function s$(){const n="An unknown error occurred, please check the error payload for server response.";return new ps(ds.UNKNOWN,n)}function o$(){return new ps(ds.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function a$(){return new ps(ds.CANCELED,"User canceled the upload/download.")}function l$(n){return new ps(ds.INVALID_URL,"Invalid URL '"+n+"'.")}function c$(n){return new ps(ds.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function M2(n){return new ps(ds.INVALID_ARGUMENT,n)}function MD(){return new ps(ds.APP_DELETED,"The Firebase app was deleted.")}function u$(n){return new ps(ds.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Sr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Sr.makeFromUrl(e,t)}catch{return new Sr(e,"")}if(i.path==="")return i;throw c$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",v=new RegExp(`^https?://${p}/${f}/b/${r}/o${_}`,"i"),S={bucket:1,path:3},I=t===DD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",R=new RegExp(`^https?://${I}/${r}/${w}`,"i"),D=[{regex:l,indices:u,postModify:s},{regex:v,indices:S,postModify:h},{regex:R,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<D.length;L++){const N=D[L],V=N.regex.exec(e);if(V){const A=V[N.indices.bucket];let b=V[N.indices.path];b||(b=""),i=new Sr(A,b),N.postModify(i);break}}if(i==null)throw l$(e);return i}}class h${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function d$(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...w){h||(h=!0,e.apply(null,w))}function p(w){r=setTimeout(()=>{r=null,n(v,u())},w)}function _(){s&&clearTimeout(s)}function v(w,...R){if(h){_();return}if(w){_(),f.call(null,w,...R);return}if(u()||o){_(),f.call(null,w,...R);return}i<64&&(i*=2);let D;l===1?(l=2,D=0):D=(i+Math.random())*1e3,p(D)}let S=!1;function I(w){S||(S=!0,_(),!h&&(r!==null?(w||(l=2),clearTimeout(r),p(0)):w||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function f$(n){n(!1)}function g$(n){return n!==void 0}function L2(n,e,t,i){if(i<e)throw M2(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw M2(`Invalid value for '${n}'. Expected ${t} or less.`)}function m$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var bp;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(bp||(bp={}));function p$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class y${constructor(e,t,i,r,s,o,l,u,h,f,p,_=!0,v=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=_,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,I)=>{this.resolve_=S,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new hm(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===bp.NO_ERROR,u=s.getStatus();if(!l||p$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===bp.ABORT;i(!1,new hm(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new hm(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());g$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=s$();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?MD():a$();o(u)}else{const u=o$();o(u)}};this.canceled_?t(!1,new hm(!1,null,!0)):this.backoffId_=d$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&f$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hm{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function _$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function x$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function v$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function w$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function E$(n,e,t,i,r,s,o=!0,l=!1){const u=m$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return v$(f,e),_$(f,t),x$(f,s),w$(f,i),new y$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function T$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function S$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Cp{constructor(e,t){this._service=e,t instanceof Sr?this._location=t:this._location=Sr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Cp(e,t)}get root(){const e=new Sr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return S$(this._location.path)}get storage(){return this._service}get parent(){const e=T$(this._location.path);if(e===null)return null;const t=new Sr(this._location.bucket,e);return new Cp(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw u$(e)}}function O2(n,e){const t=e?.[n$];return t==null?null:Sr.makeFromBucketSpec(t,n)}function I$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Ol(e);r&&(tw(`https://${n.host}/b`),nw("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:uk(s,n.app.options.projectId))}class b${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=DD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=i$,this._maxUploadRetryTime=r$,this._requests=new Set,r!=null?this._bucket=Sr.makeFromBucketSpec(r,this._host):this._bucket=O2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Sr.makeFromBucketSpec(this._url,e):this._bucket=O2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){L2("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){L2("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Yi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Cp(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new h$(MD());{const o=E$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const j2="@firebase/storage",F2="0.14.0";const LD="storage";function C$(n=sw(),e){n=no(n);const i=sy(n,LD).getImmediate({identifier:e}),r=ak("storage");return r&&R$(i,...r),i}function R$(n,e,t,i={}){I$(n,e,t,i)}function A$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new b$(t,i,r,e,jl)}function P$(){Tl(new ra(LD,A$,"PUBLIC").setMultipleInstances(!0)),ls(j2,F2,""),ls(j2,F2,"esm2020")}P$();const k$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Bw=yk(k$),lx=z8(Bw),N$=qG(Bw);C$(Bw);YG(N$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const D$="visvriend2024",M$=new Fs,OD=Pr()(wf((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===D$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await XB(lx,M$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await AB(lx),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{RB(lx,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),Ww="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",Jd=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function L$(n,e){let t=Jd[0],i=1/0;for(const r of Jd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function O$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Ww}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function j$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Ww}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function F$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Ww}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function V$(n){const[e,t,i]=await Promise.all([O$(n),j$(n),F$(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function V2(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const z2=Pr((n,e)=>({station:Jd[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=L$(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=V2(t):r=await V$(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=V2(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})}));function z$({target:n}){const e=K.useRef(null),t=K.useRef(null),i=gs(s=>s.setMap),r=qe(s=>s.showScaleBar);return K.useEffect(()=>{if(!e.current){const s=new R9({target:n,controls:[],view:new ts({center:pl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),K.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new k9({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const U$=["OpenStreetMap","Luchtfoto","Terrein","CartoDB Light"];function B$(){const n=K.useRef(null),e=K.useRef(!1);z$({target:"map"});const t=gs(u=>u.map),i=Xi(u=>u.registerLayer),r=Xi(u=>u.setLayerVisibility);Xi(u=>u.setLayerOpacity);const s=qe(u=>u.defaultBackground),o=qe(u=>u.gpsAutoStart),l=zn(u=>u.startTracking);return K.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=qe.getState().defaultBackground||"CartoDB Light",h=u==="OpenStreetMap",f=u==="Luchtfoto",p=u==="Terrein",_=u==="CartoDB Light";console.log("Background setting:",u);const v=new Lh({properties:{title:"CartoDB Light",type:"base"},visible:_,source:new ed({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20})}),S=new Lh({properties:{title:"Terrein",type:"base"},visible:p,source:new ed({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors, SRTM | Map style:  OpenTopoMap (CC-BY-SA)",maxZoom:17})}),I=new Lh({properties:{title:"OpenStreetMap",type:"base"},visible:h,source:new q6}),w=new Lh({properties:{title:"Luchtfoto",type:"base"},visible:f,source:new ed({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),R=new Lh({properties:{title:"Labels Overlay",type:"overlay"},visible:f,source:new ed({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(v),t.addLayer(S),t.addLayer(I),t.addLayer(w),t.addLayer(R),i("CartoDB Light",v),i("Terrein",S),i("OpenStreetMap",I),i("Luchtfoto",w),i("Labels Overlay",R),r("CartoDB Light",_),r("Terrein",p),r("OpenStreetMap",h),r("Luchtfoto",f),r("Labels Overlay",f),t.updateSize(),M();async function M(){const D=iz();console.log(`Loading ${D.length} immediate layers...`),(await Promise.allSettled(D.map(async N=>{try{const V=await N.factory();return V?{name:N.name,layer:V}:null}catch(V){return console.warn(`Failed to create ${N.name}:`,V),null}}))).forEach(N=>{if(N.status==="fulfilled"&&N.value){const{name:V,layer:A}=N.value;t.addLayer(A),i(V,A)}})}},[t,i]),K.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";U$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),K.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),g.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const W$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),G$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),U2=n=>{const e=G$(n);return e.charAt(0).toUpperCase()+e.slice(1)},jD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),$$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var H$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const K$=K.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>K.createElement("svg",{ref:u,...H$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:jD("lucide",r),...!s&&!$$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>K.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Te=(n,e)=>{const t=K.forwardRef(({className:i,...r},s)=>K.createElement(K$,{ref:s,iconNode:e,className:jD(`lucide-${W$(U2(n))}`,`lucide-${n}`,i),...r}));return t.displayName=U2(n),t};const q$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],FD=Te("anchor",q$);const X$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Y$=Te("book-open",X$);const Z$=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Q$=Te("calendar",Z$);const J$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Gw=Te("camera",J$);const eH=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],tH=Te("chart-column",eH);const nH=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Rp=Te("check",nH);const iH=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],rH=Te("chevron-down",iH);const sH=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],VD=Te("chevron-left",sH);const oH=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Xo=Te("chevron-right",oH);const aH=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],zD=Te("chevron-up",aH);const lH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],cH=Te("cloud-fog",lH);const uH=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],hH=Te("cloud-lightning",uH);const dH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],Pl=Te("cloud-rain",dH);const fH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],gH=Te("cloud-snow",fH);const mH=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],ef=Te("cloud",mH);const pH=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],tf=Te("droplets",pH);const yH=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],UD=Te("external-link",yH);const _H=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],xH=Te("eye-off",_H);const vH=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wH=Te("eye",vH);const EH=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],TH=Te("file-text",EH);const SH=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Js=Te("fish",SH);const IH=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],BD=Te("gauge",IH);const bH=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],CH=Te("image-plus",bH);const RH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],WD=Te("info",RH);const AH=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],nf=Te("layers",AH);const PH=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],kH=Te("loader-circle",PH);const NH=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],DH=Te("locate-fixed",NH);const MH=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],LH=Te("lock",MH);const OH=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],jH=Te("log-out",OH);const FH=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ir=Te("map-pin",FH);const VH=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Ry=Te("map",VH);const zH=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],UH=Te("menu",zH);const BH=[["path",{d:"M5 12h14",key:"1ays0h"}]],$w=Te("minus",BH);const WH=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],GH=Te("mountain",WH);const $H=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Du=Te("navigation",$H);const HH=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],KH=Te("pause",HH);const qH=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],XH=Te("person-standing",qH);const YH=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ZH=Te("play",YH);const QH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],JH=Te("plus",QH);const eK=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Hw=Te("refresh-cw",eK);const tK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],nK=Te("rotate-ccw",tK);const iK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],rK=Te("ruler",iK);const sK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oK=Te("save",sK);const aK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],lK=Te("scale",aK);const cK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Rv=Te("search",cK);const uK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hK=Te("settings",uK);const dK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],fK=Te("ship",dK);const gK=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],mK=Te("sparkles",gK);const pK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Av=Te("star",pK);const yK=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],_K=Te("sun",yK);const xK=[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]],vK=Te("sunrise",xK);const wK=[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]],EK=Te("sunset",wK);const TK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],SK=Te("tag",TK);const IK=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],GD=Te("thermometer",IK);const bK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Kw=Te("trending-down",bK);const CK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],qw=Te("trending-up",CK);const RK=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],AK=Te("type",RK);const PK=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],kK=Te("user",PK);const NK=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],kl=Te("waves",NK);const DK=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],Pv=Te("wind",DK);const MK=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],An=Te("x",MK);async function LK(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,_=OK(r,f,p);e(_);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function OK(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const _=i+2+p*12;if(n.getUint16(_,t)===34853){s=e+n.getUint32(_+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const _=s+2+p*12,v=n.getUint16(_,t),S=n.getUint16(_+2,t),I=n.getUint32(_+4,t),w=_+8;switch(v){case 1:l=String.fromCharCode(n.getUint8(w));break;case 2:u=B2(n,e+n.getUint32(w,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(w));break;case 4:f=B2(n,e+n.getUint32(w,t),3,t);break}}if(u&&f&&l&&h){const p=W2(u[0],u[1],u[2],l),_=W2(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(_))return{lat:p,lng:_}}return null}catch{return null}}function B2(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function W2(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const $D=200,jK=.7;async function FK(n,e=$D){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",jK)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function VK(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function HD(n){const e=await FK(n,$D),t=await VK(e);return{thumbnailBlob:e,thumbnailBase64:t}}function KD(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function zK(){const n=gs(H=>H.map),e=Un(H=>H.openCatchForm),t=qe(H=>H.showWeatherWidget),i=qe(H=>H.setShowWeatherWidget),r=qe(H=>H.showWindIndicator),s=qe(H=>H.setShowWindIndicator),o=qe(H=>H.showTideWidget),l=qe(H=>H.setShowTideWidget),u=qe(H=>H.showBuienradarWidget),h=qe(H=>H.setShowBuienradarWidget),f=qe(H=>H.showWaterflowWidget),p=qe(H=>H.setShowWaterflowWidget),_=qe(H=>H.showForecastSlider),v=qe(H=>H.setShowForecastSlider),[S,I]=K.useState(null),[w,R]=K.useState(!1),[M,D]=K.useState(!1),[L,N]=K.useState(!1),V=K.useRef(null),A=K.useRef(null);K.useEffect(()=>{if(!n)return;const H=n.getViewport();if(!H)return;const X=600,ne=15,W=be=>{if(be.touches.length!==1)return;const Le=be.touches[0];A.current={x:Le.clientX,y:Le.clientY},V.current&&clearTimeout(V.current),V.current=window.setTimeout(()=>{if(!A.current)return;const Ge=window.__olMap;if(!Ge)return;const Wt=H.getBoundingClientRect(),Wn=[A.current.x-Wt.left,A.current.y-Wt.top],Zt=Ge.getCoordinateFromPixel(Wn);if(Zt){const Pn=Mx(Zt);be.preventDefault(),I({pixel:[A.current.x,A.current.y],coordinate:Pn}),R(!0),D(!1),setTimeout(()=>D(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},X)},G=be=>{if(!V.current||!A.current)return;const Le=be.touches[0],Ge=Le.clientX-A.current.x,Wt=Le.clientY-A.current.y;Math.sqrt(Ge*Ge+Wt*Wt)>ne&&(clearTimeout(V.current),V.current=null)},re=()=>{V.current&&(clearTimeout(V.current),V.current=null),A.current=null},ge=be=>{w&&be.preventDefault()},_e=be=>{be.button===0&&(A.current={x:be.clientX,y:be.clientY},V.current&&clearTimeout(V.current),V.current=window.setTimeout(()=>{if(!A.current)return;const Le=window.__olMap;if(!Le)return;const Ge=H.getBoundingClientRect(),Wt=[A.current.x-Ge.left,A.current.y-Ge.top],Wn=Le.getCoordinateFromPixel(Wt);if(Wn){const Zt=Mx(Wn);I({pixel:[A.current.x,A.current.y],coordinate:Zt}),R(!0),D(!1),setTimeout(()=>D(!0),300)}},X))},Ce=be=>{if(!V.current||!A.current)return;const Le=be.clientX-A.current.x,Ge=be.clientY-A.current.y;Math.sqrt(Le*Le+Ge*Ge)>ne&&(clearTimeout(V.current),V.current=null)},Ne=()=>{V.current&&(clearTimeout(V.current),V.current=null),A.current=null};return H.addEventListener("touchstart",W,{passive:!1}),H.addEventListener("touchmove",G,{passive:!0}),H.addEventListener("touchend",re),H.addEventListener("touchcancel",re),H.addEventListener("contextmenu",ge),H.addEventListener("mousedown",_e),H.addEventListener("mousemove",Ce),H.addEventListener("mouseup",Ne),H.addEventListener("mouseleave",Ne),()=>{H.removeEventListener("touchstart",W),H.removeEventListener("touchmove",G),H.removeEventListener("touchend",re),H.removeEventListener("touchcancel",re),H.removeEventListener("contextmenu",ge),H.removeEventListener("mousedown",_e),H.removeEventListener("mousemove",Ce),H.removeEventListener("mouseup",Ne),H.removeEventListener("mouseleave",Ne),V.current&&clearTimeout(V.current)}},[n,w]);const b=()=>{M&&(R(!1),I(null),D(!1))},P=()=>{R(!1),I(null),D(!1),N(!1)},j=K.useRef(null),z=()=>{if(!S)return;const[H,X]=S.coordinate;e({location:{lat:X,lng:H},locationSource:"map"}),P()},B=()=>{j.current?.click()},O=async H=>{const X=H.target.files?.[0];if(!(!X||!S)){try{const ne=await LK(X),{thumbnailBase64:W}=await HD(X),G={id:KD(),thumbnailBase64:W,createdAt:new Date().toISOString(),pendingUpload:!0};if(ne)e({location:ne,locationSource:"photo",photos:[G]});else{const[re,ge]=S.coordinate;e({location:{lat:ge,lng:re},locationSource:"map",photos:[G]})}}catch(ne){console.error("Failed to process photo:",ne);const[W,G]=S.coordinate;e({location:{lat:G,lng:W},locationSource:"map"})}H.target.value="",P()}},se=()=>{if(!S)return;const[H,X]=S.coordinate,ne=`https://www.google.com/maps?q=${X},${H}`;window.open(ne,"_blank"),P()},me=()=>{if(!S)return;const[H,X]=S.coordinate,ne=`https://www.google.com/maps?layer=c&cbll=${X},${H}`;window.open(ne,"_blank"),P()},pe=H=>{const[X,ne]=H;return`${ne.toFixed(5)}N, ${X.toFixed(5)}E`},ue=()=>{if(!S)return{};const H=220,X=340,W=L?X+280:X;let G=S.pixel[0];G+H>window.innerWidth&&(G=window.innerWidth-H-10),G<10&&(G=10);let re=S.pixel[1];const ge=window.innerHeight-S.pixel[1],_e=S.pixel[1];return ge<W&&_e>W?re=S.pixel[1]-W+40:ge<W&&(re=Math.max(10,window.innerHeight-W-10)),{left:G,top:re}};return g.jsx(Xt,{children:w&&S&&g.jsxs(g.Fragment,{children:[g.jsx(ke.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),g.jsxs(ke.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none max-h-[90vh] overflow-y-auto",style:ue(),initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[g.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[g.jsx(ir,{size:16}),g.jsx("span",{className:"text-xs font-mono",children:pe(S.coordinate)})]})}),g.jsxs("div",{className:"bg-white",children:[g.jsxs("button",{onClick:B,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(Gw,{size:20,className:"text-green-500"}),g.jsx("span",{className:"font-medium",children:"Maak foto"})]}),g.jsxs("button",{onClick:z,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(Js,{size:20,className:"text-orange-500"}),g.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),g.jsxs("button",{onClick:me,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(XH,{size:20,className:"text-yellow-600"}),g.jsx("span",{className:"font-medium",children:"Street View"})]}),g.jsxs("button",{onClick:se,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(UD,{size:20,className:"text-blue-600"}),g.jsx("span",{className:"font-medium",children:"Google Maps"})]}),g.jsxs("button",{onClick:()=>N(!L),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(ef,{size:20,className:"text-purple-500"}),g.jsx("span",{className:"font-medium",children:"Widgets"}),g.jsx(Xo,{size:16,className:`ml-auto text-gray-400 transition-transform ${L?"rotate-90":""}`})]}),g.jsx(Xt,{children:L&&g.jsx(ke.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-gray-50 border-t border-gray-100",children:g.jsxs("div",{className:"py-1 px-2",children:[g.jsx("div",{className:"px-2 py-1.5 text-xs text-gray-400 font-medium",children:"Toon/verberg widgets"}),g.jsx(Lc,{icon:g.jsx(GD,{size:16,className:"text-orange-500"}),label:"Weer & visvriendelijkheid",checked:t,onChange:i}),g.jsx(Lc,{icon:g.jsx(Pv,{size:16,className:"text-cyan-500"}),label:"Wind indicator",checked:r,onChange:s}),g.jsx(Lc,{icon:g.jsx(kl,{size:16,className:"text-blue-500"}),label:"Getijden",checked:o,onChange:l}),g.jsx(Lc,{icon:g.jsx(Pl,{size:16,className:"text-indigo-500"}),label:"Buienradar",checked:u,onChange:h}),g.jsx(Lc,{icon:g.jsx(tf,{size:16,className:"text-cyan-600"}),label:"Waterafvoer rivieren",checked:f,onChange:p}),g.jsx(Lc,{icon:g.jsx(tH,{size:16,className:"text-green-500"}),label:"Voorspelling schuif",checked:_,onChange:v})]})})})]}),g.jsx("input",{ref:j,type:"file",accept:"image/*",capture:"environment",onChange:O,className:"hidden"}),g.jsx("div",{className:"bg-white border-t border-gray-100",children:g.jsxs("button",{onClick:P,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[g.jsx(An,{size:18}),g.jsx("span",{children:"Annuleren"})]})})]})]})})}function Lc({icon:n,label:e,checked:t,onChange:i}){return g.jsxs("button",{onClick:()=>i(!t),className:"w-full px-2 py-2 flex items-center gap-2 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:[n,g.jsx("span",{className:"text-sm text-gray-700 flex-1 text-left",children:e}),g.jsx("div",{className:`w-9 h-5 rounded-full transition-colors flex-shrink-0 ${t?"bg-orange-500":"bg-gray-300"}`,children:g.jsx("div",{className:"w-4 h-4 mt-0.5 rounded-full bg-white shadow transition-transform",style:{marginLeft:t?"18px":"2px"}})})]})}function UK(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=zn(),s=K.useCallback(l=>{i(l)},[i]),o=K.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return K.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function BK(){const{tracking:n,toggle:e}=UK();return g.jsx(ke.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:g.jsx(DH,{size:22,strokeWidth:2})})}const WK="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function GK(){const n=gs(_=>_.map),e=zn(_=>_.position),t=zn(_=>_.accuracy),i=zn(_=>_.tracking),r=zn(_=>_.smoothHeading),s=qe(_=>_.showAccuracyCircle),o=zn(_=>_.firstFix),l=zn(_=>_.resetFirstFix),u=K.useRef(null),h=K.useRef(null),f=K.useRef(null),p=K.useMemo(()=>_=>new tr({image:new F1({src:WK,scale:.9,rotation:_,rotateWithView:!1,anchor:[.5,.5]})}),[]);return K.useEffect(()=>{if(!n||!i&&!e)return;const _=pl([5.1214,52.0907]);return u.current=new hu({geometry:new yl(_)}),u.current.setStyle(p(0)),h.current=new hu({geometry:new yl(_)}),f.current=new H1({source:new j1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),K.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const _=pl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(_),h.current.getGeometry()?.setCoordinates(_),s&&t){const v=n.getView().getResolution()||1,S=Math.min(t/v,80);h.current.setStyle(new tr({image:new Ml({radius:S,fill:new Rr({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new tr({}));if(o&&i){n.getView().setCenter(_),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:_,duration:150})},[n,i,e,t,o,l,s]),K.useEffect(()=>{if(!u.current)return;const _=r!==null?r*Math.PI/180:0;u.current.setStyle(p(_))},[r,p]),null}function $K(){const n=gs(D=>D.map),[e,t]=K.useState(!1),[i,r]=K.useState(""),[s,o]=K.useState([]),[l,u]=K.useState(!1),[h,f]=K.useState(!1),p=K.useRef(null),_=K.useRef(null),v=K.useRef();K.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),K.useEffect(()=>{if(!e)return;const D=L=>{_.current&&!_.current.contains(L.target)&&S()};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[e]),K.useEffect(()=>{if(!e)return;const D=L=>{L.key==="Escape"&&S()};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[e]),K.useEffect(()=>{if(v.current&&clearTimeout(v.current),i.length<2){o([]);return}return v.current=window.setTimeout(async()=>{f(!0);try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();L.response?.docs&&o(L.response.docs)}catch(D){console.error("Search error:",D),o([])}finally{f(!1)}},300),()=>{v.current&&clearTimeout(v.current)}},[i]);const S=()=>{t(!1),r(""),o([]),u(!1)},I=async D=>{try{const N=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(D)}`)).json();if(N.response?.docs?.[0]?.centroide_ll){const A=N.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(A)return{lng:parseFloat(A[1]),lat:parseFloat(A[2])}}}catch(L){console.error("Lookup error:",L)}return null},w=async D=>{if(!n)return;const L=await I(D.id);L&&n.getView().animate({center:pl([L.lng,L.lat]),zoom:16,duration:1e3}),S()},R=async(D,L)=>{L.stopPropagation();const N=await I(D.id);if(N){const V=`https://www.google.com/maps?q=${N.lat},${N.lng}`;window.open(V,"_blank")}S()},M={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?g.jsxs("div",{ref:_,className:"fixed left-[52px] right-14 z-[850]",style:M,children:[g.jsxs(ke.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[g.jsx(Rv,{size:18,className:"search-icon"}),g.jsx("input",{ref:p,type:"text",value:i,onChange:D=>{r(D.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),g.jsx("button",{onClick:S,className:"search-clear",title:"Sluiten",children:g.jsx(An,{size:18})})]}),g.jsx(Xt,{children:l&&s.length>0&&g.jsx(ke.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(D=>g.jsxs("li",{className:"search-result-item",children:[g.jsx("div",{className:"search-result-content",onClick:()=>w(D),children:g.jsx("span",{className:"search-result-text",children:D.weergavenaam})}),g.jsx("button",{className:"search-navigate-btn",onClick:L=>R(D,L),title:"Open in Google Maps",children:g.jsx(UD,{size:20})})]},D.id))})}),l&&h&&g.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):g.jsx(ke.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:M,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:g.jsx(Rv,{size:22,className:"text-gray-600"})})}function HK({size:n=18}){return g.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function KK(){const[n,e]=K.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=Un(),{user:r,loading:s,signInWithGoogle:o,logout:l}=OD(),u=qe(w=>w.showCatchButton),h=qe(w=>w.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),_=()=>{p(),t()},v=()=>{p(),i()},S=()=>{p(),o()},I=()=>{p(),l()};return g.jsxs(g.Fragment,{children:[g.jsx(ke.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-orange-500 hover:bg-orange-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?g.jsx(An,{size:22,className:"text-white"}):g.jsx(UH,{size:22,className:"text-gray-600"})}),g.jsx(Xt,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(ke.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),g.jsxs(ke.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[g.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-orange-500",children:g.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?g.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:g.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-orange-500 rounded-full animate-spin"})}):r?g.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?g.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):g.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:g.jsx(kK,{size:16,className:"text-white"})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),g.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),g.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:g.jsx(jH,{size:16})})]})}):g.jsxs("button",{onClick:S,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[g.jsx(HK,{size:18}),g.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),g.jsx("div",{className:"py-1",children:g.jsxs("button",{onClick:_,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[g.jsx(WD,{size:18,className:"text-blue-500"}),g.jsx("span",{children:"Info & handleiding"})]})}),g.jsx("div",{className:"py-1 border-t border-gray-100",children:g.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Js,{size:18,className:"text-green-500"}),g.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),g.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),g.jsx("div",{className:"mt-auto border-t border-gray-100",children:g.jsxs("button",{onClick:v,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[g.jsx(hK,{size:18,className:"text-gray-500"}),g.jsx("span",{children:"Instellingen"})]})}),g.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function qK(){const{infoPanelOpen:n,toggleInfoPanel:e}=Un(),[t,i]=K.useState("info"),r=[{id:"info",label:"Info",icon:g.jsx(WD,{size:14})},{id:"functies",label:"Functies",icon:g.jsx(TH,{size:14})},{id:"handleiding",label:"Handleiding",icon:g.jsx(Y$,{size:14})}];return g.jsx(Xt,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(ke.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(ke.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600",children:[g.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-orange-400/50 hover:bg-orange-400 transition-colors border-0 outline-none",children:g.jsx(An,{size:18,className:"text-white",strokeWidth:2.5})})]}),g.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>g.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-orange-600 border-b-2 border-orange-600 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&g.jsx(XK,{}),t==="functies"&&g.jsx(YK,{}),t==="handleiding"&&g.jsx(ZK,{}),g.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:g.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function XK(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),g.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),g.jsxs("ul",{className:"space-y-2 text-gray-600",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),g.jsxs("div",{className:"text-gray-600 space-y-2",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function YK(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Ry,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Js,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Registreer soort, gewicht en lengte"}),g.jsx("li",{children:"Vismethode en aas bijhouden"}),g.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),g.jsx("li",{children:"GPS locatie per vangst"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(ir,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Markeer je beste visplekken"}),g.jsx("li",{children:"Voeg notities en ratings toe"}),g.jsx("li",{children:"Welke vis zit waar?"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(ef,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Live weergegevens op je locatie"}),g.jsx("li",{children:"Windsnelheid en richting"}),g.jsx("li",{children:"Luchtdruk"}),g.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Du,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Live GPS tracking"}),g.jsx("li",{children:"Zoek adressen en plaatsen"}),g.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function ZK(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),g.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[g.jsxs("li",{children:["Tik op de ",g.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),g.jsxs("li",{children:["Gebruik het ",g.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),g.jsxs("li",{children:["Tik op de ",g.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Gebruik de ",g.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),g.jsxs("li",{children:["Check de ",g.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),g.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),g.jsxs("li",{children:["Markeer succesvolle plekken als ",g.jsx("strong",{children:"favoriet"})]})]})]})]})}const QK=pl([5.1214,52.0907]),JK=8;function eq(){const n=gs(r=>r.map),e=Xi(r=>r.setLayerVisibility),t=zn(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:QK,zoom:JK,rotation:0,duration:500})};return g.jsx(ke.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:g.jsx(nK,{size:18,className:"text-gray-600"})})}const tq={Map:Ry,Fish:Js,Anchor:FD,Layers:nf,Star:Av},nq={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},iq={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function rq(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=cz(),[r,s]=K.useState(!1),[o,l]=K.useState(null),[u,h]=K.useState(!1),[f,p]=K.useState(""),_=I=>{e(I),s(!1)},v=(I,w)=>{I.stopPropagation();const{useLayerStore:R}=require("../../store"),M=R.getState().visible,D=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(L=>M[L]);t(w,{layers:D}),l(w),setTimeout(()=>l(null),2e3)},S=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return g.jsxs(g.Fragment,{children:[g.jsx(ke.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?g.jsx(zD,{size:20,className:"text-orange-600"}):g.jsx(nf,{size:20,className:"text-gray-600"})}),g.jsx(Xt,{children:r&&g.jsxs(g.Fragment,{children:[g.jsx(ke.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),g.jsxs(ke.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[g.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-orange-500 to-orange-600",children:g.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),g.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const w=tq[I.icon]||nf,R=nq[I.icon]||"text-blue-600",M=iq[I.icon]||"hover:bg-blue-50",D=o===I.id;return g.jsxs("button",{onClick:()=>_(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${M} rounded text-left transition-colors border-0 outline-none bg-transparent ${D?"bg-green-50":""}`,children:[g.jsx(w,{size:16,className:`${R} flex-shrink-0`}),g.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),D?g.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:g.jsx(Rp,{size:14,className:"text-green-500"})}):g.jsx("span",{onClick:L=>v(L,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:g.jsx(oK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),g.jsx("div",{className:"border-t border-gray-200 p-2",children:u?g.jsxs("div",{className:"flex gap-1",children:[g.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),onKeyDown:I=>{I.key==="Enter"&&S(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-orange-400"}),g.jsx("button",{onClick:S,disabled:!f.trim(),className:"px-2 py-1 bg-orange-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):g.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",children:[g.jsx(JH,{size:14}),g.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const vd={lat:52.1326,lng:5.2913},sq={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijpmist",51:"Lichte motregen",53:"Motregen",55:"Zware motregen",61:"Lichte regen",63:"Regen",65:"Zware regen",71:"Lichte sneeuw",73:"Sneeuw",75:"Zware sneeuw",80:"Lichte buien",81:"Buien",82:"Zware buien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer"};function qD({code:n,size:e=18}){return n===0?g.jsx(_K,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?g.jsx(ef,{size:e,className:"text-gray-400"}):n===45||n===48?g.jsx(cH,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?g.jsx(Pl,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?g.jsx(gH,{size:e,className:"text-cyan-500"}):n>=95?g.jsx(hH,{size:e,className:"text-purple-500"}):g.jsx(ef,{size:e,className:"text-gray-400"})}function oq({degrees:n,size:e=14}){return g.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:g.jsx(Du,{size:e,className:"text-blue-500"})})}function aq({size:n=16,className:e=""}){return g.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[g.jsx("path",{d:"M2 12h16"}),g.jsx("path",{d:"M18 12l4-4"}),g.jsx("path",{d:"M18 12l4 4"}),g.jsx("circle",{cx:"3",cy:"12",r:"1.5",fill:"currentColor"}),g.jsx("path",{d:"M6 12l1.5-3"}),g.jsx("path",{d:"M6 12l1.5 3"}),g.jsx("path",{d:"M10 12l1.5-3"}),g.jsx("path",{d:"M10 12l1.5 3"}),g.jsx("path",{d:"M14 12l1.5-2.5"}),g.jsx("path",{d:"M14 12l1.5 2.5"})]})}function kv({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return g.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[g.jsx("defs",{children:g.jsx("clipPath",{id:i,children:g.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),g.jsxs("g",{clipPath:`url(#${i})`,children:[g.jsx("ellipse",{cx:"12",cy:"12",rx:"8",ry:"5"}),g.jsx("path",{d:"M3 12L0 7V17L3 12Z"}),g.jsx("circle",{cx:"17",cy:"10.5",r:"1.2",fill:"white"}),g.jsx("circle",{cx:"17.3",cy:"10.5",r:"0.5",fill:"black"}),g.jsx("path",{d:"M10 7L12 4L14 7",fill:"currentColor"}),g.jsx("path",{d:"M11 17L12 19L13 17",fill:"currentColor"})]})]})}function XD({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1,s=[];for(let o=0;o<i&&o<e;o++)s.push(g.jsx(kv,{size:18,className:t},o));return r>=.5&&i<e&&s.push(g.jsx(kv,{size:18,className:t,clipPercent:60},"half")),g.jsx("div",{className:"flex items-center gap-1",children:s.length>0?s:g.jsx(aq,{size:18,className:t})})}function Nv(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function lq(n){return n<.03||n>.97?"Nieuwe maan":n<.22?"Wassende sikkel":n<.28?"Eerste kwartier":n<.47?"Wassende maan":n<.53?"Volle maan":n<.72?"Afnemende maan":n<.78?"Laatste kwartier":"Afnemende sikkel"}const cq="https://svs.gsfc.nasa.gov/vis/a000000/a004700/a004720/lroc_color_poles_1k.jpg";function uq({phase:n,size:e=20}){const t=n<=.5?n*2:(1-n)*2,i=n<.5;let r;return n<=.5?r=1-n*4:r=(n-.5)*4-1,r=Math.max(-1,Math.min(1,r)),g.jsxs("div",{className:"relative rounded-full overflow-hidden",style:{width:e,height:e,boxShadow:`0 ${e*.05}px ${e*.15}px rgba(0,0,0,0.4)`},children:[g.jsx("div",{className:"absolute inset-0 rounded-full",style:{backgroundImage:`url(${cq})`,backgroundSize:"cover",backgroundPosition:"center",filter:"contrast(1.1) brightness(1.05)"}}),g.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`
            radial-gradient(circle at 30% 25%, rgba(200,200,190,0.4) 0%, transparent 25%),
            radial-gradient(circle at 70% 60%, rgba(180,180,170,0.3) 0%, transparent 20%),
            radial-gradient(circle at 45% 75%, rgba(160,160,150,0.3) 0%, transparent 15%),
            radial-gradient(circle at 60% 30%, rgba(170,170,160,0.25) 0%, transparent 18%),
            radial-gradient(circle at 25% 55%, rgba(190,190,180,0.2) 0%, transparent 12%),
            linear-gradient(135deg, #d4d4c8 0%, #a8a89c 50%, #8c8c80 100%)
          `,mixBlendMode:"overlay"}}),g.jsxs("svg",{className:"absolute inset-0",viewBox:"0 0 100 100",style:{width:e,height:e},children:[g.jsx("defs",{children:g.jsxs("linearGradient",{id:`moonShadow-${e}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[g.jsx("stop",{offset:"0%",stopColor:"rgba(5,5,15,0.97)"}),g.jsx("stop",{offset:"40%",stopColor:"rgba(5,5,15,0.95)"}),g.jsx("stop",{offset:"100%",stopColor:"rgba(5,5,15,0)"})]})}),n<.03||n>.97?g.jsx("circle",{cx:"50",cy:"50",r:"50",fill:"rgba(5,5,15,0.95)"}):n>.47&&n<.53?null:g.jsx("ellipse",{cx:50+r*50,cy:"50",rx:Math.abs(50*(1-Math.abs(r*.8))),ry:"50",fill:"rgba(5,5,15,0.95)",style:{transform:"none"}})]}),t>.1&&g.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none",style:{background:i?`radial-gradient(circle at ${85-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`:`radial-gradient(circle at ${15-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`}})]})}function hq(n){const e=Nv(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=(i+12)%24,l=[i,o],u=[r,s];let h=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(h+=.3),l.forEach(f=>{const p=Math.abs(t-f);p<=1||p>=23?h+=.3:(p<=2||p>=22)&&(h+=.15)}),u.forEach(f=>{Math.abs(t-f)<=1&&(h-=.1)}),{activity:Math.max(.1,Math.min(1,h)),besteTijden:l,slechteTijden:u}}function dq(n){return n<.1||n>.9||n>.4&&n<.6?{type:"Springtij",color:"text-green-600"}:n>.2&&n<.3||n>.7&&n<.8?{type:"Doodtij",color:"text-orange-600"}:{type:"Normaal",color:"text-blue-600"}}function YD(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),s=745;for(let o=0;o<e;o++){const l=new Date(n);l.setDate(l.getDate()+o),l.setHours(0,0,0,0);const h=(l.getTime()-r.getTime())/(1e3*60*60*24)%i/i;let f=h*s*2%1440;for(let p=0;p<4;p++){const _=p%2===0,v=p*(s/2);let S=f+v;const I=Math.floor(S/1440);S=S%1440;const w=Math.floor(S/60),R=Math.floor(S%60),M=new Date(l);M.setDate(M.getDate()+I),M.setHours(w,R,0,0);const D=Math.abs(Math.sin(h*Math.PI*2)),L=_?1.8:.4,N=D*.5;t.push({time:M,height:_?L+N:L-N*.5,type:_?"high":"low"})}}return t.sort((o,l)=>o.time.getTime()-l.time.getTime())}function fq({data:n,showHeader:e=!1}){if(!n||n.length===0)return null;const t=Math.max(...n.map(s=>s.precipitation),.5),i=n.some(s=>s.precipitation>0),r=s=>{const o=new Date(s);return`${o.getHours()}:${o.getMinutes().toString().padStart(2,"0")}`};return g.jsxs("div",{className:"space-y-1",children:[e&&g.jsx("div",{className:"flex items-center justify-between",children:g.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"})}),!i&&g.jsx("div",{className:"text-[10px] text-green-600 font-medium text-right",children:"Droog"}),g.jsxs("div",{className:"relative h-10 bg-gray-100 rounded-lg overflow-hidden",children:[g.jsx("div",{className:"absolute inset-0 flex",children:[...Array(8)].map((s,o)=>g.jsx("div",{className:"flex-1 border-r border-gray-200/50"},o))}),g.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((s,o)=>{const l=s.precipitation/t*100,u=s.precipitation>2?"bg-blue-600":s.precipitation>.5?"bg-blue-500":s.precipitation>0?"bg-blue-400":"bg-transparent";return g.jsx("div",{className:"flex-1 mx-px",title:`${r(s.time)}: ${s.precipitation.toFixed(1)} mm`,children:g.jsx("div",{className:`w-full rounded-t transition-all ${u}`,style:{height:`${Math.max(l,s.precipitation>0?8:0)}%`}})},o)})}),g.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+1u"}),g.jsx("span",{children:"+2u"})]})]}),i&&g.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-500",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-400"}),g.jsx("span",{children:"Licht"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-500"}),g.jsx("span",{children:"Matig"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-600"}),g.jsx("span",{children:"Zwaar"})]})]})]})}function gq({hourly:n}){const e=new Date,t=e.getHours(),i=n.filter(r=>new Date(r.time)>=e).slice(0,8);return i.length===0?null:g.jsxs("div",{className:"space-y-1",children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),g.jsx("div",{className:"flex gap-1 overflow-x-auto py-1 -mx-1 px-1",children:i.map((r,s)=>{const o=new Date(r.time),l=o.getHours()===t;return g.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg min-w-[36px] ${l?"bg-blue-100":"bg-gray-50"}`,children:[g.jsx("span",{className:"text-[9px] text-gray-500",children:l?"Nu":`${o.getHours()}:00`}),g.jsx(qD,{code:r.weatherCode,size:14}),g.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(r.temperature),""]}),r.precipitationProbability>20&&g.jsxs("span",{className:"text-[8px] text-blue-500",children:[r.precipitationProbability,"%"]})]},r.time)})})]})}const mq=[{name:"Amsterdam",lat:52.3676,lng:4.9041},{name:"Rotterdam",lat:51.9244,lng:4.4777},{name:"Den Haag",lat:52.0705,lng:4.3007},{name:"Utrecht",lat:52.0907,lng:5.1214},{name:"Eindhoven",lat:51.4416,lng:5.4697},{name:"Groningen",lat:53.2194,lng:6.5665},{name:"Tilburg",lat:51.5555,lng:5.0913},{name:"Almere",lat:52.3508,lng:5.2647},{name:"Breda",lat:51.5719,lng:4.7683},{name:"Nijmegen",lat:51.8126,lng:5.8372},{name:"Arnhem",lat:51.9851,lng:5.8987},{name:"Haarlem",lat:52.3874,lng:4.6462},{name:"Enschede",lat:52.2215,lng:6.8937},{name:"Zwolle",lat:52.5168,lng:6.083},{name:"Maastricht",lat:50.8514,lng:5.6909},{name:"Leiden",lat:52.1601,lng:4.497},{name:"Dordrecht",lat:51.8133,lng:4.6901},{name:"Zoetermeer",lat:52.0575,lng:4.4931},{name:"Leeuwarden",lat:53.2012,lng:5.7999},{name:"Den Bosch",lat:51.6978,lng:5.3037}];function pq({hourlyData:n,onClose:e,onLocationChange:t}){const[i,r]=K.useState(new Date),[s,o]=K.useState(""),[l,u]=K.useState(!1),[h,f]=K.useState(null),p=new Date,_=K.useMemo(()=>{const b=new Date(p);return b.setHours(b.getHours(),0,0,0),b},[]),v=K.useMemo(()=>{const b=new Date(_);return b.setHours(b.getHours()+48),b},[_]),S=v.getTime()-_.getTime(),I=(i.getTime()-_.getTime())/S*100,w=n.filter(b=>{const P=new Date(b.time);return P>=_&&P<=v}),R=mq.filter(b=>b.name.toLowerCase().includes(s.toLowerCase())).slice(0,6),M=b=>{const P=new Date;P.setHours(0,0,0,0);const j=new Date(b);j.setHours(0,0,0,0);const z=Math.floor((j.getTime()-P.getTime())/(1440*60*1e3));return z===0?"Vandaag":z===1?"Morgen":z===2?"Overmorgen":b.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},D=b=>`${b.getHours().toString().padStart(2,"0")}:00`,L=w.find(b=>{const P=new Date(b.time);return P.getHours()===i.getHours()&&P.getDate()===i.getDate()}),N=Math.max(...w.map(b=>b.precipitation),1),V=w.some(b=>b.precipitation>0),A=b=>{f(b.name),u(!1),o(""),t&&t(b.lat,b.lng,b.name)};return g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:g.jsx(ke.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:b=>b.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Pl,{size:20,className:"text-blue-500"}),g.jsx("span",{className:"font-semibold text-gray-800",children:"Neerslag 48 uur"}),!V&&g.jsx("span",{className:"text-xs text-green-600 font-medium bg-green-50 px-2 py-0.5 rounded-full",children:"Droog"})]}),g.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(An,{size:16,className:"text-gray-500"})})]}),g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>u(!l),className:"w-full flex items-center gap-2 px-3 py-2 bg-gray-50 hover:bg-gray-100 rounded-xl transition-colors border-0 outline-none text-left",children:[g.jsx(ir,{size:16,className:"text-gray-400"}),g.jsx("span",{className:"flex-1 text-sm text-gray-700",children:h||"Huidige locatie"}),g.jsx(Rv,{size:14,className:"text-gray-400"})]}),l&&g.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-xl shadow-lg border border-gray-100 z-10 overflow-hidden",children:[g.jsx("div",{className:"p-2 border-b border-gray-100",children:g.jsx("input",{type:"text",value:s,onChange:b=>o(b.target.value),placeholder:"Zoek plaats...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-blue-400",autoFocus:!0})}),g.jsxs("div",{className:"max-h-40 overflow-y-auto",children:[g.jsxs("button",{onClick:()=>{f(null),u(!1),t&&t(vd.lat,vd.lng,"Huidige locatie")},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[g.jsx(Du,{size:14,className:"text-blue-500"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Huidige locatie"})]}),R.map(b=>g.jsxs("button",{onClick:()=>A(b),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[g.jsx(ir,{size:14,className:"text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-700",children:b.name})]},b.name))]})]})]}),g.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("div",{className:"text-xs text-gray-500",children:M(i)}),g.jsx("div",{className:"text-xl font-bold text-blue-600",children:D(i)})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L?`${L.precipitation.toFixed(1)} mm`:"0 mm"}),L&&L.precipitationProbability>0&&g.jsxs("div",{className:"text-xs text-blue-500",children:[L.precipitationProbability,"% kans"]})]})]}),g.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-28",children:[g.jsx("div",{className:"absolute top-1 left-2 text-[9px] font-medium text-amber-600",children:" Nu"}),g.jsx("div",{className:"absolute inset-2 pt-3 flex items-end gap-px",children:w.map((b,P)=>{const j=b.precipitation/N*100,z=new Date(b.time),B=z.getHours()===i.getHours()&&z.getDate()===i.getDate(),O=P===0,se=b.precipitation>2?"bg-blue-600":b.precipitation>.5?"bg-blue-500":b.precipitation>0?"bg-blue-400":"bg-gray-200";return g.jsx("div",{className:"flex-1 cursor-pointer h-full flex flex-col justify-end",onClick:()=>r(z),children:g.jsx("div",{className:`w-full rounded-t transition-all ${se} ${B?"ring-2 ring-amber-400 ring-offset-1":""} ${O?"ring-1 ring-amber-500":""}`,style:{height:`${Math.max(j,b.precipitation>0?8:3)}%`}})},P)})}),g.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+24u"}),g.jsx("span",{children:"+48u"})]})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("input",{type:"range",min:"0",max:"100",value:I,onChange:b=>r(new Date(_.getTime()+parseFloat(b.target.value)/100*S)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{className:I<5?"text-amber-600 font-medium":"",children:"Nu"}),g.jsxs("span",{children:[M(i)," ",D(i)]}),g.jsx("span",{children:"+48u"})]})]}),g.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-400"}),g.jsx("span",{children:"Licht"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-500"}),g.jsx("span",{children:"Matig"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-600"}),g.jsx("span",{children:"Zwaar"})]})]})]})})})}function yq({onClose:n}){const[e,t]=K.useState(new Date),i=zn(b=>b.position),r=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664}],s=(b,P)=>{let j=r[5],z=1/0;for(const B of r){const O=Math.sqrt(Math.pow(B.lat-b,2)+Math.pow(B.lng-P,2));O<z&&(z=O,j=B)}return j},[o,l]=K.useState(()=>i?s(i.lat,i.lng):r[5]),u=new Date,h=K.useMemo(()=>{const b=new Date;return b.setDate(b.getDate()-1),b.setHours(0,0,0,0),b},[]),f=K.useMemo(()=>{const b=new Date;return b.setDate(b.getDate()+2),b.setHours(23,59,59,999),b},[]),p=K.useMemo(()=>{const b=new Date(h);return YD(b,4)},[h]),_=f.getTime()-h.getTime(),v=(e.getTime()-h.getTime())/_*100,S=b=>{if(p.length<2)return 1;let P=p[0],j=p[1];for(let me=0;me<p.length-1;me++)if(p[me].time<=b&&p[me+1].time>b){P=p[me],j=p[me+1];break}const z=j.time.getTime()-P.time.getTime(),B=b.getTime()-P.time.getTime(),O=Math.max(0,Math.min(1,B/z)),se=(1-Math.cos(O*Math.PI))/2;return P.height+(j.height-P.height)*se},I=K.useMemo(()=>{const b=[];for(let j=0;j<=200;j++){const z=new Date(h.getTime()+j/200*_),B=S(z);b.push({x:j/200*100,y:B,time:z})}return b},[h,_,p]),w=Math.min(...I.map(b=>b.y)),M=Math.max(...I.map(b=>b.y))-w||1,D=b=>{const P=new Date;P.setHours(0,0,0,0);const j=new Date(b);j.setHours(0,0,0,0);const z=Math.floor((j.getTime()-P.getTime())/(1440*60*1e3));return z===0?"Vandaag":z===1?"Morgen":z===-1?"Gisteren":b.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},L=b=>b.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),N=S(e),V=(u.getTime()-h.getTime())/_*100,A=(e.getTime()-h.getTime())/_*100;return g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsx(ke.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-md overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:b=>b.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(kl,{size:20,className:"text-blue-500"}),g.jsx("span",{className:"font-semibold text-gray-800",children:"Getijden"})]}),g.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(An,{size:16,className:"text-gray-500"})})]}),g.jsx("select",{value:o.id,onChange:b=>{const P=r.find(j=>j.id===b.target.value);P&&l(P)},className:"w-full p-2.5 border border-gray-200 rounded-xl text-sm bg-white/80 outline-none focus:ring-2 focus:ring-blue-400",children:r.map(b=>g.jsx("option",{value:b.id,children:b.name},b.id))}),g.jsxs("div",{className:"relative bg-gradient-to-b from-blue-50 to-blue-100 rounded-xl p-3 h-32",children:[g.jsxs("svg",{className:"absolute inset-3 w-[calc(100%-24px)] h-[calc(100%-24px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[g.jsx("path",{d:`M 0 100 ${I.map(b=>`L ${b.x} ${100-(b.y-w)/M*80}`).join(" ")} L 100 100 Z`,fill:"url(#waterGradient)",opacity:"0.6"}),g.jsx("path",{d:`M ${I.map(b=>`${b.x} ${100-(b.y-w)/M*80}`).join(" L ")}`,fill:"none",stroke:"#3b82f6",strokeWidth:"1.5"}),V>=0&&V<=100&&g.jsx("line",{x1:V,y1:"0",x2:V,y2:"100",stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),g.jsx("line",{x1:A,y1:"0",x2:A,y2:"100",stroke:"#ef4444",strokeWidth:"1.5"}),g.jsx("circle",{cx:A,cy:100-(N-w)/M*80,r:"3",fill:"#ef4444"}),g.jsx("defs",{children:g.jsxs("linearGradient",{id:"waterGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[g.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),g.jsx("stop",{offset:"100%",stopColor:"#93c5fd"})]})})]}),g.jsxs("div",{className:"absolute bottom-1 left-3 right-3 flex justify-between text-[9px] text-gray-500",children:[g.jsx("span",{children:D(h)}),g.jsx("span",{children:D(u)}),g.jsx("span",{children:D(f)})]}),g.jsxs("div",{className:"absolute top-2 right-3 bg-white/90 rounded-lg px-2 py-1 shadow-sm",children:[g.jsxs("div",{className:"text-[10px] text-gray-500",children:[D(e)," ",L(e)]}),g.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[N.toFixed(2),"m"]})]})]}),g.jsx("input",{type:"range",min:"0",max:"100",value:v,onChange:b=>{const P=new Date(h.getTime()+parseFloat(b.target.value)/100*_);t(P)},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{onClick:()=>t(new Date),className:"flex-1 px-3 py-2 text-sm bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none font-medium",children:"Nu"}),p.filter(b=>b.time>u).slice(0,2).map((b,P)=>g.jsxs("button",{onClick:()=>t(b.time),className:`flex-1 px-2 py-2 text-sm rounded-xl transition-colors border-0 outline-none font-medium ${b.type==="high"?"bg-green-50 hover:bg-green-100 text-green-600":"bg-red-50 hover:bg-red-100 text-red-600"}`,children:[b.type==="high"?"HW":"LW"," ",L(b.time)]},P))]}),g.jsx("div",{className:"text-[10px] text-gray-400 text-center",children:"Berekening op basis van maanstand"})]})})})}function _q({pressureHistory:n,currentPressure:e,trend:t,onClose:i}){const[r,s]=K.useState(12),o=new Date,l=n.slice(-72),u=Math.min(...l.map(w=>w.pressure),990),h=Math.max(...l.map(w=>w.pressure),1040),f=h-u||20,p=w=>{if(w>=l.length-1||w<1)return .5;const R=l[w].pressure-l[w-1].pressure,M=l[w].pressure;let D=.5;return R>.5?D+=.3:R<-.5&&(D-=.2),M>=1010&&M<=1025&&(D+=.2),M>1020&&Math.abs(R)<.3&&(D+=.2),Math.max(0,Math.min(1,D))},v=[...l.map((w,R)=>({hour:R,activity:p(R)}))].sort((w,R)=>R.activity-w.activity).slice(0,5),S=()=>t==="rising"?g.jsx(qw,{size:16,className:"text-green-500"}):t==="falling"?g.jsx(Kw,{size:16,className:"text-red-500"}):g.jsx($w,{size:16,className:"text-gray-400"}),I=()=>t==="rising"?"Stijgend - Goed voor vissen!":t==="falling"?"Dalend - Minder activiteit":"Stabiel";return g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i,children:g.jsx(ke.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:w=>w.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(BD,{size:20,className:"text-purple-500"}),g.jsx("span",{className:"font-semibold text-gray-800",children:"Luchtdruk"})]}),g.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(An,{size:16,className:"text-gray-500"})})]}),g.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-4",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[Math.round(e)," hPa"]}),g.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[S(),g.jsx("span",{className:"text-sm text-gray-600",children:I()})]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx(XD,{value:p(l.length-1)*3,color:p(l.length-1)>.7?"text-green-500":p(l.length-1)>.4?"text-amber-500":"text-red-500"}),g.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Nu"})]})]})}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:"Druk & visactiviteit (48 uur)"}),g.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-32",children:[g.jsxs("svg",{className:"absolute inset-2 w-[calc(100%-16px)] h-[calc(100%-16px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[l.slice(-48).map((w,R)=>{const M=p(l.length-48+R),D=R/47*100,L=M*30,N=M>.7?"#22c55e":M>.4?"#f59e0b":"#ef4444";return g.jsx("rect",{x:D-1,y:100-L,width:2,height:L,fill:N,opacity:"0.3"},R)}),g.jsx("path",{d:`M ${l.slice(-48).map((w,R)=>{const M=R/47*100,D=100-(w.pressure-u)/f*80;return`${M} ${D}`}).join(" L ")}`,fill:"none",stroke:"#8b5cf6",strokeWidth:"2"}),g.jsx("rect",{x:"0",y:100-(1025-u)/f*80,width:"100",height:15/f*80,fill:"#22c55e",opacity:"0.1"})]}),g.jsx("div",{className:"absolute top-1 left-2 text-[9px] text-gray-400",children:Math.round(h)}),g.jsx("div",{className:"absolute bottom-4 left-2 text-[9px] text-gray-400",children:Math.round(u)}),g.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[g.jsx("span",{children:"-48u"}),g.jsx("span",{children:"-24u"}),g.jsx("span",{children:"Nu"})]})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[g.jsx(kv,{size:12,className:"text-green-500"}),"Beste vistijden (op basis van druk)"]}),g.jsx("div",{className:"flex flex-wrap gap-1",children:v.slice(0,4).map((w,R)=>{const M=new Date(l[w.hour]?.time||o),D=M.getDate()===o.getDate();return g.jsxs("div",{className:"bg-green-50 rounded-lg px-2 py-1 text-xs",children:[g.jsxs("span",{className:"text-green-700 font-medium",children:[D?"Vandaag":"Morgen"," ",M.getHours(),":00"]}),g.jsxs("span",{className:"text-green-500 ml-1",children:[Math.round(w.activity*100),"%"]})]},R)})})]}),g.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-green-400 opacity-50"}),g.jsx("span",{children:"Actief"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-amber-400 opacity-50"}),g.jsx("span",{children:"Matig"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-8 h-3 rounded-sm bg-green-500 opacity-20"}),g.jsx("span",{children:"Optimale zone"})]})]})]})})})}function xq({onClose:n}){const[e,t]=K.useState(!0),[i,r]=K.useState(0),[s,o]=K.useState([]),l=zn(w=>w.position);K.useEffect(()=>{(async()=>{try{const M=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json();if(M.radar?.past){const D=M.radar.past.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`);M.radar?.nowcast&&D.push(...M.radar.nowcast.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`)),o(D)}}catch(R){console.error("Failed to fetch radar data:",R)}})()},[]),K.useEffect(()=>{if(!e||s.length===0)return;const w=setInterval(()=>{r(R=>(R+1)%s.length)},500);return()=>clearInterval(w)},[e,s.length]);const u=l?.lat||52.1326,h=l?.lng||5.2913,f=7,p=Math.pow(2,f),_=Math.floor((h+180)/360*p),v=Math.floor((1-Math.log(Math.tan(u*Math.PI/180)+1/Math.cos(u*Math.PI/180))/Math.PI)/2*p),S=()=>s.length===0?null:s[i]?.replace("{z}",f.toString()).replace("{x}",_.toString()).replace("{y}",v.toString()),I=()=>{if(s.length===0)return"Laden...";const R=i-12;return R<-5?`-${Math.abs(R)*5} min`:R<0?`-${Math.abs(R)*5} min`:R===0?"Nu":`+${R*5} min`};return g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsx(ke.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:w=>w.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Pl,{size:20,className:"text-blue-500"}),g.jsx("span",{className:"font-semibold text-gray-800",children:"Buienradar"})]}),g.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(An,{size:16,className:"text-gray-500"})})]}),g.jsxs("div",{className:"relative bg-gray-200 rounded-xl overflow-hidden",style:{aspectRatio:"1/1"},children:[g.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(w=>[-1,0,1].map(R=>g.jsx("img",{src:`https://tile.openstreetmap.org/${f}/${_+R}/${v+w}.png`,alt:"",className:"w-full h-full object-cover",style:{filter:"saturate(0.3) brightness(1.1)"}},`${R}-${w}`)))}),S()&&g.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(w=>[-1,0,1].map(R=>g.jsx("img",{src:s[i]?.replace("{z}",f.toString()).replace("{x}",(_+R).toString()).replace("{y}",(v+w).toString()),alt:"",className:"w-full h-full object-cover",style:{mixBlendMode:"multiply"}},`radar-${R}-${w}`)))}),g.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-sm font-medium",children:I()}),g.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:g.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow-lg"})})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:i,onChange:w=>{t(!1),r(parseInt(w.target.value))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{children:"-1 uur"}),g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+30 min"})]})]}),g.jsx("div",{className:"flex items-center justify-center gap-3",children:g.jsxs("button",{onClick:()=>t(!e),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none",children:[e?g.jsx(KH,{size:16}):g.jsx(ZH,{size:16}),g.jsx("span",{className:"text-sm font-medium",children:e?"Pauzeren":"Afspelen"})]})}),g.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] text-gray-500",children:[g.jsx("span",{children:"Licht"}),g.jsxs("div",{className:"flex h-2",children:[g.jsx("div",{className:"w-4 bg-blue-200 rounded-l"}),g.jsx("div",{className:"w-4 bg-blue-400"}),g.jsx("div",{className:"w-4 bg-blue-600"}),g.jsx("div",{className:"w-4 bg-purple-600"}),g.jsx("div",{className:"w-4 bg-red-500 rounded-r"})]}),g.jsx("span",{children:"Zwaar"})]})]})})})}function vq(){const{current:n,loading:e,fetchWeather:t,getFishingScore:i,pressureHistory:r,getPressureTrend:s,hourlyForecast:o,precipitation15min:l}=ek(),u=zn(X=>X.position),h=qe(X=>X.showWeatherWidget),{waterData:f,station:p,fetchData:_}=z2(),[v,S]=K.useState(!1),[I,w]=K.useState(!1),[R,M]=K.useState(!1),[D,L]=K.useState(0),[N,V]=K.useState(!1),[A,b]=K.useState(!1);K.useEffect(()=>{const X=u||vd;t(X.lat,X.lng),_()},[]),K.useEffect(()=>{u&&t(u.lat,u.lng)},[u,t]),K.useEffect(()=>{const X=u||vd,ne=setInterval(()=>{t(X.lat,X.lng),_()},600*1e3);return()=>clearInterval(ne)},[u,t,_]);const P=new Date;Nv(P);const j=hq(P),B=K.useMemo(()=>{const X=new Date;return X.setHours(0,0,0,0),YD(X,2)},[]).filter(X=>X.time>P).slice(0,4),O=i?i():1,se=Math.min(3,O/2+j.activity*1.5),me=X=>X>=2.5?"text-green-500":X>=1.5?"text-lime-500":X>=.8?"text-amber-500":"text-red-500",pe=X=>X>=2.5?"Uitstekend":X>=1.5?"Goed":X>=.8?"Matig":"Slecht",ue=X=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(X/45)%8],H=X=>X.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return h?g.jsxs(g.Fragment,{children:[v&&g.jsx("div",{className:"fixed inset-0 z-[1499]",onClick:()=>S(!1)}),g.jsxs(ke.div,{className:"fixed left-2 z-[1500] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:v?{top:"0.5rem",bottom:"0.5rem",width:"220px",overflowY:"auto"}:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[e&&!n?g.jsxs("div",{className:"p-3 flex items-center gap-2",children:[g.jsx(Hw,{size:16,className:"animate-spin text-blue-500"}),g.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):n?g.jsxs("div",{className:"p-2.5",children:[g.jsxs("button",{onClick:()=>S(!v),className:"w-full border-0 outline-none bg-transparent p-0",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(qD,{code:n.weatherCode,size:24}),g.jsx("div",{className:"flex flex-col leading-tight",children:g.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(n.temperature),""]})})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(Pv,{size:14,className:"text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-600",children:Math.round(n.windSpeed)}),g.jsx(oq,{degrees:n.windDirection,size:12})]}),g.jsx("div",{className:"ml-auto",children:v?g.jsx(zD,{size:16,className:"text-gray-400"}):g.jsx(rH,{size:16,className:"text-gray-400"})})]}),g.jsxs("div",{className:"flex items-center gap-2 mt-1.5 pt-1.5 border-t border-gray-200/50",children:[g.jsx(XD,{value:se,color:me(se)}),g.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full transition-all ${se>=2.5?"bg-green-500":se>=1.5?"bg-lime-500":se>=.8?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(se/3*100,5)}%`}})}),g.jsx("span",{className:`text-[10px] font-medium ${me(se)}`,children:pe(se)})]})]}),g.jsx(Xt,{children:v&&g.jsx(ke.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:g.jsxs("div",{className:"pt-3 mt-2 border-t border-gray-200/50 space-y-3",children:[g.jsx("div",{className:"text-xs text-gray-600",children:sq[n.weatherCode]||"Onbekend"}),(()=>{const X=new Date;X.setDate(X.getDate()+D);const ne=Nv(X),W=dq(ne),G=D===0?"Vandaag":D===1?"Morgen":D===-1?"Gisteren":X.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"});return g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-3",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(uq,{phase:ne,size:40}),g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"text-gray-800 text-sm font-medium",children:lq(ne)}),g.jsxs("div",{className:"text-gray-500 text-[10px]",children:[Math.round(ne*100),"% verlicht"]}),g.jsx("div",{className:`text-[10px] font-medium ${W.color}`,children:W.type})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-xs text-gray-600",children:G}),D!==0&&g.jsx("button",{onClick:()=>L(0),className:"text-[10px] text-blue-500 hover:underline border-0 bg-transparent p-0 outline-none",children:"Vandaag"})]})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("input",{type:"range",min:"-14",max:"14",value:D,onChange:re=>L(parseInt(re.target.value)),className:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{children:"-14d"}),g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+14d"})]})]})]})})(),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[g.jsx("span",{className:"text-gray-500",children:"Maanactiviteit"}),g.jsxs("span",{className:"text-gray-600",children:[Math.round(j.activity*100),"%"]})]}),g.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full transition-all ${j.activity>=.7?"bg-green-500":j.activity>=.5?"bg-lime-500":j.activity>=.3?"bg-amber-500":"bg-red-400"}`,style:{width:`${j.activity*100}%`}})})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(tf,{size:14,className:"text-cyan-500"}),g.jsx("select",{value:p?.id||"",onChange:X=>{X.stopPropagation();const ne=Jd.find(W=>W.id===X.target.value);if(ne){const{setStation:W,fetchData:G}=z2.getState();W(ne),setTimeout(()=>G(),50)}},className:"flex-1 px-2 py-1 text-xs border border-gray-200 rounded-lg bg-white/80 outline-none focus:ring-1 focus:ring-cyan-400",children:Jd.map(X=>g.jsx("option",{value:X.id,children:X.name},X.id))})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f?.temperature!==void 0&&g.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(GD,{size:12,className:"text-cyan-500"}),g.jsx("span",{children:"Water"})]}),g.jsxs("div",{className:"text-sm font-bold text-cyan-600",children:[f.temperature.toFixed(1),"C"]})]}),f?.waveHeight!==void 0&&g.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(kl,{size:12,className:"text-blue-500"}),g.jsx("span",{children:"Golven"})]}),g.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[f.waveHeight," cm"]})]}),f?.currentSpeed!==void 0&&g.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(Du,{size:12,className:"text-green-500"}),g.jsx("span",{children:"Stroming"})]}),g.jsxs("div",{className:"text-sm font-bold text-green-600",children:[f.currentSpeed," cm/s"]})]}),f?.currentDirection!==void 0&&g.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(Du,{size:12,className:"text-purple-500",style:{transform:`rotate(${f.currentDirection}deg)`}}),g.jsx("span",{children:"Richting"})]}),g.jsxs("div",{className:"text-sm font-bold text-purple-600",children:[Math.round(f.currentDirection),""]})]})]})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[g.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[g.jsx(Pv,{size:12,className:"text-gray-400"}),g.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",ue(n.windDirection)]})]}),g.jsxs("button",{onClick:()=>V(!0),className:"flex items-center gap-1.5 text-gray-600 hover:bg-purple-50 rounded-lg p-1 -m-1 transition-colors border-0 bg-transparent cursor-pointer",children:[g.jsx(BD,{size:12,className:"text-purple-500"}),g.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const X=s();return X==="rising"?g.jsx(qw,{size:12,className:"text-green-500"}):X==="falling"?g.jsx(Kw,{size:12,className:"text-red-500"}):g.jsx($w,{size:12,className:"text-gray-400"})})(),g.jsx(Xo,{size:10,className:"text-gray-400 ml-auto"})]})]}),g.jsxs("button",{onClick:()=>b(!0),className:"w-full flex items-center gap-2 p-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors border-0 cursor-pointer",children:[g.jsx(Pl,{size:16,className:"text-blue-500"}),g.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Buienradar"}),g.jsx("span",{className:"text-xs text-blue-500 ml-auto",children:"Live kaart"}),g.jsx(Xo,{size:14,className:"text-blue-400"})]}),l.length>0&&g.jsx("button",{onClick:()=>M(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:g.jsxs("div",{className:"hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"}),g.jsx(Xo,{size:12,className:"text-gray-400"})]}),g.jsx(fq,{data:l})]})}),o.length>0&&g.jsx(gq,{hourly:o}),B.length>0&&g.jsx("button",{onClick:()=>w(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:g.jsxs("div",{className:"space-y-1 hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[g.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(kl,{size:12}),g.jsx("span",{children:"Volgende getijden"})]}),g.jsx(Xo,{size:12,className:"text-gray-400"})]}),g.jsx("div",{className:"flex gap-1",children:B.map((X,ne)=>g.jsxs("div",{className:`flex-1 p-1.5 rounded text-center ${X.type==="high"?"bg-green-50":"bg-red-50"}`,children:[g.jsx("div",{className:`text-[9px] font-medium ${X.type==="high"?"text-green-600":"text-red-600"}`,children:X.type==="high"?"HW":"LW"}),g.jsx("div",{className:"text-[10px] font-medium",children:H(X.time)})]},ne))})]})}),p&&g.jsxs("div",{className:"text-[9px] text-gray-400 text-center",children:["Waterdata: ",p.name]})]})})})]}):g.jsxs("button",{onClick:()=>{const X=u||vd;t(X.lat,X.lng)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[g.jsx(ef,{size:18,className:"text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]}),g.jsx(Xt,{children:I&&g.jsx(yq,{onClose:()=>w(!1)})}),g.jsx(Xt,{children:R&&o.length>0&&g.jsx(pq,{hourlyData:o,onClose:()=>M(!1)})}),g.jsx(Xt,{children:N&&n&&g.jsx(_q,{pressureHistory:r,currentPressure:n.pressure,trend:s(),onClose:()=>V(!1)})}),g.jsx(Xt,{children:A&&g.jsx(xq,{onClose:()=>b(!1)})})]})]}):null}const Ap=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664},{id:"TEXEL",name:"Texel",lat:53.0044,lng:4.7819},{id:"TERNEUZN",name:"Terneuzen",lat:51.3356,lng:3.8283}];function wq(n,e,t){const i=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5),r=-23.45*Math.cos(360/365*(i+10)*Math.PI/180),s=e*Math.PI/180,o=r*Math.PI/180,l=Math.acos(-Math.tan(s)*Math.tan(o))*180/Math.PI,u=12-t/15+1,h=u-l/15,f=u+l/15,p=new Date(n);p.setHours(Math.floor(h),Math.floor(h%1*60),0,0);const _=new Date(n);return _.setHours(Math.floor(f),Math.floor(f%1*60),0,0),{sunrise:p,sunset:_}}function Eq(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),s=e.lng/15*60,o=745,l=new Date(n);l.setHours(0,0,0,0);const h=(l.getTime()-r.getTime())/(1e3*60*60*24)%i/i;let f=h*o*2%1440;f=(f+s)%1440,f>360&&(f-=o/2);for(let p=-1;p<5;p++){const _=p%2===0,v=p*(o/2);let S=f+v;const I=Math.floor(S/60),w=Math.floor(S%60),R=new Date(l);R.setHours(I,w,0,0);const M=Math.abs(Math.sin(h*Math.PI*2)),D=_?1.8:.4,L=M*.5;t.push({time:R,height:_?D+L:D-L*.5,type:_?"high":"low"})}return t.sort((p,_)=>p.time.getTime()-_.time.getTime())}function Tq(n,e){let t=Ap[5],i=1/0;for(const r of Ap){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}function ZD(n,e){if(e.length<2)return 1;let t=e[0],i=e[1];for(let u=0;u<e.length-1;u++)if(e[u].time<=n&&e[u+1].time>n){t=e[u],i=e[u+1];break}const r=i.time.getTime()-t.time.getTime(),s=n.getTime()-t.time.getTime(),o=Math.max(0,Math.min(1,s/r)),l=(1-Math.cos(o*Math.PI))/2;return t.height+(i.height-t.height)*l}function Sq({embedded:n=!1}){const[e,t]=K.useState(!1),[i,r]=K.useState(Ap[5]),[s,o]=K.useState(new Date),[l,u]=K.useState(!1),h=zn(V=>V.position),f=qe(V=>V.showTideWidget);K.useEffect(()=>{h&&r(Tq(h.lat,h.lng))},[h]);const p=K.useMemo(()=>Eq(s,i),[s,i]),_=K.useMemo(()=>wq(s,i.lat,i.lng),[s,i]);if(!f&&!n)return null;const v=new Date,S=ZD(v,p),I=p.find(V=>V.time>v),w=()=>{const V=new Date(s);V.setDate(V.getDate()-1),o(V)},R=()=>{const V=new Date(s);V.setDate(V.getDate()+1),o(V)},M=()=>{o(new Date)},D=V=>{const A=new Date;A.setHours(0,0,0,0);const b=new Date(V);b.setHours(0,0,0,0);const P=Math.floor((b.getTime()-A.getTime())/(1440*60*1e3));return P===0?"Vandaag":P===1?"Morgen":P===-1?"Gisteren":V.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"})},L=V=>V.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),N=()=>{const V=new Date;return s.toDateString()===V.toDateString()};return g.jsxs(g.Fragment,{children:[g.jsxs(ke.button,{className:`${n?"":"fixed top-28 right-2 z-[700]"} bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none`,onClick:()=>t(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[g.jsx(kl,{size:18,className:"text-blue-500"}),g.jsxs("div",{className:"text-left",children:[g.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[80px]",children:i.name}),g.jsxs("div",{className:"text-xs font-medium text-blue-600",children:[S.toFixed(1),"m",I&&g.jsx("span",{className:"text-gray-400 ml-1",children:I.type==="high"?"":""})]})]})]}),g.jsx(Xt,{children:e&&g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>t(!1),children:g.jsxs(ke.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:V=>V.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-cyan-500",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(kl,{size:20,className:"text-white"}),g.jsx("span",{className:"font-semibold text-white",children:"Getijden"})]}),g.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:g.jsx(An,{size:20,className:"text-white"})})]}),g.jsxs("div",{className:"p-4 space-y-4",children:[g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>u(!l),className:"w-full flex items-center gap-2 p-2.5 bg-gray-50 rounded-lg text-left border-0 outline-none hover:bg-gray-100 transition-colors",children:[g.jsx(ir,{size:16,className:"text-blue-500"}),g.jsx("span",{className:"flex-1 text-sm font-medium text-gray-700",children:i.name}),g.jsx(Xo,{size:16,className:`text-gray-400 transition-transform ${l?"rotate-90":""}`})]}),g.jsx(Xt,{children:l&&g.jsx(ke.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 z-10 max-h-48 overflow-y-auto",children:Ap.map(V=>g.jsx("button",{onClick:()=>{r(V),u(!1)},className:`w-full px-3 py-2 text-left text-sm hover:bg-blue-50 border-0 outline-none transition-colors ${V.id===i.id?"bg-blue-50 text-blue-600 font-medium":"text-gray-700"}`,children:V.name},V.id))})})]}),g.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-2",children:[g.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none bg-transparent",children:g.jsx(VD,{size:20,className:"text-gray-600"})}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Q$,{size:16,className:"text-gray-500"}),g.jsx("span",{className:"font-medium text-gray-700",children:D(s)}),!N()&&g.jsx("button",{onClick:M,className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-600 rounded-full border-0 outline-none hover:bg-blue-200 transition-colors",children:"Vandaag"})]}),g.jsx("button",{onClick:R,className:"p-2 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none bg-transparent",children:g.jsx(Xo,{size:20,className:"text-gray-600"})})]}),g.jsx(Iq,{tides:p,sunTimes:_,selectedDate:s,isToday:N()}),g.jsx("div",{className:"grid grid-cols-4 gap-2",children:p.filter(V=>{const A=new Date(s);A.setHours(0,0,0,0);const b=new Date(s);return b.setHours(23,59,59,999),V.time>=A&&V.time<=b}).slice(0,4).map((V,A)=>g.jsxs("div",{className:`p-2.5 rounded-lg text-center ${V.type==="high"?"bg-emerald-50 border border-emerald-200":"bg-red-50 border border-red-200"}`,children:[g.jsx("div",{className:`text-xs font-bold ${V.type==="high"?"text-emerald-600":"text-red-500"}`,children:V.type==="high"?"HW":"LW"}),g.jsx("div",{className:"text-sm font-semibold text-gray-800",children:L(V.time)}),g.jsxs("div",{className:"text-xs text-gray-500",children:[V.height.toFixed(2),"m"]})]},A))}),g.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-amber-50 to-blue-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(vK,{size:18,className:"text-amber-500"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:"Zonsopkomst"}),g.jsx("div",{className:"text-sm font-medium text-gray-700",children:L(_.sunrise)})]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(EK,{size:18,className:"text-orange-500"}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:"Zonsondergang"}),g.jsx("div",{className:"text-sm font-medium text-gray-700",children:L(_.sunset)})]})]})]}),g.jsx("div",{className:"text-xs text-gray-400 text-center",children:"Bron: berekening gebaseerd op maanstand  Alleen ter indicatie"})]})]})})})]})}function Iq({tides:n,sunTimes:e,selectedDate:t,isToday:i}){const o={top:15,right:10,bottom:25,left:35},l=360-o.left-o.right,u=140-o.top-o.bottom,h=new Date(t);h.setHours(0,0,0,0);const f=new Date(t);f.setHours(24,0,0,0);const p=f.getTime()-h.getTime(),_=new Date,v=o.left+(e.sunrise.getTime()-h.getTime())/p*l,S=o.left+(e.sunset.getTime()-h.getTime())/p*l,I=[],w=96;for(let N=0;N<=w;N++){const V=new Date(h.getTime()+N/w*p),A=ZD(V,n),b=o.left+N/w*l,P=o.top+u-(A-0)/2.5*u;I.push({x:b,y:P,time:V,height:A})}const R=I.map((N,V)=>`${V===0?"M":"L"} ${N.x.toFixed(1)} ${N.y.toFixed(1)}`).join(" "),M=i?o.left+(_.getTime()-h.getTime())/p*l:-100,D=i?I.find(N=>Math.abs(N.time.getTime()-_.getTime())<900*1e3):null,L=[0,6,12,18,24];return g.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:g.jsxs("svg",{width:360,height:140,className:"w-full",children:[g.jsx("rect",{x:o.left,y:o.top,width:Math.max(0,v-o.left),height:u,fill:"rgba(99, 102, 241, 0.08)"}),g.jsx("rect",{x:S,y:o.top,width:Math.max(0,360-o.right-S),height:u,fill:"rgba(99, 102, 241, 0.08)"}),g.jsx("rect",{x:v,y:o.top,width:Math.max(0,S-v),height:u,fill:"rgba(251, 191, 36, 0.08)"}),[0,.5,1,1.5,2,2.5].map(N=>{const V=o.top+u-(N-0)/2.5*u;return g.jsxs("g",{children:[g.jsx("line",{x1:o.left,y1:V,x2:360-o.right,y2:V,stroke:N===0?"#d1d5db":"#e5e7eb",strokeWidth:N===0?1.5:1}),g.jsx("text",{x:o.left-5,y:V+3,fontSize:"9",fill:"#9ca3af",textAnchor:"end",children:N.toFixed(1)})]},N)}),L.map(N=>{const V=o.left+N/24*l;return g.jsxs("g",{children:[g.jsx("line",{x1:V,y1:o.top,x2:V,y2:140-o.bottom,stroke:"#e5e7eb",strokeWidth:"1"}),g.jsxs("text",{x:V,y:132,fontSize:"10",fill:"#6b7280",textAnchor:"middle",children:[N.toString().padStart(2,"0"),":00"]})]},N)}),g.jsx("line",{x1:v,y1:o.top,x2:v,y2:140-o.bottom,stroke:"#fbbf24",strokeWidth:"1.5",strokeDasharray:"4,2"}),g.jsx("line",{x1:S,y1:o.top,x2:S,y2:140-o.bottom,stroke:"#f97316",strokeWidth:"1.5",strokeDasharray:"4,2"}),g.jsx("path",{d:R,fill:"none",stroke:"#0ea5e9",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.filter(N=>N.time>=h&&N.time<=f).map((N,V)=>{const A=o.left+(N.time.getTime()-h.getTime())/p*l,b=o.top+u-(N.height-0)/2.5*u;return g.jsx("g",{children:g.jsx("circle",{cx:A,cy:b,r:"5",fill:N.type==="high"?"#10b981":"#ef4444",stroke:"white",strokeWidth:"2"})},V)}),i&&M>=o.left&&M<=360-o.right&&g.jsxs(g.Fragment,{children:[g.jsx("line",{x1:M,y1:o.top,x2:M,y2:140-o.bottom,stroke:"#8b5cf6",strokeWidth:"2"}),D&&g.jsx("circle",{cx:M,cy:D.y,r:"6",fill:"#8b5cf6",stroke:"white",strokeWidth:"2"}),g.jsx("rect",{x:M-12,y:o.top-12,width:"24",height:"14",rx:"3",fill:"#8b5cf6"}),g.jsx("text",{x:M,y:o.top-2,fontSize:"8",fill:"white",textAnchor:"middle",fontWeight:"bold",children:"NU"})]}),g.jsx("text",{x:8,y:o.top+u/2,fontSize:"9",fill:"#9ca3af",textAnchor:"middle",transform:`rotate(-90, 8, ${o.top+u/2})`,children:"meter"})]})})}const bq={lat:52.1326,lng:5.2913};function Cq({embedded:n=!1}){const[e,t]=K.useState(!1),[i,r]=K.useState(!1),[s,o]=K.useState(null),l=zn(N=>N.position),u=qe(N=>N.showBuienradarWidget),h=l||bq,f=()=>`https://image.buienradar.nl/2.0/image/single/RadarMapRainNL?height=512&width=512&timestamp=${Math.floor(Date.now()/3e5)*3e5}`,p=()=>`https://gpsgadget.buienradar.nl/data/raintext/?lat=${h.lat.toFixed(2)}&lon=${h.lng.toFixed(2)}`,[_,v]=K.useState(f()),[S,I]=K.useState([]),w=async()=>{r(!0);try{const N=await fetch(p());if(N.ok){const b=(await N.text()).trim().split(`
`).map(P=>{const[j,z]=P.split("|");return{time:z?.trim()||"",value:parseInt(j)||0}}).filter(P=>P.time);I(b),o(new Date)}}catch(N){console.error("Failed to fetch precipitation data:",N)}r(!1)};if(K.useEffect(()=>{e&&(w(),v(f()))},[e,h.lat,h.lng]),K.useEffect(()=>{if(!e)return;const N=setInterval(()=>{w(),v(f())},300*1e3);return()=>clearInterval(N)},[e]),!u&&!n)return null;const R=S.some(N=>N.value>0),M=Math.max(...S.map(N=>N.value),0),D=N=>N===0?"Droog":N<77?"Licht":N<166?"Matig":"Zwaar",L=N=>N===0?"text-green-500":N<77?"text-blue-400":N<166?"text-blue-600":"text-blue-800";return g.jsxs(g.Fragment,{children:[g.jsxs(ke.button,{className:`${n?"":"fixed top-40 right-2 z-[700]"} bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none`,onClick:()=>t(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[g.jsx(Pl,{size:18,className:R?"text-blue-500":"text-gray-400"}),g.jsxs("div",{className:"text-left",children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:"Buienradar"}),g.jsx("div",{className:`text-xs font-medium ${L(M)}`,children:D(M)})]})]}),g.jsx(Xt,{children:e&&g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>t(!1),children:g.jsxs(ke.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:N=>N.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-indigo-600",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Pl,{size:20,className:"text-white"}),g.jsx("span",{className:"font-semibold text-white",children:"Buienradar"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:()=>{w(),v(f())},className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",disabled:i,children:g.jsx(Hw,{size:18,className:`text-white ${i?"animate-spin":""}`})}),g.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:g.jsx(An,{size:20,className:"text-white"})})]})]}),g.jsxs("div",{className:"p-4 space-y-4",children:[g.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[g.jsx(ir,{size:14,className:"text-blue-500"}),g.jsx("span",{children:l?"Jouw locatie":"Nederland (centrum)"}),g.jsxs("span",{className:"text-gray-400 text-xs",children:["(",h.lat.toFixed(2),"N, ",h.lng.toFixed(2),"E)"]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Neerslag komende 2 uur"}),S.length>0?g.jsx(Rq,{data:S}):g.jsx("div",{className:"h-20 flex items-center justify-center text-gray-400 text-sm",children:i?"Laden...":"Geen data beschikbaar"})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Radar Nederland"}),g.jsx("div",{className:"relative rounded-lg overflow-hidden bg-gray-200",style:{paddingBottom:"100%"},children:g.jsx("img",{src:_,alt:"Buienradar",className:"absolute inset-0 w-full h-full object-cover",onError:N=>{N.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="50" y="50" text-anchor="middle" fill="%23999">Laden...</text></svg>'}})})]}),g.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs text-gray-500",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-3 rounded bg-green-400"}),g.jsx("span",{children:"Droog"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-3 rounded bg-blue-300"}),g.jsx("span",{children:"Licht"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-3 rounded bg-blue-500"}),g.jsx("span",{children:"Matig"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-3 rounded bg-blue-700"}),g.jsx("span",{children:"Zwaar"})]})]}),s&&g.jsxs("div",{className:"text-xs text-gray-400 text-center",children:["Laatst bijgewerkt: ",s.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]}),g.jsx("div",{className:"text-xs text-gray-400 text-center",children:"Bron: Buienradar.nl"})]})]})})})]})}function Rq({data:n}){const e=Math.max(...n.map(i=>i.value),1);n.length;const t=i=>i===0?"bg-green-300":i<77?"bg-blue-300":i<166?"bg-blue-500":"bg-blue-700";return g.jsxs("div",{className:"space-y-2",children:[g.jsx("div",{className:"flex items-end gap-0.5 h-16",children:n.map((i,r)=>g.jsx("div",{className:"flex-1 flex flex-col items-center",children:g.jsx("div",{className:`w-full rounded-t ${t(i.value)} transition-all`,style:{height:`${Math.max(2,i.value/e*100)}%`,minHeight:"2px"}})},r))}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{children:n[0]?.time||""}),g.jsx("span",{children:n[Math.floor(n.length/2)]?.time||""}),g.jsx("span",{children:n[n.length-1]?.time||""})]})]})}const cx=[{id:"lobith",name:"Lobith",river:"Rijn",lat:51.8556,lng:6.1086,normalFlow:2300},{id:"borgharen",name:"Borgharen",river:"Maas",lat:50.8708,lng:5.6956,normalFlow:250},{id:"vreeswijk",name:"Vreeswijk",river:"Lek",lat:52.0167,lng:5.0833,normalFlow:800},{id:"tiel",name:"Tiel",river:"Waal",lat:51.8833,lng:5.4333,normalFlow:1500},{id:"deventer",name:"Deventer",river:"IJssel",lat:52.25,lng:6.1833,normalFlow:400},{id:"olst",name:"Olst",river:"IJssel",lat:52.3333,lng:6.1167,normalFlow:380}];function Aq(n){const e=new Date,t=Math.floor((e.getTime()-new Date(e.getFullYear(),0,0).getTime())/(1e3*60*60*24)),i=1+.4*Math.sin((t-100)*Math.PI/182),r=.9+Math.random()*.2,s=Math.round(n.normalFlow*i*r),o=Math.random(),l=o<.33?"rising":o<.66?"falling":"stable";return{stationId:n.id,flow:s,trend:l,timestamp:e}}function Pq({embedded:n=!1}){const[e,t]=K.useState(!1),[i,r]=K.useState(cx[0]),[s,o]=K.useState(new Map),[l,u]=K.useState(!1),h=qe(I=>I.showWaterflowWidget),f=()=>{u(!0);const I=new Map;cx.forEach(w=>{I.set(w.id,Aq(w))}),o(I),u(!1)};if(K.useEffect(()=>{f()},[]),K.useEffect(()=>{const I=setInterval(f,9e5);return()=>clearInterval(I)},[]),!h&&!n)return null;const p=s.get(i.id),_=(I,w)=>{const R=I/w;return R<.7?{text:"Laag",color:"text-orange-500",bg:"bg-orange-50"}:R>1.3?{text:"Hoog",color:"text-blue-600",bg:"bg-blue-50"}:{text:"Normaal",color:"text-green-500",bg:"bg-green-50"}},v=I=>I==="rising"?g.jsx(qw,{size:14,className:"text-blue-500"}):I==="falling"?g.jsx(Kw,{size:14,className:"text-orange-500"}):g.jsx($w,{size:14,className:"text-gray-400"}),S=p?_(p.flow,i.normalFlow):null;return g.jsxs(g.Fragment,{children:[g.jsxs(ke.button,{className:`${n?"":"fixed top-52 right-2 z-[700]"} bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none`,onClick:()=>t(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[g.jsx(tf,{size:18,className:"text-cyan-500"}),g.jsxs("div",{className:"text-left",children:[g.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[80px]",children:i.river}),g.jsx("div",{className:`text-xs font-medium ${S?.color||"text-gray-600"}`,children:p?`${p.flow} m/s`:"Laden..."})]})]}),g.jsx(Xt,{children:e&&g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>t(!1),children:g.jsxs(ke.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:I=>I.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-cyan-500 to-blue-600",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(tf,{size:20,className:"text-white"}),g.jsx("span",{className:"font-semibold text-white",children:"Waterafvoer"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:f,className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",disabled:l,children:g.jsx(Hw,{size:18,className:`text-white ${l?"animate-spin":""}`})}),g.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:g.jsx(An,{size:20,className:"text-white"})})]})]}),g.jsxs("div",{className:"p-4 space-y-4",children:[p&&g.jsxs("div",{className:`rounded-lg p-4 ${S?.bg||"bg-gray-50"}`,children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(ir,{size:16,className:"text-gray-500"}),g.jsx("span",{className:"font-medium text-gray-800",children:i.name}),g.jsxs("span",{className:"text-sm text-gray-500",children:["(",i.river,")"]})]}),v(p.trend)]}),g.jsxs("div",{className:"flex items-baseline gap-2",children:[g.jsx("span",{className:`text-3xl font-bold ${S?.color}`,children:p.flow.toLocaleString()}),g.jsx("span",{className:"text-gray-500",children:"m/s"})]}),g.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Normaal: ",i.normalFlow.toLocaleString()," m/s"]}),g.jsxs("div",{className:`mt-1 text-sm font-medium ${S?.color}`,children:[S?.text," waterstand"]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Meetstations"}),g.jsx("div",{className:"grid gap-2",children:cx.map(I=>{const w=s.get(I.id),R=w?_(w.flow,I.normalFlow):null,M=I.id===i.id;return g.jsx("button",{onClick:()=>r(I),className:`w-full p-3 rounded-lg text-left transition-colors border-0 outline-none ${M?"bg-cyan-50 border-2 border-cyan-300":"bg-gray-50 hover:bg-gray-100"}`,children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("div",{className:"font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.river})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:`font-semibold ${R?.color||"text-gray-600"}`,children:w?`${w.flow.toLocaleString()} m/s`:"..."}),g.jsxs("div",{className:"flex items-center justify-end gap-1",children:[w&&v(w.trend),g.jsx("span",{className:`text-xs ${R?.color||"text-gray-400"}`,children:R?.text||""})]})]})]})},I.id)})})]}),g.jsxs("div",{className:"text-xs text-gray-400 text-center space-y-1",children:[g.jsx("div",{children:"Waterafvoer in kubieke meter per seconde"}),g.jsx("div",{children:"Bron: Rijkswaterstaat (simulatie)"})]})]})]})})})]})}const Pp=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],kq=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],Nq=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],ux=5;function Dq({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=K.useRef(null),s=K.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=ux-n.length,p=Array.from(h).slice(0,f);for(const _ of p)try{const{thumbnailBase64:v}=await HD(_),S={id:KD(),thumbnailBase64:v,createdAt:new Date().toISOString(),pendingUpload:!0};e(S)}catch(v){console.error("Failed to process image:",v)}u.target.value=""},l=n.length<ux;return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",ux,")"]}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>g.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[g.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&g.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:g.jsx(An,{size:12,className:"text-white"})}),u.pendingUpload&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[g.jsx(Gw,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),g.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[g.jsx(CH,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),g.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),g.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const Mq={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function Lq(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,p=0,_=0,v=0,S=0,I=0;const w=h.length/4;for(let L=0;L<h.length;L+=4){const N=h[L],V=h[L+1],A=h[L+2];f+=N,p+=V,V>N&&V>A&&_++,N>100&&V>80&&V<150&&A<100&&v++,N>150&&V>150&&A>150&&S++,N<80&&V<80&&A<80&&I++}const R=[];_/w>.2&&R.push("green"),v/w>.2&&R.push("brown"),S/w>.2&&R.push("silver"),I/w>.3&&R.push("dark");const M=f/w,D=p/w;M>150&&D>100&&D<180&&R.push("gold"),e(R)},t.src=n})}function Oq(n){const e=[];for(const[t,i]of Object.entries(Mq)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function jq(n){try{const e=await Lq(n),t=Oq(e);if(t.length===0)return{species:"",confidence:0,suggestions:Pp.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:Pp.slice(0,5).map(t=>t.name)}}}function Fq(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function Vq({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=JP(re=>re.addCatch),s=ek(re=>re.current),o=zn(re=>re.position),[l,u]=K.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=K.useState(t||(o?"gps":null)),[p,_]=K.useState(""),[v,S]=K.useState(""),[I,w]=K.useState(""),[R,M]=K.useState(""),[D,L]=K.useState(""),[N,V]=K.useState(""),[A,b]=K.useState(i),[P,j]=K.useState(!1),[z,B]=K.useState([]),[O,se]=K.useState(0),me=async re=>{if(b(ge=>[...ge,re]),re.dataUrl&&!p){j(!0);try{const ge=await jq(re.dataUrl);if(B(ge.suggestions),se(ge.confidence),ge.species&&ge.confidence>.4){_(ge.species);const _e=Fq(ge.species)}}catch(ge){console.error("AI recognition failed:",ge)}finally{j(!1)}}},pe=re=>{_(re),B([])},ue=re=>{b(ge=>ge.filter(_e=>_e.id!==re))},H=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},X=re=>{if(re.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:v?parseInt(v):void 0,length:I?parseInt(I):void 0,photos:A.length>0?A:void 0,method:R||"Anders",bait:D||void 0,notes:N||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},W=(()=>{switch(h){case"gps":return{icon:Du,label:"GPS",color:"text-blue-500"};case"photo":return{icon:Gw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:Ry,label:"Kaart",color:"text-orange-500"};default:return{icon:ir,label:"Locatie",color:"text-gray-500"}}})(),G=W.icon;return g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsxs(ke.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:re=>re.stopPropagation(),children:[g.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Js,{className:"text-white",size:24}),g.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),g.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:g.jsx(An,{size:20})})]}),g.jsxs("form",{onSubmit:X,className:"p-4 space-y-4",children:[g.jsx("div",{className:"space-y-2",children:l?g.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(G,{size:16,className:W.color}),g.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),g.jsx("span",{className:`text-xs ${W.color} font-medium`,children:W.label})]}):g.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(ir,{size:16}),g.jsx("span",{children:"Geen locatie"})]}),o&&g.jsx("button",{type:"button",onClick:H,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",P&&g.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[g.jsx(kH,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),g.jsx(Xt,{children:z.length>0&&!p&&g.jsxs(ke.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[g.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[g.jsx(mK,{size:12}),g.jsxs("span",{children:["AI suggesties ",O>.3?`(${Math.round(O*100)}% zeker)`:""]})]}),g.jsx("div",{className:"flex flex-wrap gap-1",children:z.map(re=>g.jsx("button",{type:"button",onClick:()=>pe(re),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:re},re))})]})}),g.jsxs("select",{value:p,onChange:re=>{_(re.target.value),B([])},className:"form-select",required:!0,children:[g.jsx("option",{value:"",children:"Selecteer vissoort..."}),Pp.map(re=>g.jsx("option",{value:re.name,children:re.name},re.name))]})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[g.jsx(lK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),g.jsx("input",{type:"number",value:v,onChange:re=>S(re.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[g.jsx(rK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),g.jsx("input",{type:"number",value:I,onChange:re=>w(re.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),g.jsxs("select",{value:R,onChange:re=>M(re.target.value),className:"form-select",children:[g.jsx("option",{value:"",children:"Selecteer methode..."}),kq.map(re=>g.jsx("option",{value:re,children:re},re))]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),g.jsxs("select",{value:D,onChange:re=>L(re.target.value),className:"form-select",children:[g.jsx("option",{value:"",children:"Selecteer aas..."}),Nq.map(re=>g.jsx("option",{value:re,children:re},re))]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),g.jsx("textarea",{value:N,onChange:re=>V(re.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),g.jsx(Dq,{photos:A,onAddPhoto:me,onRemovePhoto:ue}),g.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function zq(){const n=Un(h=>h.catchFormOpen),e=Un(h=>h.catchFormLocation),t=Un(h=>h.catchFormLocationSource),i=Un(h=>h.catchFormInitialPhotos),r=Un(h=>h.openCatchForm),s=Un(h=>h.closeCatchForm),o=zn(h=>h.position),l=qe(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return g.jsxs(g.Fragment,{children:[l&&g.jsx(ke.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:g.jsx(Js,{size:22,strokeWidth:2})}),g.jsx(Xt,{children:n&&g.jsx(Vq,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function Uq(){const n=gs(r=>r.map),e=JP(r=>r.catches),t=K.useRef(null),i=K.useRef(null);return K.useEffect(()=>{if(n)return i.current=new j1,t.current=new H1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),K.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new hu({geometry:new yl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new tr({image:new Ml({radius:14,fill:new Rr({color:"#22c55e"}),stroke:new Ou({color:"#fff",width:2})}),text:new mf({text:l,font:"bold 12px sans-serif",fill:new Rr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function Bq(){const n=gs(r=>r.map),e=tk(r=>r.spots),t=K.useRef(null),i=K.useRef(null);return K.useEffect(()=>{if(n)return i.current=new j1,t.current=new H1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),K.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new hu({geometry:new yl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new tr({image:new Ml({radius:12,fill:new Rr({color:l}),stroke:new Ou({color:"#fff",width:2})}),text:new mf({text:"",font:"bold 14px sans-serif",fill:new Rr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function Wq({onClose:n,initialLocation:e}){const t=tk(w=>w.addSpot),[i,r]=K.useState(""),[s,o]=K.useState(""),[l,u]=K.useState([]),[h,f]=K.useState(""),[p,_]=K.useState(3),v=e,S=w=>{u(R=>R.includes(w)?R.filter(M=>M!==w):[...R,w])},I=w=>{if(w.preventDefault(),!i||!v){alert("Geef een naam op voor deze locatie");return}t({name:i,location:v,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return g.jsx(ke.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsxs(ke.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:w=>w.stopPropagation(),children:[g.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Av,{className:"text-white",size:24}),g.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),g.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:g.jsx(An,{size:20})})]}),g.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[v&&g.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[g.jsx(ir,{size:16}),g.jsxs("span",{children:[v.lat.toFixed(5),", ",v.lng.toFixed(5)]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),g.jsx("input",{type:"text",value:i,onChange:w=>r(w.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),g.jsx("input",{type:"text",value:s,onChange:w=>o(w.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),g.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(w=>g.jsx("button",{type:"button",onClick:()=>_(w),className:"p-1 border-0 outline-none bg-transparent",children:g.jsx(Av,{size:28,className:w<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},w))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:Pp.slice(0,12).map(w=>g.jsx("button",{type:"button",onClick:()=>S(w.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(w.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:w.name},w.name))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),g.jsx("textarea",{value:h,onChange:w=>f(w.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),g.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const Gq=[{name:"Aanlegsteigers",icon:FD,color:"#2196F3"},{name:"Trailerhellingen",icon:fK,color:"#4CAF50"},{name:"Dieptekaart",icon:kl,color:"#00BCD4"},{name:"Viswater",icon:ir,color:"#9C27B0"}],G2=[{name:"CartoDB Light",label:"Light"},{name:"Terrein",label:"Terrein"},{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function $q(){const n=Un(v=>v.layerPanelOpen),e=Un(v=>v.toggleLayerPanel),t=Xi(v=>v.visible),i=Xi(v=>v.opacity),r=Xi(v=>v.toggleLayer),s=Xi(v=>v.setLayerVisibility),o=Xi(v=>v.setLayerOpacity),l=v=>{G2.forEach(S=>{s(S.name,S.name===v)}),v==="Luchtfoto"?s("Labels Overlay",!0):s("Labels Overlay",!1)},u=()=>{s("Labels Overlay",!t["Labels Overlay"])},h=i["AHN4 Hillshade"]??.5,f=t["AHN4 Hillshade"],p=i["PDOK Water NL"]??.7,_=t["PDOK Water NL"];return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:g.jsx(ke.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:g.jsx(nf,{size:22})})}),g.jsx(Xt,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(ke.div,{className:"fixed inset-0 z-[1000]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(ke.div,{className:"fixed top-2 right-2 z-[1001] bg-white rounded-lg shadow-lg overflow-hidden w-[280px] max-h-[calc(100vh-100px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[g.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-orange-500",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(nf,{size:14,className:"text-white"}),g.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})]}),g.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-orange-400/50 hover:bg-orange-400 transition-colors",children:g.jsx(An,{size:16,className:"text-white",strokeWidth:2.5})})]}),g.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[g.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[g.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1.5 px-1 uppercase tracking-wide",children:"Achtergrond"}),g.jsx("div",{className:"flex gap-1",children:G2.map(v=>g.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[v.name]?"bg-orange-500 text-white":"bg-gray-100 text-gray-600 hover:bg-orange-50"}`,onClick:()=>l(v.name),children:v.label},v.name))}),t.Luchtfoto&&g.jsxs("button",{onClick:u,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-orange-50 text-orange-600":"bg-transparent text-gray-500 hover:bg-orange-50"}`,children:[g.jsxs("span",{className:"flex items-center gap-1.5",children:[g.jsx(SK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&g.jsx(Rp,{size:12})]})]}),g.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[g.jsx("div",{className:"text-xs font-medium text-amber-600 mb-1.5 px-1 uppercase tracking-wide",children:"Hoogtekaart"}),g.jsx($2,{name:"AHN4 Hillshade",icon:GH,color:"#f59e0b",visible:f,opacity:h,onToggle:()=>r("AHN4 Hillshade"),onOpacityChange:v=>o("AHN4 Hillshade",v)})]}),g.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[g.jsx("div",{className:"text-xs font-medium text-cyan-600 mb-1.5 px-1 uppercase tracking-wide",children:"Water"}),g.jsx($2,{name:"PDOK Water NL",label:"Waterlopen NL",icon:tf,color:"#0284c7",visible:_,opacity:p,onToggle:()=>r("PDOK Water NL"),onOpacityChange:v=>o("PDOK Water NL",v)})]}),g.jsxs("div",{children:[g.jsx("div",{className:"text-xs font-medium text-orange-600 mb-1.5 px-1 uppercase tracking-wide",children:"Vislagen"}),g.jsx("div",{className:"space-y-0.5",children:Gq.map(v=>{const S=v.icon,I=t[v.name];return g.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${I?"bg-orange-50":"bg-transparent hover:bg-orange-50"}`,onClick:()=>r(v.name),children:[g.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:I?v.color:"#e5e7eb"},children:g.jsx(S,{size:12,className:"text-white"})}),g.jsx("span",{className:`text-sm ${I?"text-orange-700":"text-gray-600"}`,children:v.name}),g.jsx("div",{className:"ml-auto",children:g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:I?v.color:"white",border:`2px solid ${I?v.color:"#d1d5db"}`},children:I&&g.jsx(Rp,{size:10,className:"text-white",strokeWidth:3})})})]},v.name)})})]})]})]})]})})]})}function $2({name:n,label:e,icon:t,color:i,visible:r,opacity:s,onToggle:o,onOpacityChange:l}){const u=e||n;return g.jsxs("div",{children:[g.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${r?"bg-gray-50":"bg-transparent hover:bg-gray-50"}`,onClick:o,children:[g.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:r?i:"#e5e7eb"},children:g.jsx(t,{size:12,className:"text-white"})}),g.jsx("span",{className:`text-sm ${r?"text-gray-800":"text-gray-600"}`,children:u}),g.jsx("div",{className:"ml-auto",children:g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:r?i:"white",border:`2px solid ${r?i:"#d1d5db"}`},children:r&&g.jsx(Rp,{size:10,className:"text-white",strokeWidth:3})})})]}),r&&g.jsx("div",{className:"mt-1 px-2 pb-1",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] text-gray-400 w-16",children:"Transparantie"}),g.jsx("input",{type:"range",min:"10",max:"100",value:s*100,onChange:h=>l(parseInt(h.target.value)/100),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{accentColor:i}}),g.jsxs("span",{className:"text-[10px] text-gray-400 w-6 text-right",children:[Math.round(s*100),"%"]})]})})]})}function Hq(){const n=Un(w=>w.settingsPanelOpen),e=Un(w=>w.toggleSettingsPanel),t=qe(w=>w.showCatchButton),i=qe(w=>w.setShowCatchButton),r=qe(w=>w.showCatches),s=qe(w=>w.setShowCatches),o=qe(w=>w.showFavoriteSpots),l=qe(w=>w.setShowFavoriteSpots),u=qe(w=>w.defaultBackground),h=qe(w=>w.setDefaultBackground),f=qe(w=>w.fontScale),p=qe(w=>w.setFontScale),_=qe(w=>w.showFontSliders),v=qe(w=>w.setShowFontSliders),S=Xi(w=>w.setLayerVisibility),I=w=>{h(w),S("Terrein",w==="Terrein"),S("OpenStreetMap",w==="OpenStreetMap"),S("Luchtfoto",w==="Luchtfoto"),S("Labels Overlay",w==="Luchtfoto")};return n?g.jsx(ke.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:g.jsxs(ke.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:w=>w.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600",children:[g.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),g.jsx("button",{onClick:e,className:"p-1.5 rounded-lg bg-orange-600 hover:bg-orange-700 transition-colors border-0 outline-none",children:g.jsx(An,{size:18,className:"text-white"})})]}),g.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[g.jsxs("div",{className:"space-y-3",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),g.jsx(dm,{icon:g.jsx(Js,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),g.jsx(dm,{icon:g.jsx(Js,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),g.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),g.jsx(dm,{icon:g.jsx(ir,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),g.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:g.jsx(Ry,{size:18,className:"text-gray-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),g.jsxs("select",{value:u,onChange:w=>I(w.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-orange-400",children:[g.jsx("option",{value:"Terrein",children:"Terrein (relif)"}),g.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),g.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),g.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weergave"}),g.jsx(dm,{icon:g.jsx(AK,{size:18,className:"text-purple-500"}),label:"Tekstgrootte aanpassen",description:"Toon schuifbalk voor tekstgrootte",checked:_,onChange:v}),_&&g.jsxs("div",{className:"flex items-center gap-3 pl-2",children:[g.jsx("span",{className:"text-xs text-gray-500",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:f,onChange:w=>p(parseInt(w.target.value)),className:"flex-1"}),g.jsx("span",{className:"text-lg text-gray-500",children:"T"}),g.jsxs("span",{className:"text-xs text-gray-500 w-10",children:[f,"%"]})]}),g.jsx("p",{className:"text-xs text-gray-400 pl-2",children:"Widgets via lang drukken op kaart  Widgets"})]})]}),g.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function dm({icon:n,label:e,description:t,checked:i,onChange:r}){return g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),g.jsxs("div",{className:"flex-1",children:[g.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),g.jsx("p",{className:"text-xs text-gray-400",children:t})]}),g.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-orange-500":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function Kq(){const n=gs(S=>S.map),[e,t]=K.useState([]),[i,r]=K.useState(0),[s,o]=K.useState(!1),[l,u]=K.useState(null),h=e.length,f=e[i]||"";K.useEffect(()=>{if(!n)return;const S=async I=>{const w=[];if(n.forEachFeatureAtPixel(I.pixel,(R,M)=>{const D=R.getProperties(),L=M?.get("title")||"";let N="";if(L==="Aanlegsteigers"||D.layerType==="aanlegsteiger"){const V=D.name||"Aanlegsteiger",A=D.operator||"",b=D.access||"",P=D.fee||"",j=D.capacity||"",z=D.website||"";N=`<strong class="text-blue-800">${V}</strong>`,A&&(N+=`<br/><span class="text-sm text-gray-600">Beheerder: ${A}</span>`),b&&(N+=`<br/><span class="text-sm text-gray-600">Toegang: ${b==="yes"?"Openbaar":b==="private"?"Priv":b}</span>`),P&&(N+=`<br/><span class="text-sm text-gray-600">Kosten: ${P==="yes"?"Betaald":P==="no"?"Gratis":P}</span>`),j&&(N+=`<br/><span class="text-sm text-gray-600">Capaciteit: ${j} boten</span>`),z&&(N+=`<br/><a href="${z}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Website</a>`)}else if(L==="Trailerhellingen"||D.layerType==="trailerhelling"){const V=D.name||null,A=D.operator||"",b=D.access||"",P=D.fee||"",j=D.surface||"",z=D.website||"",B=D.description||"",O=D.opening_hours||"";let se="";P==="no"?se='<span class="inline-block px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full">Gratis</span>':P==="yes"?se='<span class="inline-block px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded-full">Betaald</span>':P&&(se=`<span class="inline-block px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded-full">${P}</span>`),V?(N=`<strong class="text-green-800 text-lg">${V}</strong>`,se&&(N+=` ${se}`)):(N='<strong class="text-green-800 text-lg">Trailerhelling</strong>',se&&(N+=` ${se}`)),b&&(N+=`<br/><span class="text-sm text-gray-600">Toegang: ${b==="yes"||b==="public"||b==="permissive"?"Openbaar":b==="private"?"Priv":b==="customers"?"Alleen klanten":b}</span>`),A&&(N+=`<br/><span class="text-sm text-gray-600">Beheerder: ${A}</span>`),j&&(N+=`<br/><span class="text-sm text-gray-600">Ondergrond: ${{concrete:"Beton",asphalt:"Asfalt",gravel:"Grind",paved:"Verhard",unpaved:"Onverhard",grass:"Gras",sand:"Zand",wood:"Hout"}[j]||j}</span>`),O&&(N+=`<br/><span class="text-sm text-gray-600">Openingstijden: ${O}</span>`),B&&(N+=`<br/><span class="text-sm text-gray-500 italic">${B}</span>`),z&&(N+=`<br/><a href="${z}" target="_blank" rel="noopener noreferrer" class="text-green-600 hover:underline text-sm">Website</a>`)}else if(L==="Viswater"||D.layerType==="viswater"){const V=D.name||"Viswater",A=D.fishing||"",b=D.access||"",P=D.operator||"";N=`<strong class="text-purple-800">${V}</strong>`,A&&(N+=`<br/><span class="text-sm text-purple-700">Type: ${A}</span>`),P&&(N+=`<br/><span class="text-sm text-gray-600">Beheerder: ${P}</span>`),b&&(N+=`<br/><span class="text-sm text-gray-600">Toegang: ${b}</span>`)}else(D.name||D.title)&&(N=`<strong class="text-gray-800">${D.name||D.title}</strong>`,D.description&&(N+=`<br/><span class="text-sm text-gray-600">${D.description}</span>`));N&&w.push({content:N,coordinate:I.coordinate})}),w.length>0){t(w.map(M=>M.content)),r(0),o(!0);const R=Mx(w[0].coordinate);u(`https://www.google.com/maps/dir/?api=1&destination=${R[1]},${R[0]}`)}};return n.on("singleclick",S),()=>{n.un("singleclick",S)}},[n]);const p=()=>{o(!1),t([]),r(0),u(null)},_=()=>{i<h-1&&r(i+1)},v=()=>{i>0&&r(i-1)};return g.jsx(Xt,{children:s&&f&&g.jsxs(ke.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"fixed bottom-0 left-0 right-0 z-[1200] bg-white rounded-t-2xl shadow-lg max-h-[50vh] overflow-hidden",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-orange-500 to-orange-600",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[h>1&&g.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[g.jsx("button",{onClick:v,disabled:i===0,className:"p-1 rounded bg-orange-600 hover:bg-orange-700 disabled:opacity-50 border-0 outline-none",children:g.jsx(VD,{size:16,className:"text-white"})}),g.jsxs("span",{className:"text-white text-xs px-1",children:[i+1,"/",h]}),g.jsx("button",{onClick:_,disabled:i===h-1,className:"p-1 rounded bg-orange-600 hover:bg-orange-700 disabled:opacity-50 border-0 outline-none",children:g.jsx(Xo,{size:16,className:"text-white"})})]}),g.jsx("span",{className:"font-medium text-white text-sm",children:"Info"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[l&&g.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 rounded bg-orange-600 hover:bg-orange-700 border-0 outline-none",title:"Navigeer met Google Maps",onClick:S=>S.stopPropagation(),children:g.jsx(Navigation2,{size:16,className:"text-white"})}),g.jsx("button",{onClick:p,className:"p-1.5 rounded bg-blue-600 hover:bg-blue-700 border-0 outline-none",children:g.jsx(An,{size:16,className:"text-white"})})]})]}),g.jsx("div",{className:"p-4 overflow-y-auto",style:{maxHeight:"calc(50vh - 56px)"},dangerouslySetInnerHTML:{__html:f}})]})})}function qq({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=OD(),[l,u]=K.useState(""),[h,f]=K.useState(!1),[p,_]=K.useState(!1),[v,S]=K.useState(null);if(K.useEffect(()=>{o()},[o]),s)return g.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-500 via-orange-600 to-orange-800 flex items-center justify-center",children:g.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return g.jsx(g.Fragment,{children:n});const I=R=>{R.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},w=async()=>{try{S(null),await i()}catch{S("Google login mislukt"),setTimeout(()=>S(null),3e3)}};return g.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-500 via-orange-600 to-orange-800 flex items-center justify-center p-4",children:g.jsxs(ke.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[g.jsxs("div",{className:"flex flex-col items-center mb-6",children:[g.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-500 to-orange-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:g.jsx(Js,{size:40,className:"text-white"})}),g.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),g.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),g.jsxs(ke.button,{onClick:w,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[g.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),v&&g.jsx(ke.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:v}),g.jsxs("div",{className:"flex items-center gap-3 my-4",children:[g.jsx("div",{className:"flex-1 h-px bg-gray-200"}),g.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),g.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),g.jsxs("form",{onSubmit:I,className:"space-y-4",children:[g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:g.jsx(LH,{size:20})}),g.jsx("input",{type:p?"text":"password",value:l,onChange:R=>u(R.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-orange-400"}`}),g.jsx("button",{type:"button",onClick:()=>_(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?g.jsx(xH,{size:20}):g.jsx(wH,{size:20})})]}),h&&g.jsx(ke.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),g.jsx(ke.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),g.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function Xq(){const n=Un(s=>s.spotFormOpen),e=Un(s=>s.spotFormLocation),t=Un(s=>s.closeSpotForm),r=14*qe(s=>s.fontScale)/100;return g.jsx(qq,{children:g.jsxs("div",{className:"h-screen w-screen overflow-hidden",style:{fontSize:`${r}px`},children:[g.jsx(B$,{}),g.jsx(GK,{}),g.jsx(Uq,{}),g.jsx(Bq,{}),g.jsx(Kq,{}),g.jsx(zK,{}),g.jsx(vq,{}),g.jsx(Sq,{}),g.jsx(Cq,{}),g.jsx(Pq,{}),g.jsx($K,{}),g.jsx(KK,{}),g.jsx(rq,{}),g.jsx(eq,{}),g.jsx($q,{}),g.jsx(zq,{}),g.jsx(BK,{}),g.jsx(qK,{}),g.jsx(Hq,{}),g.jsx(Xt,{children:n&&g.jsx(Wq,{onClose:t,initialLocation:e||void 0})})]})})}const Yq="1.2.39";console.log(`%c VisApp v${Yq}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");fL.createRoot(document.getElementById("root")).render(g.jsx(Xq,{}));export{di as $,qA as A,Qc as B,IA as C,eX as D,We as E,Rr as F,UF as G,tX as H,F1 as I,rX as J,dX as K,hX as L,WI as M,jV as N,FV as O,yl as P,uX as Q,aX as R,tr as S,Lh as T,Ld as U,j1 as V,oX as W,ed as X,nX as Y,yr as Z,hu as _,H1 as a,it as a0,pm as a1,Gm as a2,hP as a3,zx as a4,uu as a5,BF as a6,EP as a7,al as a8,$o as a9,nr as aA,Hp as aB,p1 as aC,ll as aD,T6 as aE,Vn as aa,Wp as ab,Ue as ac,fn as ad,du as ae,ft as af,Yn as ag,ci as ah,Kh as ai,Ys as aj,Qp as ak,lX as al,Cb as am,v6 as an,_6 as ao,w6 as ap,pP as aq,g1 as ar,Rd as as,$g as at,Ax as au,eo as av,cX as aw,Jq as ax,gX as ay,G6 as az,Ou as b,I1 as c,SA as d,m1 as e,$A as f,HF as g,GI as h,Yc as i,KF as j,R1 as k,$I as l,WA as m,C1 as n,KA as o,rt as p,Vp as q,q4 as r,ml as s,GA as t,Rt as u,HA as v,iX as w,$m as x,qF as y,sX as z};
//# sourceMappingURL=index-ByHmsuNe.js.map
