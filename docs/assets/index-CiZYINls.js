const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-2XVzP9LT.js","assets/GeoJSON-B9abF0yw.js","assets/boothellingenOL-fkGRsvBW.js","assets/viswaterOL-DkoZkUcB.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function fw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var V_={exports:{}},Th={},F_={exports:{}},Ge={};var kT;function vN(){if(kT)return Ge;kT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function y(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,C={};function T(G,$,xe){this.props=G,this.context=$,this.refs=C,this.updater=xe||E}T.prototype.isReactComponent={},T.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function b(){}b.prototype=T.prototype;function P(G,$,xe){this.props=G,this.context=$,this.refs=C,this.updater=xe||E}var k=P.prototype=new b;k.constructor=P,x(k,T.prototype),k.isPureReactComponent=!0;var O=Array.isArray,F=Object.prototype.hasOwnProperty,W={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function R(G,$,xe){var Te,Ie={},be=null,Me=null;if($!=null)for(Te in $.ref!==void 0&&(Me=$.ref),$.key!==void 0&&(be=""+$.key),$)F.call($,Te)&&!D.hasOwnProperty(Te)&&(Ie[Te]=$[Te]);var Ve=arguments.length-2;if(Ve===1)Ie.children=xe;else if(1<Ve){for(var Be=Array(Ve),lt=0;lt<Ve;lt++)Be[lt]=arguments[lt+2];Ie.children=Be}if(G&&G.defaultProps)for(Te in Ve=G.defaultProps,Ve)Ie[Te]===void 0&&(Ie[Te]=Ve[Te]);return{$$typeof:n,type:G,key:be,ref:Me,props:Ie,_owner:W.current}}function M(G,$){return{$$typeof:n,type:G.type,key:$,ref:G.ref,props:G.props,_owner:G._owner}}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function j(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(xe){return $[xe]})}var z=/\/+/g;function L(G,$){return typeof G=="object"&&G!==null&&G.key!=null?j(""+G.key):$.toString(36)}function ae(G,$,xe,Te,Ie){var be=typeof G;(be==="undefined"||be==="boolean")&&(G=null);var Me=!1;if(G===null)Me=!0;else switch(be){case"string":case"number":Me=!0;break;case"object":switch(G.$$typeof){case n:case e:Me=!0}}if(Me)return Me=G,Ie=Ie(Me),G=Te===""?"."+L(Me,0):Te,O(Ie)?(xe="",G!=null&&(xe=G.replace(z,"$&/")+"/"),ae(Ie,$,xe,"",function(lt){return lt})):Ie!=null&&(V(Ie)&&(Ie=M(Ie,xe+(!Ie.key||Me&&Me.key===Ie.key?"":(""+Ie.key).replace(z,"$&/")+"/")+G)),$.push(Ie)),1;if(Me=0,Te=Te===""?".":Te+":",O(G))for(var Ve=0;Ve<G.length;Ve++){be=G[Ve];var Be=Te+L(be,Ve);Me+=ae(be,$,xe,Be,Ie)}else if(Be=y(G),typeof Be=="function")for(G=Be.call(G),Ve=0;!(be=G.next()).done;)be=be.value,Be=Te+L(be,Ve++),Me+=ae(be,$,xe,Be,Ie);else if(be==="object")throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Me}function pe(G,$,xe){if(G==null)return G;var Te=[],Ie=0;return ae(G,Te,"","",function(be){return $.call(xe,be,Ie++)}),Te}function fe(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(xe){(G._status===0||G._status===-1)&&(G._status=1,G._result=xe)},function(xe){(G._status===0||G._status===-1)&&(G._status=2,G._result=xe)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var ce={current:null},J={transition:null},oe={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:J,ReactCurrentOwner:W};function ne(){throw Error("act(...) is not supported in production builds of React.")}return Ge.Children={map:pe,forEach:function(G,$,xe){pe(G,function(){$.apply(this,arguments)},xe)},count:function(G){var $=0;return pe(G,function(){$++}),$},toArray:function(G){return pe(G,function($){return $})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},Ge.Component=T,Ge.Fragment=t,Ge.Profiler=r,Ge.PureComponent=P,Ge.StrictMode=i,Ge.Suspense=c,Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,Ge.act=ne,Ge.cloneElement=function(G,$,xe){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var Te=x({},G.props),Ie=G.key,be=G.ref,Me=G._owner;if($!=null){if($.ref!==void 0&&(be=$.ref,Me=W.current),$.key!==void 0&&(Ie=""+$.key),G.type&&G.type.defaultProps)var Ve=G.type.defaultProps;for(Be in $)F.call($,Be)&&!D.hasOwnProperty(Be)&&(Te[Be]=$[Be]===void 0&&Ve!==void 0?Ve[Be]:$[Be])}var Be=arguments.length-2;if(Be===1)Te.children=xe;else if(1<Be){Ve=Array(Be);for(var lt=0;lt<Be;lt++)Ve[lt]=arguments[lt+2];Te.children=Ve}return{$$typeof:n,type:G.type,key:Ie,ref:be,props:Te,_owner:Me}},Ge.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:s,_context:G},G.Consumer=G},Ge.createElement=R,Ge.createFactory=function(G){var $=R.bind(null,G);return $.type=G,$},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(G){return{$$typeof:l,render:G}},Ge.isValidElement=V,Ge.lazy=function(G){return{$$typeof:f,_payload:{_status:-1,_result:G},_init:fe}},Ge.memo=function(G,$){return{$$typeof:h,type:G,compare:$===void 0?null:$}},Ge.startTransition=function(G){var $=J.transition;J.transition={};try{G()}finally{J.transition=$}},Ge.unstable_act=ne,Ge.useCallback=function(G,$){return ce.current.useCallback(G,$)},Ge.useContext=function(G){return ce.current.useContext(G)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(G){return ce.current.useDeferredValue(G)},Ge.useEffect=function(G,$){return ce.current.useEffect(G,$)},Ge.useId=function(){return ce.current.useId()},Ge.useImperativeHandle=function(G,$,xe){return ce.current.useImperativeHandle(G,$,xe)},Ge.useInsertionEffect=function(G,$){return ce.current.useInsertionEffect(G,$)},Ge.useLayoutEffect=function(G,$){return ce.current.useLayoutEffect(G,$)},Ge.useMemo=function(G,$){return ce.current.useMemo(G,$)},Ge.useReducer=function(G,$,xe){return ce.current.useReducer(G,$,xe)},Ge.useRef=function(G){return ce.current.useRef(G)},Ge.useState=function(G){return ce.current.useState(G)},Ge.useSyncExternalStore=function(G,$,xe){return ce.current.useSyncExternalStore(G,$,xe)},Ge.useTransition=function(){return ce.current.useTransition()},Ge.version="18.3.1",Ge}var DT;function Wd(){return DT||(DT=1,F_.exports=vN()),F_.exports}var MT;function wN(){if(MT)return Th;MT=1;var n=Wd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,h){var f,m={},y=null,E=null;h!==void 0&&(y=""+h),c.key!==void 0&&(y=""+c.key),c.ref!==void 0&&(E=c.ref);for(f in c)i.call(c,f)&&!s.hasOwnProperty(f)&&(m[f]=c[f]);if(l&&l.defaultProps)for(f in c=l.defaultProps,c)m[f]===void 0&&(m[f]=c[f]);return{$$typeof:e,type:l,key:y,ref:E,props:m,_owner:r.current}}return Th.Fragment=t,Th.jsx=o,Th.jsxs=o,Th}var NT;function EN(){return NT||(NT=1,V_.exports=wN()),V_.exports}var S=EN(),Ig={},j_={exports:{}},Zn={},U_={exports:{}},z_={};var LT;function xN(){return LT||(LT=1,(function(n){function e(J,oe){var ne=J.length;J.push(oe);e:for(;0<ne;){var G=ne-1>>>1,$=J[G];if(0<r($,oe))J[G]=oe,J[ne]=$,ne=G;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var oe=J[0],ne=J.pop();if(ne!==oe){J[0]=ne;e:for(var G=0,$=J.length,xe=$>>>1;G<xe;){var Te=2*(G+1)-1,Ie=J[Te],be=Te+1,Me=J[be];if(0>r(Ie,ne))be<$&&0>r(Me,Ie)?(J[G]=Me,J[be]=ne,G=be):(J[G]=Ie,J[Te]=ne,G=Te);else if(be<$&&0>r(Me,ne))J[G]=Me,J[be]=ne,G=be;else break e}}return oe}function r(J,oe){var ne=J.sortIndex-oe.sortIndex;return ne!==0?ne:J.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],h=[],f=1,m=null,y=3,E=!1,x=!1,C=!1,T=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(J){for(var oe=t(h);oe!==null;){if(oe.callback===null)i(h);else if(oe.startTime<=J)i(h),oe.sortIndex=oe.expirationTime,e(c,oe);else break;oe=t(h)}}function O(J){if(C=!1,k(J),!x)if(t(c)!==null)x=!0,fe(F);else{var oe=t(h);oe!==null&&ce(O,oe.startTime-J)}}function F(J,oe){x=!1,C&&(C=!1,b(R),R=-1),E=!0;var ne=y;try{for(k(oe),m=t(c);m!==null&&(!(m.expirationTime>oe)||J&&!j());){var G=m.callback;if(typeof G=="function"){m.callback=null,y=m.priorityLevel;var $=G(m.expirationTime<=oe);oe=n.unstable_now(),typeof $=="function"?m.callback=$:m===t(c)&&i(c),k(oe)}else i(c);m=t(c)}if(m!==null)var xe=!0;else{var Te=t(h);Te!==null&&ce(O,Te.startTime-oe),xe=!1}return xe}finally{m=null,y=ne,E=!1}}var W=!1,D=null,R=-1,M=5,V=-1;function j(){return!(n.unstable_now()-V<M)}function z(){if(D!==null){var J=n.unstable_now();V=J;var oe=!0;try{oe=D(!0,J)}finally{oe?L():(W=!1,D=null)}}else W=!1}var L;if(typeof P=="function")L=function(){P(z)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,pe=ae.port2;ae.port1.onmessage=z,L=function(){pe.postMessage(null)}}else L=function(){T(z,0)};function fe(J){D=J,W||(W=!0,L())}function ce(J,oe){R=T(function(){J(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){x||E||(x=!0,fe(F))},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(J){switch(y){case 1:case 2:case 3:var oe=3;break;default:oe=y}var ne=y;y=oe;try{return J()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,oe){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ne=y;y=J;try{return oe()}finally{y=ne}},n.unstable_scheduleCallback=function(J,oe,ne){var G=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?G+ne:G):ne=G,J){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,J={id:f++,callback:oe,priorityLevel:J,startTime:ne,expirationTime:$,sortIndex:-1},ne>G?(J.sortIndex=ne,e(h,J),t(c)===null&&J===t(h)&&(C?(b(R),R=-1):C=!0,ce(O,ne-G))):(J.sortIndex=$,e(c,J),x||E||(x=!0,fe(F))),J},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(J){var oe=y;return function(){var ne=y;y=oe;try{return J.apply(this,arguments)}finally{y=ne}}}})(z_)),z_}var OT;function TN(){return OT||(OT=1,U_.exports=xN()),U_.exports}var VT;function IN(){if(VT)return Zn;VT=1;var n=Wd(),e=TN();function t(a){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,u){o(a,u),o(a+"Capture",u)}function o(a,u){for(r[a]=u,a=0;a<u.length;a++)i.add(u[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function y(a){return c.call(m,a)?!0:c.call(f,a)?!1:h.test(a)?m[a]=!0:(f[a]=!0,!1)}function E(a,u,d,p){if(d!==null&&d.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return p?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function x(a,u,d,p){if(u===null||typeof u>"u"||E(a,u,d,p))return!0;if(p)return!1;if(d!==null)switch(d.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function C(a,u,d,p,_,v,A){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=d,this.propertyName=a,this.type=u,this.sanitizeURL=v,this.removeEmptyString=A}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new C(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var u=a[0];T[u]=new C(u,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new C(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new C(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new C(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new C(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new C(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new C(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new C(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function P(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var u=a.replace(b,P);T[u]=new C(u,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var u=a.replace(b,P);T[u]=new C(u,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var u=a.replace(b,P);T[u]=new C(u,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new C(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new C(a,1,!1,a.toLowerCase(),null,!0,!0)});function k(a,u,d,p){var _=T.hasOwnProperty(u)?T[u]:null;(_!==null?_.type!==0:p||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(x(u,d,_,p)&&(d=null),p||_===null?y(u)&&(d===null?a.removeAttribute(u):a.setAttribute(u,""+d)):_.mustUseProperty?a[_.propertyName]=d===null?_.type===3?!1:"":d:(u=_.attributeName,p=_.attributeNamespace,d===null?a.removeAttribute(u):(_=_.type,d=_===3||_===4&&d===!0?"":""+d,p?a.setAttributeNS(p,u,d):a.setAttribute(u,d))))}var O=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),W=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),j=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),J=Symbol.iterator;function oe(a){return a===null||typeof a!="object"?null:(a=J&&a[J]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,G;function $(a){if(G===void 0)try{throw Error()}catch(d){var u=d.stack.trim().match(/\n( *(at )?)/);G=u&&u[1]||""}return`
`+G+a}var xe=!1;function Te(a,u){if(!a||xe)return"";xe=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Z){var p=Z}Reflect.construct(a,[],u)}else{try{u.call()}catch(Z){p=Z}a.call(u.prototype)}else{try{throw Error()}catch(Z){p=Z}a()}}catch(Z){if(Z&&p&&typeof Z.stack=="string"){for(var _=Z.stack.split(`
`),v=p.stack.split(`
`),A=_.length-1,U=v.length-1;1<=A&&0<=U&&_[A]!==v[U];)U--;for(;1<=A&&0<=U;A--,U--)if(_[A]!==v[U]){if(A!==1||U!==1)do if(A--,U--,0>U||_[A]!==v[U]){var B=`
`+_[A].replace(" at new "," at ");return a.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",a.displayName)),B}while(1<=A&&0<=U);break}}}finally{xe=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function Ie(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=Te(a.type,!1),a;case 11:return a=Te(a.type.render,!1),a;case 1:return a=Te(a.type,!0),a;default:return""}}function be(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case D:return"Fragment";case W:return"Portal";case M:return"Profiler";case R:return"StrictMode";case L:return"Suspense";case ae:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case z:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case pe:return u=a.displayName||null,u!==null?u:be(a.type)||"Memo";case fe:u=a._payload,a=a._init;try{return be(a(u))}catch{}}return null}function Me(a){var u=a.type;switch(a.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=u.render,a=a.displayName||a.name||"",u.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(u);case 8:return u===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function Ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Be(a){var u=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function lt(a){var u=Be(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,u),p=""+a[u];if(!a.hasOwnProperty(u)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,v=d.set;return Object.defineProperty(a,u,{configurable:!0,get:function(){return _.call(this)},set:function(A){p=""+A,v.call(this,A)}}),Object.defineProperty(a,u,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(A){p=""+A},stopTracking:function(){a._valueTracker=null,delete a[u]}}}}function Qi(a){a._valueTracker||(a._valueTracker=lt(a))}function ds(a){if(!a)return!1;var u=a._valueTracker;if(!u)return!0;var d=u.getValue(),p="";return a&&(p=Be(a)?a.checked?"true":"false":a.value),a=p,a!==d?(u.setValue(a),!0):!1}function Gn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Wn(a,u){var d=u.checked;return ne({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function cn(a,u){var d=u.defaultValue==null?"":u.defaultValue,p=u.checked!=null?u.checked:u.defaultChecked;d=Ve(u.value!=null?u.value:d),a._wrapperState={initialChecked:p,initialValue:d,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function hn(a,u){u=u.checked,u!=null&&k(a,"checked",u,!1)}function Kn(a,u){hn(a,u);var d=Ve(u.value),p=u.type;if(d!=null)p==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(p==="submit"||p==="reset"){a.removeAttribute("value");return}u.hasOwnProperty("value")?yt(a,u.type,d):u.hasOwnProperty("defaultValue")&&yt(a,u.type,Ve(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(a.defaultChecked=!!u.defaultChecked)}function Ri(a,u,d){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var p=u.type;if(!(p!=="submit"&&p!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+a._wrapperState.initialValue,d||u===a.value||(a.value=u),a.defaultValue=u}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function yt(a,u,d){(u!=="number"||Gn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ut=Array.isArray;function tn(a,u,d,p){if(a=a.options,u){u={};for(var _=0;_<d.length;_++)u["$"+d[_]]=!0;for(d=0;d<a.length;d++)_=u.hasOwnProperty("$"+a[d].value),a[d].selected!==_&&(a[d].selected=_),_&&p&&(a[d].defaultSelected=!0)}else{for(d=""+Ve(d),u=null,_=0;_<a.length;_++){if(a[_].value===d){a[_].selected=!0,p&&(a[_].defaultSelected=!0);return}u!==null||a[_].disabled||(u=a[_])}u!==null&&(u.selected=!0)}}function Ai(a,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},u,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,u){var d=u.value;if(d==null){if(d=u.children,u=u.defaultValue,d!=null){if(u!=null)throw Error(t(92));if(ut(d)){if(1<d.length)throw Error(t(93));d=d[0]}u=d}u==null&&(u=""),d=u}a._wrapperState={initialValue:Ve(d)}}function Js(a,u){var d=Ve(u.value),p=Ve(u.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),u.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),p!=null&&(a.defaultValue=""+p)}function Pi(a){var u=a.textContent;u===a._wrapperState.initialValue&&u!==""&&u!==null&&(a.value=u)}function Sr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ji(a,u){return a==null||a==="http://www.w3.org/1999/xhtml"?Sr(u):a==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Cr,la=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,d,p,_){MSApp.execUnsafeLocalFunction(function(){return a(u,d,p,_)})}:a})(function(a,u){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=u;else{for(Cr=Cr||document.createElement("div"),Cr.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=Cr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;u.firstChild;)a.appendChild(u.firstChild)}});function Rr(a,u){if(u){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=u;return}}a.textContent=u}var bi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ll=["Webkit","ms","Moz","O"];Object.keys(bi).forEach(function(a){Ll.forEach(function(u){u=u+a.charAt(0).toUpperCase()+a.substring(1),bi[u]=bi[a]})});function Ar(a,u,d){return u==null||typeof u=="boolean"||u===""?"":d||typeof u!="number"||u===0||bi.hasOwnProperty(a)&&bi[a]?(""+u).trim():u+"px"}function fs(a,u){a=a.style;for(var d in u)if(u.hasOwnProperty(d)){var p=d.indexOf("--")===0,_=Ar(d,u[d],p);d==="float"&&(d="cssFloat"),p?a.setProperty(d,_):a[d]=_}}var eo=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ln(a,u){if(u){if(eo[a]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function gs(a,u){if(a.indexOf("-")===-1)return typeof u.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pr=null;function br(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var On=null,Vn=null,ft=null;function to(a){if(a=lh(a)){if(typeof On!="function")throw Error(t(280));var u=a.stateNode;u&&(u=jf(u),On(a.stateNode,a.type,u))}}function er(a){Vn?ft?ft.push(a):ft=[a]:Vn=a}function Ot(){if(Vn){var a=Vn,u=ft;if(ft=Vn=null,to(a),u)for(a=0;a<u.length;a++)to(u[a])}}function ki(a,u){return a(u)}function dn(){}var Vt=!1;function fn(a,u,d){if(Vt)return a(u,d);Vt=!0;try{return ki(a,u,d)}finally{Vt=!1,(Vn!==null||ft!==null)&&(dn(),Ot())}}function gn(a,u){var d=a.stateNode;if(d===null)return null;var p=jf(d);if(p===null)return null;d=p[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,u,typeof d));return d}var nn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){nn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{nn=!1}function Bt(a,u,d,p,_,v,A,U,B){var Z=Array.prototype.slice.call(arguments,3);try{u.apply(d,Z)}catch(re){this.onError(re)}}var Xt=!1,Di=null,Ol=!1,Mi=null,yf={onError:function(a){Xt=!0,Di=a}};function _f(a,u,d,p,_,v,A,U,B){Xt=!1,Di=null,Bt.apply(yf,arguments)}function Oc(a,u,d,p,_,v,A,U,B){if(_f.apply(this,arguments),Xt){if(Xt){var Z=Di;Xt=!1,Di=null}else throw Error(t(198));Ol||(Ol=!0,Mi=Z)}}function tr(a){var u=a,d=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,(u.flags&4098)!==0&&(d=u.return),a=u.return;while(a)}return u.tag===3?d:null}function Vc(a){if(a.tag===13){var u=a.memoizedState;if(u===null&&(a=a.alternate,a!==null&&(u=a.memoizedState)),u!==null)return u.dehydrated}return null}function vf(a){if(tr(a)!==a)throw Error(t(188))}function wf(a){var u=a.alternate;if(!u){if(u=tr(a),u===null)throw Error(t(188));return u!==a?null:a}for(var d=a,p=u;;){var _=d.return;if(_===null)break;var v=_.alternate;if(v===null){if(p=_.return,p!==null){d=p;continue}break}if(_.child===v.child){for(v=_.child;v;){if(v===d)return vf(_),a;if(v===p)return vf(_),u;v=v.sibling}throw Error(t(188))}if(d.return!==p.return)d=_,p=v;else{for(var A=!1,U=_.child;U;){if(U===d){A=!0,d=_,p=v;break}if(U===p){A=!0,p=_,d=v;break}U=U.sibling}if(!A){for(U=v.child;U;){if(U===d){A=!0,d=v,p=_;break}if(U===p){A=!0,p=v,d=_;break}U=U.sibling}if(!A)throw Error(t(189))}}if(d.alternate!==p)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:u}function Ef(a){return a=wf(a),a!==null?ua(a):null}function ua(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var u=ua(a);if(u!==null)return u;a=a.sibling}return null}var Fc=e.unstable_scheduleCallback,Vl=e.unstable_cancelCallback,ca=e.unstable_shouldYield,ps=e.unstable_requestPaint,vt=e.unstable_now,gy=e.unstable_getCurrentPriorityLevel,Fl=e.unstable_ImmediatePriority,jc=e.unstable_UserBlockingPriority,ha=e.unstable_NormalPriority,Uc=e.unstable_LowPriority,jl=e.unstable_IdlePriority,da=null,li=null;function xf(a){if(li&&typeof li.onCommitFiberRoot=="function")try{li.onCommitFiberRoot(da,a,void 0,(a.current.flags&128)===128)}catch{}}var ui=Math.clz32?Math.clz32:fa,kr=Math.log,Ni=Math.LN2;function fa(a){return a>>>=0,a===0?32:31-(kr(a)/Ni|0)|0}var Dr=64,no=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ms(a,u){var d=a.pendingLanes;if(d===0)return 0;var p=0,_=a.suspendedLanes,v=a.pingedLanes,A=d&268435455;if(A!==0){var U=A&~_;U!==0?p=st(U):(v&=A,v!==0&&(p=st(v)))}else A=d&~_,A!==0?p=st(A):v!==0&&(p=st(v));if(p===0)return 0;if(u!==0&&u!==p&&(u&_)===0&&(_=p&-p,v=u&-u,_>=v||_===16&&(v&4194240)!==0))return u;if((p&4)!==0&&(p|=d&16),u=a.entangledLanes,u!==0)for(a=a.entanglements,u&=p;0<u;)d=31-ui(u),_=1<<d,p|=a[d],u&=~_;return p}function ga(a,u){switch(a){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pa(a,u){for(var d=a.suspendedLanes,p=a.pingedLanes,_=a.expirationTimes,v=a.pendingLanes;0<v;){var A=31-ui(v),U=1<<A,B=_[A];B===-1?((U&d)===0||(U&p)!==0)&&(_[A]=ga(U,u)):B<=u&&(a.expiredLanes|=U),v&=~U}}function zc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Bc(){var a=Dr;return Dr<<=1,(Dr&4194240)===0&&(Dr=64),a}function Gc(a){for(var u=[],d=0;31>d;d++)u.push(a);return u}function ma(a,u,d){a.pendingLanes|=u,u!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,u=31-ui(u),a[u]=d}function py(a,u){var d=a.pendingLanes&~u;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=u,a.mutableReadLanes&=u,a.entangledLanes&=u,u=a.entanglements;var p=a.eventTimes;for(a=a.expirationTimes;0<d;){var _=31-ui(d),v=1<<_;u[_]=0,p[_]=-1,a[_]=-1,d&=~v}}function Wc(a,u){var d=a.entangledLanes|=u;for(a=a.entanglements;d;){var p=31-ui(d),_=1<<p;_&u|a[p]&u&&(a[p]|=u),d&=~_}}var $e=0;function Mr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Kc,Ul,$c,Hc,Xc,Nr=!1,zl=[],Lr=null,Or=null,pn=null,ya=new Map,ys=new Map,ci=[],Tf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function io(a,u){switch(a){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Or=null;break;case"mouseover":case"mouseout":pn=null;break;case"pointerover":case"pointerout":ya.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":ys.delete(u.pointerId)}}function nr(a,u,d,p,_,v){return a===null||a.nativeEvent!==v?(a={blockedOn:u,domEventName:d,eventSystemFlags:p,nativeEvent:v,targetContainers:[_]},u!==null&&(u=lh(u),u!==null&&Ul(u)),a):(a.eventSystemFlags|=p,u=a.targetContainers,_!==null&&u.indexOf(_)===-1&&u.push(_),a)}function If(a,u,d,p,_){switch(u){case"focusin":return Lr=nr(Lr,a,u,d,p,_),!0;case"dragenter":return Or=nr(Or,a,u,d,p,_),!0;case"mouseover":return pn=nr(pn,a,u,d,p,_),!0;case"pointerover":var v=_.pointerId;return ya.set(v,nr(ya.get(v)||null,a,u,d,p,_)),!0;case"gotpointercapture":return v=_.pointerId,ys.set(v,nr(ys.get(v)||null,a,u,d,p,_)),!0}return!1}function Bl(a){var u=Ea(a.target);if(u!==null){var d=tr(u);if(d!==null){if(u=d.tag,u===13){if(u=Vc(d),u!==null){a.blockedOn=u,Xc(a.priority,function(){$c(d)});return}}else if(u===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var u=a.targetContainers;0<u.length;){var d=Gl(a.domEventName,a.eventSystemFlags,u[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var p=new d.constructor(d.type,d);Pr=p,d.target.dispatchEvent(p),Pr=null}else return u=lh(d),u!==null&&Ul(u),a.blockedOn=d,!1;u.shift()}return!0}function Sf(a,u,d){pt(a)&&d.delete(u)}function my(){Nr=!1,Lr!==null&&pt(Lr)&&(Lr=null),Or!==null&&pt(Or)&&(Or=null),pn!==null&&pt(pn)&&(pn=null),ya.forEach(Sf),ys.forEach(Sf)}function ro(a,u){a.blockedOn===u&&(a.blockedOn=null,Nr||(Nr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,my)))}function so(a){function u(_){return ro(_,a)}if(0<zl.length){ro(zl[0],a);for(var d=1;d<zl.length;d++){var p=zl[d];p.blockedOn===a&&(p.blockedOn=null)}}for(Lr!==null&&ro(Lr,a),Or!==null&&ro(Or,a),pn!==null&&ro(pn,a),ya.forEach(u),ys.forEach(u),d=0;d<ci.length;d++)p=ci[d],p.blockedOn===a&&(p.blockedOn=null);for(;0<ci.length&&(d=ci[0],d.blockedOn===null);)Bl(d),d.blockedOn===null&&ci.shift()}var _s=O.ReactCurrentBatchConfig,vs=!0;function Vr(a,u,d,p){var _=$e,v=_s.transition;_s.transition=null;try{$e=1,qc(a,u,d,p)}finally{$e=_,_s.transition=v}}function Cf(a,u,d,p){var _=$e,v=_s.transition;_s.transition=null;try{$e=4,qc(a,u,d,p)}finally{$e=_,_s.transition=v}}function qc(a,u,d,p){if(vs){var _=Gl(a,u,d,p);if(_===null)Ry(a,u,p,Fr,d),io(a,p);else if(If(_,a,u,d,p))p.stopPropagation();else if(io(a,p),u&4&&-1<Tf.indexOf(a)){for(;_!==null;){var v=lh(_);if(v!==null&&Kc(v),v=Gl(a,u,d,p),v===null&&Ry(a,u,p,Fr,d),v===_)break;_=v}_!==null&&p.stopPropagation()}else Ry(a,u,p,null,d)}}var Fr=null;function Gl(a,u,d,p){if(Fr=null,a=br(p),a=Ea(a),a!==null)if(u=tr(a),u===null)a=null;else if(d=u.tag,d===13){if(a=Vc(u),a!==null)return a;a=null}else if(d===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;a=null}else u!==a&&(a=null);return Fr=a,null}function Wl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gy()){case Fl:return 1;case jc:return 4;case ha:case Uc:return 16;case jl:return 536870912;default:return 16}default:return 16}}var hi=null,Kl=null,ws=null;function Rf(){if(ws)return ws;var a,u=Kl,d=u.length,p,_="value"in hi?hi.value:hi.textContent,v=_.length;for(a=0;a<d&&u[a]===_[a];a++);var A=d-a;for(p=1;p<=A&&u[d-p]===_[v-p];p++);return ws=_.slice(a,1<p?1-p:void 0)}function _a(a){var u=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&u===13&&(a=13)):a=u,a===10&&(a=13),32<=a||a===13?a:0}function jr(){return!0}function Yc(){return!1}function Sn(a){function u(d,p,_,v,A){this._reactName=d,this._targetInst=_,this.type=p,this.nativeEvent=v,this.target=A,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(v):v[U]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?jr:Yc,this.isPropagationStopped=Yc,this}return ne(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=jr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=jr)},persist:function(){},isPersistent:jr}),u}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},va=Sn(Ur),oo=ne({},Ur,{view:0,detail:0}),$l=Sn(oo),Hl,Xl,di,wa=ne({},oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fe,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==di&&(di&&a.type==="mousemove"?(Hl=a.screenX-di.screenX,Xl=a.screenY-di.screenY):Xl=Hl=0,di=a),Hl)},movementY:function(a){return"movementY"in a?a.movementY:Xl}}),Zc=Sn(wa),Af=ne({},wa,{dataTransfer:0}),Pf=Sn(Af),ql=ne({},oo,{relatedTarget:0}),mn=Sn(ql),bf=ne({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),kf=Sn(bf),ao=ne({},Ur,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Sn(ao),w=ne({},Ur,{data:0}),I=Sn(w),N={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function he(a){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(a):(a=Q[a])?!!u[a]:!1}function Fe(){return he}var Ft=ne({},oo,{key:function(a){if(a.key){var u=N[a.key]||a.key;if(u!=="Unidentified")return u}return a.type==="keypress"?(a=_a(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fe,charCode:function(a){return a.type==="keypress"?_a(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?_a(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ct=Sn(Ft),Gt=ne({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fi=Sn(Gt),Es=ne({},oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fe}),zr=Sn(Es),Br=ne({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yl=Sn(Br),Qc=ne({},wa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),fM=Sn(Qc),gM=[9,13,27,32],yy=l&&"CompositionEvent"in window,Jc=null;l&&"documentMode"in document&&(Jc=document.documentMode);var pM=l&&"TextEvent"in window&&!Jc,Tx=l&&(!yy||Jc&&8<Jc&&11>=Jc),Ix=" ",Sx=!1;function Cx(a,u){switch(a){case"keyup":return gM.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rx(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Zl=!1;function mM(a,u){switch(a){case"compositionend":return Rx(u);case"keypress":return u.which!==32?null:(Sx=!0,Ix);case"textInput":return a=u.data,a===Ix&&Sx?null:a;default:return null}}function yM(a,u){if(Zl)return a==="compositionend"||!yy&&Cx(a,u)?(a=Rf(),ws=Kl=hi=null,Zl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Tx&&u.locale!=="ko"?null:u.data;default:return null}}var _M={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ax(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u==="input"?!!_M[a.type]:u==="textarea"}function Px(a,u,d,p){er(p),u=Of(u,"onChange"),0<u.length&&(d=new va("onChange","change",null,d,p),a.push({event:d,listeners:u}))}var eh=null,th=null;function vM(a){Hx(a,0)}function Df(a){var u=nu(a);if(ds(u))return a}function wM(a,u){if(a==="change")return u}var bx=!1;if(l){var _y;if(l){var vy="oninput"in document;if(!vy){var kx=document.createElement("div");kx.setAttribute("oninput","return;"),vy=typeof kx.oninput=="function"}_y=vy}else _y=!1;bx=_y&&(!document.documentMode||9<document.documentMode)}function Dx(){eh&&(eh.detachEvent("onpropertychange",Mx),th=eh=null)}function Mx(a){if(a.propertyName==="value"&&Df(th)){var u=[];Px(u,th,a,br(a)),fn(vM,u)}}function EM(a,u,d){a==="focusin"?(Dx(),eh=u,th=d,eh.attachEvent("onpropertychange",Mx)):a==="focusout"&&Dx()}function xM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Df(th)}function TM(a,u){if(a==="click")return Df(u)}function IM(a,u){if(a==="input"||a==="change")return Df(u)}function SM(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var ir=typeof Object.is=="function"?Object.is:SM;function nh(a,u){if(ir(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var d=Object.keys(a),p=Object.keys(u);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var _=d[p];if(!c.call(u,_)||!ir(a[_],u[_]))return!1}return!0}function Nx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Lx(a,u){var d=Nx(a);a=0;for(var p;d;){if(d.nodeType===3){if(p=a+d.textContent.length,a<=u&&p>=u)return{node:d,offset:u-a};a=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Nx(d)}}function Ox(a,u){return a&&u?a===u?!0:a&&a.nodeType===3?!1:u&&u.nodeType===3?Ox(a,u.parentNode):"contains"in a?a.contains(u):a.compareDocumentPosition?!!(a.compareDocumentPosition(u)&16):!1:!1}function Vx(){for(var a=window,u=Gn();u instanceof a.HTMLIFrameElement;){try{var d=typeof u.contentWindow.location.href=="string"}catch{d=!1}if(d)a=u.contentWindow;else break;u=Gn(a.document)}return u}function wy(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u&&(u==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||u==="textarea"||a.contentEditable==="true")}function CM(a){var u=Vx(),d=a.focusedElem,p=a.selectionRange;if(u!==d&&d&&d.ownerDocument&&Ox(d.ownerDocument.documentElement,d)){if(p!==null&&wy(d)){if(u=p.start,a=p.end,a===void 0&&(a=u),"selectionStart"in d)d.selectionStart=u,d.selectionEnd=Math.min(a,d.value.length);else if(a=(u=d.ownerDocument||document)&&u.defaultView||window,a.getSelection){a=a.getSelection();var _=d.textContent.length,v=Math.min(p.start,_);p=p.end===void 0?v:Math.min(p.end,_),!a.extend&&v>p&&(_=p,p=v,v=_),_=Lx(d,v);var A=Lx(d,p);_&&A&&(a.rangeCount!==1||a.anchorNode!==_.node||a.anchorOffset!==_.offset||a.focusNode!==A.node||a.focusOffset!==A.offset)&&(u=u.createRange(),u.setStart(_.node,_.offset),a.removeAllRanges(),v>p?(a.addRange(u),a.extend(A.node,A.offset)):(u.setEnd(A.node,A.offset),a.addRange(u)))}}for(u=[],a=d;a=a.parentNode;)a.nodeType===1&&u.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<u.length;d++)a=u[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var RM=l&&"documentMode"in document&&11>=document.documentMode,Ql=null,Ey=null,ih=null,xy=!1;function Fx(a,u,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;xy||Ql==null||Ql!==Gn(p)||(p=Ql,"selectionStart"in p&&wy(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),ih&&nh(ih,p)||(ih=p,p=Of(Ey,"onSelect"),0<p.length&&(u=new va("onSelect","select",null,u,d),a.push({event:u,listeners:p}),u.target=Ql)))}function Mf(a,u){var d={};return d[a.toLowerCase()]=u.toLowerCase(),d["Webkit"+a]="webkit"+u,d["Moz"+a]="moz"+u,d}var Jl={animationend:Mf("Animation","AnimationEnd"),animationiteration:Mf("Animation","AnimationIteration"),animationstart:Mf("Animation","AnimationStart"),transitionend:Mf("Transition","TransitionEnd")},Ty={},jx={};l&&(jx=document.createElement("div").style,"AnimationEvent"in window||(delete Jl.animationend.animation,delete Jl.animationiteration.animation,delete Jl.animationstart.animation),"TransitionEvent"in window||delete Jl.transitionend.transition);function Nf(a){if(Ty[a])return Ty[a];if(!Jl[a])return a;var u=Jl[a],d;for(d in u)if(u.hasOwnProperty(d)&&d in jx)return Ty[a]=u[d];return a}var Ux=Nf("animationend"),zx=Nf("animationiteration"),Bx=Nf("animationstart"),Gx=Nf("transitionend"),Wx=new Map,Kx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lo(a,u){Wx.set(a,u),s(u,[a])}for(var Iy=0;Iy<Kx.length;Iy++){var Sy=Kx[Iy],AM=Sy.toLowerCase(),PM=Sy[0].toUpperCase()+Sy.slice(1);lo(AM,"on"+PM)}lo(Ux,"onAnimationEnd"),lo(zx,"onAnimationIteration"),lo(Bx,"onAnimationStart"),lo("dblclick","onDoubleClick"),lo("focusin","onFocus"),lo("focusout","onBlur"),lo(Gx,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bM=new Set("cancel close invalid load scroll toggle".split(" ").concat(rh));function $x(a,u,d){var p=a.type||"unknown-event";a.currentTarget=d,Oc(p,u,void 0,a),a.currentTarget=null}function Hx(a,u){u=(u&4)!==0;for(var d=0;d<a.length;d++){var p=a[d],_=p.event;p=p.listeners;e:{var v=void 0;if(u)for(var A=p.length-1;0<=A;A--){var U=p[A],B=U.instance,Z=U.currentTarget;if(U=U.listener,B!==v&&_.isPropagationStopped())break e;$x(_,U,Z),v=B}else for(A=0;A<p.length;A++){if(U=p[A],B=U.instance,Z=U.currentTarget,U=U.listener,B!==v&&_.isPropagationStopped())break e;$x(_,U,Z),v=B}}}if(Ol)throw a=Mi,Ol=!1,Mi=null,a}function wt(a,u){var d=u[My];d===void 0&&(d=u[My]=new Set);var p=a+"__bubble";d.has(p)||(Xx(u,a,2,!1),d.add(p))}function Cy(a,u,d){var p=0;u&&(p|=4),Xx(d,a,p,u)}var Lf="_reactListening"+Math.random().toString(36).slice(2);function sh(a){if(!a[Lf]){a[Lf]=!0,i.forEach(function(d){d!=="selectionchange"&&(bM.has(d)||Cy(d,!1,a),Cy(d,!0,a))});var u=a.nodeType===9?a:a.ownerDocument;u===null||u[Lf]||(u[Lf]=!0,Cy("selectionchange",!1,u))}}function Xx(a,u,d,p){switch(Wl(u)){case 1:var _=Vr;break;case 4:_=Cf;break;default:_=qc}d=_.bind(null,u,d,a),_=void 0,!nn||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(_=!0),p?_!==void 0?a.addEventListener(u,d,{capture:!0,passive:_}):a.addEventListener(u,d,!0):_!==void 0?a.addEventListener(u,d,{passive:_}):a.addEventListener(u,d,!1)}function Ry(a,u,d,p,_){var v=p;if((u&1)===0&&(u&2)===0&&p!==null)e:for(;;){if(p===null)return;var A=p.tag;if(A===3||A===4){var U=p.stateNode.containerInfo;if(U===_||U.nodeType===8&&U.parentNode===_)break;if(A===4)for(A=p.return;A!==null;){var B=A.tag;if((B===3||B===4)&&(B=A.stateNode.containerInfo,B===_||B.nodeType===8&&B.parentNode===_))return;A=A.return}for(;U!==null;){if(A=Ea(U),A===null)return;if(B=A.tag,B===5||B===6){p=v=A;continue e}U=U.parentNode}}p=p.return}fn(function(){var Z=v,re=br(d),le=[];e:{var ie=Wx.get(a);if(ie!==void 0){var ge=va,ye=a;switch(a){case"keypress":if(_a(d)===0)break e;case"keydown":case"keyup":ge=ct;break;case"focusin":ye="focus",ge=mn;break;case"focusout":ye="blur",ge=mn;break;case"beforeblur":case"afterblur":ge=mn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=Zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=Pf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=zr;break;case Ux:case zx:case Bx:ge=kf;break;case Gx:ge=Yl;break;case"scroll":ge=$l;break;case"wheel":ge=fM;break;case"copy":case"cut":case"paste":ge=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=fi}var _e=(u&4)!==0,jt=!_e&&a==="scroll",H=_e?ie!==null?ie+"Capture":null:ie;_e=[];for(var K=Z,q;K!==null;){q=K;var ue=q.stateNode;if(q.tag===5&&ue!==null&&(q=ue,H!==null&&(ue=gn(K,H),ue!=null&&_e.push(oh(K,ue,q)))),jt)break;K=K.return}0<_e.length&&(ie=new ge(ie,ye,null,d,re),le.push({event:ie,listeners:_e}))}}if((u&7)===0){e:{if(ie=a==="mouseover"||a==="pointerover",ge=a==="mouseout"||a==="pointerout",ie&&d!==Pr&&(ye=d.relatedTarget||d.fromElement)&&(Ea(ye)||ye[xs]))break e;if((ge||ie)&&(ie=re.window===re?re:(ie=re.ownerDocument)?ie.defaultView||ie.parentWindow:window,ge?(ye=d.relatedTarget||d.toElement,ge=Z,ye=ye?Ea(ye):null,ye!==null&&(jt=tr(ye),ye!==jt||ye.tag!==5&&ye.tag!==6)&&(ye=null)):(ge=null,ye=Z),ge!==ye)){if(_e=Zc,ue="onMouseLeave",H="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(_e=fi,ue="onPointerLeave",H="onPointerEnter",K="pointer"),jt=ge==null?ie:nu(ge),q=ye==null?ie:nu(ye),ie=new _e(ue,K+"leave",ge,d,re),ie.target=jt,ie.relatedTarget=q,ue=null,Ea(re)===Z&&(_e=new _e(H,K+"enter",ye,d,re),_e.target=q,_e.relatedTarget=jt,ue=_e),jt=ue,ge&&ye)t:{for(_e=ge,H=ye,K=0,q=_e;q;q=eu(q))K++;for(q=0,ue=H;ue;ue=eu(ue))q++;for(;0<K-q;)_e=eu(_e),K--;for(;0<q-K;)H=eu(H),q--;for(;K--;){if(_e===H||H!==null&&_e===H.alternate)break t;_e=eu(_e),H=eu(H)}_e=null}else _e=null;ge!==null&&qx(le,ie,ge,_e,!1),ye!==null&&jt!==null&&qx(le,jt,ye,_e,!0)}}e:{if(ie=Z?nu(Z):window,ge=ie.nodeName&&ie.nodeName.toLowerCase(),ge==="select"||ge==="input"&&ie.type==="file")var we=wM;else if(Ax(ie))if(bx)we=IM;else{we=xM;var Ae=EM}else(ge=ie.nodeName)&&ge.toLowerCase()==="input"&&(ie.type==="checkbox"||ie.type==="radio")&&(we=TM);if(we&&(we=we(a,Z))){Px(le,we,d,re);break e}Ae&&Ae(a,ie,Z),a==="focusout"&&(Ae=ie._wrapperState)&&Ae.controlled&&ie.type==="number"&&yt(ie,"number",ie.value)}switch(Ae=Z?nu(Z):window,a){case"focusin":(Ax(Ae)||Ae.contentEditable==="true")&&(Ql=Ae,Ey=Z,ih=null);break;case"focusout":ih=Ey=Ql=null;break;case"mousedown":xy=!0;break;case"contextmenu":case"mouseup":case"dragend":xy=!1,Fx(le,d,re);break;case"selectionchange":if(RM)break;case"keydown":case"keyup":Fx(le,d,re)}var Pe;if(yy)e:{switch(a){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Zl?Cx(a,d)&&(Ne="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Ne="onCompositionStart");Ne&&(Tx&&d.locale!=="ko"&&(Zl||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Zl&&(Pe=Rf()):(hi=re,Kl="value"in hi?hi.value:hi.textContent,Zl=!0)),Ae=Of(Z,Ne),0<Ae.length&&(Ne=new I(Ne,a,null,d,re),le.push({event:Ne,listeners:Ae}),Pe?Ne.data=Pe:(Pe=Rx(d),Pe!==null&&(Ne.data=Pe)))),(Pe=pM?mM(a,d):yM(a,d))&&(Z=Of(Z,"onBeforeInput"),0<Z.length&&(re=new I("onBeforeInput","beforeinput",null,d,re),le.push({event:re,listeners:Z}),re.data=Pe))}Hx(le,u)})}function oh(a,u,d){return{instance:a,listener:u,currentTarget:d}}function Of(a,u){for(var d=u+"Capture",p=[];a!==null;){var _=a,v=_.stateNode;_.tag===5&&v!==null&&(_=v,v=gn(a,d),v!=null&&p.unshift(oh(a,v,_)),v=gn(a,u),v!=null&&p.push(oh(a,v,_))),a=a.return}return p}function eu(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function qx(a,u,d,p,_){for(var v=u._reactName,A=[];d!==null&&d!==p;){var U=d,B=U.alternate,Z=U.stateNode;if(B!==null&&B===p)break;U.tag===5&&Z!==null&&(U=Z,_?(B=gn(d,v),B!=null&&A.unshift(oh(d,B,U))):_||(B=gn(d,v),B!=null&&A.push(oh(d,B,U)))),d=d.return}A.length!==0&&a.push({event:u,listeners:A})}var kM=/\r\n?/g,DM=/\u0000|\uFFFD/g;function Yx(a){return(typeof a=="string"?a:""+a).replace(kM,`
`).replace(DM,"")}function Vf(a,u,d){if(u=Yx(u),Yx(a)!==u&&d)throw Error(t(425))}function Ff(){}var Ay=null,Py=null;function by(a,u){return a==="textarea"||a==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var ky=typeof setTimeout=="function"?setTimeout:void 0,MM=typeof clearTimeout=="function"?clearTimeout:void 0,Zx=typeof Promise=="function"?Promise:void 0,NM=typeof queueMicrotask=="function"?queueMicrotask:typeof Zx<"u"?function(a){return Zx.resolve(null).then(a).catch(LM)}:ky;function LM(a){setTimeout(function(){throw a})}function Dy(a,u){var d=u,p=0;do{var _=d.nextSibling;if(a.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"){if(p===0){a.removeChild(_),so(u);return}p--}else d!=="$"&&d!=="$?"&&d!=="$!"||p++;d=_}while(d);so(u)}function uo(a){for(;a!=null;a=a.nextSibling){var u=a.nodeType;if(u===1||u===3)break;if(u===8){if(u=a.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return a}function Qx(a){a=a.previousSibling;for(var u=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(u===0)return a;u--}else d==="/$"&&u++}a=a.previousSibling}return null}var tu=Math.random().toString(36).slice(2),Gr="__reactFiber$"+tu,ah="__reactProps$"+tu,xs="__reactContainer$"+tu,My="__reactEvents$"+tu,OM="__reactListeners$"+tu,VM="__reactHandles$"+tu;function Ea(a){var u=a[Gr];if(u)return u;for(var d=a.parentNode;d;){if(u=d[xs]||d[Gr]){if(d=u.alternate,u.child!==null||d!==null&&d.child!==null)for(a=Qx(a);a!==null;){if(d=a[Gr])return d;a=Qx(a)}return u}a=d,d=a.parentNode}return null}function lh(a){return a=a[Gr]||a[xs],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function nu(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function jf(a){return a[ah]||null}var Ny=[],iu=-1;function co(a){return{current:a}}function Et(a){0>iu||(a.current=Ny[iu],Ny[iu]=null,iu--)}function _t(a,u){iu++,Ny[iu]=a.current,a.current=u}var ho={},Cn=co(ho),$n=co(!1),xa=ho;function ru(a,u){var d=a.type.contextTypes;if(!d)return ho;var p=a.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===u)return p.__reactInternalMemoizedMaskedChildContext;var _={},v;for(v in d)_[v]=u[v];return p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=u,a.__reactInternalMemoizedMaskedChildContext=_),_}function Hn(a){return a=a.childContextTypes,a!=null}function Uf(){Et($n),Et(Cn)}function Jx(a,u,d){if(Cn.current!==ho)throw Error(t(168));_t(Cn,u),_t($n,d)}function e1(a,u,d){var p=a.stateNode;if(u=u.childContextTypes,typeof p.getChildContext!="function")return d;p=p.getChildContext();for(var _ in p)if(!(_ in u))throw Error(t(108,Me(a)||"Unknown",_));return ne({},d,p)}function zf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||ho,xa=Cn.current,_t(Cn,a),_t($n,$n.current),!0}function t1(a,u,d){var p=a.stateNode;if(!p)throw Error(t(169));d?(a=e1(a,u,xa),p.__reactInternalMemoizedMergedChildContext=a,Et($n),Et(Cn),_t(Cn,a)):Et($n),_t($n,d)}var Ts=null,Bf=!1,Ly=!1;function n1(a){Ts===null?Ts=[a]:Ts.push(a)}function FM(a){Bf=!0,n1(a)}function fo(){if(!Ly&&Ts!==null){Ly=!0;var a=0,u=$e;try{var d=Ts;for($e=1;a<d.length;a++){var p=d[a];do p=p(!0);while(p!==null)}Ts=null,Bf=!1}catch(_){throw Ts!==null&&(Ts=Ts.slice(a+1)),Fc(Fl,fo),_}finally{$e=u,Ly=!1}}return null}var su=[],ou=0,Gf=null,Wf=0,Li=[],Oi=0,Ta=null,Is=1,Ss="";function Ia(a,u){su[ou++]=Wf,su[ou++]=Gf,Gf=a,Wf=u}function i1(a,u,d){Li[Oi++]=Is,Li[Oi++]=Ss,Li[Oi++]=Ta,Ta=a;var p=Is;a=Ss;var _=32-ui(p)-1;p&=~(1<<_),d+=1;var v=32-ui(u)+_;if(30<v){var A=_-_%5;v=(p&(1<<A)-1).toString(32),p>>=A,_-=A,Is=1<<32-ui(u)+_|d<<_|p,Ss=v+a}else Is=1<<v|d<<_|p,Ss=a}function Oy(a){a.return!==null&&(Ia(a,1),i1(a,1,0))}function Vy(a){for(;a===Gf;)Gf=su[--ou],su[ou]=null,Wf=su[--ou],su[ou]=null;for(;a===Ta;)Ta=Li[--Oi],Li[Oi]=null,Ss=Li[--Oi],Li[Oi]=null,Is=Li[--Oi],Li[Oi]=null}var gi=null,pi=null,St=!1,rr=null;function r1(a,u){var d=Ui(5,null,null,0);d.elementType="DELETED",d.stateNode=u,d.return=a,u=a.deletions,u===null?(a.deletions=[d],a.flags|=16):u.push(d)}function s1(a,u){switch(a.tag){case 5:var d=a.type;return u=u.nodeType!==1||d.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(a.stateNode=u,gi=a,pi=uo(u.firstChild),!0):!1;case 6:return u=a.pendingProps===""||u.nodeType!==3?null:u,u!==null?(a.stateNode=u,gi=a,pi=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(d=Ta!==null?{id:Is,overflow:Ss}:null,a.memoizedState={dehydrated:u,treeContext:d,retryLane:1073741824},d=Ui(18,null,null,0),d.stateNode=u,d.return=a,a.child=d,gi=a,pi=null,!0):!1;default:return!1}}function Fy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function jy(a){if(St){var u=pi;if(u){var d=u;if(!s1(a,u)){if(Fy(a))throw Error(t(418));u=uo(d.nextSibling);var p=gi;u&&s1(a,u)?r1(p,d):(a.flags=a.flags&-4097|2,St=!1,gi=a)}}else{if(Fy(a))throw Error(t(418));a.flags=a.flags&-4097|2,St=!1,gi=a}}}function o1(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;gi=a}function Kf(a){if(a!==gi)return!1;if(!St)return o1(a),St=!0,!1;var u;if((u=a.tag!==3)&&!(u=a.tag!==5)&&(u=a.type,u=u!=="head"&&u!=="body"&&!by(a.type,a.memoizedProps)),u&&(u=pi)){if(Fy(a))throw a1(),Error(t(418));for(;u;)r1(a,u),u=uo(u.nextSibling)}if(o1(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,u=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(u===0){pi=uo(a.nextSibling);break e}u--}else d!=="$"&&d!=="$!"&&d!=="$?"||u++}a=a.nextSibling}pi=null}}else pi=gi?uo(a.stateNode.nextSibling):null;return!0}function a1(){for(var a=pi;a;)a=uo(a.nextSibling)}function au(){pi=gi=null,St=!1}function Uy(a){rr===null?rr=[a]:rr.push(a)}var jM=O.ReactCurrentBatchConfig;function uh(a,u,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var p=d.stateNode}if(!p)throw Error(t(147,a));var _=p,v=""+a;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===v?u.ref:(u=function(A){var U=_.refs;A===null?delete U[v]:U[v]=A},u._stringRef=v,u)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function $f(a,u){throw a=Object.prototype.toString.call(u),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a))}function l1(a){var u=a._init;return u(a._payload)}function u1(a){function u(H,K){if(a){var q=H.deletions;q===null?(H.deletions=[K],H.flags|=16):q.push(K)}}function d(H,K){if(!a)return null;for(;K!==null;)u(H,K),K=K.sibling;return null}function p(H,K){for(H=new Map;K!==null;)K.key!==null?H.set(K.key,K):H.set(K.index,K),K=K.sibling;return H}function _(H,K){return H=Eo(H,K),H.index=0,H.sibling=null,H}function v(H,K,q){return H.index=q,a?(q=H.alternate,q!==null?(q=q.index,q<K?(H.flags|=2,K):q):(H.flags|=2,K)):(H.flags|=1048576,K)}function A(H){return a&&H.alternate===null&&(H.flags|=2),H}function U(H,K,q,ue){return K===null||K.tag!==6?(K=k_(q,H.mode,ue),K.return=H,K):(K=_(K,q),K.return=H,K)}function B(H,K,q,ue){var we=q.type;return we===D?re(H,K,q.props.children,ue,q.key):K!==null&&(K.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===fe&&l1(we)===K.type)?(ue=_(K,q.props),ue.ref=uh(H,K,q),ue.return=H,ue):(ue=mg(q.type,q.key,q.props,null,H.mode,ue),ue.ref=uh(H,K,q),ue.return=H,ue)}function Z(H,K,q,ue){return K===null||K.tag!==4||K.stateNode.containerInfo!==q.containerInfo||K.stateNode.implementation!==q.implementation?(K=D_(q,H.mode,ue),K.return=H,K):(K=_(K,q.children||[]),K.return=H,K)}function re(H,K,q,ue,we){return K===null||K.tag!==7?(K=Da(q,H.mode,ue,we),K.return=H,K):(K=_(K,q),K.return=H,K)}function le(H,K,q){if(typeof K=="string"&&K!==""||typeof K=="number")return K=k_(""+K,H.mode,q),K.return=H,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case F:return q=mg(K.type,K.key,K.props,null,H.mode,q),q.ref=uh(H,null,K),q.return=H,q;case W:return K=D_(K,H.mode,q),K.return=H,K;case fe:var ue=K._init;return le(H,ue(K._payload),q)}if(ut(K)||oe(K))return K=Da(K,H.mode,q,null),K.return=H,K;$f(H,K)}return null}function ie(H,K,q,ue){var we=K!==null?K.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return we!==null?null:U(H,K,""+q,ue);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case F:return q.key===we?B(H,K,q,ue):null;case W:return q.key===we?Z(H,K,q,ue):null;case fe:return we=q._init,ie(H,K,we(q._payload),ue)}if(ut(q)||oe(q))return we!==null?null:re(H,K,q,ue,null);$f(H,q)}return null}function ge(H,K,q,ue,we){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return H=H.get(q)||null,U(K,H,""+ue,we);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case F:return H=H.get(ue.key===null?q:ue.key)||null,B(K,H,ue,we);case W:return H=H.get(ue.key===null?q:ue.key)||null,Z(K,H,ue,we);case fe:var Ae=ue._init;return ge(H,K,q,Ae(ue._payload),we)}if(ut(ue)||oe(ue))return H=H.get(q)||null,re(K,H,ue,we,null);$f(K,ue)}return null}function ye(H,K,q,ue){for(var we=null,Ae=null,Pe=K,Ne=K=0,on=null;Pe!==null&&Ne<q.length;Ne++){Pe.index>Ne?(on=Pe,Pe=null):on=Pe.sibling;var Je=ie(H,Pe,q[Ne],ue);if(Je===null){Pe===null&&(Pe=on);break}a&&Pe&&Je.alternate===null&&u(H,Pe),K=v(Je,K,Ne),Ae===null?we=Je:Ae.sibling=Je,Ae=Je,Pe=on}if(Ne===q.length)return d(H,Pe),St&&Ia(H,Ne),we;if(Pe===null){for(;Ne<q.length;Ne++)Pe=le(H,q[Ne],ue),Pe!==null&&(K=v(Pe,K,Ne),Ae===null?we=Pe:Ae.sibling=Pe,Ae=Pe);return St&&Ia(H,Ne),we}for(Pe=p(H,Pe);Ne<q.length;Ne++)on=ge(Pe,H,Ne,q[Ne],ue),on!==null&&(a&&on.alternate!==null&&Pe.delete(on.key===null?Ne:on.key),K=v(on,K,Ne),Ae===null?we=on:Ae.sibling=on,Ae=on);return a&&Pe.forEach(function(xo){return u(H,xo)}),St&&Ia(H,Ne),we}function _e(H,K,q,ue){var we=oe(q);if(typeof we!="function")throw Error(t(150));if(q=we.call(q),q==null)throw Error(t(151));for(var Ae=we=null,Pe=K,Ne=K=0,on=null,Je=q.next();Pe!==null&&!Je.done;Ne++,Je=q.next()){Pe.index>Ne?(on=Pe,Pe=null):on=Pe.sibling;var xo=ie(H,Pe,Je.value,ue);if(xo===null){Pe===null&&(Pe=on);break}a&&Pe&&xo.alternate===null&&u(H,Pe),K=v(xo,K,Ne),Ae===null?we=xo:Ae.sibling=xo,Ae=xo,Pe=on}if(Je.done)return d(H,Pe),St&&Ia(H,Ne),we;if(Pe===null){for(;!Je.done;Ne++,Je=q.next())Je=le(H,Je.value,ue),Je!==null&&(K=v(Je,K,Ne),Ae===null?we=Je:Ae.sibling=Je,Ae=Je);return St&&Ia(H,Ne),we}for(Pe=p(H,Pe);!Je.done;Ne++,Je=q.next())Je=ge(Pe,H,Ne,Je.value,ue),Je!==null&&(a&&Je.alternate!==null&&Pe.delete(Je.key===null?Ne:Je.key),K=v(Je,K,Ne),Ae===null?we=Je:Ae.sibling=Je,Ae=Je);return a&&Pe.forEach(function(_N){return u(H,_N)}),St&&Ia(H,Ne),we}function jt(H,K,q,ue){if(typeof q=="object"&&q!==null&&q.type===D&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case F:e:{for(var we=q.key,Ae=K;Ae!==null;){if(Ae.key===we){if(we=q.type,we===D){if(Ae.tag===7){d(H,Ae.sibling),K=_(Ae,q.props.children),K.return=H,H=K;break e}}else if(Ae.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===fe&&l1(we)===Ae.type){d(H,Ae.sibling),K=_(Ae,q.props),K.ref=uh(H,Ae,q),K.return=H,H=K;break e}d(H,Ae);break}else u(H,Ae);Ae=Ae.sibling}q.type===D?(K=Da(q.props.children,H.mode,ue,q.key),K.return=H,H=K):(ue=mg(q.type,q.key,q.props,null,H.mode,ue),ue.ref=uh(H,K,q),ue.return=H,H=ue)}return A(H);case W:e:{for(Ae=q.key;K!==null;){if(K.key===Ae)if(K.tag===4&&K.stateNode.containerInfo===q.containerInfo&&K.stateNode.implementation===q.implementation){d(H,K.sibling),K=_(K,q.children||[]),K.return=H,H=K;break e}else{d(H,K);break}else u(H,K);K=K.sibling}K=D_(q,H.mode,ue),K.return=H,H=K}return A(H);case fe:return Ae=q._init,jt(H,K,Ae(q._payload),ue)}if(ut(q))return ye(H,K,q,ue);if(oe(q))return _e(H,K,q,ue);$f(H,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,K!==null&&K.tag===6?(d(H,K.sibling),K=_(K,q),K.return=H,H=K):(d(H,K),K=k_(q,H.mode,ue),K.return=H,H=K),A(H)):d(H,K)}return jt}var lu=u1(!0),c1=u1(!1),Hf=co(null),Xf=null,uu=null,zy=null;function By(){zy=uu=Xf=null}function Gy(a){var u=Hf.current;Et(Hf),a._currentValue=u}function Wy(a,u,d){for(;a!==null;){var p=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,p!==null&&(p.childLanes|=u)):p!==null&&(p.childLanes&u)!==u&&(p.childLanes|=u),a===d)break;a=a.return}}function cu(a,u){Xf=a,zy=uu=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&u)!==0&&(Xn=!0),a.firstContext=null)}function Vi(a){var u=a._currentValue;if(zy!==a)if(a={context:a,memoizedValue:u,next:null},uu===null){if(Xf===null)throw Error(t(308));uu=a,Xf.dependencies={lanes:0,firstContext:a}}else uu=uu.next=a;return u}var Sa=null;function Ky(a){Sa===null?Sa=[a]:Sa.push(a)}function h1(a,u,d,p){var _=u.interleaved;return _===null?(d.next=d,Ky(u)):(d.next=_.next,_.next=d),u.interleaved=d,Cs(a,p)}function Cs(a,u){a.lanes|=u;var d=a.alternate;for(d!==null&&(d.lanes|=u),d=a,a=a.return;a!==null;)a.childLanes|=u,d=a.alternate,d!==null&&(d.childLanes|=u),d=a,a=a.return;return d.tag===3?d.stateNode:null}var go=!1;function $y(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function d1(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Rs(a,u){return{eventTime:a,lane:u,tag:0,payload:null,callback:null,next:null}}function po(a,u,d){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(Qe&2)!==0){var _=p.pending;return _===null?u.next=u:(u.next=_.next,_.next=u),p.pending=u,Cs(a,d)}return _=p.interleaved,_===null?(u.next=u,Ky(p)):(u.next=_.next,_.next=u),p.interleaved=u,Cs(a,d)}function qf(a,u,d){if(u=u.updateQueue,u!==null&&(u=u.shared,(d&4194240)!==0)){var p=u.lanes;p&=a.pendingLanes,d|=p,u.lanes=d,Wc(a,d)}}function f1(a,u){var d=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var _=null,v=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};v===null?_=v=A:v=v.next=A,d=d.next}while(d!==null);v===null?_=v=u:v=v.next=u}else _=v=u;d={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:v,shared:p.shared,effects:p.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=u}function Yf(a,u,d,p){var _=a.updateQueue;go=!1;var v=_.firstBaseUpdate,A=_.lastBaseUpdate,U=_.shared.pending;if(U!==null){_.shared.pending=null;var B=U,Z=B.next;B.next=null,A===null?v=Z:A.next=Z,A=B;var re=a.alternate;re!==null&&(re=re.updateQueue,U=re.lastBaseUpdate,U!==A&&(U===null?re.firstBaseUpdate=Z:U.next=Z,re.lastBaseUpdate=B))}if(v!==null){var le=_.baseState;A=0,re=Z=B=null,U=v;do{var ie=U.lane,ge=U.eventTime;if((p&ie)===ie){re!==null&&(re=re.next={eventTime:ge,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ye=a,_e=U;switch(ie=u,ge=d,_e.tag){case 1:if(ye=_e.payload,typeof ye=="function"){le=ye.call(ge,le,ie);break e}le=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=_e.payload,ie=typeof ye=="function"?ye.call(ge,le,ie):ye,ie==null)break e;le=ne({},le,ie);break e;case 2:go=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,ie=_.effects,ie===null?_.effects=[U]:ie.push(U))}else ge={eventTime:ge,lane:ie,tag:U.tag,payload:U.payload,callback:U.callback,next:null},re===null?(Z=re=ge,B=le):re=re.next=ge,A|=ie;if(U=U.next,U===null){if(U=_.shared.pending,U===null)break;ie=U,U=ie.next,ie.next=null,_.lastBaseUpdate=ie,_.shared.pending=null}}while(!0);if(re===null&&(B=le),_.baseState=B,_.firstBaseUpdate=Z,_.lastBaseUpdate=re,u=_.shared.interleaved,u!==null){_=u;do A|=_.lane,_=_.next;while(_!==u)}else v===null&&(_.shared.lanes=0);Aa|=A,a.lanes=A,a.memoizedState=le}}function g1(a,u,d){if(a=u.effects,u.effects=null,a!==null)for(u=0;u<a.length;u++){var p=a[u],_=p.callback;if(_!==null){if(p.callback=null,p=d,typeof _!="function")throw Error(t(191,_));_.call(p)}}}var ch={},Wr=co(ch),hh=co(ch),dh=co(ch);function Ca(a){if(a===ch)throw Error(t(174));return a}function Hy(a,u){switch(_t(dh,u),_t(hh,a),_t(Wr,ch),a=u.nodeType,a){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Ji(null,"");break;default:a=a===8?u.parentNode:u,u=a.namespaceURI||null,a=a.tagName,u=Ji(u,a)}Et(Wr),_t(Wr,u)}function hu(){Et(Wr),Et(hh),Et(dh)}function p1(a){Ca(dh.current);var u=Ca(Wr.current),d=Ji(u,a.type);u!==d&&(_t(hh,a),_t(Wr,d))}function Xy(a){hh.current===a&&(Et(Wr),Et(hh))}var At=co(0);function Zf(a){for(var u=a;u!==null;){if(u.tag===13){var d=u.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var qy=[];function Yy(){for(var a=0;a<qy.length;a++)qy[a]._workInProgressVersionPrimary=null;qy.length=0}var Qf=O.ReactCurrentDispatcher,Zy=O.ReactCurrentBatchConfig,Ra=0,Pt=null,qt=null,rn=null,Jf=!1,fh=!1,gh=0,UM=0;function Rn(){throw Error(t(321))}function Qy(a,u){if(u===null)return!1;for(var d=0;d<u.length&&d<a.length;d++)if(!ir(a[d],u[d]))return!1;return!0}function Jy(a,u,d,p,_,v){if(Ra=v,Pt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Qf.current=a===null||a.memoizedState===null?WM:KM,a=d(p,_),fh){v=0;do{if(fh=!1,gh=0,25<=v)throw Error(t(301));v+=1,rn=qt=null,u.updateQueue=null,Qf.current=$M,a=d(p,_)}while(fh)}if(Qf.current=ng,u=qt!==null&&qt.next!==null,Ra=0,rn=qt=Pt=null,Jf=!1,u)throw Error(t(300));return a}function e_(){var a=gh!==0;return gh=0,a}function Kr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Pt.memoizedState=rn=a:rn=rn.next=a,rn}function Fi(){if(qt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=qt.next;var u=rn===null?Pt.memoizedState:rn.next;if(u!==null)rn=u,qt=a;else{if(a===null)throw Error(t(310));qt=a,a={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},rn===null?Pt.memoizedState=rn=a:rn=rn.next=a}return rn}function ph(a,u){return typeof u=="function"?u(a):u}function t_(a){var u=Fi(),d=u.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=qt,_=p.baseQueue,v=d.pending;if(v!==null){if(_!==null){var A=_.next;_.next=v.next,v.next=A}p.baseQueue=_=v,d.pending=null}if(_!==null){v=_.next,p=p.baseState;var U=A=null,B=null,Z=v;do{var re=Z.lane;if((Ra&re)===re)B!==null&&(B=B.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),p=Z.hasEagerState?Z.eagerState:a(p,Z.action);else{var le={lane:re,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};B===null?(U=B=le,A=p):B=B.next=le,Pt.lanes|=re,Aa|=re}Z=Z.next}while(Z!==null&&Z!==v);B===null?A=p:B.next=U,ir(p,u.memoizedState)||(Xn=!0),u.memoizedState=p,u.baseState=A,u.baseQueue=B,d.lastRenderedState=p}if(a=d.interleaved,a!==null){_=a;do v=_.lane,Pt.lanes|=v,Aa|=v,_=_.next;while(_!==a)}else _===null&&(d.lanes=0);return[u.memoizedState,d.dispatch]}function n_(a){var u=Fi(),d=u.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=d.dispatch,_=d.pending,v=u.memoizedState;if(_!==null){d.pending=null;var A=_=_.next;do v=a(v,A.action),A=A.next;while(A!==_);ir(v,u.memoizedState)||(Xn=!0),u.memoizedState=v,u.baseQueue===null&&(u.baseState=v),d.lastRenderedState=v}return[v,p]}function m1(){}function y1(a,u){var d=Pt,p=Fi(),_=u(),v=!ir(p.memoizedState,_);if(v&&(p.memoizedState=_,Xn=!0),p=p.queue,i_(w1.bind(null,d,p,a),[a]),p.getSnapshot!==u||v||rn!==null&&rn.memoizedState.tag&1){if(d.flags|=2048,mh(9,v1.bind(null,d,p,_,u),void 0,null),sn===null)throw Error(t(349));(Ra&30)!==0||_1(d,u,_)}return _}function _1(a,u,d){a.flags|=16384,a={getSnapshot:u,value:d},u=Pt.updateQueue,u===null?(u={lastEffect:null,stores:null},Pt.updateQueue=u,u.stores=[a]):(d=u.stores,d===null?u.stores=[a]:d.push(a))}function v1(a,u,d,p){u.value=d,u.getSnapshot=p,E1(u)&&x1(a)}function w1(a,u,d){return d(function(){E1(u)&&x1(a)})}function E1(a){var u=a.getSnapshot;a=a.value;try{var d=u();return!ir(a,d)}catch{return!0}}function x1(a){var u=Cs(a,1);u!==null&&lr(u,a,1,-1)}function T1(a){var u=Kr();return typeof a=="function"&&(a=a()),u.memoizedState=u.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ph,lastRenderedState:a},u.queue=a,a=a.dispatch=GM.bind(null,Pt,a),[u.memoizedState,a]}function mh(a,u,d,p){return a={tag:a,create:u,destroy:d,deps:p,next:null},u=Pt.updateQueue,u===null?(u={lastEffect:null,stores:null},Pt.updateQueue=u,u.lastEffect=a.next=a):(d=u.lastEffect,d===null?u.lastEffect=a.next=a:(p=d.next,d.next=a,a.next=p,u.lastEffect=a)),a}function I1(){return Fi().memoizedState}function eg(a,u,d,p){var _=Kr();Pt.flags|=a,_.memoizedState=mh(1|u,d,void 0,p===void 0?null:p)}function tg(a,u,d,p){var _=Fi();p=p===void 0?null:p;var v=void 0;if(qt!==null){var A=qt.memoizedState;if(v=A.destroy,p!==null&&Qy(p,A.deps)){_.memoizedState=mh(u,d,v,p);return}}Pt.flags|=a,_.memoizedState=mh(1|u,d,v,p)}function S1(a,u){return eg(8390656,8,a,u)}function i_(a,u){return tg(2048,8,a,u)}function C1(a,u){return tg(4,2,a,u)}function R1(a,u){return tg(4,4,a,u)}function A1(a,u){if(typeof u=="function")return a=a(),u(a),function(){u(null)};if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function P1(a,u,d){return d=d!=null?d.concat([a]):null,tg(4,4,A1.bind(null,u,a),d)}function r_(){}function b1(a,u){var d=Fi();u=u===void 0?null:u;var p=d.memoizedState;return p!==null&&u!==null&&Qy(u,p[1])?p[0]:(d.memoizedState=[a,u],a)}function k1(a,u){var d=Fi();u=u===void 0?null:u;var p=d.memoizedState;return p!==null&&u!==null&&Qy(u,p[1])?p[0]:(a=a(),d.memoizedState=[a,u],a)}function D1(a,u,d){return(Ra&21)===0?(a.baseState&&(a.baseState=!1,Xn=!0),a.memoizedState=d):(ir(d,u)||(d=Bc(),Pt.lanes|=d,Aa|=d,a.baseState=!0),u)}function zM(a,u){var d=$e;$e=d!==0&&4>d?d:4,a(!0);var p=Zy.transition;Zy.transition={};try{a(!1),u()}finally{$e=d,Zy.transition=p}}function M1(){return Fi().memoizedState}function BM(a,u,d){var p=vo(a);if(d={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null},N1(a))L1(u,d);else if(d=h1(a,u,d,p),d!==null){var _=jn();lr(d,a,p,_),O1(d,u,p)}}function GM(a,u,d){var p=vo(a),_={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null};if(N1(a))L1(u,_);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=u.lastRenderedReducer,v!==null))try{var A=u.lastRenderedState,U=v(A,d);if(_.hasEagerState=!0,_.eagerState=U,ir(U,A)){var B=u.interleaved;B===null?(_.next=_,Ky(u)):(_.next=B.next,B.next=_),u.interleaved=_;return}}catch{}d=h1(a,u,_,p),d!==null&&(_=jn(),lr(d,a,p,_),O1(d,u,p))}}function N1(a){var u=a.alternate;return a===Pt||u!==null&&u===Pt}function L1(a,u){fh=Jf=!0;var d=a.pending;d===null?u.next=u:(u.next=d.next,d.next=u),a.pending=u}function O1(a,u,d){if((d&4194240)!==0){var p=u.lanes;p&=a.pendingLanes,d|=p,u.lanes=d,Wc(a,d)}}var ng={readContext:Vi,useCallback:Rn,useContext:Rn,useEffect:Rn,useImperativeHandle:Rn,useInsertionEffect:Rn,useLayoutEffect:Rn,useMemo:Rn,useReducer:Rn,useRef:Rn,useState:Rn,useDebugValue:Rn,useDeferredValue:Rn,useTransition:Rn,useMutableSource:Rn,useSyncExternalStore:Rn,useId:Rn,unstable_isNewReconciler:!1},WM={readContext:Vi,useCallback:function(a,u){return Kr().memoizedState=[a,u===void 0?null:u],a},useContext:Vi,useEffect:S1,useImperativeHandle:function(a,u,d){return d=d!=null?d.concat([a]):null,eg(4194308,4,A1.bind(null,u,a),d)},useLayoutEffect:function(a,u){return eg(4194308,4,a,u)},useInsertionEffect:function(a,u){return eg(4,2,a,u)},useMemo:function(a,u){var d=Kr();return u=u===void 0?null:u,a=a(),d.memoizedState=[a,u],a},useReducer:function(a,u,d){var p=Kr();return u=d!==void 0?d(u):u,p.memoizedState=p.baseState=u,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:u},p.queue=a,a=a.dispatch=BM.bind(null,Pt,a),[p.memoizedState,a]},useRef:function(a){var u=Kr();return a={current:a},u.memoizedState=a},useState:T1,useDebugValue:r_,useDeferredValue:function(a){return Kr().memoizedState=a},useTransition:function(){var a=T1(!1),u=a[0];return a=zM.bind(null,a[1]),Kr().memoizedState=a,[u,a]},useMutableSource:function(){},useSyncExternalStore:function(a,u,d){var p=Pt,_=Kr();if(St){if(d===void 0)throw Error(t(407));d=d()}else{if(d=u(),sn===null)throw Error(t(349));(Ra&30)!==0||_1(p,u,d)}_.memoizedState=d;var v={value:d,getSnapshot:u};return _.queue=v,S1(w1.bind(null,p,v,a),[a]),p.flags|=2048,mh(9,v1.bind(null,p,v,d,u),void 0,null),d},useId:function(){var a=Kr(),u=sn.identifierPrefix;if(St){var d=Ss,p=Is;d=(p&~(1<<32-ui(p)-1)).toString(32)+d,u=":"+u+"R"+d,d=gh++,0<d&&(u+="H"+d.toString(32)),u+=":"}else d=UM++,u=":"+u+"r"+d.toString(32)+":";return a.memoizedState=u},unstable_isNewReconciler:!1},KM={readContext:Vi,useCallback:b1,useContext:Vi,useEffect:i_,useImperativeHandle:P1,useInsertionEffect:C1,useLayoutEffect:R1,useMemo:k1,useReducer:t_,useRef:I1,useState:function(){return t_(ph)},useDebugValue:r_,useDeferredValue:function(a){var u=Fi();return D1(u,qt.memoizedState,a)},useTransition:function(){var a=t_(ph)[0],u=Fi().memoizedState;return[a,u]},useMutableSource:m1,useSyncExternalStore:y1,useId:M1,unstable_isNewReconciler:!1},$M={readContext:Vi,useCallback:b1,useContext:Vi,useEffect:i_,useImperativeHandle:P1,useInsertionEffect:C1,useLayoutEffect:R1,useMemo:k1,useReducer:n_,useRef:I1,useState:function(){return n_(ph)},useDebugValue:r_,useDeferredValue:function(a){var u=Fi();return qt===null?u.memoizedState=a:D1(u,qt.memoizedState,a)},useTransition:function(){var a=n_(ph)[0],u=Fi().memoizedState;return[a,u]},useMutableSource:m1,useSyncExternalStore:y1,useId:M1,unstable_isNewReconciler:!1};function sr(a,u){if(a&&a.defaultProps){u=ne({},u),a=a.defaultProps;for(var d in a)u[d]===void 0&&(u[d]=a[d]);return u}return u}function s_(a,u,d,p){u=a.memoizedState,d=d(p,u),d=d==null?u:ne({},u,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var ig={isMounted:function(a){return(a=a._reactInternals)?tr(a)===a:!1},enqueueSetState:function(a,u,d){a=a._reactInternals;var p=jn(),_=vo(a),v=Rs(p,_);v.payload=u,d!=null&&(v.callback=d),u=po(a,v,_),u!==null&&(lr(u,a,_,p),qf(u,a,_))},enqueueReplaceState:function(a,u,d){a=a._reactInternals;var p=jn(),_=vo(a),v=Rs(p,_);v.tag=1,v.payload=u,d!=null&&(v.callback=d),u=po(a,v,_),u!==null&&(lr(u,a,_,p),qf(u,a,_))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var d=jn(),p=vo(a),_=Rs(d,p);_.tag=2,u!=null&&(_.callback=u),u=po(a,_,p),u!==null&&(lr(u,a,p,d),qf(u,a,p))}};function V1(a,u,d,p,_,v,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,v,A):u.prototype&&u.prototype.isPureReactComponent?!nh(d,p)||!nh(_,v):!0}function F1(a,u,d){var p=!1,_=ho,v=u.contextType;return typeof v=="object"&&v!==null?v=Vi(v):(_=Hn(u)?xa:Cn.current,p=u.contextTypes,v=(p=p!=null)?ru(a,_):ho),u=new u(d,v),a.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=ig,a.stateNode=u,u._reactInternals=a,p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=_,a.__reactInternalMemoizedMaskedChildContext=v),u}function j1(a,u,d,p){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(d,p),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(d,p),u.state!==a&&ig.enqueueReplaceState(u,u.state,null)}function o_(a,u,d,p){var _=a.stateNode;_.props=d,_.state=a.memoizedState,_.refs={},$y(a);var v=u.contextType;typeof v=="object"&&v!==null?_.context=Vi(v):(v=Hn(u)?xa:Cn.current,_.context=ru(a,v)),_.state=a.memoizedState,v=u.getDerivedStateFromProps,typeof v=="function"&&(s_(a,u,v,d),_.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(u=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),u!==_.state&&ig.enqueueReplaceState(_,_.state,null),Yf(a,d,_,p),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308)}function du(a,u){try{var d="",p=u;do d+=Ie(p),p=p.return;while(p);var _=d}catch(v){_=`
Error generating stack: `+v.message+`
`+v.stack}return{value:a,source:u,stack:_,digest:null}}function a_(a,u,d){return{value:a,source:null,stack:d??null,digest:u??null}}function l_(a,u){try{console.error(u.value)}catch(d){setTimeout(function(){throw d})}}var HM=typeof WeakMap=="function"?WeakMap:Map;function U1(a,u,d){d=Rs(-1,d),d.tag=3,d.payload={element:null};var p=u.value;return d.callback=function(){cg||(cg=!0,T_=p),l_(a,u)},d}function z1(a,u,d){d=Rs(-1,d),d.tag=3;var p=a.type.getDerivedStateFromError;if(typeof p=="function"){var _=u.value;d.payload=function(){return p(_)},d.callback=function(){l_(a,u)}}var v=a.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(d.callback=function(){l_(a,u),typeof p!="function"&&(yo===null?yo=new Set([this]):yo.add(this));var A=u.stack;this.componentDidCatch(u.value,{componentStack:A!==null?A:""})}),d}function B1(a,u,d){var p=a.pingCache;if(p===null){p=a.pingCache=new HM;var _=new Set;p.set(u,_)}else _=p.get(u),_===void 0&&(_=new Set,p.set(u,_));_.has(d)||(_.add(d),a=aN.bind(null,a,u,d),u.then(a,a))}function G1(a){do{var u;if((u=a.tag===13)&&(u=a.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return a;a=a.return}while(a!==null);return null}function W1(a,u,d,p,_){return(a.mode&1)===0?(a===u?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(u=Rs(-1,1),u.tag=2,po(d,u,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=_,a)}var XM=O.ReactCurrentOwner,Xn=!1;function Fn(a,u,d,p){u.child=a===null?c1(u,null,d,p):lu(u,a.child,d,p)}function K1(a,u,d,p,_){d=d.render;var v=u.ref;return cu(u,_),p=Jy(a,u,d,p,v,_),d=e_(),a!==null&&!Xn?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~_,As(a,u,_)):(St&&d&&Oy(u),u.flags|=1,Fn(a,u,p,_),u.child)}function $1(a,u,d,p,_){if(a===null){var v=d.type;return typeof v=="function"&&!b_(v)&&v.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(u.tag=15,u.type=v,H1(a,u,v,p,_)):(a=mg(d.type,null,p,u,u.mode,_),a.ref=u.ref,a.return=u,u.child=a)}if(v=a.child,(a.lanes&_)===0){var A=v.memoizedProps;if(d=d.compare,d=d!==null?d:nh,d(A,p)&&a.ref===u.ref)return As(a,u,_)}return u.flags|=1,a=Eo(v,p),a.ref=u.ref,a.return=u,u.child=a}function H1(a,u,d,p,_){if(a!==null){var v=a.memoizedProps;if(nh(v,p)&&a.ref===u.ref)if(Xn=!1,u.pendingProps=p=v,(a.lanes&_)!==0)(a.flags&131072)!==0&&(Xn=!0);else return u.lanes=a.lanes,As(a,u,_)}return u_(a,u,d,p,_)}function X1(a,u,d){var p=u.pendingProps,_=p.children,v=a!==null?a.memoizedState:null;if(p.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(gu,mi),mi|=d;else{if((d&1073741824)===0)return a=v!==null?v.baseLanes|d:d,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:a,cachePool:null,transitions:null},u.updateQueue=null,_t(gu,mi),mi|=a,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=v!==null?v.baseLanes:d,_t(gu,mi),mi|=p}else v!==null?(p=v.baseLanes|d,u.memoizedState=null):p=d,_t(gu,mi),mi|=p;return Fn(a,u,_,d),u.child}function q1(a,u){var d=u.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(u.flags|=512,u.flags|=2097152)}function u_(a,u,d,p,_){var v=Hn(d)?xa:Cn.current;return v=ru(u,v),cu(u,_),d=Jy(a,u,d,p,v,_),p=e_(),a!==null&&!Xn?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~_,As(a,u,_)):(St&&p&&Oy(u),u.flags|=1,Fn(a,u,d,_),u.child)}function Y1(a,u,d,p,_){if(Hn(d)){var v=!0;zf(u)}else v=!1;if(cu(u,_),u.stateNode===null)sg(a,u),F1(u,d,p),o_(u,d,p,_),p=!0;else if(a===null){var A=u.stateNode,U=u.memoizedProps;A.props=U;var B=A.context,Z=d.contextType;typeof Z=="object"&&Z!==null?Z=Vi(Z):(Z=Hn(d)?xa:Cn.current,Z=ru(u,Z));var re=d.getDerivedStateFromProps,le=typeof re=="function"||typeof A.getSnapshotBeforeUpdate=="function";le||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==p||B!==Z)&&j1(u,A,p,Z),go=!1;var ie=u.memoizedState;A.state=ie,Yf(u,p,A,_),B=u.memoizedState,U!==p||ie!==B||$n.current||go?(typeof re=="function"&&(s_(u,d,re,p),B=u.memoizedState),(U=go||V1(u,d,U,p,ie,B,Z))?(le||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(u.flags|=4194308)):(typeof A.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=p,u.memoizedState=B),A.props=p,A.state=B,A.context=Z,p=U):(typeof A.componentDidMount=="function"&&(u.flags|=4194308),p=!1)}else{A=u.stateNode,d1(a,u),U=u.memoizedProps,Z=u.type===u.elementType?U:sr(u.type,U),A.props=Z,le=u.pendingProps,ie=A.context,B=d.contextType,typeof B=="object"&&B!==null?B=Vi(B):(B=Hn(d)?xa:Cn.current,B=ru(u,B));var ge=d.getDerivedStateFromProps;(re=typeof ge=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==le||ie!==B)&&j1(u,A,p,B),go=!1,ie=u.memoizedState,A.state=ie,Yf(u,p,A,_);var ye=u.memoizedState;U!==le||ie!==ye||$n.current||go?(typeof ge=="function"&&(s_(u,d,ge,p),ye=u.memoizedState),(Z=go||V1(u,d,Z,p,ie,ye,B)||!1)?(re||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,ye,B),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,ye,B)),typeof A.componentDidUpdate=="function"&&(u.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=1024),u.memoizedProps=p,u.memoizedState=ye),A.props=p,A.state=ye,A.context=B,p=Z):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=1024),p=!1)}return c_(a,u,d,p,v,_)}function c_(a,u,d,p,_,v){q1(a,u);var A=(u.flags&128)!==0;if(!p&&!A)return _&&t1(u,d,!1),As(a,u,v);p=u.stateNode,XM.current=u;var U=A&&typeof d.getDerivedStateFromError!="function"?null:p.render();return u.flags|=1,a!==null&&A?(u.child=lu(u,a.child,null,v),u.child=lu(u,null,U,v)):Fn(a,u,U,v),u.memoizedState=p.state,_&&t1(u,d,!0),u.child}function Z1(a){var u=a.stateNode;u.pendingContext?Jx(a,u.pendingContext,u.pendingContext!==u.context):u.context&&Jx(a,u.context,!1),Hy(a,u.containerInfo)}function Q1(a,u,d,p,_){return au(),Uy(_),u.flags|=256,Fn(a,u,d,p),u.child}var h_={dehydrated:null,treeContext:null,retryLane:0};function d_(a){return{baseLanes:a,cachePool:null,transitions:null}}function J1(a,u,d){var p=u.pendingProps,_=At.current,v=!1,A=(u.flags&128)!==0,U;if((U=A)||(U=a!==null&&a.memoizedState===null?!1:(_&2)!==0),U?(v=!0,u.flags&=-129):(a===null||a.memoizedState!==null)&&(_|=1),_t(At,_&1),a===null)return jy(u),a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((u.mode&1)===0?u.lanes=1:a.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(A=p.children,a=p.fallback,v?(p=u.mode,v=u.child,A={mode:"hidden",children:A},(p&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=A):v=yg(A,p,0,null),a=Da(a,p,d,null),v.return=u,a.return=u,v.sibling=a,u.child=v,u.child.memoizedState=d_(d),u.memoizedState=h_,a):f_(u,A));if(_=a.memoizedState,_!==null&&(U=_.dehydrated,U!==null))return qM(a,u,A,p,U,_,d);if(v){v=p.fallback,A=u.mode,_=a.child,U=_.sibling;var B={mode:"hidden",children:p.children};return(A&1)===0&&u.child!==_?(p=u.child,p.childLanes=0,p.pendingProps=B,u.deletions=null):(p=Eo(_,B),p.subtreeFlags=_.subtreeFlags&14680064),U!==null?v=Eo(U,v):(v=Da(v,A,d,null),v.flags|=2),v.return=u,p.return=u,p.sibling=v,u.child=p,p=v,v=u.child,A=a.child.memoizedState,A=A===null?d_(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},v.memoizedState=A,v.childLanes=a.childLanes&~d,u.memoizedState=h_,p}return v=a.child,a=v.sibling,p=Eo(v,{mode:"visible",children:p.children}),(u.mode&1)===0&&(p.lanes=d),p.return=u,p.sibling=null,a!==null&&(d=u.deletions,d===null?(u.deletions=[a],u.flags|=16):d.push(a)),u.child=p,u.memoizedState=null,p}function f_(a,u){return u=yg({mode:"visible",children:u},a.mode,0,null),u.return=a,a.child=u}function rg(a,u,d,p){return p!==null&&Uy(p),lu(u,a.child,null,d),a=f_(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function qM(a,u,d,p,_,v,A){if(d)return u.flags&256?(u.flags&=-257,p=a_(Error(t(422))),rg(a,u,A,p)):u.memoizedState!==null?(u.child=a.child,u.flags|=128,null):(v=p.fallback,_=u.mode,p=yg({mode:"visible",children:p.children},_,0,null),v=Da(v,_,A,null),v.flags|=2,p.return=u,v.return=u,p.sibling=v,u.child=p,(u.mode&1)!==0&&lu(u,a.child,null,A),u.child.memoizedState=d_(A),u.memoizedState=h_,v);if((u.mode&1)===0)return rg(a,u,A,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var U=p.dgst;return p=U,v=Error(t(419)),p=a_(v,p,void 0),rg(a,u,A,p)}if(U=(A&a.childLanes)!==0,Xn||U){if(p=sn,p!==null){switch(A&-A){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(p.suspendedLanes|A))!==0?0:_,_!==0&&_!==v.retryLane&&(v.retryLane=_,Cs(a,_),lr(p,a,_,-1))}return P_(),p=a_(Error(t(421))),rg(a,u,A,p)}return _.data==="$?"?(u.flags|=128,u.child=a.child,u=lN.bind(null,a),_._reactRetry=u,null):(a=v.treeContext,pi=uo(_.nextSibling),gi=u,St=!0,rr=null,a!==null&&(Li[Oi++]=Is,Li[Oi++]=Ss,Li[Oi++]=Ta,Is=a.id,Ss=a.overflow,Ta=u),u=f_(u,p.children),u.flags|=4096,u)}function eT(a,u,d){a.lanes|=u;var p=a.alternate;p!==null&&(p.lanes|=u),Wy(a.return,u,d)}function g_(a,u,d,p,_){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:_}:(v.isBackwards=u,v.rendering=null,v.renderingStartTime=0,v.last=p,v.tail=d,v.tailMode=_)}function tT(a,u,d){var p=u.pendingProps,_=p.revealOrder,v=p.tail;if(Fn(a,u,p.children,d),p=At.current,(p&2)!==0)p=p&1|2,u.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&eT(a,d,u);else if(a.tag===19)eT(a,d,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}p&=1}if(_t(At,p),(u.mode&1)===0)u.memoizedState=null;else switch(_){case"forwards":for(d=u.child,_=null;d!==null;)a=d.alternate,a!==null&&Zf(a)===null&&(_=d),d=d.sibling;d=_,d===null?(_=u.child,u.child=null):(_=d.sibling,d.sibling=null),g_(u,!1,_,d,v);break;case"backwards":for(d=null,_=u.child,u.child=null;_!==null;){if(a=_.alternate,a!==null&&Zf(a)===null){u.child=_;break}a=_.sibling,_.sibling=d,d=_,_=a}g_(u,!0,d,null,v);break;case"together":g_(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function sg(a,u){(u.mode&1)===0&&a!==null&&(a.alternate=null,u.alternate=null,u.flags|=2)}function As(a,u,d){if(a!==null&&(u.dependencies=a.dependencies),Aa|=u.lanes,(d&u.childLanes)===0)return null;if(a!==null&&u.child!==a.child)throw Error(t(153));if(u.child!==null){for(a=u.child,d=Eo(a,a.pendingProps),u.child=d,d.return=u;a.sibling!==null;)a=a.sibling,d=d.sibling=Eo(a,a.pendingProps),d.return=u;d.sibling=null}return u.child}function YM(a,u,d){switch(u.tag){case 3:Z1(u),au();break;case 5:p1(u);break;case 1:Hn(u.type)&&zf(u);break;case 4:Hy(u,u.stateNode.containerInfo);break;case 10:var p=u.type._context,_=u.memoizedProps.value;_t(Hf,p._currentValue),p._currentValue=_;break;case 13:if(p=u.memoizedState,p!==null)return p.dehydrated!==null?(_t(At,At.current&1),u.flags|=128,null):(d&u.child.childLanes)!==0?J1(a,u,d):(_t(At,At.current&1),a=As(a,u,d),a!==null?a.sibling:null);_t(At,At.current&1);break;case 19:if(p=(d&u.childLanes)!==0,(a.flags&128)!==0){if(p)return tT(a,u,d);u.flags|=128}if(_=u.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),_t(At,At.current),p)break;return null;case 22:case 23:return u.lanes=0,X1(a,u,d)}return As(a,u,d)}var nT,p_,iT,rT;nT=function(a,u){for(var d=u.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},p_=function(){},iT=function(a,u,d,p){var _=a.memoizedProps;if(_!==p){a=u.stateNode,Ca(Wr.current);var v=null;switch(d){case"input":_=Wn(a,_),p=Wn(a,p),v=[];break;case"select":_=ne({},_,{value:void 0}),p=ne({},p,{value:void 0}),v=[];break;case"textarea":_=Ai(a,_),p=Ai(a,p),v=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(a.onclick=Ff)}Ln(d,p);var A;d=null;for(Z in _)if(!p.hasOwnProperty(Z)&&_.hasOwnProperty(Z)&&_[Z]!=null)if(Z==="style"){var U=_[Z];for(A in U)U.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(r.hasOwnProperty(Z)?v||(v=[]):(v=v||[]).push(Z,null));for(Z in p){var B=p[Z];if(U=_?.[Z],p.hasOwnProperty(Z)&&B!==U&&(B!=null||U!=null))if(Z==="style")if(U){for(A in U)!U.hasOwnProperty(A)||B&&B.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in B)B.hasOwnProperty(A)&&U[A]!==B[A]&&(d||(d={}),d[A]=B[A])}else d||(v||(v=[]),v.push(Z,d)),d=B;else Z==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,U=U?U.__html:void 0,B!=null&&U!==B&&(v=v||[]).push(Z,B)):Z==="children"?typeof B!="string"&&typeof B!="number"||(v=v||[]).push(Z,""+B):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(r.hasOwnProperty(Z)?(B!=null&&Z==="onScroll"&&wt("scroll",a),v||U===B||(v=[])):(v=v||[]).push(Z,B))}d&&(v=v||[]).push("style",d);var Z=v;(u.updateQueue=Z)&&(u.flags|=4)}},rT=function(a,u,d,p){d!==p&&(u.flags|=4)};function yh(a,u){if(!St)switch(a.tailMode){case"hidden":u=a.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function An(a){var u=a.alternate!==null&&a.alternate.child===a.child,d=0,p=0;if(u)for(var _=a.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=p,a.childLanes=d,u}function ZM(a,u,d){var p=u.pendingProps;switch(Vy(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(u),null;case 1:return Hn(u.type)&&Uf(),An(u),null;case 3:return p=u.stateNode,hu(),Et($n),Et(Cn),Yy(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(Kf(u)?u.flags|=4:a===null||a.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,rr!==null&&(C_(rr),rr=null))),p_(a,u),An(u),null;case 5:Xy(u);var _=Ca(dh.current);if(d=u.type,a!==null&&u.stateNode!=null)iT(a,u,d,p,_),a.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!p){if(u.stateNode===null)throw Error(t(166));return An(u),null}if(a=Ca(Wr.current),Kf(u)){p=u.stateNode,d=u.type;var v=u.memoizedProps;switch(p[Gr]=u,p[ah]=v,a=(u.mode&1)!==0,d){case"dialog":wt("cancel",p),wt("close",p);break;case"iframe":case"object":case"embed":wt("load",p);break;case"video":case"audio":for(_=0;_<rh.length;_++)wt(rh[_],p);break;case"source":wt("error",p);break;case"img":case"image":case"link":wt("error",p),wt("load",p);break;case"details":wt("toggle",p);break;case"input":cn(p,v),wt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!v.multiple},wt("invalid",p);break;case"textarea":It(p,v),wt("invalid",p)}Ln(d,v),_=null;for(var A in v)if(v.hasOwnProperty(A)){var U=v[A];A==="children"?typeof U=="string"?p.textContent!==U&&(v.suppressHydrationWarning!==!0&&Vf(p.textContent,U,a),_=["children",U]):typeof U=="number"&&p.textContent!==""+U&&(v.suppressHydrationWarning!==!0&&Vf(p.textContent,U,a),_=["children",""+U]):r.hasOwnProperty(A)&&U!=null&&A==="onScroll"&&wt("scroll",p)}switch(d){case"input":Qi(p),Ri(p,v,!0);break;case"textarea":Qi(p),Pi(p);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(p.onclick=Ff)}p=_,u.updateQueue=p,p!==null&&(u.flags|=4)}else{A=_.nodeType===9?_:_.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Sr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=A.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof p.is=="string"?a=A.createElement(d,{is:p.is}):(a=A.createElement(d),d==="select"&&(A=a,p.multiple?A.multiple=!0:p.size&&(A.size=p.size))):a=A.createElementNS(a,d),a[Gr]=u,a[ah]=p,nT(a,u,!1,!1),u.stateNode=a;e:{switch(A=gs(d,p),d){case"dialog":wt("cancel",a),wt("close",a),_=p;break;case"iframe":case"object":case"embed":wt("load",a),_=p;break;case"video":case"audio":for(_=0;_<rh.length;_++)wt(rh[_],a);_=p;break;case"source":wt("error",a),_=p;break;case"img":case"image":case"link":wt("error",a),wt("load",a),_=p;break;case"details":wt("toggle",a),_=p;break;case"input":cn(a,p),_=Wn(a,p),wt("invalid",a);break;case"option":_=p;break;case"select":a._wrapperState={wasMultiple:!!p.multiple},_=ne({},p,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,p),_=Ai(a,p),wt("invalid",a);break;default:_=p}Ln(d,_),U=_;for(v in U)if(U.hasOwnProperty(v)){var B=U[v];v==="style"?fs(a,B):v==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&la(a,B)):v==="children"?typeof B=="string"?(d!=="textarea"||B!=="")&&Rr(a,B):typeof B=="number"&&Rr(a,""+B):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(r.hasOwnProperty(v)?B!=null&&v==="onScroll"&&wt("scroll",a):B!=null&&k(a,v,B,A))}switch(d){case"input":Qi(a),Ri(a,p,!1);break;case"textarea":Qi(a),Pi(a);break;case"option":p.value!=null&&a.setAttribute("value",""+Ve(p.value));break;case"select":a.multiple=!!p.multiple,v=p.value,v!=null?tn(a,!!p.multiple,v,!1):p.defaultValue!=null&&tn(a,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(a.onclick=Ff)}switch(d){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return An(u),null;case 6:if(a&&u.stateNode!=null)rT(a,u,a.memoizedProps,p);else{if(typeof p!="string"&&u.stateNode===null)throw Error(t(166));if(d=Ca(dh.current),Ca(Wr.current),Kf(u)){if(p=u.stateNode,d=u.memoizedProps,p[Gr]=u,(v=p.nodeValue!==d)&&(a=gi,a!==null))switch(a.tag){case 3:Vf(p.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Vf(p.nodeValue,d,(a.mode&1)!==0)}v&&(u.flags|=4)}else p=(d.nodeType===9?d:d.ownerDocument).createTextNode(p),p[Gr]=u,u.stateNode=p}return An(u),null;case 13:if(Et(At),p=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(St&&pi!==null&&(u.mode&1)!==0&&(u.flags&128)===0)a1(),au(),u.flags|=98560,v=!1;else if(v=Kf(u),p!==null&&p.dehydrated!==null){if(a===null){if(!v)throw Error(t(318));if(v=u.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[Gr]=u}else au(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;An(u),v=!1}else rr!==null&&(C_(rr),rr=null),v=!0;if(!v)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=d,u):(p=p!==null,p!==(a!==null&&a.memoizedState!==null)&&p&&(u.child.flags|=8192,(u.mode&1)!==0&&(a===null||(At.current&1)!==0?Yt===0&&(Yt=3):P_())),u.updateQueue!==null&&(u.flags|=4),An(u),null);case 4:return hu(),p_(a,u),a===null&&sh(u.stateNode.containerInfo),An(u),null;case 10:return Gy(u.type._context),An(u),null;case 17:return Hn(u.type)&&Uf(),An(u),null;case 19:if(Et(At),v=u.memoizedState,v===null)return An(u),null;if(p=(u.flags&128)!==0,A=v.rendering,A===null)if(p)yh(v,!1);else{if(Yt!==0||a!==null&&(a.flags&128)!==0)for(a=u.child;a!==null;){if(A=Zf(a),A!==null){for(u.flags|=128,yh(v,!1),p=A.updateQueue,p!==null&&(u.updateQueue=p,u.flags|=4),u.subtreeFlags=0,p=d,d=u.child;d!==null;)v=d,a=p,v.flags&=14680066,A=v.alternate,A===null?(v.childLanes=0,v.lanes=a,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=A.childLanes,v.lanes=A.lanes,v.child=A.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=A.memoizedProps,v.memoizedState=A.memoizedState,v.updateQueue=A.updateQueue,v.type=A.type,a=A.dependencies,v.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return _t(At,At.current&1|2),u.child}a=a.sibling}v.tail!==null&&vt()>pu&&(u.flags|=128,p=!0,yh(v,!1),u.lanes=4194304)}else{if(!p)if(a=Zf(A),a!==null){if(u.flags|=128,p=!0,d=a.updateQueue,d!==null&&(u.updateQueue=d,u.flags|=4),yh(v,!0),v.tail===null&&v.tailMode==="hidden"&&!A.alternate&&!St)return An(u),null}else 2*vt()-v.renderingStartTime>pu&&d!==1073741824&&(u.flags|=128,p=!0,yh(v,!1),u.lanes=4194304);v.isBackwards?(A.sibling=u.child,u.child=A):(d=v.last,d!==null?d.sibling=A:u.child=A,v.last=A)}return v.tail!==null?(u=v.tail,v.rendering=u,v.tail=u.sibling,v.renderingStartTime=vt(),u.sibling=null,d=At.current,_t(At,p?d&1|2:d&1),u):(An(u),null);case 22:case 23:return A_(),p=u.memoizedState!==null,a!==null&&a.memoizedState!==null!==p&&(u.flags|=8192),p&&(u.mode&1)!==0?(mi&1073741824)!==0&&(An(u),u.subtreeFlags&6&&(u.flags|=8192)):An(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function QM(a,u){switch(Vy(u),u.tag){case 1:return Hn(u.type)&&Uf(),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return hu(),Et($n),Et(Cn),Yy(),a=u.flags,(a&65536)!==0&&(a&128)===0?(u.flags=a&-65537|128,u):null;case 5:return Xy(u),null;case 13:if(Et(At),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(t(340));au()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return Et(At),null;case 4:return hu(),null;case 10:return Gy(u.type._context),null;case 22:case 23:return A_(),null;case 24:return null;default:return null}}var og=!1,Pn=!1,JM=typeof WeakSet=="function"?WeakSet:Set,me=null;function fu(a,u){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(p){Mt(a,u,p)}else d.current=null}function m_(a,u,d){try{d()}catch(p){Mt(a,u,p)}}var sT=!1;function eN(a,u){if(Ay=vs,a=Vx(),wy(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var _=p.anchorOffset,v=p.focusNode;p=p.focusOffset;try{d.nodeType,v.nodeType}catch{d=null;break e}var A=0,U=-1,B=-1,Z=0,re=0,le=a,ie=null;t:for(;;){for(var ge;le!==d||_!==0&&le.nodeType!==3||(U=A+_),le!==v||p!==0&&le.nodeType!==3||(B=A+p),le.nodeType===3&&(A+=le.nodeValue.length),(ge=le.firstChild)!==null;)ie=le,le=ge;for(;;){if(le===a)break t;if(ie===d&&++Z===_&&(U=A),ie===v&&++re===p&&(B=A),(ge=le.nextSibling)!==null)break;le=ie,ie=le.parentNode}le=ge}d=U===-1||B===-1?null:{start:U,end:B}}else d=null}d=d||{start:0,end:0}}else d=null;for(Py={focusedElem:a,selectionRange:d},vs=!1,me=u;me!==null;)if(u=me,a=u.child,(u.subtreeFlags&1028)!==0&&a!==null)a.return=u,me=a;else for(;me!==null;){u=me;try{var ye=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(ye!==null){var _e=ye.memoizedProps,jt=ye.memoizedState,H=u.stateNode,K=H.getSnapshotBeforeUpdate(u.elementType===u.type?_e:sr(u.type,_e),jt);H.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var q=u.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ue){Mt(u,u.return,ue)}if(a=u.sibling,a!==null){a.return=u.return,me=a;break}me=u.return}return ye=sT,sT=!1,ye}function _h(a,u,d){var p=u.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&a)===a){var v=_.destroy;_.destroy=void 0,v!==void 0&&m_(u,d,v)}_=_.next}while(_!==p)}}function ag(a,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var d=u=u.next;do{if((d.tag&a)===a){var p=d.create;d.destroy=p()}d=d.next}while(d!==u)}}function y_(a){var u=a.ref;if(u!==null){var d=a.stateNode;a.tag,a=d,typeof u=="function"?u(a):u.current=a}}function oT(a){var u=a.alternate;u!==null&&(a.alternate=null,oT(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&(delete u[Gr],delete u[ah],delete u[My],delete u[OM],delete u[VM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function aT(a){return a.tag===5||a.tag===3||a.tag===4}function lT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||aT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function __(a,u,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,u?d.nodeType===8?d.parentNode.insertBefore(a,u):d.insertBefore(a,u):(d.nodeType===8?(u=d.parentNode,u.insertBefore(a,d)):(u=d,u.appendChild(a)),d=d._reactRootContainer,d!=null||u.onclick!==null||(u.onclick=Ff));else if(p!==4&&(a=a.child,a!==null))for(__(a,u,d),a=a.sibling;a!==null;)__(a,u,d),a=a.sibling}function v_(a,u,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,u?d.insertBefore(a,u):d.appendChild(a);else if(p!==4&&(a=a.child,a!==null))for(v_(a,u,d),a=a.sibling;a!==null;)v_(a,u,d),a=a.sibling}var yn=null,or=!1;function mo(a,u,d){for(d=d.child;d!==null;)uT(a,u,d),d=d.sibling}function uT(a,u,d){if(li&&typeof li.onCommitFiberUnmount=="function")try{li.onCommitFiberUnmount(da,d)}catch{}switch(d.tag){case 5:Pn||fu(d,u);case 6:var p=yn,_=or;yn=null,mo(a,u,d),yn=p,or=_,yn!==null&&(or?(a=yn,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):yn.removeChild(d.stateNode));break;case 18:yn!==null&&(or?(a=yn,d=d.stateNode,a.nodeType===8?Dy(a.parentNode,d):a.nodeType===1&&Dy(a,d),so(a)):Dy(yn,d.stateNode));break;case 4:p=yn,_=or,yn=d.stateNode.containerInfo,or=!0,mo(a,u,d),yn=p,or=_;break;case 0:case 11:case 14:case 15:if(!Pn&&(p=d.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var v=_,A=v.destroy;v=v.tag,A!==void 0&&((v&2)!==0||(v&4)!==0)&&m_(d,u,A),_=_.next}while(_!==p)}mo(a,u,d);break;case 1:if(!Pn&&(fu(d,u),p=d.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=d.memoizedProps,p.state=d.memoizedState,p.componentWillUnmount()}catch(U){Mt(d,u,U)}mo(a,u,d);break;case 21:mo(a,u,d);break;case 22:d.mode&1?(Pn=(p=Pn)||d.memoizedState!==null,mo(a,u,d),Pn=p):mo(a,u,d);break;default:mo(a,u,d)}}function cT(a){var u=a.updateQueue;if(u!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new JM),u.forEach(function(p){var _=uN.bind(null,a,p);d.has(p)||(d.add(p),p.then(_,_))})}}function ar(a,u){var d=u.deletions;if(d!==null)for(var p=0;p<d.length;p++){var _=d[p];try{var v=a,A=u,U=A;e:for(;U!==null;){switch(U.tag){case 5:yn=U.stateNode,or=!1;break e;case 3:yn=U.stateNode.containerInfo,or=!0;break e;case 4:yn=U.stateNode.containerInfo,or=!0;break e}U=U.return}if(yn===null)throw Error(t(160));uT(v,A,_),yn=null,or=!1;var B=_.alternate;B!==null&&(B.return=null),_.return=null}catch(Z){Mt(_,u,Z)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)hT(u,a),u=u.sibling}function hT(a,u){var d=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ar(u,a),$r(a),p&4){try{_h(3,a,a.return),ag(3,a)}catch(_e){Mt(a,a.return,_e)}try{_h(5,a,a.return)}catch(_e){Mt(a,a.return,_e)}}break;case 1:ar(u,a),$r(a),p&512&&d!==null&&fu(d,d.return);break;case 5:if(ar(u,a),$r(a),p&512&&d!==null&&fu(d,d.return),a.flags&32){var _=a.stateNode;try{Rr(_,"")}catch(_e){Mt(a,a.return,_e)}}if(p&4&&(_=a.stateNode,_!=null)){var v=a.memoizedProps,A=d!==null?d.memoizedProps:v,U=a.type,B=a.updateQueue;if(a.updateQueue=null,B!==null)try{U==="input"&&v.type==="radio"&&v.name!=null&&hn(_,v),gs(U,A);var Z=gs(U,v);for(A=0;A<B.length;A+=2){var re=B[A],le=B[A+1];re==="style"?fs(_,le):re==="dangerouslySetInnerHTML"?la(_,le):re==="children"?Rr(_,le):k(_,re,le,Z)}switch(U){case"input":Kn(_,v);break;case"textarea":Js(_,v);break;case"select":var ie=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!v.multiple;var ge=v.value;ge!=null?tn(_,!!v.multiple,ge,!1):ie!==!!v.multiple&&(v.defaultValue!=null?tn(_,!!v.multiple,v.defaultValue,!0):tn(_,!!v.multiple,v.multiple?[]:"",!1))}_[ah]=v}catch(_e){Mt(a,a.return,_e)}}break;case 6:if(ar(u,a),$r(a),p&4){if(a.stateNode===null)throw Error(t(162));_=a.stateNode,v=a.memoizedProps;try{_.nodeValue=v}catch(_e){Mt(a,a.return,_e)}}break;case 3:if(ar(u,a),$r(a),p&4&&d!==null&&d.memoizedState.isDehydrated)try{so(u.containerInfo)}catch(_e){Mt(a,a.return,_e)}break;case 4:ar(u,a),$r(a);break;case 13:ar(u,a),$r(a),_=a.child,_.flags&8192&&(v=_.memoizedState!==null,_.stateNode.isHidden=v,!v||_.alternate!==null&&_.alternate.memoizedState!==null||(x_=vt())),p&4&&cT(a);break;case 22:if(re=d!==null&&d.memoizedState!==null,a.mode&1?(Pn=(Z=Pn)||re,ar(u,a),Pn=Z):ar(u,a),$r(a),p&8192){if(Z=a.memoizedState!==null,(a.stateNode.isHidden=Z)&&!re&&(a.mode&1)!==0)for(me=a,re=a.child;re!==null;){for(le=me=re;me!==null;){switch(ie=me,ge=ie.child,ie.tag){case 0:case 11:case 14:case 15:_h(4,ie,ie.return);break;case 1:fu(ie,ie.return);var ye=ie.stateNode;if(typeof ye.componentWillUnmount=="function"){p=ie,d=ie.return;try{u=p,ye.props=u.memoizedProps,ye.state=u.memoizedState,ye.componentWillUnmount()}catch(_e){Mt(p,d,_e)}}break;case 5:fu(ie,ie.return);break;case 22:if(ie.memoizedState!==null){gT(le);continue}}ge!==null?(ge.return=ie,me=ge):gT(le)}re=re.sibling}e:for(re=null,le=a;;){if(le.tag===5){if(re===null){re=le;try{_=le.stateNode,Z?(v=_.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(U=le.stateNode,B=le.memoizedProps.style,A=B!=null&&B.hasOwnProperty("display")?B.display:null,U.style.display=Ar("display",A))}catch(_e){Mt(a,a.return,_e)}}}else if(le.tag===6){if(re===null)try{le.stateNode.nodeValue=Z?"":le.memoizedProps}catch(_e){Mt(a,a.return,_e)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===a)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===a)break e;for(;le.sibling===null;){if(le.return===null||le.return===a)break e;re===le&&(re=null),le=le.return}re===le&&(re=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:ar(u,a),$r(a),p&4&&cT(a);break;case 21:break;default:ar(u,a),$r(a)}}function $r(a){var u=a.flags;if(u&2){try{e:{for(var d=a.return;d!==null;){if(aT(d)){var p=d;break e}d=d.return}throw Error(t(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(Rr(_,""),p.flags&=-33);var v=lT(a);v_(a,v,_);break;case 3:case 4:var A=p.stateNode.containerInfo,U=lT(a);__(a,U,A);break;default:throw Error(t(161))}}catch(B){Mt(a,a.return,B)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function tN(a,u,d){me=a,dT(a)}function dT(a,u,d){for(var p=(a.mode&1)!==0;me!==null;){var _=me,v=_.child;if(_.tag===22&&p){var A=_.memoizedState!==null||og;if(!A){var U=_.alternate,B=U!==null&&U.memoizedState!==null||Pn;U=og;var Z=Pn;if(og=A,(Pn=B)&&!Z)for(me=_;me!==null;)A=me,B=A.child,A.tag===22&&A.memoizedState!==null?pT(_):B!==null?(B.return=A,me=B):pT(_);for(;v!==null;)me=v,dT(v),v=v.sibling;me=_,og=U,Pn=Z}fT(a)}else(_.subtreeFlags&8772)!==0&&v!==null?(v.return=_,me=v):fT(a)}}function fT(a){for(;me!==null;){var u=me;if((u.flags&8772)!==0){var d=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Pn||ag(5,u);break;case 1:var p=u.stateNode;if(u.flags&4&&!Pn)if(d===null)p.componentDidMount();else{var _=u.elementType===u.type?d.memoizedProps:sr(u.type,d.memoizedProps);p.componentDidUpdate(_,d.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var v=u.updateQueue;v!==null&&g1(u,v,p);break;case 3:var A=u.updateQueue;if(A!==null){if(d=null,u.child!==null)switch(u.child.tag){case 5:d=u.child.stateNode;break;case 1:d=u.child.stateNode}g1(u,A,d)}break;case 5:var U=u.stateNode;if(d===null&&u.flags&4){d=U;var B=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&d.focus();break;case"img":B.src&&(d.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Z=u.alternate;if(Z!==null){var re=Z.memoizedState;if(re!==null){var le=re.dehydrated;le!==null&&so(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pn||u.flags&512&&y_(u)}catch(ie){Mt(u,u.return,ie)}}if(u===a){me=null;break}if(d=u.sibling,d!==null){d.return=u.return,me=d;break}me=u.return}}function gT(a){for(;me!==null;){var u=me;if(u===a){me=null;break}var d=u.sibling;if(d!==null){d.return=u.return,me=d;break}me=u.return}}function pT(a){for(;me!==null;){var u=me;try{switch(u.tag){case 0:case 11:case 15:var d=u.return;try{ag(4,u)}catch(B){Mt(u,d,B)}break;case 1:var p=u.stateNode;if(typeof p.componentDidMount=="function"){var _=u.return;try{p.componentDidMount()}catch(B){Mt(u,_,B)}}var v=u.return;try{y_(u)}catch(B){Mt(u,v,B)}break;case 5:var A=u.return;try{y_(u)}catch(B){Mt(u,A,B)}}}catch(B){Mt(u,u.return,B)}if(u===a){me=null;break}var U=u.sibling;if(U!==null){U.return=u.return,me=U;break}me=u.return}}var nN=Math.ceil,lg=O.ReactCurrentDispatcher,w_=O.ReactCurrentOwner,ji=O.ReactCurrentBatchConfig,Qe=0,sn=null,Wt=null,_n=0,mi=0,gu=co(0),Yt=0,vh=null,Aa=0,ug=0,E_=0,wh=null,qn=null,x_=0,pu=1/0,Ps=null,cg=!1,T_=null,yo=null,hg=!1,_o=null,dg=0,Eh=0,I_=null,fg=-1,gg=0;function jn(){return(Qe&6)!==0?vt():fg!==-1?fg:fg=vt()}function vo(a){return(a.mode&1)===0?1:(Qe&2)!==0&&_n!==0?_n&-_n:jM.transition!==null?(gg===0&&(gg=Bc()),gg):(a=$e,a!==0||(a=window.event,a=a===void 0?16:Wl(a.type)),a)}function lr(a,u,d,p){if(50<Eh)throw Eh=0,I_=null,Error(t(185));ma(a,d,p),((Qe&2)===0||a!==sn)&&(a===sn&&((Qe&2)===0&&(ug|=d),Yt===4&&wo(a,_n)),Yn(a,p),d===1&&Qe===0&&(u.mode&1)===0&&(pu=vt()+500,Bf&&fo()))}function Yn(a,u){var d=a.callbackNode;pa(a,u);var p=ms(a,a===sn?_n:0);if(p===0)d!==null&&Vl(d),a.callbackNode=null,a.callbackPriority=0;else if(u=p&-p,a.callbackPriority!==u){if(d!=null&&Vl(d),u===1)a.tag===0?FM(yT.bind(null,a)):n1(yT.bind(null,a)),NM(function(){(Qe&6)===0&&fo()}),d=null;else{switch(Mr(p)){case 1:d=Fl;break;case 4:d=jc;break;case 16:d=ha;break;case 536870912:d=jl;break;default:d=ha}d=ST(d,mT.bind(null,a))}a.callbackPriority=u,a.callbackNode=d}}function mT(a,u){if(fg=-1,gg=0,(Qe&6)!==0)throw Error(t(327));var d=a.callbackNode;if(mu()&&a.callbackNode!==d)return null;var p=ms(a,a===sn?_n:0);if(p===0)return null;if((p&30)!==0||(p&a.expiredLanes)!==0||u)u=pg(a,p);else{u=p;var _=Qe;Qe|=2;var v=vT();(sn!==a||_n!==u)&&(Ps=null,pu=vt()+500,ba(a,u));do try{sN();break}catch(U){_T(a,U)}while(!0);By(),lg.current=v,Qe=_,Wt!==null?u=0:(sn=null,_n=0,u=Yt)}if(u!==0){if(u===2&&(_=zc(a),_!==0&&(p=_,u=S_(a,_))),u===1)throw d=vh,ba(a,0),wo(a,p),Yn(a,vt()),d;if(u===6)wo(a,p);else{if(_=a.current.alternate,(p&30)===0&&!iN(_)&&(u=pg(a,p),u===2&&(v=zc(a),v!==0&&(p=v,u=S_(a,v))),u===1))throw d=vh,ba(a,0),wo(a,p),Yn(a,vt()),d;switch(a.finishedWork=_,a.finishedLanes=p,u){case 0:case 1:throw Error(t(345));case 2:ka(a,qn,Ps);break;case 3:if(wo(a,p),(p&130023424)===p&&(u=x_+500-vt(),10<u)){if(ms(a,0)!==0)break;if(_=a.suspendedLanes,(_&p)!==p){jn(),a.pingedLanes|=a.suspendedLanes&_;break}a.timeoutHandle=ky(ka.bind(null,a,qn,Ps),u);break}ka(a,qn,Ps);break;case 4:if(wo(a,p),(p&4194240)===p)break;for(u=a.eventTimes,_=-1;0<p;){var A=31-ui(p);v=1<<A,A=u[A],A>_&&(_=A),p&=~v}if(p=_,p=vt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*nN(p/1960))-p,10<p){a.timeoutHandle=ky(ka.bind(null,a,qn,Ps),p);break}ka(a,qn,Ps);break;case 5:ka(a,qn,Ps);break;default:throw Error(t(329))}}}return Yn(a,vt()),a.callbackNode===d?mT.bind(null,a):null}function S_(a,u){var d=wh;return a.current.memoizedState.isDehydrated&&(ba(a,u).flags|=256),a=pg(a,u),a!==2&&(u=qn,qn=d,u!==null&&C_(u)),a}function C_(a){qn===null?qn=a:qn.push.apply(qn,a)}function iN(a){for(var u=a;;){if(u.flags&16384){var d=u.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var p=0;p<d.length;p++){var _=d[p],v=_.getSnapshot;_=_.value;try{if(!ir(v(),_))return!1}catch{return!1}}}if(d=u.child,u.subtreeFlags&16384&&d!==null)d.return=u,u=d;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function wo(a,u){for(u&=~E_,u&=~ug,a.suspendedLanes|=u,a.pingedLanes&=~u,a=a.expirationTimes;0<u;){var d=31-ui(u),p=1<<d;a[d]=-1,u&=~p}}function yT(a){if((Qe&6)!==0)throw Error(t(327));mu();var u=ms(a,0);if((u&1)===0)return Yn(a,vt()),null;var d=pg(a,u);if(a.tag!==0&&d===2){var p=zc(a);p!==0&&(u=p,d=S_(a,p))}if(d===1)throw d=vh,ba(a,0),wo(a,u),Yn(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=u,ka(a,qn,Ps),Yn(a,vt()),null}function R_(a,u){var d=Qe;Qe|=1;try{return a(u)}finally{Qe=d,Qe===0&&(pu=vt()+500,Bf&&fo())}}function Pa(a){_o!==null&&_o.tag===0&&(Qe&6)===0&&mu();var u=Qe;Qe|=1;var d=ji.transition,p=$e;try{if(ji.transition=null,$e=1,a)return a()}finally{$e=p,ji.transition=d,Qe=u,(Qe&6)===0&&fo()}}function A_(){mi=gu.current,Et(gu)}function ba(a,u){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,MM(d)),Wt!==null)for(d=Wt.return;d!==null;){var p=d;switch(Vy(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Uf();break;case 3:hu(),Et($n),Et(Cn),Yy();break;case 5:Xy(p);break;case 4:hu();break;case 13:Et(At);break;case 19:Et(At);break;case 10:Gy(p.type._context);break;case 22:case 23:A_()}d=d.return}if(sn=a,Wt=a=Eo(a.current,null),_n=mi=u,Yt=0,vh=null,E_=ug=Aa=0,qn=wh=null,Sa!==null){for(u=0;u<Sa.length;u++)if(d=Sa[u],p=d.interleaved,p!==null){d.interleaved=null;var _=p.next,v=d.pending;if(v!==null){var A=v.next;v.next=_,p.next=A}d.pending=p}Sa=null}return a}function _T(a,u){do{var d=Wt;try{if(By(),Qf.current=ng,Jf){for(var p=Pt.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}Jf=!1}if(Ra=0,rn=qt=Pt=null,fh=!1,gh=0,w_.current=null,d===null||d.return===null){Yt=1,vh=u,Wt=null;break}e:{var v=a,A=d.return,U=d,B=u;if(u=_n,U.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var Z=B,re=U,le=re.tag;if((re.mode&1)===0&&(le===0||le===11||le===15)){var ie=re.alternate;ie?(re.updateQueue=ie.updateQueue,re.memoizedState=ie.memoizedState,re.lanes=ie.lanes):(re.updateQueue=null,re.memoizedState=null)}var ge=G1(A);if(ge!==null){ge.flags&=-257,W1(ge,A,U,v,u),ge.mode&1&&B1(v,Z,u),u=ge,B=Z;var ye=u.updateQueue;if(ye===null){var _e=new Set;_e.add(B),u.updateQueue=_e}else ye.add(B);break e}else{if((u&1)===0){B1(v,Z,u),P_();break e}B=Error(t(426))}}else if(St&&U.mode&1){var jt=G1(A);if(jt!==null){(jt.flags&65536)===0&&(jt.flags|=256),W1(jt,A,U,v,u),Uy(du(B,U));break e}}v=B=du(B,U),Yt!==4&&(Yt=2),wh===null?wh=[v]:wh.push(v),v=A;do{switch(v.tag){case 3:v.flags|=65536,u&=-u,v.lanes|=u;var H=U1(v,B,u);f1(v,H);break e;case 1:U=B;var K=v.type,q=v.stateNode;if((v.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(yo===null||!yo.has(q)))){v.flags|=65536,u&=-u,v.lanes|=u;var ue=z1(v,U,u);f1(v,ue);break e}}v=v.return}while(v!==null)}ET(d)}catch(we){u=we,Wt===d&&d!==null&&(Wt=d=d.return);continue}break}while(!0)}function vT(){var a=lg.current;return lg.current=ng,a===null?ng:a}function P_(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),sn===null||(Aa&268435455)===0&&(ug&268435455)===0||wo(sn,_n)}function pg(a,u){var d=Qe;Qe|=2;var p=vT();(sn!==a||_n!==u)&&(Ps=null,ba(a,u));do try{rN();break}catch(_){_T(a,_)}while(!0);if(By(),Qe=d,lg.current=p,Wt!==null)throw Error(t(261));return sn=null,_n=0,Yt}function rN(){for(;Wt!==null;)wT(Wt)}function sN(){for(;Wt!==null&&!ca();)wT(Wt)}function wT(a){var u=IT(a.alternate,a,mi);a.memoizedProps=a.pendingProps,u===null?ET(a):Wt=u,w_.current=null}function ET(a){var u=a;do{var d=u.alternate;if(a=u.return,(u.flags&32768)===0){if(d=ZM(d,u,mi),d!==null){Wt=d;return}}else{if(d=QM(d,u),d!==null){d.flags&=32767,Wt=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Yt=6,Wt=null;return}}if(u=u.sibling,u!==null){Wt=u;return}Wt=u=a}while(u!==null);Yt===0&&(Yt=5)}function ka(a,u,d){var p=$e,_=ji.transition;try{ji.transition=null,$e=1,oN(a,u,d,p)}finally{ji.transition=_,$e=p}return null}function oN(a,u,d,p){do mu();while(_o!==null);if((Qe&6)!==0)throw Error(t(327));d=a.finishedWork;var _=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var v=d.lanes|d.childLanes;if(py(a,v),a===sn&&(Wt=sn=null,_n=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||hg||(hg=!0,ST(ha,function(){return mu(),null})),v=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||v){v=ji.transition,ji.transition=null;var A=$e;$e=1;var U=Qe;Qe|=4,w_.current=null,eN(a,d),hT(d,a),CM(Py),vs=!!Ay,Py=Ay=null,a.current=d,tN(d),ps(),Qe=U,$e=A,ji.transition=v}else a.current=d;if(hg&&(hg=!1,_o=a,dg=_),v=a.pendingLanes,v===0&&(yo=null),xf(d.stateNode),Yn(a,vt()),u!==null)for(p=a.onRecoverableError,d=0;d<u.length;d++)_=u[d],p(_.value,{componentStack:_.stack,digest:_.digest});if(cg)throw cg=!1,a=T_,T_=null,a;return(dg&1)!==0&&a.tag!==0&&mu(),v=a.pendingLanes,(v&1)!==0?a===I_?Eh++:(Eh=0,I_=a):Eh=0,fo(),null}function mu(){if(_o!==null){var a=Mr(dg),u=ji.transition,d=$e;try{if(ji.transition=null,$e=16>a?16:a,_o===null)var p=!1;else{if(a=_o,_o=null,dg=0,(Qe&6)!==0)throw Error(t(331));var _=Qe;for(Qe|=4,me=a.current;me!==null;){var v=me,A=v.child;if((me.flags&16)!==0){var U=v.deletions;if(U!==null){for(var B=0;B<U.length;B++){var Z=U[B];for(me=Z;me!==null;){var re=me;switch(re.tag){case 0:case 11:case 15:_h(8,re,v)}var le=re.child;if(le!==null)le.return=re,me=le;else for(;me!==null;){re=me;var ie=re.sibling,ge=re.return;if(oT(re),re===Z){me=null;break}if(ie!==null){ie.return=ge,me=ie;break}me=ge}}}var ye=v.alternate;if(ye!==null){var _e=ye.child;if(_e!==null){ye.child=null;do{var jt=_e.sibling;_e.sibling=null,_e=jt}while(_e!==null)}}me=v}}if((v.subtreeFlags&2064)!==0&&A!==null)A.return=v,me=A;else e:for(;me!==null;){if(v=me,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:_h(9,v,v.return)}var H=v.sibling;if(H!==null){H.return=v.return,me=H;break e}me=v.return}}var K=a.current;for(me=K;me!==null;){A=me;var q=A.child;if((A.subtreeFlags&2064)!==0&&q!==null)q.return=A,me=q;else e:for(A=K;me!==null;){if(U=me,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:ag(9,U)}}catch(we){Mt(U,U.return,we)}if(U===A){me=null;break e}var ue=U.sibling;if(ue!==null){ue.return=U.return,me=ue;break e}me=U.return}}if(Qe=_,fo(),li&&typeof li.onPostCommitFiberRoot=="function")try{li.onPostCommitFiberRoot(da,a)}catch{}p=!0}return p}finally{$e=d,ji.transition=u}}return!1}function xT(a,u,d){u=du(d,u),u=U1(a,u,1),a=po(a,u,1),u=jn(),a!==null&&(ma(a,1,u),Yn(a,u))}function Mt(a,u,d){if(a.tag===3)xT(a,a,d);else for(;u!==null;){if(u.tag===3){xT(u,a,d);break}else if(u.tag===1){var p=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(yo===null||!yo.has(p))){a=du(d,a),a=z1(u,a,1),u=po(u,a,1),a=jn(),u!==null&&(ma(u,1,a),Yn(u,a));break}}u=u.return}}function aN(a,u,d){var p=a.pingCache;p!==null&&p.delete(u),u=jn(),a.pingedLanes|=a.suspendedLanes&d,sn===a&&(_n&d)===d&&(Yt===4||Yt===3&&(_n&130023424)===_n&&500>vt()-x_?ba(a,0):E_|=d),Yn(a,u)}function TT(a,u){u===0&&((a.mode&1)===0?u=1:(u=no,no<<=1,(no&130023424)===0&&(no=4194304)));var d=jn();a=Cs(a,u),a!==null&&(ma(a,u,d),Yn(a,d))}function lN(a){var u=a.memoizedState,d=0;u!==null&&(d=u.retryLane),TT(a,d)}function uN(a,u){var d=0;switch(a.tag){case 13:var p=a.stateNode,_=a.memoizedState;_!==null&&(d=_.retryLane);break;case 19:p=a.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(u),TT(a,d)}var IT;IT=function(a,u,d){if(a!==null)if(a.memoizedProps!==u.pendingProps||$n.current)Xn=!0;else{if((a.lanes&d)===0&&(u.flags&128)===0)return Xn=!1,YM(a,u,d);Xn=(a.flags&131072)!==0}else Xn=!1,St&&(u.flags&1048576)!==0&&i1(u,Wf,u.index);switch(u.lanes=0,u.tag){case 2:var p=u.type;sg(a,u),a=u.pendingProps;var _=ru(u,Cn.current);cu(u,d),_=Jy(null,u,p,a,_,d);var v=e_();return u.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Hn(p)?(v=!0,zf(u)):v=!1,u.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,$y(u),_.updater=ig,u.stateNode=_,_._reactInternals=u,o_(u,p,a,d),u=c_(null,u,p,!0,v,d)):(u.tag=0,St&&v&&Oy(u),Fn(null,u,_,d),u=u.child),u;case 16:p=u.elementType;e:{switch(sg(a,u),a=u.pendingProps,_=p._init,p=_(p._payload),u.type=p,_=u.tag=hN(p),a=sr(p,a),_){case 0:u=u_(null,u,p,a,d);break e;case 1:u=Y1(null,u,p,a,d);break e;case 11:u=K1(null,u,p,a,d);break e;case 14:u=$1(null,u,p,sr(p.type,a),d);break e}throw Error(t(306,p,""))}return u;case 0:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),u_(a,u,p,_,d);case 1:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),Y1(a,u,p,_,d);case 3:e:{if(Z1(u),a===null)throw Error(t(387));p=u.pendingProps,v=u.memoizedState,_=v.element,d1(a,u),Yf(u,p,null,d);var A=u.memoizedState;if(p=A.element,v.isDehydrated)if(v={element:p,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},u.updateQueue.baseState=v,u.memoizedState=v,u.flags&256){_=du(Error(t(423)),u),u=Q1(a,u,p,d,_);break e}else if(p!==_){_=du(Error(t(424)),u),u=Q1(a,u,p,d,_);break e}else for(pi=uo(u.stateNode.containerInfo.firstChild),gi=u,St=!0,rr=null,d=c1(u,null,p,d),u.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(au(),p===_){u=As(a,u,d);break e}Fn(a,u,p,d)}u=u.child}return u;case 5:return p1(u),a===null&&jy(u),p=u.type,_=u.pendingProps,v=a!==null?a.memoizedProps:null,A=_.children,by(p,_)?A=null:v!==null&&by(p,v)&&(u.flags|=32),q1(a,u),Fn(a,u,A,d),u.child;case 6:return a===null&&jy(u),null;case 13:return J1(a,u,d);case 4:return Hy(u,u.stateNode.containerInfo),p=u.pendingProps,a===null?u.child=lu(u,null,p,d):Fn(a,u,p,d),u.child;case 11:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),K1(a,u,p,_,d);case 7:return Fn(a,u,u.pendingProps,d),u.child;case 8:return Fn(a,u,u.pendingProps.children,d),u.child;case 12:return Fn(a,u,u.pendingProps.children,d),u.child;case 10:e:{if(p=u.type._context,_=u.pendingProps,v=u.memoizedProps,A=_.value,_t(Hf,p._currentValue),p._currentValue=A,v!==null)if(ir(v.value,A)){if(v.children===_.children&&!$n.current){u=As(a,u,d);break e}}else for(v=u.child,v!==null&&(v.return=u);v!==null;){var U=v.dependencies;if(U!==null){A=v.child;for(var B=U.firstContext;B!==null;){if(B.context===p){if(v.tag===1){B=Rs(-1,d&-d),B.tag=2;var Z=v.updateQueue;if(Z!==null){Z=Z.shared;var re=Z.pending;re===null?B.next=B:(B.next=re.next,re.next=B),Z.pending=B}}v.lanes|=d,B=v.alternate,B!==null&&(B.lanes|=d),Wy(v.return,d,u),U.lanes|=d;break}B=B.next}}else if(v.tag===10)A=v.type===u.type?null:v.child;else if(v.tag===18){if(A=v.return,A===null)throw Error(t(341));A.lanes|=d,U=A.alternate,U!==null&&(U.lanes|=d),Wy(A,d,u),A=v.sibling}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===u){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}Fn(a,u,_.children,d),u=u.child}return u;case 9:return _=u.type,p=u.pendingProps.children,cu(u,d),_=Vi(_),p=p(_),u.flags|=1,Fn(a,u,p,d),u.child;case 14:return p=u.type,_=sr(p,u.pendingProps),_=sr(p.type,_),$1(a,u,p,_,d);case 15:return H1(a,u,u.type,u.pendingProps,d);case 17:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),sg(a,u),u.tag=1,Hn(p)?(a=!0,zf(u)):a=!1,cu(u,d),F1(u,p,_),o_(u,p,_,d),c_(null,u,p,!0,a,d);case 19:return tT(a,u,d);case 22:return X1(a,u,d)}throw Error(t(156,u.tag))};function ST(a,u){return Fc(a,u)}function cN(a,u,d,p){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(a,u,d,p){return new cN(a,u,d,p)}function b_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function hN(a){if(typeof a=="function")return b_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===z)return 11;if(a===pe)return 14}return 2}function Eo(a,u){var d=a.alternate;return d===null?(d=Ui(a.tag,u,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=u,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,u=a.dependencies,d.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function mg(a,u,d,p,_,v){var A=2;if(p=a,typeof a=="function")b_(a)&&(A=1);else if(typeof a=="string")A=5;else e:switch(a){case D:return Da(d.children,_,v,u);case R:A=8,_|=8;break;case M:return a=Ui(12,d,u,_|2),a.elementType=M,a.lanes=v,a;case L:return a=Ui(13,d,u,_),a.elementType=L,a.lanes=v,a;case ae:return a=Ui(19,d,u,_),a.elementType=ae,a.lanes=v,a;case ce:return yg(d,_,v,u);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:A=10;break e;case j:A=9;break e;case z:A=11;break e;case pe:A=14;break e;case fe:A=16,p=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return u=Ui(A,d,u,_),u.elementType=a,u.type=p,u.lanes=v,u}function Da(a,u,d,p){return a=Ui(7,a,p,u),a.lanes=d,a}function yg(a,u,d,p){return a=Ui(22,a,p,u),a.elementType=ce,a.lanes=d,a.stateNode={isHidden:!1},a}function k_(a,u,d){return a=Ui(6,a,null,u),a.lanes=d,a}function D_(a,u,d){return u=Ui(4,a.children!==null?a.children:[],a.key,u),u.lanes=d,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}function dN(a,u,d,p,_){this.tag=u,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gc(0),this.expirationTimes=Gc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gc(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function M_(a,u,d,p,_,v,A,U,B){return a=new dN(a,u,d,U,B),u===1?(u=1,v===!0&&(u|=8)):u=0,v=Ui(3,null,null,u),a.current=v,v.stateNode=a,v.memoizedState={element:p,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},$y(v),a}function fN(a,u,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:p==null?null:""+p,children:a,containerInfo:u,implementation:d}}function CT(a){if(!a)return ho;a=a._reactInternals;e:{if(tr(a)!==a||a.tag!==1)throw Error(t(170));var u=a;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Hn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Hn(d))return e1(a,d,u)}return u}function RT(a,u,d,p,_,v,A,U,B){return a=M_(d,p,!0,a,_,v,A,U,B),a.context=CT(null),d=a.current,p=jn(),_=vo(d),v=Rs(p,_),v.callback=u??null,po(d,v,_),a.current.lanes=_,ma(a,_,p),Yn(a,p),a}function _g(a,u,d,p){var _=u.current,v=jn(),A=vo(_);return d=CT(d),u.context===null?u.context=d:u.pendingContext=d,u=Rs(v,A),u.payload={element:a},p=p===void 0?null:p,p!==null&&(u.callback=p),a=po(_,u,A),a!==null&&(lr(a,_,A,v),qf(a,_,A)),A}function vg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function AT(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<u?d:u}}function N_(a,u){AT(a,u),(a=a.alternate)&&AT(a,u)}function gN(){return null}var PT=typeof reportError=="function"?reportError:function(a){console.error(a)};function L_(a){this._internalRoot=a}wg.prototype.render=L_.prototype.render=function(a){var u=this._internalRoot;if(u===null)throw Error(t(409));_g(a,u,null,null)},wg.prototype.unmount=L_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var u=a.containerInfo;Pa(function(){_g(null,a,null,null)}),u[xs]=null}};function wg(a){this._internalRoot=a}wg.prototype.unstable_scheduleHydration=function(a){if(a){var u=Hc();a={blockedOn:null,target:a,priority:u};for(var d=0;d<ci.length&&u!==0&&u<ci[d].priority;d++);ci.splice(d,0,a),d===0&&Bl(a)}};function O_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Eg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function bT(){}function pN(a,u,d,p,_){if(_){if(typeof p=="function"){var v=p;p=function(){var Z=vg(A);v.call(Z)}}var A=RT(u,p,a,0,null,!1,!1,"",bT);return a._reactRootContainer=A,a[xs]=A.current,sh(a.nodeType===8?a.parentNode:a),Pa(),A}for(;_=a.lastChild;)a.removeChild(_);if(typeof p=="function"){var U=p;p=function(){var Z=vg(B);U.call(Z)}}var B=M_(a,0,!1,null,null,!1,!1,"",bT);return a._reactRootContainer=B,a[xs]=B.current,sh(a.nodeType===8?a.parentNode:a),Pa(function(){_g(u,B,d,p)}),B}function xg(a,u,d,p,_){var v=d._reactRootContainer;if(v){var A=v;if(typeof _=="function"){var U=_;_=function(){var B=vg(A);U.call(B)}}_g(u,A,a,_)}else A=pN(d,u,a,_,p);return vg(A)}Kc=function(a){switch(a.tag){case 3:var u=a.stateNode;if(u.current.memoizedState.isDehydrated){var d=st(u.pendingLanes);d!==0&&(Wc(u,d|1),Yn(u,vt()),(Qe&6)===0&&(pu=vt()+500,fo()))}break;case 13:Pa(function(){var p=Cs(a,1);if(p!==null){var _=jn();lr(p,a,1,_)}}),N_(a,1)}},Ul=function(a){if(a.tag===13){var u=Cs(a,134217728);if(u!==null){var d=jn();lr(u,a,134217728,d)}N_(a,134217728)}},$c=function(a){if(a.tag===13){var u=vo(a),d=Cs(a,u);if(d!==null){var p=jn();lr(d,a,u,p)}N_(a,u)}},Hc=function(){return $e},Xc=function(a,u){var d=$e;try{return $e=a,u()}finally{$e=d}},On=function(a,u,d){switch(u){case"input":if(Kn(a,d),u=d.name,d.type==="radio"&&u!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<d.length;u++){var p=d[u];if(p!==a&&p.form===a.form){var _=jf(p);if(!_)throw Error(t(90));ds(p),Kn(p,_)}}}break;case"textarea":Js(a,d);break;case"select":u=d.value,u!=null&&tn(a,!!d.multiple,u,!1)}},ki=R_,dn=Pa;var mN={usingClientEntryPoint:!1,Events:[lh,nu,jf,er,Ot,R_]},xh={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yN={bundleType:xh.bundleType,version:xh.version,rendererPackageName:xh.rendererPackageName,rendererConfig:xh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Ef(a),a===null?null:a.stateNode},findFiberByHostInstance:xh.findFiberByHostInstance||gN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tg.isDisabled&&Tg.supportsFiber)try{da=Tg.inject(yN),li=Tg}catch{}}return Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mN,Zn.createPortal=function(a,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O_(u))throw Error(t(200));return fN(a,u,null,d)},Zn.createRoot=function(a,u){if(!O_(a))throw Error(t(299));var d=!1,p="",_=PT;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onRecoverableError!==void 0&&(_=u.onRecoverableError)),u=M_(a,1,!1,null,null,d,!1,p,_),a[xs]=u.current,sh(a.nodeType===8?a.parentNode:a),new L_(u)},Zn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Ef(u),a=a===null?null:a.stateNode,a},Zn.flushSync=function(a){return Pa(a)},Zn.hydrate=function(a,u,d){if(!Eg(u))throw Error(t(200));return xg(null,a,u,!0,d)},Zn.hydrateRoot=function(a,u,d){if(!O_(a))throw Error(t(405));var p=d!=null&&d.hydratedSources||null,_=!1,v="",A=PT;if(d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(v=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),u=RT(u,null,a,1,d??null,_,!1,v,A),a[xs]=u.current,sh(a),p)for(a=0;a<p.length;a++)d=p[a],_=d._getVersion,_=_(d._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[d,_]:u.mutableSourceEagerHydrationData.push(d,_);return new wg(u)},Zn.render=function(a,u,d){if(!Eg(u))throw Error(t(200));return xg(null,a,u,!1,d)},Zn.unmountComponentAtNode=function(a){if(!Eg(a))throw Error(t(40));return a._reactRootContainer?(Pa(function(){xg(null,null,a,!1,function(){a._reactRootContainer=null,a[xs]=null})}),!0):!1},Zn.unstable_batchedUpdates=R_,Zn.unstable_renderSubtreeIntoContainer=function(a,u,d,p){if(!Eg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return xg(a,u,d,!1,p)},Zn.version="18.3.1-next-f1338f8080-20240426",Zn}var FT;function SN(){if(FT)return j_.exports;FT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),j_.exports=IN(),j_.exports}var jT;function CN(){if(jT)return Ig;jT=1;var n=SN();return Ig.createRoot=n.createRoot,Ig.hydrateRoot=n.hydrateRoot,Ig}var RN=CN();const AN=fw(RN);var ee=Wd();const PN=fw(ee),gw=ee.createContext({});function pw(n){const e=ee.useRef(null);return e.current===null&&(e.current=n()),e.current}const mm=ee.createContext(null),mw=ee.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class bN extends ee.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function kN({children:n,isPresent:e}){const t=ee.useId(),i=ee.useRef(null),r=ee.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=ee.useContext(mw);return ee.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${c}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),S.jsx(bN,{isPresent:e,childRef:i,sizeRef:r,children:ee.cloneElement(n,{ref:i})})}const DN=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=pw(MN),c=ee.useId(),h=ee.useCallback(m=>{l.set(m,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=ee.useMemo(()=>({id:c,initial:e,isPresent:t,custom:r,onExitComplete:h,register:m=>(l.set(m,!1),()=>l.delete(m))}),s?[Math.random(),h]:[t,h]);return ee.useMemo(()=>{l.forEach((m,y)=>l.set(y,!1))},[t]),ee.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=S.jsx(kN,{isPresent:t,children:n})),S.jsx(mm.Provider,{value:f,children:n})};function MN(){return new Map}function yA(n=!0){const e=ee.useContext(mm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=ee.useId();ee.useEffect(()=>{n&&r(s)},[n]);const o=ee.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Sg=n=>n.key||"";function UT(n){const e=[];return ee.Children.forEach(n,t=>{ee.isValidElement(t)&&e.push(t)}),e}const yw=typeof window<"u",_A=yw?ee.useLayoutEffect:ee.useEffect,ra=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,c]=yA(o),h=ee.useMemo(()=>UT(n),[n]),f=o&&!l?[]:h.map(Sg),m=ee.useRef(!0),y=ee.useRef(h),E=pw(()=>new Map),[x,C]=ee.useState(h),[T,b]=ee.useState(h);_A(()=>{m.current=!1,y.current=h;for(let O=0;O<T.length;O++){const F=Sg(T[O]);f.includes(F)?E.delete(F):E.get(F)!==!0&&E.set(F,!1)}},[T,f.length,f.join("-")]);const P=[];if(h!==x){let O=[...h];for(let F=0;F<T.length;F++){const W=T[F],D=Sg(W);f.includes(D)||(O.splice(F,0,W),P.push(W))}s==="wait"&&P.length&&(O=P),b(UT(O)),C(h);return}const{forceRender:k}=ee.useContext(gw);return S.jsx(S.Fragment,{children:T.map(O=>{const F=Sg(O),W=o&&!l?!1:h===T||f.includes(F),D=()=>{if(E.has(F))E.set(F,!0);else return;let R=!0;E.forEach(M=>{M||(R=!1)}),R&&(k?.(),b(y.current),o&&c?.(),i&&i())};return S.jsx(DN,{isPresent:W,initial:!m.current||t?void 0:!1,custom:W?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:W?void 0:D,children:O},F)})})},Ti=n=>n;let vA=Ti;function _w(n){let e;return()=>(e===void 0&&(e=n()),e)}const ec=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},js=n=>n*1e3,Us=n=>n/1e3,NN={useManualTiming:!1};function LN(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(c.schedule(h),n()),h(o)}const c={schedule:(h,f=!1,m=!1)=>{const E=m&&i?e:t;return f&&s.add(h),E.has(h)||E.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,c.process(h))}};return c}const Cg=["read","resolveKeyframes","update","preRender","render","postRender"],ON=40;function wA(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Cg.reduce((b,P)=>(b[P]=LN(s),b),{}),{read:l,resolveKeyframes:c,update:h,preRender:f,render:m,postRender:y}=o,E=()=>{const b=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(b-r.timestamp,ON),1),r.timestamp=b,r.isProcessing=!0,l.process(r),c.process(r),h.process(r),f.process(r),m.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(E))},x=()=>{t=!0,i=!0,r.isProcessing||n(E)};return{schedule:Cg.reduce((b,P)=>{const k=o[P];return b[P]=(O,F=!1,W=!1)=>(t||x(),k.schedule(O,F,W)),b},{}),cancel:b=>{for(let P=0;P<Cg.length;P++)o[Cg[P]].cancel(b)},state:r,steps:o}}const{schedule:xt,cancel:Zo,state:vn,steps:B_}=wA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ti,!0),EA=ee.createContext({strict:!1}),zT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},tc={};for(const n in zT)tc[n]={isEnabled:e=>zT[n].some(t=>!!e[t])};function VN(n){for(const e in n)tc[e]={...tc[e],...n[e]}}const FN=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function _p(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||FN.has(n)}let xA=n=>!_p(n);function jN(n){n&&(xA=e=>e.startsWith("on")?!_p(e):n(e))}try{jN(require("@emotion/is-prop-valid").default)}catch{}function UN(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(xA(r)||t===!0&&_p(r)||!e&&!_p(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function zN(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const ym=ee.createContext({});function dd(n){return typeof n=="string"||Array.isArray(n)}function _m(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const vw=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ww=["initial",...vw];function vm(n){return _m(n.animate)||ww.some(e=>dd(n[e]))}function TA(n){return!!(vm(n)||n.variants)}function BN(n,e){if(vm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||dd(t)?t:void 0,animate:dd(i)?i:void 0}}return n.inherit!==!1?e:{}}function GN(n){const{initial:e,animate:t}=BN(n,ee.useContext(ym));return ee.useMemo(()=>({initial:e,animate:t}),[BT(e),BT(t)])}function BT(n){return Array.isArray(n)?n.join(" "):n}const WN=Symbol.for("motionComponentSymbol");function Fu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function KN(n,e,t){return ee.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Fu(t)&&(t.current=i))},[e])}const Ew=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),$N="framerAppearId",IA="data-"+Ew($N),{schedule:xw}=wA(queueMicrotask,!1),SA=ee.createContext({});function HN(n,e,t,i,r){var s,o;const{visualElement:l}=ee.useContext(ym),c=ee.useContext(EA),h=ee.useContext(mm),f=ee.useContext(mw).reducedMotion,m=ee.useRef(null);i=i||c.renderer,!m.current&&i&&(m.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=m.current,E=ee.useContext(SA);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&XN(m.current,t,r,E);const x=ee.useRef(!1);ee.useInsertionEffect(()=>{y&&x.current&&y.update(t,h)});const C=t[IA],T=ee.useRef(!!C&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,C))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,C)));return _A(()=>{y&&(x.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),xw.render(y.render),T.current&&y.animationState&&y.animationState.animateChanges())}),ee.useEffect(()=>{y&&(!T.current&&y.animationState&&y.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,C)}),T.current=!1))}),y}function XN(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:CA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&Fu(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:c,layoutRoot:h})}function CA(n){if(n)return n.options.allowProjection!==!1?n.projection:CA(n.parent)}function qN({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&VN(n);function l(h,f){let m;const y={...ee.useContext(mw),...h,layoutId:YN(h)},{isStatic:E}=y,x=GN(h),C=i(h,E);if(!E&&yw){ZN();const T=QN(y);m=T.MeasureLayout,x.visualElement=HN(r,C,y,e,T.ProjectionNode)}return S.jsxs(ym.Provider,{value:x,children:[m&&x.visualElement?S.jsx(m,{visualElement:x.visualElement,...y}):null,t(r,h,KN(C,x.visualElement,f),C,E,x.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const c=ee.forwardRef(l);return c[WN]=r,c}function YN({layoutId:n}){const e=ee.useContext(gw).id;return e&&n!==void 0?e+"-"+n:n}function ZN(n,e){ee.useContext(EA).strict}function QN(n){const{drag:e,layout:t}=tc;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const JN=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Tw(n){return typeof n!="string"||n.includes("-")?!1:!!(JN.indexOf(n)>-1||/[A-Z]/u.test(n))}function GT(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Iw(n,e,t,i){if(typeof e=="function"){const[r,s]=GT(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=GT(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const Y0=n=>Array.isArray(n),eL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),tL=n=>Y0(n)?n[n.length-1]||0:n,Nn=n=>!!(n&&n.getVelocity);function Jg(n){const e=Nn(n)?n.get():n;return eL(e)?e.toValue():e}function nL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:iL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const RA=n=>(e,t)=>{const i=ee.useContext(ym),r=ee.useContext(mm),s=()=>nL(n,e,i,r);return t?s():pw(s)};function iL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=Jg(s[y]);let{initial:o,animate:l}=n;const c=vm(n),h=TA(n);e&&h&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const m=f?l:o;if(m&&typeof m!="boolean"&&!_m(m)){const y=Array.isArray(m)?m:[m];for(let E=0;E<y.length;E++){const x=Iw(n,y[E]);if(x){const{transitionEnd:C,transition:T,...b}=x;for(const P in b){let k=b[P];if(Array.isArray(k)){const O=f?k.length-1:0;k=k[O]}k!==null&&(r[P]=k)}for(const P in C)r[P]=C[P]}}}return r}const Rc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Rl=new Set(Rc),AA=n=>e=>typeof e=="string"&&e.startsWith(n),PA=AA("--"),rL=AA("var(--"),Sw=n=>rL(n)?sL.test(n.split("/*")[0].trim()):!1,sL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,bA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Ks=(n,e,t)=>t>e?e:t<n?n:t,Ac={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},fd={...Ac,transform:n=>Ks(0,1,n)},Rg={...Ac,default:1},Kd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Mo=Kd("deg"),es=Kd("%"),ke=Kd("px"),oL=Kd("vh"),aL=Kd("vw"),WT={...es,parse:n=>es.parse(n)/100,transform:n=>es.transform(n*100)},lL={borderWidth:ke,borderTopWidth:ke,borderRightWidth:ke,borderBottomWidth:ke,borderLeftWidth:ke,borderRadius:ke,radius:ke,borderTopLeftRadius:ke,borderTopRightRadius:ke,borderBottomRightRadius:ke,borderBottomLeftRadius:ke,width:ke,maxWidth:ke,height:ke,maxHeight:ke,top:ke,right:ke,bottom:ke,left:ke,padding:ke,paddingTop:ke,paddingRight:ke,paddingBottom:ke,paddingLeft:ke,margin:ke,marginTop:ke,marginRight:ke,marginBottom:ke,marginLeft:ke,backgroundPositionX:ke,backgroundPositionY:ke},uL={rotate:Mo,rotateX:Mo,rotateY:Mo,rotateZ:Mo,scale:Rg,scaleX:Rg,scaleY:Rg,scaleZ:Rg,skew:Mo,skewX:Mo,skewY:Mo,distance:ke,translateX:ke,translateY:ke,translateZ:ke,x:ke,y:ke,z:ke,perspective:ke,transformPerspective:ke,opacity:fd,originX:WT,originY:WT,originZ:ke},KT={...Ac,transform:Math.round},Cw={...lL,...uL,zIndex:KT,size:ke,fillOpacity:fd,strokeOpacity:fd,numOctaves:KT},cL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hL=Rc.length;function dL(n,e,t){let i="",r=!0;for(let s=0;s<hL;s++){const o=Rc[s],l=n[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||t){const h=bA(l,Cw[o]);if(!c){r=!1;const f=cL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Rw(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const c in e){const h=e[c];if(Rl.has(c)){o=!0;continue}else if(PA(c)){r[c]=h;continue}else{const f=bA(h,Cw[c]);c.startsWith("origin")?(l=!0,s[c]=f):i[c]=f}}if(e.transform||(o||t?i.transform=dL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:c="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${c} ${h} ${f}`}}const fL={offset:"stroke-dashoffset",array:"stroke-dasharray"},gL={offset:"strokeDashoffset",array:"strokeDasharray"};function pL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?fL:gL;n[s.offset]=ke.transform(-i);const o=ke.transform(e),l=ke.transform(t);n[s.array]=`${o} ${l}`}function $T(n,e,t){return typeof n=="string"?n:ke.transform(e+t*n)}function mL(n,e,t){const i=$T(e,n.x,n.width),r=$T(t,n.y,n.height);return`${i} ${r}`}function Aw(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...h},f,m){if(Rw(n,h,m),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:E,dimensions:x}=n;y.transform&&(x&&(E.transform=y.transform),delete y.transform),x&&(r!==void 0||s!==void 0||E.transform)&&(E.transformOrigin=mL(x,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&pL(y,o,l,c,!1)}const Pw=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),kA=()=>({...Pw(),attrs:{}}),bw=n=>typeof n=="string"&&n.toLowerCase()==="svg";function DA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const MA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function NA(n,e,t,i){DA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(MA.has(r)?r:Ew(r),e.attrs[r])}const vp={};function yL(n){Object.assign(vp,n)}function LA(n,{layout:e,layoutId:t}){return Rl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!vp[n]||n==="opacity")}function kw(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Nn(r[o])||e.style&&Nn(e.style[o])||LA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function OA(n,e,t){const i=kw(n,e,t);for(const r in n)if(Nn(n[r])||Nn(e[r])){const s=Rc.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function _L(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const HT=["x","y","width","height","cx","cy","r"],vL={useVisualState:RA({scrapeMotionValuesFromProps:OA,createRenderState:kA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Rl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<HT.length;l++){const c=HT[l];n[c]!==e[c]&&(o=!0)}o&&xt.read(()=>{_L(t,i),xt.render(()=>{Aw(i,r,bw(t.tagName),n.transformTemplate),NA(t,i)})})}})},wL={useVisualState:RA({scrapeMotionValuesFromProps:kw,createRenderState:Pw})};function VA(n,e,t){for(const i in e)!Nn(e[i])&&!LA(i,t)&&(n[i]=e[i])}function EL({transformTemplate:n},e){return ee.useMemo(()=>{const t=Pw();return Rw(t,e,n),Object.assign({},t.vars,t.style)},[e])}function xL(n,e){const t=n.style||{},i={};return VA(i,t,n),Object.assign(i,EL(n,e)),i}function TL(n,e){const t={},i=xL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function IL(n,e,t,i){const r=ee.useMemo(()=>{const s=kA();return Aw(s,e,bw(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};VA(s,n.style,n),r.style={...s,...r.style}}return r}function SL(n=!1){return(t,i,r,{latestValues:s},o)=>{const c=(Tw(t)?IL:TL)(i,s,o,t),h=UN(i,typeof t=="string",n),f=t!==ee.Fragment?{...h,...c,ref:r}:{},{children:m}=i,y=ee.useMemo(()=>Nn(m)?m.get():m,[m]);return ee.createElement(t,{...f,children:y})}}function CL(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Tw(i)?vL:wL,preloadedFeatures:n,useRender:SL(r),createVisualElement:e,Component:i};return qN(o)}}function FA(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function wm(n,e,t){const i=n.getProps();return Iw(i,e,t!==void 0?t:i.custom,n)}const RL=_w(()=>window.ScrollTimeline!==void 0);class AL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(RL()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class PL extends AL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Dw(n,e){return n?n[e]||n.default||n:void 0}const Z0=2e4;function jA(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<Z0;)e+=t,i=n.next(e);return e>=Z0?1/0:e}function Mw(n){return typeof n=="function"}function XT(n,e){n.timeline=e,n.onfinish=null}const Nw=n=>Array.isArray(n)&&typeof n[0]=="number",bL={linearEasing:void 0};function kL(n,e){const t=_w(n);return()=>{var i;return(i=bL[e])!==null&&i!==void 0?i:t()}}const wp=kL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),UA=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(ec(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function zA(n){return!!(typeof n=="function"&&wp()||!n||typeof n=="string"&&(n in Q0||wp())||Nw(n)||Array.isArray(n)&&n.every(zA))}const Vh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,Q0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Vh([0,.65,.55,1]),circOut:Vh([.55,0,1,.45]),backIn:Vh([.31,.01,.66,-.59]),backOut:Vh([.33,1.53,.69,.99])};function BA(n,e){if(n)return typeof n=="function"&&wp()?UA(n,e):Nw(n)?Vh(n):Array.isArray(n)?n.map(t=>BA(t,e)||Q0.easeOut):Q0[n]}const cr={x:!1,y:!1};function GA(){return cr.x||cr.y}function DL(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function WA(n,e){const t=DL(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function qT(n){return e=>{e.pointerType==="touch"||GA()||n(e)}}function ML(n,e,t={}){const[i,r,s]=WA(n,t),o=qT(l=>{const{target:c}=l,h=e(l);if(typeof h!="function"||!c)return;const f=qT(m=>{h(m),c.removeEventListener("pointerleave",f)});c.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const KA=(n,e)=>e?n===e?!0:KA(n,e.parentElement):!1,Lw=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,NL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function LL(n){return NL.has(n.tagName)||n.tabIndex!==-1}const Fh=new WeakSet;function YT(n){return e=>{e.key==="Enter"&&n(e)}}function G_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const OL=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=YT(()=>{if(Fh.has(t))return;G_(t,"down");const r=YT(()=>{G_(t,"up")}),s=()=>G_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function ZT(n){return Lw(n)&&!GA()}function VL(n,e,t={}){const[i,r,s]=WA(n,t),o=l=>{const c=l.currentTarget;if(!ZT(l)||Fh.has(c))return;Fh.add(c);const h=e(l),f=(E,x)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",y),!(!ZT(E)||!Fh.has(c))&&(Fh.delete(c),typeof h=="function"&&h(E,{success:x}))},m=E=>{f(E,t.useGlobalTarget||KA(c,E.target))},y=E=>{f(E,!1)};window.addEventListener("pointerup",m,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!LL(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>OL(h,r),r)}),s}function FL(n){return n==="x"||n==="y"?cr[n]?null:(cr[n]=!0,()=>{cr[n]=!1}):cr.x||cr.y?null:(cr.x=cr.y=!0,()=>{cr.x=cr.y=!1})}const $A=new Set(["width","height","top","left","right","bottom",...Rc]);let ep;function jL(){ep=void 0}const ts={now:()=>(ep===void 0&&ts.set(vn.isProcessing||NN.useManualTiming?vn.timestamp:performance.now()),ep),set:n=>{ep=n,queueMicrotask(jL)}};function Ow(n,e){n.indexOf(e)===-1&&n.push(e)}function Vw(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Fw{constructor(){this.subscriptions=[]}add(e){return Ow(this.subscriptions,e),()=>Vw(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function HA(n,e){return e?n*(1e3/e):0}const QT=30,UL=n=>!isNaN(parseFloat(n));class zL{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=ts.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ts.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=UL(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Fw);const i=this.events[e].add(t);return e==="change"?()=>{i(),xt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ts.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>QT)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,QT);return HA(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gd(n,e){return new zL(n,e)}function BL(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,gd(t))}function GL(n,e){const t=wm(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=tL(s[o]);BL(n,o,l)}}function WL(n){return!!(Nn(n)&&n.add)}function J0(n,e){const t=n.getValue("willChange");if(WL(t))return t.add(e)}function XA(n){return n.props[IA]}const qA=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,KL=1e-7,$L=12;function HL(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=qA(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>KL&&++l<$L);return o}function $d(n,e,t,i){if(n===e&&t===i)return Ti;const r=s=>HL(s,0,1,n,t);return s=>s===0||s===1?s:qA(r(s),e,i)}const YA=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,ZA=n=>e=>1-n(1-e),QA=$d(.33,1.53,.69,.99),jw=ZA(QA),JA=YA(jw),eP=n=>(n*=2)<1?.5*jw(n):.5*(2-Math.pow(2,-10*(n-1))),Uw=n=>1-Math.sin(Math.acos(n)),tP=ZA(Uw),nP=YA(Uw),iP=n=>/^0[^.\s]+$/u.test(n);function XL(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||iP(n):!0}const qh=n=>Math.round(n*1e5)/1e5,zw=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function qL(n){return n==null}const YL=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Bw=(n,e)=>t=>!!(typeof t=="string"&&YL.test(t)&&t.startsWith(n)||e&&!qL(t)&&Object.prototype.hasOwnProperty.call(t,e)),rP=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(zw);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},ZL=n=>Ks(0,255,n),W_={...Ac,transform:n=>Math.round(ZL(n))},qa={test:Bw("rgb","red"),parse:rP("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+W_.transform(n)+", "+W_.transform(e)+", "+W_.transform(t)+", "+qh(fd.transform(i))+")"};function QL(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const ev={test:Bw("#"),parse:QL,transform:qa.transform},ju={test:Bw("hsl","hue"),parse:rP("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+es.transform(qh(e))+", "+es.transform(qh(t))+", "+qh(fd.transform(i))+")"},Dn={test:n=>qa.test(n)||ev.test(n)||ju.test(n),parse:n=>qa.test(n)?qa.parse(n):ju.test(n)?ju.parse(n):ev.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?qa.transform(n):ju.transform(n)},JL=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function eO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(zw))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(JL))===null||t===void 0?void 0:t.length)||0)>0}const sP="number",oP="color",tO="var",nO="var(",JT="${}",iO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function pd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(iO,c=>(Dn.test(c)?(i.color.push(s),r.push(oP),t.push(Dn.parse(c))):c.startsWith(nO)?(i.var.push(s),r.push(tO),t.push(c)):(i.number.push(s),r.push(sP),t.push(parseFloat(c))),++s,JT)).split(JT);return{values:t,split:l,indexes:i,types:r}}function aP(n){return pd(n).values}function lP(n){const{split:e,types:t}=pd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===sP?s+=qh(r[o]):l===oP?s+=Dn.transform(r[o]):s+=r[o]}return s}}const rO=n=>typeof n=="number"?0:n;function sO(n){const e=aP(n);return lP(n)(e.map(rO))}const Qo={test:eO,parse:aP,createTransformer:lP,getAnimatableNone:sO},oO=new Set(["brightness","contrast","saturate","opacity"]);function aO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(zw)||[];if(!i)return n;const r=t.replace(i,"");let s=oO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const lO=/\b([a-z-]*)\(.*?\)/gu,tv={...Qo,getAnimatableNone:n=>{const e=n.match(lO);return e?e.map(aO).join(" "):n}},uO={...Cw,color:Dn,backgroundColor:Dn,outlineColor:Dn,fill:Dn,stroke:Dn,borderColor:Dn,borderTopColor:Dn,borderRightColor:Dn,borderBottomColor:Dn,borderLeftColor:Dn,filter:tv,WebkitFilter:tv},Gw=n=>uO[n];function uP(n,e){let t=Gw(n);return t!==tv&&(t=Qo),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const cO=new Set(["auto","none","0"]);function hO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!cO.has(s)&&pd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=uP(t,r)}const eI=n=>n===Ac||n===ke,tI=(n,e)=>parseFloat(n.split(", ")[e]),nI=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return tI(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?tI(s[1],n):0}},dO=new Set(["x","y","z"]),fO=Rc.filter(n=>!dO.has(n));function gO(n){const e=[];return fO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const nc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:nI(4,13),y:nI(5,14)};nc.translateX=nc.x;nc.translateY=nc.y;const il=new Set;let nv=!1,iv=!1;function cP(){if(iv){const n=Array.from(il).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=gO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}iv=!1,nv=!1,il.forEach(n=>n.complete()),il.clear()}function hP(){il.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(iv=!0)})}function pO(){hP(),cP()}class Ww{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(il.add(this),nv||(nv=!0,xt.read(hP),xt.resolveKeyframes(cP))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const c=i.readValue(t,l);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),il.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,il.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const dP=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),mO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function yO(n){const e=mO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function fP(n,e,t=1){const[i,r]=yO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return dP(o)?parseFloat(o):o}return Sw(r)?fP(r,e,t+1):r}const gP=n=>e=>e.test(n),_O={test:n=>n==="auto",parse:n=>n},pP=[Ac,ke,es,Mo,aL,oL,_O],iI=n=>pP.find(gP(n));class mP extends Ww{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),Sw(h))){const f=fP(h,t.current);f!==void 0&&(e[c]=f),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!$A.has(i)||e.length!==2)return;const[r,s]=e,o=iI(r),l=iI(s);if(o!==l)if(eI(o)&&eI(l))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)XL(e[r])&&i.push(r);i.length&&hO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=nc[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=nc[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}const rI=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Qo.test(n)||n==="0")&&!n.startsWith("url("));function vO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function wO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=rI(r,e),l=rI(s,e);return!o||!l?!1:vO(n)||(t==="spring"||Mw(t))&&i}const EO=n=>n!==null;function Em(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(EO),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const xO=40;class yP{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ts.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>xO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&pO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ts.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:c,isGenerator:h}=this.options;if(!h&&!wO(e,i,r,s))if(o)this.options.duration=0;else{c&&c(Em(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const kt=(n,e,t)=>n+(e-n)*t;function K_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function TO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,c=2*t-l;r=K_(c,l,n+1/3),s=K_(c,l,n),o=K_(c,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Ep(n,e){return t=>t>0?e:n}const $_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},IO=[ev,qa,ju],SO=n=>IO.find(e=>e.test(n));function sI(n){const e=SO(n);if(!e)return!1;let t=e.parse(n);return e===ju&&(t=TO(t)),t}const oI=(n,e)=>{const t=sI(n),i=sI(e);if(!t||!i)return Ep(n,e);const r={...t};return s=>(r.red=$_(t.red,i.red,s),r.green=$_(t.green,i.green,s),r.blue=$_(t.blue,i.blue,s),r.alpha=kt(t.alpha,i.alpha,s),qa.transform(r))},CO=(n,e)=>t=>e(n(t)),Hd=(...n)=>n.reduce(CO),rv=new Set(["none","hidden"]);function RO(n,e){return rv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function AO(n,e){return t=>kt(n,e,t)}function Kw(n){return typeof n=="number"?AO:typeof n=="string"?Sw(n)?Ep:Dn.test(n)?oI:kO:Array.isArray(n)?_P:typeof n=="object"?Dn.test(n)?oI:PO:Ep}function _P(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>Kw(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function PO(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=Kw(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function bO(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],c=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=c,r[o]++}return i}const kO=(n,e)=>{const t=Qo.createTransformer(e),i=pd(n),r=pd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?rv.has(n)&&!r.values.length||rv.has(e)&&!i.values.length?RO(n,e):Hd(_P(bO(i,r),r.values),t):Ep(n,e)};function vP(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kt(n,e,t):Kw(n)(n,e)}const DO=5;function wP(n,e,t){const i=Math.max(e-DO,0);return HA(t-n(i),e-i)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},H_=.001;function MO({duration:n=Lt.duration,bounce:e=Lt.bounce,velocity:t=Lt.velocity,mass:i=Lt.mass}){let r,s,o=1-e;o=Ks(Lt.minDamping,Lt.maxDamping,o),n=Ks(Lt.minDuration,Lt.maxDuration,Us(n)),o<1?(r=h=>{const f=h*o,m=f*n,y=f-t,E=sv(h,o),x=Math.exp(-m);return H_-y/E*x},s=h=>{const m=h*o*n,y=m*t+t,E=Math.pow(o,2)*Math.pow(h,2)*n,x=Math.exp(-m),C=sv(Math.pow(h,2),o);return(-r(h)+H_>0?-1:1)*((y-E)*x)/C}):(r=h=>{const f=Math.exp(-h*n),m=(h-t)*n+1;return-H_+f*m},s=h=>{const f=Math.exp(-h*n),m=(t-h)*(n*n);return f*m});const l=5/n,c=LO(r,s,l);if(n=js(n),isNaN(c))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:n};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const NO=12;function LO(n,e,t){let i=t;for(let r=1;r<NO;r++)i=i-n(i)/e(i);return i}function sv(n,e){return n*Math.sqrt(1-e*e)}const OO=["duration","bounce"],VO=["stiffness","damping","mass"];function aI(n,e){return e.some(t=>n[t]!==void 0)}function FO(n){let e={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...n};if(!aI(n,VO)&&aI(n,OO))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Ks(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Lt.mass,stiffness:r,damping:s}}else{const t=MO(n);e={...e,...t,mass:Lt.mass},e.isResolvedFromDuration=!0}return e}function EP(n=Lt.visualDuration,e=Lt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:c,damping:h,mass:f,duration:m,velocity:y,isResolvedFromDuration:E}=FO({...t,velocity:-Us(t.velocity||0)}),x=y||0,C=h/(2*Math.sqrt(c*f)),T=o-s,b=Us(Math.sqrt(c/f)),P=Math.abs(T)<5;i||(i=P?Lt.restSpeed.granular:Lt.restSpeed.default),r||(r=P?Lt.restDelta.granular:Lt.restDelta.default);let k;if(C<1){const F=sv(b,C);k=W=>{const D=Math.exp(-C*b*W);return o-D*((x+C*b*T)/F*Math.sin(F*W)+T*Math.cos(F*W))}}else if(C===1)k=F=>o-Math.exp(-b*F)*(T+(x+b*T)*F);else{const F=b*Math.sqrt(C*C-1);k=W=>{const D=Math.exp(-C*b*W),R=Math.min(F*W,300);return o-D*((x+C*b*T)*Math.sinh(R)+F*T*Math.cosh(R))/F}}const O={calculatedDuration:E&&m||null,next:F=>{const W=k(F);if(E)l.done=F>=m;else{let D=0;C<1&&(D=F===0?js(x):wP(k,F,W));const R=Math.abs(D)<=i,M=Math.abs(o-W)<=r;l.done=R&&M}return l.value=l.done?o:W,l},toString:()=>{const F=Math.min(jA(O),Z0),W=UA(D=>O.next(F*D).value,F,30);return F+"ms "+W}};return O}function lI({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:c,restDelta:h=.5,restSpeed:f}){const m=n[0],y={done:!1,value:m},E=R=>l!==void 0&&R<l||c!==void 0&&R>c,x=R=>l===void 0?c:c===void 0||Math.abs(l-R)<Math.abs(c-R)?l:c;let C=t*e;const T=m+C,b=o===void 0?T:o(T);b!==T&&(C=b-m);const P=R=>-C*Math.exp(-R/i),k=R=>b+P(R),O=R=>{const M=P(R),V=k(R);y.done=Math.abs(M)<=h,y.value=y.done?b:V};let F,W;const D=R=>{E(y.value)&&(F=R,W=EP({keyframes:[y.value,x(y.value)],velocity:wP(k,R,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return D(0),{calculatedDuration:null,next:R=>{let M=!1;return!W&&F===void 0&&(M=!0,O(R),D(R)),F!==void 0&&R>=F?W.next(R-F):(!M&&O(R),y)}}}const jO=$d(.42,0,1,1),UO=$d(0,0,.58,1),xP=$d(.42,0,.58,1),zO=n=>Array.isArray(n)&&typeof n[0]!="number",BO={linear:Ti,easeIn:jO,easeInOut:xP,easeOut:UO,circIn:Uw,circInOut:nP,circOut:tP,backIn:jw,backInOut:JA,backOut:QA,anticipate:eP},uI=n=>{if(Nw(n)){vA(n.length===4);const[e,t,i,r]=n;return $d(e,t,i,r)}else if(typeof n=="string")return BO[n];return n};function GO(n,e,t){const i=[],r=t||vP,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||Ti:e;l=Hd(c,l)}i.push(l)}return i}function WO(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(vA(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=GO(e,i,r),c=l.length,h=f=>{if(o&&f<n[0])return e[0];let m=0;if(c>1)for(;m<n.length-2&&!(f<n[m+1]);m++);const y=ec(n[m],n[m+1],f);return l[m](y)};return t?f=>h(Ks(n[0],n[s-1],f)):h}function KO(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=ec(0,e,i);n.push(kt(t,1,r))}}function $O(n){const e=[0];return KO(e,n.length-1),e}function HO(n,e){return n.map(t=>t*e)}function XO(n,e){return n.map(()=>e||xP).splice(0,n.length-1)}function xp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=zO(i)?i.map(uI):uI(i),s={done:!1,value:e[0]},o=HO(t&&t.length===e.length?t:$O(e),n),l=WO(o,e,{ease:Array.isArray(r)?r:XO(e,r)});return{calculatedDuration:n,next:c=>(s.value=l(c),s.done=c>=n,s)}}const qO=n=>{const e=({timestamp:t})=>n(t);return{start:()=>xt.update(e,!0),stop:()=>Zo(e),now:()=>vn.isProcessing?vn.timestamp:ts.now()}},YO={decay:lI,inertia:lI,tween:xp,keyframes:xp,spring:EP},ZO=n=>n/100;class $w extends yP{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||Ww,l=(c,h)=>this.onKeyframesResolved(c,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Mw(t)?t:YO[t]||xp;let c,h;l!==xp&&typeof e[0]!="number"&&(c=Hd(ZO,vP(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=jA(f));const{calculatedDuration:m}=f,y=m+r,E=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:c,calculatedDuration:m,resolvedDuration:y,totalDuration:E}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:c,calculatedDuration:h,totalDuration:f,resolvedDuration:m}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:E,repeatType:x,repeatDelay:C,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-y*(this.speed>=0?1:-1),P=this.speed>=0?b<0:b>f;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let k=this.currentTime,O=s;if(E){const R=Math.min(this.currentTime,f)/m;let M=Math.floor(R),V=R%1;!V&&R>=1&&(V=1),V===1&&M--,M=Math.min(M,E+1),M%2&&(x==="reverse"?(V=1-V,C&&(V-=C/m)):x==="mirror"&&(O=o)),k=Ks(0,1,V)*m}const F=P?{done:!1,value:c[0]}:O.next(k);l&&(F.value=l(F.value));let{done:W}=F;!P&&h!==null&&(W=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return D&&r!==void 0&&(F.value=Em(c,this.options,r)),T&&T(F.value),D&&this.finish(),F}get duration(){const{resolved:e}=this;return e?Us(e.calculatedDuration):0}get time(){return Us(this.currentTime)}set time(e){e=js(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Us(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=qO,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const QO=new Set(["opacity","clipPath","filter","transform"]);function JO(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:c}={}){const h={[e]:t};c&&(h.offset=c);const f=BA(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const eV=_w(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Tp=10,tV=2e4;function nV(n){return Mw(n.type)||n.type==="spring"||!zA(n.ease)}function iV(n,e){const t=new $w({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<tV;)i=t.sample(s),r.push(i.value),s+=Tp;return{times:void 0,keyframes:r,duration:s-Tp,ease:"linear"}}const TP={anticipate:eP,backInOut:JA,circInOut:nP};function rV(n){return n in TP}class cI extends yP{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new mP(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:c,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&wp()&&rV(s)&&(s=TP[s]),nV(this.options)){const{onComplete:m,onUpdate:y,motionValue:E,element:x,...C}=this.options,T=iV(e,C);e=T.keyframes,e.length===1&&(e[1]=e[0]),i=T.duration,r=T.times,s=T.ease,o="keyframes"}const f=JO(l.owner.current,c,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(XT(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;l.set(Em(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Us(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Us(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=js(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ti;const{animation:i}=t;XT(i,e)}return Ti}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:m,element:y,...E}=this.options,x=new $w({...E,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),C=js(this.time);h.setWithVelocity(x.sample(C-Tp).value,x.sample(C).value,Tp)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=t.owner.getProps();return eV()&&i&&QO.has(i)&&!c&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const sV={type:"spring",stiffness:500,damping:25,restSpeed:10},oV=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),aV={type:"keyframes",duration:.8},lV={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},uV=(n,{keyframes:e})=>e.length>2?aV:Rl.has(n)?n.startsWith("scale")?oV(e[1]):sV:lV;function cV({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:c,elapsed:h,...f}){return!!Object.keys(f).length}const Hw=(n,e,t,i={},r,s)=>o=>{const l=Dw(i,n)||{},c=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-js(c);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};cV(l)||(f={...f,...uV(n,f)}),f.duration&&(f.duration=js(f.duration)),f.repeatDelay&&(f.repeatDelay=js(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!s&&e.get()!==void 0){const y=Em(f.keyframes,l);if(y!==void 0)return xt.update(()=>{f.onUpdate(y),f.onComplete()}),new PL([])}return!s&&cI.supports(f)?new cI(f):new $w(f)};function hV({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function IP(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...c}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const m in c){const y=n.getValue(m,(s=n.latestValues[m])!==null&&s!==void 0?s:null),E=c[m];if(E===void 0||f&&hV(f,m))continue;const x={delay:t,...Dw(o||{},m)};let C=!1;if(window.MotionHandoffAnimation){const b=XA(n);if(b){const P=window.MotionHandoffAnimation(b,m,xt);P!==null&&(x.startTime=P,C=!0)}}J0(n,m),y.start(Hw(m,y,E,n.shouldReduceMotion&&$A.has(m)?{type:!1}:x,n,C));const T=y.animation;T&&h.push(T)}return l&&Promise.all(h).then(()=>{xt.update(()=>{l&&GL(n,l)})}),h}function ov(n,e,t={}){var i;const r=wm(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(IP(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:y}=s;return dV(n,e,f+h,m,y,t)}:()=>Promise.resolve(),{when:c}=s;if(c){const[h,f]=c==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function dV(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,c=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(fV).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(ov(h,e,{...s,delay:t+c(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function fV(n,e){return n.sortNodePosition(e)}function gV(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>ov(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=ov(n,e,t);else{const r=typeof e=="function"?wm(n,e,t.custom):e;i=Promise.all(IP(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const pV=ww.length;function SP(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?SP(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<pV;t++){const i=ww[t],r=n.props[i];(dd(r)||r===!1)&&(e[i]=r)}return e}const mV=[...vw].reverse(),yV=vw.length;function _V(n){return e=>Promise.all(e.map(({animation:t,options:i})=>gV(n,t,i)))}function vV(n){let e=_V(n),t=hI(),i=!0;const r=c=>(h,f)=>{var m;const y=wm(n,f,c==="exit"?(m=n.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(y){const{transition:E,transitionEnd:x,...C}=y;h={...h,...C,...x}}return h};function s(c){e=c(n)}function o(c){const{props:h}=n,f=SP(n.parent)||{},m=[],y=new Set;let E={},x=1/0;for(let T=0;T<yV;T++){const b=mV[T],P=t[b],k=h[b]!==void 0?h[b]:f[b],O=dd(k),F=b===c?P.isActive:null;F===!1&&(x=T);let W=k===f[b]&&k!==h[b]&&O;if(W&&i&&n.manuallyAnimateOnMount&&(W=!1),P.protectedKeys={...E},!P.isActive&&F===null||!k&&!P.prevProp||_m(k)||typeof k=="boolean")continue;const D=wV(P.prevProp,k);let R=D||b===c&&P.isActive&&!W&&O||T>x&&O,M=!1;const V=Array.isArray(k)?k:[k];let j=V.reduce(r(b),{});F===!1&&(j={});const{prevResolvedValues:z={}}=P,L={...z,...j},ae=ce=>{R=!0,y.has(ce)&&(M=!0,y.delete(ce)),P.needsAnimating[ce]=!0;const J=n.getValue(ce);J&&(J.liveStyle=!1)};for(const ce in L){const J=j[ce],oe=z[ce];if(E.hasOwnProperty(ce))continue;let ne=!1;Y0(J)&&Y0(oe)?ne=!FA(J,oe):ne=J!==oe,ne?J!=null?ae(ce):y.add(ce):J!==void 0&&y.has(ce)?ae(ce):P.protectedKeys[ce]=!0}P.prevProp=k,P.prevResolvedValues=j,P.isActive&&(E={...E,...j}),i&&n.blockInitialAnimation&&(R=!1),R&&(!(W&&D)||M)&&m.push(...V.map(ce=>({animation:ce,options:{type:b}})))}if(y.size){const T={};y.forEach(b=>{const P=n.getBaseTarget(b),k=n.getValue(b);k&&(k.liveStyle=!0),T[b]=P??null}),m.push({animation:T})}let C=!!m.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(C=!1),i=!1,C?e(m):Promise.resolve()}function l(c,h){var f;if(t[c].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var E;return(E=y.animationState)===null||E===void 0?void 0:E.setActive(c,h)}),t[c].isActive=h;const m=o(c);for(const y in t)t[y].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=hI(),i=!0}}}function wV(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!FA(e,n):!1}function Ma(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function hI(){return{animate:Ma(!0),whileInView:Ma(),whileHover:Ma(),whileTap:Ma(),whileDrag:Ma(),whileFocus:Ma(),exit:Ma()}}let sa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class EV extends sa{constructor(e){super(e),e.animationState||(e.animationState=vV(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();_m(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let xV=0;class TV extends sa{constructor(){super(...arguments),this.id=xV++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const IV={animation:{Feature:EV},exit:{Feature:TV}};function md(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Xd(n){return{point:{x:n.pageX,y:n.pageY}}}const SV=n=>e=>Lw(e)&&n(e,Xd(e));function Yh(n,e,t,i){return md(n,e,SV(t),i)}const dI=(n,e)=>Math.abs(n-e);function CV(n,e){const t=dI(n.x,e.x),i=dI(n.y,e.y);return Math.sqrt(t**2+i**2)}class CP{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=q_(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,E=CV(m.offset,{x:0,y:0})>=3;if(!y&&!E)return;const{point:x}=m,{timestamp:C}=vn;this.history.push({...x,timestamp:C});const{onStart:T,onMove:b}=this.handlers;y||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=X_(y,this.transformPagePoint),xt.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:E,onSessionEnd:x,resumeAnimation:C}=this.handlers;if(this.dragSnapToOrigin&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=q_(m.type==="pointercancel"?this.lastMoveEventInfo:X_(y,this.transformPagePoint),this.history);this.startEvent&&E&&E(m,T),x&&x(m,T)},!Lw(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=Xd(e),l=X_(o,this.transformPagePoint),{point:c}=l,{timestamp:h}=vn;this.history=[{...c,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,q_(l,this.history)),this.removeListeners=Hd(Yh(this.contextWindow,"pointermove",this.handlePointerMove),Yh(this.contextWindow,"pointerup",this.handlePointerUp),Yh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Zo(this.updatePoint)}}function X_(n,e){return e?{point:e(n.point)}:n}function fI(n,e){return{x:n.x-e.x,y:n.y-e.y}}function q_({point:n},e){return{point:n,delta:fI(n,RP(e)),offset:fI(n,RV(e)),velocity:AV(e,.1)}}function RV(n){return n[0]}function RP(n){return n[n.length-1]}function AV(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=RP(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>js(e)));)t--;if(!i)return{x:0,y:0};const s=Us(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const AP=1e-4,PV=1-AP,bV=1+AP,PP=.01,kV=0-PP,DV=0+PP;function Ii(n){return n.max-n.min}function MV(n,e,t){return Math.abs(n-e)<=t}function gI(n,e,t,i=.5){n.origin=i,n.originPoint=kt(e.min,e.max,n.origin),n.scale=Ii(t)/Ii(e),n.translate=kt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=PV&&n.scale<=bV||isNaN(n.scale))&&(n.scale=1),(n.translate>=kV&&n.translate<=DV||isNaN(n.translate))&&(n.translate=0)}function Zh(n,e,t,i){gI(n.x,e.x,t.x,i?i.originX:void 0),gI(n.y,e.y,t.y,i?i.originY:void 0)}function pI(n,e,t){n.min=t.min+e.min,n.max=n.min+Ii(e)}function NV(n,e,t){pI(n.x,e.x,t.x),pI(n.y,e.y,t.y)}function mI(n,e,t){n.min=e.min-t.min,n.max=n.min+Ii(e)}function Qh(n,e,t){mI(n.x,e.x,t.x),mI(n.y,e.y,t.y)}function LV(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?kt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?kt(t,n,i.max):Math.min(n,t)),n}function yI(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function OV(n,{top:e,left:t,bottom:i,right:r}){return{x:yI(n.x,t,r),y:yI(n.y,e,i)}}function _I(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function VV(n,e){return{x:_I(n.x,e.x),y:_I(n.y,e.y)}}function FV(n,e){let t=.5;const i=Ii(n),r=Ii(e);return r>i?t=ec(e.min,e.max-i,n.min):i>r&&(t=ec(n.min,n.max-r,e.min)),Ks(0,1,t)}function jV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const av=.35;function UV(n=av){return n===!1?n=0:n===!0&&(n=av),{x:vI(n,"left","right"),y:vI(n,"top","bottom")}}function vI(n,e,t){return{min:wI(n,e),max:wI(n,t)}}function wI(n,e){return typeof n=="number"?n:n[e]||0}const EI=()=>({translate:0,scale:1,origin:0,originPoint:0}),Uu=()=>({x:EI(),y:EI()}),xI=()=>({min:0,max:0}),Ut=()=>({x:xI(),y:xI()});function Gi(n){return[n("x"),n("y")]}function bP({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function zV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function BV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function Y_(n){return n===void 0||n===1}function lv({scale:n,scaleX:e,scaleY:t}){return!Y_(n)||!Y_(e)||!Y_(t)}function Va(n){return lv(n)||kP(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function kP(n){return TI(n.x)||TI(n.y)}function TI(n){return n&&n!=="0%"}function Ip(n,e,t){const i=n-t,r=e*i;return t+r}function II(n,e,t,i,r){return r!==void 0&&(n=Ip(n,r,i)),Ip(n,t,i)+e}function uv(n,e=0,t=1,i,r){n.min=II(n.min,e,t,i,r),n.max=II(n.max,e,t,i,r)}function DP(n,{x:e,y:t}){uv(n.x,e.translate,e.scale,e.originPoint),uv(n.y,t.translate,t.scale,t.originPoint)}const SI=.999999999999,CI=1.0000000000001;function GV(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Bu(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,DP(n,o)),i&&Va(s.latestValues)&&Bu(n,s.latestValues))}e.x<CI&&e.x>SI&&(e.x=1),e.y<CI&&e.y>SI&&(e.y=1)}function zu(n,e){n.min=n.min+e,n.max=n.max+e}function RI(n,e,t,i,r=.5){const s=kt(n.min,n.max,r);uv(n,e,t,s,i)}function Bu(n,e){RI(n.x,e.x,e.scaleX,e.scale,e.originX),RI(n.y,e.y,e.scaleY,e.scale,e.originY)}function MP(n,e){return bP(BV(n.getBoundingClientRect(),e))}function WV(n,e,t){const i=MP(n,t),{scroll:r}=e;return r&&(zu(i.x,r.offset.x),zu(i.y,r.offset.y)),i}const NP=({current:n})=>n?n.ownerDocument.defaultView:null,KV=new WeakMap;class $V{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Xd(f).point)},s=(f,m)=>{const{drag:y,dragPropagation:E,onDragStart:x}=this.getProps();if(y&&!E&&(this.openDragLock&&this.openDragLock(),this.openDragLock=FL(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Gi(T=>{let b=this.getAxisMotionValue(T).get()||0;if(es.test(b)){const{projection:P}=this.visualElement;if(P&&P.layout){const k=P.layout.layoutBox[T];k&&(b=Ii(k)*(parseFloat(b)/100))}}this.originPoint[T]=b}),x&&xt.postRender(()=>x(f,m)),J0(this.visualElement,"transform");const{animationState:C}=this.visualElement;C&&C.setActive("whileDrag",!0)},o=(f,m)=>{const{dragPropagation:y,dragDirectionLock:E,onDirectionLock:x,onDrag:C}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:T}=m;if(E&&this.currentDirection===null){this.currentDirection=HV(T),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),C&&C(f,m)},l=(f,m)=>this.stop(f,m),c=()=>Gi(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new CP(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:NP(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&xt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Ag(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=LV(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Fu(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=OV(r.layoutBox,t):this.constraints=!1,this.elastic=UV(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Gi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=jV(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fu(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=WV(i,r.root,this.visualElement.getTransformPagePoint());let o=VV(r.layout.layoutBox,s);if(t){const l=t(zV(o));this.hasMutatedConstraints=!!l,l&&(o=bP(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},h=Gi(f=>{if(!Ag(f,t,this.currentDirection))return;let m=c&&c[f]||{};o&&(m={min:0,max:0});const y=r?200:1e6,E=r?40:1e7,x={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:E,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(f,x)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return J0(this.visualElement,e),i.start(Hw(e,i,0,t,this.visualElement,!1))}stopAnimation(){Gi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Gi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Gi(t=>{const{drag:i}=this.getProps();if(!Ag(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-kt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Fu(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Gi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();r[o]=FV({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Gi(o=>{if(!Ag(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];l.set(kt(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;KV.set(this.visualElement,this);const e=this.visualElement.current,t=Yh(e,"pointerdown",c=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Fu(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),xt.read(i);const o=md(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(Gi(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=c[f].translate,m.set(m.get()+c[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=av,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Ag(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function HV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class XV extends sa{constructor(e){super(e),this.removeGroupControls=Ti,this.removeListeners=Ti,this.controls=new $V(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ti}unmount(){this.removeGroupControls(),this.removeListeners()}}const AI=n=>(e,t)=>{n&&xt.postRender(()=>n(e,t))};class qV extends sa{constructor(){super(...arguments),this.removePointerDownListener=Ti}onPointerDown(e){this.session=new CP(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:NP(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:AI(e),onStart:AI(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&xt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Yh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const tp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function PI(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ih={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(ke.test(n))n=parseFloat(n);else return n;const t=PI(n,e.target.x),i=PI(n,e.target.y);return`${t}% ${i}%`}},YV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=Qo.parse(n);if(r.length>5)return i;const s=Qo.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=c;const h=kt(l,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class ZV extends ee.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;yL(QV),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),tp.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||xt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),xw.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function LP(n){const[e,t]=yA(),i=ee.useContext(gw);return S.jsx(ZV,{...n,layoutGroup:i,switchLayoutGroup:ee.useContext(SA),isPresent:e,safeToRemove:t})}const QV={borderRadius:{...Ih,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ih,borderTopRightRadius:Ih,borderBottomLeftRadius:Ih,borderBottomRightRadius:Ih,boxShadow:YV};function JV(n,e,t){const i=Nn(n)?n:gd(n);return i.start(Hw("",i,e,t)),i.animation}function eF(n){return n instanceof SVGElement&&n.tagName!=="svg"}const tF=(n,e)=>n.depth-e.depth;class nF{constructor(){this.children=[],this.isDirty=!1}add(e){Ow(this.children,e),this.isDirty=!0}remove(e){Vw(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(tF),this.isDirty=!1,this.children.forEach(e)}}function iF(n,e){const t=ts.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Zo(i),n(s-e))};return xt.read(i,!0),()=>Zo(i)}const OP=["TopLeft","TopRight","BottomLeft","BottomRight"],rF=OP.length,bI=n=>typeof n=="string"?parseFloat(n):n,kI=n=>typeof n=="number"||ke.test(n);function sF(n,e,t,i,r,s){r?(n.opacity=kt(0,t.opacity!==void 0?t.opacity:1,oF(i)),n.opacityExit=kt(e.opacity!==void 0?e.opacity:1,0,aF(i))):s&&(n.opacity=kt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<rF;o++){const l=`border${OP[o]}Radius`;let c=DI(e,l),h=DI(t,l);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||kI(c)===kI(h)?(n[l]=Math.max(kt(bI(c),bI(h),i),0),(es.test(h)||es.test(c))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=kt(e.rotate||0,t.rotate||0,i))}function DI(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const oF=VP(0,.5,tP),aF=VP(.5,.95,Ti);function VP(n,e,t){return i=>i<n?0:i>e?1:t(ec(n,e,i))}function MI(n,e){n.min=e.min,n.max=e.max}function zi(n,e){MI(n.x,e.x),MI(n.y,e.y)}function NI(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function LI(n,e,t,i,r){return n-=e,n=Ip(n,1/t,i),r!==void 0&&(n=Ip(n,1/r,i)),n}function lF(n,e=0,t=1,i=.5,r,s=n,o=n){if(es.test(e)&&(e=parseFloat(e),e=kt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=kt(s.min,s.max,i);n===s&&(l-=e),n.min=LI(n.min,e,t,l,r),n.max=LI(n.max,e,t,l,r)}function OI(n,e,[t,i,r],s,o){lF(n,e[t],e[i],e[r],e.scale,s,o)}const uF=["x","scaleX","originX"],cF=["y","scaleY","originY"];function VI(n,e,t,i){OI(n.x,e,uF,t?t.x:void 0,i?i.x:void 0),OI(n.y,e,cF,t?t.y:void 0,i?i.y:void 0)}function FI(n){return n.translate===0&&n.scale===1}function FP(n){return FI(n.x)&&FI(n.y)}function jI(n,e){return n.min===e.min&&n.max===e.max}function hF(n,e){return jI(n.x,e.x)&&jI(n.y,e.y)}function UI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function jP(n,e){return UI(n.x,e.x)&&UI(n.y,e.y)}function zI(n){return Ii(n.x)/Ii(n.y)}function BI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class dF{constructor(){this.members=[]}add(e){Ow(this.members,e),e.scheduleRender()}remove(e){if(Vw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function fF(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:m,rotateY:y,skewX:E,skewY:x}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),m&&(i+=`rotateX(${m}deg) `),y&&(i+=`rotateY(${y}deg) `),E&&(i+=`skewX(${E}deg) `),x&&(i+=`skewY(${x}deg) `)}const l=n.x.scale*e.x,c=n.y.scale*e.y;return(l!==1||c!==1)&&(i+=`scale(${l}, ${c})`),i||"none"}const Fa={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},jh=typeof window<"u"&&window.MotionDebug!==void 0,Z_=["","X","Y","Z"],gF={visibility:"hidden"},GI=1e3;let pF=0;function Q_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function UP(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=XA(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",xt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&UP(i)}function zP({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=pF++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jh&&(Fa.totalNodes=Fa.resolvedTargetDeltas=Fa.recalculatedProjection=0),this.nodes.forEach(_F),this.nodes.forEach(TF),this.nodes.forEach(IF),this.nodes.forEach(vF),jh&&window.MotionDebug.record(Fa)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new nF)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Fw),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=eF(o),this.instance=o;const{layoutId:c,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||c)&&(this.isLayoutDirty=!0),n){let m;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=iF(y,250),tp.hasAnimatedSinceResize&&(tp.hasAnimatedSinceResize=!1,this.nodes.forEach(KI))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&f&&(c||h)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:y,hasRelativeTargetChanged:E,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const C=this.options.transition||f.getDefaultTransition()||PF,{onLayoutAnimationStart:T,onLayoutAnimationComplete:b}=f.getProps(),P=!this.targetLayout||!jP(this.targetLayout,x)||E,k=!y&&E;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||k||y&&(P||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,k);const O={...Dw(C,"layout"),onPlay:T,onComplete:b};(f.shouldReduceMotion||this.options.layoutRoot)&&(O.delay=0,O.type=!1),this.startAnimation(O)}else y||KI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Zo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(SF),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&UP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(WI);return}this.isUpdating||this.nodes.forEach(EF),this.isUpdating=!1,this.nodes.forEach(xF),this.nodes.forEach(mF),this.nodes.forEach(yF),this.clearAllSnapshots();const l=ts.now();vn.delta=Ks(0,1e3/60,l-vn.timestamp),vn.timestamp=l,vn.isProcessing=!0,B_.update.process(vn),B_.preRender.process(vn),B_.render.process(vn),vn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,xw.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(wF),this.sharedNodes.forEach(CF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!FP(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Va(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),bF(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const c=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(kF))){const{scroll:f}=this.root;f&&(zu(c.x,f.offset.x),zu(c.y,f.offset.y))}return c}removeElementScroll(o){var l;const c=Ut();if(zi(c,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return c;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:m,options:y}=f;f!==this.root&&m&&y.layoutScroll&&(m.wasRoot&&zi(c,o),zu(c.x,m.offset.x),zu(c.y,m.offset.y))}return c}applyTransform(o,l=!1){const c=Ut();zi(c,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Bu(c,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Va(f.latestValues)&&Bu(c,f.latestValues)}return Va(this.latestValues)&&Bu(c,this.latestValues),c}removeTransform(o){const l=Ut();zi(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!Va(h.latestValues))continue;lv(h.latestValues)&&h.updateSnapshot();const f=Ut(),m=h.measurePageBox();zi(f,m),VI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Va(this.latestValues)&&VI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==c;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:y}=this.options;if(!(!this.layout||!(m||y))){if(this.resolvedRelativeTargetAt=vn.timestamp,!this.targetDelta&&!this.relativeTarget){const E=this.getClosestProjectingParent();E&&E.layout&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.layout.layoutBox,E.layout.layoutBox),zi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),NV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):zi(this.target,this.layout.layoutBox),DP(this.target,this.targetDelta)):zi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const E=this.getClosestProjectingParent();E&&!!E.resumingFrom==!!this.resumingFrom&&!E.options.layoutScroll&&E.target&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.target,E.target),zi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}jh&&Fa.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||lv(this.parent.latestValues)||kP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===vn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;zi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,E=this.treeScale.y;GV(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:x}=l;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(NI(this.prevProjectionDelta.x,this.projectionDelta.x),NI(this.prevProjectionDelta.y,this.projectionDelta.y)),Zh(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==E||!BI(this.projectionDelta.x,this.prevProjectionDelta.x)||!BI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),jh&&Fa.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Uu(),this.projectionDelta=Uu(),this.projectionDeltaWithTransform=Uu()}setAnimationOrigin(o,l=!1){const c=this.snapshot,h=c?c.latestValues:{},f={...this.latestValues},m=Uu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),E=c?c.source:void 0,x=this.layout?this.layout.source:void 0,C=E!==x,T=this.getStack(),b=!T||T.members.length<=1,P=!!(C&&!b&&this.options.crossfade===!0&&!this.path.some(AF));this.animationProgress=0;let k;this.mixTargetDelta=O=>{const F=O/1e3;$I(m.x,o.x,F),$I(m.y,o.y,F),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qh(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),RF(this.relativeTarget,this.relativeTargetOrigin,y,F),k&&hF(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Ut()),zi(k,this.relativeTarget)),C&&(this.animationValues=f,sF(f,h,this.latestValues,F,P,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Zo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xt.update(()=>{tp.hasAnimatedSinceResize=!0,this.currentAnimation=JV(0,GI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(GI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:h,latestValues:f}=o;if(!(!l||!c||!h)){if(this!==o&&this.layout&&h&&BP(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||Ut();const m=Ii(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+m;const y=Ii(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+y}zi(l,c),Bu(l,f),Zh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new dF),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const h={};c.z&&Q_("z",o,h,this.animationValues);for(let f=0;f<Z_.length;f++)Q_(`rotate${Z_[f]}`,o,h,this.animationValues),Q_(`skew${Z_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return gF;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=Jg(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const C={};return this.options.layoutId&&(C.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,C.pointerEvents=Jg(o?.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(C.transform=f?f({},""):"none",this.hasProjected=!1),C}const y=m.animationValues||m.latestValues;this.applyTransformsToTarget(),h.transform=fF(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x:E,y:x}=this.projectionDelta;h.transformOrigin=`${E.origin*100}% ${x.origin*100}% 0`,m.animationValues?h.opacity=m===this?(c=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=m===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const C in vp){if(y[C]===void 0)continue;const{correct:T,applyTo:b}=vp[C],P=h.transform==="none"?y[C]:T(y[C],m);if(b){const k=b.length;for(let O=0;O<k;O++)h[b[O]]=P}else h[C]=P}return this.options.layoutId&&(h.pointerEvents=m===this?Jg(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(WI),this.root.sharedNodes.clear()}}}function mF(n){n.updateLayout()}function yF(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Gi(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],E=Ii(y);y.min=i[m].min,y.max=y.min+E}):BP(s,t.layoutBox,i)&&Gi(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],E=Ii(i[m]);y.max=y.min+E,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[m].max=n.relativeTarget[m].min+E)});const l=Uu();Zh(l,i,t.layoutBox);const c=Uu();o?Zh(c,n.applyTransform(r,!0),t.measuredBox):Zh(c,i,t.layoutBox);const h=!FP(l);let f=!1;if(!n.resumeFrom){const m=n.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:y,layout:E}=m;if(y&&E){const x=Ut();Qh(x,t.layoutBox,y.layoutBox);const C=Ut();Qh(C,i,E.layoutBox),jP(x,C)||(f=!0),m.options.layoutRoot&&(n.relativeTarget=C,n.relativeTargetOrigin=x,n.relativeParent=m)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function _F(n){jh&&Fa.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function vF(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function wF(n){n.clearSnapshot()}function WI(n){n.clearMeasurements()}function EF(n){n.isLayoutDirty=!1}function xF(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function KI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function TF(n){n.resolveTargetDelta()}function IF(n){n.calcProjection()}function SF(n){n.resetSkewAndRotation()}function CF(n){n.removeLeadSnapshot()}function $I(n,e,t){n.translate=kt(e.translate,0,t),n.scale=kt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function HI(n,e,t,i){n.min=kt(e.min,t.min,i),n.max=kt(e.max,t.max,i)}function RF(n,e,t,i){HI(n.x,e.x,t.x,i),HI(n.y,e.y,t.y,i)}function AF(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const PF={duration:.45,ease:[.4,0,.1,1]},XI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),qI=XI("applewebkit/")&&!XI("chrome/")?Math.round:Ti;function YI(n){n.min=qI(n.min),n.max=qI(n.max)}function bF(n){YI(n.x),YI(n.y)}function BP(n,e,t){return n==="position"||n==="preserve-aspect"&&!MV(zI(e),zI(t),.2)}function kF(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const DF=zP({attachResizeListener:(n,e)=>md(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),J_={current:void 0},GP=zP({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!J_.current){const n=new DF({});n.mount(window),n.setOptions({layoutScroll:!0}),J_.current=n}return J_.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),MF={pan:{Feature:qV},drag:{Feature:XV,ProjectionNode:GP,MeasureLayout:LP}};function ZI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&xt.postRender(()=>s(e,Xd(e)))}class NF extends sa{mount(){const{current:e}=this.node;e&&(this.unmount=ML(e,t=>(ZI(this.node,t,"Start"),i=>ZI(this.node,i,"End"))))}unmount(){}}class LF extends sa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Hd(md(this.node.current,"focus",()=>this.onFocus()),md(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function QI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&xt.postRender(()=>s(e,Xd(e)))}class OF extends sa{mount(){const{current:e}=this.node;e&&(this.unmount=VL(e,t=>(QI(this.node,t,"Start"),(i,{success:r})=>QI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const cv=new WeakMap,e0=new WeakMap,VF=n=>{const e=cv.get(n.target);e&&e(n)},FF=n=>{n.forEach(VF)};function jF({root:n,...e}){const t=n||document;e0.has(t)||e0.set(t,{});const i=e0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(FF,{root:n,...e})),i[r]}function UF(n,e,t){const i=jF(e);return cv.set(n,t),i.observe(n),()=>{cv.delete(n),i.unobserve(n)}}const zF={some:0,all:1};class BF extends sa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:zF[r]},l=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),y=h?f:m;y&&y(c)};return UF(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(GF(e,t))&&this.startObserver()}unmount(){}}function GF({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const WF={inView:{Feature:BF},tap:{Feature:OF},focus:{Feature:LF},hover:{Feature:NF}},KF={layout:{ProjectionNode:GP,MeasureLayout:LP}},hv={current:null},WP={current:!1};function $F(){if(WP.current=!0,!!yw)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>hv.current=n.matches;n.addListener(e),e()}else hv.current=!1}const HF=[...pP,Dn,Qo],XF=n=>HF.find(gP(n)),JI=new WeakMap;function qF(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Nn(r))n.addValue(i,r);else if(Nn(s))n.addValue(i,gd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,gd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const eS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class YF{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Ww,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const E=ts.now();this.renderScheduledAt<E&&(this.renderScheduledAt=E,xt.render(this.render,!1,!0))};const{latestValues:c,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=vm(t),this.isVariantNode=TA(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const E in y){const x=y[E];c[E]!==void 0&&Nn(x)&&x.set(c[E],!1)}}mount(e){this.current=e,JI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),WP.current||$F(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:hv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){JI.delete(this.current),this.projection&&this.projection.unmount(),Zo(this.notifyUpdate),Zo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Rl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&xt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in tc){const t=tc[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<eS.length;i++){const r=eS[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=qF(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=gd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(dP(r)||iP(r))?r=parseFloat(r):!XF(r)&&Qo.test(t)&&(r=uP(e,t)),this.setBaseTarget(e,Nn(r)?r.get():r)),Nn(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Iw(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Nn(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Fw),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class KP extends YF{constructor(){super(...arguments),this.KeyframeResolver=mP}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Nn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function ZF(n){return window.getComputedStyle(n)}class QF extends KP{constructor(){super(...arguments),this.type="html",this.renderInstance=DA}readValueFromInstance(e,t){if(Rl.has(t)){const i=Gw(t);return i&&i.default||0}else{const i=ZF(e),r=(PA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return MP(e,t)}build(e,t,i){Rw(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return kw(e,t,i)}}class JF extends KP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Rl.has(t)){const i=Gw(t);return i&&i.default||0}return t=MA.has(t)?t:Ew(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return OA(e,t,i)}build(e,t,i){Aw(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){NA(e,t,i,r)}mount(e){this.isSVGTag=bw(e.tagName),super.mount(e)}}const e3=(n,e)=>Tw(n)?new JF(e):new QF(e,{allowProjection:n!==ee.Fragment}),t3=CL({...IV,...WF,...MF,...KF},e3),it=zN(t3),Jn={ADD:"add",REMOVE:"remove"},ic={PROPERTYCHANGE:"propertychange"},ze={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class xm{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function n3(n,e,t){let i,r;t=t||zs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function zs(n,e){return n>e?1:n<e?-1:0}function i3(n,e){return n<e?1:n>e?-1:0}function Xw(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function r3(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function qw(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function oa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function s3(n,e,t){const i=e||zs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function yd(){return!0}function Tm(){return!1}function _d(){}function $P(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!oa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function o3(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function qd(n){for(const e in n)delete n[e]}function rc(n){let e;for(e in n)return!1;return!e}class Ys{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Im extends xm{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ys(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let c;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?c=r[h].handleEvent(s):c=r[h].call(this,s),c===!1||s.propagationStopped){c=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,_d);delete o[i]}return c}disposeInternal(){this.listeners_&&qd(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=_d,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function tt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Sp(n,e,t,i){return tt(n,e,t,i,!0)}function Rt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),qd(n))}class Yd extends Im{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ze.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=tt(this,e[s],t);return r}return tt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Sp(this,e[s],t)}else i=Sp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)a3(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Yd.prototype.on;Yd.prototype.once;Yd.prototype.un;function a3(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Rt(n[e]);else Rt(n)}function et(){throw new Error("Unimplemented abstract method.")}let l3=0;function nt(n){return n.ol_uid||(n.ol_uid=String(++l3))}class tS extends Ys{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class as extends Yd{constructor(e){super(),this.on,this.once,this.un,nt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new tS(i,e,t)),i=ic.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new tS(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],rc(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const nS={LENGTH:"length"};class Pg extends Ys{constructor(e,t,i){super(e),this.element=t,this.index=i}}class $i extends as{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(nS.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Pg(Jn.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Pg(Jn.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Pg(Jn.REMOVE,r,e)),this.dispatchEvent(new Pg(Jn.ADD,t,e))}updateLength_(){this.set(nS.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function at(n,e){if(!n)throw new Error(e)}class sc extends as{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new sc(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=tt(e,ze.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?u3(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function u3(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(at(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const an={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function iS(n){const e=Zi();for(let t=0,i=n.length;t<i;++t)Jh(e,n[t]);return e}function Yw(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function HP(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function XP(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function oc(n,e){return qP(n,e[0],e[1])}function Uh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function qP(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function dv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let c=an.UNKNOWN;return o<t?c=c|an.LEFT:o>r&&(c=c|an.RIGHT),l<i?c=c|an.BELOW:l>s&&(c=c|an.ABOVE),c===an.UNKNOWN&&(c=an.INTERSECTING),c}function Zi(){return[1/0,1/0,-1/0,-1/0]}function Jo(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Sm(n){return Jo(1/0,1/0,-1/0,-1/0,n)}function YP(n,e){const t=n[0],i=n[1];return Jo(t,i,t,i,e)}function Zw(n,e,t,i,r){const s=Sm(r);return ZP(s,n,e,t,i)}function vd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function c3(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Jh(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function ZP(n,e,t,i,r){for(;t<i;t+=r)h3(n,e[t],e[t+1]);return n}function h3(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function QP(n,e){let t;return t=e(Cm(n)),t||(t=e(Rm(n)),t)||(t=e(Am(n)),t)||(t=e(Al(n)),t)?t:!1}function fv(n){let e=0;return Pm(n)||(e=dt(n)*zn(n)),e}function Cm(n){return[n[0],n[1]]}function Rm(n){return[n[2],n[1]]}function dl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function d3(n,e){let t;if(e==="bottom-left")t=Cm(n);else if(e==="bottom-right")t=Rm(n);else if(e==="top-left")t=Al(n);else if(e==="top-right")t=Am(n);else throw new Error("Invalid corner");return t}function gv(n,e,t,i,r){const[s,o,l,c,h,f,m,y]=JP(n,e,t,i);return Jo(Math.min(s,l,h,m),Math.min(o,c,f,y),Math.max(s,l,h,m),Math.max(o,c,f,y),r)}function JP(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),c=r*o,h=r*l,f=s*o,m=s*l,y=n[0],E=n[1];return[y-c+m,E-h-f,y-c-m,E-h+f,y+c-m,E+h+f,y+c+m,E+h-f,y-c+m,E-h-f]}function zn(n){return n[3]-n[1]}function rl(n,e,t){const i=t||Zi();return ni(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Sm(i),i}function Al(n){return[n[0],n[3]]}function Am(n){return[n[2],n[3]]}function dt(n){return n[2]-n[0]}function ni(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Pm(n){return n[2]<n[0]||n[3]<n[1]}function f3(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function g3(n,e,t){let i=!1;const r=dv(n,e),s=dv(n,t);if(r===an.INTERSECTING||s===an.INTERSECTING)i=!0;else{const o=n[0],l=n[1],c=n[2],h=n[3],f=e[0],m=e[1],y=t[0],E=t[1],x=(E-m)/(y-f);let C,T;s&an.ABOVE&&!(r&an.ABOVE)&&(C=y-(E-h)/x,i=C>=o&&C<=c),!i&&s&an.RIGHT&&!(r&an.RIGHT)&&(T=E-(y-c)*x,i=T>=l&&T<=h),!i&&s&an.BELOW&&!(r&an.BELOW)&&(C=y-(E-l)/x,i=C>=o&&C<=c),!i&&s&an.LEFT&&!(r&an.LEFT)&&(T=E-(y-o)*x,i=T>=l&&T<=h)}return i}function eb(n,e){const t=e.getExtent(),i=dl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=dt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function tb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];eb(n,e);const r=dt(i);if(dt(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function p3(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const c=((n-t)*o+(e-i)*l)/(o*o+l*l);c>1?(t=r,i=s):c>0&&(t+=o*c,i+=l*c)}return $u(n,e,t,i)}function $u(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function m3(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const c=Math.abs(n[l][i]);c>s&&(s=c,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const c=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=c*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function rS(n){return n*180/Math.PI}function Ko(n){return n*Math.PI/180}function sl(n,e){const t=n%e;return t*e<0?t+e:t}function vi(n,e,t){return n+t*(e-n)}function Zd(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function K$(n,e){return Math.round(Zd(n,e))}function bg(n,e){return Math.floor(Zd(n,e))}function kg(n,e){return Math.ceil(Zd(n,e))}function pv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function y3(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Cp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Qw(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function _3(n,e){return n[0]*=e,n[1]*=e,n}function nb(n,e){if(e.canWrapX()){const t=dt(e.getExtent()),i=v3(n,e,t);i&&(n[0]-=i*t)}return n}function v3(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||dt(i),r=Math.floor((n[0]-i[0])/t)),r}function ib(...n){console.warn(...n)}const ac={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Jw{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||ac[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Qd=6378137,Gu=Math.PI*Qd,w3=[-Gu,-Gu,Gu,Gu],E3=[-180,-85,180,85],Dg=Qd*Math.log(Math.tan(Math.PI/2));class yu extends Jw{constructor(e){super({code:e,units:"m",extent:w3,global:!0,worldExtent:E3,getPointResolution:function(t,i){return t/Math.cosh(i[1]/Qd)}})}}const sS=[new yu("EPSG:3857"),new yu("EPSG:102100"),new yu("EPSG:102113"),new yu("EPSG:900913"),new yu("http://www.opengis.net/def/crs/EPSG/0/3857"),new yu("http://www.opengis.net/gml/srs/epsg.xml#3857")];function x3(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Gu*n[s]/180;let o=Qd*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Dg?o=Dg:o<-Dg&&(o=-Dg),e[s+1]=o}return e}function T3(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Gu,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Qd))/Math.PI-90;return e}const I3=6378137,oS=[-180,-90,180,90],S3=Math.PI*I3/180;class Na extends Jw{constructor(e,t){super({code:e,units:"degrees",extent:oS,axisOrientation:t,global:!0,metersPerUnit:S3,worldExtent:oS})}}const aS=[new Na("CRS:84"),new Na("EPSG:4326","neu"),new Na("urn:ogc:def:crs:OGC:1.3:CRS84"),new Na("urn:ogc:def:crs:OGC:2:84"),new Na("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Na("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Na("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let mv={};function C3(n){return mv[n]||mv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function R3(n,e){mv[n]=e}let Hu={};function wd(n,e,t){const i=n.getCode(),r=e.getCode();i in Hu||(Hu[i]={}),Hu[i][r]=t}function t0(n,e){return n in Hu&&e in Hu[n]?Hu[n][e]:null}const Rp=.9996,qi=.00669438,bm=qi*qi,km=bm*qi,Ya=qi/(1-qi),lS=Math.sqrt(1-qi),lc=(1-lS)/(1+lS),rb=lc*lc,eE=rb*lc,tE=eE*lc,sb=tE*lc,ob=1-qi/4-3*bm/64-5*km/256,A3=3*qi/8+3*bm/32+45*km/1024,P3=15*bm/256+45*km/1024,b3=35*km/3072,k3=3/2*lc-27/32*eE+269/512*sb,D3=21/16*rb-55/32*tE,M3=151/96*eE-417/128*sb,N3=1097/512*tE,Ap=6378137;function L3(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Rp/(Ap*ob),l=o+k3*Math.sin(2*o)+D3*Math.sin(4*o)+M3*Math.sin(6*o)+N3*Math.sin(8*o),c=Math.sin(l),h=c*c,f=Math.cos(l),m=c/f,y=m*m,E=y*y,x=1-qi*h,C=Math.sqrt(1-qi*h),T=Ap/C,b=(1-qi)/x,P=Ya*f**2,k=P*P,O=i/(T*Rp),F=O*O,W=F*O,D=W*O,R=D*O,M=R*O,V=l-m/b*(F/2-D/24*(5+3*y+10*P-4*k-9*Ya))+M/720*(61+90*y+298*P+45*E-252*Ya-3*k);let j=(O-W/6*(1+2*y+P)+R/120*(5-2*P+28*y-3*k+8*Ya+24*E))/f;return j=pv(j+Ko(ab(t.number)),-Math.PI,Math.PI),[rS(j),rS(V)]}const uS=-80,cS=84,O3=-180,V3=180;function F3(n,e,t){n=pv(n,O3,V3),e<uS?e=uS:e>cS&&(e=cS);const i=Ko(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,c=l*l,h=Ko(n),f=ab(t.number),m=Ko(f),y=Ap/Math.sqrt(1-qi*r**2),E=Ya*s**2,x=s*pv(h-m,-Math.PI,Math.PI),C=x*x,T=C*x,b=T*x,P=b*x,k=P*x,O=Ap*(ob*i-A3*Math.sin(2*i)+P3*Math.sin(4*i)-b3*Math.sin(6*i)),F=Rp*y*(x+T/6*(1-l+E)+P/120*(5-18*l+c+72*E-58*Ya))+5e5;let W=Rp*(O+y*o*(C/2+b/24*(5-l+9*E+4*E**2)+k/720*(61-58*l+c+600*E-330*Ya)));return t.north||(W+=1e7),[F,W]}function ab(n){return(n-1)*6-180+3}const j3=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function lb(n){let e=0;for(const r of j3){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function hS(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const c=t[l],h=t[l+1],f=n(c,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function U3(n){return lb(n)?new Jw({code:n,units:"m"}):null}function z3(n){const e=lb(n.getCode());return e?{forward:hS(F3,e),inverse:hS(L3,e)}:null}const B3=63710088e-1;function dS(n,e,t){t=t||B3;const i=Ko(n[1]),r=Ko(e[1]),s=(r-i)/2,o=Ko(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const G3=[z3],W3=[U3];let yv=!0;function ub(n){yv=!1}function nE(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function _v(n){R3(n.getCode(),n),wd(n,n,nE)}function K3(n){n.forEach(_v)}function si(n){if(typeof n!="string")return n;const e=C3(n);if(e)return e;for(const t of W3){const i=t(n);if(i)return i}return null}function Pp(n,e,t,i){n=si(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/ac[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=rE(n,si("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=dS(h.slice(0,2),h.slice(2,4)),m=dS(h.slice(4,6),h.slice(6,8));r=(f+m)/2}const c=i?ac[i]:n.getMetersPerUnit();c!==void 0&&(r/=c)}}return r}function fS(n){K3(n),n.forEach(function(e){n.forEach(function(t){e!==t&&wd(e,t,nE)})})}function $3(n,e,t,i){n.forEach(function(r){e.forEach(function(s){wd(r,s,t),wd(s,r,i)})})}function iE(n,e){return n?typeof n=="string"?si(n):n:si(e)}function H3(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),c=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=c?e[o+h]:l[h]}return t})}function fl(n,e){return ub(),Dm(n,"EPSG:4326","EPSG:3857")}function gS(n,e){const t=Dm(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=sl(i+180,360)-180),t}function np(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||rE(n,e)===nE)&&t}function rE(n,e){const t=n.getCode(),i=e.getCode();let r=t0(t,i);if(r)return r;let s=null,o=null;for(const c of G3)s||(s=c(n)),o||(o=c(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=n0(s.inverse,o.forward);else{const c=t0(t,l);c&&(r=n0(c,o.forward))}else{const c=t0(l,i);c&&(r=n0(s.inverse,c))}return r&&(_v(n),_v(e),wd(n,e,r)),r}function n0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function bp(n,e){const t=si(n),i=si(e);return rE(t,i)}function Dm(n,e,t){const i=bp(e,t);if(!i){const r=si(e).getCode(),s=si(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function vv(n,e){return n}function Ds(n,e){return yv&&!Cp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(yv=!1,ib("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function cb(n,e){return n}function zo(n,e){return n}function X3(){fS(sS),fS(aS),$3(aS,sS,x3,T3)}X3();new Array(6);function wr(){return[1,0,0,1,0,0]}function q3(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function $s(n,e,t,i,r,s,o,l){const c=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*c,n[2]=-i*c,n[3]=r*h,n[4]=o*i*h-l*i*c+e,n[5]=o*r*c+l*r*h+t,n}function hb(n,e){const t=Y3(e);at(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],c=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*c-o*l)/t,n[5]=-(i*c-r*l)/t,n}function Y3(n){return n[0]*n[3]-n[1]*n[2]}const Z3=[1e5,1e5,1e5,1e5,2,2];function Q3(n){return"matrix("+n.join(", ")+")"}function wv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function J3(n,e){const t=wv(n),i=wv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*Z3[r])!==0)return!1;return!0}function $o(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let c=e;c<t;c+=i){const h=n[c],f=n[c+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let m=2;m<o;m++)s[l++]=n[c+m]}return s&&s.length!=l&&(s.length=l),s}function db(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),c=Math.sin(r),h=s[0],f=s[1];let m=0;for(let y=e;y<t;y+=i){const E=n[y]-h,x=n[y+1]-f;o[m++]=h+E*l-x*c,o[m++]=f+E*c+x*l;for(let C=y+2;C<y+i;++C)o[m++]=n[C]}return o&&o.length!=m&&(o.length=m),o}function e4(n,e,t,i,r,s,o,l){l=l||[];const c=o[0],h=o[1];let f=0;for(let m=e;m<t;m+=i){const y=n[m]-c,E=n[m+1]-h;l[f++]=c+r*y,l[f++]=h+s*E;for(let x=m+2;x<m+i;++x)l[f++]=n[x]}return l&&l.length!=f&&(l.length=f),l}function t4(n,e,t,i,r,s,o){o=o||[];let l=0;for(let c=e;c<t;c+=i){o[l++]=n[c]+r,o[l++]=n[c+1]+s;for(let h=c+2;h<c+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const pS=wr(),n4=[NaN,NaN];class i4 extends as{constructor(){super(),this.extent_=Zi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=$P((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return et()}closestPointXY(e,t,i,r){return et()}containsXY(e,t){return this.closestPointXY(e,t,n4,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return et()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Sm(t),this.extentRevision_=this.getRevision()}return f3(this.extent_,e)}rotate(e,t){et()}scale(e,t,i){et()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return et()}getType(){return et()}applyTransform(e){et()}intersectsExtent(e){return et()}translate(e,t){et()}transform(e,t){const i=si(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const c=i.getExtent(),h=i.getWorldExtent(),f=zn(h)/zn(c);$s(pS,h[0],h[3],f,-f,0,0,0);const m=$o(s,0,s.length,l,pS,o),y=bp(i,t);return y?y(m,m,l):m}:bp(i,t);return this.applyTransform(r),this}}class sE extends i4{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Zw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return et()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=mS(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){et()}setLayout(e,t,i){let r;if(e)r=mS(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=r4(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();db(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=dl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();e4(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();t4(i,0,i.length,r,e,t,i),this.changed()}}}function r4(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function mS(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function s4(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return $o(i,0,i.length,r,e,t)}function yS(n,e,t,i,r,s,o){const l=n[e],c=n[e+1],h=n[t]-l,f=n[t+1]-c;let m;if(h===0&&f===0)m=e;else{const y=((r-l)*h+(s-c)*f)/(h*h+f*f);if(y>1)m=t;else if(y>0){for(let E=0;E<i;++E)o[E]=vi(n[e+E],n[t+E],y);o.length=i;return}else m=e}for(let y=0;y<i;++y)o[y]=n[m+y];o.length=i}function fb(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],c=n[e+1],h=$u(s,o,l,c);h>r&&(r=h),s=l,o=c}return r}function gb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=fb(n,e,l,i,r),e=l}return r}function $$(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=gb(n,e,l,i,r),e=l[l.length-1]}return r}function pb(n,e,t,i,r,s,o,l,c,h,f){if(e==t)return h;let m,y;if(r===0){if(y=$u(o,l,n[e],n[e+1]),y<h){for(m=0;m<i;++m)c[m]=n[e+m];return c.length=i,y}return h}f=f||[NaN,NaN];let E=e+i;for(;E<t;)if(yS(n,E-i,E,i,o,l,f),y=$u(o,l,f[0],f[1]),y<h){for(h=y,m=0;m<i;++m)c[m]=f[m];c.length=i,E+=i}else E+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(yS(n,t-i,e,i,o,l,f),y=$u(o,l,f[0],f[1]),y<h)){for(h=y,m=0;m<i;++m)c[m]=f[m];c.length=i}return h}function mb(n,e,t,i,r,s,o,l,c,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const E=t[m];h=pb(n,e,E,i,r,s,o,l,c,h,f),e=E}return h}function H$(n,e,t,i,r,s,o,l,c,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const E=t[m];h=mb(n,e,E,i,r,s,o,l,c,h,f),e=E[E.length-1]}return h}function o4(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function yb(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function _b(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=yb(n,e,t[o],i);r[s++]=c,e=c}return r.length=s,r}function X$(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=_b(n,e,t[o],i,r[s]);c.length===0&&(c[0]=e),r[s++]=c,e=c[c.length-1]}return r.length=s,r}function Wu(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function kp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=t[o];r[s++]=Wu(n,e,c,i,r[s]),e=c}return r.length=s,r}function _S(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=t[o];r[s++]=c.length===1&&c[0]===e?[]:kp(n,e,c,i,r[s]),e=c[c.length-1]}return r.length=s,r}function vS(n,e,t,i,r,s,o){let l,c;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,c=r;else if(h!==0){let f=n[e],m=n[e+1],y=0;const E=[0];for(let T=e+i;T<t;T+=i){const b=n[T],P=n[T+1];y+=Math.sqrt((b-f)*(b-f)+(P-m)*(P-m)),E.push(y),f=b,m=P}const x=r*y,C=n3(E,x);C<0?(c=(x-E[-C-2])/(E[-C-1]-E[-C-2]),l=e+(-C-2)*i):l=e+C*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:c===void 0?n[l+f]:vi(n[l+f],n[l+i+f],c);return s}function wS(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,c=t/i;for(;l<c;){const y=l+c>>1;r<n[(y+1)*i-1]?c=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],m=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(vi(n[(l-1)*i+y],n[l*i+y],m));return o.push(r),o}function q$(n,e,t,i,r,s,o){if(o)return wS(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let c=0,h=t.length;c<h;++c){const f=t[c];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return wS(n,e,f,i,r,!1);e=f}}return null}function a4(n,e,t,i,r){return!QP(r,function(o){return!Za(n,e,t,i,o[0],o[1])})}function Za(n,e,t,i,r,s){let o=0,l=n[t-i],c=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];c<=s?f>s&&(h-l)*(s-c)-(r-l)*(f-c)>0&&o++:f<=s&&(h-l)*(s-c)-(r-l)*(f-c)<0&&o--,l=h,c=f}return o!==0}function oE(n,e,t,i,r,s){if(t.length===0||!Za(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Za(n,t[o-1],t[o],i,r,s))return!1;return!0}function Y$(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const c=t[o];if(oE(n,e,c,i,r,s))return!0;e=c[c.length-1]}return!1}function l4(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function aE(n,e,t,i,r,s){return s=s??ZP(Zi(),n,e,t,i),ni(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:l4(n,e,t,i,function(o,l){return g3(r,o,l)}):!1}function Z$(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(aE(n,e,t[s],i,r))return!0;e=t[s]}return!1}function vb(n,e,t,i,r){return!!(aE(n,e,t,i,r)||Za(n,e,t,i,r[0],r[1])||Za(n,e,t,i,r[0],r[3])||Za(n,e,t,i,r[2],r[1])||Za(n,e,t,i,r[2],r[3]))}function wb(n,e,t,i,r){if(!vb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(a4(n,t[s-1],t[s],i,r)&&!aE(n,t[s-1],t[s],i,r))return!1;return!0}function Q$(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(wb(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function u4(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const c=n[l],h=n[l+1];o+=Math.sqrt((c-r)*(c-r)+(h-s)*(h-s)),r=c,s=h}return o}function lE(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const c=new Array(l);c[0]=1,c[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const m=h.pop(),y=h.pop();let E=0;const x=n[y],C=n[y+1],T=n[m],b=n[m+1];for(let P=y+i;P<m;P+=i){const k=n[P],O=n[P+1],F=p3(k,O,x,C,T,b);F>E&&(f=P,E=F)}E>r&&(c[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<m&&h.push(f,m))}for(let m=0;m<l;++m)c[m]&&(s[o++]=n[e+m*i],s[o++]=n[e+m*i+1]);return o}function c4(n,e,t,i,r,s,o,l){for(let c=0,h=t.length;c<h;++c){const f=t[c];o=lE(n,e,f,i,r,s,o),l.push(o),e=f}return o}function ja(n,e){return e*Math.round(n/e)}function h4(n,e,t,i,r,s,o){if(e==t)return o;let l=ja(n[e],r),c=ja(n[e+1],r);e+=i,s[o++]=l,s[o++]=c;let h,f;do if(h=ja(n[e],r),f=ja(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==c);for(;e<t;){const m=ja(n[e],r),y=ja(n[e+1],r);if(e+=i,m==h&&y==f)continue;const E=h-l,x=f-c,C=m-l,T=y-c;if(E*T==x*C&&(E<0&&C<E||E==C||E>0&&C>E)&&(x<0&&T<x||x==T||x>0&&T>x)){h=m,f=y;continue}s[o++]=h,s[o++]=f,l=h,c=f,h=m,f=y}return s[o++]=h,s[o++]=f,o}function uE(n,e,t,i,r,s,o,l){for(let c=0,h=t.length;c<h;++c){const f=t[c];o=h4(n,e,f,i,r,s,o),l.push(o),e=f}return o}function J$(n,e,t,i,r,s,o,l){for(let c=0,h=t.length;c<h;++c){const f=t[c],m=[];o=uE(n,e,f,i,r,s,o,m),l.push(m),e=f[f.length-1]}return o}class gl extends sE{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new gl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=$u(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let c=0;c<l;++c)i[c]=s[c];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return YP(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return qP(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=o4(this.flatCoordinates,0,e,this.stride),this.changed()}}const Hi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},pl=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",d4=pl.includes("safari")&&!pl.includes("chrom");d4&&(pl.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(pl));const f4=pl.includes("webkit")&&!pl.includes("edge"),Eb=pl.includes("macintosh"),g4=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ei=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,xb=typeof Image<"u"&&Image.prototype.decode,Tb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ue={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Qt(n,e,t,i){let r;return t&&t.length?r=t.shift():Ei?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let i0;function Dp(){return i0||(i0=Qt(1,1)),i0}function Mm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function ES(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function p4(n){for(;n.lastChild;)n.lastChild.remove()}function m4(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Ib(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Bo(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const cE=[NaN,NaN,NaN,0];let r0;function y4(){return r0||(r0=Qt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),r0}const _4=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,v4=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,w4=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,E4=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Mg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ed(n){throw new Error('failed to parse "'+n+'" as color')}function Sb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(v4)||n.match(_4)||n.match(w4);if(s){const o=s[4],l=100/255;return[Dt(Mg(s[1],l)+.5|0,0,255),Dt(Mg(s[2],l)+.5|0,0,255),Dt(Mg(s[3],l)+.5|0,0,255),o!==void 0?Dt(Mg(o,100),0,1):1]}ed(n)}if(n.startsWith("#")){if(E4.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let c=0,h=s.length;c<h;c+=o){let f=parseInt(s.substring(c,c+o),16);o===1&&(f+=f<<4),l[c/o]=f}return l[3]=l[3]/255,l}ed(n)}const e=y4();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ed(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Sb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=Zd(r[3]/255,3),r}function x4(n){return typeof n=="string"?n:dE(n)}const T4=1024,Sh={};let s0=0;function I4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function o0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function a0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function l0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function u0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function xS(n){const e=l0(n[0]),t=l0(n[1]),i=l0(n[2]),r=u0(e*.222488403+t*.716873169+i*.06060791),s=500*(u0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-u0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function S4(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=a0(e),s=a0(e+t/500*Math.cos(i)),o=a0(e-t/200*Math.sin(i)),l=o0(s*3.021973625-r*1.617392459-o*.404875592),c=o0(s*-.943766287+r*1.916279586+o*.027607165),h=o0(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(c+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function hE(n){if(n==="none")return cE;if(Sh.hasOwnProperty(n))return Sh[n];if(s0>=T4){let t=0;for(const i in Sh)(t++&3)===0&&(delete Sh[i],--s0)}const e=Sb(n);e.length!==4&&ed(n);for(const t of e)isNaN(t)&&ed(n);return Sh[n]=e,++s0,e}function uc(n){return Array.isArray(n)?n:hE(n)}function dE(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function C4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Sp(i,ze.LOAD,function(){o=!0,s||e()})];return i.src&&xb?(s=!0,i.decode().then(function(){r&&e()}).catch(function(c){r&&(o?e():t())})):l.push(Sp(i,ze.ERROR,t)),function(){r=!1,l.forEach(Rt)}}function R4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function A4(n,e){return e&&(n.src=e),n.src&&xb?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):R4(n)}class P4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=c0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=c0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=c0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ue.IDLE&&r.load(),r.getImageState()===Ue.LOADING?r.ready().then(()=>{this.patternCache_[o]=Dp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Dp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function c0(n,e,t){const i=t?uc(t):"null";return e+":"+n+":"+i}const Xi=new P4;let Ch=null;class Cb extends Im{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ue.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ue.LOADED){Ch||(Ch=Qt(1,1,void 0,{willReadFrequently:!0})),Ch.drawImage(this.image_,0,0);try{Ch.getImageData(0,0,1,1),this.tainted_=!1}catch{Ch=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ze.CHANGE)}handleImageError_(){this.imageState_=Ue.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ue.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Qt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ue.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ue.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&A4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ue.LOADED)return;const t=this.image_,i=Qt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=x4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)e();else{const t=()=>{(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)&&(this.removeEventListener(ze.CHANGE,t),e())};this.addEventListener(ze.CHANGE,t)}})),this.ready_}}function Mp(n,e,t,i,r,s){let o=e===void 0?void 0:Xi.get(e,t,r);return o||(o=new Cb(n,n&&"src"in n?n.src||void 0:e,t,i,r),Xi.set(e,t,r,o,s)),s&&o&&!Xi.getPattern(e,t,r)&&Xi.set(e,t,r,o,s),o}function Yr(n){return n?Array.isArray(n)?dE(n):typeof n=="object"&&"src"in n?b4(n):n:null}function b4(n){if(!n.offset||!n.size)return Xi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Xi.getPattern(e,void 0,n.color);if(t)return t;const i=Xi.get(n.src,"anonymous",null);if(i.getImageState()!==Ue.LOADED)return null;const r=Qt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Mp(r.canvas,e,void 0,Ue.LOADED,n.color,!0),Xi.getPattern(e,void 0,n.color)}class Rb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Ng="ol-hidden",Jd="ol-unselectable",fE="ol-control",TS="ol-collapsed",k4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),IS=["style","variant","weight","size","lineHeight","family"],Ev={normal:400,bold:700},xv=function(n){const e=n.match(k4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=IS.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[IS[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Ev&&(t.weight=Ev[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},Ab="10px sans-serif",ei="#000",cc="round",Bs=[],Gs=0,hc="round",Ed=10,xd="#000",Td="center",Np="middle",Qa=[0,0,0,0],Id=1,bu=new as;let Rh=null,SS;const Tv={},D4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function M4(n,e,t){return`${n} ${e} 16px "${t}"`}const N4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=xv(s),c=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const m=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Ev[f.weight]||f.weight;return m===c&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=bu.getProperties(),l=Object.keys(o).filter(c=>o[c]<100);for(let c=l.length-1;c>=0;--c){const h=l[c];let f=o[h];f<100&&(await i(h)?(qd(Tv),bu.set(h,100)):(f+=10,bu.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ei?self.fonts:document.fonts);const o=xv(s);if(!o)return;const l=o.families;let c=!1;for(const h of l){if(D4.has(h))continue;const f=M4(o.style,o.weight,h);bu.get(f)===void 0&&(bu.set(f,0,!0),c=!0)}c&&(clearTimeout(e),e=setTimeout(r,100))}})(),L4=(function(){let n;return function(e){let t=Tv[e];if(t==null){if(Ei){const i=xv(e),r=Pb(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Tv[e]=t}return t}})();function Pb(n,e){return Rh||(Rh=Qt(1,1)),n!=SS&&(Rh.font=n,SS=Rh.font),Rh.measureText(e)}function bb(n,e){return Pb(n,e).width}function CS(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,bb(n,s)),0);return t[e]=i,i}function O4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,c=0;for(let h=0,f=e.length;h<=f;h+=2){const m=e[h];if(m===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=c,c=0;continue}const y=e[h+1]||n.font,E=bb(y,m);t.push(E),o+=E;const x=L4(y);i.push(x),c=Math.max(c,x)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function V4(n,e,t,i,r,s,o,l,c,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=m=>m.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(c,h),n.scale(f[0],f[1]),F4(i,n)):f[0]<0||f[1]<0?(n.translate(c,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,c,h,o*f[0],l*f[1]),n.restore()}function F4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class j4 extends Rb{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Zd(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=wr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=$o(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,c=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=c*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,m=s.length;f<m;f+=2){const y=s[f]-this.imageAnchorX_,E=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const x=y+this.imageAnchorX_,C=E+this.imageAnchorY_;$s(l,x,C,1,1,h,-x,-C),o.save(),o.transform.apply(o,l),o.translate(x,C),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,E,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=c)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=$o(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const c=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(c-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,c,h),this.textFillState_&&o.fillText(this.text_,c,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=$o(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let c=l.length;s&&(c-=2);for(let h=2;h<c;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ni(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=s4(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ni(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ni(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let c=0,h=o.length;c<h;++c)s=this.moveToLineTo_(r,s,o[c],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ni(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ni(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,c=s.length;l<c;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),oa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Td;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Yr(i||ei)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),c=t.getWidth(),h=t.getMiterLimit(),f=s||Bs;this.strokeState_={lineCap:r!==void 0?r:cc,lineDash:this.pixelRatio_===1?f:f.map(m=>m*this.pixelRatio_),lineDashOffset:(o||Gs)*this.pixelRatio_,lineJoin:l!==void 0?l:hc,lineWidth:(c!==void 0?c:Id)*this.pixelRatio_,miterLimit:h!==void 0?h:Ed,strokeStyle:Yr(i||xd)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const E=t.getColor();this.textFillState_={fillStyle:Yr(E||ei)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const E=i.getColor(),x=i.getLineCap(),C=i.getLineDash(),T=i.getLineDashOffset(),b=i.getLineJoin(),P=i.getWidth(),k=i.getMiterLimit();this.textStrokeState_={lineCap:x!==void 0?x:cc,lineDash:C||Bs,lineDashOffset:T||Gs,lineJoin:b!==void 0?b:hc,lineWidth:P!==void 0?P:Id,miterLimit:k!==void 0?k:Ed,strokeStyle:Yr(E||xd)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),c=e.getRotation(),h=e.getScaleArray(),f=e.getText(),m=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:Ab,textAlign:m!==void 0?m:Td,textBaseline:y!==void 0?y:Np},this.text_=f!==void 0?Array.isArray(f)?f.reduce((E,x,C)=>E+=C%2?" ":x,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=c!==void 0?c:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const U4=.5,kb={Point:X4,LineString:K4,Polygon:Y4,MultiPoint:q4,MultiLineString:$4,MultiPolygon:H4,GeometryCollection:W4,Circle:B4};function z4(n,e){return parseInt(nt(n),10)-parseInt(nt(e),10)}function RS(n,e){const t=Db(n,e);return t*t}function Db(n,e){return U4*n/e}function B4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Circle");c.setFillStrokeStyle(s,o),c.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l),c.drawText(e,i)}}function AS(n,e,t,i,r,s,o,l){const c=[],h=t.getImage();if(h){let y=!0;const E=h.getImageState();E==Ue.LOADED||E==Ue.ERROR?y=!1:E==Ue.IDLE&&h.load(),y&&c.push(h.ready())}const f=t.getFill();f&&f.loading()&&c.push(f.ready());const m=c.length>0;return m&&Promise.all(c).then(()=>r(null)),G4(n,e,t,i,s,o,l),m}function G4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const c=l.simplifyTransformed(i,r);if(t.getRenderer())Mb(n,c,t,e,o);else{const f=kb[c.getType()];f(n,c,t,e,o,s)}}function Mb(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,c=o.length;l<c;++l)Mb(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function W4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,c;for(l=0,c=o.length;l<c;++l){const h=kb[o[l].getType()];h(n,o[l],t,i,r,s)}}function K4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function $4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function H4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l),c.drawText(e,i,r)}}function X4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(o.getImageState()!=Ue.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(c){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function q4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,c=t.getText(),h=c&&c.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Ue.LOADED)return;const m=n.getBuilder(t.getZIndex(),"Image");m.setImageStyle(o,f),m.drawMultiPoint(e,i,r)}if(h){const m=n.getBuilder(t.getZIndex(),"Text");m.setTextStyle(c,f),m.drawText(e,i,r)}}function Y4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l),c.drawText(e,i,r)}}let Z4=!1;function Q4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=Z4,l.onload=function(c){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function PS(n,e){return function(t,i,r,s,o){Q4(n,e,t,i,r,(l,c)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function J4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function ej(n,e,t,i){const r=[];let s=Zi();for(let o=0,l=t.length;o<l;++o){const c=t[o];s=Zw(n,e,c[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=c[c.length-1]}return r}function gE(n,e,t,i,r,s,o){let l,c,h,f,m,y,E;const x=r[s+1],C=[];for(let P=0,k=t.length;P<k;++P){const O=t[P];for(f=n[O-i],y=n[O-i+1],l=e;l<O;l+=i)m=n[l],E=n[l+1],(x<=y&&E<=x||y<=x&&x<=E)&&(h=(x-y)/(E-y)*(m-f)+f,C.push(h)),f=m,y=E}let T=NaN,b=-1/0;for(C.sort(zs),f=C[0],l=1,c=C.length;l<c;++l){m=C[l];const P=Math.abs(m-f);P>b&&(h=(f+m)/2,oE(n,e,t,i,h,x)&&(T=h,b=P)),f=m}return isNaN(T)&&(T=r[s]),o?(o.push(T,x,b),o):[T,x,b]}function tj(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const c=t[o];s=gE(n,e,c,i,r,2*o,s),e=c[c.length-1]}return s}function nj(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function pE(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],c=n[e+1];r+=(l-s)*(c+o),s=l,o=c}return r===0?void 0:r>0}function Nb(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],c=pE(n,e,l,i);if(s===0){if(r&&c||!r&&!c)return!1}else if(r&&!c||!r&&c)return!1;e=l}return!0}function eH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!Nb(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Iv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],c=pE(n,e,l,i);(s===0?r&&c||!r&&!c:r&&!c||!r&&c)&&nj(n,e,l,i),e=l}return e}function tH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Iv(n,e,t[s],i,r);return e}function ij(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const c=e[o],h=pE(n,i,c,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=c}return t}function Lb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,c=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=c*h-l*f,l=h,c=f}return r/2}function Ob(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Lb(n,e,l,i),e=l}return r}function nH(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Ob(n,e,l,i),e=l[l.length-1]}return r}class Sd extends sE{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Sd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<XP(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),pb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Lb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Wu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=lE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Sd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=yb(this.flatCoordinates,0,e,this.stride),this.changed()}}class Cd extends sE{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?qw(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Cd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<XP(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),mb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return oE(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Ob(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Iv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,kp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=dl(this.getExtent());this.flatInteriorPoint_=gE(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new gl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Sd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const c=i[o],h=new Sd(t.slice(s,c),e);r.push(h),s=c}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Nb(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Iv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=uE(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Cd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return wb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=_b(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function bS(n){if(Pm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Cd(s,"XY",[s.length])}const kS=wr();class dr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?YP(this.flatCoordinates_):Zw(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=dl(this.getExtent());this.flatInteriorPoints_=gE(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=ij(this.flatCoordinates_,this.ends_),t=ej(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=tj(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=vS(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=vS(e,t,o,2,.5);qw(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=si(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=zn(i)/zn(t);$s(kS,i[0],i[3],r,-r,0,0,0),$o(this.flatCoordinates_,0,this.flatCoordinates_.length,2,kS,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new dr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=$P((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=lE(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=c4(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=uE(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new dr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}dr.prototype.getFlatCoordinates=dr.prototype.getOrientedFlatCoordinates;function Vb(n,e,t=0,i=n.length-1,r=rj){for(;i>t;){if(i-t>600){const c=i-t+1,h=e-t+1,f=Math.log(c),m=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*m*(c-m)/c)*(h-c/2<0?-1:1),E=Math.max(t,Math.floor(e-h*m/c+y)),x=Math.min(i,Math.floor(e+(c-h)*m/c+y));Vb(n,e,E,x,r)}const s=n[e];let o=t,l=i;for(Ah(n,t,e),r(n[i],s)>0&&Ah(n,t,i);o<l;){for(Ah(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Ah(n,t,l):(l++,Ah(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Ah(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function rj(n,e){return n<e?-1:n>e?1:0}let Fb=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Og(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],c=t.leaf?r(l):l;Og(e,c)&&(t.leaf?i.push(l):d0(e,c)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!Og(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Og(e,o)){if(t.leaf||d0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=ku([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,c,h;for(;i||s.length;){if(i||(i=s.pop(),c=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=sj(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&d0(i,r)?(s.push(i),o.push(l),l=0,c=i,i=i.children[0]):c?(l++,i=c.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=ku(e.slice(t,i+1)),_u(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=ku([]),l.leaf=!1,l.height=r;const c=Math.ceil(s/o),h=c*Math.ceil(Math.sqrt(o));DS(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const m=Math.min(f+h-1,i);DS(e,f,m,c,this.compareMinY);for(let y=f;y<=m;y+=c){const E=Math.min(y+c-1,m);l.children.push(this._build(e,y,E,r-1))}}return _u(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let c=0;c<t.children.length;c++){const h=t.children[c],f=h0(h),m=lj(e,h)-f;m<o?(o=m,s=f<s?f:s,l=h):m===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Bh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=ku(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,_u(i,this.toBBox),_u(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=ku([e,t]),this.data.height=e.height+1,this.data.leaf=!1,_u(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const c=zh(e,0,l,this.toBBox),h=zh(e,l,i,this.toBBox),f=uj(c,h),m=h0(c)+h0(h);f<s?(s=f,r=l,o=m<o?m:o):f===s&&m<o&&(o=m,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:oj,s=e.leaf?this.compareMinY:aj,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=zh(e,0,t,s),l=zh(e,i-t,i,s);let c=Lg(o)+Lg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Bh(o,e.leaf?s(f):f),c+=Lg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Bh(l,e.leaf?s(f):f),c+=Lg(l)}return c}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Bh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():_u(e[t],this.toBBox)}};function sj(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function _u(n,e){zh(n,0,n.children.length,e,n)}function zh(n,e,t,i,r){r||(r=ku(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Bh(r,n.leaf?i(o):o)}return r}function Bh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function oj(n,e){return n.minX-e.minX}function aj(n,e){return n.minY-e.minY}function h0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Lg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function lj(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function uj(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function d0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Og(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function ku(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function DS(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;Vb(n,o,e,t,r),s.push(e,o,o,t)}}class MS{constructor(e){this.rbush_=new Fb(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[nt(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],c={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=c,this.items_[nt(l)]=c}this.rbush_.load(i)}remove(e){const t=nt(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[nt(t)],r=[i.minX,i.minY,i.maxX,i.maxY];vd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return rc(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Jo(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class jb extends as{constructor(e){super(),this.projection=si(e.projection),this.attributions_=NS(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=NS(e),this.changed()}setState(e){this.state_=e,this.changed()}}function NS(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Bi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class To extends Ys{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class mE extends jb{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=_d,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(at(this.format_,"`format` must be set when `url` is set"),this.loader_=PS(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:J4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new MS:null,this.loadedExtentsRtree_=new MS,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new $i(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=nt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new To(Bi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof dr||(this.featureChangeKeys_[e]=[tt(t,ze.CHANGE,this.handleFeatureChange_,this),tt(t,ic.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof dr){const s=this.idIndex_[r];s instanceof dr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(at(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],c=nt(l);this.addToIndex_(c,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],c=nt(l);this.setupChangeEvents_(c,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[c]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Bi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new To(Bi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Bi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Bi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Jn.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Jn.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new To(Bi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof dr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof dr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),rc(this.nullGeometryFeatures_)||qw(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=tb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const c=[-1/0,-1/0,1/0,1/0];return t=t||yd,this.featuresRtree_.forEachInExtent(c,function(h){if(t(h)){const f=h.getGeometry(),m=l;if(l=f instanceof dr?0:f.closestPointXY(i,r,o,l),l<m){s=h;const y=Math.sqrt(l);c[0]=i-y,c[1]=r-y,c[2]=i+y,c[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=nt(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new To(Bi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:nt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&rc(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const c=s[o];r.forEachInExtent(c,function(f){return Uh(f.extent,c)})||(++this.loadingExtentsCount_,this.dispatchEvent(new To(Bi.FEATURESLOADSTART)),this.loader_.call(this,c,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new To(Bi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new To(Bi.FEATURESLOADERROR))}),r.insert(c,{extent:c.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(vd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=nt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Rt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Bi.REMOVEFEATURE)&&this.dispatchEvent(new To(Bi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){at(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(PS(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Tr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Tr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Mp(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ue.IDLE&&t.load(),t.getImageState()===Ue.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?nt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:uc(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Pc{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Pc({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function LS(n){return n[0]>0&&n[1]>0}function cj(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function ri(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Nm{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ri(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Nm({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return et()}getImage(e){return et()}getHitDetectionImage(){return et()}getPixelRatio(e){return 1}getImageState(){return et()}getImageSize(){return et()}getOrigin(){return et()}getSize(){return et()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ri(e)}listenImageChange(e){et()}load(){et()}unlistenImageChange(e){et()}ready(){return Promise.resolve()}}class Lm extends Nm{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ue.LOADING:Ue.LOADED,this.imageState_===Ue.LOADING&&this.ready().then(()=>this.imageState_=Ue.LOADED),this.render()}clone(){const e=this.getScale(),t=new Lm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Xi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Qt(o,o);this.draw_(s,l,e),r=l.canvas,Xi.set(i,null,null,new Cb(r,void 0,null,Ue.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const W=r;r=s,s=W}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,c=s*Math.sin(l),h=Math.sqrt(s*s-c*c),f=r-h,m=Math.sqrt(c*c+f*f),y=m/c;if(e==="miter"&&y<=i)return y*t;const E=t/2/y,x=t/2*(f/m),T=Math.sqrt((r+E)*(r+E)+x*x)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const b=r*Math.sin(l),P=Math.sqrt(r*r-b*b),k=s-P,F=Math.sqrt(b*b+k*k)/b;if(F<=i){const W=F*t/2-s-r;return 2*Math.max(T,W)}return T*2}createRenderOptions(){let e=cc,t=hc,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Yr(this.stroke_.getColor()??xd),l=this.stroke_.getWidth()??Id,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??hc,e=this.stroke_.getLineCap()??cc,i=this.stroke_.getMiterLimit()??Ed);const c=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+c);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ei),t.fillStyle=Yr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=uc(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Qt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const c=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(c),h*Math.sin(c))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ei,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Pl extends Lm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Pl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Yi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=OS,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Yi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=OS,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function hj(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(at(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let f0=null;function Ub(n,e){if(!f0){const t=new Tr({color:"rgba(255,255,255,0.4)"}),i=new Pc({color:"#3399CC",width:1.25});f0=[new Yi({image:new Pl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return f0}function OS(n){return n.getGeometry()}const dj="#333";class ef{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ri(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Tr({color:dj}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ef({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Tr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ri(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Mn={ANIMATING:0,INTERACTING:1},Se={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Vg=[Se.FILL],Go=[Se.STROKE],Ja=[Se.BEGIN_PATH],VS=[Se.CLOSE_PATH];class tf extends Rb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,c=e.length;l<c;l+=t)r[0]=e[l],r[1]=e[l+1],oc(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let c=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],m=e[t+1];const y=this.tmpCoordinate_;let E=!0,x,C,T;for(x=t+r;x<i;x+=r)y[0]=e[x],y[1]=e[x+1],T=dv(h,y),T!==C?(E&&(l[c++]=f,l[c++]=m,E=!1),l[c++]=y[0],l[c++]=y[1]):T===an.INTERSECTING?(l[c++]=y[0],l[c++]=y[1],E=!1):E=!0,f=y[0],m=y[1],C=T;return(s&&E||x===t+r)&&(l[c++]=f,l[c++]=m),c}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const c=i[o],h=this.appendFlatLineCoordinates(e,t,c,r,!1,!1);s.push(h),t=c}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),c=this.coordinates.length;let h,f,m,y,E;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const x=e.getEndss();E=0;for(let C=0,T=x.length;C<T;++C){const b=[];E=this.drawCustomCoordinates_(h,E,x[C],l,b),y.push(b)}this.instructions.push([Se.CUSTOM,c,y,e,i,_S,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,y,e,r||i,_S,s]);break;case"Polygon":case"MultiLineString":m=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),E=this.drawCustomCoordinates_(h,0,e.getEnds(),l,m),this.instructions.push([Se.CUSTOM,c,m,e,i,kp,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,m,e,r||i,kp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Se.CUSTOM,c,f,e,i,Wu,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,f,e,r||i,Wu,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>c&&(this.instructions.push([Se.CUSTOM,c,f,e,i,Wu,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,f,e,r||i,Wu,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Se.CUSTOM,c,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Se.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Se.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Se.END_GEOMETRY?o=t:s==Se.BEGIN_GEOMETRY&&(r[2]=t,r3(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Yr(i||ei)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Yr(i||xd);const r=e.getLineCap();t.lineCap=r!==void 0?r:cc;const s=e.getLineDash();t.lineDash=s?s.slice():Bs;const o=e.getLineDashOffset();t.lineDashOffset=o||Gs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:hc;const c=e.getWidth();t.lineWidth=c!==void 0?c:Id;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Ed,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Se.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Se.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,c=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!oa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=c||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=c,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Se.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=HP(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Yw(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class fj extends tf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!oc(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Se.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let c=0,h=r.length;c<h;c+=e.getStride())(!this.maxExtent||oc(this.maxExtent,r.slice(c,c+2)))&&s.push(r[c],r[c+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Se.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class gj extends tf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Se.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs],Ja);const l=e.getFlatCoordinates(),c=e.getStride();this.drawFlatCoordinates_(l,0,l.length,c),this.hitDetectionInstructions.push(Go),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs],Ja);const l=e.getEnds(),c=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinates_(c,f,l[m],h);this.hitDetectionInstructions.push(Go),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Go),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Go),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Ja)}}class FS extends tf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,c=i.length;this.instructions.push(Ja),this.hitDetectionInstructions.push(Ja);for(let h=0;h<c;++h){const f=i[h],m=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),E=[Se.MOVE_TO_LINE_TO,m,y];this.instructions.push(E),this.hitDetectionInstructions.push(E),l&&(this.instructions.push(VS),this.hitDetectionInstructions.push(VS)),t=f}return o&&(this.instructions.push(Vg),this.hitDetectionInstructions.push(Vg)),l&&(this.instructions.push(Go),this.hitDetectionInstructions.push(Go)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ei]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getFlatCoordinates(),c=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,c,!1,!1);const f=[Se.CIRCLE,h];this.instructions.push(Ja,f),this.hitDetectionInstructions.push(Ja,f),r.fillStyle!==void 0&&(this.instructions.push(Vg),this.hitDetectionInstructions.push(Vg)),r.strokeStyle!==void 0&&(this.instructions.push(Go),this.hitDetectionInstructions.push(Go)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ei]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getEnds(),c=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(c,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ei]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getEndss(),c=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinatess_(c,f,l[m],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=ja(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function pj(n,e,t,i,r){const s=[];let o=t,l=0,c=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=c.slice(-2),m=e[o+r],y=e[o+r+1],E=Math.sqrt((m-h)*(m-h)+(y-f)*(y-f));if(l+=E,l>=n){const x=(n-l+E)/E,C=vi(h,m,x),T=vi(f,y,x);c.push(C,T),s.push(c),c=[C,T],l==n&&(o+=r),l=0}else if(l<n)c.push(e[o+r],e[o+r+1]),o+=r;else{const x=E-l,C=vi(h,m,x/E),T=vi(f,y,x/E);c.push(C,T),s.push(c),c=[C,T],l=0,o+=r}}return l>0&&s.push(c),s}function mj(n,e,t,i,r){let s=t,o=t,l=0,c=0,h=t,f,m,y,E,x,C,T,b,P,k;for(m=t;m<i;m+=r){const O=e[m],F=e[m+1];x!==void 0&&(P=O-x,k=F-C,E=Math.sqrt(P*P+k*k),T!==void 0&&(c+=y,f=Math.acos((T*P+b*k)/(y*E)),f>n&&(c>l&&(l=c,s=h,o=m),c=0,h=m-r)),y=E,T=P,b=k),x=O,C=F}return c+=E,c>l?[h,m]:[s,o]}const Lp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class yj extends tf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ei]={fillStyle:ei},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let c=l.length;const h=e.getType();let f=null,m=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ni(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const T=e.getEndss();y=[];for(let b=0,P=T.length;b<P;++b)y.push(T[b][0])}this.beginGeometry(e,t,i);const E=o.repeat,x=E?void 0:o.textAlign;let C=0;for(let T=0,b=y.length;T<b;++T){let P;E?P=pj(E*this.resolution,f,C,y[T],m):P=[f.slice(C,y[T])];for(let k=0,O=P.length;k<O;++k){const F=P[k];let W=0,D=F.length;if(x==null){const M=mj(o.maxAngle,F,0,F.length,2);W=M[0],D=M[1]}for(let M=W;M<D;M+=m)l.push(F[M],F[M+1]);const R=l.length;C=y[T],this.drawChars_(c,R),c=R}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),m=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),m=3;break;case"MultiPolygon":const O=e.getFlatInteriorPoints();f=[];for(let F=0,W=O.length;F<W;F+=3)o.overflow||y.push(O[F+2]/this.resolution),f.push(O[F],O[F+1]);if(f.length===0)return;m=2;break}const E=this.appendFlatPointCoordinates(f,m);if(E===c)return;if(y&&(E-c)/2!==f.length/m){let O=c/2;y=y.filter((F,W)=>{const D=l[(O+W)*2]===f[W*m]&&l[(O+W)*2+1]===f[W*m+1];return D||--O,D})}this.saveTextStates_();const x=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,C=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let T=o.padding;if(T!=Qa&&(o.scale[0]<0||o.scale[1]<0)){let O=o.padding[0],F=o.padding[1],W=o.padding[2],D=o.padding[3];o.scale[0]<0&&(F=-F,D=-D),o.scale[1]<0&&(O=-O,W=-W),T=[O,F,W,D]}const b=this.pixelRatio;this.instructions.push([Se.DRAW_IMAGE,c,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,T==Qa?Qa:T.map(function(O){return O*b}),x,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const P=1/b,k=x?x.slice(0):null;k&&(k[1]=ei),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,c,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,this.declutterMode_,this.declutterImageWithText_,T,k,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ei:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Td,justify:t.justify,textBaseline:t.textBaseline||Np,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const c=this.pixelRatio,h=Lp[r.textBaseline],f=this.textOffsetY_*c,m=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Se.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,c,f,s,y*c,m,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Se.DRAW_CHARS,e,t,h,r.overflow,l&&ei,r.maxAngle,c,f,s,y*c,m,o,1/c,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Yr(o.getColor()||ei)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const C=l.getLineDash(),T=l.getLineDashOffset(),b=l.getWidth(),P=l.getMiterLimit();s.lineCap=l.getLineCap()||cc,s.lineDash=C?C.slice():Bs,s.lineDashOffset=T===void 0?Gs:T,s.lineJoin=l.getLineJoin()||hc,s.lineWidth=b===void 0?Id:b,s.miterLimit=P===void 0?Ed:P,s.strokeStyle=Yr(l.getColor()||xd)}i=this.textState_;const c=e.getFont()||Ab;N4(c);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=c,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Np,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Qa,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),m=e.getOffsetY(),y=e.getRotateWithView(),E=e.getKeepUpright(),x=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=m===void 0?0:m,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=E===void 0?!0:E,this.textRotation_=x===void 0?0:x,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:nt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+nt(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const _j={Circle:FS,Default:tf,Image:fj,LineString:gj,Polygon:FS,Text:yj};class vj{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=_j[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function wj(n,e,t,i,r,s,o,l,c,h,f,m,y=!0){let E=n[e],x=n[e+1],C=0,T=0,b=0,P=0;function k(){C=E,T=x,e+=i,E=n[e],x=n[e+1],P+=b,b=Math.sqrt((E-C)*(E-C)+(x-T)*(x-T))}do k();while(e<t-i&&P+b<s);let O=b===0?0:(s-P)/b;const F=vi(C,E,O),W=vi(T,x,O),D=e-i,R=P,M=s+l*c(h,r,f);for(;e<t-i&&P+b<M;)k();O=b===0?0:(M-P)/b;const V=vi(C,E,O),j=vi(T,x,O);let z=!1;if(y)if(m){const ce=[F,W,V,j];db(ce,0,4,2,m,ce,ce),z=ce[0]>ce[2]}else z=F>V;const L=Math.PI,ae=[],pe=D+i===e;e=D,b=0,P=R,E=n[e],x=n[e+1];let fe;if(pe){k(),fe=Math.atan2(x-T,E-C),z&&(fe+=fe>0?-L:L);const ce=(V+F)/2,J=(j+W)/2;return ae[0]=[ce,J,(M-s)/2,fe,r],ae}r=r.replace(/\n/g," ");for(let ce=0,J=r.length;ce<J;){k();let oe=Math.atan2(x-T,E-C);if(z&&(oe+=oe>0?-L:L),fe!==void 0){let Ie=oe-fe;if(Ie+=Ie>L?-2*L:Ie<-L?2*L:0,Math.abs(Ie)>o)return null}fe=oe;const ne=ce;let G=0;for(;ce<J;++ce){const Ie=z?J-ce-1:ce,be=l*c(h,r[Ie],f);if(e+i<t&&P+b<s+G+be/2)break;G+=be}if(ce===ne)continue;const $=z?r.substring(J-ne,J-ce):r.substring(ne,ce);O=b===0?0:(s+G/2-P)/b;const xe=vi(C,E,O),Te=vi(T,x,O);ae.push([xe,Te,G/2,oe,$]),s+=G}return ae}class zb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Dp(),{get:(e,t)=>{if(typeof Dp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const vu=Zi(),Io=[],bs=[],ks=[],So=[];function jS(n){return n[3].declutterBox}const US=new RegExp("[-----]");function g0(n,e){return e==="start"?e=US.test(n)?"right":"left":e==="end"&&(e=US.test(n)?"left":"right"),Lp[e]}function Ej(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function xj(n,e,t){return t%2===0&&(n+=e),n}class Tj{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=wr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new zb:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,c=this.textStates[t],h=this.pixelRatio,f=[c.scale[0]*h,c.scale[1]*h],m=c.justify?Lp[c.justify]:g0(Array.isArray(e)?e[0]:e,c.textAlign||Td),y=r&&o.lineWidth?o.lineWidth:0,E=Array.isArray(e)?e:String(e).split(`
`).reduce(Ej,[]),{width:x,height:C,widths:T,heights:b,lineWidths:P}=O4(c,E),k=x+y,O=[],F=(k+2)*f[0],W=(C+y)*f[1],D={width:F<0?Math.floor(F):Math.ceil(F),height:W<0?Math.floor(W):Math.ceil(W),contextInstructions:O};(f[0]!=1||f[1]!=1)&&O.push("scale",f),r&&(O.push("strokeStyle",o.strokeStyle),O.push("lineWidth",y),O.push("lineCap",o.lineCap),O.push("lineJoin",o.lineJoin),O.push("miterLimit",o.miterLimit),O.push("setLineDash",[o.lineDash]),O.push("lineDashOffset",o.lineDashOffset)),i&&O.push("fillStyle",l.fillStyle),O.push("textBaseline","middle"),O.push("textAlign","center");const R=.5-m;let M=m*k+R*y;const V=[],j=[];let z=0,L=0,ae=0,pe=0,fe;for(let ce=0,J=E.length;ce<J;ce+=2){const oe=E[ce];if(oe===`
`){L+=z,z=0,M=m*k+R*y,++pe;continue}const ne=E[ce+1]||c.font;ne!==fe&&(r&&V.push("font",ne),i&&j.push("font",ne),fe=ne),z=Math.max(z,b[ae]);const G=[oe,M+R*T[ae]+m*(T[ae]-P[pe]),.5*(y+z)+L];M+=T[ae],r&&V.push("strokeText",G),i&&j.push("fillText",G),++ae}return Array.prototype.push.apply(O,V),Array.prototype.push.apply(O,j),this.labels_[s]=D,D}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,c,h,f,m,y,E,x,C,T){l*=y[0],c*=y[1];let b=i-l,P=r-c;const k=s+h>e?e-h:s,O=o+f>t?t-f:o,F=x[3]+k*y[0]+x[1],W=x[0]+O*y[1]+x[2],D=b-x[3],R=P-x[0];(C||m!==0)&&(Io[0]=D,So[0]=D,Io[1]=R,bs[1]=R,bs[0]=D+F,ks[0]=bs[0],ks[1]=R+W,So[1]=ks[1]);let M;return m!==0?(M=$s(wr(),i,r,1,1,m,-i,-r),un(M,Io),un(M,bs),un(M,ks),un(M,So),Jo(Math.min(Io[0],bs[0],ks[0],So[0]),Math.min(Io[1],bs[1],ks[1],So[1]),Math.max(Io[0],bs[0],ks[0],So[0]),Math.max(Io[1],bs[1],ks[1],So[1]),vu)):Jo(Math.min(D,D+F),Math.min(R,R+W),Math.max(D,D+F),Math.max(R,R+W),vu),E&&(b=Math.round(b),P=Math.round(P)),{drawImageX:b,drawImageY:P,drawImageW:k,drawImageH:O,originX:h,originY:f,declutterBox:{minX:vu[0],minY:vu[1],maxX:vu[2],maxY:vu[3],value:T},canvasTransform:M,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const c=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(c&&this.replayTextBackground_(e,Io,bs,ks,So,o,l),V4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],c=this.pixelRatio,h=g0(Array.isArray(e)?e[0]:e,s.textAlign||Td),f=Lp[s.textBaseline||Np],m=l&&l.lineWidth?l.lineWidth:0,y=o.width/c-2*s.scale[0],E=h*y+2*(.5-h)*m,x=f*o.height/c+2*(.5-f)*m;return{label:o,anchorX:E,anchorY:x}}execute_(e,t,i,r,s,o,l,c){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&oa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=$o(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),q3(this.renderedTransform_,i));let m=0;const y=r.length;let E=0,x,C,T,b,P,k,O,F,W,D,R,M,V,j=0,z=0;const L=this.coordinateCache_,ae=this.viewRotation_,pe=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,fe={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ae},ce=this.instructions!=r||this.overlaps?0:200;let J,oe,ne,G;for(;m<y;){const $=r[m];switch($[0]){case Se.BEGIN_GEOMETRY:J=$[1],G=$[3],J.getGeometry()?l!==void 0&&!ni(l,G.getExtent())?m=$[2]+1:++m:m=$[2],h&&(h.zIndex=$[4]);break;case Se.BEGIN_PATH:j>ce&&(this.fill_(e),j=0),z>ce&&(e.stroke(),z=0),!j&&!z&&(e.beginPath(),P=NaN,k=NaN),++m;break;case Se.CIRCLE:E=$[1];const Te=f[E],Ie=f[E+1],be=f[E+2],Me=f[E+3],Ve=be-Te,Be=Me-Ie,lt=Math.sqrt(Ve*Ve+Be*Be);e.moveTo(Te+lt,Ie),e.arc(Te,Ie,lt,0,2*Math.PI,!0),++m;break;case Se.CLOSE_PATH:e.closePath(),++m;break;case Se.CUSTOM:E=$[1],x=$[2];const Qi=$[3],ds=$[4],Gn=$[5];fe.geometry=Qi,fe.feature=J,m in L||(L[m]=[]);const Wn=L[m];Gn?Gn(f,E,x,2,Wn):(Wn[0]=f[E],Wn[1]=f[E+1],Wn.length=2),h&&(h.zIndex=$[6]),ds(Wn,fe),++m;break;case Se.DRAW_IMAGE:E=$[1],x=$[2],W=$[3],C=$[4],T=$[5];let cn=$[6];const hn=$[7],Kn=$[8],Ri=$[9],yt=$[10];let ut=$[11];const tn=$[12];let Ai=$[13];b=$[14]||"declutter";const It=$[15];if(!W&&$.length>=20){D=$[19],R=$[20],M=$[21],V=$[22];const Ot=this.drawLabelWithPointPlacement_(D,R,M,V);W=Ot.label,$[3]=W;const ki=$[23];C=(Ot.anchorX-ki)*this.pixelRatio,$[4]=C;const dn=$[24];T=(Ot.anchorY-dn)*this.pixelRatio,$[5]=T,cn=W.height,$[6]=cn,Ai=W.width,$[13]=Ai}let Js;$.length>25&&(Js=$[25]);let Pi,Sr,Ji;$.length>17?(Pi=$[16],Sr=$[17],Ji=$[18]):(Pi=Qa,Sr=null,Ji=null),yt&&pe?ut+=ae:!yt&&!pe&&(ut-=ae);let Cr=0;for(;E<x;E+=2){if(Js&&Js[Cr++]<Ai/this.pixelRatio)continue;const Ot=this.calculateImageOrLabelDimensions_(W.width,W.height,f[E],f[E+1],Ai,cn,C,T,Kn,Ri,ut,tn,s,Pi,!!Sr||!!Ji,J),ki=[e,t,W,Ot,hn,Sr,Ji];if(c){let dn,Vt,fn;if(It){const rt=x-E;if(!It[rt]){It[rt]={args:ki,declutterMode:b};continue}const Bt=It[rt];dn=Bt.args,Vt=Bt.declutterMode,delete It[rt],fn=jS(dn)}let gn,nn;if(dn&&(Vt!=="declutter"||!c.collides(fn))&&(gn=!0),(b!=="declutter"||!c.collides(Ot.declutterBox))&&(nn=!0),Vt==="declutter"&&b==="declutter"){const rt=gn&&nn;gn=rt,nn=rt}gn&&(Vt!=="none"&&c.insert(fn),this.replayImageOrLabel_.apply(this,dn)),nn&&(b!=="none"&&c.insert(Ot.declutterBox),this.replayImageOrLabel_.apply(this,ki))}else this.replayImageOrLabel_.apply(this,ki)}++m;break;case Se.DRAW_CHARS:const la=$[1],Rr=$[2],bi=$[3],Ll=$[4];V=$[5];const Ar=$[6],fs=$[7],eo=$[8];M=$[9];const Ln=$[10];D=$[11],Array.isArray(D)&&(D=D.reduce(xj,"")),R=$[12];const gs=[$[13],$[13]];b=$[14]||"declutter";const Pr=$[15],br=this.textStates[R],On=br.font,Vn=[br.scale[0]*fs,br.scale[1]*fs];let ft;On in this.widths_?ft=this.widths_[On]:(ft={},this.widths_[On]=ft);const to=u4(f,la,Rr,2),er=Math.abs(Vn[0])*CS(On,D,ft);if(Ll||er<=to){const Ot=this.textStates[R].textAlign,ki=(to-er)*g0(D,Ot),dn=wj(f,la,Rr,2,D,ki,Ar,Math.abs(Vn[0]),CS,On,ft,pe?0:this.viewRotation_,Pr);e:if(dn){const Vt=[];let fn,gn,nn,rt,Bt;if(M)for(fn=0,gn=dn.length;fn<gn;++fn){Bt=dn[fn],nn=Bt[4],rt=this.createLabel(nn,R,"",M),C=Bt[2]+(Vn[0]<0?-Ln:Ln),T=bi*rt.height+(.5-bi)*2*Ln*Vn[1]/Vn[0]-eo;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,C,T,0,0,Bt[3],gs,!1,Qa,!1,J);if(c&&b==="declutter"&&c.collides(Xt.declutterBox))break e;Vt.push([e,t,rt,Xt,1,null,null])}if(V)for(fn=0,gn=dn.length;fn<gn;++fn){Bt=dn[fn],nn=Bt[4],rt=this.createLabel(nn,R,V,""),C=Bt[2],T=bi*rt.height-eo;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,C,T,0,0,Bt[3],gs,!1,Qa,!1,J);if(c&&b==="declutter"&&c.collides(Xt.declutterBox))break e;Vt.push([e,t,rt,Xt,1,null,null])}c&&b!=="none"&&c.load(Vt.map(jS));for(let Xt=0,Di=Vt.length;Xt<Di;++Xt)this.replayImageOrLabel_.apply(this,Vt[Xt])}}++m;break;case Se.END_GEOMETRY:if(o!==void 0){J=$[1];const Ot=o(J,G,b);if(Ot)return Ot}++m;break;case Se.FILL:ce?j++:this.fill_(e),++m;break;case Se.MOVE_TO_LINE_TO:for(E=$[1],x=$[2],oe=f[E],ne=f[E+1],e.moveTo(oe,ne),P=oe+.5|0,k=ne+.5|0,E+=2;E<x;E+=2)oe=f[E],ne=f[E+1],O=oe+.5|0,F=ne+.5|0,(E==x-2||O!==P||F!==k)&&(e.lineTo(oe,ne),P=O,k=F);++m;break;case Se.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],j&&(this.fill_(e),j=0,z&&(e.stroke(),z=0)),e.fillStyle=$[1],++m;break;case Se.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,$),++m;break;case Se.STROKE:ce?z++:e.stroke(),++m;break;default:++m;break}}j&&this.fill_(e),z&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Wa=["Polygon","Circle","LineString","Image","Text","Default"],Bb=["Image","Text"],Ij=Wa.filter(n=>!Bb.includes(n));class Sj{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=wr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new Tj(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,c=$s(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Qt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let m;this.renderBuffer_!==void 0&&(m=Zi(),Jh(m,e),Yw(m,t*(this.renderBuffer_+r),m));const y=Cj(r);let E;function x(F,W,D){const R=f.getImageData(0,0,l,l).data;for(let M=0,V=y.length;M<V;M++)if(R[y[M]]>0){if(!o||D==="none"||E!=="Image"&&E!=="Text"||o.includes(F)){const j=(y[M]-3)/4,z=r-j%l,L=r-(j/l|0),ae=s(F,W,z*z+L*L);if(ae)return ae}f.clearRect(0,0,l,l);break}}const C=Object.keys(this.executorsByZIndex_).map(Number);C.sort(zs);let T,b,P,k,O;for(T=C.length-1;T>=0;--T){const F=C[T].toString();for(P=this.executorsByZIndex_[F],b=Wa.length-1;b>=0;--b)if(E=Wa[b],k=P[E],k!==void 0&&(O=k.executeHitDetection(f,c,i,x,m),O))return O}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return $o(l,0,8,2,e,l),l}isEmpty(){return rc(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const c=Object.keys(this.executorsByZIndex_).map(Number);c.sort(l?i3:zs),o=o||Wa;const h=Wa.length;for(let f=0,m=c.length;f<m;++f){const y=c[f].toString(),E=this.executorsByZIndex_[y];for(let x=0,C=o.length;x<C;++x){const T=o[x],b=E[T];if(b!==void 0){const P=l===null?void 0:b.getZIndexContext(),k=P?P.getContext():e,O=this.maxExtent_&&T!=="Image"&&T!=="Text";if(O&&(k.save(),this.clip(k,i)),!P||T==="Text"||T==="Image"?b.execute(k,t,i,r,s,l):P.pushFunction(F=>b.execute(F,t,i,r,s,l)),O&&k.restore(),P){P.offset();const F=c[f]*h+Wa.indexOf(T);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(P)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(zs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const p0={};function Cj(n){if(p0[n]!==void 0)return p0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let c=i[l];c||(c=[],i[l]=c),c.push(((n+s)*e+(n+o))*4+3),s>0&&c.push(((n-s)*e+(n+o))*4+3),o>0&&(c.push(((n+s)*e+(n-o))*4+3),s>0&&c.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return p0[n]=r,r}function zS(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let yE=class Gb extends Nm{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;at(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||nt(o)),at(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),at(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(e.src!==void 0?c=Ue.IDLE:o!==void 0&&("complete"in o?o.complete?c=o.src?Ue.LOADED:Ue.IDLE:c=Ue.LOADING:c=Ue.LOADED),this.color_=e.color!==void 0?uc(e.color):null,this.iconImage_=Mp(o,l,this.crossOrigin_,c,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const m=this.getImage(1);if(m.width&&m.height)h=m.width,f=m.height;else if(m instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const E=this.iconImage_.getSize();this.setScale(zS(E[0],E[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(zS(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Gb({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Mp(null,e,this.crossOrigin_,Ue.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(ze.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(ze.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Xr=.5;function Rj(n,e,t,i,r,s,o,l,c){const h=r,f=n[0]*Xr,m=n[1]*Xr,y=Qt(f,m);y.imageSmoothingEnabled=!1;const E=y.canvas,x=new j4(y,Xr,r,null,o,l,null),C=t.length,T=Math.floor((256*256*256-1)/C),b={};for(let k=1;k<=C;++k){const O=t[k-1],F=O.getStyleFunction()||i;if(!F)continue;let W=F(O,s);if(!W)continue;Array.isArray(W)||(W=[W]);const R=(k*T).toString(16).padStart(7,"#00000");for(let M=0,V=W.length;M<V;++M){const j=W[M],z=j.getGeometryFunction()(O);if(!z||!ni(h,z.getExtent()))continue;const L=j.clone(),ae=L.getFill();ae&&ae.setColor(R);const pe=L.getStroke();pe&&(pe.setColor(R),pe.setLineDash(null)),L.setText(void 0);const fe=j.getImage();if(fe){const ne=fe.getImageSize();if(!ne)continue;const G=Qt(ne[0],ne[1],void 0,{alpha:!1}),$=G.canvas;G.fillStyle=R,G.fillRect(0,0,$.width,$.height),L.setImage(new yE({img:$,anchor:fe.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:fe.getOrigin(),opacity:1,size:fe.getSize(),scale:fe.getScale(),rotation:fe.getRotation(),rotateWithView:fe.getRotateWithView()}))}const ce=L.getZIndex()||0;let J=b[ce];J||(J={},b[ce]=J,J.Polygon=[],J.Circle=[],J.LineString=[],J.Point=[]);const oe=z.getType();if(oe==="GeometryCollection"){const ne=z.getGeometriesArrayRecursive();for(let G=0,$=ne.length;G<$;++G){const xe=ne[G];J[xe.getType().replace("Multi","")].push(xe,L)}}else J[oe.replace("Multi","")].push(z,L)}}const P=Object.keys(b).map(Number).sort(zs);for(let k=0,O=P.length;k<O;++k){const F=b[P[k]];for(const W in F){const D=F[W];for(let R=0,M=D.length;R<M;R+=2){x.setStyle(D[R+1]);for(let V=0,j=e.length;V<j;++V)x.setTransform(e[V]),x.drawGeometry(D[R])}}}return y.getImageData(0,0,E.width,E.height)}function Aj(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Xr),s=Math.floor(Math.round(n[1])*Xr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],c=t.data[o+1],f=t.data[o+2]+256*(c+256*l),m=Math.floor((256*256*256-1)/e.length);f&&f%m===0&&i.push(e[f/m-1])}return i}class Wb extends Ys{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const Pj=5;class bj extends Yd{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=Pj}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return et()}getData(e){return null}prepareFrame(e){return et()}renderFrame(e,t){return et()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ue.LOADED||t.getState()===Ue.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ue.LOADED&&t!=Ue.ERROR&&e.addEventListener(ze.CHANGE,this.boundHandleImageChange_),t==Ue.IDLE&&(e.load(),t=e.getState()),t==Ue.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const BS=[];let Du=null;function kj(){Du=Qt(1,1,void 0,{willReadFrequently:!0})}class Kb extends bj{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=wr(),this.pixelTransform=wr(),this.inversePixelTransform=wr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Du||kj(),Du.clearRect(0,0,1,1);let r;try{Du.drawImage(e,t,i,1,1,0,0,1,1),r=Du.getImageData(0,0,1,1).data}catch{return Du=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&oa(uc(e.style.backgroundColor),uc(i)))){const l=e.firstElementChild;Bo(l)&&(o=l.getContext("2d"))}if(o&&J3(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ei?Ib():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Qt();const c=o.canvas;s.appendChild(c),l=c.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Al(i),s=Am(i),o=Rm(i),l=Cm(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const c=this.inversePixelTransform;un(c,r),un(c,s),un(c,o),un(c,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(dt(i)/r*o),c=Math.round(zn(i)/r*o);$s(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-c/2),hb(this.inversePixelTransform,this.pixelTransform);const h=Q3(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=c?(f.width=l,f.height=c):this.context.clearRect(0,0,l,c),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new Wb(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Hi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Hi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new zb),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Hi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Hi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const c=s/2,h=o/2,f=r/t,m=-f,y=-e[0]+l,E=-e[1];return $s(this.tempTransform,c,h,f,m,-i,y,E)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class Dj extends Kb{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Zi(),this.wrappedRenderedExtent_=Zi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,c=s.projection,h=s.rotation,f=c.getExtent(),m=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),E=t.pixelRatio,x=t.viewHints,C=!(x[Mn.ANIMATING]||x[Mn.INTERACTING]),T=this.context,b=Math.round(dt(r)/l*E),P=Math.round(zn(r)/l*E),k=m.getWrapX()&&c.canWrapX(),O=k?dt(f):null,F=k?Math.ceil((r[2]-f[2])/O)+1:1;let W=k?Math.floor((r[0]-f[0])/O):0;do{let D=this.getRenderTransform(o,l,0,E,b,P,W*O);t.declutter&&(D=D.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],D,h,C,i===void 0?Wa:i?Bb:Ij,i?y&&t.declutter[y]:void 0)}while(++W<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Qt(this.context.canvas.width,this.context.canvas.height,BS))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Mm(this.context),BS.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Hi.PRERENDER)||this.getLayer().hasListener(Hi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const c=zo(i.extent);l=ni(c,e.extent),this.clipped_=l&&!Uh(c,e.extent),this.clipped_&&this.clipUnrotated(s,e,c)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,c=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],m=i[0]*Xr,y=i[1]*Xr;f.push(this.getRenderTransform(r,s,o,Xr,m,y,0).slice());const E=h.getSource(),x=l.getExtent();if(E.getWrapX()&&l.canWrapX()&&!Uh(x,c)){let C=c[0];const T=dt(x);let b=0,P;for(;C<x[0];)--b,P=T*b,f.push(this.getRenderTransform(r,s,o,Xr,m,y,P).slice()),C+=T;for(b=0,C=c[2];C>x[2];)++b,P=T*b,f.push(this.getRenderTransform(r,s,o,Xr,m,y,P).slice()),C-=T}this.hitDetectionImageData_=Rj(i,f,this.renderedFeatures_,h.getStyleFunction(),c,s,o,RS(s,this.renderedPixelRatio_))}t(Aj(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,c=this.getLayer(),h={},f=function(y,E,x){const C=nt(y),T=h[C];if(T){if(T!==!0&&x<T.distanceSq){if(x===0)return h[C]=!0,s.splice(s.lastIndexOf(T),1),r(y,c,E);T.geometry=E,T.distanceSq=x}}else{if(x===0)return h[C]=!0,r(y,c,E);s.push(h[C]={feature:y,layer:c,geometry:E,distanceSq:x,callback:r})}},m=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,m?t.declutter?.[m]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Mn.ANIMATING],s=e.viewHints[Mn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const c=e.extent,h=e.viewState,f=h.projection,m=h.resolution,y=e.pixelRatio,E=t.getRevision(),x=t.getRenderBuffer();let C=t.getRenderOrder();C===void 0&&(C=z4);const T=h.center.slice(),b=Yw(c,x*m),P=b.slice(),k=[b.slice()],O=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Uh(O,e.extent)){const ae=dt(O),pe=Math.max(dt(b)/2,ae);b[0]=O[0]-pe,b[2]=O[2]+pe,nb(T,f);const fe=eb(k[0],f);fe[0]<O[0]&&fe[2]<O[2]?k.push([fe[0]+ae,fe[1],fe[2]+ae,fe[3]]):fe[0]>O[0]&&fe[2]>O[2]&&k.push([fe[0]-ae,fe[1],fe[2]-ae,fe[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==E&&this.renderedRenderOrder_==C&&this.renderedFrameDeclutter_===!!e.declutter&&Uh(this.wrappedRenderedExtent_,b))return oa(this.renderedExtent_,P)||(this.hitDetectionImageData_=null,this.renderedExtent_=P),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new vj(Db(m,y),b,m,y);let W;for(let ae=0,pe=k.length;ae<pe;++ae)i.loadFeatures(k[ae],m,f);const D=RS(m,y);let R=!0;const M=(ae,pe)=>{let fe;const ce=ae.getStyleFunction()||t.getStyleFunction();if(ce&&(fe=ce(ae,m)),fe){const J=this.renderFeature(ae,D,fe,F,W,this.getLayer().getDeclutter(),pe);R=R&&!J}},V=cb(b),j=i.getFeaturesInExtent(V);C&&j.sort(C);for(let ae=0,pe=j.length;ae<pe;++ae)M(j[ae],ae);this.renderedFeatures_=j,this.ready=R;const z=F.finish(),L=new Sj(b,m,y,i.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=m,this.renderedRevision_=E,this.renderedRenderOrder_=C,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=P,this.wrappedRenderedExtent_=b,this.renderedCenter_=T,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=L,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let c=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)c=AS(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||c;else c=AS(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return c}}let bl=0;const Un=1<<bl++,He=1<<bl++,ti=1<<bl++,fr=1<<bl++,ml=1<<bl++,Gh=1<<bl++,Fg=Math.pow(2,bl)-1,_E={[Un]:"boolean",[He]:"number",[ti]:"string",[fr]:"color",[ml]:"number[]",[Gh]:"size"},Mj=Object.keys(_E).map(Number).sort(zs);function Nj(n){return n in _E}function Wh(n){const e=[];for(const t of Mj)Kh(n,t)&&e.push(_E[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kh(n,e){return(n&e)===e}function Co(n,e){return n===e}class Zt{constructor(e,t){if(!Nj(e))throw new Error(`literal expressions must have a specific type, got ${Wh(e)}`);this.type=e,this.value=t}}class Lj{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function $b(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function In(n,e,t){switch(typeof n){case"boolean":{if(Co(e,ti))return new Zt(ti,n?"true":"false");if(!Kh(e,Un))throw new Error(`got a boolean, but expected ${Wh(e)}`);return new Zt(Un,n)}case"number":{if(Co(e,Gh))return new Zt(Gh,ri(n));if(Co(e,Un))return new Zt(Un,!!n);if(Co(e,ti))return new Zt(ti,n.toString());if(!Kh(e,He))throw new Error(`got a number, but expected ${Wh(e)}`);return new Zt(He,n)}case"string":{if(Co(e,fr))return new Zt(fr,hE(n));if(Co(e,Un))return new Zt(Un,!!n);if(!Kh(e,ti))throw new Error(`got a string, but expected ${Wh(e)}`);return new Zt(ti,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return $j(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Co(e,Gh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Zt(Gh,n)}if(Co(e,fr)){if(n.length===3)return new Zt(fr,[...n,1]);if(n.length===4)return new Zt(fr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kh(e,ml))throw new Error(`got an array of numbers, but expected ${Wh(e)}`);return new Zt(ml,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},Oj={[te.Get]:Le(je(1,1/0),GS),[te.Var]:Le(je(1,1),Vj),[te.Has]:Le(je(1,1/0),GS),[te.Id]:Le(Fj,wu),[te.Concat]:Le(je(2,1/0),ot(ti)),[te.GeometryType]:Le(jj,wu),[te.LineMetric]:Le(wu),[te.Resolution]:Le(m0,wu),[te.Zoom]:Le(m0,wu),[te.Time]:Le(m0,wu),[te.Any]:Le(je(2,1/0),ot(Un)),[te.All]:Le(je(2,1/0),ot(Un)),[te.Not]:Le(je(1,1),ot(Un)),[te.Equal]:Le(je(2,2),ot(Fg)),[te.NotEqual]:Le(je(2,2),ot(Fg)),[te.GreaterThan]:Le(je(2,2),ot(He)),[te.GreaterThanOrEqualTo]:Le(je(2,2),ot(He)),[te.LessThan]:Le(je(2,2),ot(He)),[te.LessThanOrEqualTo]:Le(je(2,2),ot(He)),[te.Multiply]:Le(je(2,1/0),WS),[te.Coalesce]:Le(je(2,1/0),WS),[te.Divide]:Le(je(2,2),ot(He)),[te.Add]:Le(je(2,1/0),ot(He)),[te.Subtract]:Le(je(2,2),ot(He)),[te.Clamp]:Le(je(3,3),ot(He)),[te.Mod]:Le(je(2,2),ot(He)),[te.Pow]:Le(je(2,2),ot(He)),[te.Abs]:Le(je(1,1),ot(He)),[te.Floor]:Le(je(1,1),ot(He)),[te.Ceil]:Le(je(1,1),ot(He)),[te.Round]:Le(je(1,1),ot(He)),[te.Sin]:Le(je(1,1),ot(He)),[te.Cos]:Le(je(1,1),ot(He)),[te.Atan]:Le(je(1,2),ot(He)),[te.Sqrt]:Le(je(1,1),ot(He)),[te.Match]:Le(je(4,1/0),KS,zj),[te.Between]:Le(je(3,3),ot(He)),[te.Interpolate]:Le(je(6,1/0),KS,Bj),[te.Case]:Le(je(3,1/0),Uj,Gj),[te.In]:Le(je(2,2),Wj),[te.Number]:Le(je(1,1/0),ot(Fg)),[te.String]:Le(je(1,1/0),ot(Fg)),[te.Array]:Le(je(1,1/0),ot(He)),[te.Color]:Le(je(1,4),ot(He)),[te.Band]:Le(je(1,3),ot(He)),[te.Palette]:Le(je(2,2),Kj),[te.ToString]:Le(je(1,1),ot(Un|He|ti|fr))};function GS(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Zt(He,o);break}case"string":{r[s]=new Zt(ti,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function Vj(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Zt(ti,i)]}function Fj(n,e,t){t.featureId=!0}function jj(n,e,t){t.geometryType=!0}function m0(n,e,t){t.mapState=!0}function wu(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function je(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function WS(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=In(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=In(e[o+1],n,i);s[o]=l}return s}}function Uj(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function KS(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function zj(n,e,t){const i=n.length-1,r=ti|He|Un,s=In(n[1],r,t),o=In(n[n.length-1],e,t),l=new Array(i-2);for(let c=0;c<i-2;c+=2){try{const h=In(n[c+2],s.type,t);l[c]=h}catch(h){throw new Error(`failed to parse argument ${c+1} of match expression: ${h.message}`)}try{const h=In(n[c+3],o.type,t);l[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+2} of match expression: ${h.message}`)}}return[s,...l,o]}function Bj(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const c=i[1];if(typeof c!="number"||c<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(c)} instead`);r=c;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Zt(He,r);let o;try{o=In(n[2],He,t)}catch(c){throw new Error(`failed to parse argument 1 in interpolate expression: ${c.message}`)}const l=new Array(n.length-3);for(let c=0;c<l.length;c+=2){try{const h=In(n[c+3],He,t);l[c]=h}catch(h){throw new Error(`failed to parse argument ${c+2} for interpolate expression: ${h.message}`)}try{const h=In(n[c+4],e,t);l[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function Gj(n,e,t){const i=In(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=In(n[s+1],Un,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=In(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function Wj(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ti}else r=He;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const c=In(i[l],r,t);s[l]=c}catch(c){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${c.message}`)}return[In(n[1],r,t),...s]}function Kj(n,e,t){let i;try{i=In(n[1],He,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=In(r[o],fr,t)}catch(c){throw new Error(`failed to parse color at index ${o} in palette expression: ${c.message}`)}if(!(l instanceof Zt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Le(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new Lj(t,r,...s)}}function $j(n,e,t){const i=n[0],r=Oj[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function Hb(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Hb(n.getGeometries()[0]);default:return""}}function Xb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Zs(n,e,t){const i=In(n,e,t);return Ir(i)}function Ir(n,e){if(n instanceof Zt){if(n.type===fr&&typeof n.value=="string"){const i=hE(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return Hj(n);case te.Get:case te.Var:case te.Has:return Xj(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Ir(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return Yj(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return qj(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return Zj(n);case te.Case:return Qj(n);case te.Match:return Jj(n);case te.Interpolate:return e5(n);case te.ToString:return t5(n);default:throw new Error(`Unsupported operator ${t}`)}}function Hj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function Xj(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,c=s.length;l<c;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,c=s.length;l<c;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function qj(n,e){const t=n.operator,i=Ir(n.args[0]),r=Ir(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function Yj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),c=r[2](s);return o>=l&&o<=c};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function Zj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const c=r[2](s);return o>c?c:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function Qj(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function Jj(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function e5(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,c;for(let h=2;h<t;h+=2){const f=i[h](r);let m=i[h+1](r);const y=Array.isArray(m);if(y&&(m=I4(m)),f>=o)return h===2?m:y?n5(s,o,l,c,f,m):$h(s,o,l,c,f,m);l=f,c=m}return c}}function t5(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===fr?dE(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function $h(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,c=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+c*(s-i)}function n5(n,e,t,i,r,s){if(r-t===0)return i;const l=xS(i),c=xS(s);let h=c[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[$h(n,e,t,l[0],r,c[0]),$h(n,e,t,l[1],r,c[1]),l[2]+$h(n,e,t,0,r,h),$h(n,e,t,i[3],r,s[3])];return S4(f)}function i5(n){return!0}function r5(n){const e=$b(),t=s5(n,e),i=Xb();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Hb(r.getGeometry())),t(i)}}function $S(n){const e=$b(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Sv(n[o],e);const r=Xb(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let c=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[c]=f,c+=1)}return s.length=c,s}}function s5(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Zs(s.filter,Un,e):i5;let l;if(Array.isArray(s.style)){const c=s.style.length;l=new Array(c);for(let h=0;h<c;++h)l[h]=Sv(s.style[h],e)}else l=[Sv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const c=i[l].filter;if(c(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Sv(n,e){const t=Rd(n,"",e),i=Ad(n,"",e),r=o5(n,e),s=a5(n,e),o=ii(n,"z-index",e);if(!t&&!i&&!r&&!s&&!rc(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Yi;return function(c){let h=!0;if(t){const f=t(c);f&&(h=!1),l.setFill(f)}if(i){const f=i(c);f&&(h=!1),l.setStroke(f)}if(r){const f=r(c);f&&(h=!1),l.setText(f)}if(s){const f=s(c);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(c)),h?null:l}}function Rd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=h5(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=vE(n,e+"fill-color",t)}if(!i)return null;const r=new Tr;return function(s){const o=i(s);return o===cE?null:(r.setColor(o),r)}}function Ad(n,e,t){const i=ii(n,e+"stroke-width",t),r=vE(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ms(n,e+"stroke-line-cap",t),o=Ms(n,e+"stroke-line-join",t),l=qb(n,e+"stroke-line-dash",t),c=ii(n,e+"stroke-line-dash-offset",t),h=ii(n,e+"stroke-miter-limit",t),f=new Pc;return function(m){if(r){const y=r(m);if(y===cE)return null;f.setColor(y)}if(i&&f.setWidth(i(m)),s){const y=s(m);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(m);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(m)),c&&f.setLineDashOffset(c(m)),h&&f.setMiterLimit(h(m)),f}}function o5(n,e){const t="text-",i=Ms(n,t+"value",e);if(!i)return null;const r=Rd(n,t,e),s=Rd(n,t+"background-",e),o=Ad(n,t,e),l=Ad(n,t+"background-",e),c=Ms(n,t+"font",e),h=ii(n,t+"max-angle",e),f=ii(n,t+"offset-x",e),m=ii(n,t+"offset-y",e),y=Xu(n,t+"overflow",e),E=Ms(n,t+"placement",e),x=ii(n,t+"repeat",e),C=Om(n,t+"scale",e),T=Xu(n,t+"rotate-with-view",e),b=ii(n,t+"rotation",e),P=Ms(n,t+"align",e),k=Ms(n,t+"justify",e),O=Ms(n,t+"baseline",e),F=Xu(n,t+"keep-upright",e),W=qb(n,t+"padding",e),D=Vm(n,t+"declutter-mode"),R=new ef({declutterMode:D});return function(M){if(R.setText(i(M)),r&&R.setFill(r(M)),s&&R.setBackgroundFill(s(M)),o&&R.setStroke(o(M)),l&&R.setBackgroundStroke(l(M)),c&&R.setFont(c(M)),h&&R.setMaxAngle(h(M)),f&&R.setOffsetX(f(M)),m&&R.setOffsetY(m(M)),y&&R.setOverflow(y(M)),E){const V=E(M);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(V)}if(x&&R.setRepeat(x(M)),C&&R.setScale(C(M)),T&&R.setRotateWithView(T(M)),b&&R.setRotation(b(M)),P){const V=P(M);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(V)}if(k){const V=k(M);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(V)}if(O){const V=O(M);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(V)}return W&&R.setPadding(W(M)),F&&R.setKeepUpright(F(M)),R}}function a5(n,e){return"icon-src"in n?l5(n,e):"shape-points"in n?u5(n,e):"circle-radius"in n?c5(n,e):null}function l5(n,e){const t="icon-",i=t+"src",r=Yb(n[i],i),s=Op(n,t+"anchor",e),o=Om(n,t+"scale",e),l=ii(n,t+"opacity",e),c=Op(n,t+"displacement",e),h=ii(n,t+"rotation",e),f=Xu(n,t+"rotate-with-view",e),m=XS(n,t+"anchor-origin"),y=qS(n,t+"anchor-x-units"),E=qS(n,t+"anchor-y-units"),x=p5(n,t+"color"),C=f5(n,t+"cross-origin"),T=g5(n,t+"offset"),b=XS(n,t+"offset-origin"),P=Vp(n,t+"width"),k=Vp(n,t+"height"),O=d5(n,t+"size"),F=Vm(n,t+"declutter-mode"),W=new yE({src:r,anchorOrigin:m,anchorXUnits:y,anchorYUnits:E,color:x,crossOrigin:C,offset:T,offsetOrigin:b,height:k,width:P,size:O,declutterMode:F});return function(D){return l&&W.setOpacity(l(D)),c&&W.setDisplacement(c(D)),h&&W.setRotation(h(D)),f&&W.setRotateWithView(f(D)),o&&W.setScale(o(D)),s&&W.setAnchor(s(D)),W}}function u5(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Cv(n[i],i),o=Cv(n[r],r),l=Rd(n,t,e),c=Ad(n,t,e),h=Om(n,t+"scale",e),f=Op(n,t+"displacement",e),m=ii(n,t+"rotation",e),y=Xu(n,t+"rotate-with-view",e),E=Vp(n,t+"radius2"),x=Vp(n,t+"angle"),C=Vm(n,t+"declutter-mode"),T=new Lm({points:s,radius:o,radius2:E,angle:x,declutterMode:C});return function(b){return l&&T.setFill(l(b)),c&&T.setStroke(c(b)),f&&T.setDisplacement(f(b)),m&&T.setRotation(m(b)),y&&T.setRotateWithView(y(b)),h&&T.setScale(h(b)),T}}function c5(n,e){const t="circle-",i=Rd(n,t,e),r=Ad(n,t,e),s=ii(n,t+"radius",e),o=Om(n,t+"scale",e),l=Op(n,t+"displacement",e),c=ii(n,t+"rotation",e),h=Xu(n,t+"rotate-with-view",e),f=Vm(n,t+"declutter-mode"),m=new Pl({radius:5,declutterMode:f});return function(y){return s&&m.setRadius(s(y)),i&&m.setFill(i(y)),r&&m.setStroke(r(y)),l&&m.setDisplacement(l(y)),c&&m.setRotation(c(y)),h&&m.setRotateWithView(h(y)),o&&m.setScale(o(y)),m}}function ii(n,e,t){if(!(e in n))return;const i=Zs(n[e],He,t);return function(r){return Cv(i(r),e)}}function Ms(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ti,t);return function(r){return Yb(i(r),e)}}function h5(n,e,t){const i=Ms(n,e+"pattern-src",t),r=HS(n,e+"pattern-offset",t),s=HS(n,e+"pattern-size",t),o=vE(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Xu(n,e,t){if(!(e in n))return null;const i=Zs(n[e],Un,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function vE(n,e,t){if(!(e in n))return null;const i=Zs(n[e],fr,t);return function(r){return Zb(i(r),e)}}function qb(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ml,t);return function(r){return nf(i(r),e)}}function Op(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ml,t);return function(r){const s=nf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function HS(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ml,t);return function(r){return Qb(i(r),e)}}function Om(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ml|He,t);return function(r){return m5(i(r),e)}}function Vp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function d5(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return ri(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function f5(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function XS(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function qS(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function g5(n,e){const t=n[e];if(t!==void 0)return nf(t,e)}function Vm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function p5(n,e){const t=n[e];if(t!==void 0)return Zb(t,e)}function nf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function Yb(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Cv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function Zb(n,e){if(typeof n=="string")return n;const t=nf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function Qb(n,e){const t=nf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function m5(n,e){return typeof n=="number"?n:Qb(n,e)}const ur={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function YS(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const c=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,m=l?l[1]:0;let y=n[0]+c/2+f,E=n[2]-c/2+f,x=n[1]+h/2+m,C=n[3]-h/2+m;y>E&&(y=(E+y)/2,E=y),x>C&&(x=(C+x)/2,C=x);let T=Dt(i[0],y,E),b=Dt(i[1],x,C);if(o&&t&&r){const P=30*r;T+=-P*Math.log(1+Math.max(0,y-i[0])/P)+P*Math.log(1+Math.max(0,i[0]-E)/P),b+=-P*Math.log(1+Math.max(0,x-i[1])/P)+P*Math.log(1+Math.max(0,i[1]-C)/P)}return[T,b]})}function y5(n){return n}function Jb(n){return Math.pow(n,3)}function bc(n){return 1-Jb(1-n)}function _5(n){return 3*n*n-2*n*n*n}function v5(n){return n}function wE(n,e,t,i){const r=dt(e)/t[0],s=zn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function EE(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function w5(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const c=n[0],h=n[n.length-1],f=t?wE(c,t,o,i):c;if(l)return e?EE(r,f,h):Dt(r,h,f);const m=Math.min(f,r),y=Math.floor(Xw(n,m,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function E5(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,c,h){if(o!==void 0){const f=r?wE(e,r,c,s):e;if(h)return i?EE(o,f,t):Dt(o,t,f);const m=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-m),E=-l*(.5-m)+.5,x=Math.min(f,o),C=Math.floor(Math.log(e/x)/Math.log(n)+E),T=Math.max(y,C),b=e/Math.pow(n,T);return Dt(b,t,f)}})}function ZS(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,c){if(s!==void 0){const h=i?wE(n,i,l,r):n;return!t||!c?Dt(s,e,h):EE(s,h,e)}})}function xE(n){if(n!==void 0)return 0}function QS(n){if(n!==void 0)return n}function x5(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function T5(n){const e=Ko(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const I5=42,TE=256,y0=0;class qr extends as{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=iE(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&ub(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=zo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in ur)delete t[l];this.setProperties(t,!0);const i=C5(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=S5(e),s=i.constraint,o=R5(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&jg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,c=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],m={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||_5,callback:i};if(f.center&&(m.sourceCenter=o,m.targetCenter=f.center.slice(),o=m.targetCenter),f.zoom!==void 0?(m.sourceResolution=l,m.targetResolution=this.getResolutionForZoom(f.zoom),l=m.targetResolution):f.resolution&&(m.sourceResolution=l,m.targetResolution=f.resolution,l=m.targetResolution),f.rotation!==void 0){m.sourceRotation=c;const y=sl(f.rotation-c+Math.PI,2*Math.PI)-Math.PI;m.targetRotation=c+y,c=m.targetRotation}A5(m)?m.complete=!0:s+=m.duration,h.push(m)}this.animations_.push(h),this.setHint(Mn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Mn.ANIMATING]>0}getInteracting(){return this.hints_[Mn.INTERACTING]>0}cancelAnimations(){this.setHint(Mn.ANIMATING,-this.hints_[Mn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&jg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const c=r[o];if(c.complete)continue;const h=e-c.start;let f=c.duration>0?h/c.duration:1;f>=1?(c.complete=!0,f=1):s=!1;const m=c.easing(f);if(c.sourceCenter){const y=c.sourceCenter[0],E=c.sourceCenter[1],x=c.targetCenter[0],C=c.targetCenter[1];this.nextCenter_=c.targetCenter;const T=y+m*(x-y),b=E+m*(C-E);this.targetCenter_=[T,b]}if(c.sourceResolution&&c.targetResolution){const y=m===1?c.targetResolution:c.sourceResolution+m*(c.targetResolution-c.sourceResolution);if(c.anchor){const E=this.getViewportSize_(this.getRotation()),x=this.constraints_.resolution(y,0,E,!0);this.targetCenter_=this.calculateCenterZoom(x,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const y=m===1?sl(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+m*(c.targetRotation-c.sourceRotation);if(c.anchor){const E=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(E,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!c.complete)break}if(s){this.animations_[i]=null,this.setHint(Mn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&jg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Qw(i,e-this.getRotation()),y3(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&vv(e,this.getProjection())}getCenterInternal(){return this.get(ur.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return cb(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();at(t,"The view center is not defined");const i=this.getResolution();at(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return at(r!==void 0,"The view rotation is not defined"),gv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(ur.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(zo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=dt(e)/t[0],r=zn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(ur.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=_0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=Xw(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(at(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){at(!Pm(e),"Cannot fit empty extent provided as `geometry`");const r=zo(e,this.getProjection());i=bS(r)}else if(e.getType()==="Circle"){const r=zo(e.getExtent(),this.getProjection());i=bS(r),i.rotate(this.getRotation(),dl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,c=1/0,h=-1/0,f=-1/0;for(let m=0,y=s.length;m<y;m+=o){const E=s[m]*i-s[m+1]*r,x=s[m]*r+s[m+1]*i;l=Math.min(l,E),c=Math.min(c,x),h=Math.max(h,E),f=Math.max(f,x)}return[l,c,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let c=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);c=isNaN(c)?o:Math.max(c,o),c=this.getConstrainedResolution(c,s?0:1);const h=this.getRotation(),f=Math.sin(h),m=Math.cos(h),y=dl(l);y[0]+=(r[1]-r[3])/2*c,y[1]+=(r[0]-r[2])/2*c;const E=y[0]*m-y[1]*f,x=y[1]*m+y[0]*f,C=this.getConstrainedCenter([E,x],c),T=t.callback?t.callback:_d;t.duration!==void 0?this.animateInternal({resolution:c,center:C,duration:t.duration,easing:t.easing},T):(this.targetResolution_=c,this.targetCenter_=C,this.applyTargetState_(!1,!0),jg(T,!0))}centerOn(e,t,i){this.centerOnInternal(Ds(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(_0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),c=_0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-c[0],e[1]-c[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=vv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(ur.ROTATION)!==r&&this.set(ur.ROTATION,r),this.get(ur.RESOLUTION)!==o&&(this.set(ur.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(ur.CENTER)||!Cp(this.get(ur.CENTER),l))&&this.set(ur.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),c=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=c,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Cp(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:c,resolution:l,duration:e,easing:bc,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Mn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ds(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Mn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function jg(n,e){setTimeout(function(){n(e)},0)}function S5(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return YS(n.extent,n.constrainOnlyCenter,t)}const e=iE(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,YS(t,!1,!1)}return y5}function C5(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:y0,l=n.maxZoom!==void 0?n.maxZoom:28;const c=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,m=n.showFullExtent!==void 0?n.showFullExtent:!1,y=iE(n.projection,"EPSG:3857"),E=y.getExtent();let x=n.constrainOnlyCenter,C=n.extent;if(!h&&!C&&y.isGlobal()&&(x=!1,C=E),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[l]!==void 0?T[l]:T[T.length-1],n.constrainResolution?e=w5(T,f,!x&&C,m):e=ZS(t,i,f,!x&&C,m)}else{const b=(E?Math.max(dt(E),zn(E)):360*ac.degrees/y.getMetersPerUnit())/TE/Math.pow(2,y0),P=b/Math.pow(2,28-y0);t=n.maxResolution,t!==void 0?o=0:t=b/Math.pow(c,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(c,l):i=b/Math.pow(c,l):i=P),l=o+Math.floor(Math.log(t/i)/Math.log(c)),i=t/Math.pow(c,l-o),n.constrainResolution?e=E5(c,t,i,f,!x&&C,m):e=ZS(t,i,f,!x&&C,m)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:c}}function R5(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?T5():t===!1?QS:typeof t=="number"?x5(t):QS}return xE}function A5(n){return!(n.sourceCenter&&n.targetCenter&&!Cp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function _0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,c=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,c+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-c*o,f=c*s+l*o;return[h,f]}const ht={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class ek extends as{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ht.OPACITY]=e.opacity!==void 0?e.opacity:1,at(typeof t[ht.OPACITY]=="number","Layer opacity must be a number"),t[ht.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ht.Z_INDEX]=e.zIndex,t[ht.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ht.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ht.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ht.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return et()}getLayerStatesArray(e){return et()}getExtent(){return this.get(ht.EXTENT)}getMaxResolution(){return this.get(ht.MAX_RESOLUTION)}getMinResolution(){return this.get(ht.MIN_RESOLUTION)}getMinZoom(){return this.get(ht.MIN_ZOOM)}getMaxZoom(){return this.get(ht.MAX_ZOOM)}getOpacity(){return this.get(ht.OPACITY)}getSourceState(){return et()}getVisible(){return this.get(ht.VISIBLE)}getZIndex(){return this.get(ht.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ht.EXTENT,e)}setMaxResolution(e){this.set(ht.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ht.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ht.MAX_ZOOM,e)}setMinZoom(e){this.set(ht.MIN_ZOOM,e)}setOpacity(e){at(typeof e=="number","Layer opacity must be a number"),this.set(ht.OPACITY,e)}setVisible(e){this.set(ht.VISIBLE,e)}setZIndex(e){this.set(ht.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Fm extends ek{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ht.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ht.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=tt(e,ze.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof qr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return IE(r,t.viewState)&&(!s||ni(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof qr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ht.MAP,e)}getMapInternal(){return this.get(ht.MAP)}setMap(e){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=tt(e,Hi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=tt(this,ze.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);at(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ht.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function IE(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const JS={RENDER_ORDER:"renderOrder"};class tk extends Fm{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(JS.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new Fb(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(JS.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Ub:e;const t=P5(e);this.styleFunction_=e===null?void 0:hj(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function P5(n){if(n===void 0)return Ub;if(!n)return null;if(typeof n=="function"||n instanceof Yi)return n;if(!Array.isArray(n))return $S([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Yi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Yi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return r5(r)}return $S(n)}class SE extends tk{constructor(e){super(e)}createRenderer(){return new Dj(this)}}const Ro={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Oo extends Ys{constructor(e,t){super(e),this.layer=t}}const v0={LAYERS:"layers"};class kc extends ek{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(v0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new $i(i.slice(),{unique:!0}):at(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new $i(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(tt(e,Jn.ADD,this.handleLayersAdd_,this),tt(e,Jn.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Rt);qd(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Oo(Ro.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[tt(e,ic.PROPERTYCHANGE,this.handleLayerChange_,this),tt(e,ze.CHANGE,this.handleLayerChange_,this)];e instanceof kc&&t.push(tt(e,Ro.ADDLAYER,this.handleLayerGroupAdd_,this),tt(e,Ro.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[nt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Oo(Ro.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Oo(Ro.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Oo(Ro.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=nt(t);this.listenerKeys_[i].forEach(Rt),delete this.listenerKeys_[i],this.dispatchEvent(new Oo(Ro.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(v0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Oo(Ro.REMOVELAYER,i[r]))}this.set(v0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const c=t[o];c.opacity*=r.opacity,c.visible=c.visible&&r.visible,c.maxResolution=Math.min(c.maxResolution,r.maxResolution),c.minResolution=Math.max(c.minResolution,r.minResolution),c.minZoom=Math.max(c.minZoom,r.minZoom),c.maxZoom=Math.min(c.maxZoom,r.maxZoom),r.extent!==void 0&&(c.extent!==void 0?c.extent=rl(c.extent,r.extent):c.extent=r.extent),c.zIndex===void 0&&(c.zIndex=s)}return t}getSourceState(){return"ready"}}const Ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class CE extends Im{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(ze.CHANGE)}release(){this.setState(Ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ce.EMPTY){if(this.state!==Ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){et()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:Jb(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Rv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const b5=new Error("disposed"),k5=[256,256];class eC extends CE{constructor(e){const t=Ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Rv(this.data_);return e?[e.width,e.height]:k5}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ce.IDLE&&this.state!==Ce.ERROR)return;this.state=Ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ce.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(b5),this.controller_=null),super.disposeInternal()}}class nk extends CE{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ei?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ce.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ce.ERROR,this.unlistenImage_(),this.image_=D5(),this.changed()}handleImageLoad_(){if(Ei)this.state=Ce.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ce.LOADED:this.state=Ce.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ce.ERROR&&(this.state=Ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ce.IDLE&&(this.state=Ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=C4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function D5(){const n=Qt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let w0;const qu=[];function tC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function E0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function M5(){if(w0===void 0){const n=Qt(6,6,qu);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",tC(n,4,5,4,0),tC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;w0=E0(e,0)||E0(e,4)||E0(e,8),Mm(n),qu.push(n.canvas)}return w0}function nC(n,e,t,i){const r=Dm(t,e,n);let s=Pp(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const c=n.getExtent();if(!c||oc(c,r)){const h=Pp(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function N5(n,e,t,i){const r=dl(t);let s=nC(n,e,r,i);return(!isFinite(s)||s<=0)&&QP(t,function(o){return s=nC(n,e,o,i),isFinite(s)&&s>0}),s}function L5(n,e,t,i,r,s,o,l,c,h,f,m,y,E){const x=Qt(Math.round(t*n),Math.round(t*e),qu);if(m||(x.imageSmoothingEnabled=!1),c.length===0)return x.canvas;x.scale(t,t);function C(F){return Math.round(F*t)/t}x.globalCompositeOperation="lighter";const T=Zi();c.forEach(function(F,W,D){c3(T,F.extent)});let b;const P=t/i,k=(m?1:1+Math.pow(2,-24))/P;b=Qt(Math.round(dt(T)*P),Math.round(zn(T)*P),qu),m||(b.imageSmoothingEnabled=!1),c.forEach(function(F,W,D){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){b.save();const z=(F.clipExtent[0]-T[0])*P,L=-(F.clipExtent[3]-T[3])*P,ae=dt(F.clipExtent)*P,pe=zn(F.clipExtent)*P;b.rect(m?z:Math.round(z),m?L:Math.round(L),m?ae:Math.round(z+ae)-Math.round(z),m?pe:Math.round(L+pe)-Math.round(L)),b.clip()}const R=(F.extent[0]-T[0])*P,M=-(F.extent[3]-T[3])*P,V=dt(F.extent)*P,j=zn(F.extent)*P;b.drawImage(F.image,h,h,F.image.width-2*h,F.image.height-2*h,m?R:Math.round(R),m?M:Math.round(M),m?V:Math.round(R+V)-Math.round(R),m?j:Math.round(M+j)-Math.round(M)),F.clipExtent&&b.restore()}});const O=Al(o);return l.getTriangles().forEach(function(F,W,D){const R=F.source,M=F.target;let V=R[0][0],j=R[0][1],z=R[1][0],L=R[1][1],ae=R[2][0],pe=R[2][1];const fe=C((M[0][0]-O[0])/s),ce=C(-(M[0][1]-O[1])/s),J=C((M[1][0]-O[0])/s),oe=C(-(M[1][1]-O[1])/s),ne=C((M[2][0]-O[0])/s),G=C(-(M[2][1]-O[1])/s),$=V,xe=j;V=0,j=0,z-=$,L-=xe,ae-=$,pe-=xe;const Te=[[z,L,0,0,J-fe],[ae,pe,0,0,ne-fe],[0,0,z,L,oe-ce],[0,0,ae,pe,G-ce]],Ie=m3(Te);if(!Ie)return;if(x.save(),x.beginPath(),M5()||!m){x.moveTo(J,oe);const Me=4,Ve=fe-J,Be=ce-oe;for(let lt=0;lt<Me;lt++)x.lineTo(J+C((lt+1)*Ve/Me),oe+C(lt*Be/(Me-1))),lt!=Me-1&&x.lineTo(J+C((lt+1)*Ve/Me),oe+C((lt+1)*Be/(Me-1)));x.lineTo(ne,G)}else x.moveTo(J,oe),x.lineTo(fe,ce),x.lineTo(ne,G);x.clip(),x.transform(Ie[0],Ie[2],Ie[1],Ie[3],fe,ce),x.translate(T[0]-$,T[3]-xe);let be;if(b)be=b.canvas,x.scale(k,-k);else{const Me=c[0],Ve=Me.extent;be=Me.image,x.scale(dt(Ve)/be.width,-zn(Ve)/be.height)}x.drawImage(be,0,0),x.restore()}),b&&(Mm(b),qu.push(b.canvas)),f&&(x.save(),x.globalCompositeOperation="source-over",x.strokeStyle="black",x.lineWidth=1,l.getTriangles().forEach(function(F,W,D){const R=F.target,M=(R[0][0]-O[0])/s,V=-(R[0][1]-O[1])/s,j=(R[1][0]-O[0])/s,z=-(R[1][1]-O[1])/s,L=(R[2][0]-O[0])/s,ae=-(R[2][1]-O[1])/s;x.beginPath(),x.moveTo(j,z),x.lineTo(M,V),x.lineTo(L,ae),x.closePath(),x.stroke()}),x.restore()),x.canvas}const O5=10,iC=.25;class V5{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let c={};const h=l?H3(k=>un(l,Dm(k,this.targetProj_,this.sourceProj_))):bp(this.targetProj_,this.sourceProj_);this.transformInv_=function(k){const O=k[0]+"/"+k[1];return c[O]||(c[O]=h(k)),c[O]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&dt(r)>=dt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?dt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?dt(this.targetProj_.getExtent()):null;const f=Al(i),m=Am(i),y=Rm(i),E=Cm(i),x=this.transformInv_(f),C=this.transformInv_(m),T=this.transformInv_(y),b=this.transformInv_(E),P=O5+(o?Math.max(0,Math.ceil(Math.log2(fv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,m,y,E,x,C,T,b,P),this.wrapsXInSource_){let k=1/0;this.triangles_.forEach(function(O,F,W){k=Math.min(k,O.source[0][0],O.source[1][0],O.source[2][0])}),this.triangles_.forEach(O=>{if(Math.max(O.source[0][0],O.source[1][0],O.source[2][0])-k>this.sourceWorldWidth_/2){const F=[[O.source[0][0],O.source[0][1]],[O.source[1][0],O.source[1][1]],[O.source[2][0],O.source[2][1]]];F[0][0]-k>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-k>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-k>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const W=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-W<this.sourceWorldWidth_/2&&(O.source=F)}})}c={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,c,h){const f=iS([s,o,l,c]),m=this.sourceWorldWidth_?dt(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,E=this.sourceProj_.canWrapX()&&m>.5&&m<1;let x=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=iS([e,t,i,r]);x=dt(T)/this.targetWorldWidth_>iC||x}!E&&this.sourceProj_.isGlobal()&&m&&(x=m>iC||x)}if(!x&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ni(f,this.maxSourceExtent_))return;let C=0;if(!x&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(c[0])||!isFinite(c[1]))){if(h>0)x=!0;else if(C=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),C!=1&&C!=2&&C!=4&&C!=8)return}if(h>0){if(!x){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(T);let P;E?P=(sl(s[0],y)+sl(l[0],y))/2-sl(b[0],y):P=(s[0]+l[0])/2-b[0];const k=(s[1]+l[1])/2-b[1];x=P*P+k*k>this.errorThresholdSquared_}if(x){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(T),P=[(r[0]+e[0])/2,(r[1]+e[1])/2],k=this.transformInv_(P);this.addQuad_(e,t,T,P,s,o,b,k,h-1),this.addQuad_(P,T,i,r,k,b,l,c,h-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(T),P=[(i[0]+r[0])/2,(i[1]+r[1])/2],k=this.transformInv_(P);this.addQuad_(e,T,P,r,s,b,k,c,h-1),this.addQuad_(T,t,i,P,b,o,l,k,h-1)}return}}if(E){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(C&11)==0&&this.addTriangle_(e,i,r,s,l,c),(C&14)==0&&this.addTriangle_(e,i,t,s,l,o),C&&((C&13)==0&&this.addTriangle_(t,r,e,o,c,s),(C&7)==0&&this.addTriangle_(t,r,i,o,c,l))}calculateSourceExtent(){const e=Zi();return this.triangles_.forEach(function(t,i,r){const s=t.source;Jh(e,s[0]),Jh(e,s[1]),Jh(e,s[2])}),e}getTriangles(){return this.triangles_}}const F5=.5;class ik extends CE{constructor(e,t,i,r,s,o,l,c,h,f,m,y){super(s,Ce.IDLE,y),this.renderEdges_=m!==void 0?m:!1,this.pixelRatio_=l,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const E=r.getTileCoordExtent(this.wrappedTileCoord_),x=this.targetTileGrid_.getExtent();let C=this.sourceTileGrid_.getExtent();const T=x?rl(E,x):E;if(fv(T)===0){this.state=Ce.EMPTY;return}const b=e.getExtent();b&&(C?C=rl(C,b):C=b);const P=r.getResolution(this.wrappedTileCoord_[0]),k=N5(e,i,T,P);if(!isFinite(k)||k<=0){this.state=Ce.EMPTY;return}const O=f!==void 0?f:F5;if(this.triangulation_=new V5(e,i,T,C,k*O,P),this.triangulation_.getTriangles().length===0){this.state=Ce.EMPTY;return}this.sourceZ_=t.getZForResolution(k);let F=this.triangulation_.calculateSourceExtent();if(C&&(e.canWrapX()?(F[1]=Dt(F[1],C[1],C[3]),F[3]=Dt(F[3],C[1],C[3])):F=rl(F,C)),!fv(F))this.state=Ce.EMPTY;else{let W=0,D=0;e.canWrapX()&&(W=dt(b),D=Math.floor((F[0]-b[0])/W)),tb(F.slice(),e,!0).forEach(M=>{const V=t.getTileRangeForExtentAndZ(M,this.sourceZ_);for(let j=V.minX;j<=V.maxX;j++)for(let z=V.minY;z<=V.maxY;z++){const L=h(this.sourceZ_,j,z,l);if(L){const ae=D*W;this.sourceTiles_.push({tile:L,offset:ae})}}++D}),this.sourceTiles_.length===0&&(this.state=Ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ce.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=L5(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,c,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ce.LOADED}this.changed()}load(){if(this.state==Ce.IDLE){this.state=Ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ce.IDLE||i==Ce.LOADING){e++;const r=tt(t,ze.CHANGE,s=>{const o=t.getState();(o==Ce.LOADED||o==Ce.ERROR||o==Ce.EMPTY)&&(Rt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Rt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Mm(this.canvas_.getContext("2d")),qu.push(this.canvas_),this.canvas_=null),super.release()}}class RE{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Eu(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new RE(n,e,t,i)}class rC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof xm&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return at(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return at(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){at(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Fp(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function j5(n,e,t){return n+"/"+e+"/"+t}function ip(n,e,t,i,r){return`${nt(n)},${e},${j5(t,i,r)}`}function U5(n){return z5(n[0],n[1],n[2])}function z5(n,e,t){return(e<<n)+t}function B5(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function x0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function G5(n,e,t){const i=n[t];return i?i.delete(e):!1}function sC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=rl(e,zo(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=rl(e,r))}return e}class W5 extends Kb{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Zi(),this.tempTileRange_=new RE(0,0,0,0),this.tempTileCoord_=Fp(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new rC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new rC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),c=ip(l,l.getKey(),e,t,i);let h;if(s.containsKey(c))h=s.get(c);else{const f=r.viewState.projection,m=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!m||np(m,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(c,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!oc(s,r))return null;const o=t.viewState,l=i.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=c.getZForResolution(o.resolution);f>=c.getMinZoom();--f){const m=c.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,m[1],m[2],t);if(!y||y.getState()!==Ce.LOADED)continue;const E=c.getOrigin(f),x=ri(c.getTileSize(f)),C=c.getResolution(f);let T;if(y instanceof nk||y instanceof ik)T=y.getImage();else if(y instanceof eC){if(T=Rv(y.getData()),!T)continue}else continue;const b=Math.floor(h*((r[0]-E[0])/C-m[1]*x[0])),P=Math.floor(h*((E[1]-r[1])/C-m[2]*x[1])),k=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(T,b+k,P+k)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),c=l.getRenderSource(),h=c.getTileGridForProjection(o.projection),f=nt(c);f in e.wantedTiles||(e.wantedTiles[f]={});const m=e.wantedTiles[f],y=l.getMapInternal(),E=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),c.zDirection)),x=o.rotation,C=x?JP(o.center,o.resolution,x,e.size):void 0;for(let T=i;T>=E;--T){const b=h.getTileRangeForExtentAndZ(t,T,this.tempTileRange_),P=h.getResolution(T);for(let k=b.minX;k<=b.maxX;++k)for(let O=b.minY;O<=b.maxY;++O){if(x&&!h.tileCoordIntersectsViewport([T,k,O],C))continue;const F=this.getTile(T,k,O,e);if(!F||!x0(r,F,T))continue;const D=F.getKey();if(m[D]=!0,F.getState()===Ce.IDLE&&!e.tileQueue.isKeyQueued(D)){const R=Fp(T,k,O,this.tempTileCoord_);e.tileQueue.enqueue([F,f,h.getTileCoordCenter(R),P])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let c=0;c<l.length;++c){const h=ip(this.getLayer().getSource(),l[c],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ce.LOADED)return f.endTransition(nt(this)),x0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,c=this.getLayer().getRenderSource(),h=c.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let m=s.minY;m<=s.maxY;++m){const y=ip(c,h,i,f,m);let E=!1;if(l.containsKey(y)){const x=l.peek(y);x.getState()===Ce.LOADED&&(x0(r,x,i),E=!0)}E||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,c=e.pixelRatio,h=this.getLayer(),f=h.getSource(),m=f.getTileGridForProjection(s),y=m.getZForResolution(o,f.zDirection),E=m.getResolution(y),x=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==x&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=x):this.renderedSourceKey_=x;let C=e.extent;const T=f.getTilePixelRatio(c);this.prepareContainer(e,t);const b=this.context.canvas.width,P=this.context.canvas.height,k=i.extent&&zo(i.extent);k&&(C=rl(C,zo(i.extent)));const O=E*b/2/T,F=E*P/2/T,W=[l[0]-O,l[1]-F,l[0]+O,l[1]+F],D={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const J=m.getZForResolution(r.nextResolution,f.zDirection),oe=sC(e,e.nextExtent);this.enqueueTiles(e,oe,J,D,R)}const M=sC(e,C);if(this.enqueueTiles(e,M,y,D,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,M,y-1,D,R-1)},0),!(y in D))return this.container;const V=nt(this),j=e.time;for(const J of D[y]){const oe=J.getState();if(oe===Ce.EMPTY)continue;const ne=J.tileCoord;if(oe===Ce.LOADED&&J.getAlpha(V,j)===1){J.endTransition(V);continue}if(oe!==Ce.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,D)){G5(D,J,y),e.animate=!0;continue}if(this.findAltTiles_(m,ne,y+1,D))continue;const xe=m.getMinZoom();for(let Te=y-1;Te>=xe&&!this.findAltTiles_(m,ne,Te,D);--Te);}const z=E/o*c/T,L=this.getRenderContext(e);$s(this.tempTransform,b/2,P/2,z,z,0,-b/2,-P/2),i.extent&&this.clipUnrotated(L,e,k),f.getInterpolate()||(L.imageSmoothingEnabled=!1),this.preRender(L,e);const ae=Object.keys(D).map(Number);ae.sort(zs);let pe;const fe=[],ce=[];for(let J=ae.length-1;J>=0;--J){const oe=ae[J],ne=f.getTilePixelSize(oe,c,s),$=m.getResolution(oe)/E,xe=ne[0]*$*z,Te=ne[1]*$*z,Ie=m.getTileCoordForCoordAndZ(Al(W),oe),be=m.getTileCoordExtent(Ie),Me=un(this.tempTransform,[T*(be[0]-W[0])/E,T*(W[3]-be[3])/E]),Ve=T*f.getGutterForProjection(s);for(const Be of D[oe]){if(Be.getState()!==Ce.LOADED)continue;const lt=Be.tileCoord,Qi=Ie[1]-lt[1],ds=Math.round(Me[0]-(Qi-1)*xe),Gn=Ie[2]-lt[2],Wn=Math.round(Me[1]-(Gn-1)*Te),cn=Math.round(Me[0]-Qi*xe),hn=Math.round(Me[1]-Gn*Te),Kn=ds-cn,Ri=Wn-hn,yt=ae.length===1;let ut=!1;pe=[cn,hn,cn+Kn,hn,cn+Kn,hn+Ri,cn,hn+Ri];for(let tn=0,Ai=fe.length;tn<Ai;++tn)if(!yt&&oe<ce[tn]){const It=fe[tn];ni([cn,hn,cn+Kn,hn+Ri],[It[0],It[3],It[4],It[7]])&&(ut||(L.save(),ut=!0),L.beginPath(),L.moveTo(pe[0],pe[1]),L.lineTo(pe[2],pe[3]),L.lineTo(pe[4],pe[5]),L.lineTo(pe[6],pe[7]),L.moveTo(It[6],It[7]),L.lineTo(It[4],It[5]),L.lineTo(It[2],It[3]),L.lineTo(It[0],It[1]),L.clip())}fe.push(pe),ce.push(oe),this.drawTile(Be,e,cn,hn,Kn,Ri,Ve,yt),ut&&L.restore(),this.renderedTiles.unshift(Be),this.updateUsedTiles(e.usedTiles,f,Be)}}if(this.renderedResolution=E,this.extentChanged=!this.renderedExtent_||!vd(this.renderedExtent_,W),this.renderedExtent_=W,this.renderedPixelRatio=c,this.postRender(this.context,e),i.extent&&L.restore(),L.imageSmoothingEnabled=!0,this.renderComplete){const J=(oe,ne)=>{const G=nt(f),$=ne.wantedTiles[G],xe=$?Object.keys($).length:0;this.updateCacheSize(xe),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(J)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,c){let h;if(e instanceof eC){if(h=Rv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),m=nt(this),y=t.layerStatesArray[t.layerIndex],E=y.opacity*(c?e.getAlpha(m,t.time):1),x=E!==f.globalAlpha;x&&(f.save(),f.globalAlpha=E),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),x&&f.restore(),E!==y.opacity?t.animate=!0:c&&e.endTransition(m)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=nt(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Ug={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class K5 extends Fm{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Ug.PRELOAD)}setPreload(e){this.set(Ug.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Ug.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Ug.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class T0 extends K5{constructor(e){super(e)}createRenderer(){return new W5(this,{cacheSize:this.getCacheSize()})}}const xu=[0,0,0],Ao=5;class rk{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,at(s3(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,at(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Al(i)),at(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,at(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:TE,at(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new RE(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,c=r.maxY;l<=c;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,c=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):c=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Eu(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(c,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Eu(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Eu(s,o,s,o,i);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*c),f=Math.floor(o*c);if(t<r)return Eu(h,h,f,f,i);const m=Math.floor(c*(s+1))-1,y=Math.floor(c*(o+1))-1;return Eu(h,m,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,xu);const r=xu[1],s=xu[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,xu);const o=xu[1],l=xu[2];return Eu(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=ri(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=ri(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,c=o+s[0]*r,h=l+s[1]*r;return Jo(o,l,c,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),c=this.getOrigin(o),h=ri(this.getTileSize(o),this.tmpSize_);let f=l*(e-c[0])/i/h[0],m=l*(c[1]-t)/i/h[1];return r?(f=kg(f,Ao)-1,m=kg(m,Ao)-1):(f=bg(f,Ao),m=bg(m,Ao)),Fp(o,f,m,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),c=ri(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/c[0],f=(o[1]-t)/l/c[1];return r?(h=kg(h,Ao)-1,f=kg(f,Ao)-1):(h=bg(h,Ao),f=bg(f,Ao)),Fp(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=Xw(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return vb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function sk(n){let e=n.getDefaultTileGrid();return e||(e=q5(n),n.setDefaultTileGrid(e)),e}function $5(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=AE(t);if(!oc(s,r)){const o=dt(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function H5(n,e,t,i){i=i!==void 0?i:"top-left";const r=ok(n,e,t);return new rk({extent:n,origin:d3(n,i),resolutions:r,tileSize:t})}function X5(n){const e=n||{},t=e.extent||si("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:ok(t,e.maxZoom,e.tileSize,e.maxResolution)};return new rk(i)}function ok(n,e,t,i){e=e!==void 0?e:I5,t=ri(t!==void 0?t:TE);const r=zn(n),s=dt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let c=0;c<o;++c)l[c]=i/Math.pow(2,c);return l}function q5(n,e,t,i){const r=AE(n);return H5(r,e,t,i)}function AE(n){n=si(n);let e=n.getExtent();if(!e){const t=180*ac.degrees/n.getMetersPerUnit();e=Jo(-t,-t,t,t)}return e}function rH(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const Y5=/\{z\}/g,Z5=/\{x\}/g,Q5=/\{y\}/g,J5=/\{-y\}/g;function e6(n,e,t,i,r){return n.replace(Y5,e.toString()).replace(Z5,t.toString()).replace(Q5,i.toString()).replace(J5,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function t6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function n6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return e6(n,o,t[1],t[2],s)})}function i6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=n6(n[r],e);return r6(i)}function r6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=U5(e),s=sl(r,n.length);return n[s](e,t,i)})}class s6 extends jb{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ri(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||nt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return et()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:sk(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=ri(r.getTileSize(e),this.tmpSize);return s==1?o:cj(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=$5(r,e,i)),B5(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class o6 extends Ys{constructor(e,t){super(e),this.tile=t}}const I0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class PE extends s6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===PE.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=nt(t),r=t.getState();let s;r==Ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=I0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ce.ERROR?I0.TILELOADERROR:r==Ce.LOADED?I0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new o6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=t6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(i6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class a6 extends PE{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:ak,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:nk,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!np(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||np(t,e)))return this.tileGrid;const i=nt(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=sk(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],c=this.getTileCoordForTileUrlFunction(l,s),h=c?this.tileUrlFunction(c,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ce.IDLE:Ce.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(ze.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||np(l,s))return this.getTileInternal(e,t,i,r,l||s);const c=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),m=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(c,s),E=new ik(l,f,s,m,c,y,this.getTilePixelRatio(r),this.getGutter(),(x,C,T,b)=>this.getTileInternal(x,C,T,b,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return E.key=h,E}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),c=ip(this,l,e,t,i);if(o&&o.containsKey(c))return o.get(c);const h=this.createTile_(e,t,i,r,s,l);return o?.set(c,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=si(e);if(i){const r=nt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function ak(n,e){if(Ei){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Av extends a6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:X5({extent:AE(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const l6="modulepreload",u6=function(n){return"/visapp/"+n},oC={},zg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=c(t.map(h=>{if(h=u6(h),h in oC)return;oC[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":l6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((E,x)=>{y.addEventListener("load",E),y.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},c6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class h6 extends Av{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[c6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ei&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||ak)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const jp=1/0;class d6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,qd(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){at(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=jp?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const c=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[c]?h:c;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,c;for(l=0;l<s;++l)o=t[l],c=e(o),c==jp?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=c,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class f6 extends d6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(ze.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ce.LOADED||i===Ce.ERROR||i===Ce.EMPTY){i!==Ce.ERROR&&t.removeEventListener(ze.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ce.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function g6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return jp;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Mu extends Ys{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class No extends Mu{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Nt={SINGLECLICK:"singleclick",CLICK:ze.CLICK,DBLCLICK:ze.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Pv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class p6 extends Im{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=tt(i,Pv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=tt(i,Pv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ze.TOUCHMOVE,this.boundHandleTouchMove_,Tb?{passive:!1}:!1)}emulateClick_(e){let t=new No(Nt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new No(Nt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new No(Nt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Nt.POINTERUP||t.type==Nt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Nt.POINTERDOWN||t.type==Nt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new No(Nt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new No(Nt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(tt(i,Nt.POINTERMOVE,this.handlePointerMove_,this),tt(i,Nt.POINTERUP,this.handlePointerUp_,this),tt(this.element_,Nt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(tt(this.element_.getRootNode(),Nt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new No(Nt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new No(Nt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ze.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Lo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},kn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class jm extends as{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Rt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==_d&&this.listenerKeys.push(tt(e,Lo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class m6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(ze.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+Jd+" "+fE+(this.collapsed_&&this.collapsible_?" "+TS:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>o3(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!oa(t,this.renderedAttributions_)){p4(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(TS),this.collapsed_?ES(this.collapseLabel_,this.label_):ES(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class y6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(ze.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+Jd+" "+fE,c=this.element;c.className=l,c.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ng)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:bc}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Ng);!s&&i===0?this.element.classList.add(Ng):s&&i!==0&&this.element.classList.remove(Ng)}this.label_.style.transform=r}this.rotation_=i}}class _6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",c=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=c,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(ze.CLICK,this.handleClick_.bind(this,i),!1);const m=document.createElement("button");m.className=s,m.setAttribute("type","button"),m.title=h,m.appendChild(typeof l=="string"?document.createTextNode(l):l),m.addEventListener(ze.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+Jd+" "+fE,E=this.element;E.className=y,E.appendChild(f),E.appendChild(m),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:bc})):i.setZoom(s)}}}function v6(n){n=n||{};const e=new $i;return(n.zoom===void 0||n.zoom)&&e.push(new _6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new y6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new m6(n.attributionOptions)),e}class w6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const aC={ACTIVE:"active"};class rf extends as{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(aC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(aC.ACTIVE,e)}setMap(e){this.map_=e}}function E6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:v5,center:n.getConstrainedCenter(r)})}}function bE(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:bc})}class x6 extends rf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Nt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();bE(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function bv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const T6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},I6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},lk=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?I6(n):!0},S6=yd,uk=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(f4&&Eb&&e.ctrlKey)},ck=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},C6=function(n){const e=n.originalEvent;return Eb?e.metaKey:e.ctrlKey},R6=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},hk=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},S0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},A6=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class sf extends rf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Nt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Nt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Nt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Nt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function kE(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class P6 extends sf{constructor(e){super({stopDown:Tm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:bv(ck,A6);this.condition_=e.onFocusOnly?bv(lk,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(kE(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();_3(s,l.getResolution()),Qw(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),c=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(c),duration:500,easing:bc})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class b6 extends sf{constructor(e){e=e||{},super({stopDown:Tm}),this.condition_=e.condition?e.condition:T6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!S0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===xE)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return S0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return S0(e)&&uk(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class k6 extends xm{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Cd([r])}getGeometry(){return this.geometry_}}const Tu={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ph extends Ys{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class D6 extends sf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new k6(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??uk,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ph(Tu.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ph(t?Tu.BOXEND:Tu.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ph(Tu.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Tu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Tu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class M6 extends D6{constructor(e){e=e||{};const t=e.condition?e.condition:R6;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:bc})}}const La={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class N6 extends rf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return ck(t)&&hk(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==ze.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==La.DOWN||r==La.LEFT||r==La.RIGHT||r==La.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let c=0,h=0;r==La.DOWN?h=-l:r==La.LEFT?c=-l:r==La.RIGHT?c=l:h=l;const f=[c,h];Qw(f,o.getRotation()),E6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class L6 extends rf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!C6(t)&&hk(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==ze.KEYDOWN||e.type==ze.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();bE(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const O6=40,V6=300;class F6 extends rf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:S6;this.condition_=e.onFocusOnly?bv(lk,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==ze.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=O6;break;case WheelEvent.DOM_DELTA_PAGE:s*=V6;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const c=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),c),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),bE(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class j6 extends sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Tm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const c=s-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=c}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==xE&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(kE(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class U6 extends sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Tm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const c=e.map,h=c.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(kE(this.targetPointers))),c.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function z6(n){n=n||{};const e=new $i,t=new w6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new b6),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new x6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new P6({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new j6),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new U6({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new N6),e.push(new L6({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new F6({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new M6({duration:n.zoomDuration})),e}class B6 extends xm{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){et()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;$s(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),hb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,c){let h;const f=t.viewState;function m(O,F,W,D){return s.call(o,F,O?W:null,D)}const y=f.projection,E=nb(e.slice(),y),x=[[0,0]];if(y.canWrapX()&&r){const O=y.getExtent(),F=dt(O);x.push([-F,0],[F,0])}const C=t.layerStatesArray,T=C.length,b=[],P=[];for(let O=0;O<x.length;O++)for(let F=T-1;F>=0;--F){const W=C[F],D=W.layer;if(D.hasRenderer()&&IE(W,f)&&l.call(c,D)){const R=D.getRenderer(),M=D.getSource();if(R&&M){const V=M.getWrapX()?E:e,j=m.bind(null,W.managed);P[0]=V[0]+x[O][0],P[1]=V[1]+x[O][1],h=R.forEachFeatureAtCoordinate(P,t,i,j,b)}if(h)return h}}if(b.length===0)return;const k=1/b.length;return b.forEach((O,F)=>O.distanceSq+=F*k),b.sort((O,F)=>O.distanceSq-F.distanceSq),b.some(O=>h=O.callback(O.feature,O.layer,O.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,yd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){et()}scheduleExpireIconCache(e){Xi.canExpireCache()&&e.postRenderFunctions.push(G6)}}function G6(n,e){Xi.expire()}class W6 extends B6{constructor(e){super(e),this.fontChangeListenerKey_=tt(bu,ic.PROPERTYCHANGE,e.redrawText,e),this.element_=Ei?Ib():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Jd+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new Wb(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Hi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof tk&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const m=t[h];e.layerIndex=h;const y=m.layer,E=y.getSourceState();if(!IE(m,r)||E!="ready"&&E!="undefined"){y.unrender();continue}const x=y.render(e,o);x&&(x!==o&&(this.children_.push(x),o=x),s.push(m))}this.declutter(e,s),m4(this.element_,this.children_);const c=this.getMap().getTargetElement();if(Bo(c)){const h=c.getContext("2d");for(const f of this.children_){const m=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Bo(m)||m.width>0)&&(h.fillStyle=y,h.fillRect(0,0,c.width,c.height)),Bo(m)&&m.width>0){const E=f.style.opacity||m.style.opacity;h.globalAlpha=E===""?1:Number(E);const x=m.style.transform;if(x)h.setTransform(...wv(x));else{const C=parseFloat(m.style.width)/m.width,T=parseFloat(m.style.height)/m.height;h.setTransform(C,0,0,T,0,0)}h.drawImage(m,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Hi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function dk(n){if(n instanceof Fm){n.setMapInternal(null);return}n instanceof kc&&n.getLayers().forEach(dk)}function fk(n,e){if(n instanceof Fm){n.setMapInternal(e);return}if(n instanceof kc){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)fk(t[i],e)}}let K6=class extends as{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=$6(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:g4,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=wr(),this.pixelToCoordinateTransform_=wr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ei||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ei||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ei?new $i:v6()),this.interactions=t.interactions||(Ei?new $i:z6({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new f6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(kn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(kn.VIEW,this.handleViewChanged_),this.addChangeListener(kn.SIZE,this.handleSizeChanged_),this.addChangeListener(kn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof qr)&&e.view.then(function(r){i.setView(new qr(r))}),this.controls.addEventListener(Jn.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Jn.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Jn.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Jn.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Jn.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Jn.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){fk(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:yd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof kc?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:yd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(kn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return vv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(kn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof $i){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(kn.SIZE)}getView(){return this.get(kn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return g6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new No(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Pv.POINTERDOWN||i===ze.WHEEL||i===ze.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Mn.ANIMATING]||o[Mn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Hi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Hi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Mu(Lo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Mu(Lo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Rt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ze.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ze.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Bo(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Bo(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new W6(this)),!Bo(t)){this.mapBrowserEventHandler_=new p6(this,this.moveTolerance_);for(const r in Nt)this.mapBrowserEventHandler_.addEventListener(Nt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ze.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ze.WHEEL,this.boundHandleBrowserEvent_,Tb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[tt(i,ze.KEYDOWN,this.handleBrowserEvent,this),tt(i,ze.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=tt(e,ic.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=tt(e,ze.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Oo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[tt(e,ic.PROPERTYCHANGE,this.render,this),tt(e,ze.CHANGE,this.render,this),tt(e,"addlayer",this.handleLayerAdd_,this),tt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){dk(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&LS(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:gv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:nt(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const c=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=gv(l.nextCenter,l.nextResolution,c,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Pm(this.previousExtent_)&&!vd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Mu(Lo.MOVESTART,this,r)),this.previousExtent_=Sm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Mn.ANIMATING]&&!s.viewHints[Mn.INTERACTING]&&!vd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Mu(Lo.MOVEEND,this,s)),HP(s.extent,this.previousExtent_))),this.dispatchEvent(new Mu(Lo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Lo.LOADSTART)||this.hasListener(Lo.LOADEND)||this.hasListener(Hi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Oo("removelayer",t)),this.set(kn.LAYERGROUP,e)}setSize(e){this.set(kn.SIZE,e)}setTarget(e){this.set(kn.TARGET,e)}setView(e){if(!e||e instanceof qr){this.set(kn.VIEW,e);return}this.set(kn.VIEW,new qr);const t=this;e.then(function(i){t.setView(new qr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Bo(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!LS(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&ib("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!oa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function $6(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new kc({layers:n.layers});t[kn.LAYERGROUP]=i,t[kn.TARGET]=n.target,t[kn.VIEW]=n.view instanceof qr?n.view:new qr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new $i(n.controls.slice()):(at(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new $i(n.interactions.slice()):(at(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new $i(n.overlays.slice()):(at(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new $i,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const C0="units",H6=[1,2,5],bh=25.4/.28;class X6 extends jm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Jd,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(C0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(C0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(C0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Pp(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||bh)/bh,c=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||bh)/bh:void 0;let h=l*o,f="";if(r=="degrees"){const k=ac.degrees;h*=k,h<k/60?(f="",o*=3600):h<k?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let m=3*Math.floor(Math.log(l*o)/Math.log(10)),y,E,x,C=0,T,b;for(;;){x=Math.floor(m/3);const k=Math.pow(10,x);if(y=H6[(m%3+3)%3]*k,E=Math.round(y/o),isNaN(E)){this.element.style.display="none",this.renderedVisible_=!1;return}if(c!==void 0&&E>=c){y=C,E=T,x=b;break}else if(E>=l)break;C=y,T=E,b=x,++m}const P=this.scaleBar_?this.createScaleBar(E,y,f):y.toFixed(x<0?-x:0)+" "+f;this.renderedHTML_!=P&&(this.innerElement_.innerHTML=P,this.renderedHTML_=P),this.renderedWidth_!=E&&(this.innerElement_.style.width=E+"px",this.renderedWidth_=E),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,c=[this.createMarker("absolute")];for(let f=0;f<o;++f){const m=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";c.push(`<div><div class="ol-scale-singlebar ${m}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return c.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+c.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),c=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${c}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Pp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||bh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const q6={},lC=n=>{let e;const t=new Set,i=(f,m)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const E=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(x=>x(e,E))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(q6?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},Y6=n=>n?lC(n):lC;var R0={exports:{}},A0={},P0={exports:{}},b0={};var uC;function Z6(){if(uC)return b0;uC=1;var n=Wd();function e(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(m,y){var E=y(),x=i({inst:{value:E,getSnapshot:y}}),C=x[0].inst,T=x[1];return s(function(){C.value=E,C.getSnapshot=y,c(C)&&T({inst:C})},[m,E,y]),r(function(){return c(C)&&T({inst:C}),m(function(){c(C)&&T({inst:C})})},[m]),o(E),E}function c(m){var y=m.getSnapshot;m=m.value;try{var E=y();return!t(m,E)}catch{return!0}}function h(m,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return b0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,b0}var cC;function Q6(){return cC||(cC=1,P0.exports=Z6()),P0.exports}var hC;function J6(){if(hC)return A0;hC=1;var n=Wd(),e=Q6();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;return A0.useSyncExternalStoreWithSelector=function(h,f,m,y,E){var x=s(null);if(x.current===null){var C={hasValue:!1,value:null};x.current=C}else C=x.current;x=l(function(){function b(W){if(!P){if(P=!0,k=W,W=y(W),E!==void 0&&C.hasValue){var D=C.value;if(E(D,W))return O=D}return O=W}if(D=O,i(k,W))return D;var R=y(W);return E!==void 0&&E(D,R)?(k=W,D):(k=W,O=R)}var P=!1,k,O,F=m===void 0?null:m;return[function(){return b(f())},F===null?void 0:function(){return b(F())}]},[f,m,y,E]);var T=r(h,x[0],x[1]);return o(function(){C.hasValue=!0,C.value=T},[T]),c(T),T},A0}var dC;function eU(){return dC||(dC=1,R0.exports=J6()),R0.exports}var tU=eU();const nU=fw(tU),gk={},{useDebugValue:iU}=PN,{useSyncExternalStoreWithSelector:rU}=nU;let fC=!1;const sU=n=>n;function oU(n,e=sU,t){(gk?"production":void 0)!=="production"&&t&&!fC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),fC=!0);const i=rU(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return iU(i),i}const gC=n=>{(gk?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Y6(n):n,t=(i,r)=>oU(e,i,r);return Object.assign(t,e),t},ls=n=>n?gC(n):gC;var pk=Symbol.for("immer-nothing"),pC=Symbol.for("immer-draftable"),Si=Symbol.for("immer-state");function gr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Pd=Object.getPrototypeOf;function dc(n){return!!n&&!!n[Si]}function yl(n){return n?mk(n)||Array.isArray(n)||!!n[pC]||!!n.constructor?.[pC]||of(n)||zm(n):!1}var aU=Object.prototype.constructor.toString(),mC=new WeakMap;function mk(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=mC.get(t);return i===void 0&&(i=Function.toString.call(t),mC.set(t,i)),i===aU}function Up(n,e,t=!0){Um(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Um(n){const e=n[Si];return e?e.type_:Array.isArray(n)?1:of(n)?2:zm(n)?3:0}function kv(n,e){return Um(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function yk(n,e,t){const i=Um(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function lU(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function of(n){return n instanceof Map}function zm(n){return n instanceof Set}function Ua(n){return n.copy_||n.base_}function Dv(n,e){if(of(n))return new Map(n);if(zm(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=mk(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Si];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Pd(n),i)}else{const i=Pd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function DE(n,e=!1){return Bm(n)||dc(n)||!yl(n)||(Um(n)>1&&Object.defineProperties(n,{set:Bg,add:Bg,clear:Bg,delete:Bg}),Object.freeze(n),e&&Object.values(n).forEach(t=>DE(t,!0))),n}function uU(){gr(2)}var Bg={value:uU};function Bm(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var cU={};function _l(n){const e=cU[n];return e||gr(0,n),e}var bd;function _k(){return bd}function hU(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function yC(n,e){e&&(_l("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Mv(n){Nv(n),n.drafts_.forEach(dU),n.drafts_=null}function Nv(n){n===bd&&(bd=n.parent_)}function _C(n){return bd=hU(bd,n)}function dU(n){const e=n[Si];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function vC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Si].modified_&&(Mv(e),gr(4)),yl(n)&&(n=zp(e,n),e.parent_||Bp(e,n)),e.patches_&&_l("Patches").generateReplacementPatches_(t[Si].base_,n,e.patches_,e.inversePatches_)):n=zp(e,t,[]),Mv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==pk?n:void 0}function zp(n,e,t){if(Bm(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Si];if(!r)return Up(e,(s,o)=>wC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Bp(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Up(o,(c,h)=>wC(n,r,s,c,h,t,l),i),Bp(n,s,!1),t&&n.patches_&&_l("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function wC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Bm(r);if(!(l&&!o)){if(dc(r)){const c=s&&e&&e.type_!==3&&!kv(e.assigned_,i)?s.concat(i):void 0,h=zp(n,r,c);if(yk(t,i,h),dc(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(yl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;zp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(of(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Bp(n,r)}}}function Bp(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&DE(e,t)}function fU(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:_k(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=ME;t&&(r=[i],s=kd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var ME={get(n,e){if(e===Si)return n;const t=Ua(n);if(!kv(t,e))return gU(n,t,e);const i=t[e];return n.finalized_||!yl(i)?i:i===k0(n.base_,e)?(D0(n),n.copy_[e]=Ov(i,n)):i},has(n,e){return e in Ua(n)},ownKeys(n){return Reflect.ownKeys(Ua(n))},set(n,e,t){const i=vk(Ua(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=k0(Ua(n),e),s=r?.[Si];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(lU(t,r)&&(t!==void 0||kv(n.base_,e)))return!0;D0(n),Lv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return k0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,D0(n),Lv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ua(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){gr(11)},getPrototypeOf(n){return Pd(n.base_)},setPrototypeOf(){gr(12)}},kd={};Up(ME,(n,e)=>{kd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});kd.deleteProperty=function(n,e){return kd.set.call(this,n,e,void 0)};kd.set=function(n,e,t){return ME.set.call(this,n[0],e,t,n[0])};function k0(n,e){const t=n[Si];return(t?Ua(t):n)[e]}function gU(n,e,t){const i=vk(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function vk(n,e){if(!(e in n))return;let t=Pd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Pd(t)}}function Lv(n){n.modified_||(n.modified_=!0,n.parent_&&Lv(n.parent_))}function D0(n){n.copy_||(n.copy_=Dv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var pU=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(c=s,...h){return o.produce(c,f=>t.call(this,f,...h))}}typeof t!="function"&&gr(6),i!==void 0&&typeof i!="function"&&gr(7);let r;if(yl(e)){const s=_C(this),o=Ov(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Mv(s):Nv(s)}return yC(s,i),vC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===pk&&(r=void 0),this.autoFreeze_&&DE(r,!0),i){const s=[],o=[];_l("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else gr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){yl(n)||gr(8),dc(n)&&(n=mU(n));const e=_C(this),t=Ov(n,void 0);return t[Si].isManual_=!0,Nv(e),t}finishDraft(n,e){const t=n&&n[Si];(!t||!t.isManual_)&&gr(9);const{scope_:i}=t;return yC(i,e),vC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=_l("Patches").applyPatches_;return dc(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Ov(n,e){const t=of(n)?_l("MapSet").proxyMap_(n,e):zm(n)?_l("MapSet").proxySet_(n,e):fU(n,e);return(e?e.scope_:_k()).drafts_.push(t),t}function mU(n){return dc(n)||gr(10,n),wk(n)}function wk(n){if(!yl(n)||Bm(n))return n;const e=n[Si];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Dv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Dv(n,!0);return Up(t,(r,s)=>{yk(t,r,wk(s))},i),e&&(e.finalized_=!1),t}var yU=new pU,_U=yU.produce;const vU=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?_U(r):r;return e(l,s,...o)},n(i.setState,t,i)),Gm=vU,Wi=ls()(Gm((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),Ek={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await zg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-2XVzP9LT.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await zg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-fkGRsvBW.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await zg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-BYsxus7t.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await zg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-DkoZkUcB.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function wU(){return Object.values(Ek).filter(n=>n.immediateLoad)}const us=ls()(Gm((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ho=ls()(Gm((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=Ek[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=us.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(c=>{c.layers[t]=o,c.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),xi=ls()(Gm(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e||null})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),EU={};function xU(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=c=>c===null?null:JSON.parse(c,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Dd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Dd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Dd(i)(t)}}}},TU=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:T=>T,version:0,merge:(T,b)=>({...b,...T}),...e},o=!1;const l=new Set,c=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=Dd(s.serialize),m=()=>{const T=s.partialize({...i()});let b;const P=f({state:T,version:s.version}).then(k=>h.setItem(s.name,k)).catch(k=>{b=k});if(b)throw b;return P},y=r.setState;r.setState=(T,b)=>{y(T,b),m()};const E=n((...T)=>{t(...T),m()},i,r);let x;const C=()=>{var T;if(!h)return;o=!1,l.forEach(P=>P(i()));const b=((T=s.onRehydrateStorage)==null?void 0:T.call(s,i()))||void 0;return Dd(h.getItem.bind(h))(s.name).then(P=>{if(P)return s.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate)return s.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var k;return x=s.merge(P,(k=i())!=null?k:E),t(x,!0),m()}).then(()=>{b?.(x,void 0),o=!0,c.forEach(P=>P(x))}).catch(P=>{b?.(void 0,P)})};return r.persist={setOptions:T=>{s={...s,...T},T.getStorage&&(h=T.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(c.add(T),()=>{c.delete(T)})},C(),x||E},IU=(n,e)=>(t,i,r)=>{let s={storage:xU(()=>localStorage),partialize:C=>C,version:0,merge:(C,T)=>({...T,...C}),...e},o=!1;const l=new Set,c=new Set;let h=s.storage;if(!h)return n((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...C)},i,r);const f=()=>{const C=s.partialize({...i()});return h.setItem(s.name,{state:C,version:s.version})},m=r.setState;r.setState=(C,T)=>{m(C,T),f()};const y=n((...C)=>{t(...C),f()},i,r);r.getInitialState=()=>y;let E;const x=()=>{var C,T;if(!h)return;o=!1,l.forEach(P=>{var k;return P((k=i())!=null?k:y)});const b=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(C=i())!=null?C:y))||void 0;return Dd(h.getItem.bind(h))(s.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate)return[!0,s.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var k;const[O,F]=P;if(E=s.merge(F,(k=i())!=null?k:y),t(E,!0),O)return f()}).then(()=>{b?.(E,void 0),E=i(),o=!0,c.forEach(P=>P(E))}).catch(P=>{b?.(void 0,P)})};return r.persist={setOptions:C=>{s={...s,...C},C.storage&&(h=C.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>o,onHydrate:C=>(l.add(C),()=>{l.delete(C)}),onFinishHydration:C=>(c.add(C),()=>{c.delete(C)})},s.skipHydration||x(),E||y},SU=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((EU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),TU(n,e)):IU(n,e),af=SU,yi=ls()(af(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e})}),{name:"visapp-settings"})),xk=ls()(af((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),Tk=ls((n,e)=>({current:null,loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"}})),Ik=ls()(af(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),EC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],xC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],CU=ls()(af((n,e)=>({presets:EC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Ho.getState().setLayerVisibility;xC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Ho.getState().visible,r=xC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:EC})}}),{name:"visapp-presets"})),RU=()=>{};var TC={};const Sk=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},AU=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Ck={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,c=r+2<n.length,h=c?n[r+2]:0,f=s>>2,m=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,E=h&63;c||(E=64,o||(y=64)),i.push(t[f],t[m],t[y],t[E])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Sk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):AU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const m=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||m==null)throw new PU;const y=s<<2|l>>4;if(i.push(y),h!==64){const E=l<<4&240|h>>2;if(i.push(E),m!==64){const x=h<<6&192|m;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class PU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bU=function(n){const e=Sk(n);return Ck.encodeByteArray(e,!0)},Gp=function(n){return bU(n).replace(/\./g,"")},Rk=function(n){try{return Ck.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ak(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const kU=()=>Ak().__FIREBASE_DEFAULTS__,DU=()=>{if(typeof process>"u"||typeof TC>"u")return;const n=TC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},MU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Rk(n[1]);return e&&JSON.parse(e)},Wm=()=>{try{return RU()||kU()||DU()||MU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Pk=n=>Wm()?.emulatorHosts?.[n],bk=n=>{const e=Pk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},kk=()=>Wm()?.config,Dk=n=>Wm()?.[`_${n}`];class NU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function kl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function NE(n){return(await fetch(n,{credentials:"include"})).ok}function Mk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Gp(JSON.stringify(t)),Gp(JSON.stringify(o)),""].join(".")}const td={};function LU(){const n={prod:[],emulator:[]};for(const e of Object.keys(td))td[e]?n.emulator.push(e):n.prod.push(e);return n}function OU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let IC=!1;function LE(n,e){if(typeof window>"u"||typeof document>"u"||!kl(window.location.host)||td[n]===e||td[n]||IC)return;td[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=LU().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function c(y,E){y.setAttribute("width","24"),y.setAttribute("id",E),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{IC=!0,o()},y}function f(y,E){y.setAttribute("id",E),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function m(){const y=OU(i),E=t("text"),x=document.getElementById(E)||document.createElement("span"),C=t("learnmore"),T=document.getElementById(C)||document.createElement("a"),b=t("preprendIcon"),P=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const k=y.element;l(k),f(T,C);const O=h();c(P,b),k.append(P,x,T,O),document.body.appendChild(k)}s?(x.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function VU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function Nk(){const n=Wm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function UU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zU(){const n=Jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Lk(){return!Nk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ok(){return!Nk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Vk(){try{return typeof indexedDB=="object"}catch{return!1}}function BU(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const GU="FirebaseError";class cs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=GU,Object.setPrototypeOf(this,cs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lf.prototype.create)}}class lf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?WU(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new cs(r,l,i)}}function WU(n,e){return n.replace(KU,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const KU=/\{\$([^}]+)}/g;function $U(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function vl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(SC(s)&&SC(o)){if(!vl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function SC(n){return n!==null&&typeof n=="object"}function uf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function HU(n,e){const t=new XU(n,e);return t.subscribe.bind(t)}class XU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");qU(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=M0),r.error===void 0&&(r.error=M0),r.complete===void 0&&(r.complete=M0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function qU(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function M0(){}function Qs(n){return n&&n._delegate?n._delegate:n}class ea{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const za="[DEFAULT]";class YU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new NU;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QU(e))try{this.getOrInitializeService({instanceIdentifier:za})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=za){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=za){return this.instances.has(e)}getOptions(e=za){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:ZU(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=za){return this.component?this.component.multipleInstances?e:za:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ZU(n){return n===za?void 0:n}function QU(n){return n.instantiationMode==="EAGER"}class JU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new YU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const ez={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},tz=Ke.INFO,nz={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},iz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=nz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class OE{constructor(e){this.name=e,this._logLevel=tz,this._logHandler=iz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ez[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const rz=(n,e)=>e.some(t=>n instanceof t);let CC,RC;function sz(){return CC||(CC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oz(){return RC||(RC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fk=new WeakMap,Vv=new WeakMap,jk=new WeakMap,N0=new WeakMap,VE=new WeakMap;function az(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Xo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Fk.set(t,n)}).catch(()=>{}),VE.set(e,n),e}function lz(n){if(Vv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Vv.set(n,e)}let Fv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||jk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function uz(n){Fv=n(Fv)}function cz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(L0(this),e,...t);return jk.set(i,e.sort?e.sort():[e]),Xo(i)}:oz().includes(n)?function(...e){return n.apply(L0(this),e),Xo(Fk.get(this))}:function(...e){return Xo(n.apply(L0(this),e))}}function hz(n){return typeof n=="function"?cz(n):(n instanceof IDBTransaction&&lz(n),rz(n,sz())?new Proxy(n,Fv):n)}function Xo(n){if(n instanceof IDBRequest)return az(n);if(N0.has(n))return N0.get(n);const e=hz(n);return e!==n&&(N0.set(n,e),VE.set(e,n)),e}const L0=n=>VE.get(n);function dz(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Xo(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Xo(o.result),c.oldVersion,c.newVersion,Xo(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const fz=["get","getKey","getAll","getAllKeys","count"],gz=["put","add","delete","clear"],O0=new Map;function AC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(O0.get(e))return O0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=gz.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||fz.includes(t)))return;const s=async function(o,...l){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&c.done]))[0]};return O0.set(e,s),s}uz(n=>({...n,get:(e,t,i)=>AC(e,t)||n.get(e,t,i),has:(e,t)=>!!AC(e,t)||n.has(e,t)}));class pz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(mz(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function mz(n){return n.getComponent()?.type==="VERSION"}const jv="@firebase/app",PC="0.14.6";const Hs=new OE("@firebase/app"),yz="@firebase/app-compat",_z="@firebase/analytics-compat",vz="@firebase/analytics",wz="@firebase/app-check-compat",Ez="@firebase/app-check",xz="@firebase/auth",Tz="@firebase/auth-compat",Iz="@firebase/database",Sz="@firebase/data-connect",Cz="@firebase/database-compat",Rz="@firebase/functions",Az="@firebase/functions-compat",Pz="@firebase/installations",bz="@firebase/installations-compat",kz="@firebase/messaging",Dz="@firebase/messaging-compat",Mz="@firebase/performance",Nz="@firebase/performance-compat",Lz="@firebase/remote-config",Oz="@firebase/remote-config-compat",Vz="@firebase/storage",Fz="@firebase/storage-compat",jz="@firebase/firestore",Uz="@firebase/ai",zz="@firebase/firestore-compat",Bz="firebase",Gz="12.6.0";const Uv="[DEFAULT]",Wz={[jv]:"fire-core",[yz]:"fire-core-compat",[vz]:"fire-analytics",[_z]:"fire-analytics-compat",[Ez]:"fire-app-check",[wz]:"fire-app-check-compat",[xz]:"fire-auth",[Tz]:"fire-auth-compat",[Iz]:"fire-rtdb",[Sz]:"fire-data-connect",[Cz]:"fire-rtdb-compat",[Rz]:"fire-fn",[Az]:"fire-fn-compat",[Pz]:"fire-iid",[bz]:"fire-iid-compat",[kz]:"fire-fcm",[Dz]:"fire-fcm-compat",[Mz]:"fire-perf",[Nz]:"fire-perf-compat",[Lz]:"fire-rc",[Oz]:"fire-rc-compat",[Vz]:"fire-gcs",[Fz]:"fire-gcs-compat",[jz]:"fire-fst",[zz]:"fire-fst-compat",[Uz]:"fire-vertex","fire-js":"fire-js",[Bz]:"fire-js-all"};const Wp=new Map,Kz=new Map,zv=new Map;function bC(n,e){try{n.container.addComponent(e)}catch(t){Hs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wl(n){const e=n.name;if(zv.has(e))return Hs.debug(`There were multiple attempts to register component ${e}.`),!1;zv.set(e,n);for(const t of Wp.values())bC(t,n);for(const t of Kz.values())bC(t,n);return!0}function Km(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ki(n){return n==null?!1:n.settings!==void 0}const $z={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qo=new lf("app","Firebase",$z);class Hz{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ea("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qo.create("app-deleted",{appName:this._name})}}const Dl=Gz;function Uk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Uv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw qo.create("bad-app-name",{appName:String(r)});if(t||(t=kk()),!t)throw qo.create("no-options");const s=Wp.get(r);if(s){if(vl(t,s.options)&&vl(i,s.config))return s;throw qo.create("duplicate-app",{appName:r})}const o=new JU(r);for(const c of zv.values())o.addComponent(c);const l=new Hz(t,i,o);return Wp.set(r,l),l}function FE(n=Uv){const e=Wp.get(n);if(!e&&n===Uv&&kk())return Uk();if(!e)throw qo.create("no-app",{appName:n});return e}function ns(n,e,t){let i=Wz[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hs.warn(o.join(" "));return}wl(new ea(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const Xz="firebase-heartbeat-database",qz=1,Md="firebase-heartbeat-store";let V0=null;function zk(){return V0||(V0=dz(Xz,qz,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Md)}catch(t){console.warn(t)}}}}).catch(n=>{throw qo.create("idb-open",{originalErrorMessage:n.message})})),V0}async function Yz(n){try{const t=(await zk()).transaction(Md),i=await t.objectStore(Md).get(Bk(n));return await t.done,i}catch(e){if(e instanceof cs)Hs.warn(e.message);else{const t=qo.create("idb-get",{originalErrorMessage:e?.message});Hs.warn(t.message)}}}async function kC(n,e){try{const i=(await zk()).transaction(Md,"readwrite");await i.objectStore(Md).put(e,Bk(n)),await i.done}catch(t){if(t instanceof cs)Hs.warn(t.message);else{const i=qo.create("idb-set",{originalErrorMessage:t?.message});Hs.warn(i.message)}}}function Bk(n){return`${n.name}!${n.options.appId}`}const Zz=1024,Qz=30;class Jz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tB(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=DC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>Qz){const r=nB(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Hs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=DC(),{heartbeatsToSend:t,unsentEntries:i}=eB(this._heartbeatsCache.heartbeats),r=Gp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Hs.warn(e),""}}}function DC(){return new Date().toISOString().substring(0,10)}function eB(n,e=Zz){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),MC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),MC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class tB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Vk()?BU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Yz(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return kC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return kC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function MC(n){return Gp(JSON.stringify({version:2,heartbeats:n})).length}function nB(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function iB(n){wl(new ea("platform-logger",e=>new pz(e),"PRIVATE")),wl(new ea("heartbeat",e=>new Jz(e),"PRIVATE")),ns(jv,PC,n),ns(jv,PC,"esm2020"),ns("fire-js","")}iB("");function Gk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rB=Gk,Wk=new lf("auth","Firebase",Gk());const Kp=new OE("@firebase/auth");function sB(n,...e){Kp.logLevel<=Ke.WARN&&Kp.warn(`Auth (${Dl}): ${n}`,...e)}function rp(n,...e){Kp.logLevel<=Ke.ERROR&&Kp.error(`Auth (${Dl}): ${n}`,...e)}function rs(n,...e){throw UE(n,...e)}function Er(n,...e){return UE(n,...e)}function jE(n,e,t){const i={...rB(),[e]:t};return new lf("auth","Firebase",i).create(e,{appName:n.name})}function ol(n){return jE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oB(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&rs(n,"argument-error"),jE(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function UE(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Wk.create(n,...e)}function Oe(n,e,...t){if(!n)throw UE(e,...t)}function Os(n){const e="INTERNAL ASSERTION FAILED: "+n;throw rp(e),new Error(e)}function Xs(n,e){n||Os(e)}function Bv(){return typeof self<"u"&&self.location?.href||""}function aB(){return NC()==="http:"||NC()==="https:"}function NC(){return typeof self<"u"&&self.location?.protocol||null}function lB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aB()||jU()||"connection"in navigator)?navigator.onLine:!0}function uB(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class cf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xs(t>e,"Short delay should be less than long delay!"),this.isMobile=VU()||UU()}get(){return lB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function zE(n,e){Xs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Kk{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const cB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const hB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],dB=new cf(3e4,6e4);function BE(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Dc(n,e,t,i,r={}){return $k(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=uf({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:c,...s};return FU()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&kl(n.emulatorConfig.host)&&(h.credentials="include"),Kk.fetch()(await Hk(n,n.config.apiHost,t,l),h)})}async function $k(n,e,t){n._canInitEmulator=!1;const i={...cB,...e};try{const r=new gB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,h]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gg(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Gg(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Gg(n,"user-disabled",o);const f=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw jE(n,f,h);rs(n,f)}}catch(r){if(r instanceof cs)throw r;rs(n,"network-request-failed",{message:String(r)})}}async function fB(n,e,t,i,r={}){const s=await Dc(n,e,t,i,r);return"mfaPendingCredential"in s&&rs(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Hk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?zE(n.config,r):`${n.config.apiScheme}://${r}`;return hB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class gB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Er(this.auth,"network-request-failed")),dB.get())})}}function Gg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Er(n,e,i);return r.customData._tokenResponse=t,r}async function pB(n,e){return Dc(n,"POST","/v1/accounts:delete",e)}async function $p(n,e){return Dc(n,"POST","/v1/accounts:lookup",e)}function nd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mB(n,e=!1){const t=Qs(n),i=await t.getIdToken(e),r=GE(i);Oe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:nd(F0(r.auth_time)),issuedAtTime:nd(F0(r.iat)),expirationTime:nd(F0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function F0(n){return Number(n)*1e3}function GE(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return rp("JWT malformed, contained fewer than 3 sections"),null;try{const r=Rk(t);return r?JSON.parse(r):(rp("Failed to decode base64 JWT payload"),null)}catch(r){return rp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function LC(n){const e=GE(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Nd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof cs&&yB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function yB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class _B{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Gv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Hp(n){const e=n.auth,t=await n.getIdToken(),i=await Nd(n,$p(e,{idToken:t}));Oe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?Xk(r.providerUserInfo):[],o=wB(n.providerData,s),l=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!o?.length,h=l?c:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Gv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function vB(n){const e=Qs(n);await Hp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function wB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Xk(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function EB(n,e){const t=await $k(n,{},async()=>{const i=uf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await Hk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:i};return n.emulatorConfig&&kl(n.emulatorConfig.host)&&(c.credentials="include"),Kk.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function xB(n,e){return Dc(n,"POST","/v2/accounts:revokeToken",BE(n,e))}class Yu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=LC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await EB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Yu;return i&&(Oe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Oe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Oe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yu,this.toJSON())}_performRefresh(){return Os("not implemented")}}function Po(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class mr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new _B(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Gv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Nd(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return mB(this,e)}reload(){return vB(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Hp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ki(this.auth.app))return Promise.reject(ol(this.auth));const e=await this.getIdToken();return await Nd(this,pB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,c=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:y,isAnonymous:E,providerData:x,stsTokenManager:C}=t;Oe(m&&C,e,"internal-error");const T=Yu.fromJSON(this.name,C);Oe(typeof m=="string",e,"internal-error"),Po(i,e.name),Po(r,e.name),Oe(typeof y=="boolean",e,"internal-error"),Oe(typeof E=="boolean",e,"internal-error"),Po(s,e.name),Po(o,e.name),Po(l,e.name),Po(c,e.name),Po(h,e.name),Po(f,e.name);const b=new mr({uid:m,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:E,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:T,createdAt:h,lastLoginAt:f});return x&&Array.isArray(x)&&(b.providerData=x.map(P=>({...P}))),c&&(b._redirectEventId=c),b}static async _fromIdTokenResponse(e,t,i=!1){const r=new Yu;r.updateFromServerResponse(t);const s=new mr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Hp(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Oe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?Xk(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Yu;l.updateFromIdToken(i);const c=new mr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Gv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(c,h),c}}const OC=new Map;function Vs(n){Xs(n instanceof Function,"Expected a class definition");let e=OC.get(n);return e?(Xs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,OC.set(n,e),e)}class qk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}qk.type="NONE";const VC=qk;function sp(n,e,t){return`firebase:${n}:${e}:${t}`}class Zu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=sp(this.userKey,r.apiKey,s),this.fullPersistenceKey=sp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await $p(this.auth,{idToken:e}).catch(()=>{});return t?mr._fromGetAccountInfoResponse(this.auth,t,e):null}return mr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Zu(Vs(VC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Vs(VC);const o=sp(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let m;if(typeof f=="string"){const y=await $p(e,{idToken:f}).catch(()=>{});if(!y)break;m=await mr._fromGetAccountInfoResponse(e,y,f)}else m=mr._fromJSON(e,f);h!==s&&(l=m),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Zu(s,e,i):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Zu(s,e,i))}}function FC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Yk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(t2(e))return"Blackberry";if(n2(e))return"Webos";if(Zk(e))return"Safari";if((e.includes("chrome/")||Qk(e))&&!e.includes("edge/"))return"Chrome";if(e2(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Yk(n=Jt()){return/firefox\//i.test(n)}function Zk(n=Jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qk(n=Jt()){return/crios\//i.test(n)}function Jk(n=Jt()){return/iemobile/i.test(n)}function e2(n=Jt()){return/android/i.test(n)}function t2(n=Jt()){return/blackberry/i.test(n)}function n2(n=Jt()){return/webos/i.test(n)}function WE(n=Jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function TB(n=Jt()){return WE(n)&&!!window.navigator?.standalone}function IB(){return zU()&&document.documentMode===10}function i2(n=Jt()){return WE(n)||e2(n)||n2(n)||t2(n)||/windows phone/i.test(n)||Jk(n)}function r2(n,e=[]){let t;switch(n){case"Browser":t=FC(Jt());break;case"Worker":t=`${FC(Jt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dl}/${i}`}class SB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function CB(n,e={}){return Dc(n,"GET","/v2/passwordPolicy",BE(n,e))}const RB=6;class AB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??RB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class PB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jC(this),this.idTokenSubscription=new jC(this),this.beforeStateQueue=new SB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Zu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await $p(this,{idToken:e}),i=await mr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ki(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Hp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ki(this.app))return Promise.reject(ol(this));const t=e?Qs(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ki(this.app)?Promise.reject(ol(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ki(this.app)?Promise.reject(ol(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CB(this),t=new AB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await xB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vs(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Zu.create(this,[Vs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=r2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&sB(`Error while retrieving App Check token: ${e.error}`),e?.token}}function $m(n){return Qs(n)}class jC{constructor(e){this.auth=e,this.observer=null,this.addObserver=HU(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let KE={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bB(n){KE=n}function kB(n){return KE.loadJS(n)}function DB(){return KE.gapiScript}function MB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function NB(n,e){const t=Km(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(vl(s,e??{}))return r;rs(r,"already-initialized")}return t.initialize({options:e})}function LB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function OB(n,e,t){const i=$m(n);Oe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=s2(e),{host:o,port:l}=VB(e),c=l===null?"":`:${l}`,h={url:`${s}//${o}${c}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Oe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Oe(vl(h,i.config.emulator)&&vl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,kl(o)?(NE(`${s}//${o}${c}`),LE("Auth",!0)):FB()}function s2(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function VB(n){const e=s2(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:UC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:UC(o)}}}function UC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function FB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class o2{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Os("not implemented")}_getIdTokenResponse(e){return Os("not implemented")}_linkToIdToken(e,t){return Os("not implemented")}_getReauthenticationResolver(e){return Os("not implemented")}}async function Qu(n,e){return fB(n,"POST","/v1/accounts:signInWithIdp",BE(n,e))}const jB="http://localhost";class El extends o2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new El(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):rs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new El(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Qu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Qu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qu(e,t)}buildRequest(){const e={requestUri:jB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=uf(t)}return e}}class $E{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hf extends $E{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Vo extends hf{constructor(){super("facebook.com")}static credential(e){return El._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vo.credential(e.oauthAccessToken)}catch{return null}}}Vo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vo.PROVIDER_ID="facebook.com";class Ns extends hf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return El._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ns.credential(t,i)}catch{return null}}}Ns.GOOGLE_SIGN_IN_METHOD="google.com";Ns.PROVIDER_ID="google.com";class Fo extends hf{constructor(){super("github.com")}static credential(e){return El._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fo.credential(e.oauthAccessToken)}catch{return null}}}Fo.GITHUB_SIGN_IN_METHOD="github.com";Fo.PROVIDER_ID="github.com";class jo extends hf{constructor(){super("twitter.com")}static credential(e,t){return El._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return jo.credential(t,i)}catch{return null}}}jo.TWITTER_SIGN_IN_METHOD="twitter.com";jo.PROVIDER_ID="twitter.com";class fc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await mr._fromIdTokenResponse(e,i,r),o=zC(i);return new fc({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=zC(i);return new fc({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function zC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Xp extends cs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Xp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Xp(e,t,i,r)}}function a2(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Xp._fromErrorAndOperation(n,s,e,i):s})}async function UB(n,e,t=!1){const i=await Nd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fc._forOperation(n,"link",i)}async function zB(n,e,t=!1){const{auth:i}=n;if(Ki(i.app))return Promise.reject(ol(i));const r="reauthenticate";try{const s=await Nd(n,a2(i,r,e,n),t);Oe(s.idToken,i,"internal-error");const o=GE(s.idToken);Oe(o,i,"internal-error");const{sub:l}=o;return Oe(n.uid===l,i,"user-mismatch"),fc._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&rs(i,"user-mismatch"),s}}async function BB(n,e,t=!1){if(Ki(n.app))return Promise.reject(ol(n));const i="signIn",r=await a2(n,i,e),s=await fc._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function GB(n,e,t,i){return Qs(n).onIdTokenChanged(e,t,i)}function WB(n,e,t){return Qs(n).beforeAuthStateChanged(e,t)}function KB(n,e,t,i){return Qs(n).onAuthStateChanged(e,t,i)}function $B(n){return Qs(n).signOut()}const qp="__sak";class l2{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qp,"1"),this.storage.removeItem(qp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const HB=1e3,XB=10;class u2 extends l2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=i2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);IB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,XB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},HB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}u2.type="LOCAL";const qB=u2;class c2 extends l2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}c2.type="SESSION";const h2=c2;function YB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Hm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Hm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),c=await YB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hm.receivers=[];function HE(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class ZB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const h=HE("",20);r.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(m){const y=m;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function is(){return window}function QB(n){is().location.href=n}function d2(){return typeof is().WorkerGlobalScope<"u"&&typeof is().importScripts=="function"}async function JB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function e9(){return navigator?.serviceWorker?.controller||null}function t9(){return d2()?self:null}const f2="firebaseLocalStorageDb",n9=1,Yp="firebaseLocalStorage",g2="fbase_key";class df{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Xm(n,e){return n.transaction([Yp],e?"readwrite":"readonly").objectStore(Yp)}function i9(){const n=indexedDB.deleteDatabase(f2);return new df(n).toPromise()}function Wv(){const n=indexedDB.open(f2,n9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Yp,{keyPath:g2})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Yp)?e(i):(i.close(),await i9(),e(await Wv()))})})}async function BC(n,e,t){const i=Xm(n,!0).put({[g2]:e,value:t});return new df(i).toPromise()}async function r9(n,e){const t=Xm(n,!1).get(e),i=await new df(t).toPromise();return i===void 0?null:i.value}function GC(n,e){const t=Xm(n,!0).delete(e);return new df(t).toPromise()}const s9=800,o9=3;class p2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>o9)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return d2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hm._getInstance(t9()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await JB(),!this.activeServiceWorker)return;this.sender=new ZB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||e9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wv();return await BC(e,qp,"1"),await GC(e,qp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>BC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>r9(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>GC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Xm(r,!1).getAll();return new df(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),s9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}p2.type="LOCAL";const a9=p2;new cf(3e4,6e4);function m2(n,e){return e?Vs(e):(Oe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class XE extends o2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function l9(n){return BB(n.auth,new XE(n),n.bypassAuthState)}function u9(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),zB(t,new XE(n),n.bypassAuthState)}async function c9(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),UB(t,new XE(n),n.bypassAuthState)}class y2{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return l9;case"linkViaPopup":case"linkViaRedirect":return c9;case"reauthViaPopup":case"reauthViaRedirect":return u9;default:rs(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const h9=new cf(2e3,1e4);async function d9(n,e,t){if(Ki(n.app))return Promise.reject(Er(n,"operation-not-supported-in-this-environment"));const i=$m(n);oB(n,e,$E);const r=m2(i,t);return new el(i,"signInViaPopup",e,r).executeNotNull()}class el extends y2{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,el.currentPopupAction&&el.currentPopupAction.cancel(),el.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=HE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,el.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,h9.get())};e()}}el.currentPopupAction=null;const f9="pendingRedirect",op=new Map;class g9 extends y2{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=op.get(this.auth._key());if(!e){try{const i=await p9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}op.set(this.auth._key(),e)}return this.bypassAuthState||op.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function p9(n,e){const t=_9(e),i=y9(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function m9(n,e){op.set(n._key(),e)}function y9(n){return Vs(n._redirectPersistence)}function _9(n){return sp(f9,n.config.apiKey,n.name)}async function v9(n,e,t=!1){if(Ki(n.app))return Promise.reject(ol(n));const i=$m(n),r=m2(i,e),o=await new g9(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const w9=600*1e3;class E9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!x9(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!_2(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Er(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=w9&&this.cachedEventUids.clear(),this.cachedEventUids.has(WC(e))}saveEventToCache(e){this.cachedEventUids.add(WC(e)),this.lastProcessedEventTime=Date.now()}}function WC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function _2({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function x9(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _2(n);default:return!1}}async function T9(n,e={}){return Dc(n,"GET","/v1/projects",e)}const I9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,S9=/^https?/;async function C9(n){if(n.config.emulator)return;const{authorizedDomains:e}=await T9(n);for(const t of e)try{if(R9(t))return}catch{}rs(n,"unauthorized-domain")}function R9(n){const e=Bv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!S9.test(t))return!1;if(I9.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const A9=new cf(3e4,6e4);function KC(){const n=is().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function P9(n){return new Promise((e,t)=>{function i(){KC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{KC(),t(Er(n,"network-request-failed"))},timeout:A9.get()})}if(is().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(is().gapi?.load)i();else{const r=MB("iframefcb");return is()[r]=()=>{gapi.load?i():t(Er(n,"network-request-failed"))},kB(`${DB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw ap=null,e})}let ap=null;function b9(n){return ap=ap||P9(n),ap}const k9=new cf(5e3,15e3),D9="__/auth/iframe",M9="emulator/auth/iframe",N9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},L9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O9(n){const e=n.config;Oe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?zE(e,M9):`https://${n.config.authDomain}/${D9}`,i={apiKey:e.apiKey,appName:n.name,v:Dl},r=L9.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${uf(i).slice(1)}`}async function V9(n){const e=await b9(n),t=is().gapi;return Oe(t,n,"internal-error"),e.open({where:document.body,url:O9(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:N9,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Er(n,"network-request-failed"),l=is().setTimeout(()=>{s(o)},k9.get());function c(){is().clearTimeout(l),r(i)}i.ping(c).then(c,()=>{s(o)})}))}const F9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},j9=500,U9=600,z9="_blank",B9="http://localhost";class $C{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function G9(n,e,t,i=j9,r=U9){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const c={...F9,width:i.toString(),height:r.toString(),top:s,left:o},h=Jt().toLowerCase();t&&(l=Qk(h)?z9:t),Yk(h)&&(e=e||B9,c.scrollbars="yes");const f=Object.entries(c).reduce((y,[E,x])=>`${y}${E}=${x},`,"");if(TB(h)&&l!=="_self")return W9(e||"",l),new $C(null);const m=window.open(e||"",l,f);Oe(m,n,"popup-blocked");try{m.focus()}catch{}return new $C(m)}function W9(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const K9="__/auth/handler",$9="emulator/auth/handler",H9=encodeURIComponent("fac");async function HC(n,e,t,i,r,s){Oe(n.config.authDomain,n,"auth-domain-config-required"),Oe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Dl,eventId:r};if(e instanceof $E){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",$U(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof hf){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await n._getAppCheckToken(),h=c?`#${H9}=${encodeURIComponent(c)}`:"";return`${X9(n)}?${uf(l).slice(1)}${h}`}function X9({config:n}){return n.emulator?zE(n,$9):`https://${n.authDomain}/${K9}`}const j0="webStorageSupport";class q9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=h2,this._completeRedirectFn=v9,this._overrideRedirectResult=m9}async _openPopup(e,t,i,r){Xs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await HC(e,t,i,Bv(),r);return G9(e,s,HE())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await HC(e,t,i,Bv(),r);return QB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Xs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await V9(e),i=new E9(e);return t.register("authEvent",r=>(Oe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(j0,{type:j0},r=>{const s=r?.[0]?.[j0];s!==void 0&&t(!!s),rs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=C9(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return i2()||Zk()||WE()}}const Y9=q9;var XC="@firebase/auth",qC="1.12.0";class Z9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Q9(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function J9(n){wl(new ea("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Oe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:r2(n)},h=new PB(i,r,s,c);return LB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),wl(new ea("auth-internal",e=>{const t=$m(e.getProvider("auth").getImmediate());return(i=>new Z9(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ns(XC,qC,Q9(n)),ns(XC,qC,"esm2020")}const eG=300,tG=Dk("authIdTokenMaxAge")||eG;let YC=null;const nG=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>tG)return;const r=t?.token;YC!==r&&(YC=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function iG(n=FE()){const e=Km(n,"auth");if(e.isInitialized())return e.getImmediate();const t=NB(n,{popupRedirectResolver:Y9,persistence:[a9,qB,h2]}),i=Dk("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=nG(s.toString());WB(t,o,()=>o(t.currentUser)),GB(t,l=>o(l))}}const r=Pk("auth");return r&&OB(t,`http://${r}`),t}function rG(){return document.getElementsByTagName("head")?.[0]??document}bB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Er("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",rG().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});J9("Browser");var sG="firebase",oG="12.7.0";ns(sG,oG,"app");var ZC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qE;(function(){var n;function e(D,R){function M(){}M.prototype=R.prototype,D.F=R.prototype,D.prototype=new M,D.prototype.constructor=D,D.D=function(V,j,z){for(var L=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)L[ae-2]=arguments[ae];return R.prototype[j].apply(V,L)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(D,R,M){M||(M=0);const V=Array(16);if(typeof R=="string")for(var j=0;j<16;++j)V[j]=R.charCodeAt(M++)|R.charCodeAt(M++)<<8|R.charCodeAt(M++)<<16|R.charCodeAt(M++)<<24;else for(j=0;j<16;++j)V[j]=R[M++]|R[M++]<<8|R[M++]<<16|R[M++]<<24;R=D.g[0],M=D.g[1],j=D.g[2];let z=D.g[3],L;L=R+(z^M&(j^z))+V[0]+3614090360&4294967295,R=M+(L<<7&4294967295|L>>>25),L=z+(j^R&(M^j))+V[1]+3905402710&4294967295,z=R+(L<<12&4294967295|L>>>20),L=j+(M^z&(R^M))+V[2]+606105819&4294967295,j=z+(L<<17&4294967295|L>>>15),L=M+(R^j&(z^R))+V[3]+3250441966&4294967295,M=j+(L<<22&4294967295|L>>>10),L=R+(z^M&(j^z))+V[4]+4118548399&4294967295,R=M+(L<<7&4294967295|L>>>25),L=z+(j^R&(M^j))+V[5]+1200080426&4294967295,z=R+(L<<12&4294967295|L>>>20),L=j+(M^z&(R^M))+V[6]+2821735955&4294967295,j=z+(L<<17&4294967295|L>>>15),L=M+(R^j&(z^R))+V[7]+4249261313&4294967295,M=j+(L<<22&4294967295|L>>>10),L=R+(z^M&(j^z))+V[8]+1770035416&4294967295,R=M+(L<<7&4294967295|L>>>25),L=z+(j^R&(M^j))+V[9]+2336552879&4294967295,z=R+(L<<12&4294967295|L>>>20),L=j+(M^z&(R^M))+V[10]+4294925233&4294967295,j=z+(L<<17&4294967295|L>>>15),L=M+(R^j&(z^R))+V[11]+2304563134&4294967295,M=j+(L<<22&4294967295|L>>>10),L=R+(z^M&(j^z))+V[12]+1804603682&4294967295,R=M+(L<<7&4294967295|L>>>25),L=z+(j^R&(M^j))+V[13]+4254626195&4294967295,z=R+(L<<12&4294967295|L>>>20),L=j+(M^z&(R^M))+V[14]+2792965006&4294967295,j=z+(L<<17&4294967295|L>>>15),L=M+(R^j&(z^R))+V[15]+1236535329&4294967295,M=j+(L<<22&4294967295|L>>>10),L=R+(j^z&(M^j))+V[1]+4129170786&4294967295,R=M+(L<<5&4294967295|L>>>27),L=z+(M^j&(R^M))+V[6]+3225465664&4294967295,z=R+(L<<9&4294967295|L>>>23),L=j+(R^M&(z^R))+V[11]+643717713&4294967295,j=z+(L<<14&4294967295|L>>>18),L=M+(z^R&(j^z))+V[0]+3921069994&4294967295,M=j+(L<<20&4294967295|L>>>12),L=R+(j^z&(M^j))+V[5]+3593408605&4294967295,R=M+(L<<5&4294967295|L>>>27),L=z+(M^j&(R^M))+V[10]+38016083&4294967295,z=R+(L<<9&4294967295|L>>>23),L=j+(R^M&(z^R))+V[15]+3634488961&4294967295,j=z+(L<<14&4294967295|L>>>18),L=M+(z^R&(j^z))+V[4]+3889429448&4294967295,M=j+(L<<20&4294967295|L>>>12),L=R+(j^z&(M^j))+V[9]+568446438&4294967295,R=M+(L<<5&4294967295|L>>>27),L=z+(M^j&(R^M))+V[14]+3275163606&4294967295,z=R+(L<<9&4294967295|L>>>23),L=j+(R^M&(z^R))+V[3]+4107603335&4294967295,j=z+(L<<14&4294967295|L>>>18),L=M+(z^R&(j^z))+V[8]+1163531501&4294967295,M=j+(L<<20&4294967295|L>>>12),L=R+(j^z&(M^j))+V[13]+2850285829&4294967295,R=M+(L<<5&4294967295|L>>>27),L=z+(M^j&(R^M))+V[2]+4243563512&4294967295,z=R+(L<<9&4294967295|L>>>23),L=j+(R^M&(z^R))+V[7]+1735328473&4294967295,j=z+(L<<14&4294967295|L>>>18),L=M+(z^R&(j^z))+V[12]+2368359562&4294967295,M=j+(L<<20&4294967295|L>>>12),L=R+(M^j^z)+V[5]+4294588738&4294967295,R=M+(L<<4&4294967295|L>>>28),L=z+(R^M^j)+V[8]+2272392833&4294967295,z=R+(L<<11&4294967295|L>>>21),L=j+(z^R^M)+V[11]+1839030562&4294967295,j=z+(L<<16&4294967295|L>>>16),L=M+(j^z^R)+V[14]+4259657740&4294967295,M=j+(L<<23&4294967295|L>>>9),L=R+(M^j^z)+V[1]+2763975236&4294967295,R=M+(L<<4&4294967295|L>>>28),L=z+(R^M^j)+V[4]+1272893353&4294967295,z=R+(L<<11&4294967295|L>>>21),L=j+(z^R^M)+V[7]+4139469664&4294967295,j=z+(L<<16&4294967295|L>>>16),L=M+(j^z^R)+V[10]+3200236656&4294967295,M=j+(L<<23&4294967295|L>>>9),L=R+(M^j^z)+V[13]+681279174&4294967295,R=M+(L<<4&4294967295|L>>>28),L=z+(R^M^j)+V[0]+3936430074&4294967295,z=R+(L<<11&4294967295|L>>>21),L=j+(z^R^M)+V[3]+3572445317&4294967295,j=z+(L<<16&4294967295|L>>>16),L=M+(j^z^R)+V[6]+76029189&4294967295,M=j+(L<<23&4294967295|L>>>9),L=R+(M^j^z)+V[9]+3654602809&4294967295,R=M+(L<<4&4294967295|L>>>28),L=z+(R^M^j)+V[12]+3873151461&4294967295,z=R+(L<<11&4294967295|L>>>21),L=j+(z^R^M)+V[15]+530742520&4294967295,j=z+(L<<16&4294967295|L>>>16),L=M+(j^z^R)+V[2]+3299628645&4294967295,M=j+(L<<23&4294967295|L>>>9),L=R+(j^(M|~z))+V[0]+4096336452&4294967295,R=M+(L<<6&4294967295|L>>>26),L=z+(M^(R|~j))+V[7]+1126891415&4294967295,z=R+(L<<10&4294967295|L>>>22),L=j+(R^(z|~M))+V[14]+2878612391&4294967295,j=z+(L<<15&4294967295|L>>>17),L=M+(z^(j|~R))+V[5]+4237533241&4294967295,M=j+(L<<21&4294967295|L>>>11),L=R+(j^(M|~z))+V[12]+1700485571&4294967295,R=M+(L<<6&4294967295|L>>>26),L=z+(M^(R|~j))+V[3]+2399980690&4294967295,z=R+(L<<10&4294967295|L>>>22),L=j+(R^(z|~M))+V[10]+4293915773&4294967295,j=z+(L<<15&4294967295|L>>>17),L=M+(z^(j|~R))+V[1]+2240044497&4294967295,M=j+(L<<21&4294967295|L>>>11),L=R+(j^(M|~z))+V[8]+1873313359&4294967295,R=M+(L<<6&4294967295|L>>>26),L=z+(M^(R|~j))+V[15]+4264355552&4294967295,z=R+(L<<10&4294967295|L>>>22),L=j+(R^(z|~M))+V[6]+2734768916&4294967295,j=z+(L<<15&4294967295|L>>>17),L=M+(z^(j|~R))+V[13]+1309151649&4294967295,M=j+(L<<21&4294967295|L>>>11),L=R+(j^(M|~z))+V[4]+4149444226&4294967295,R=M+(L<<6&4294967295|L>>>26),L=z+(M^(R|~j))+V[11]+3174756917&4294967295,z=R+(L<<10&4294967295|L>>>22),L=j+(R^(z|~M))+V[2]+718787259&4294967295,j=z+(L<<15&4294967295|L>>>17),L=M+(z^(j|~R))+V[9]+3951481745&4294967295,D.g[0]=D.g[0]+R&4294967295,D.g[1]=D.g[1]+(j+(L<<21&4294967295|L>>>11))&4294967295,D.g[2]=D.g[2]+j&4294967295,D.g[3]=D.g[3]+z&4294967295}i.prototype.v=function(D,R){R===void 0&&(R=D.length);const M=R-this.blockSize,V=this.C;let j=this.h,z=0;for(;z<R;){if(j==0)for(;z<=M;)r(this,D,z),z+=this.blockSize;if(typeof D=="string"){for(;z<R;)if(V[j++]=D.charCodeAt(z++),j==this.blockSize){r(this,V),j=0;break}}else for(;z<R;)if(V[j++]=D[z++],j==this.blockSize){r(this,V),j=0;break}}this.h=j,this.o+=R},i.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var R=1;R<D.length-8;++R)D[R]=0;R=this.o*8;for(var M=D.length-8;M<D.length;++M)D[M]=R&255,R/=256;for(this.v(D),D=Array(16),R=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)D[R++]=this.g[M]>>>V&255;return D};function s(D,R){var M=l;return Object.prototype.hasOwnProperty.call(M,D)?M[D]:M[D]=R(D)}function o(D,R){this.h=R;const M=[];let V=!0;for(let j=D.length-1;j>=0;j--){const z=D[j]|0;V&&z==R||(M[j]=z,V=!1)}this.g=M}var l={};function c(D){return-128<=D&&D<128?s(D,function(R){return new o([R|0],R<0?-1:0)}):new o([D|0],D<0?-1:0)}function h(D){if(isNaN(D)||!isFinite(D))return m;if(D<0)return T(h(-D));const R=[];let M=1;for(let V=0;D>=M;V++)R[V]=D/M|0,M*=4294967296;return new o(R,0)}function f(D,R){if(D.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(D.charAt(0)=="-")return T(f(D.substring(1),R));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=h(Math.pow(R,8));let V=m;for(let z=0;z<D.length;z+=8){var j=Math.min(8,D.length-z);const L=parseInt(D.substring(z,z+j),R);j<8?(j=h(Math.pow(R,j)),V=V.j(j).add(h(L))):(V=V.j(M),V=V.add(h(L)))}return V}var m=c(0),y=c(1),E=c(16777216);n=o.prototype,n.m=function(){if(C(this))return-T(this).m();let D=0,R=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);D+=(V>=0?V:4294967296+V)*R,R*=4294967296}return D},n.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(x(this))return"0";if(C(this))return"-"+T(this).toString(D);const R=h(Math.pow(D,6));var M=this;let V="";for(;;){const j=O(M,R).g;M=b(M,j.j(R));let z=((M.g.length>0?M.g[0]:M.h)>>>0).toString(D);if(M=j,x(M))return z+V;for(;z.length<6;)z="0"+z;V=z+V}},n.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function x(D){if(D.h!=0)return!1;for(let R=0;R<D.g.length;R++)if(D.g[R]!=0)return!1;return!0}function C(D){return D.h==-1}n.l=function(D){return D=b(this,D),C(D)?-1:x(D)?0:1};function T(D){const R=D.g.length,M=[];for(let V=0;V<R;V++)M[V]=~D.g[V];return new o(M,~D.h).add(y)}n.abs=function(){return C(this)?T(this):this},n.add=function(D){const R=Math.max(this.g.length,D.g.length),M=[];let V=0;for(let j=0;j<=R;j++){let z=V+(this.i(j)&65535)+(D.i(j)&65535),L=(z>>>16)+(this.i(j)>>>16)+(D.i(j)>>>16);V=L>>>16,z&=65535,L&=65535,M[j]=L<<16|z}return new o(M,M[M.length-1]&-2147483648?-1:0)};function b(D,R){return D.add(T(R))}n.j=function(D){if(x(this)||x(D))return m;if(C(this))return C(D)?T(this).j(T(D)):T(T(this).j(D));if(C(D))return T(this.j(T(D)));if(this.l(E)<0&&D.l(E)<0)return h(this.m()*D.m());const R=this.g.length+D.g.length,M=[];for(var V=0;V<2*R;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let j=0;j<D.g.length;j++){const z=this.i(V)>>>16,L=this.i(V)&65535,ae=D.i(j)>>>16,pe=D.i(j)&65535;M[2*V+2*j]+=L*pe,P(M,2*V+2*j),M[2*V+2*j+1]+=z*pe,P(M,2*V+2*j+1),M[2*V+2*j+1]+=L*ae,P(M,2*V+2*j+1),M[2*V+2*j+2]+=z*ae,P(M,2*V+2*j+2)}for(D=0;D<R;D++)M[D]=M[2*D+1]<<16|M[2*D];for(D=R;D<2*R;D++)M[D]=0;return new o(M,0)};function P(D,R){for(;(D[R]&65535)!=D[R];)D[R+1]+=D[R]>>>16,D[R]&=65535,R++}function k(D,R){this.g=D,this.h=R}function O(D,R){if(x(R))throw Error("division by zero");if(x(D))return new k(m,m);if(C(D))return R=O(T(D),R),new k(T(R.g),T(R.h));if(C(R))return R=O(D,T(R)),new k(T(R.g),R.h);if(D.g.length>30){if(C(D)||C(R))throw Error("slowDivide_ only works with positive integers.");for(var M=y,V=R;V.l(D)<=0;)M=F(M),V=F(V);var j=W(M,1),z=W(V,1);for(V=W(V,2),M=W(M,2);!x(V);){var L=z.add(V);L.l(D)<=0&&(j=j.add(M),z=L),V=W(V,1),M=W(M,1)}return R=b(D,j.j(R)),new k(j,R)}for(j=m;D.l(R)>=0;){for(M=Math.max(1,Math.floor(D.m()/R.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),z=h(M),L=z.j(R);C(L)||L.l(D)>0;)M-=V,z=h(M),L=z.j(R);x(z)&&(z=y),j=j.add(z),D=b(D,L)}return new k(j,D)}n.B=function(D){return O(this,D).h},n.and=function(D){const R=Math.max(this.g.length,D.g.length),M=[];for(let V=0;V<R;V++)M[V]=this.i(V)&D.i(V);return new o(M,this.h&D.h)},n.or=function(D){const R=Math.max(this.g.length,D.g.length),M=[];for(let V=0;V<R;V++)M[V]=this.i(V)|D.i(V);return new o(M,this.h|D.h)},n.xor=function(D){const R=Math.max(this.g.length,D.g.length),M=[];for(let V=0;V<R;V++)M[V]=this.i(V)^D.i(V);return new o(M,this.h^D.h)};function F(D){const R=D.g.length+1,M=[];for(let V=0;V<R;V++)M[V]=D.i(V)<<1|D.i(V-1)>>>31;return new o(M,D.h)}function W(D,R){const M=R>>5;R%=32;const V=D.g.length-M,j=[];for(let z=0;z<V;z++)j[z]=R>0?D.i(z+M)>>>R|D.i(z+M+1)<<32-R:D.i(z+M);return new o(j,D.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,qE=o}).apply(typeof ZC<"u"?ZC:typeof self<"u"?self:typeof window<"u"?window:{});var Wg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var v2,Hh,w2,lp,Kv,E2,x2,T2;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wg=="object"&&Wg];for(var w=0;w<g.length;++w){var I=g[w];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=t(this);function r(g,w){if(w)e:{var I=i;g=g.split(".");for(var N=0;N<g.length-1;N++){var X=g[N];if(!(X in I))break e;I=I[X]}g=g[g.length-1],N=I[g],w=w(N),w!=N&&w!=null&&e(I,g,{configurable:!0,writable:!0,value:w})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(w){var I=[],N;for(N in w)Object.prototype.hasOwnProperty.call(w,N)&&I.push([N,w[N]]);return I}});var s=s||{},o=this||self;function l(g){var w=typeof g;return w=="object"&&g!=null||w=="function"}function c(g,w,I){return g.call.apply(g.bind,arguments)}function h(g,w,I){return h=c,h.apply(null,arguments)}function f(g,w){var I=Array.prototype.slice.call(arguments,1);return function(){var N=I.slice();return N.push.apply(N,arguments),g.apply(this,N)}}function m(g,w){function I(){}I.prototype=w.prototype,g.Z=w.prototype,g.prototype=new I,g.prototype.constructor=g,g.Ob=function(N,X,Q){for(var he=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)he[Fe-2]=arguments[Fe];return w.prototype[X].apply(N,he)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function E(g){const w=g.length;if(w>0){const I=Array(w);for(let N=0;N<w;N++)I[N]=g[N];return I}return[]}function x(g,w){for(let N=1;N<arguments.length;N++){const X=arguments[N];var I=typeof X;if(I=I!="object"?I:X?Array.isArray(X)?"array":I:"null",I=="array"||I=="object"&&typeof X.length=="number"){I=g.length||0;const Q=X.length||0;g.length=I+Q;for(let he=0;he<Q;he++)g[I+he]=X[he]}else g.push(X)}}class C{constructor(w,I){this.i=w,this.j=I,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function T(g){o.setTimeout(()=>{throw g},0)}function b(){var g=D;let w=null;return g.g&&(w=g.g,g.g=g.g.next,g.g||(g.h=null),w.next=null),w}class P{constructor(){this.h=this.g=null}add(w,I){const N=k.get();N.set(w,I),this.h?this.h.next=N:this.g=N,this.h=N}}var k=new C(()=>new O,g=>g.reset());class O{constructor(){this.next=this.g=this.h=null}set(w,I){this.h=w,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let F,W=!1,D=new P,R=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(M)}};function M(){for(var g;g=b();){try{g.h.call(g.g)}catch(I){T(I)}var w=k;w.j(g),w.h<100&&(w.h++,g.next=w.g,w.g=g)}W=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,w){this.type=g,this.g=this.target=w,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,w=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const I=()=>{};o.addEventListener("test",I,w),o.removeEventListener("test",I,w)}catch{}return g})();function L(g){return/^[\s\xa0]*$/.test(g)}function ae(g,w){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,w)}m(ae,j),ae.prototype.init=function(g,w){const I=this.type=g.type,N=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=w,w=g.relatedTarget,w||(I=="mouseover"?w=g.fromElement:I=="mouseout"&&(w=g.toElement)),this.relatedTarget=w,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var pe="closure_listenable_"+(Math.random()*1e6|0),fe=0;function ce(g,w,I,N,X){this.listener=g,this.proxy=null,this.src=w,this.type=I,this.capture=!!N,this.ha=X,this.key=++fe,this.da=this.fa=!1}function J(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function oe(g,w,I){for(const N in g)w.call(I,g[N],N,g)}function ne(g,w){for(const I in g)w.call(void 0,g[I],I,g)}function G(g){const w={};for(const I in g)w[I]=g[I];return w}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xe(g,w){let I,N;for(let X=1;X<arguments.length;X++){N=arguments[X];for(I in N)g[I]=N[I];for(let Q=0;Q<$.length;Q++)I=$[Q],Object.prototype.hasOwnProperty.call(N,I)&&(g[I]=N[I])}}function Te(g){this.src=g,this.g={},this.h=0}Te.prototype.add=function(g,w,I,N,X){const Q=g.toString();g=this.g[Q],g||(g=this.g[Q]=[],this.h++);const he=be(g,w,N,X);return he>-1?(w=g[he],I||(w.fa=!1)):(w=new ce(w,this.src,Q,!!N,X),w.fa=I,g.push(w)),w};function Ie(g,w){const I=w.type;if(I in g.g){var N=g.g[I],X=Array.prototype.indexOf.call(N,w,void 0),Q;(Q=X>=0)&&Array.prototype.splice.call(N,X,1),Q&&(J(w),g.g[I].length==0&&(delete g.g[I],g.h--))}}function be(g,w,I,N){for(let X=0;X<g.length;++X){const Q=g[X];if(!Q.da&&Q.listener==w&&Q.capture==!!I&&Q.ha==N)return X}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),Ve={};function Be(g,w,I,N,X){if(Array.isArray(w)){for(let Q=0;Q<w.length;Q++)Be(g,w[Q],I,N,X);return null}return I=Ri(I),g&&g[pe]?g.J(w,I,l(N)?!!N.capture:!1,X):lt(g,w,I,!1,N,X)}function lt(g,w,I,N,X,Q){if(!w)throw Error("Invalid event type");const he=l(X)?!!X.capture:!!X;let Fe=hn(g);if(Fe||(g[Me]=Fe=new Te(g)),I=Fe.add(w,I,N,he,Q),I.proxy)return I;if(N=Qi(),I.proxy=N,N.src=g,N.listener=I,g.addEventListener)z||(X=he),X===void 0&&(X=!1),g.addEventListener(w.toString(),N,X);else if(g.attachEvent)g.attachEvent(Wn(w.toString()),N);else if(g.addListener&&g.removeListener)g.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Qi(){function g(I){return w.call(g.src,g.listener,I)}const w=cn;return g}function ds(g,w,I,N,X){if(Array.isArray(w))for(var Q=0;Q<w.length;Q++)ds(g,w[Q],I,N,X);else N=l(N)?!!N.capture:!!N,I=Ri(I),g&&g[pe]?(g=g.i,Q=String(w).toString(),Q in g.g&&(w=g.g[Q],I=be(w,I,N,X),I>-1&&(J(w[I]),Array.prototype.splice.call(w,I,1),w.length==0&&(delete g.g[Q],g.h--)))):g&&(g=hn(g))&&(w=g.g[w.toString()],g=-1,w&&(g=be(w,I,N,X)),(I=g>-1?w[g]:null)&&Gn(I))}function Gn(g){if(typeof g!="number"&&g&&!g.da){var w=g.src;if(w&&w[pe])Ie(w.i,g);else{var I=g.type,N=g.proxy;w.removeEventListener?w.removeEventListener(I,N,g.capture):w.detachEvent?w.detachEvent(Wn(I),N):w.addListener&&w.removeListener&&w.removeListener(N),(I=hn(w))?(Ie(I,g),I.h==0&&(I.src=null,w[Me]=null)):J(g)}}}function Wn(g){return g in Ve?Ve[g]:Ve[g]="on"+g}function cn(g,w){if(g.da)g=!0;else{w=new ae(w,this);const I=g.listener,N=g.ha||g.src;g.fa&&Gn(g),g=I.call(N,w)}return g}function hn(g){return g=g[Me],g instanceof Te?g:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ri(g){return typeof g=="function"?g:(g[Kn]||(g[Kn]=function(w){return g.handleEvent(w)}),g[Kn])}function yt(){V.call(this),this.i=new Te(this),this.M=this,this.G=null}m(yt,V),yt.prototype[pe]=!0,yt.prototype.removeEventListener=function(g,w,I,N){ds(this,g,w,I,N)};function ut(g,w){var I,N=g.G;if(N)for(I=[];N;N=N.G)I.push(N);if(g=g.M,N=w.type||w,typeof w=="string")w=new j(w,g);else if(w instanceof j)w.target=w.target||g;else{var X=w;w=new j(N,g),xe(w,X)}X=!0;let Q,he;if(I)for(he=I.length-1;he>=0;he--)Q=w.g=I[he],X=tn(Q,N,!0,w)&&X;if(Q=w.g=g,X=tn(Q,N,!0,w)&&X,X=tn(Q,N,!1,w)&&X,I)for(he=0;he<I.length;he++)Q=w.g=I[he],X=tn(Q,N,!1,w)&&X}yt.prototype.N=function(){if(yt.Z.N.call(this),this.i){var g=this.i;for(const w in g.g){const I=g.g[w];for(let N=0;N<I.length;N++)J(I[N]);delete g.g[w],g.h--}}this.G=null},yt.prototype.J=function(g,w,I,N){return this.i.add(String(g),w,!1,I,N)},yt.prototype.K=function(g,w,I,N){return this.i.add(String(g),w,!0,I,N)};function tn(g,w,I,N){if(w=g.i.g[String(w)],!w)return!0;w=w.concat();let X=!0;for(let Q=0;Q<w.length;++Q){const he=w[Q];if(he&&!he.da&&he.capture==I){const Fe=he.listener,Ft=he.ha||he.src;he.fa&&Ie(g.i,he),X=Fe.call(Ft,N)!==!1&&X}}return X&&!N.defaultPrevented}function Ai(g,w){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:o.setTimeout(g,w||0)}function It(g){g.g=Ai(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const w=g.h;g.h=null,g.m.apply(null,w)}class Js extends V{constructor(w,I){super(),this.m=w,this.l=I,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pi(g){V.call(this),this.h=g,this.g={}}m(Pi,V);var Sr=[];function Ji(g){oe(g.g,function(w,I){this.g.hasOwnProperty(I)&&Gn(w)},g),g.g={}}Pi.prototype.N=function(){Pi.Z.N.call(this),Ji(this)},Pi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cr=o.JSON.stringify,la=o.JSON.parse,Rr=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function bi(){}function Ll(){}var Ar={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fs(){j.call(this,"d")}m(fs,j);function eo(){j.call(this,"c")}m(eo,j);var Ln={},gs=null;function Pr(){return gs=gs||new yt}Ln.Ia="serverreachability";function br(g){j.call(this,Ln.Ia,g)}m(br,j);function On(g){const w=Pr();ut(w,new br(w))}Ln.STAT_EVENT="statevent";function Vn(g,w){j.call(this,Ln.STAT_EVENT,g),this.stat=w}m(Vn,j);function ft(g){const w=Pr();ut(w,new Vn(w,g))}Ln.Ja="timingevent";function to(g,w){j.call(this,Ln.Ja,g),this.size=w}m(to,j);function er(g,w){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},w)}function Ot(){this.g=!0}Ot.prototype.ua=function(){this.g=!1};function ki(g,w,I,N,X,Q){g.info(function(){if(g.g)if(Q){var he="",Fe=Q.split("&");for(let ct=0;ct<Fe.length;ct++){var Ft=Fe[ct].split("=");if(Ft.length>1){const Gt=Ft[0];Ft=Ft[1];const fi=Gt.split("_");he=fi.length>=2&&fi[1]=="type"?he+(Gt+"="+Ft+"&"):he+(Gt+"=redacted&")}}}else he=null;else he=Q;return"XMLHTTP REQ ("+N+") [attempt "+X+"]: "+w+`
`+I+`
`+he})}function dn(g,w,I,N,X,Q,he){g.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+X+"]: "+w+`
`+I+`
`+Q+" "+he})}function Vt(g,w,I,N){g.info(function(){return"XMLHTTP TEXT ("+w+"): "+gn(g,I)+(N?" "+N:"")})}function fn(g,w){g.info(function(){return"TIMEOUT: "+w})}Ot.prototype.info=function(){};function gn(g,w){if(!g.g)return w;if(!w)return null;try{const Q=JSON.parse(w);if(Q){for(g=0;g<Q.length;g++)if(Array.isArray(Q[g])){var I=Q[g];if(!(I.length<2)){var N=I[1];if(Array.isArray(N)&&!(N.length<1)){var X=N[0];if(X!="noop"&&X!="stop"&&X!="close")for(let he=1;he<N.length;he++)N[he]=""}}}}return Cr(Q)}catch{return w}}var nn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bt;function Xt(){}m(Xt,bi),Xt.prototype.g=function(){return new XMLHttpRequest},Bt=new Xt;function Di(g){return encodeURIComponent(String(g))}function Ol(g){var w=1;g=g.split(":");const I=[];for(;w>0&&g.length;)I.push(g.shift()),w--;return g.length&&I.push(g.join(":")),I}function Mi(g,w,I,N){this.j=g,this.i=w,this.l=I,this.S=N||1,this.V=new Pi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yf}function yf(){this.i=null,this.g="",this.h=!1}var _f={},Oc={};function tr(g,w,I){g.M=1,g.A=ms(Ni(w)),g.u=I,g.R=!0,Vc(g,null)}function Vc(g,w){g.F=Date.now(),ua(g),g.B=Ni(g.A);var I=g.B,N=g.S;Array.isArray(N)||(N=[String(N)]),Hc(I.i,"t",N),g.C=0,I=g.j.L,g.h=new yf,g.g=Af(g.j,I?w:null,!g.u),g.P>0&&(g.O=new Js(h(g.Y,g,g.g),g.P)),w=g.V,I=g.g,N=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Sr[0]=X.toString()),X=Sr);for(let Q=0;Q<X.length;Q++){const he=Be(I,X[Q],N||w.handleEvent,!1,w.h||w);if(!he)break;w.g[he.key]=he}w=g.J?G(g.J):{},g.u?(g.v||(g.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,w)):(g.v="GET",g.g.ea(g.B,g.v,null,w)),On(),ki(g.i,g.v,g.B,g.l,g.S,g.u)}Mi.prototype.ba=function(g){g=g.target;const w=this.O;w&&Vr(g)==3?w.j():this.Y(g)},Mi.prototype.Y=function(g){try{if(g==this.g)e:{const Fe=Vr(this.g),Ft=this.g.ya(),ct=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||Cf(this.g)))){this.K||Fe!=4||Ft==7||(Ft==8||ct<=0?On(3):On(2)),Vl(this);var w=this.g.ca();this.X=w;var I=vf(this);if(this.o=w==200,dn(this.i,this.v,this.B,this.l,this.S,Fe,w),this.o){if(this.U&&!this.L){t:{if(this.g){var N,X=this.g;if((N=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(N)){var Q=N;break t}}Q=null}if(g=Q)Vt(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,g);else{this.o=!1,this.m=3,ft(12),ps(this),ca(this);break e}}if(this.R){g=!0;let Gt;for(;!this.K&&this.C<I.length;)if(Gt=Ef(this,I),Gt==Oc){Fe==4&&(this.m=4,ft(14),g=!1),Vt(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==_f){this.m=4,ft(15),Vt(this.i,this.l,I,"[Invalid Chunk]"),g=!1;break}else Vt(this.i,this.l,Gt,null),vt(this,Gt);if(wf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||I.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Vt(this.i,this.l,I,"[Invalid Chunked Response]"),ps(this),ca(this);else if(I.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),va(he),he.P=!0,ft(11))}}else Vt(this.i,this.l,I,null),vt(this,I);Fe==4&&ps(this),this.o&&!this.K&&(Fe==4?Hl(this.j,this):(this.o=!1,ua(this)))}else qc(this.g),w==400&&I.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),ps(this),ca(this)}}}catch{}};function vf(g){if(!wf(g))return g.g.la();const w=Cf(g.g);if(w==="")return"";let I="";const N=w.length,X=Vr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ps(g),ca(g),"";g.h.i=new o.TextDecoder}for(let Q=0;Q<N;Q++)g.h.h=!0,I+=g.h.i.decode(w[Q],{stream:!(X&&Q==N-1)});return w.length=0,g.h.g+=I,g.C=0,g.h.g}function wf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Ef(g,w){var I=g.C,N=w.indexOf(`
`,I);return N==-1?Oc:(I=Number(w.substring(I,N)),isNaN(I)?_f:(N+=1,N+I>w.length?Oc:(w=w.slice(N,N+I),g.C=N+I,w)))}Mi.prototype.cancel=function(){this.K=!0,ps(this)};function ua(g){g.T=Date.now()+g.H,Fc(g,g.H)}function Fc(g,w){if(g.D!=null)throw Error("WatchDog timer not null");g.D=er(h(g.aa,g),w)}function Vl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Mi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(fn(this.i,this.B),this.M!=2&&(On(),ft(17)),ps(this),this.m=2,ca(this)):Fc(this,this.T-g)};function ca(g){g.j.I==0||g.K||Hl(g.j,g)}function ps(g){Vl(g);var w=g.O;w&&typeof w.dispose=="function"&&w.dispose(),g.O=null,Ji(g.V),g.g&&(w=g.g,g.g=null,w.abort(),w.dispose())}function vt(g,w){try{var I=g.j;if(I.I!=0&&(I.g==g||Uc(I.h,g))){if(!g.L&&Uc(I.h,g)&&I.I==3){try{var N=I.Ba.g.parse(w)}catch{N=null}if(Array.isArray(N)&&N.length==3){var X=N;if(X[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<g.F)$l(I),hi(I);else break e;Ur(I),ft(18)}}else I.xa=X[1],0<I.xa-I.K&&X[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=er(h(I.Va,I),6e3));ha(I.h)<=1&&I.ta&&(I.ta=void 0)}else di(I,11)}else if((g.L||I.g==g)&&$l(I),!L(w))for(X=I.Ba.g.parse(w),w=0;w<X.length;w++){let ct=X[w];const Gt=ct[0];if(!(Gt<=I.K))if(I.K=Gt,ct=ct[1],I.I==2)if(ct[0]=="c"){I.M=ct[1],I.ba=ct[2];const fi=ct[3];fi!=null&&(I.ka=fi,I.j.info("VER="+I.ka));const Es=ct[4];Es!=null&&(I.za=Es,I.j.info("SVER="+I.za));const zr=ct[5];zr!=null&&typeof zr=="number"&&zr>0&&(N=1.5*zr,I.O=N,I.j.info("backChannelRequestTimeoutMs_="+N)),N=I;const Br=g.g;if(Br){const Yl=Br.g?Br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yl){var Q=N.h;Q.g||Yl.indexOf("spdy")==-1&&Yl.indexOf("quic")==-1&&Yl.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(jl(Q,Q.h),Q.h=null))}if(N.G){const Qc=Br.g?Br.g.getResponseHeader("X-HTTP-Session-Id"):null;Qc&&(N.wa=Qc,st(N.J,N.G,Qc))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-g.F,I.j.info("Handshake RTT: "+I.T+"ms")),N=I;var he=g;if(N.na=Zc(N,N.L?N.ba:null,N.W),he.L){da(N.h,he);var Fe=he,Ft=N.O;Ft&&(Fe.H=Ft),Fe.D&&(Vl(Fe),ua(Fe)),N.g=he}else Sn(N);I.i.length>0&&ws(I)}else ct[0]!="stop"&&ct[0]!="close"||di(I,7);else I.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?di(I,7):Wl(I):ct[0]!="noop"&&I.l&&I.l.qa(ct),I.A=0)}}On(4)}catch{}}var gy=class{constructor(g,w){this.g=g,this.map=w}};function Fl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function jc(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function ha(g){return g.h?1:g.g?g.g.size:0}function Uc(g,w){return g.h?g.h==w:g.g?g.g.has(w):!1}function jl(g,w){g.g?g.g.add(w):g.h=w}function da(g,w){g.h&&g.h==w?g.h=null:g.g&&g.g.has(w)&&g.g.delete(w)}Fl.prototype.cancel=function(){if(this.i=li(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function li(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let w=g.i;for(const I of g.g.values())w=w.concat(I.G);return w}return E(g.i)}var xf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ui(g,w){if(g){g=g.split("&");for(let I=0;I<g.length;I++){const N=g[I].indexOf("=");let X,Q=null;N>=0?(X=g[I].substring(0,N),Q=g[I].substring(N+1)):X=g[I],w(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function kr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;g instanceof kr?(this.l=g.l,fa(this,g.j),this.o=g.o,this.g=g.g,Dr(this,g.u),this.h=g.h,no(this,Xc(g.i)),this.m=g.m):g&&(w=String(g).match(xf))?(this.l=!1,fa(this,w[1]||"",!0),this.o=ga(w[2]||""),this.g=ga(w[3]||"",!0),Dr(this,w[4]),this.h=ga(w[5]||"",!0),no(this,w[6]||"",!0),this.m=ga(w[7]||"")):(this.l=!1,this.i=new $e(null,this.l))}kr.prototype.toString=function(){const g=[];var w=this.j;w&&g.push(pa(w,Bc,!0),":");var I=this.g;return(I||w=="file")&&(g.push("//"),(w=this.o)&&g.push(pa(w,Bc,!0),"@"),g.push(Di(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&g.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&g.push("/"),g.push(pa(I,I.charAt(0)=="/"?ma:Gc,!0))),(I=this.i.toString())&&g.push("?",I),(I=this.m)&&g.push("#",pa(I,Wc)),g.join("")},kr.prototype.resolve=function(g){const w=Ni(this);let I=!!g.j;I?fa(w,g.j):I=!!g.o,I?w.o=g.o:I=!!g.g,I?w.g=g.g:I=g.u!=null;var N=g.h;if(I)Dr(w,g.u);else if(I=!!g.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var X=w.h.lastIndexOf("/");X!=-1&&(N=w.h.slice(0,X+1)+N)}if(X=N,X==".."||X==".")N="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){N=X.lastIndexOf("/",0)==0,X=X.split("/");const Q=[];for(let he=0;he<X.length;){const Fe=X[he++];Fe=="."?N&&he==X.length&&Q.push(""):Fe==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),N&&he==X.length&&Q.push("")):(Q.push(Fe),N=!0)}N=Q.join("/")}else N=X}return I?w.h=N:I=g.i.toString()!=="",I?no(w,Xc(g.i)):I=!!g.m,I&&(w.m=g.m),w};function Ni(g){return new kr(g)}function fa(g,w,I){g.j=I?ga(w,!0):w,g.j&&(g.j=g.j.replace(/:$/,""))}function Dr(g,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);g.u=w}else g.u=null}function no(g,w,I){w instanceof $e?(g.i=w,zl(g.i,g.l)):(I||(w=pa(w,py)),g.i=new $e(w,g.l))}function st(g,w,I){g.i.set(w,I)}function ms(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function ga(g,w){return g?w?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function pa(g,w,I){return typeof g=="string"?(g=encodeURI(g).replace(w,zc),I&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function zc(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Bc=/[#\/\?@]/g,Gc=/[#\?:]/g,ma=/[#\?]/g,py=/[#\?@]/g,Wc=/#/g;function $e(g,w){this.h=this.g=null,this.i=g||null,this.j=!!w}function Mr(g){g.g||(g.g=new Map,g.h=0,g.i&&ui(g.i,function(w,I){g.add(decodeURIComponent(w.replace(/\+/g," ")),I)}))}n=$e.prototype,n.add=function(g,w){Mr(this),this.i=null,g=Nr(this,g);let I=this.g.get(g);return I||this.g.set(g,I=[]),I.push(w),this.h+=1,this};function Kc(g,w){Mr(g),w=Nr(g,w),g.g.has(w)&&(g.i=null,g.h-=g.g.get(w).length,g.g.delete(w))}function Ul(g,w){return Mr(g),w=Nr(g,w),g.g.has(w)}n.forEach=function(g,w){Mr(this),this.g.forEach(function(I,N){I.forEach(function(X){g.call(w,X,N,this)},this)},this)};function $c(g,w){Mr(g);let I=[];if(typeof w=="string")Ul(g,w)&&(I=I.concat(g.g.get(Nr(g,w))));else for(g=Array.from(g.g.values()),w=0;w<g.length;w++)I=I.concat(g[w]);return I}n.set=function(g,w){return Mr(this),this.i=null,g=Nr(this,g),Ul(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[w]),this.h+=1,this},n.get=function(g,w){return g?(g=$c(this,g),g.length>0?String(g[0]):w):w};function Hc(g,w,I){Kc(g,w),I.length>0&&(g.i=null,g.g.set(Nr(g,w),E(I)),g.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],w=Array.from(this.g.keys());for(let N=0;N<w.length;N++){var I=w[N];const X=Di(I);I=$c(this,I);for(let Q=0;Q<I.length;Q++){let he=X;I[Q]!==""&&(he+="="+Di(I[Q])),g.push(he)}}return this.i=g.join("&")};function Xc(g){const w=new $e;return w.i=g.i,g.g&&(w.g=new Map(g.g),w.h=g.h),w}function Nr(g,w){return w=String(w),g.j&&(w=w.toLowerCase()),w}function zl(g,w){w&&!g.j&&(Mr(g),g.i=null,g.g.forEach(function(I,N){const X=N.toLowerCase();N!=X&&(Kc(this,N),Hc(this,X,I))},g)),g.j=w}function Lr(g,w){const I=new Ot;if(o.Image){const N=new Image;N.onload=f(pn,I,"TestLoadImage: loaded",!0,w,N),N.onerror=f(pn,I,"TestLoadImage: error",!1,w,N),N.onabort=f(pn,I,"TestLoadImage: abort",!1,w,N),N.ontimeout=f(pn,I,"TestLoadImage: timeout",!1,w,N),o.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=g}else w(!1)}function Or(g,w){const I=new Ot,N=new AbortController,X=setTimeout(()=>{N.abort(),pn(I,"TestPingServer: timeout",!1,w)},1e4);fetch(g,{signal:N.signal}).then(Q=>{clearTimeout(X),Q.ok?pn(I,"TestPingServer: ok",!0,w):pn(I,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(X),pn(I,"TestPingServer: error",!1,w)})}function pn(g,w,I,N,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),N(I)}catch{}}function ya(){this.g=new Rr}function ys(g){this.i=g.Sb||null,this.h=g.ab||!1}m(ys,bi),ys.prototype.g=function(){return new ci(this.i,this.h)};function ci(g,w){yt.call(this),this.H=g,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(ci,yt),n=ci.prototype,n.open=function(g,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=w,this.readyState=1,nr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(w.body=g),(this.H||o).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,io(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,nr(this)),this.g&&(this.readyState=3,nr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Tf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Tf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var w=g.value?g.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!g.done}))&&(this.response=this.responseText+=w)}g.done?io(this):nr(this),this.readyState==3&&Tf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,io(this))},n.Na=function(g){this.g&&(this.response=g,io(this))},n.ga=function(){this.g&&io(this)};function io(g){g.readyState=4,g.l=null,g.j=null,g.B=null,nr(g)}n.setRequestHeader=function(g,w){this.A.append(g,w)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],w=this.h.entries();for(var I=w.next();!I.done;)I=I.value,g.push(I[0]+": "+I[1]),I=w.next();return g.join(`\r
`)};function nr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(ci.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function If(g){let w="";return oe(g,function(I,N){w+=N,w+=":",w+=I,w+=`\r
`}),w}function Bl(g,w,I){e:{for(N in I){var N=!1;break e}N=!0}N||(I=If(I),typeof g=="string"?I!=null&&Di(I):st(g,w,I))}function pt(g){yt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(pt,yt);var Sf=/^https?$/i,my=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,w,I,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);w=w?w.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(w,String(g),!0),this.B=!1}catch(Q){ro(this,Q);return}if(g=I||"",I=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var X in N)I.set(X,N[X]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const Q of N.keys())I.set(Q,N.get(Q));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(I.keys()).find(Q=>Q.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(my,w,void 0)>=0)||N||X||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,he]of I)this.g.setRequestHeader(Q,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(Q){ro(this,Q)}};function ro(g,w){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=w,g.o=5,so(g),vs(g)}function so(g){g.A||(g.A=!0,ut(g,"complete"),ut(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ut(this,"complete"),ut(this,"abort"),vs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?_s(this):this.Xa())},n.Xa=function(){_s(this)};function _s(g){if(g.h&&typeof s<"u"){if(g.v&&Vr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ut(g,"readystatechange"),Vr(g)==4){g.h=!1;try{const Q=g.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var I;if(!(I=w)){var N;if(N=Q===0){let he=String(g.D).match(xf)[1]||null;!he&&o.self&&o.self.location&&(he=o.self.location.protocol.slice(0,-1)),N=!Sf.test(he?he.toLowerCase():"")}I=N}if(I)ut(g,"complete"),ut(g,"success");else{g.o=6;try{var X=Vr(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",so(g)}}finally{vs(g)}}}}function vs(g,w){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const I=g.g;g.g=null,w||ut(g,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Vr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Vr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var w=this.g.responseText;return g&&w.indexOf(g)==0&&(w=w.substring(g.length)),la(w)}};function Cf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function qc(g){const w={};g=(g.g&&Vr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<g.length;N++){if(L(g[N]))continue;var I=Ol(g[N]);const X=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const Q=w[X]||[];w[X]=Q,Q.push(I)}ne(w,function(N){return N.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fr(g,w,I){return I&&I.internalChannelParams&&I.internalChannelParams[g]||w}function Gl(g){this.za=0,this.i=[],this.j=new Ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Fr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Fr("baseRetryDelayMs",5e3,g),this.Za=Fr("retryDelaySeedMs",1e4,g),this.Ta=Fr("forwardChannelMaxRetries",2,g),this.va=Fr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Fl(g&&g.concurrentRequestLimit),this.Ba=new ya,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Gl.prototype,n.ka=8,n.I=1,n.connect=function(g,w,I,N){ft(0),this.W=g,this.H=w||{},I&&N!==void 0&&(this.H.OSID=I,this.H.OAID=N),this.F=this.X,this.J=Zc(this,null,this.W),ws(this)};function Wl(g){if(Kl(g),g.I==3){var w=g.V++,I=Ni(g.J);if(st(I,"SID",g.M),st(I,"RID",w),st(I,"TYPE","terminate"),jr(g,I),w=new Mi(g,g.j,w),w.M=2,w.A=ms(Ni(I)),I=!1,o.navigator&&o.navigator.sendBeacon)try{I=o.navigator.sendBeacon(w.A.toString(),"")}catch{}!I&&o.Image&&(new Image().src=w.A,I=!0),I||(w.g=Af(w.j,null),w.g.ea(w.A)),w.F=Date.now(),ua(w)}wa(g)}function hi(g){g.g&&(va(g),g.g.cancel(),g.g=null)}function Kl(g){hi(g),g.v&&(o.clearTimeout(g.v),g.v=null),$l(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function ws(g){if(!jc(g.h)&&!g.m){g.m=!0;var w=g.Ea;F||R(),W||(F(),W=!0),D.add(w,g),g.D=0}}function Rf(g,w){return ha(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=w.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=er(h(g.Ea,g,w),Xl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Mi(this,this.j,g);let Q=this.o;if(this.U&&(Q?(Q=G(Q),xe(Q,this.U)):Q=this.U),this.u!==null||this.R||(X.J=Q,Q=null),this.S)e:{for(var w=0,I=0;I<this.i.length;I++){t:{var N=this.i[I];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(w+=N,w>4096){w=I;break e}if(w===4096||I===this.i.length-1){w=I+1;break e}}w=1e3}else w=1e3;w=Yc(this,X,w),I=Ni(this.J),st(I,"RID",g),st(I,"CVER",22),this.G&&st(I,"X-HTTP-Session-Id",this.G),jr(this,I),Q&&(this.R?w="headers="+Di(If(Q))+"&"+w:this.u&&Bl(I,this.u,Q)),jl(this.h,X),this.Ra&&st(I,"TYPE","init"),this.S?(st(I,"$req",w),st(I,"SID","null"),X.U=!0,tr(X,I,null)):tr(X,I,w),this.I=2}}else this.I==3&&(g?_a(this,g):this.i.length==0||jc(this.h)||_a(this))};function _a(g,w){var I;w?I=w.l:I=g.V++;const N=Ni(g.J);st(N,"SID",g.M),st(N,"RID",I),st(N,"AID",g.K),jr(g,N),g.u&&g.o&&Bl(N,g.u,g.o),I=new Mi(g,g.j,I,g.D+1),g.u===null&&(I.J=g.o),w&&(g.i=w.G.concat(g.i)),w=Yc(g,I,1e3),I.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),jl(g.h,I),tr(I,N,w)}function jr(g,w){g.H&&oe(g.H,function(I,N){st(w,N,I)}),g.l&&oe({},function(I,N){st(w,N,I)})}function Yc(g,w,I){I=Math.min(g.i.length,I);const N=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let Fe=-1;for(;;){const Ft=["count="+I];Fe==-1?I>0?(Fe=X[0].g,Ft.push("ofs="+Fe)):Fe=0:Ft.push("ofs="+Fe);let ct=!0;for(let Gt=0;Gt<I;Gt++){var Q=X[Gt].g;const fi=X[Gt].map;if(Q-=Fe,Q<0)Fe=Math.max(0,X[Gt].g-100),ct=!1;else try{Q="req"+Q+"_"||"";try{var he=fi instanceof Map?fi:Object.entries(fi);for(const[Es,zr]of he){let Br=zr;l(zr)&&(Br=Cr(zr)),Ft.push(Q+Es+"="+encodeURIComponent(Br))}}catch(Es){throw Ft.push(Q+"type="+encodeURIComponent("_badmap")),Es}}catch{N&&N(fi)}}if(ct){he=Ft.join("&");break e}}he=void 0}return g=g.i.splice(0,I),w.G=g,he}function Sn(g){if(!g.g&&!g.v){g.Y=1;var w=g.Da;F||R(),W||(F(),W=!0),D.add(w,g),g.A=0}}function Ur(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=er(h(g.Da,g),Xl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,oo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=er(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),hi(this),oo(this))};function va(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function oo(g){g.g=new Mi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var w=Ni(g.na);st(w,"RID","rpc"),st(w,"SID",g.M),st(w,"AID",g.K),st(w,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(w,"TO",g.ia),st(w,"TYPE","xmlhttp"),jr(g,w),g.u&&g.o&&Bl(w,g.u,g.o),g.O&&(g.g.H=g.O);var I=g.g;g=g.ba,I.M=1,I.A=ms(Ni(w)),I.u=null,I.R=!0,Vc(I,g)}n.Va=function(){this.C!=null&&(this.C=null,hi(this),Ur(this),ft(19))};function $l(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Hl(g,w){var I=null;if(g.g==w){$l(g),va(g),g.g=null;var N=2}else if(Uc(g.h,w))I=w.G,da(g.h,w),N=1;else return;if(g.I!=0){if(w.o)if(N==1){I=w.u?w.u.length:0,w=Date.now()-w.F;var X=g.D;N=Pr(),ut(N,new to(N,I)),ws(g)}else Sn(g);else if(X=w.m,X==3||X==0&&w.X>0||!(N==1&&Rf(g,w)||N==2&&Ur(g)))switch(I&&I.length>0&&(w=g.h,w.i=w.i.concat(I)),X){case 1:di(g,5);break;case 4:di(g,10);break;case 3:di(g,6);break;default:di(g,2)}}}function Xl(g,w){let I=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(I*=2),I*w}function di(g,w){if(g.j.info("Error code "+w),w==2){var I=h(g.bb,g),N=g.Ua;const X=!N;N=new kr(N||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||fa(N,"https"),ms(N),X?Lr(N.toString(),I):Or(N.toString(),I)}else ft(2);g.I=0,g.l&&g.l.pa(w),wa(g),Kl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function wa(g){if(g.I=0,g.ja=[],g.l){const w=li(g.h);(w.length!=0||g.i.length!=0)&&(x(g.ja,w),x(g.ja,g.i),g.h.i.length=0,E(g.i),g.i.length=0),g.l.oa()}}function Zc(g,w,I){var N=I instanceof kr?Ni(I):new kr(I);if(N.g!="")w&&(N.g=w+"."+N.g),Dr(N,N.u);else{var X=o.location;N=X.protocol,w=w?w+"."+X.hostname:X.hostname,X=+X.port;const Q=new kr(null);N&&fa(Q,N),w&&(Q.g=w),X&&Dr(Q,X),I&&(Q.h=I),N=Q}return I=g.G,w=g.wa,I&&w&&st(N,I,w),st(N,"VER",g.ka),jr(g,N),N}function Af(g,w,I){if(w&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=g.Aa&&!g.ma?new pt(new ys({ab:I})):new pt(g.ma),w.Fa(g.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pf(){}n=Pf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ql(){}ql.prototype.g=function(g,w){return new mn(g,w)};function mn(g,w){yt.call(this),this.g=new Gl(w),this.l=g,this.h=w&&w.messageUrlParams||null,g=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(g?g["X-WebChannel-Content-Type"]=w.messageContentType:g={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(g?g["X-WebChannel-Client-Profile"]=w.sa:g={"X-WebChannel-Client-Profile":w.sa}),this.g.U=g,(g=w&&w.Qb)&&!L(g)&&(this.g.u=g),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!L(w)&&(this.g.G=w,g=this.h,g!==null&&w in g&&(g=this.h,w in g&&delete g[w])),this.j=new ao(this)}m(mn,yt),mn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){Wl(this.g)},mn.prototype.o=function(g){var w=this.g;if(typeof g=="string"){var I={};I.__data__=g,g=I}else this.v&&(I={},I.__data__=Cr(g),g=I);w.i.push(new gy(w.Ya++,g)),w.I==3&&ws(w)},mn.prototype.N=function(){this.g.l=null,delete this.j,Wl(this.g),delete this.g,mn.Z.N.call(this)};function bf(g){fs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var w=g.__sm__;if(w){e:{for(const I in w){g=I;break e}g=void 0}(this.i=g)&&(g=this.i,w=w!==null&&g in w?w[g]:void 0),this.data=w}else this.data=g}m(bf,fs);function kf(){eo.call(this),this.status=1}m(kf,eo);function ao(g){this.g=g}m(ao,Pf),ao.prototype.ra=function(){ut(this.g,"a")},ao.prototype.qa=function(g){ut(this.g,new bf(g))},ao.prototype.pa=function(g){ut(this.g,new kf)},ao.prototype.oa=function(){ut(this.g,"b")},ql.prototype.createWebChannel=ql.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,T2=function(){return new ql},x2=function(){return Pr()},E2=Ln,Kv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nn.NO_ERROR=0,nn.TIMEOUT=8,nn.HTTP_ERROR=6,lp=nn,rt.COMPLETE="complete",w2=rt,Ll.EventType=Ar,Ar.OPEN="a",Ar.CLOSE="b",Ar.ERROR="c",Ar.MESSAGE="d",yt.prototype.listen=yt.prototype.J,Hh=Ll,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,v2=pt}).apply(typeof Wg<"u"?Wg:typeof self<"u"?self:typeof window<"u"?window:{});const QC="@firebase/firestore",JC="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Mc="12.7.0";const xl=new OE("@firebase/firestore");function Nu(){return xl.logLevel}function de(n,...e){if(xl.logLevel<=Ke.DEBUG){const t=e.map(YE);xl.debug(`Firestore (${Mc}): ${n}`,...t)}}function wi(n,...e){if(xl.logLevel<=Ke.ERROR){const t=e.map(YE);xl.error(`Firestore (${Mc}): ${n}`,...t)}}function qm(n,...e){if(xl.logLevel<=Ke.WARN){const t=e.map(YE);xl.warn(`Firestore (${Mc}): ${n}`,...t)}}function YE(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Re(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,I2(n,i,t)}function I2(n,e,t){let i=`FIRESTORE (${Mc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw wi(i),new Error(i)}function De(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||I2(e,r,i)}function Tt(n,e){return n}const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends cs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class al{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class S2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aG{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class lG{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class uG{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){De(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let s=new al;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new al,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await r(this.currentUser)}))},l=c=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new al)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(De(typeof i.accessToken=="string",31837,{l:i}),new S2(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class cG{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hG{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new cG(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class eR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dG{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ki(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){De(this.o===void 0,3512);const i=s=>{s.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,de("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new eR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(De(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new eR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function fG(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class C2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=fG(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function We(n,e){return n<e?-1:n>e?1:0}function $v(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return U0(r)===U0(s)?We(r,s):U0(r)?1:-1}return We(n.length,e.length)}const gG=55296,pG=57343;function U0(n){const e=n.charCodeAt(0);return e>=gG&&e<=pG}function gc(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function R2(n){return n+"\0"}const tR="__name__";class Hr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Re(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Hr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Hr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return We(e.length,t.length)}static compareSegments(e,t){const i=Hr.isNumericId(e),r=Hr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Hr.extractNumericId(e).compare(Hr.extractNumericId(t)):$v(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return qE.fromString(e.substring(4,e.length-2))}}class Ct extends Hr{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ee(se.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const mG=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Hr{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return mG.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tR}static keyField(){return new zt([tR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Ee(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ee(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ee(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Ee(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}class ve{constructor(e){this.path=e}static fromPath(e){return new ve(Ct.fromString(e))}static fromName(e){return new ve(Ct.fromString(e).popFirst(5))}static empty(){return new ve(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new Ct(e.slice()))}}function yG(n,e,t,i){if(e===!0&&i===!0)throw new Ee(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function _G(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function vG(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function A2(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ee(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=vG(n);throw new Ee(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Ht(n,e){const t={typeString:n};return e&&(t.value=e),t}function ff(n,e){if(!_G(n))throw new Ee(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Ee(se.INVALID_ARGUMENT,t);return!0}const nR=-62135596800,iR=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*iR);return new bt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ee(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ee(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<nR)throw new Ee(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iR}_compareTo(e){return this.seconds===e.seconds?We(this.nanoseconds,e.nanoseconds):We(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ff(e,bt._jsonSchema))return new bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-nR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bt._jsonSchemaVersion="firestore/timestamp/1.0",bt._jsonSchema={type:Ht("string",bt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};class Ze{static fromTimestamp(e){return new Ze(e)}static min(){return new Ze(new bt(0,0))}static max(){return new Ze(new bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ld=-1;class Zp{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Hv(n){return n.fields.find((e=>e.kind===2))}function Ba(n){return n.fields.filter((e=>e.kind!==2))}Zp.UNKNOWN_ID=-1;class up{constructor(e,t){this.fieldPath=e,this.kind=t}}class Od{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Od(0,Ci.min())}}function wG(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ze.fromTimestamp(i===1e9?new bt(t+1,0):new bt(t,i));return new Ci(r,ve.empty(),e)}function P2(n){return new Ci(n.readTime,n.key,Ld)}class Ci{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ci(Ze.min(),ve.empty(),Ld)}static max(){return new Ci(Ze.max(),ve.empty(),Ld)}}function ZE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ve.comparator(n.documentKey,e.documentKey),t!==0?t:We(n.largestBatchId,e.largestBatchId))}const b2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class k2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ym(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==b2)throw n;de("LocalStore","Unexpectedly lost primary lease")}class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Y(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Y?t:Y.resolve(t)}catch(t){return Y.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.reject(t)}static resolve(e){return new Y(((t,i)=>{t(e)}))}static reject(e){return new Y(((t,i)=>{i(e)}))}static waitFor(e){return new Y(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(c=>i(c)))})),o=!0,s===r&&t()}))}static or(e){let t=Y.resolve(!1);for(const i of e)t=t.next((r=>r?Y.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Y(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Y(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const _i="SimpleDb";class Zm{static open(e,t,i,r){try{return new Zm(t,e.transaction(r,i))}catch(s){throw new id(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new al,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new id(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=QE(i.target.error);this.S.reject(new id(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(de(_i,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new xG(t)}}class Yo{static delete(e){return de(_i,"Removing database:",e),Ka(Ak().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Vk())return!1;if(Yo.F())return!0;const e=Jt(),t=Yo.M(e),i=0<t&&t<10,r=D2(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Yo.M(Jt())===12.2&&wi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(de(_i,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new id(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Ee(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Ee(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new id(e,o))},r.onupgradeneeded=s=>{de(_i,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{de(_i,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Zm.open(this.db,e,s?"readonly":"readwrite",i),c=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Y.reject(h)))).toPromise();return c.catch((()=>{})),await l.D,c}catch(l){const c=l,h=c.name!=="FirebaseError"&&o<3;if(de(_i,"Transaction failed with error:",c.message,"Retrying:",h),this.close(),!h)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function D2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class EG{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ka(this.U.delete())}}class id extends Ee{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ml(n){return n.name==="IndexedDbTransactionError"}class xG{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(de(_i,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(de(_i,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ka(i)}add(e){return de(_i,"ADD",this.store.name,e,e),Ka(this.store.add(e))}get(e){return Ka(this.store.get(e)).next((t=>(t===void 0&&(t=null),de(_i,"GET",this.store.name,e,t),t)))}delete(e){return de(_i,"DELETE",this.store.name,e),Ka(this.store.delete(e))}count(){return de(_i,"COUNT",this.store.name),Ka(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Y(((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,c)=>{o.push(c)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Y(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){de(_i,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Y(((i,r)=>{t.onerror=s=>{const o=QE(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Y(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const c=new EG(l),h=t(l.primaryKey,l.value,c);if(h instanceof Y){const f=h.catch((m=>(c.done(),Y.reject(m))));i.push(f)}c.isDone?r():c.G===null?l.continue():l.continue(c.G)}})).next((()=>Y.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ka(n){return new Y(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=QE(i.target.error);t(r)}}))}let rR=!1;function QE(n){const e=Yo.M(Jt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Ee("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rR||(rR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const rd="IndexBackfiller";class TG{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){de(rd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();de(rd,`Documents written: ${t}`)}catch(t){Ml(t)?de(rd,"Ignoring IndexedDB error during index backfill: ",t):await Ym(t)}await this.re(6e4)}))}}class IG{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Y.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return de(rd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(de(rd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=P2(s);ZE(o,i)>0&&(i=o)})),new Ci(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class yr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yr.ce=-1;const ll=-1;function Qm(n){return n==null}function Qp(n){return n===0&&1/n==-1/0}const Jp="";function Bn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=sR(e)),e=SG(n.get(t),e);return sR(e)}function SG(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case Jp:t+="";break;default:t+=s}}return t}function sR(n){return n+Jp+""}function Zr(n){const e=n.length;if(De(e>=2,64408,{path:n}),e===2)return De(n.charAt(0)===Jp&&n.charAt(1)==="",56145,{path:n}),Ct.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(Jp,s);switch((o<0||o>t)&&Re(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let c;r.length===0?c=l:(r+=l,c=r,r=""),i.push(c);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Re(61167,{path:n})}s=o+2}return new Ct(i)}const Ga="remoteDocuments",gf="owner",Iu="owner",Vd="mutationQueues",CG="userId",hr="mutations",oR="batchId",tl="userMutationsIndex",aR=["userId","batchId"];function cp(n,e){return[n,Bn(e)]}function M2(n,e,t){return[n,Bn(e),t]}const RG={},pc="documentMutations",em="remoteDocumentsV14",AG=["prefixPath","collectionGroup","readTime","documentId"],hp="documentKeyIndex",PG=["prefixPath","collectionGroup","documentId"],N2="collectionGroupIndex",bG=["collectionGroup","readTime","prefixPath","documentId"],Fd="remoteDocumentGlobal",Xv="remoteDocumentGlobalKey",mc="targets",L2="queryTargetsIndex",kG=["canonicalId","targetId"],yc="targetDocuments",DG=["targetId","path"],JE="documentTargetsIndex",MG=["path","targetId"],tm="targetGlobalKey",ul="targetGlobal",jd="collectionParents",NG=["collectionId","parent"],_c="clientMetadata",LG="clientId",Jm="bundles",OG="bundleId",ey="namedQueries",VG="name",ex="indexConfiguration",FG="indexId",qv="collectionGroupIndex",jG="collectionGroup",sd="indexState",UG=["indexId","uid"],O2="sequenceNumberIndex",zG=["uid","sequenceNumber"],od="indexEntries",BG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],V2="documentKeyIndex",GG=["indexId","uid","orderedDocumentKey"],ty="documentOverlays",WG=["userId","collectionPath","documentId"],Yv="collectionPathOverlayIndex",KG=["userId","collectionPath","largestBatchId"],F2="collectionGroupOverlayIndex",$G=["userId","collectionGroup","largestBatchId"],tx="globals",HG="name",j2=[Vd,hr,pc,Ga,mc,gf,ul,yc,_c,Fd,jd,Jm,ey],XG=[...j2,ty],U2=[Vd,hr,pc,em,mc,gf,ul,yc,_c,Fd,jd,Jm,ey,ty],z2=U2,nx=[...z2,ex,sd,od],qG=nx,B2=[...nx,tx],YG=B2;class Zv extends k2{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function en(n,e){const t=Tt(n);return Yo.O(t.le,e)}function lR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ix(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ZG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class oi{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new oi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new oi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kg(this.root,e,this.comparator,!0)}}class Kg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new oi(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uR(this.data.getIterator())}getIteratorFrom(e){return new uR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class uR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Su(n){return n.hasNext()?n.getNext():void 0}class Fs{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new Fs([])}unionWith(e){let t=new mt(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Fs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class QG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ai{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new QG("Invalid base64 string: "+s):s}})(e);return new ai(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new ai(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return We(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ai.EMPTY_BYTE_STRING=new ai("");const JG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ta(n){if(De(!!n,39018),typeof n=="string"){let e=0;const t=JG.exec(n);if(De(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$t(n.seconds),nanos:$t(n.nanos)}}function $t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function vc(n){return typeof n=="string"?ai.fromBase64String(n):ai.fromUint8Array(n)}const G2="server_timestamp",W2="__type__",K2="__previous_value__",$2="__local_write_time__";function rx(n){return(n?.mapValue?.fields||{})[W2]?.stringValue===G2}function H2(n){const e=n.mapValue.fields[K2];return rx(e)?H2(e):e}function nm(n){const e=ta(n.mapValue.fields[$2].timestampValue);return new bt(e.seconds,e.nanos)}class e8{constructor(e,t,i,r,s,o,l,c,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=f}}const im="(default)";class wc{constructor(e,t){this.projectId=e,this.database=t||im}static empty(){return new wc("","")}get isDefaultDatabase(){return this.database===im}isEqual(e){return e instanceof wc&&e.projectId===this.projectId&&e.database===this.database}}const X2="__type__",q2="__max__",Wo={mapValue:{fields:{__type__:{stringValue:q2}}}},Y2="__vector__",rm="value",dp={nullValue:"NULL_VALUE"};function Ec(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?rx(n)?4:Z2(n)?9007199254740991:ny(n)?10:11:Re(28295,{value:n})}function ss(n,e){if(n===e)return!0;const t=Ec(n);if(t!==Ec(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return nm(n).isEqual(nm(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ta(r.timestampValue),l=ta(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return vc(r.bytesValue).isEqual(vc(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return $t(r.geoPointValue.latitude)===$t(s.geoPointValue.latitude)&&$t(r.geoPointValue.longitude)===$t(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return $t(r.integerValue)===$t(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=$t(r.doubleValue),l=$t(s.doubleValue);return o===l?Qp(o)===Qp(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return gc(n.arrayValue.values||[],e.arrayValue.values||[],ss);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(lR(o)!==lR(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ss(o[c],l[c])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function Ud(n,e){return(n.values||[]).find((t=>ss(t,e)))!==void 0}function na(n,e){if(n===e)return 0;const t=Ec(n),i=Ec(e);if(t!==i)return We(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return We(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=$t(s.integerValue||s.doubleValue),c=$t(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(n,e);case 3:return cR(n.timestampValue,e.timestampValue);case 4:return cR(nm(n),nm(e));case 5:return $v(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=vc(s),c=vc(o);return l.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),c=o.split("/");for(let h=0;h<l.length&&h<c.length;h++){const f=We(l[h],c[h]);if(f!==0)return f}return We(l.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=We($t(s.latitude),$t(o.latitude));return l!==0?l:We($t(s.longitude),$t(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return hR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},c=o.fields||{},h=l[rm]?.arrayValue,f=c[rm]?.arrayValue,m=We(h?.values?.length||0,f?.values?.length||0);return m!==0?m:hR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Wo.mapValue&&o===Wo.mapValue)return 0;if(s===Wo.mapValue)return 1;if(o===Wo.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),h=o.fields||{},f=Object.keys(h);c.sort(),f.sort();for(let m=0;m<c.length&&m<f.length;++m){const y=$v(c[m],f[m]);if(y!==0)return y;const E=na(l[c[m]],h[f[m]]);if(E!==0)return E}return We(c.length,f.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function cR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return We(n,e);const t=ta(n),i=ta(e),r=We(t.seconds,i.seconds);return r!==0?r:We(t.nanos,i.nanos)}function hR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=na(t[r],i[r]);if(s)return s}return We(t.length,i.length)}function xc(n){return Qv(n)}function Qv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ta(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return vc(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ve.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=Qv(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Qv(t.fields[o])}`;return r+"}"})(n.mapValue):Re(61005,{value:n})}function sx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Jv(n){return!!n&&"integerValue"in n}function zd(n){return!!n&&"arrayValue"in n}function dR(n){return!!n&&"nullValue"in n}function fR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function z0(n){return!!n&&"mapValue"in n}function ny(n){return(n?.mapValue?.fields||{})[X2]?.stringValue===Y2}function ad(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ix(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ad(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ad(n.arrayValue.values[t]);return e}return{...n}}function Z2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===q2}const Q2={mapValue:{fields:{[X2]:{stringValue:Y2},[rm]:{arrayValue:{}}}}};function t8(n){return"nullValue"in n?dp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?sx(wc.empty(),ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ny(n)?Q2:{mapValue:{}}:Re(35942,{value:n})}function n8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?sx(wc.empty(),ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Q2:"mapValue"in n?ny(n)?{mapValue:{}}:Wo:Re(61959,{value:n})}function gR(n,e){const t=na(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function pR(n,e){const t=na(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pr{constructor(e){this.value=e}static empty(){return new pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!z0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ad(t)}setAll(e){let t=zt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=ad(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());z0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ss(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];z0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){ix(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new pr(ad(this.value))}}class xn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new xn(e,0,Ze.min(),Ze.min(),Ze.min(),pr.empty(),0)}static newFoundDocument(e,t,i,r){return new xn(e,1,t,Ze.min(),i,r,0)}static newNoDocument(e,t){return new xn(e,2,t,Ze.min(),Ze.min(),pr.empty(),0)}static newUnknownDocument(e,t){return new xn(e,3,t,Ze.min(),Ze.min(),pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Tc{constructor(e,t){this.position=e,this.inclusive=t}}function mR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=ve.comparator(ve.fromName(o.referenceValue),t.key):i=na(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function yR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ss(n.position[t],e.position[t]))return!1;return!0}class sm{constructor(e,t="asc"){this.field=e,this.dir=t}}function i8(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class J2{}class Xe extends J2{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new r8(e,t,i):t==="array-contains"?new a8(e,i):t==="in"?new sD(e,i):t==="not-in"?new l8(e,i):t==="array-contains-any"?new u8(e,i):new Xe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new s8(e,i):new o8(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(na(t,this.value)):t!==null&&Ec(this.value)===Ec(t)&&this.matchesComparison(na(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gt extends J2{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gt(e,t)}matches(e){return Ic(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ic(n){return n.op==="and"}function ew(n){return n.op==="or"}function ox(n){return eD(n)&&Ic(n)}function eD(n){for(const e of n.filters)if(e instanceof gt)return!1;return!0}function tw(n){if(n instanceof Xe)return n.field.canonicalString()+n.op.toString()+xc(n.value);if(ox(n))return n.filters.map((e=>tw(e))).join(",");{const e=n.filters.map((t=>tw(t))).join(",");return`${n.op}(${e})`}}function tD(n,e){return n instanceof Xe?(function(i,r){return r instanceof Xe&&i.op===r.op&&i.field.isEqual(r.field)&&ss(i.value,r.value)})(n,e):n instanceof gt?(function(i,r){return r instanceof gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&tD(o,r.filters[l])),!0):!1})(n,e):void Re(19439)}function nD(n,e){const t=n.filters.concat(e);return gt.create(t,n.op)}function iD(n){return n instanceof Xe?(function(t){return`${t.field.canonicalString()} ${t.op} ${xc(t.value)}`})(n):n instanceof gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(iD).join(" ,")+"}"})(n):"Filter"}class r8 extends Xe{constructor(e,t,i){super(e,t,i),this.key=ve.fromName(i.referenceValue)}matches(e){const t=ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class s8 extends Xe{constructor(e,t){super(e,"in",t),this.keys=rD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class o8 extends Xe{constructor(e,t){super(e,"not-in",t),this.keys=rD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function rD(n,e){return(e.arrayValue?.values||[]).map((t=>ve.fromName(t.referenceValue)))}class a8 extends Xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return zd(t)&&Ud(t.arrayValue,this.value)}}class sD extends Xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ud(this.value.arrayValue,t)}}class l8 extends Xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ud(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ud(this.value.arrayValue,t)}}class u8 extends Xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!zd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Ud(this.value.arrayValue,i)))}}class c8{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function nw(n,e=null,t=[],i=[],r=null,s=null,o=null){return new c8(n,e,t,i,r,s,o)}function Tl(n){const e=Tt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>tw(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),Qm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>xc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>xc(i))).join(",")),e.Te=t}return e.Te}function pf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!i8(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!tD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!yR(n.startAt,e.startAt)&&yR(n.endAt,e.endAt)}function h8(n){return ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function om(n,e){return n.filters.filter((t=>t instanceof Xe&&t.field.isEqual(e)))}function _R(n,e,t){let i=dp,r=!0;for(const s of om(n,e)){let o=dp,l=!0;switch(s.op){case"<":case"<=":o=t8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=dp}gR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];gR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function vR(n,e,t){let i=Wo,r=!0;for(const s of om(n,e)){let o=Wo,l=!0;switch(s.op){case">=":case">":o=n8(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Wo}pR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];pR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class iy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function d8(n,e,t,i,r,s,o,l){return new iy(n,e,t,i,r,s,o,l)}function oD(n){return new iy(n)}function wR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function f8(n){return n.collectionGroup!==null}function ld(n){const e=Tt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mt(zt.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new sm(s,i))})),t.has(zt.keyField().canonicalString())||e.Ie.push(new sm(zt.keyField(),i))}return e.Ie}function Ws(n){const e=Tt(n);return e.Ee||(e.Ee=g8(e,ld(n))),e.Ee}function g8(n,e){if(n.limitType==="F")return nw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new sm(r.field,s)}));const t=n.endAt?new Tc(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Tc(n.startAt.position,n.startAt.inclusive):null;return nw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function iw(n,e,t){return new iy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function aD(n,e){return pf(Ws(n),Ws(e))&&n.limitType===e.limitType}function lD(n){return`${Tl(Ws(n))}|lt:${n.limitType}`}function kh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>iD(r))).join(", ")}]`),Qm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>xc(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>xc(r))).join(",")),`Target(${i})`})(Ws(n))}; limitType=${n.limitType})`}function ry(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ve.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of ld(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,c){const h=mR(o,l,c);return o.inclusive?h<=0:h<0})(i.startAt,ld(i),r)||i.endAt&&!(function(o,l,c){const h=mR(o,l,c);return o.inclusive?h>=0:h>0})(i.endAt,ld(i),r))})(n,e)}function p8(n){return(e,t)=>{let i=!1;for(const r of ld(n)){const s=m8(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function m8(n,e,t){const i=n.field.isKeyField()?ve.comparator(e.key,t.key):(function(s,o,l){const c=o.data.field(s),h=l.data.field(s);return c!==null&&h!==null?na(c,h):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:n.dir})}}class aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ix(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return ZG(this.inner)}size(){return this.innerSize}}const y8=new oi(ve.comparator);function nl(){return y8}const uD=new oi(ve.comparator);function $g(...n){let e=uD;for(const t of n)e=e.insert(t.key,t);return e}function _8(n){let e=uD;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Qr(){return ud()}function cD(){return ud()}function ud(){return new aa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const v8=new oi(ve.comparator),w8=new mt(ve.comparator);function Tn(...n){let e=w8;for(const t of n)e=e.add(t);return e}const E8=new mt(We);function x8(){return E8}function T8(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qp(e)?"-0":e}}function I8(n){return{integerValue:""+n}}class sy{constructor(){this._=void 0}}function S8(n,e,t){return n instanceof Bd?(function(r,s){const o={fields:{[W2]:{stringValue:G2},[$2]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&rx(s)&&(s=H2(s)),s&&(o.fields[K2]=s),{mapValue:o}})(t,e):n instanceof Sc?hD(n,e):n instanceof Cc?dD(n,e):(function(r,s){const o=R8(r,s),l=ER(o)+ER(r.Ae);return Jv(o)&&Jv(r.Ae)?I8(l):T8(r.serializer,l)})(n,e)}function C8(n,e,t){return n instanceof Sc?hD(n,e):n instanceof Cc?dD(n,e):t}function R8(n,e){return n instanceof Gd?(function(i){return Jv(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Bd extends sy{}class Sc extends sy{constructor(e){super(),this.elements=e}}function hD(n,e){const t=fD(e);for(const i of n.elements)t.some((r=>ss(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Cc extends sy{constructor(e){super(),this.elements=e}}function dD(n,e){let t=fD(e);for(const i of n.elements)t=t.filter((r=>!ss(r,i)));return{arrayValue:{values:t}}}class Gd extends sy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ER(n){return $t(n.integerValue||n.doubleValue)}function fD(n){return zd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class A8{constructor(e,t){this.field=e,this.transform=t}}function P8(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Sc&&r instanceof Sc||i instanceof Cc&&r instanceof Cc?gc(i.elements,r.elements,ss):i instanceof Gd&&r instanceof Gd?ss(i.Ae,r.Ae):i instanceof Bd&&r instanceof Bd})(n.transform,e.transform)}class b8{constructor(e,t){this.version=e,this.transformResults=t}}class _r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _r}static exists(e){return new _r(void 0,e)}static updateTime(e){return new _r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class oy{}function gD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ax(n.key,_r.none()):new mf(n.key,n.data,_r.none());{const t=n.data,i=pr.empty();let r=new mt(zt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Nc(n.key,i,new Fs(r.toArray()),_r.none())}}function k8(n,e,t){n instanceof mf?(function(r,s,o){const l=r.value.clone(),c=TR(r.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Nc?(function(r,s,o){if(!fp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=TR(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(pD(r)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function cd(n,e,t,i){return n instanceof mf?(function(s,o,l,c){if(!fp(s.precondition,o))return l;const h=s.value.clone(),f=IR(s.fieldTransforms,c,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Nc?(function(s,o,l,c){if(!fp(s.precondition,o))return l;const h=IR(s.fieldTransforms,c,o),f=o.data;return f.setAll(pD(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,i):(function(s,o,l){return fp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function xR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&gc(i,r,((s,o)=>P8(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class mf extends oy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Nc extends oy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function pD(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function TR(n,e,t){const i=new Map;De(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,C8(o,l,t[r]))}return i}function IR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,S8(s,o,e))}return i}class ax extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mD extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class lx{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&k8(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=cd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=cd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=cD();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const c=gD(o,l);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(Ze.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Tn())}isEqual(e){return this.batchId===e.batchId&&gc(this.mutations,e.mutations,((t,i)=>xR(t,i)))&&gc(this.baseMutations,e.baseMutations,((t,i)=>xR(t,i)))}}class ux{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){De(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return v8})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new ux(e,t,i,r)}}class cx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Ye;function D8(n){switch(n){case se.OK:return Re(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function M8(n){if(n===void 0)return wi("GRPC error has no .code"),se.UNKNOWN;switch(n){case Kt.OK:return se.OK;case Kt.CANCELLED:return se.CANCELLED;case Kt.UNKNOWN:return se.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return se.INTERNAL;case Kt.UNAVAILABLE:return se.UNAVAILABLE;case Kt.UNAUTHENTICATED:return se.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case Kt.NOT_FOUND:return se.NOT_FOUND;case Kt.ALREADY_EXISTS:return se.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return se.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case Kt.ABORTED:return se.ABORTED;case Kt.OUT_OF_RANGE:return se.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return se.UNIMPLEMENTED;case Kt.DATA_LOSS:return se.DATA_LOSS;default:return Re(39323,{code:n})}}(Ye=Kt||(Kt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";new qE([4294967295,4294967295],0);const N8={asc:"ASCENDING",desc:"DESCENDING"},L8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},O8={and:"AND",or:"OR"};class V8{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function F8(n,e){return n.useProto3Json||Qm(e)?e:{value:e}}function rw(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function j8(n,e){return rw(n,e.toTimestamp())}function xr(n){return De(!!n,49232),Ze.fromTimestamp((function(t){const i=ta(t);return new bt(i.seconds,i.nanos)})(n))}function yD(n,e){return sw(n,e).canonicalString()}function sw(n,e){const t=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function _D(n){const e=Ct.fromString(n);return De(q8(e),10190,{key:e.toString()}),e}function am(n,e){return yD(n.databaseId,e.path)}function gp(n,e){const t=_D(e);if(t.get(1)!==n.databaseId.projectId)throw new Ee(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ee(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ve(ED(t))}function vD(n,e){return yD(n.databaseId,e)}function wD(n){const e=_D(n);return e.length===4?Ct.emptyPath():ED(e)}function U8(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ED(n){return De(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function SR(n,e,t){return{name:am(n,e),fields:t.value.mapValue.fields}}function z8(n,e,t){const i=gp(n,e.name),r=xr(e.updateTime),s=e.createTime?xr(e.createTime):Ze.min(),o=new pr({mapValue:{fields:e.fields}}),l=xn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function lm(n,e){let t;if(e instanceof mf)t={update:SR(n,e.key,e.value)};else if(e instanceof ax)t={delete:am(n,e.key)};else if(e instanceof Nc)t={update:SR(n,e.key,e.data),updateMask:X8(e.fieldMask)};else{if(!(e instanceof mD))return Re(16599,{Vt:e.type});t={verify:am(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Bd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Sc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Cc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Gd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Re(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:j8(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re(27497)})(n,e.precondition)),t}function ow(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?_r.updateTime(xr(s.updateTime)):s.exists!==void 0?_r.exists(s.exists):_r.none()})(e.currentDocument):_r.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let c=null;if("setToServerValue"in l)De(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new Bd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];c=new Sc(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];c=new Cc(f)}else"increment"in l?c=new Gd(o,l.increment):Re(16584,{proto:l});const h=zt.fromServerFormat(l.fieldPath);return new A8(h,c)})(n,r))):[];if(e.update){e.update.name;const r=gp(n,e.update.name),s=new pr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const h=c.fieldPaths||[];return new Fs(h.map((f=>zt.fromServerFormat(f))))})(e.updateMask);return new Nc(r,s,o,t,i)}return new mf(r,s,t,i)}if(e.delete){const r=gp(n,e.delete);return new ax(r,t)}if(e.verify){const r=gp(n,e.verify);return new mD(r,t)}return Re(1463,{proto:e})}function B8(n,e){return n&&n.length>0?(De(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?xr(r.updateTime):xr(s);return o.isEqual(Ze.min())&&(o=xr(s)),new b8(o,r.transformResults||[])})(t,e)))):[]}function G8(n,e){return{documents:[vD(n,e.path)]}}function W8(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=vD(n,r);const s=(function(h){if(h.length!==0)return ID(gt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Lu(y.field),direction:K8(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=F8(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function xD(n){let e=wD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){De(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){const y=TD(m);return y instanceof gt&&ox(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((y=>(function(x){return new sm(Ou(x.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(m){let y;return y=typeof m=="object"?m.value:m,Qm(y)?null:y})(t.limit));let c=null;t.startAt&&(c=(function(m){const y=!!m.before,E=m.values||[];return new Tc(E,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const y=!m.before,E=m.values||[];return new Tc(E,y)})(t.endAt)),d8(e,r,o,s,l,"F",c,h)}function TD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ou(t.unaryFilter.field);return Xe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Ou(t.unaryFilter.field);return Xe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ou(t.unaryFilter.field);return Xe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ou(t.unaryFilter.field);return Xe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Xe.create(Ou(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gt.create(t.compositeFilter.filters.map((i=>TD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function K8(n){return N8[n]}function $8(n){return L8[n]}function H8(n){return O8[n]}function Lu(n){return{fieldPath:n.canonicalString()}}function Ou(n){return zt.fromServerFormat(n.fieldPath)}function ID(n){return n instanceof Xe?(function(t){if(t.op==="=="){if(fR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NAN"}};if(dR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(fR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NOT_NAN"}};if(dR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lu(t.field),op:$8(t.op),value:t.value}}})(n):n instanceof gt?(function(t){const i=t.getFilters().map((r=>ID(r)));return i.length===1?i[0]:{compositeFilter:{op:H8(t.op),filters:i}}})(n):Re(54877,{filter:n})}function X8(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function q8(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ku{constructor(e,t,i,r,s=Ze.min(),o=Ze.min(),l=ai.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ku(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ku(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ku(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ku(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class SD{constructor(e){this.yt=e}}function Y8(n,e){let t;if(e.document)t=z8(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=ve.fromSegments(e.noDocument.path),r=Sl(e.noDocument.readTime);t=xn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re(56709);{const i=ve.fromSegments(e.unknownDocument.path),r=Sl(e.unknownDocument.version);t=xn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new bt(r[0],r[1]);return Ze.fromTimestamp(s)})(e.readTime)),t}function CR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:um(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:am(s,o.key),fields:o.data.value.mapValue.fields,updateTime:rw(s,o.version.toTimestamp()),createTime:rw(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Il(e.version)};else{if(!e.isUnknownDocument())return Re(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Il(e.version)}}return i}function um(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Il(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sl(n){const e=new bt(n.seconds,n.nanoseconds);return Ze.fromTimestamp(e)}function $a(n,e){const t=(e.baseMutations||[]).map((s=>ow(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>ow(n.yt,s))),r=bt.fromMillis(e.localWriteTimeMs);return new lx(e.batchId,r,t,i)}function Xh(n){const e=Sl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Sl(n.lastLimboFreeSnapshotVersion):Ze.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return De(o===1,1966,{count:o}),Ws(oD(wD(s.documents[0])))})(n.query):(function(s){return Ws(xD(s))})(n.query),new Ku(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ai.fromBase64String(n.resumeToken))}function CD(n,e){const t=Il(e.snapshotVersion),i=Il(e.lastLimboFreeSnapshotVersion);let r;r=h8(e.target)?G8(n.yt,e.target):W8(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Tl(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function RD(n){const e=xD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?iw(e,e.limit,"L"):e}function B0(n,e){return new cx(e.largestBatchId,ow(n.yt,e.overlayMutation))}function RR(n,e){const t=e.path.lastSegment();return[n,Bn(e.path.popLast()),t]}function AR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Il(i.readTime),documentKey:Bn(i.documentKey.path),largestBatchId:i.largestBatchId}}class Z8{getBundleMetadata(e,t){return PR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Sl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return PR(e).put((function(r){return{bundleId:r.id,createTime:Il(xr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return bR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:RD(s.bundledQuery),readTime:Sl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return bR(e).put((function(r){return{name:r.name,readTime:Il(xr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function PR(n){return en(n,Jm)}function bR(n){return en(n,ey)}class ay{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new ay(e,i)}getOverlay(e,t){return Dh(e).get(RR(this.userId,t)).next((i=>i?B0(this.serializer,i):null))}getOverlays(e,t){const i=Qr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new cx(t,o);r.push(this.St(e,l))})),Y.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Bn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dh(e).Z(Yv,l))})),Y.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Qr(),s=Bn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dh(e).J(Yv,o).next((l=>{for(const c of l){const h=B0(this.serializer,c);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=Qr();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dh(e).ee({index:F2,range:l},((c,h,f)=>{const m=B0(this.serializer,h);s.size()<r||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Dh(e).put((function(r,s,o){const[l,c,h]=RR(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:lm(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dh(n){return en(n,ty)}class Q8{bt(e){return en(e,tx)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?ai.fromUint8Array(i):ai.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Ha{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt($t(e.integerValue));else if("doubleValue"in e){const i=$t(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Qp(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ta(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(vc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?Z2(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ny(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Re(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=rm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt($t(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),ve.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ha.Kt=new Ha;const Cu=255;function J8(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function kR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=J8(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class eW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=kR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=kR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Cu),this.sn(255)}_n(){this.an(Cu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Cu?(this.sn(Cu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Cu?(this.an(Cu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class tW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class nW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Mh{constructor(){this.cn=new eW,this.ln=new tW(this.cn),this.hn=new nW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Xa{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Xa(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:pp(this.En),directionalValue:pp(this.dn),orderedDocumentKey:pp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function bo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=DR(n.En,e.En),t!==0?t:(t=DR(n.dn,e.dn),t!==0?t:ve.comparator(n.In,e.In)))}function DR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function pp(n){return Ok()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function MR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class NR{constructor(e){this.mn=new mt(((t,i)=>zt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(De(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Hv(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ba(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const c=i[s];if(!this.Sn(l,c)||!this.bn(this.fn[o++],c))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(zt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new up(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new up(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new up(i.field,i.dir==="asc"?0:1)));return new Zp(Zp.UNKNOWN_ID,this.collectionId,t,Od.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function AD(n){if(De(n instanceof Xe||n instanceof gt,20012),n instanceof Xe){if(n instanceof sD){const t=n.value.arrayValue?.values?.map((i=>Xe.create(n.field,"==",i)))||[];return gt.create(t,"or")}return n}const e=n.filters.map((t=>AD(t)));return gt.create(e,n.op)}function iW(n){if(n.getFilters().length===0)return[];const e=uw(AD(n));return De(PD(e),7391),aw(e)||lw(e)?[e]:e.getFilters()}function aw(n){return n instanceof Xe}function lw(n){return n instanceof gt&&ox(n)}function PD(n){return aw(n)||lw(n)||(function(t){if(t instanceof gt&&ew(t)){for(const i of t.getFilters())if(!aw(i)&&!lw(i))return!1;return!0}return!1})(n)}function uw(n){if(De(n instanceof Xe||n instanceof gt,34018),n instanceof Xe)return n;if(n.filters.length===1)return uw(n.filters[0]);const e=n.filters.map((i=>uw(i)));let t=gt.create(e,n.op);return t=cm(t),PD(t)?t:(De(t instanceof gt,64498),De(Ic(t),40251),De(t.filters.length>1,57927),t.filters.reduce(((i,r)=>hx(i,r))))}function hx(n,e){let t;return De(n instanceof Xe||n instanceof gt,38388),De(e instanceof Xe||e instanceof gt,25473),t=n instanceof Xe?e instanceof Xe?(function(r,s){return gt.create([r,s],"and")})(n,e):LR(n,e):e instanceof Xe?LR(e,n):(function(r,s){if(De(r.filters.length>0&&s.filters.length>0,48005),Ic(r)&&Ic(s))return nD(r,s.getFilters());const o=ew(r)?r:s,l=ew(r)?s:r,c=o.filters.map((h=>hx(h,l)));return gt.create(c,"or")})(n,e),cm(t)}function LR(n,e){if(Ic(e))return nD(e,n.getFilters());{const t=e.filters.map((i=>hx(n,i)));return gt.create(t,"or")}}function cm(n){if(De(n instanceof Xe||n instanceof gt,11850),n instanceof Xe)return n;const e=n.getFilters();if(e.length===1)return cm(e[0]);if(eD(n))return n;const t=e.map((r=>cm(r))),i=[];return t.forEach((r=>{r instanceof Xe?i.push(r):r instanceof gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:gt.create(i,n.op)}class rW{constructor(){this.Cn=new dx}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(Ci.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(Ci.min())}updateCollectionGroup(e,t,i){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}}class dx{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new mt(Ct.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mt(Ct.comparator)).toArray()}}const OR="IndexedDbIndexManager",Hg=new Uint8Array(0);class sW{constructor(e,t){this.databaseId=t,this.vn=new dx,this.Fn=new aa((i=>Tl(i)),((i,r)=>pf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Bn(r)};return VR(e).put(s)}return Y.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[R2(t),""],!1,!0);return VR(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Zr(o.parent))}return i}))}addFieldIndex(e,t){const i=Nh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Au(e);return s.next((l=>{o.put(AR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Nh(e),r=Au(e),s=Ru(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Nh(e),i=Ru(e),r=Au(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Y.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new NR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ru(e);let r=!0;const s=new Map;return Y.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Tn();const l=[];return Y.forEach(s,((c,h)=>{de(OR,`Using index ${(function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(c)} to execute ${Tl(t)}`);const f=(function(k,O){const F=Hv(O);if(F===void 0)return null;for(const W of om(k,F.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null})(h,c),m=(function(k,O){const F=new Map;for(const W of Ba(O))for(const D of om(k,W.fieldPath))switch(D.op){case"==":case"in":F.set(W.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return F.set(W.fieldPath.canonicalString(),D.value),Array.from(F.values())}return null})(h,c),y=(function(k,O){const F=[];let W=!0;for(const D of Ba(O)){const R=D.kind===0?_R(k,D.fieldPath,k.startAt):vR(k,D.fieldPath,k.startAt);F.push(R.value),W&&(W=R.inclusive)}return new Tc(F,W)})(h,c),E=(function(k,O){const F=[];let W=!0;for(const D of Ba(O)){const R=D.kind===0?vR(k,D.fieldPath,k.endAt):_R(k,D.fieldPath,k.endAt);F.push(R.value),W&&(W=R.inclusive)}return new Tc(F,W)})(h,c),x=this.On(c,h,y),C=this.On(c,h,E),T=this.Nn(c,h,m),b=this.Bn(c.indexId,f,x,y.inclusive,C,E.inclusive,T);return Y.forEach(b,(P=>i.Y(P,t.limit).next((k=>{k.forEach((O=>{const F=ve.fromSegments(O.documentKey);o.has(F)||(o=o.add(F),l.push(F))}))}))))})).next((()=>l))}return Y.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=iW(gt.create(e.filters,"and")).map((i=>nw(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const c=(t!=null?t.length:1)*Math.max(i.length,s.length),h=c/(t!=null?t.length:1),f=[];for(let m=0;m<c;++m){const y=t?this.Ln(t[m/h]):Hg,E=this.kn(e,y,i[m%h],r),x=this.qn(e,y,s[m%h],o),C=l.map((T=>this.kn(e,y,T,!0)));f.push(...this.createRange(E,x,C))}return f}kn(e,t,i,r){const s=new Xa(e,ve.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Xa(e,ve.empty(),t,i);return r?s.An():s}xn(e,t){const i=new NR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Y.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(c){let h=new mt(zt.comparator),f=!1;for(const m of c.filters)for(const y of m.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const m of c.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Mh;for(const r of Ba(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Ha.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Mh;return Ha.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Mh;return Ha.Kt.Dt(sx(this.databaseId,t),i.Pn((function(s){const o=Ba(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Mh);let s=0;for(const o of Ba(e)){const l=i[s++];for(const c of r)if(this.Un(t,o.fieldPath)&&zd(l))r=this.Kn(r,o,l);else{const h=c.Pn(o.kind);Ha.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const c=new Mh;c.seed(l.un()),Ha.Kt.Dt(o,c.Pn(t.kind)),s.push(c)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Xe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Nh(e),r=Au(e);return(t?i.J(qv,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Y.forEach(s,(l=>r.get([l.indexId,this.uid]).next((c=>{o.push((function(f,m){const y=m?new Od(m.sequenceNumber,new Ci(Sl(m.readTime),new ve(Zr(m.documentKey)),m.largestBatchId)):Od.empty(),E=f.fields.map((([x,C])=>new up(zt.fromServerFormat(x),C)));return new Zp(f.indexId,f.collectionGroup,E,y)})(l,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:We(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Nh(e),s=Au(e);return this.Gn(e).next((o=>r.J(qv,IDBKeyRange.bound(t,t)).next((l=>Y.forEach(l,(c=>s.put(AR(c.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Y.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Y.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Y.forEach(l,(c=>this.zn(e,r,c).next((h=>{const f=this.jn(s,c);return h.isEqual(f)?Y.resolve():this.Jn(e,s,c,h,f)})))))))}))}Hn(e,t,i,r){return Ru(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ru(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ru(e);let s=new mt(bo);return r.ee({index:V2,range:IDBKeyRange.only([i.indexId,this.uid,pp(this.$n(i,t))])},((o,l)=>{s=s.add(new Xa(i.indexId,t,MR(l.arrayValue),MR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new mt(bo);const r=this.Qn(t,e);if(r==null)return i;const s=Hv(t);if(s!=null){const o=e.data.field(s.fieldPath);if(zd(o))for(const l of o.arrayValue.values||[])i=i.add(new Xa(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Xa(t.indexId,e.key,Hg,r));return i}Jn(e,t,i,r,s){de(OR,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,h,f,m,y){const E=c.getIterator(),x=h.getIterator();let C=Su(E),T=Su(x);for(;C||T;){let b=!1,P=!1;if(C&&T){const k=f(C,T);k<0?P=!0:k>0&&(b=!0)}else C!=null?P=!0:b=!0;b?(m(T),T=Su(x)):P?(y(C),C=Su(E)):(C=Su(E),T=Su(x))}})(r,s,bo,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Y.waitFor(o)}Gn(e){let t=1;return Au(e).ee({index:O2,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>bo(o,l))).filter(((o,l,c)=>!l||bo(o,c[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=bo(o,e),c=bo(o,t);if(l===0)r[0]=e.An();else if(l>0&&c<0)r.push(o),r.push(o.An());else if(c>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Hg,ve.empty()),c=r[o+1].Vn(this.uid,Hg,ve.empty());s.push(IDBKeyRange.bound(l,c))}return s}Zn(e,t){return bo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(FR)}getMinOffset(e,t){return Y.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Re(44426))))).next(FR)}}function VR(n){return en(n,jd)}function Ru(n){return en(n,od)}function Nh(n){return en(n,ex)}function Au(n){return en(n,sd)}function FR(n){De(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;ZE(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ci(e.readTime,e.documentKey,t)}const jR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bD=41943040;class Qn{static withCacheSize(e){return new Qn(e,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function kD(n,e,t){const i=n.store(hr),r=n.store(pc),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const c=i.ee({range:o},((f,m,y)=>(l++,y.delete())));s.push(c.next((()=>{De(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const m=M2(e,f.key.path,t.batchId);s.push(r.delete(m)),h.push(f.key)}return Y.waitFor(s).next((()=>h))}function hm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re(14731);e=n.noDocument}return JSON.stringify(e).length}Qn.DEFAULT_COLLECTION_PERCENTILE=10,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qn.DEFAULT=new Qn(bD,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qn.DISABLED=new Qn(-1,0,0);class ly{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){De(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new ly(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ko(e).ee({index:tl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Vu(e),o=ko(e);return o.add({}).next((l=>{De(typeof l=="number",49019);const c=new lx(l,t,i,r),h=(function(E,x,C){const T=C.baseMutations.map((P=>lm(E.yt,P))),b=C.mutations.map((P=>lm(E.yt,P)));return{userId:x,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:T,mutations:b}})(this.serializer,this.userId,c),f=[];let m=new mt(((y,E)=>We(y.canonicalString(),E.canonicalString())));for(const y of r){const E=M2(this.userId,y.key.path,l);m=m.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(E,RG))}return m.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=c.keys()})),Y.waitFor(f).next((()=>c))}))}lookupMutationBatch(e,t){return ko(e).get(t).next((i=>i?(De(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),$a(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Y.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return ko(e).ee({index:tl,range:r},((o,l,c)=>{l.userId===this.userId&&(De(l.batchId>=i,47524,{tr:i}),s=$a(this.serializer,l)),c.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ll;return ko(e).ee({index:tl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ll],[this.userId,Number.POSITIVE_INFINITY]);return ko(e).J(tl,t).next((i=>i.map((r=>$a(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=cp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vu(e).ee({range:r},((o,l,c)=>{const[h,f,m]=o,y=Zr(f);if(h===this.userId&&t.path.isEqual(y))return ko(e).get(m).next((E=>{if(!E)throw Re(61480,{nr:o,batchId:m});De(E.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:E.userId,batchId:m}),s.push($a(this.serializer,E))}));c.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(We);const r=[];return t.forEach((s=>{const o=cp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=Vu(e).ee({range:l},((h,f,m)=>{const[y,E,x]=h,C=Zr(E);y===this.userId&&s.path.isEqual(C)?i=i.add(x):m.done()}));r.push(c)})),Y.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=cp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new mt(We);return Vu(e).ee({range:o},((c,h,f)=>{const[m,y,E]=c,x=Zr(y);m===this.userId&&i.isPrefixOf(x)?x.length===r&&(l=l.add(E)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(ko(e).get(s).next((o=>{if(o===null)throw Re(35274,{batchId:s});De(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push($a(this.serializer,o))})))})),Y.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return kD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Y.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Y.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Vu(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const c=Zr(s[1]);r.push(c)}else l.done()})).next((()=>{De(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return DD(e,this.userId,t)}_r(e){return MD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ll,lastStreamToken:""}))}}function DD(n,e,t){const i=cp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Vu(n).ee({range:s,X:!0},((l,c,h)=>{const[f,m,y]=l;f===e&&m===r&&(o=!0),h.done()})).next((()=>o))}function ko(n){return en(n,hr)}function Vu(n){return en(n,pc)}function MD(n){return en(n,Vd)}class Cl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cl(0)}static cr(){return new Cl(-1)}}class oW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Cl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ze.fromTimestamp(new bt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Pu(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(De(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Pu(e).ee(((o,l)=>{const c=Xh(l);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))})).next((()=>Y.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Pu(e).ee(((i,r)=>{const s=Xh(r);t(s)}))}lr(e){return UR(e).get(tm).next((t=>(De(t!==null,2888),t)))}hr(e,t){return UR(e).put(tm,t)}Pr(e,t){return Pu(e).put(CD(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Tl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Pu(e).ee({range:r,index:L2},((o,l,c)=>{const h=Xh(l);pf(t,h.target)&&(s=h,c.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Uo(e);return t.forEach((o=>{const l=Bn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Y.waitFor(r)}removeMatchingKeys(e,t,i){const r=Uo(e);return Y.forEach(t,(s=>{const o=Bn(s.path);return Y.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Uo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Uo(e);let s=Tn();return r.ee({range:i,X:!0},((o,l,c)=>{const h=Zr(o[1]),f=new ve(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Bn(t.path),r=IDBKeyRange.bound([i],[R2(i)],!1,!0);let s=0;return Uo(e).ee({index:JE,X:!0,range:r},(([o,l],c,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Pu(e).get(t).next((i=>i?Xh(i):null))}}function Pu(n){return en(n,mc)}function UR(n){return en(n,ul)}function Uo(n){return en(n,yc)}const zR="LruGarbageCollector",aW=1048576;function BR([n,e],[t,i]){const r=We(n,t);return r===0?We(e,i):r}class lW{constructor(e){this.Ir=e,this.buffer=new mt(BR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();BR(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class uW{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){de(zR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ml(t)?de(zR,"Ignoring IndexedDB error during garbage collection: ",t):await Ym(t)}await this.Vr(3e5)}))}}class cW{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(yr.ce);const i=new lW(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(jR)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,c,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r)))).next((m=>(i=m,l=Date.now(),this.removeTargets(e,i,t)))).next((m=>(s=m,c=Date.now(),this.removeOrphanedDocuments(e,i)))).next((m=>(h=Date.now(),Nu()<=Ke.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${m} documents in `+(h-c)+`ms
Total Duration: ${h-f}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m}))))}}function hW(n,e){return new cW(n,e)}class dW{constructor(e,t){this.db=e,this.garbageCollector=hW(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Xg(e,i)}removeReference(e,t,i){return Xg(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Xg(e,t)}br(e,t){return(function(r,s){let o=!1;return MD(r).te((l=>DD(r,l,s).next((c=>(c&&(o=!0),Y.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const c=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Ze.min()),Uo(e).delete((function(m){return[0,Bn(m.path)]})(o)))))}));r.push(c)}})).next((()=>Y.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Xg(e,t)}Sr(e,t){const i=Uo(e);let r,s=yr.ce;return i.ee({index:JE},(([o,l],{path:c,sequenceNumber:h})=>{o===0?(s!==yr.ce&&t(new ve(Zr(r)),s),s=h,r=c):s=yr.ce})).next((()=>{s!==yr.ce&&t(new ve(Zr(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Xg(n,e){return Uo(n).put((function(i,r){return{targetId:0,path:Bn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class ND{constructor(){this.changes=new aa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Y.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class fW{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Oa(e).put(i)}removeEntry(e,t,i){return Oa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],um(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=xn.newInvalidDocument(t);return Oa(e).ee({index:hp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:xn.newInvalidDocument(t)};return Oa(e).ee({index:hp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i={document:this.Cr(t,s),size:hm(s)}})).next((()=>i))}getEntries(e,t){let i=nl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=nl(),r=new oi(ve.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,hm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Y.resolve();let r=new mt(KR);t.forEach((c=>r=r.add(c)));const s=IDBKeyRange.bound(Lh(r.first()),Lh(r.last())),o=r.getIterator();let l=o.getNext();return Oa(e).ee({index:hp,range:s},((c,h,f)=>{const m=ve.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&KR(l,m)<0;)i(l,null),l=o.getNext();l&&l.isEqual(m)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Lh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),um(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Oa(e).J(IDBKeyRange.bound(l,c,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=nl();for(const m of h){const y=this.Cr(ve.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);y.isFoundDocument()&&(ry(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=nl();const o=WR(t,i),l=WR(t,Ci.max());return Oa(e).ee({index:N2,range:IDBKeyRange.bound(o,l,!0)},((c,h,f)=>{const m=this.Cr(ve.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(m.key,m),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new gW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return GR(e).get(Xv).next((t=>(De(!!t,20021),t)))}Dr(e,t){return GR(e).put(Xv,t)}Cr(e,t){if(t){const i=Y8(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ze.min())))return i}return xn.newInvalidDocument(e)}}function LD(n){return new fW(n)}class gW extends ND{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new aa((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new mt(((s,o)=>We(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=CR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=hm(c);i+=h-l.size,t.push(this.Nr.addEntry(e,s,c))}else if(i-=l.size,this.trackRemovals){const c=CR(this.Nr.serializer,o.convertToNoDocument(Ze.min()));t.push(this.Nr.addEntry(e,s,c))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Y.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function GR(n){return en(n,Fd)}function Oa(n){return en(n,em)}function Lh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function WR(n,e){const t=e.documentKey.path.toArray();return[n,um(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function KR(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=We(t[s],i[s]),r)return r;return r=We(t.length,i.length),r||(r=We(t[t.length-2],i[i.length-2]),r||We(t[t.length-1],i[i.length-1]))}class pW{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class OD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&cd(i.mutation,r,Fs.empty(),bt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Tn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Tn()){const r=Qr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=$g();return s.forEach(((l,c)=>{o=o.insert(l,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=Qr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Tn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=nl();const o=ud(),l=(function(){return ud()})();return t.forEach(((c,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Nc)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),cd(f.mutation,h,f.mutation.getFieldMask(),bt.now())):o.set(h.key,Fs.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new pW(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=ud();let r=new oi(((o,l)=>o-l)),s=Tn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((c=>{const h=t.get(c);if(h===null)return;let f=i.get(c)||Fs.empty();f=l.applyToLocalView(h,f),i.set(c,f);const m=(r.get(l.batchId)||Tn()).add(c);r=r.insert(l.batchId,m)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,f=c.value,m=cD();f.forEach((y=>{if(!s.has(y)){const E=gD(t.get(y),i.get(y));E!==null&&m.set(y,E),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return Y.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return ve.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):f8(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Y.resolve(Qr());let l=Ld,c=s;return o.next((h=>Y.forEach(h,((f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(f)?Y.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{c=c.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,c,h,Tn()))).next((f=>({batchId:l,changes:_8(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ve(t)).next((i=>{let r=$g();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=$g();return this.indexManager.getCollectionParents(e,s).next((l=>Y.forEach(l,(c=>{const h=(function(m,y){return new iy(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((m,y)=>{o=o.insert(m,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((c,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,xn.newInvalidDocument(f)))}));let l=$g();return o.forEach(((c,h)=>{const f=s.get(c);f!==void 0&&cd(f.mutation,h,Fs.empty(),bt.now()),ry(t,h)&&(l=l.insert(c,h))})),l}))}}class mW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:xr(r.createTime)}})(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:RD(r.bundledQuery),readTime:xr(r.readTime)}})(t)),Y.resolve()}}class yW{constructor(){this.overlays=new oi(ve.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Qr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Y.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Y.resolve()}getOverlaysForCollection(e,t,i){const r=Qr(),s=t.length+1,o=new ve(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return Y.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new oi(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=Qr(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=Qr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Y.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new cx(t,i));let s=this.qr.get(t);s===void 0&&(s=Tn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class _W{constructor(){this.sessionToken=ai.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}}class fx{constructor(){this.Qr=new mt(ln.$r),this.Ur=new mt(ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new ln(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new ln(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new ve(new Ct([])),i=new ln(t,e),r=new ln(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ve(new Ct([])),i=new ln(t,e),r=new ln(t,e+1);let s=Tn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new ln(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class ln{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ve.comparator(e.key,t.key)||We(e.Yr,t.Yr)}static Kr(e,t){return We(e.Yr,t.Yr)||ve.comparator(e.key,t.key)}}class vW{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mt(ln.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new lx(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new ln(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?ll:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new ln(t,0),r=new ln(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(We);return t.forEach((r=>{const s=new ln(r,0),o=new ln(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Y.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;ve.isDocumentKey(s)||(s=s.child(""));const o=new ln(new ve(s),0);let l=new mt(We);return this.Zr.forEachWhile((c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(c.Yr)),!0)}),o),Y.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){De(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Y.forEach(t.mutations,(r=>{const s=new ln(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new ln(t,0),r=this.Zr.firstAfterOrEqual(i);return Y.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class wW{constructor(e){this.ri=e,this.docs=(function(){return new oi(ve.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Y.resolve(i?i.document.mutableCopy():xn.newInvalidDocument(t))}getEntries(e,t){let i=nl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():xn.newInvalidDocument(r))})),Y.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=nl();const o=t.path,l=new ve(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:f}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||ZE(P2(f),i)<=0||(r.has(f.key)||ry(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Y.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Re(9500)}ii(e,t){return Y.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new EW(this)}getSize(e){return Y.resolve(this.size)}}class EW extends ND{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class xW{constructor(e){this.persistence=e,this.si=new aa((t=>Tl(t)),pf),this.lastRemoteSnapshotVersion=Ze.min(),this.highestTargetId=0,this.oi=0,this._i=new fx,this.targetCount=0,this.ai=Cl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Cl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Y.waitFor(s).next((()=>r))}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Y.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Y.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Y.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Y.resolve(i)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}}class VD{constructor(e,t){this.ui={},this.overlays={},this.ci=new yr(0),this.li=!1,this.li=!0,this.hi=new _W,this.referenceDelegate=e(this),this.Pi=new xW(this),this.indexManager=new rW,this.remoteDocumentCache=(function(r){return new wW(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new SD(t),this.Ii=new mW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new yW,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new vW(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){de("MemoryPersistence","Starting transaction:",e);const r=new TW(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Y.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class TW extends k2{constructor(e){super(),this.currentSequenceNumber=e}}class uy{constructor(e){this.persistence=e,this.Ri=new fx,this.Vi=null}static mi(e){return new uy(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Y.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,(i=>{const r=ve.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Ze.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class IW{constructor(e){this.serializer=e}k(e,t,i,r){const s=new Zm("createOrUpgrade",t);i<1&&r>=1&&((function(c){c.createObjectStore(gf)})(e),(function(c){c.createObjectStore(Vd,{keyPath:CG}),c.createObjectStore(hr,{keyPath:oR,autoIncrement:!0}).createIndex(tl,aR,{unique:!0}),c.createObjectStore(pc)})(e),$R(e),(function(c){c.createObjectStore(Ga)})(e));let o=Y.resolve();return i<3&&r>=3&&(i!==0&&((function(c){c.deleteObjectStore(yc),c.deleteObjectStore(mc),c.deleteObjectStore(ul)})(e),$R(e)),o=o.next((()=>(function(c){const h=c.store(ul),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ze.min().toTimestamp(),targetCount:0};return h.put(tm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(c,h){return h.store(hr).J().next((m=>{c.deleteObjectStore(hr),c.createObjectStore(hr,{keyPath:oR,autoIncrement:!0}).createIndex(tl,aR,{unique:!0});const y=h.store(hr),E=m.map((x=>y.put(x)));return Y.waitFor(E)}))})(e,s)))),o=o.next((()=>{(function(c){c.createObjectStore(_c,{keyPath:LG})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(c){c.createObjectStore(Fd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(Jm,{keyPath:OG})})(e),(function(c){c.createObjectStore(ey,{keyPath:VG})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(c){const h=c.createObjectStore(ty,{keyPath:WG});h.createIndex(Yv,KG,{unique:!1}),h.createIndex(F2,$G,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(c){const h=c.createObjectStore(em,{keyPath:AG});h.createIndex(hp,PG),h.createIndex(N2,bG)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ga)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(c){c.createObjectStore(ex,{keyPath:FG,autoIncrement:!0}).createIndex(qv,jG,{unique:!1}),c.createObjectStore(sd,{keyPath:UG}).createIndex(O2,zG,{unique:!1}),c.createObjectStore(od,{keyPath:BG}).createIndex(V2,GG,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(tx,{keyPath:HG})})(e)}))),i<18&&r>=18&&Ok()&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),o}wi(e){let t=0;return e.store(Ga).ee(((i,r)=>{t+=hm(r)})).next((()=>{const i={byteSize:t};return e.store(Fd).put(Xv,i)}))}yi(e){const t=e.store(Vd),i=e.store(hr);return t.J().next((r=>Y.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ll],[s.userId,s.lastAcknowledgedBatchId]);return i.J(tl,o).next((l=>Y.forEach(l,(c=>{De(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const h=$a(this.serializer,c);return kD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(yc),i=e.store(Ga);return e.store(ul).get(tm).next((r=>{const s=[];return i.ee(((o,l)=>{const c=new Ct(o),h=(function(m){return[0,Bn(m)]})(c);s.push(t.get(h).next((f=>f?Y.resolve():(m=>t.put({targetId:0,path:Bn(m),sequenceNumber:r.highestListenSequenceNumber}))(c))))})).next((()=>Y.waitFor(s)))}))}bi(e,t){e.createObjectStore(jd,{keyPath:NG});const i=t.store(jd),r=new dx,s=o=>{if(r.add(o)){const l=o.lastSegment(),c=o.popLast();return i.put({collectionId:l,parent:Bn(c)})}};return t.store(Ga).ee({X:!0},((o,l)=>{const c=new Ct(o);return s(c.popLast())})).next((()=>t.store(pc).ee({X:!0},(([o,l,c],h)=>{const f=Zr(l);return s(f.popLast())}))))}Di(e){const t=e.store(mc);return t.ee(((i,r)=>{const s=Xh(r),o=CD(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Ga),r=[];return i.ee(((s,o)=>{const l=t.store(em),c=(function(m){return m.document?new ve(Ct.fromString(m.document.name).popFirst(5)):m.noDocument?ve.fromSegments(m.noDocument.path):m.unknownDocument?ve.fromSegments(m.unknownDocument.path):Re(36783)})(o).path.toArray(),h={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Y.waitFor(r)))}Fi(e,t){const i=t.store(hr),r=LD(this.serializer),s=new VD(uy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((c=>{let h=l.get(c.userId)??Tn();$a(this.serializer,c).keys().forEach((f=>h=h.add(f))),l.set(c.userId,h)})),Y.forEach(l,((c,h)=>{const f=new wn(h),m=ay.wt(this.serializer,f),y=s.getIndexManager(f),E=ly.wt(f,this.serializer,y,s.referenceDelegate);return new OD(r,E,m,y).recalculateAndSaveOverlaysForDocumentKeys(new Zv(t,yr.ce),c).next()}))}))}}function $R(n){n.createObjectStore(yc,{keyPath:DG}).createIndex(JE,MG,{unique:!0}),n.createObjectStore(mc,{keyPath:"targetId"}).createIndex(L2,kG,{unique:!0}),n.createObjectStore(ul)}const Do="IndexedDbPersistence",G0=18e5,W0=5e3,K0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",SW="main";class gx{constructor(e,t,i,r,s,o,l,c,h,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!gx.v())throw new Ee(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dW(this,r),this.$i=t+SW,this.serializer=new SD(c),this.Ui=new Yo(this.$i,this.Ni,new IW(this.serializer)),this.hi=new Q8,this.Pi=new oW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=LD(this.serializer),this.Ii=new Z8,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&wi(Do,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ee(se.FAILED_PRECONDITION,K0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new yr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>qg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ml(e))return de(Do,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return de(Do,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Oh(e).get(Iu).next((t=>Y.resolve(this.es(t))))}ts(e){return qg(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,G0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=en(t,_c);return i.J().next((r=>{const s=this.ss(r,G0),o=r.filter((l=>s.indexOf(l)===-1));return Y.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Y.resolve(!0):Oh(e).get(Iu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,W0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ee(se.FAILED_PRECONDITION,K0);return!1}}return!(!this.networkEnabled||!this.inForeground)||qg(e).J().next((i=>this.ss(i,W0).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&de(Do,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[gf,_c],(e=>{const t=new Zv(e,yr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>qg(e).J().next((t=>this.ss(t,G0).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ly.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new sW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ay.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){de(Do,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?YG:c===17?B2:c===16?qG:c===15?nx:c===14?z2:c===13?U2:c===12?XG:c===11?j2:void Re(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new Zv(l,this.ci?this.ci.next():yr.ce),t==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw wi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ee(se.FAILED_PRECONDITION,b2);return i(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Oh(e).get(Iu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,W0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ee(se.FAILED_PRECONDITION,K0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oh(e).put(Iu,t)}static v(){return Yo.v()}Zi(e){const t=Oh(e);return t.get(Iu).next((i=>this.es(i)?(de(Do,"Releasing primary lease."),t.delete(Iu)):Y.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(wi(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Lk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return de(Do,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return wi(Do,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){wi("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Oh(n){return en(n,gf)}function qg(n){return en(n,_c)}function CW(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class px{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Tn(),r=Tn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new px(e,t.fromCache,i,r)}}class RW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class FD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Lk()?8:D2(Jt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new RW;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Nu()<=Ke.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",kh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Y.resolve()):(Nu()<=Ke.DEBUG&&de("QueryEngine","Query:",kh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Nu()<=Ke.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",kh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ws(t))):Y.resolve())}ys(e,t){if(wR(t))return Y.resolve(null);let i=Ws(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=iw(t,null,"F"),i=Ws(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Tn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((c=>{const h=this.Ds(t,l);return this.Cs(t,h,o,c.readTime)?this.ys(e,iw(t,null,"F")):this.vs(e,h,t,c)}))))})))))}ws(e,t,i,r){return wR(t)||r.isEqual(Ze.min())?Y.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Y.resolve(null):(Nu()<=Ke.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kh(t)),this.vs(e,o,t,wG(r,Ld)).next((l=>l)))}))}Ds(e,t){let i=new mt(p8(e));return t.forEach(((r,s)=>{ry(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Nu()<=Ke.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",kh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ci.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const AW="LocalStore";class PW{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new oi(We),this.xs=new aa((s=>Tl(s)),pf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function jD(n,e,t,i){return new PW(n,e,t,i)}async function bW(n,e){const t=Tt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let c=Tn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)c=c.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(i,c).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function kW(n,e){const t=Tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,c,h,f){const m=h.batch,y=m.keys();let E=Y.resolve();return y.forEach((x=>{E=E.next((()=>f.getEntry(c,x))).next((C=>{const T=h.docVersions.get(x);De(T!==null,48541),C.version.compareTo(T)<0&&(m.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))}))})),E.next((()=>l.mutationQueue.removeMutationBatch(c,m)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let c=Tn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function DW(n){const e=Tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function MW(n,e){const t=Tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ll),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class HR{constructor(){this.activeTargetIds=x8()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class UD{constructor(){this.Mo=new HR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new HR,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class NW{Oo(e){}shutdown(){}}const XR="ConnectivityMonitor";class qR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){de(XR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){de(XR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Yg=null;function cw(){return Yg===null?Yg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Yg++,"0x"+Yg.toString(16)}const $0="RestConnection",LW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class OW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===im?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=cw(),l=this.zo(e,t.toUriEncodedString());de($0,`Sending RPC '${e}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,s);const{host:h}=new URL(l),f=kl(h);return this.Jo(e,l,c,i,f).then((m=>(de($0,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw qm($0,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",i),m}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=LW[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class VW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const bn="WebChannelConnection";class FW extends OW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=cw();return new Promise(((l,c)=>{const h=new v2;h.setWithCredentials(!0),h.listenOnce(w2.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case lp.NO_ERROR:const m=h.getResponseJson();de(bn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case lp.TIMEOUT:de(bn,`RPC '${e}' ${o} timed out`),c(new Ee(se.DEADLINE_EXCEEDED,"Request time out"));break;case lp.HTTP_ERROR:const y=h.getStatus();if(de(bn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const x=E?.error;if(x&&x.status&&x.message){const C=(function(b){const P=b.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(P)>=0?P:se.UNKNOWN})(x.status);c(new Ee(C,x.message))}else c(new Ee(se.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new Ee(se.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{de(bn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);de(bn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=cw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=T2(),l=x2(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const f=s.join("");de(bn,`Creating RPC '${e}' stream ${r}: ${f}`,c);const m=o.createWebChannel(f,c);this.I_(m);let y=!1,E=!1;const x=new VW({Yo:T=>{E?de(bn,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(y||(de(bn,`Opening RPC '${e}' stream ${r} transport.`),m.open(),y=!0),de(bn,`RPC '${e}' stream ${r} sending:`,T),m.send(T))},Zo:()=>m.close()}),C=(T,b,P)=>{T.listen(b,(k=>{try{P(k)}catch(O){setTimeout((()=>{throw O}),0)}}))};return C(m,Hh.EventType.OPEN,(()=>{E||(de(bn,`RPC '${e}' stream ${r} transport opened.`),x.o_())})),C(m,Hh.EventType.CLOSE,(()=>{E||(E=!0,de(bn,`RPC '${e}' stream ${r} transport closed`),x.a_(),this.E_(m))})),C(m,Hh.EventType.ERROR,(T=>{E||(E=!0,qm(bn,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),x.a_(new Ee(se.UNAVAILABLE,"The operation could not be completed")))})),C(m,Hh.EventType.MESSAGE,(T=>{if(!E){const b=T.data[0];De(!!b,16349);const P=b,k=P?.error||P[0]?.error;if(k){de(bn,`RPC '${e}' stream ${r} received error:`,k);const O=k.status;let F=(function(R){const M=Kt[R];if(M!==void 0)return M8(M)})(O),W=k.message;F===void 0&&(F=se.INTERNAL,W="Unknown error status: "+O+" with message "+k.message),E=!0,x.a_(new Ee(F,W)),m.close()}else de(bn,`RPC '${e}' stream ${r} received:`,b),x.u_(b)}})),C(l,E2.STAT_EVENT,(T=>{T.stat===Kv.PROXY?de(bn,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===Kv.NOPROXY&&de(bn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{x.__()}),0),x}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function jW(){return typeof window<"u"?window:null}function mp(){return typeof document<"u"?document:null}function zD(n){return new V8(n,!0)}class BD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&de("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const YR="PersistentStream";class UW{constructor(e,t,i,r,s,o,l,c){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new BD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(wi(t.toString()),wi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ee(se.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return de(YR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(de(YR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class zW extends UW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=B8(e.writeResults,e.commitTime),i=xr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=U8(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>lm(this.serializer,i)))};this.q_(t)}}class BW{}class GW extends BW{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ee(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,sw(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ee(se.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,sw(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ee(se.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class WW{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(wi(t),this.aa=!1):de("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const cy="RemoteStore";class KW{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{dy(this)&&(de(cy,"Restarting streams for network reachability change."),await(async function(c){const h=Tt(c);h.Ea.add(4),await hy(h),h.Ra.set("Unknown"),h.Ea.delete(4),await mx(h)})(this))}))})),this.Ra=new WW(i,r)}}async function mx(n){if(dy(n))for(const e of n.da)await e(!0)}async function hy(n){for(const e of n.da)await e(!1)}function dy(n){return Tt(n).Ea.size===0}async function GD(n,e,t){if(!Ml(e))throw e;n.Ea.add(1),await hy(n),n.Ra.set("Offline"),t||(t=()=>DW(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{de(cy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await mx(n)}))}function WD(n,e){return e().catch((t=>GD(n,t,e)))}async function fy(n){const e=Tt(n),t=ia(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ll;for(;$W(e);)try{const r=await MW(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,HW(e,r)}catch(r){await GD(e,r)}KD(e)&&$D(e)}function $W(n){return dy(n)&&n.Ta.length<10}function HW(n,e){n.Ta.push(e);const t=ia(n);t.O_()&&t.X_&&t.ea(e.mutations)}function KD(n){return dy(n)&&!ia(n).x_()&&n.Ta.length>0}function $D(n){ia(n).start()}async function XW(n){ia(n).ra()}async function qW(n){const e=ia(n);for(const t of n.Ta)e.ea(t.mutations)}async function YW(n,e,t){const i=n.Ta.shift(),r=ux.from(i,e,t);await WD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await fy(n)}async function ZW(n,e){e&&ia(n).X_&&await(async function(i,r){if((function(o){return D8(o)&&o!==se.ABORTED})(r.code)){const s=i.Ta.shift();ia(i).B_(),await WD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await fy(i)}})(n,e),KD(n)&&$D(n)}async function QW(n,e){const t=Tt(n);e?(t.Ea.delete(2),await mx(t)):e||(t.Ea.add(2),await hy(t),t.Ra.set("Unknown"))}function ia(n){return n.fa||(n.fa=(function(t,i,r){const s=Tt(t);return s.sa(),new zW(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:XW.bind(null,n),r_:ZW.bind(null,n),ta:qW.bind(null,n),na:YW.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await fy(n)):(await n.fa.stop(),n.Ta.length>0&&(de(cy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class yx{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new al,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new yx(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function JW(n,e){if(wi("AsyncQueue",`${e}: ${n}`),Ml(n))return new Ee(se.UNAVAILABLE,`${e}: ${n}`);throw n}class e7{constructor(){this.queries=ZR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Tt(t),s=r.queries;r.queries=ZR(),s.forEach(((o,l)=>{for(const c of l.Sa)c.onError(i)}))})(this,new Ee(se.ABORTED,"Firestore shutting down"))}}function ZR(){return new aa((n=>lD(n)),aD)}function t7(n){n.Ca.forEach((e=>{e.next()}))}var QR,JR;(JR=QR||(QR={})).Ma="default",JR.Cache="cache";const n7="SyncEngine";class i7{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new aa((l=>lD(l)),aD),this.Iu=new Map,this.Eu=new Set,this.du=new oi(ve.comparator),this.Au=new Map,this.Ru=new fx,this.Vu={},this.mu=new Map,this.fu=Cl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function eA(n,e,t){const i=Tt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const c=Tt(o);c.onlineState=l;let h=!1;c.queries.forEach(((f,m)=>{for(const y of m.Sa)y.va(l)&&(h=!0)})),h&&t7(c)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function r7(n,e){const t=Tt(n),i=e.batch.batchId;try{const r=await kW(t.localStore,e);XD(t,i,null),HD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await _x(t,r)}catch(r){await Ym(r)}}async function s7(n,e,t){const i=Tt(n);try{const r=await(function(o,l){const c=Tt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return c.mutationQueue.lookupMutationBatch(h,l).next((m=>(De(m!==null,37113),f=m.keys(),c.mutationQueue.removeMutationBatch(h,m)))).next((()=>c.mutationQueue.performConsistencyCheck(h))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>c.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);XD(i,e,t),HD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await _x(i,r)}catch(r){await Ym(r)}}function HD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function XD(n,e,t){const i=Tt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function _x(n,e,t){const i=Tt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,c)=>{o.push(i.pu(c,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(h){r.push(h);const f=px.As(c.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(c,h){const f=Tt(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>Y.forEach(h,(y=>Y.forEach(y.Es,(E=>f.persistence.referenceDelegate.addReference(m,y.targetId,E))).next((()=>Y.forEach(y.ds,(E=>f.persistence.referenceDelegate.removeReference(m,y.targetId,E)))))))))}catch(m){if(!Ml(m))throw m;de(AW,"Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const E=f.Ms.get(y),x=E.snapshotVersion,C=E.withLastLimboFreeSnapshotVersion(x);f.Ms=f.Ms.insert(y,C)}}})(i.localStore,s))}async function o7(n,e){const t=Tt(n);if(!t.currentUser.isEqual(e)){de(n7,"User change. New user:",e.toKey());const i=await bW(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((c=>{c.reject(new Ee(se.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await _x(t,i.Ls)}}function a7(n){const e=Tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=r7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s7.bind(null,e),e}class hw{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=zD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return jD(this.persistence,new FD,e.initialUser,this.serializer)}Cu(e){return new VD(uy.mi,this.serializer)}Du(e){return new UD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hw.provider={build:()=>new hw};class l7 extends hw{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await a7(this.xu.syncEngine),await fy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return jD(this.persistence,new FD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new uW(i,e.asyncQueue,t)}Mu(e,t){const i=new IG(t,this.persistence);return new TG(e.asyncQueue,i)}Cu(e){const t=CW(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Qn.withCacheSize(this.cacheSizeBytes):Qn.DEFAULT;return new gx(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,jW(),mp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new UD}}class dw{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>eA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=o7.bind(null,this.syncEngine),await QW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new e7})()}createDatastore(e){const t=zD(e.databaseInfo.databaseId),i=(function(s){return new FW(s)})(e.databaseInfo);return(function(s,o,l,c){return new GW(s,o,l,c)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new KW(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>eA(this.syncEngine,t,0)),(function(){return qR.v()?new qR:new NW})())}createSyncEngine(e,t){return(function(r,s,o,l,c,h,f){const m=new i7(r,s,o,l,c,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Tt(t);de(cy,"RemoteStore shutting down."),i.Ea.add(5),await hy(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}dw.provider={build:()=>new dw};const tA="FirestoreClient";class u7{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=C2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{de(tA,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(de(tA,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new al;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=JW(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function qD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const nA=new Map;const YD="firestore.googleapis.com",iA=!0;class rA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=YD,this.ssl=iA}else this.host=e.host,this.ssl=e.ssl??iA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=bD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<aW)throw new Ee(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yG("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ZD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new aG;switch(i.type){case"firstParty":return new hG(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ee(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=nA.get(t);i&&(de("ComponentProvider","Removing Datastore"),nA.delete(t),i.terminate())})(this),Promise.resolve()}}function c7(n,e,t,i={}){n=A2(n,ZD);const r=kl(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(NE(`https://${l}`),LE("Firestore",!0)),s.host!==YD&&s.host!==l&&qm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:l,ssl:r,emulatorOptions:i};if(!vl(c,o)&&(n._setSettings(c),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=Mk(i.mockUserToken,n._app?.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Ee(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(m)}n._authCredentials=new lG(new S2(h,f))}}class vx{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new vx(this.firestore,e,this._query)}}class Jr{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wx(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jr(this.firestore,e,this._key)}toJSON(){return{type:Jr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(ff(t,Jr._jsonSchema))return new Jr(e,i||null,new ve(Ct.fromString(t.referencePath)))}}Jr._jsonSchemaVersion="firestore/documentReference/1.0",Jr._jsonSchema={type:Ht("string",Jr._jsonSchemaVersion),referencePath:Ht("string")};class wx extends vx{constructor(e,t,i){super(e,t,oD(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jr(this.firestore,null,new ve(e))}withConverter(e){return new wx(this.firestore,e,this._path)}}const sA="AsyncQueue";class oA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new BD(this,"async_queue_retry"),this._c=()=>{const i=mp();i&&de(sA,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=mp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=mp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new al;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ml(e))throw e;de(sA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,wi("INTERNAL UNHANDLED ERROR: ",aA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=yx.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Re(47125,{Pc:aA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function aA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class QD extends ZD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new oA,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new oA(e),this._firestoreClient=void 0,await e}}}function h7(n,e){const t=typeof n=="object"?n:FE(),i=typeof n=="string"?n:im,r=Km(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=bk("firestore");s&&c7(r,...s)}return r}function d7(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new e8(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,qD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new u7(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function f7(n,e){qm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return g7(n,dw.provider,{build:i=>new l7(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function g7(n,e,t){if((n=A2(n,QD))._firestoreClient||n._terminated)throw new Ee(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ee(se.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},d7(n)}class Ls{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ls(ai.fromBase64String(e))}catch(t){throw new Ee(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ls(ai.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ls._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ff(e,Ls._jsonSchema))return Ls.fromBase64String(e.bytes)}}Ls._jsonSchemaVersion="firestore/bytes/1.0",Ls._jsonSchema={type:Ht("string",Ls._jsonSchemaVersion),bytes:Ht("string")};class JD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ee(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ee(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ee(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return We(this._lat,e._lat)||We(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cl._jsonSchemaVersion}}static fromJSON(e){if(ff(e,cl._jsonSchema))return new cl(e.latitude,e.longitude)}}cl._jsonSchemaVersion="firestore/geoPoint/1.0",cl._jsonSchema={type:Ht("string",cl._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};class hl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:hl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ff(e,hl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new hl(e.vectorValues);throw new Ee(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}hl._jsonSchemaVersion="firestore/vectorValue/1.0",hl._jsonSchema={type:Ht("string",hl._jsonSchemaVersion),vectorValues:Ht("object")};const p7=new RegExp("[~\\*/\\[\\]]");function m7(n,e,t){if(e.search(p7)>=0)throw lA(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new JD(...e.split("."))._internalPath}catch{throw lA(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function lA(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Ee(se.INVALID_ARGUMENT,s+n+o)}class eM{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new y7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(tM("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class y7 extends eM{data(){return super.data()}}function tM(n,e){return typeof e=="string"?m7(n,e):e instanceof JD?e._internalPath:e._delegate._internalPath}class Zg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ju extends eM{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new yp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(tM("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ju._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ju._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ju._jsonSchema={type:Ht("string",Ju._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class yp extends Ju{data(e={}){return super.data(e)}}class hd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Zg(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new yp(this._firestore,this._userDataWriter,i.key,i,new Zg(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ee(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const c=new yp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const c=new yp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:_7(l.type),doc:c,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=C2.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function _7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}hd._jsonSchemaVersion="firestore/querySnapshot/1.0",hd._jsonSchema={type:Ht("string",hd._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};(function(e,t=!0){(function(r){Mc=r})(Dl),wl(new ea("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new QD(new uG(i.getProvider("auth-internal")),new dG(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ee(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wc(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),ns(QC,JC,e),ns(QC,JC,"esm2020")})();const nM="firebasestorage.googleapis.com",v7="storageBucket",w7=120*1e3,E7=600*1e3;class hs extends cs{constructor(e,t,i=0){super(H0(e),`Firebase Storage: ${t} (${H0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,hs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return H0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var os;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(os||(os={}));function H0(n){return"storage/"+n}function x7(){const n="An unknown error occurred, please check the error payload for server response.";return new hs(os.UNKNOWN,n)}function T7(){return new hs(os.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function I7(){return new hs(os.CANCELED,"User canceled the upload/download.")}function S7(n){return new hs(os.INVALID_URL,"Invalid URL '"+n+"'.")}function C7(n){return new hs(os.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function uA(n){return new hs(os.INVALID_ARGUMENT,n)}function iM(){return new hs(os.APP_DELETED,"The Firebase app was deleted.")}function R7(n){return new hs(os.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class vr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=vr.makeFromUrl(e,t)}catch{return new vr(e,"")}if(i.path==="")return i;throw C7(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(O){O.path_=decodeURIComponent(O.path)}const f="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",E=new RegExp(`^https?://${m}/${f}/b/${r}/o${y}`,"i"),x={bucket:1,path:3},C=t===nM?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",b=new RegExp(`^https?://${C}/${r}/${T}`,"i"),k=[{regex:l,indices:c,postModify:s},{regex:E,indices:x,postModify:h},{regex:b,indices:{bucket:1,path:2},postModify:h}];for(let O=0;O<k.length;O++){const F=k[O],W=F.regex.exec(e);if(W){const D=W[F.indices.bucket];let R=W[F.indices.path];R||(R=""),i=new vr(D,R),F.postModify(i);break}}if(i==null)throw S7(e);return i}}class A7{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function P7(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function c(){return l===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function m(T){r=setTimeout(()=>{r=null,n(E,c())},T)}function y(){s&&clearTimeout(s)}function E(T,...b){if(h){y();return}if(T){y(),f.call(null,T,...b);return}if(c()||o){y(),f.call(null,T,...b);return}i<64&&(i*=2);let k;l===1?(l=2,k=0):k=(i+Math.random())*1e3,m(k)}let x=!1;function C(T){x||(x=!0,y(),!h&&(r!==null?(T||(l=2),clearTimeout(r),m(0)):T||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,C(!0)},t),C}function b7(n){n(!1)}function k7(n){return n!==void 0}function cA(n,e,t,i){if(i<e)throw uA(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw uA(`Invalid value for '${n}'. Expected ${t} or less.`)}function D7(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var dm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(dm||(dm={}));function M7(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class N7{constructor(e,t,i,r,s,o,l,c,h,f,m,y=!0,E=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=m,this.retry=y,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,C)=>{this.resolve_=x,this.reject_=C,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Qg(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const c=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===dm.NO_ERROR,c=s.getStatus();if(!l||M7(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===dm.ABORT;i(!1,new Qg(!1,null,f));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new Qg(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());k7(c)?s(c):s()}catch(c){o(c)}else if(l!==null){const c=x7();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(r.canceled){const c=this.appDelete_?iM():I7();o(c)}else{const c=T7();o(c)}};this.canceled_?t(!1,new Qg(!1,null,!0)):this.backoffId_=P7(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&b7(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Qg{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function L7(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function O7(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function V7(n,e){e&&(n["X-Firebase-GMPID"]=e)}function F7(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function j7(n,e,t,i,r,s,o=!0,l=!1){const c=D7(n.urlParams),h=n.url+c,f=Object.assign({},n.headers);return V7(f,e),L7(f,t),O7(f,s),F7(f,i),new N7(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function U7(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function z7(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class fm{constructor(e,t){this._service=e,t instanceof vr?this._location=t:this._location=vr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new fm(e,t)}get root(){const e=new vr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return z7(this._location.path)}get storage(){return this._service}get parent(){const e=U7(this._location.path);if(e===null)return null;const t=new vr(this._location.bucket,e);return new fm(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw R7(e)}}function hA(n,e){const t=e?.[v7];return t==null?null:vr.makeFromBucketSpec(t,n)}function B7(n,e,t,i={}){n.host=`${e}:${t}`;const r=kl(e);r&&(NE(`https://${n.host}/b`),LE("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:Mk(s,n.app.options.projectId))}class G7{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=nM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=w7,this._maxUploadRetryTime=E7,this._requests=new Set,r!=null?this._bucket=vr.makeFromBucketSpec(r,this._host):this._bucket=hA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vr.makeFromBucketSpec(this._url,e):this._bucket=hA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fm(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new A7(iM());{const o=j7(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const dA="@firebase/storage",fA="0.14.0";const rM="storage";function W7(n=FE(),e){n=Qs(n);const i=Km(n,rM).getImmediate({identifier:e}),r=bk("storage");return r&&K7(i,...r),i}function K7(n,e,t,i={}){B7(n,e,t,i)}function $7(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new G7(t,i,r,e,Dl)}function H7(){wl(new ea(rM,$7,"PUBLIC").setMultipleInstances(!0)),ns(dA,fA,""),ns(dA,fA,"esm2020")}H7();const X7={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Ex=Uk(X7),X0=iG(Ex),q7=h7(Ex);W7(Ex);f7(q7).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const Y7="visvriend2024",Z7=new Ns,sM=ls()(af((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===Y7;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await d9(X0,Z7);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await $B(X0),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{KB(X0,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})}));function Q7({target:n}){const e=ee.useRef(null),t=ee.useRef(null),i=us(s=>s.setMap),r=yi(s=>s.showScaleBar);return ee.useEffect(()=>{if(!e.current){const s=new K6({target:n,controls:[],view:new qr({center:fl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),ee.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new X6({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const J7=["CartoDB (licht)","OpenStreetMap","Luchtfoto"];function eK(){const n=ee.useRef(null),e=ee.useRef(!1);Q7({target:"map"});const t=us(c=>c.map),i=Ho(c=>c.registerLayer),r=Ho(c=>c.setLayerVisibility),s=yi(c=>c.defaultBackground),o=yi(c=>c.gpsAutoStart),l=Wi(c=>c.startTracking);return ee.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const c=new T0({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new h6}),h=new T0({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Av({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),f=new T0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Av({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})});t.addLayer(c),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",c),i("CartoDB (licht)",h),i("Luchtfoto",f),t.updateSize(),m();async function m(){const y=wU();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async x=>{try{const C=await x.factory();return C?{name:x.name,layer:C}:null}catch(C){return console.warn(`Failed to create ${x.name}:`,C),null}}))).forEach(x=>{if(x.status==="fulfilled"&&x.value){const{name:C,layer:T}=x.value;t.addLayer(T),i(C,T)}})}},[t,i]),ee.useEffect(()=>{if(!t||e.current)return;const c=setTimeout(()=>{const h=s||"CartoDB (licht)";J7.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(c)},[t,s,r]),ee.useEffect(()=>{if(!t||!o)return;const c=setTimeout(()=>l(),500);return()=>clearTimeout(c)},[t,o,l]),S.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const tK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),nK=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),gA=n=>{const e=nK(n);return e.charAt(0).toUpperCase()+e.slice(1)},oM=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),iK=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var rK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const sK=ee.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},c)=>ee.createElement("svg",{ref:c,...rK,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:oM("lucide",r),...!s&&!iK(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>ee.createElement(h,f)),...Array.isArray(s)?s:[s]]));const qe=(n,e)=>{const t=ee.forwardRef(({className:i,...r},s)=>ee.createElement(sK,{ref:s,iconNode:e,className:oM(`lucide-${tK(gA(n))}`,`lucide-${n}`,i),...r}));return t.displayName=gA(n),t};const oK=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],aM=qe("anchor",oK);const aK=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],lK=qe("book-open",aK);const uK=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],cK=qe("check",uK);const hK=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],dK=qe("chevron-up",hK);const fK=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],lM=qe("cloud",fK);const gK=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],uM=qe("external-link",gK);const pK=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],mK=qe("eye-off",pK);const yK=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_K=qe("eye",yK);const vK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],wK=qe("file-text",vK);const EK=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],qs=qe("fish",EK);const xK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],cM=qe("info",xK);const TK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],gm=qe("layers",TK);const IK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],SK=qe("locate-fixed",IK);const CK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],RK=qe("lock",CK);const AK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],PK=qe("log-out",AK);const bK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Lc=qe("map-pin",bK);const kK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],xx=qe("map",kK);const DK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],MK=qe("menu",DK);const NK=[["path",{d:"M5 12h14",key:"1ays0h"}]],LK=qe("minus",NK);const OK=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],VK=qe("navigation",OK);const FK=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],jK=qe("person-standing",FK);const UK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],hM=qe("plus",UK);const zK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],BK=qe("rotate-ccw",zK);const GK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],WK=qe("ruler",GK);const KK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],$K=qe("save",KK);const HK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],XK=qe("scale",HK);const qK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],pA=qe("search",qK);const YK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ZK=qe("settings",YK);const QK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],JK=qe("ship",QK);const e$=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],pm=qe("star",e$);const t$=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],n$=qe("thermometer",t$);const i$=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],r$=qe("user",i$);const s$=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],o$=qe("waves",s$);const a$=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],l$=qe("wind",a$);const u$=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Nl=qe("x",u$);function c$(){const n=us(P=>P.map),e=xi(P=>P.openCatchForm),t=xi(P=>P.openSpotForm),[i,r]=ee.useState(null),[s,o]=ee.useState(!1),[l,c]=ee.useState(!1),h=ee.useRef(null),f=ee.useRef(null);ee.useEffect(()=>{if(!n)return;const P=n.getViewport();if(!P)return;const k=600,O=15,F=z=>{if(z.touches.length!==1)return;const L=z.touches[0];f.current={x:L.clientX,y:L.clientY},h.current&&clearTimeout(h.current),h.current=window.setTimeout(()=>{if(!f.current)return;const ae=window.__olMap;if(!ae)return;const pe=P.getBoundingClientRect(),fe=[f.current.x-pe.left,f.current.y-pe.top],ce=ae.getCoordinateFromPixel(fe);if(ce){const J=gS(ce);z.preventDefault(),r({pixel:[f.current.x,f.current.y],coordinate:J}),o(!0),c(!1),setTimeout(()=>c(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},k)},W=z=>{if(!h.current||!f.current)return;const L=z.touches[0],ae=L.clientX-f.current.x,pe=L.clientY-f.current.y;Math.sqrt(ae*ae+pe*pe)>O&&(clearTimeout(h.current),h.current=null)},D=()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current=null},R=z=>{s&&z.preventDefault()},M=z=>{z.button===0&&(f.current={x:z.clientX,y:z.clientY},h.current&&clearTimeout(h.current),h.current=window.setTimeout(()=>{if(!f.current)return;const L=window.__olMap;if(!L)return;const ae=P.getBoundingClientRect(),pe=[f.current.x-ae.left,f.current.y-ae.top],fe=L.getCoordinateFromPixel(pe);if(fe){const ce=gS(fe);r({pixel:[f.current.x,f.current.y],coordinate:ce}),o(!0),c(!1),setTimeout(()=>c(!0),300)}},k))},V=z=>{if(!h.current||!f.current)return;const L=z.clientX-f.current.x,ae=z.clientY-f.current.y;Math.sqrt(L*L+ae*ae)>O&&(clearTimeout(h.current),h.current=null)},j=()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current=null};return P.addEventListener("touchstart",F,{passive:!1}),P.addEventListener("touchmove",W,{passive:!0}),P.addEventListener("touchend",D),P.addEventListener("touchcancel",D),P.addEventListener("contextmenu",R),P.addEventListener("mousedown",M),P.addEventListener("mousemove",V),P.addEventListener("mouseup",j),P.addEventListener("mouseleave",j),()=>{P.removeEventListener("touchstart",F),P.removeEventListener("touchmove",W),P.removeEventListener("touchend",D),P.removeEventListener("touchcancel",D),P.removeEventListener("contextmenu",R),P.removeEventListener("mousedown",M),P.removeEventListener("mousemove",V),P.removeEventListener("mouseup",j),P.removeEventListener("mouseleave",j),h.current&&clearTimeout(h.current)}},[n,s]);const m=()=>{l&&(o(!1),r(null),c(!1))},y=()=>{o(!1),r(null),c(!1)},E=()=>{if(!i)return;const[P,k]=i.coordinate;e({lat:k,lng:P}),y()},x=()=>{if(!i)return;const[P,k]=i.coordinate;t({lat:k,lng:P}),y()},C=()=>{if(!i)return;const[P,k]=i.coordinate,O=`https://www.google.com/maps?q=${k},${P}`;window.open(O,"_blank"),y()},T=()=>{if(!i)return;const[P,k]=i.coordinate,O=`https://www.google.com/maps?layer=c&cbll=${k},${P}`;window.open(O,"_blank"),y()},b=P=>{const[k,O]=P;return`${O.toFixed(5)}N, ${k.toFixed(5)}E`};return S.jsx(ra,{children:s&&i&&S.jsxs(S.Fragment,{children:[S.jsx(it.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),S.jsxs(it.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-lg overflow-hidden min-w-[220px] border-0 outline-none",style:{left:Math.min(i.pixel[0],window.innerWidth-240),top:Math.min(i.pixel[1],window.innerHeight-280)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[S.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:S.jsxs("div",{className:"flex items-center gap-2 text-white",children:[S.jsx(Lc,{size:16}),S.jsx("span",{className:"text-xs font-mono",children:b(i.coordinate)})]})}),S.jsxs("div",{className:"bg-white",children:[S.jsxs("button",{onClick:E,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[S.jsx(qs,{size:20,className:"text-green-500"}),S.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),S.jsxs("button",{onClick:x,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[S.jsx(pm,{size:20,className:"text-orange-500"}),S.jsx("span",{className:"font-medium",children:"Locatie vastleggen"})]}),S.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[S.jsx(jK,{size:20,className:"text-yellow-600"}),S.jsx("span",{className:"font-medium",children:"Street View"})]}),S.jsxs("button",{onClick:C,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[S.jsx(uM,{size:20,className:"text-blue-600"}),S.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),S.jsx("div",{className:"bg-gray-50 border-t border-gray-100",children:S.jsxs("button",{onClick:y,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-gray-100 transition-colors bg-transparent border-0 outline-none",children:[S.jsx(Nl,{size:18}),S.jsx("span",{children:"Annuleren"})]})})]})]})})}function h$(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=Wi(),s=ee.useCallback(l=>{i(l)},[i]),o=ee.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return ee.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function d$(){const{tracking:n,toggle:e}=h$();return S.jsx(it.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:S.jsx(SK,{size:22,strokeWidth:2})})}const f$="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function g$(){const n=us(y=>y.map),e=Wi(y=>y.position),t=Wi(y=>y.accuracy),i=Wi(y=>y.tracking),r=Wi(y=>y.smoothHeading),s=yi(y=>y.showAccuracyCircle),o=Wi(y=>y.firstFix),l=Wi(y=>y.resetFirstFix),c=ee.useRef(null),h=ee.useRef(null),f=ee.useRef(null),m=ee.useMemo(()=>y=>new Yi({image:new yE({src:f$,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return ee.useEffect(()=>{if(!n||!i&&!e)return;const y=fl([5.1214,52.0907]);return c.current=new sc({geometry:new gl(y)}),c.current.setStyle(m(0)),h.current=new sc({geometry:new gl(y)}),f.current=new SE({source:new mE({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,m]),ee.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const y=fl([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const E=n.getView().getResolution()||1,x=Math.min(t/E,80);h.current.setStyle(new Yi({image:new Pl({radius:x,fill:new Tr({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Yi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),ee.useEffect(()=>{if(!c.current)return;const y=r!==null?r*Math.PI/180:0;c.current.setStyle(m(y))},[r,m]),null}function p$(){const n=us(i=>i.map),e=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r+1,duration:200})},t=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r-1,duration:200})};return S.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[S.jsx(it.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:S.jsx(hM,{size:18,className:"text-gray-600"})}),S.jsx(it.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:S.jsx(LK,{size:18,className:"text-gray-600"})})]})}function m$(){const n=us(k=>k.map),[e,t]=ee.useState(!1),[i,r]=ee.useState(""),[s,o]=ee.useState([]),[l,c]=ee.useState(!1),[h,f]=ee.useState(!1),m=ee.useRef(null),y=ee.useRef(null),E=ee.useRef();ee.useEffect(()=>{e&&m.current&&m.current.focus()},[e]),ee.useEffect(()=>{if(!e)return;const k=O=>{y.current&&!y.current.contains(O.target)&&x()};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[e]),ee.useEffect(()=>{if(!e)return;const k=O=>{O.key==="Escape"&&x()};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[e]),ee.useEffect(()=>{if(E.current&&clearTimeout(E.current),i.length<2){o([]);return}return E.current=window.setTimeout(async()=>{f(!0);try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();O.response?.docs&&o(O.response.docs)}catch(k){console.error("Search error:",k),o([])}finally{f(!1)}},300),()=>{E.current&&clearTimeout(E.current)}},[i]);const x=()=>{t(!1),r(""),o([]),c(!1)},C=async k=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(k)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const D=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(D)return{lng:parseFloat(D[1]),lat:parseFloat(D[2])}}}catch(O){console.error("Lookup error:",O)}return null},T=async k=>{if(!n)return;const O=await C(k.id);O&&n.getView().animate({center:fl([O.lng,O.lat]),zoom:16,duration:1e3}),x()},b=async(k,O)=>{O.stopPropagation();const F=await C(k.id);if(F){const W=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(W,"_blank")}x()},P={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?S.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:P,children:[S.jsxs(it.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[S.jsx(pA,{size:18,className:"search-icon"}),S.jsx("input",{ref:m,type:"text",value:i,onChange:k=>{r(k.target.value),c(!0)},onFocus:()=>c(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),S.jsx("button",{onClick:x,className:"search-clear",title:"Sluiten",children:S.jsx(Nl,{size:18})})]}),S.jsx(ra,{children:l&&s.length>0&&S.jsx(it.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(k=>S.jsxs("li",{className:"search-result-item",children:[S.jsx("div",{className:"search-result-content",onClick:()=>T(k),children:S.jsx("span",{className:"search-result-text",children:k.weergavenaam})}),S.jsx("button",{className:"search-navigate-btn",onClick:O=>b(k,O),title:"Open in Google Maps",children:S.jsx(uM,{size:20})})]},k.id))})}),l&&h&&S.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):S.jsx(it.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:P,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:S.jsx(pA,{size:22,className:"text-gray-600"})})}function y$(){const[n,e]=ee.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=xi(),{user:r,logout:s}=sM(),o={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},l=()=>e(!1),c=()=>{l(),t()},h=()=>{l(),i()},f=async()=>{l(),await s()};return S.jsxs(S.Fragment,{children:[S.jsx(it.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:o,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?S.jsx(Nl,{size:22,className:"text-white"}):S.jsx(MK,{size:22,className:"text-gray-600"})}),S.jsx(ra,{children:n&&S.jsxs(S.Fragment,{children:[S.jsx(it.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:l}),S.jsxs(it.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-56 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[S.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:S.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),S.jsx("div",{className:"py-1",children:S.jsxs("button",{onClick:c,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[S.jsx(cM,{size:18,className:"text-blue-500"}),S.jsx("span",{children:"Info & handleiding"})]})}),S.jsxs("div",{className:"mt-auto border-t border-gray-100",children:[S.jsxs("button",{onClick:h,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[S.jsx(ZK,{size:18,className:"text-gray-500"}),S.jsx("span",{children:"Instellingen"})]}),r&&S.jsxs("div",{className:"px-3 py-2 border-t border-gray-100 flex items-center gap-2",children:[r.photoURL?S.jsx("img",{src:r.photoURL,alt:"",className:"w-6 h-6 rounded-full"}):S.jsx(r$,{size:16,className:"text-gray-400"}),S.jsx("span",{className:"text-xs text-gray-500 truncate flex-1",children:r.displayName||r.email})]}),S.jsxs("button",{onClick:f,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-red-600 hover:bg-red-50 text-sm",children:[S.jsx(PK,{size:18}),S.jsx("span",{children:"Uitloggen"})]})]}),S.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.0.0"})]})]})})]})}function _$(){const{infoPanelOpen:n,toggleInfoPanel:e}=xi(),[t,i]=ee.useState("info"),r=[{id:"info",label:"Info",icon:S.jsx(cM,{size:14})},{id:"functies",label:"Functies",icon:S.jsx(wK,{size:14})},{id:"handleiding",label:"Handleiding",icon:S.jsx(lK,{size:14})}];return S.jsx(ra,{children:n&&S.jsxs(S.Fragment,{children:[S.jsx(it.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),S.jsxs(it.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[S.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[S.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.0.0"}),S.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:S.jsx(Nl,{size:18,className:"text-white",strokeWidth:2.5})})]}),S.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>S.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),S.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&S.jsx(v$,{}),t==="functies"&&S.jsx(w$,{}),t==="handleiding"&&S.jsx(E$,{}),S.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:S.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.0.0 - Voor jou en je vismaat"})})]})]})]})})}function v$(){return S.jsxs(S.Fragment,{children:[S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),S.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),S.jsxs("ul",{className:"space-y-2 text-gray-600",children:[S.jsxs("li",{children:[S.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",S.jsx("br",{}),S.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),S.jsxs("li",{children:[S.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",S.jsx("br",{}),S.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),S.jsxs("li",{children:[S.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",S.jsx("br",{}),S.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),S.jsxs("div",{className:"text-gray-600 space-y-2",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function w$(){return S.jsxs(S.Fragment,{children:[S.jsxs("section",{children:[S.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[S.jsx(xx,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),S.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[S.jsxs("li",{children:[S.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),S.jsxs("li",{children:[S.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),S.jsxs("li",{children:[S.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),S.jsxs("li",{children:[S.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),S.jsxs("li",{children:[S.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),S.jsxs("section",{children:[S.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[S.jsx(qs,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),S.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[S.jsx("li",{children:"Registreer soort, gewicht en lengte"}),S.jsx("li",{children:"Vismethode en aas bijhouden"}),S.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),S.jsx("li",{children:"GPS locatie per vangst"})]})]}),S.jsxs("section",{children:[S.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[S.jsx(Lc,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),S.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[S.jsx("li",{children:"Markeer je beste visplekken"}),S.jsx("li",{children:"Voeg notities en ratings toe"}),S.jsx("li",{children:"Welke vis zit waar?"})]})]}),S.jsxs("section",{children:[S.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[S.jsx(lM,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),S.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[S.jsx("li",{children:"Live weergegevens op je locatie"}),S.jsx("li",{children:"Windsnelheid en richting"}),S.jsx("li",{children:"Luchtdruk"}),S.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),S.jsxs("section",{children:[S.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[S.jsx(VK,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),S.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[S.jsx("li",{children:"Live GPS tracking"}),S.jsx("li",{children:"Zoek adressen en plaatsen"}),S.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function E$(){return S.jsxs(S.Fragment,{children:[S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),S.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[S.jsxs("li",{children:["Tik op de ",S.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),S.jsxs("li",{children:["Gebruik het ",S.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),S.jsxs("li",{children:["Tik op de ",S.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),S.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),S.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),S.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),S.jsxs("section",{children:[S.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),S.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[S.jsxs("li",{children:["Gebruik de ",S.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),S.jsxs("li",{children:["Check de ",S.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),S.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),S.jsxs("li",{children:["Markeer succesvolle plekken als ",S.jsx("strong",{children:"favoriet"})]})]})]})]})}const x$=fl([5.1214,52.0907]),T$=8;function I$(){const n=us(r=>r.map),e=Ho(r=>r.setLayerVisibility),t=Wi(r=>r.stopTracking),i=()=>{t(),e("CartoDB (licht)",!0),e("OpenStreetMap",!1),e("Luchtfoto",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:x$,zoom:T$,rotation:0,duration:500})};return S.jsx(it.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:S.jsx(BK,{size:18,className:"text-gray-600"})})}const S$={Map:xx,Fish:qs,Anchor:aM,Layers:gm,Star:pm},C$={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},R$={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function A$(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=CU(),[r,s]=ee.useState(!1),[o,l]=ee.useState(null),[c,h]=ee.useState(!1),[f,m]=ee.useState(""),y=C=>{e(C),s(!1)},E=(C,T)=>{C.stopPropagation();const{useLayerStore:b}=require("../../store"),P=b.getState().visible,k=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(O=>P[O]);t(T,{layers:k}),l(T),setTimeout(()=>l(null),2e3)},x=()=>{f.trim()&&(i(f.trim()),m(""),h(!1))};return S.jsxs(S.Fragment,{children:[S.jsx(it.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?S.jsx(dK,{size:20,className:"text-blue-600"}):S.jsx(gm,{size:20,className:"text-gray-600"})}),S.jsx(ra,{children:r&&S.jsxs(S.Fragment,{children:[S.jsx(it.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),S.jsxs(it.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[S.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:S.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),S.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(C=>{const T=S$[C.icon]||gm,b=C$[C.icon]||"text-blue-600",P=R$[C.icon]||"hover:bg-blue-50",k=o===C.id;return S.jsxs("button",{onClick:()=>y(C.id),className:`w-full h-9 flex items-center gap-2 px-2 ${P} rounded text-left transition-colors border-0 outline-none bg-transparent ${k?"bg-green-50":""}`,children:[S.jsx(T,{size:16,className:`${b} flex-shrink-0`}),S.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:C.name}),k?S.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:S.jsx(cK,{size:14,className:"text-green-500"})}):S.jsx("span",{onClick:O=>E(O,C.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:S.jsx($K,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},C.id)})}),S.jsx("div",{className:"border-t border-gray-200 p-2",children:c?S.jsxs("div",{className:"flex gap-1",children:[S.jsx("input",{type:"text",value:f,onChange:C=>m(C.target.value),onKeyDown:C=>{C.key==="Enter"&&x(),C.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),S.jsx("button",{onClick:x,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):S.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[S.jsx(hM,{size:14}),S.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}function P$(){const{current:n,loading:e,fetchWeather:t,getFishingCondition:i}=Tk(),r=Wi(h=>h.position);if(ee.useEffect(()=>{r&&t(r.lat,r.lng)},[r,t]),ee.useEffect(()=>{if(!r)return;const h=setInterval(()=>{t(r.lat,r.lng)},600*1e3);return()=>clearInterval(h)},[r,t]),!n&&!e)return null;const s=i(),o={excellent:"text-green-500",good:"text-lime-500",moderate:"text-amber-500",poor:"text-red-500"},l={excellent:"Uitstekend",good:"Goed",moderate:"Matig",poor:"Slecht"},c=h=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(h/45)%8];return S.jsx(it.div,{className:"fixed top-24 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-3 min-w-[130px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e?S.jsx("div",{className:"text-sm text-gray-500",children:"Laden..."}):n?S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex items-center gap-2 pb-2 mb-1",children:[S.jsx(qs,{size:18,className:o[s]}),S.jsx("span",{className:`text-sm font-medium ${o[s]}`,children:l[s]})]}),S.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[S.jsx(n$,{size:16,className:"text-gray-400"}),S.jsxs("span",{children:[Math.round(n.temperature),"C"]})]}),S.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[S.jsx(l$,{size:16,className:"text-gray-400"}),S.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",c(n.windDirection)]})]}),S.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[S.jsx(lM,{size:16,className:"text-gray-400"}),S.jsxs("span",{children:[Math.round(n.pressure)," hPa"]})]})]}):null})}const dM=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],b$=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],k$=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"];function D$({onClose:n,initialLocation:e}){const t=xk(k=>k.addCatch),i=Tk(k=>k.current),r=Wi(k=>k.position),s=e||(r?{lat:r.lat,lng:r.lng}:null),[o,l]=ee.useState(""),[c,h]=ee.useState(""),[f,m]=ee.useState(""),[y,E]=ee.useState(""),[x,C]=ee.useState(""),[T,b]=ee.useState(""),P=k=>{if(k.preventDefault(),!o||!s){alert("Selecteer een vissoort en zorg dat GPS actief is");return}t({location:s,species:o,weight:c?parseInt(c):void 0,length:f?parseInt(f):void 0,method:y||"Anders",bait:x||void 0,notes:T||void 0,weather:i?{temp:i.temperature,windSpeed:i.windSpeed,windDirection:i.windDirection,pressure:i.pressure}:void 0}),n()};return S.jsx(it.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:S.jsxs(it.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:k=>k.stopPropagation(),children:[S.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(qs,{className:"text-white",size:24}),S.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),S.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:S.jsx(Nl,{size:20})})]}),S.jsxs("form",{onSubmit:P,className:"p-4 space-y-4",children:[s&&S.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[S.jsx(Lc,{size:16}),S.jsxs("span",{children:[s.lat.toFixed(5),", ",s.lng.toFixed(5)]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vissoort *"}),S.jsxs("select",{value:o,onChange:k=>l(k.target.value),className:"form-select",required:!0,children:[S.jsx("option",{value:"",children:"Selecteer vissoort..."}),dM.map(k=>S.jsx("option",{value:k.name,children:k.name},k.name))]})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("div",{children:[S.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[S.jsx(XK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),S.jsx("input",{type:"number",value:c,onChange:k=>h(k.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),S.jsxs("div",{children:[S.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[S.jsx(WK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),S.jsx("input",{type:"number",value:f,onChange:k=>m(k.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),S.jsxs("select",{value:y,onChange:k=>E(k.target.value),className:"form-select",children:[S.jsx("option",{value:"",children:"Selecteer methode..."}),b$.map(k=>S.jsx("option",{value:k,children:k},k))]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),S.jsxs("select",{value:x,onChange:k=>C(k.target.value),className:"form-select",children:[S.jsx("option",{value:"",children:"Selecteer aas..."}),k$.map(k=>S.jsx("option",{value:k,children:k},k))]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),S.jsx("textarea",{value:T,onChange:k=>b(k.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),S.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function M$(){const n=xi(l=>l.catchFormOpen),e=xi(l=>l.catchFormLocation),t=xi(l=>l.openCatchForm),i=xi(l=>l.closeCatchForm),r=Wi(l=>l.position),s=yi(l=>l.showCatchButton),o=()=>{r?t({lat:r.lat,lng:r.lng}):t()};return S.jsxs(S.Fragment,{children:[s&&S.jsx(it.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:o,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:S.jsx(qs,{size:22,strokeWidth:2})}),S.jsx(ra,{children:n&&S.jsx(D$,{onClose:i,initialLocation:e||void 0})})]})}function N$(){const n=us(r=>r.map),e=xk(r=>r.catches),t=ee.useRef(null),i=ee.useRef(null);return ee.useEffect(()=>{if(n)return i.current=new mE,t.current=new SE({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),ee.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=fl([r.location.lng,r.location.lat]),o=new sc({geometry:new gl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Yi({image:new Pl({radius:14,fill:new Tr({color:"#22c55e"}),stroke:new Pc({color:"#fff",width:2})}),text:new ef({text:l,font:"bold 12px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function L$(){const n=us(r=>r.map),e=Ik(r=>r.spots),t=ee.useRef(null),i=ee.useRef(null);return ee.useEffect(()=>{if(n)return i.current=new mE,t.current=new SE({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),ee.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=fl([r.location.lng,r.location.lat]),o=new sc({geometry:new gl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Yi({image:new Pl({radius:12,fill:new Tr({color:l}),stroke:new Pc({color:"#fff",width:2})}),text:new ef({text:"",font:"bold 14px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function O$({onClose:n,initialLocation:e}){const t=Ik(T=>T.addSpot),[i,r]=ee.useState(""),[s,o]=ee.useState(""),[l,c]=ee.useState([]),[h,f]=ee.useState(""),[m,y]=ee.useState(3),E=e,x=T=>{c(b=>b.includes(T)?b.filter(P=>P!==T):[...b,T])},C=T=>{if(T.preventDefault(),!i||!E){alert("Geef een naam op voor deze locatie");return}t({name:i,location:E,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:m}),n()};return S.jsx(it.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:S.jsxs(it.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:T=>T.stopPropagation(),children:[S.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(pm,{className:"text-white",size:24}),S.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),S.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:S.jsx(Nl,{size:20})})]}),S.jsxs("form",{onSubmit:C,className:"p-4 space-y-4",children:[E&&S.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[S.jsx(Lc,{size:16}),S.jsxs("span",{children:[E.lat.toFixed(5),", ",E.lng.toFixed(5)]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),S.jsx("input",{type:"text",value:i,onChange:T=>r(T.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),S.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),S.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(T=>S.jsx("button",{type:"button",onClick:()=>y(T),className:"p-1 border-0 outline-none bg-transparent",children:S.jsx(pm,{size:28,className:T<=m?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),S.jsx("div",{className:"flex flex-wrap gap-2",children:dM.slice(0,12).map(T=>S.jsx("button",{type:"button",onClick:()=>x(T.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(T.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T.name},T.name))})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),S.jsx("textarea",{value:h,onChange:T=>f(T.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),S.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const V$=[{name:"Aanlegsteigers",icon:aM,color:"#2196F3"},{name:"Boothellingen",icon:JK,color:"#4CAF50"},{name:"Dieptekaart",icon:o$,color:"#00BCD4"},{name:"Viswater",icon:Lc,color:"#9C27B0"}],mA=[{name:"CartoDB (licht)",label:"Kaart"},{name:"OpenStreetMap",label:"OSM"},{name:"Luchtfoto",label:"Satelliet"}];function F$(){const[n,e]=ee.useState(!1),t=Ho(o=>o.visible),i=Ho(o=>o.toggleLayer),r=Ho(o=>o.setLayerVisibility),s=o=>{mA.forEach(l=>{r(l.name,l.name===o)})};return S.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[S.jsx(it.button,{className:"w-11 h-11 bg-white/80 hover:bg-white/90 backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:S.jsx(gm,{size:22})}),S.jsx(ra,{children:n&&S.jsxs(it.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg p-3 min-w-[200px]",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},children:[S.jsxs("div",{className:"mb-3 pb-3 border-b border-gray-100",children:[S.jsx("div",{className:"text-xs font-medium text-gray-500 mb-2",children:"Achtergrond"}),S.jsx("div",{className:"flex gap-1",children:mA.map(o=>S.jsx("button",{className:`px-2 py-1 text-xs rounded-md transition-colors ${t[o.name]?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>s(o.name),children:o.label},o.name))})]}),S.jsx("div",{className:"text-xs font-medium text-gray-500 mb-2",children:"Kaartlagen"}),S.jsx("div",{className:"space-y-1",children:V$.map(o=>{const l=o.icon,c=t[o.name];return S.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors ${c?"bg-blue-50 text-blue-700":"hover:bg-gray-50 text-gray-700"}`,onClick:()=>i(o.name),children:[S.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center",style:{backgroundColor:c?o.color:"#e5e7eb"},children:S.jsx(l,{size:14,className:"text-white"})}),S.jsx("span",{className:"text-sm",children:o.name}),c&&S.jsx("div",{className:"ml-auto w-2 h-2 bg-green-500 rounded-full"})]},o.name)})})]})})]})}function j$(){const n=xi(f=>f.settingsPanelOpen),e=xi(f=>f.toggleSettingsPanel),t=yi(f=>f.showCatchButton),i=yi(f=>f.setShowCatchButton),r=yi(f=>f.showCatches),s=yi(f=>f.setShowCatches),o=yi(f=>f.showFavoriteSpots),l=yi(f=>f.setShowFavoriteSpots),c=yi(f=>f.defaultBackground),h=yi(f=>f.setDefaultBackground);return n?S.jsx(it.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:S.jsxs(it.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:f=>f.stopPropagation(),children:[S.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[S.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:S.jsx(Nl,{size:20,className:"text-white"})})]}),S.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),S.jsx(q0,{icon:S.jsx(qs,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),S.jsx(q0,{icon:S.jsx(qs,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),S.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[S.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),S.jsx(q0,{icon:S.jsx(Lc,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),S.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[S.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:S.jsx(xx,{size:18,className:"text-gray-500"})}),S.jsxs("div",{className:"flex-1",children:[S.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),S.jsxs("select",{value:c,onChange:f=>h(f.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[S.jsx("option",{value:"CartoDB (licht)",children:"Kaart (licht)"}),S.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),S.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]})]}),S.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function q0({icon:n,label:e,description:t,checked:i,onChange:r}){return S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),S.jsxs("div",{className:"flex-1",children:[S.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),S.jsx("p",{className:"text-xs text-gray-400",children:t})]}),S.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:S.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function U$({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=sM(),[l,c]=ee.useState(""),[h,f]=ee.useState(!1),[m,y]=ee.useState(!1),[E,x]=ee.useState(null);if(ee.useEffect(()=>{o()},[o]),s)return S.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:S.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return S.jsx(S.Fragment,{children:n});const C=b=>{b.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},T=async()=>{try{x(null),await i()}catch{x("Google login mislukt"),setTimeout(()=>x(null),3e3)}};return S.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:S.jsxs(it.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[S.jsxs("div",{className:"flex flex-col items-center mb-6",children:[S.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:S.jsx(qs,{size:40,className:"text-white"})}),S.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),S.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),S.jsxs(it.button,{onClick:T,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[S.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[S.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),S.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),S.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),S.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),E&&S.jsx(it.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:E}),S.jsxs("div",{className:"flex items-center gap-3 my-4",children:[S.jsx("div",{className:"flex-1 h-px bg-gray-200"}),S.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),S.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),S.jsxs("form",{onSubmit:C,className:"space-y-4",children:[S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:S.jsx(RK,{size:20})}),S.jsx("input",{type:m?"text":"password",value:l,onChange:b=>c(b.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),S.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?S.jsx(mK,{size:20}):S.jsx(_K,{size:20})})]}),h&&S.jsx(it.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),S.jsx(it.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),S.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function z$(){const n=xi(i=>i.spotFormOpen),e=xi(i=>i.spotFormLocation),t=xi(i=>i.closeSpotForm);return S.jsx(U$,{children:S.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[S.jsx(eK,{}),S.jsx(g$,{}),S.jsx(N$,{}),S.jsx(L$,{}),S.jsx(c$,{}),S.jsx(p$,{}),S.jsx(m$,{}),S.jsx(y$,{}),S.jsx(A$,{}),S.jsx(I$,{}),S.jsx(F$,{}),S.jsx(M$,{}),S.jsx(d$,{}),S.jsx(P$,{}),S.jsx(_$,{}),S.jsx(j$,{}),S.jsx(ra,{children:n&&S.jsx(O$,{onClose:t,initialLocation:e||void 0})})]})})}const B$="0.1.0";console.log(`%c VisApp v${B$}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");AN.createRoot(document.getElementById("root")).render(S.jsx(z$,{}));export{tH as $,yb as A,Rt as B,Pl as C,tt as D,ze as E,Tr as F,i4 as G,Sm as H,c3 as I,dl as J,gb as K,mb as L,q$ as M,kp as N,c4 as O,Z$ as P,_b as Q,$u as R,Yi as S,a6 as T,gl as U,mE as V,qP as W,$$ as X,H$ as Y,Y$ as Z,nH as _,SE as a,_S as a0,ej as a1,tj as a2,eH as a3,J$ as a4,Cd as a5,Q$ as a6,X$ as a7,dr as a8,sc as a9,et as aa,np as ab,bp as ac,Nb as ad,Iv as ae,rc as af,r4 as ag,Pc as b,zn as c,rH as d,Zi as e,si as f,dt as g,nC as h,Yw as i,U5 as j,T0 as k,sE as l,sl as m,qw as n,XP as o,fb as p,pb as q,K$ as r,l4 as s,Dm as t,wS as u,Wu as v,vS as w,u4 as x,lE as y,aE as z};
//# sourceMappingURL=index-CiZYINls.js.map
