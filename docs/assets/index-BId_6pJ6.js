const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-4erDpAzY.js","assets/GeoJSON-CP-zO1Mm.js","assets/boothellingenOL-Dukg-Vc-.js","assets/viswaterOL-vujNBosZ.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function w1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var U_={exports:{}},Th={},z_={exports:{}},We={};var zT;function FM(){if(zT)return We;zT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,I={};function S(W,$,ie){this.props=W,this.context=$,this.refs=I,this.updater=ie||E}S.prototype.isReactComponent={},S.prototype.setState=function(W,$){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,$,"setState")},S.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function P(){}P.prototype=S.prototype;function N(W,$,ie){this.props=W,this.context=$,this.refs=I,this.updater=ie||E}var D=N.prototype=new P;D.constructor=N,T(D,S.prototype),D.isPureReactComponent=!0;var L=Array.isArray,F=Object.prototype.hasOwnProperty,B={current:null},b={key:!0,ref:!0,__self:!0,__source:!0};function R(W,$,ie){var me,xe={},be=null,Me=null;if($!=null)for(me in $.ref!==void 0&&(Me=$.ref),$.key!==void 0&&(be=""+$.key),$)F.call($,me)&&!b.hasOwnProperty(me)&&(xe[me]=$[me]);var Ve=arguments.length-2;if(Ve===1)xe.children=ie;else if(1<Ve){for(var Ge=Array(Ve),lt=0;lt<Ve;lt++)Ge[lt]=arguments[lt+2];xe.children=Ge}if(W&&W.defaultProps)for(me in Ve=W.defaultProps,Ve)xe[me]===void 0&&(xe[me]=Ve[me]);return{$$typeof:n,type:W,key:be,ref:Me,props:xe,_owner:B.current}}function M(W,$){return{$$typeof:n,type:W.type,key:$,ref:W.ref,props:W.props,_owner:W._owner}}function V(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function j(W){var $={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ie){return $[ie]})}var z=/\/+/g;function k(W,$){return typeof W=="object"&&W!==null&&W.key!=null?j(""+W.key):$.toString(36)}function re(W,$,ie,me,xe){var be=typeof W;(be==="undefined"||be==="boolean")&&(W=null);var Me=!1;if(W===null)Me=!0;else switch(be){case"string":case"number":Me=!0;break;case"object":switch(W.$$typeof){case n:case e:Me=!0}}if(Me)return Me=W,xe=xe(Me),W=me===""?"."+k(Me,0):me,L(xe)?(ie="",W!=null&&(ie=W.replace(z,"$&/")+"/"),re(xe,$,ie,"",function(lt){return lt})):xe!=null&&(V(xe)&&(xe=M(xe,ie+(!xe.key||Me&&Me.key===xe.key?"":(""+xe.key).replace(z,"$&/")+"/")+W)),$.push(xe)),1;if(Me=0,me=me===""?".":me+":",L(W))for(var Ve=0;Ve<W.length;Ve++){be=W[Ve];var Ge=me+k(be,Ve);Me+=re(be,$,ie,Ge,xe)}else if(Ge=y(W),typeof Ge=="function")for(W=Ge.call(W),Ve=0;!(be=W.next()).done;)be=be.value,Ge=me+k(be,Ve++),Me+=re(be,$,ie,Ge,xe);else if(be==="object")throw $=String(W),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Me}function pe(W,$,ie){if(W==null)return W;var me=[],xe=0;return re(W,me,"","",function(be){return $.call(ie,be,xe++)}),me}function ge(W){if(W._status===-1){var $=W._result;$=$(),$.then(function(ie){(W._status===0||W._status===-1)&&(W._status=1,W._result=ie)},function(ie){(W._status===0||W._status===-1)&&(W._status=2,W._result=ie)}),W._status===-1&&(W._status=0,W._result=$)}if(W._status===1)return W._result.default;throw W._result}var ue={current:null},Q={transition:null},oe={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Q,ReactCurrentOwner:B};function ne(){throw Error("act(...) is not supported in production builds of React.")}return We.Children={map:pe,forEach:function(W,$,ie){pe(W,function(){$.apply(this,arguments)},ie)},count:function(W){var $=0;return pe(W,function(){$++}),$},toArray:function(W){return pe(W,function($){return $})||[]},only:function(W){if(!V(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},We.Component=S,We.Fragment=t,We.Profiler=r,We.PureComponent=N,We.StrictMode=i,We.Suspense=u,We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,We.act=ne,We.cloneElement=function(W,$,ie){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var me=T({},W.props),xe=W.key,be=W.ref,Me=W._owner;if($!=null){if($.ref!==void 0&&(be=$.ref,Me=B.current),$.key!==void 0&&(xe=""+$.key),W.type&&W.type.defaultProps)var Ve=W.type.defaultProps;for(Ge in $)F.call($,Ge)&&!b.hasOwnProperty(Ge)&&(me[Ge]=$[Ge]===void 0&&Ve!==void 0?Ve[Ge]:$[Ge])}var Ge=arguments.length-2;if(Ge===1)me.children=ie;else if(1<Ge){Ve=Array(Ge);for(var lt=0;lt<Ge;lt++)Ve[lt]=arguments[lt+2];me.children=Ve}return{$$typeof:n,type:W.type,key:xe,ref:be,props:me,_owner:Me}},We.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},We.createElement=R,We.createFactory=function(W){var $=R.bind(null,W);return $.type=W,$},We.createRef=function(){return{current:null}},We.forwardRef=function(W){return{$$typeof:l,render:W}},We.isValidElement=V,We.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ge}},We.memo=function(W,$){return{$$typeof:h,type:W,compare:$===void 0?null:$}},We.startTransition=function(W){var $=Q.transition;Q.transition={};try{W()}finally{Q.transition=$}},We.unstable_act=ne,We.useCallback=function(W,$){return ue.current.useCallback(W,$)},We.useContext=function(W){return ue.current.useContext(W)},We.useDebugValue=function(){},We.useDeferredValue=function(W){return ue.current.useDeferredValue(W)},We.useEffect=function(W,$){return ue.current.useEffect(W,$)},We.useId=function(){return ue.current.useId()},We.useImperativeHandle=function(W,$,ie){return ue.current.useImperativeHandle(W,$,ie)},We.useInsertionEffect=function(W,$){return ue.current.useInsertionEffect(W,$)},We.useLayoutEffect=function(W,$){return ue.current.useLayoutEffect(W,$)},We.useMemo=function(W,$){return ue.current.useMemo(W,$)},We.useReducer=function(W,$,ie){return ue.current.useReducer(W,$,ie)},We.useRef=function(W){return ue.current.useRef(W)},We.useState=function(W){return ue.current.useState(W)},We.useSyncExternalStore=function(W,$,ie){return ue.current.useSyncExternalStore(W,$,ie)},We.useTransition=function(){return ue.current.useTransition()},We.version="18.3.1",We}var BT;function $d(){return BT||(BT=1,z_.exports=FM()),z_.exports}var GT;function VM(){if(GT)return Th;GT=1;var n=$d(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},y=null,E=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(E=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:y,ref:E,props:p,_owner:r.current}}return Th.Fragment=t,Th.jsx=o,Th.jsxs=o,Th}var WT;function jM(){return WT||(WT=1,U_.exports=VM()),U_.exports}var v=jM(),Ig={},B_={exports:{}},Qn={},G_={exports:{}},W_={};var $T;function UM(){return $T||($T=1,(function(n){function e(Q,oe){var ne=Q.length;Q.push(oe);e:for(;0<ne;){var W=ne-1>>>1,$=Q[W];if(0<r($,oe))Q[W]=oe,Q[ne]=$,ne=W;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var oe=Q[0],ne=Q.pop();if(ne!==oe){Q[0]=ne;e:for(var W=0,$=Q.length,ie=$>>>1;W<ie;){var me=2*(W+1)-1,xe=Q[me],be=me+1,Me=Q[be];if(0>r(xe,ne))be<$&&0>r(Me,xe)?(Q[W]=Me,Q[be]=ne,W=be):(Q[W]=xe,Q[me]=ne,W=me);else if(be<$&&0>r(Me,ne))Q[W]=Me,Q[be]=ne,W=be;else break e}}return oe}function r(Q,oe){var ne=Q.sortIndex-oe.sortIndex;return ne!==0?ne:Q.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,y=3,E=!1,T=!1,I=!1,S=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(Q){for(var oe=t(h);oe!==null;){if(oe.callback===null)i(h);else if(oe.startTime<=Q)i(h),oe.sortIndex=oe.expirationTime,e(u,oe);else break;oe=t(h)}}function L(Q){if(I=!1,D(Q),!T)if(t(u)!==null)T=!0,ge(F);else{var oe=t(h);oe!==null&&ue(L,oe.startTime-Q)}}function F(Q,oe){T=!1,I&&(I=!1,P(R),R=-1),E=!0;var ne=y;try{for(D(oe),p=t(u);p!==null&&(!(p.expirationTime>oe)||Q&&!j());){var W=p.callback;if(typeof W=="function"){p.callback=null,y=p.priorityLevel;var $=W(p.expirationTime<=oe);oe=n.unstable_now(),typeof $=="function"?p.callback=$:p===t(u)&&i(u),D(oe)}else i(u);p=t(u)}if(p!==null)var ie=!0;else{var me=t(h);me!==null&&ue(L,me.startTime-oe),ie=!1}return ie}finally{p=null,y=ne,E=!1}}var B=!1,b=null,R=-1,M=5,V=-1;function j(){return!(n.unstable_now()-V<M)}function z(){if(b!==null){var Q=n.unstable_now();V=Q;var oe=!0;try{oe=b(!0,Q)}finally{oe?k():(B=!1,b=null)}}else B=!1}var k;if(typeof N=="function")k=function(){N(z)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,pe=re.port2;re.port1.onmessage=z,k=function(){pe.postMessage(null)}}else k=function(){S(z,0)};function ge(Q){b=Q,B||(B=!0,k())}function ue(Q,oe){R=S(function(){Q(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){T||E||(T=!0,ge(F))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var oe=3;break;default:oe=y}var ne=y;y=oe;try{return Q()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,oe){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ne=y;y=Q;try{return oe()}finally{y=ne}},n.unstable_scheduleCallback=function(Q,oe,ne){var W=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,Q){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,Q={id:f++,callback:oe,priorityLevel:Q,startTime:ne,expirationTime:$,sortIndex:-1},ne>W?(Q.sortIndex=ne,e(h,Q),t(u)===null&&Q===t(h)&&(I?(P(R),R=-1):I=!0,ue(L,ne-W))):(Q.sortIndex=$,e(u,Q),T||E||(T=!0,ge(F))),Q},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(Q){var oe=y;return function(){var ne=y;y=oe;try{return Q.apply(this,arguments)}finally{y=ne}}}})(W_)),W_}var KT;function zM(){return KT||(KT=1,G_.exports=UM()),G_.exports}var HT;function BM(){if(HT)return Qn;HT=1;var n=$d(),e=zM();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function y(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function E(a,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function T(a,c,d,m){if(c===null||typeof c>"u"||E(a,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,m,_,x,A){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=_,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=x,this.removeEmptyString=A}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){S[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];S[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){S[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){S[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){S[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){S[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){S[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){S[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){S[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function N(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(P,N);S[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(P,N);S[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(P,N);S[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){S[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),S.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){S[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function D(a,c,d,m){var _=S.hasOwnProperty(c)?S[c]:null;(_!==null?_.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(T(c,d,_,m)&&(d=null),m||_===null?y(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):_.mustUseProperty?a[_.propertyName]=d===null?_.type===3?!1:"":d:(c=_.attributeName,m=_.attributeNamespace,d===null?a.removeAttribute(c):(_=_.type,d=_===3||_===4&&d===!0?"":""+d,m?a.setAttributeNS(m,c,d):a.setAttribute(c,d))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),B=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),j=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Q=Symbol.iterator;function oe(a){return a===null||typeof a!="object"?null:(a=Q&&a[Q]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,W;function $(a){if(W===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var ie=!1;function me(a,c){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var m=J}Reflect.construct(a,[],c)}else{try{c.call()}catch(J){m=J}a.call(c.prototype)}else{try{throw Error()}catch(J){m=J}a()}}catch(J){if(J&&m&&typeof J.stack=="string"){for(var _=J.stack.split(`
`),x=m.stack.split(`
`),A=_.length-1,U=x.length-1;1<=A&&0<=U&&_[A]!==x[U];)U--;for(;1<=A&&0<=U;A--,U--)if(_[A]!==x[U]){if(A!==1||U!==1)do if(A--,U--,0>U||_[A]!==x[U]){var G=`
`+_[A].replace(" at new "," at ");return a.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",a.displayName)),G}while(1<=A&&0<=U);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function xe(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=me(a.type,!1),a;case 11:return a=me(a.type.render,!1),a;case 1:return a=me(a.type,!0),a;default:return""}}function be(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case b:return"Fragment";case B:return"Portal";case M:return"Profiler";case R:return"StrictMode";case k:return"Suspense";case re:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case z:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case pe:return c=a.displayName||null,c!==null?c:be(a.type)||"Memo";case ge:c=a._payload,a=a._init;try{return be(a(c))}catch{}}return null}function Me(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(c);case 8:return c===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ge(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function lt(a){var c=Ge(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,x=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return _.call(this)},set:function(A){m=""+A,x.call(this,A)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(A){m=""+A},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Qi(a){a._valueTracker||(a._valueTracker=lt(a))}function ds(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return a&&(m=Ge(a)?a.checked?"true":"false":a.value),a=m,a!==d?(c.setValue(a),!0):!1}function Wn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function $n(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=Ve(c.value!=null?c.value:d),a._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&D(a,"checked",c,!1)}function Kn(a,c){dn(a,c);var d=Ve(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?yt(a,c.type,d):c.hasOwnProperty("defaultValue")&&yt(a,c.type,Ve(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Ri(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function yt(a,c,d){(c!=="number"||Wn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ct=Array.isArray;function tn(a,c,d,m){if(a=a.options,c){c={};for(var _=0;_<d.length;_++)c["$"+d[_]]=!0;for(d=0;d<a.length;d++)_=c.hasOwnProperty("$"+a[d].value),a[d].selected!==_&&(a[d].selected=_),_&&m&&(a[d].defaultSelected=!0)}else{for(d=""+Ve(d),c=null,_=0;_<a.length;_++){if(a[_].value===d){a[_].selected=!0,m&&(a[_].defaultSelected=!0);return}c!==null||a[_].disabled||(c=a[_])}c!==null&&(c.selected=!0)}}function Ai(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function St(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ct(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:Ve(d)}}function eo(a,c){var d=Ve(c.value),m=Ve(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),m!=null&&(a.defaultValue=""+m)}function Pi(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Cr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ji(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Cr(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Rr,ca=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,_){MSApp.execUnsafeLocalFunction(function(){return a(c,d,m,_)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Rr=Rr||document.createElement("div"),Rr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Rr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Ar(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var bi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ol=["Webkit","ms","Moz","O"];Object.keys(bi).forEach(function(a){Ol.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),bi[c]=bi[a]})});function Pr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||bi.hasOwnProperty(a)&&bi[a]?(""+c).trim():c+"px"}function fs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,_=Pr(d,c[d],m);d==="float"&&(d="cssFloat"),m?a.setProperty(d,_):a[d]=_}}var to=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,c){if(c){if(to[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function gs(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var br=null;function kr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Fn=null,Vn=null,ft=null;function no(a){if(a=lh(a)){if(typeof Fn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Uf(c),Fn(a.stateNode,a.type,c))}}function er(a){Vn?ft?ft.push(a):ft=[a]:Vn=a}function Ot(){if(Vn){var a=Vn,c=ft;if(ft=Vn=null,no(a),c)for(a=0;a<c.length;a++)no(c[a])}}function ki(a,c){return a(c)}function fn(){}var Ft=!1;function gn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return ki(a,c,d)}finally{Ft=!1,(Vn!==null||ft!==null)&&(fn(),Ot())}}function pn(a,c){var d=a.stateNode;if(d===null)return null;var m=Uf(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var nn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){nn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{nn=!1}function Bt(a,c,d,m,_,x,A,U,G){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(ae){this.onError(ae)}}var qt=!1,Di=null,Fl=!1,Ni=null,_f={onError:function(a){qt=!0,Di=a}};function vf(a,c,d,m,_,x,A,U,G){qt=!1,Di=null,Bt.apply(_f,arguments)}function Ou(a,c,d,m,_,x,A,U,G){if(vf.apply(this,arguments),qt){if(qt){var J=Di;qt=!1,Di=null}else throw Error(t(198));Fl||(Fl=!0,Ni=J)}}function tr(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Fu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function xf(a){if(tr(a)!==a)throw Error(t(188))}function wf(a){var c=a.alternate;if(!c){if(c=tr(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,m=c;;){var _=d.return;if(_===null)break;var x=_.alternate;if(x===null){if(m=_.return,m!==null){d=m;continue}break}if(_.child===x.child){for(x=_.child;x;){if(x===d)return xf(_),a;if(x===m)return xf(_),c;x=x.sibling}throw Error(t(188))}if(d.return!==m.return)d=_,m=x;else{for(var A=!1,U=_.child;U;){if(U===d){A=!0,d=_,m=x;break}if(U===m){A=!0,m=_,d=x;break}U=U.sibling}if(!A){for(U=x.child;U;){if(U===d){A=!0,d=x,m=_;break}if(U===m){A=!0,m=x,d=_;break}U=U.sibling}if(!A)throw Error(t(189))}}if(d.alternate!==m)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Ef(a){return a=wf(a),a!==null?ua(a):null}function ua(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ua(a);if(c!==null)return c;a=a.sibling}return null}var Vu=e.unstable_scheduleCallback,Vl=e.unstable_cancelCallback,ha=e.unstable_shouldYield,ps=e.unstable_requestPaint,vt=e.unstable_now,yy=e.unstable_getCurrentPriorityLevel,jl=e.unstable_ImmediatePriority,ju=e.unstable_UserBlockingPriority,da=e.unstable_NormalPriority,Uu=e.unstable_LowPriority,Ul=e.unstable_IdlePriority,fa=null,ui=null;function Tf(a){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(fa,a,void 0,(a.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:ga,Dr=Math.log,Mi=Math.LN2;function ga(a){return a>>>=0,a===0?32:31-(Dr(a)/Mi|0)|0}var Nr=64,io=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ms(a,c){var d=a.pendingLanes;if(d===0)return 0;var m=0,_=a.suspendedLanes,x=a.pingedLanes,A=d&268435455;if(A!==0){var U=A&~_;U!==0?m=st(U):(x&=A,x!==0&&(m=st(x)))}else A=d&~_,A!==0?m=st(A):x!==0&&(m=st(x));if(m===0)return 0;if(c!==0&&c!==m&&(c&_)===0&&(_=m&-m,x=c&-c,_>=x||_===16&&(x&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=m;0<c;)d=31-hi(c),_=1<<d,m|=a[d],c&=~_;return m}function pa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(a,c){for(var d=a.suspendedLanes,m=a.pingedLanes,_=a.expirationTimes,x=a.pendingLanes;0<x;){var A=31-hi(x),U=1<<A,G=_[A];G===-1?((U&d)===0||(U&m)!==0)&&(_[A]=pa(U,c)):G<=c&&(a.expiredLanes|=U),x&=~U}}function zu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Bu(){var a=Nr;return Nr<<=1,(Nr&4194240)===0&&(Nr=64),a}function Gu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function ya(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-hi(c),a[c]=d}function _y(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<d;){var _=31-hi(d),x=1<<_;c[_]=0,m[_]=-1,a[_]=-1,d&=~x}}function Wu(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var m=31-hi(d),_=1<<m;_&c|a[m]&c&&(a[m]|=c),d&=~_}}var He=0;function Mr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var $u,zl,Ku,Hu,qu,Lr=!1,Bl=[],Or=null,Fr=null,mn=null,_a=new Map,ys=new Map,di=[],Sf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ro(a,c){switch(a){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":_a.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ys.delete(c.pointerId)}}function nr(a,c,d,m,_,x){return a===null||a.nativeEvent!==x?(a={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:x,targetContainers:[_]},c!==null&&(c=lh(c),c!==null&&zl(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,_!==null&&c.indexOf(_)===-1&&c.push(_),a)}function If(a,c,d,m,_){switch(c){case"focusin":return Or=nr(Or,a,c,d,m,_),!0;case"dragenter":return Fr=nr(Fr,a,c,d,m,_),!0;case"mouseover":return mn=nr(mn,a,c,d,m,_),!0;case"pointerover":var x=_.pointerId;return _a.set(x,nr(_a.get(x)||null,a,c,d,m,_)),!0;case"gotpointercapture":return x=_.pointerId,ys.set(x,nr(ys.get(x)||null,a,c,d,m,_)),!0}return!1}function Gl(a){var c=Ea(a.target);if(c!==null){var d=tr(c);if(d!==null){if(c=d.tag,c===13){if(c=Fu(d),c!==null){a.blockedOn=c,qu(a.priority,function(){Ku(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Wl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);br=m,d.target.dispatchEvent(m),br=null}else return c=lh(d),c!==null&&zl(c),a.blockedOn=d,!1;c.shift()}return!0}function Cf(a,c,d){pt(a)&&d.delete(c)}function vy(){Lr=!1,Or!==null&&pt(Or)&&(Or=null),Fr!==null&&pt(Fr)&&(Fr=null),mn!==null&&pt(mn)&&(mn=null),_a.forEach(Cf),ys.forEach(Cf)}function so(a,c){a.blockedOn===c&&(a.blockedOn=null,Lr||(Lr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,vy)))}function oo(a){function c(_){return so(_,a)}if(0<Bl.length){so(Bl[0],a);for(var d=1;d<Bl.length;d++){var m=Bl[d];m.blockedOn===a&&(m.blockedOn=null)}}for(Or!==null&&so(Or,a),Fr!==null&&so(Fr,a),mn!==null&&so(mn,a),_a.forEach(c),ys.forEach(c),d=0;d<di.length;d++)m=di[d],m.blockedOn===a&&(m.blockedOn=null);for(;0<di.length&&(d=di[0],d.blockedOn===null);)Gl(d),d.blockedOn===null&&di.shift()}var _s=L.ReactCurrentBatchConfig,vs=!0;function Vr(a,c,d,m){var _=He,x=_s.transition;_s.transition=null;try{He=1,Xu(a,c,d,m)}finally{He=_,_s.transition=x}}function Rf(a,c,d,m){var _=He,x=_s.transition;_s.transition=null;try{He=4,Xu(a,c,d,m)}finally{He=_,_s.transition=x}}function Xu(a,c,d,m){if(vs){var _=Wl(a,c,d,m);if(_===null)by(a,c,m,jr,d),ro(a,m);else if(If(_,a,c,d,m))m.stopPropagation();else if(ro(a,m),c&4&&-1<Sf.indexOf(a)){for(;_!==null;){var x=lh(_);if(x!==null&&$u(x),x=Wl(a,c,d,m),x===null&&by(a,c,m,jr,d),x===_)break;_=x}_!==null&&m.stopPropagation()}else by(a,c,m,null,d)}}var jr=null;function Wl(a,c,d,m){if(jr=null,a=kr(m),a=Ea(a),a!==null)if(c=tr(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Fu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return jr=a,null}function $l(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yy()){case jl:return 1;case ju:return 4;case da:case Uu:return 16;case Ul:return 536870912;default:return 16}default:return 16}}var fi=null,Kl=null,xs=null;function Af(){if(xs)return xs;var a,c=Kl,d=c.length,m,_="value"in fi?fi.value:fi.textContent,x=_.length;for(a=0;a<d&&c[a]===_[a];a++);var A=d-a;for(m=1;m<=A&&c[d-m]===_[x-m];m++);return xs=_.slice(a,1<m?1-m:void 0)}function va(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Ur(){return!0}function Yu(){return!1}function Cn(a){function c(d,m,_,x,A){this._reactName=d,this._targetInst=_,this.type=m,this.nativeEvent=x,this.target=A,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(x):x[U]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ur:Yu,this.isPropagationStopped=Yu,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ur)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ur)},persist:function(){},isPersistent:Ur}),c}var zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xa=Cn(zr),ao=ne({},zr,{view:0,detail:0}),Hl=Cn(ao),ql,Xl,gi,wa=ne({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:je,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==gi&&(gi&&a.type==="mousemove"?(ql=a.screenX-gi.screenX,Xl=a.screenY-gi.screenY):Xl=ql=0,gi=a),ql)},movementY:function(a){return"movementY"in a?a.movementY:Xl}}),Zu=Cn(wa),Pf=ne({},wa,{dataTransfer:0}),bf=Cn(Pf),Yl=ne({},ao,{relatedTarget:0}),yn=Cn(Yl),kf=ne({},zr,{animationName:0,elapsedTime:0,pseudoElement:0}),Df=Cn(kf),lo=ne({},zr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(lo),w=ne({},zr,{data:0}),C=Cn(w),O={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function je(){return de}var Vt=ne({},ao,{key:function(a){if(a.key){var c=O[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=va(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?q[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:je,charCode:function(a){return a.type==="keypress"?va(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?va(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ut=Cn(Vt),Gt=ne({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pi=Cn(Gt),ws=ne({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:je}),Br=Cn(ws),Gr=ne({},zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zl=Cn(Gr),Qu=ne({},wa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),kN=Cn(Qu),DN=[9,13,27,32],xy=l&&"CompositionEvent"in window,Ju=null;l&&"documentMode"in document&&(Ju=document.documentMode);var NN=l&&"TextEvent"in window&&!Ju,Nw=l&&(!xy||Ju&&8<Ju&&11>=Ju),Mw=" ",Lw=!1;function Ow(a,c){switch(a){case"keyup":return DN.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ql=!1;function MN(a,c){switch(a){case"compositionend":return Fw(c);case"keypress":return c.which!==32?null:(Lw=!0,Mw);case"textInput":return a=c.data,a===Mw&&Lw?null:a;default:return null}}function LN(a,c){if(Ql)return a==="compositionend"||!xy&&Ow(a,c)?(a=Af(),xs=Kl=fi=null,Ql=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Nw&&c.locale!=="ko"?null:c.data;default:return null}}var ON={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!ON[a.type]:c==="textarea"}function jw(a,c,d,m){er(m),c=Ff(c,"onChange"),0<c.length&&(d=new xa("onChange","change",null,d,m),a.push({event:d,listeners:c}))}var eh=null,th=null;function FN(a){iE(a,0)}function Nf(a){var c=ic(a);if(ds(c))return a}function VN(a,c){if(a==="change")return c}var Uw=!1;if(l){var wy;if(l){var Ey="oninput"in document;if(!Ey){var zw=document.createElement("div");zw.setAttribute("oninput","return;"),Ey=typeof zw.oninput=="function"}wy=Ey}else wy=!1;Uw=wy&&(!document.documentMode||9<document.documentMode)}function Bw(){eh&&(eh.detachEvent("onpropertychange",Gw),th=eh=null)}function Gw(a){if(a.propertyName==="value"&&Nf(th)){var c=[];jw(c,th,a,kr(a)),gn(FN,c)}}function jN(a,c,d){a==="focusin"?(Bw(),eh=c,th=d,eh.attachEvent("onpropertychange",Gw)):a==="focusout"&&Bw()}function UN(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Nf(th)}function zN(a,c){if(a==="click")return Nf(c)}function BN(a,c){if(a==="input"||a==="change")return Nf(c)}function GN(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var ir=typeof Object.is=="function"?Object.is:GN;function nh(a,c){if(ir(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var _=d[m];if(!u.call(c,_)||!ir(a[_],c[_]))return!1}return!0}function Ww(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function $w(a,c){var d=Ww(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=c&&m>=c)return{node:d,offset:c-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ww(d)}}function Kw(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?Kw(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function Hw(){for(var a=window,c=Wn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Wn(a.document)}return c}function Ty(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function WN(a){var c=Hw(),d=a.focusedElem,m=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&Kw(d.ownerDocument.documentElement,d)){if(m!==null&&Ty(d)){if(c=m.start,a=m.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var _=d.textContent.length,x=Math.min(m.start,_);m=m.end===void 0?x:Math.min(m.end,_),!a.extend&&x>m&&(_=m,m=x,x=_),_=$w(d,x);var A=$w(d,m);_&&A&&(a.rangeCount!==1||a.anchorNode!==_.node||a.anchorOffset!==_.offset||a.focusNode!==A.node||a.focusOffset!==A.offset)&&(c=c.createRange(),c.setStart(_.node,_.offset),a.removeAllRanges(),x>m?(a.addRange(c),a.extend(A.node,A.offset)):(c.setEnd(A.node,A.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var $N=l&&"documentMode"in document&&11>=document.documentMode,Jl=null,Sy=null,ih=null,Iy=!1;function qw(a,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Iy||Jl==null||Jl!==Wn(m)||(m=Jl,"selectionStart"in m&&Ty(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ih&&nh(ih,m)||(ih=m,m=Ff(Sy,"onSelect"),0<m.length&&(c=new xa("onSelect","select",null,c,d),a.push({event:c,listeners:m}),c.target=Jl)))}function Mf(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var ec={animationend:Mf("Animation","AnimationEnd"),animationiteration:Mf("Animation","AnimationIteration"),animationstart:Mf("Animation","AnimationStart"),transitionend:Mf("Transition","TransitionEnd")},Cy={},Xw={};l&&(Xw=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Lf(a){if(Cy[a])return Cy[a];if(!ec[a])return a;var c=ec[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in Xw)return Cy[a]=c[d];return a}var Yw=Lf("animationend"),Zw=Lf("animationiteration"),Qw=Lf("animationstart"),Jw=Lf("transitionend"),eE=new Map,tE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function co(a,c){eE.set(a,c),s(c,[a])}for(var Ry=0;Ry<tE.length;Ry++){var Ay=tE[Ry],KN=Ay.toLowerCase(),HN=Ay[0].toUpperCase()+Ay.slice(1);co(KN,"on"+HN)}co(Yw,"onAnimationEnd"),co(Zw,"onAnimationIteration"),co(Qw,"onAnimationStart"),co("dblclick","onDoubleClick"),co("focusin","onFocus"),co("focusout","onBlur"),co(Jw,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qN=new Set("cancel close invalid load scroll toggle".split(" ").concat(rh));function nE(a,c,d){var m=a.type||"unknown-event";a.currentTarget=d,Ou(m,c,void 0,a),a.currentTarget=null}function iE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],_=m.event;m=m.listeners;e:{var x=void 0;if(c)for(var A=m.length-1;0<=A;A--){var U=m[A],G=U.instance,J=U.currentTarget;if(U=U.listener,G!==x&&_.isPropagationStopped())break e;nE(_,U,J),x=G}else for(A=0;A<m.length;A++){if(U=m[A],G=U.instance,J=U.currentTarget,U=U.listener,G!==x&&_.isPropagationStopped())break e;nE(_,U,J),x=G}}}if(Fl)throw a=Ni,Fl=!1,Ni=null,a}function xt(a,c){var d=c[Oy];d===void 0&&(d=c[Oy]=new Set);var m=a+"__bubble";d.has(m)||(rE(c,a,2,!1),d.add(m))}function Py(a,c,d){var m=0;c&&(m|=4),rE(d,a,m,c)}var Of="_reactListening"+Math.random().toString(36).slice(2);function sh(a){if(!a[Of]){a[Of]=!0,i.forEach(function(d){d!=="selectionchange"&&(qN.has(d)||Py(d,!1,a),Py(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Of]||(c[Of]=!0,Py("selectionchange",!1,c))}}function rE(a,c,d,m){switch($l(c)){case 1:var _=Vr;break;case 4:_=Rf;break;default:_=Xu}d=_.bind(null,c,d,a),_=void 0,!nn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(_=!0),m?_!==void 0?a.addEventListener(c,d,{capture:!0,passive:_}):a.addEventListener(c,d,!0):_!==void 0?a.addEventListener(c,d,{passive:_}):a.addEventListener(c,d,!1)}function by(a,c,d,m,_){var x=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var U=m.stateNode.containerInfo;if(U===_||U.nodeType===8&&U.parentNode===_)break;if(A===4)for(A=m.return;A!==null;){var G=A.tag;if((G===3||G===4)&&(G=A.stateNode.containerInfo,G===_||G.nodeType===8&&G.parentNode===_))return;A=A.return}for(;U!==null;){if(A=Ea(U),A===null)return;if(G=A.tag,G===5||G===6){m=x=A;continue e}U=U.parentNode}}m=m.return}gn(function(){var J=x,ae=kr(d),ce=[];e:{var se=eE.get(a);if(se!==void 0){var ye=xa,ve=a;switch(a){case"keypress":if(va(d)===0)break e;case"keydown":case"keyup":ye=ut;break;case"focusin":ve="focus",ye=yn;break;case"focusout":ve="blur",ye=yn;break;case"beforeblur":case"afterblur":ye=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Zu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=bf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Br;break;case Yw:case Zw:case Qw:ye=Df;break;case Jw:ye=Zl;break;case"scroll":ye=Hl;break;case"wheel":ye=kN;break;case"copy":case"cut":case"paste":ye=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=pi}var we=(c&4)!==0,jt=!we&&a==="scroll",H=we?se!==null?se+"Capture":null:se;we=[];for(var K=J,X;K!==null;){X=K;var he=X.stateNode;if(X.tag===5&&he!==null&&(X=he,H!==null&&(he=pn(K,H),he!=null&&we.push(oh(K,he,X)))),jt)break;K=K.return}0<we.length&&(se=new ye(se,ve,null,d,ae),ce.push({event:se,listeners:we}))}}if((c&7)===0){e:{if(se=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",se&&d!==br&&(ve=d.relatedTarget||d.fromElement)&&(Ea(ve)||ve[Es]))break e;if((ye||se)&&(se=ae.window===ae?ae:(se=ae.ownerDocument)?se.defaultView||se.parentWindow:window,ye?(ve=d.relatedTarget||d.toElement,ye=J,ve=ve?Ea(ve):null,ve!==null&&(jt=tr(ve),ve!==jt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(ye=null,ve=J),ye!==ve)){if(we=Zu,he="onMouseLeave",H="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(we=pi,he="onPointerLeave",H="onPointerEnter",K="pointer"),jt=ye==null?se:ic(ye),X=ve==null?se:ic(ve),se=new we(he,K+"leave",ye,d,ae),se.target=jt,se.relatedTarget=X,he=null,Ea(ae)===J&&(we=new we(H,K+"enter",ve,d,ae),we.target=X,we.relatedTarget=jt,he=we),jt=he,ye&&ve)t:{for(we=ye,H=ve,K=0,X=we;X;X=tc(X))K++;for(X=0,he=H;he;he=tc(he))X++;for(;0<K-X;)we=tc(we),K--;for(;0<X-K;)H=tc(H),X--;for(;K--;){if(we===H||H!==null&&we===H.alternate)break t;we=tc(we),H=tc(H)}we=null}else we=null;ye!==null&&sE(ce,se,ye,we,!1),ve!==null&&jt!==null&&sE(ce,jt,ve,we,!0)}}e:{if(se=J?ic(J):window,ye=se.nodeName&&se.nodeName.toLowerCase(),ye==="select"||ye==="input"&&se.type==="file")var Te=VN;else if(Vw(se))if(Uw)Te=BN;else{Te=UN;var Ae=jN}else(ye=se.nodeName)&&ye.toLowerCase()==="input"&&(se.type==="checkbox"||se.type==="radio")&&(Te=zN);if(Te&&(Te=Te(a,J))){jw(ce,Te,d,ae);break e}Ae&&Ae(a,se,J),a==="focusout"&&(Ae=se._wrapperState)&&Ae.controlled&&se.type==="number"&&yt(se,"number",se.value)}switch(Ae=J?ic(J):window,a){case"focusin":(Vw(Ae)||Ae.contentEditable==="true")&&(Jl=Ae,Sy=J,ih=null);break;case"focusout":ih=Sy=Jl=null;break;case"mousedown":Iy=!0;break;case"contextmenu":case"mouseup":case"dragend":Iy=!1,qw(ce,d,ae);break;case"selectionchange":if($N)break;case"keydown":case"keyup":qw(ce,d,ae)}var Pe;if(xy)e:{switch(a){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else Ql?Ow(a,d)&&(Le="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Le="onCompositionStart");Le&&(Nw&&d.locale!=="ko"&&(Ql||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&Ql&&(Pe=Af()):(fi=ae,Kl="value"in fi?fi.value:fi.textContent,Ql=!0)),Ae=Ff(J,Le),0<Ae.length&&(Le=new C(Le,a,null,d,ae),ce.push({event:Le,listeners:Ae}),Pe?Le.data=Pe:(Pe=Fw(d),Pe!==null&&(Le.data=Pe)))),(Pe=NN?MN(a,d):LN(a,d))&&(J=Ff(J,"onBeforeInput"),0<J.length&&(ae=new C("onBeforeInput","beforeinput",null,d,ae),ce.push({event:ae,listeners:J}),ae.data=Pe))}iE(ce,c)})}function oh(a,c,d){return{instance:a,listener:c,currentTarget:d}}function Ff(a,c){for(var d=c+"Capture",m=[];a!==null;){var _=a,x=_.stateNode;_.tag===5&&x!==null&&(_=x,x=pn(a,d),x!=null&&m.unshift(oh(a,x,_)),x=pn(a,c),x!=null&&m.push(oh(a,x,_))),a=a.return}return m}function tc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function sE(a,c,d,m,_){for(var x=c._reactName,A=[];d!==null&&d!==m;){var U=d,G=U.alternate,J=U.stateNode;if(G!==null&&G===m)break;U.tag===5&&J!==null&&(U=J,_?(G=pn(d,x),G!=null&&A.unshift(oh(d,G,U))):_||(G=pn(d,x),G!=null&&A.push(oh(d,G,U)))),d=d.return}A.length!==0&&a.push({event:c,listeners:A})}var XN=/\r\n?/g,YN=/\u0000|\uFFFD/g;function oE(a){return(typeof a=="string"?a:""+a).replace(XN,`
`).replace(YN,"")}function Vf(a,c,d){if(c=oE(c),oE(a)!==c&&d)throw Error(t(425))}function jf(){}var ky=null,Dy=null;function Ny(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var My=typeof setTimeout=="function"?setTimeout:void 0,ZN=typeof clearTimeout=="function"?clearTimeout:void 0,aE=typeof Promise=="function"?Promise:void 0,QN=typeof queueMicrotask=="function"?queueMicrotask:typeof aE<"u"?function(a){return aE.resolve(null).then(a).catch(JN)}:My;function JN(a){setTimeout(function(){throw a})}function Ly(a,c){var d=c,m=0;do{var _=d.nextSibling;if(a.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"){if(m===0){a.removeChild(_),oo(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=_}while(d);oo(c)}function uo(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function lE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var nc=Math.random().toString(36).slice(2),Wr="__reactFiber$"+nc,ah="__reactProps$"+nc,Es="__reactContainer$"+nc,Oy="__reactEvents$"+nc,eM="__reactListeners$"+nc,tM="__reactHandles$"+nc;function Ea(a){var c=a[Wr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Es]||d[Wr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=lE(a);a!==null;){if(d=a[Wr])return d;a=lE(a)}return c}a=d,d=a.parentNode}return null}function lh(a){return a=a[Wr]||a[Es],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ic(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Uf(a){return a[ah]||null}var Fy=[],rc=-1;function ho(a){return{current:a}}function wt(a){0>rc||(a.current=Fy[rc],Fy[rc]=null,rc--)}function _t(a,c){rc++,Fy[rc]=a.current,a.current=c}var fo={},Rn=ho(fo),Hn=ho(!1),Ta=fo;function sc(a,c){var d=a.type.contextTypes;if(!d)return fo;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var _={},x;for(x in d)_[x]=c[x];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=_),_}function qn(a){return a=a.childContextTypes,a!=null}function zf(){wt(Hn),wt(Rn)}function cE(a,c,d){if(Rn.current!==fo)throw Error(t(168));_t(Rn,c),_t(Hn,d)}function uE(a,c,d){var m=a.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var _ in m)if(!(_ in c))throw Error(t(108,Me(a)||"Unknown",_));return ne({},d,m)}function Bf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||fo,Ta=Rn.current,_t(Rn,a),_t(Hn,Hn.current),!0}function hE(a,c,d){var m=a.stateNode;if(!m)throw Error(t(169));d?(a=uE(a,c,Ta),m.__reactInternalMemoizedMergedChildContext=a,wt(Hn),wt(Rn),_t(Rn,a)):wt(Hn),_t(Hn,d)}var Ts=null,Gf=!1,Vy=!1;function dE(a){Ts===null?Ts=[a]:Ts.push(a)}function nM(a){Gf=!0,dE(a)}function go(){if(!Vy&&Ts!==null){Vy=!0;var a=0,c=He;try{var d=Ts;for(He=1;a<d.length;a++){var m=d[a];do m=m(!0);while(m!==null)}Ts=null,Gf=!1}catch(_){throw Ts!==null&&(Ts=Ts.slice(a+1)),Vu(jl,go),_}finally{He=c,Vy=!1}}return null}var oc=[],ac=0,Wf=null,$f=0,Li=[],Oi=0,Sa=null,Ss=1,Is="";function Ia(a,c){oc[ac++]=$f,oc[ac++]=Wf,Wf=a,$f=c}function fE(a,c,d){Li[Oi++]=Ss,Li[Oi++]=Is,Li[Oi++]=Sa,Sa=a;var m=Ss;a=Is;var _=32-hi(m)-1;m&=~(1<<_),d+=1;var x=32-hi(c)+_;if(30<x){var A=_-_%5;x=(m&(1<<A)-1).toString(32),m>>=A,_-=A,Ss=1<<32-hi(c)+_|d<<_|m,Is=x+a}else Ss=1<<x|d<<_|m,Is=a}function jy(a){a.return!==null&&(Ia(a,1),fE(a,1,0))}function Uy(a){for(;a===Wf;)Wf=oc[--ac],oc[ac]=null,$f=oc[--ac],oc[ac]=null;for(;a===Sa;)Sa=Li[--Oi],Li[Oi]=null,Is=Li[--Oi],Li[Oi]=null,Ss=Li[--Oi],Li[Oi]=null}var mi=null,yi=null,It=!1,rr=null;function gE(a,c){var d=Ui(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function pE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,mi=a,yi=uo(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,mi=a,yi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Sa!==null?{id:Ss,overflow:Is}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Ui(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,mi=a,yi=null,!0):!1;default:return!1}}function zy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function By(a){if(It){var c=yi;if(c){var d=c;if(!pE(a,c)){if(zy(a))throw Error(t(418));c=uo(d.nextSibling);var m=mi;c&&pE(a,c)?gE(m,d):(a.flags=a.flags&-4097|2,It=!1,mi=a)}}else{if(zy(a))throw Error(t(418));a.flags=a.flags&-4097|2,It=!1,mi=a}}}function mE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;mi=a}function Kf(a){if(a!==mi)return!1;if(!It)return mE(a),It=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Ny(a.type,a.memoizedProps)),c&&(c=yi)){if(zy(a))throw yE(),Error(t(418));for(;c;)gE(a,c),c=uo(c.nextSibling)}if(mE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){yi=uo(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}yi=null}}else yi=mi?uo(a.stateNode.nextSibling):null;return!0}function yE(){for(var a=yi;a;)a=uo(a.nextSibling)}function lc(){yi=mi=null,It=!1}function Gy(a){rr===null?rr=[a]:rr.push(a)}var iM=L.ReactCurrentBatchConfig;function ch(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var m=d.stateNode}if(!m)throw Error(t(147,a));var _=m,x=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===x?c.ref:(c=function(A){var U=_.refs;A===null?delete U[x]:U[x]=A},c._stringRef=x,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function Hf(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function _E(a){var c=a._init;return c(a._payload)}function vE(a){function c(H,K){if(a){var X=H.deletions;X===null?(H.deletions=[K],H.flags|=16):X.push(K)}}function d(H,K){if(!a)return null;for(;K!==null;)c(H,K),K=K.sibling;return null}function m(H,K){for(H=new Map;K!==null;)K.key!==null?H.set(K.key,K):H.set(K.index,K),K=K.sibling;return H}function _(H,K){return H=Eo(H,K),H.index=0,H.sibling=null,H}function x(H,K,X){return H.index=X,a?(X=H.alternate,X!==null?(X=X.index,X<K?(H.flags|=2,K):X):(H.flags|=2,K)):(H.flags|=1048576,K)}function A(H){return a&&H.alternate===null&&(H.flags|=2),H}function U(H,K,X,he){return K===null||K.tag!==6?(K=M_(X,H.mode,he),K.return=H,K):(K=_(K,X),K.return=H,K)}function G(H,K,X,he){var Te=X.type;return Te===b?ae(H,K,X.props.children,he,X.key):K!==null&&(K.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&_E(Te)===K.type)?(he=_(K,X.props),he.ref=ch(H,K,X),he.return=H,he):(he=yg(X.type,X.key,X.props,null,H.mode,he),he.ref=ch(H,K,X),he.return=H,he)}function J(H,K,X,he){return K===null||K.tag!==4||K.stateNode.containerInfo!==X.containerInfo||K.stateNode.implementation!==X.implementation?(K=L_(X,H.mode,he),K.return=H,K):(K=_(K,X.children||[]),K.return=H,K)}function ae(H,K,X,he,Te){return K===null||K.tag!==7?(K=Na(X,H.mode,he,Te),K.return=H,K):(K=_(K,X),K.return=H,K)}function ce(H,K,X){if(typeof K=="string"&&K!==""||typeof K=="number")return K=M_(""+K,H.mode,X),K.return=H,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case F:return X=yg(K.type,K.key,K.props,null,H.mode,X),X.ref=ch(H,null,K),X.return=H,X;case B:return K=L_(K,H.mode,X),K.return=H,K;case ge:var he=K._init;return ce(H,he(K._payload),X)}if(ct(K)||oe(K))return K=Na(K,H.mode,X,null),K.return=H,K;Hf(H,K)}return null}function se(H,K,X,he){var Te=K!==null?K.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return Te!==null?null:U(H,K,""+X,he);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case F:return X.key===Te?G(H,K,X,he):null;case B:return X.key===Te?J(H,K,X,he):null;case ge:return Te=X._init,se(H,K,Te(X._payload),he)}if(ct(X)||oe(X))return Te!==null?null:ae(H,K,X,he,null);Hf(H,X)}return null}function ye(H,K,X,he,Te){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(X)||null,U(K,H,""+he,Te);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case F:return H=H.get(he.key===null?X:he.key)||null,G(K,H,he,Te);case B:return H=H.get(he.key===null?X:he.key)||null,J(K,H,he,Te);case ge:var Ae=he._init;return ye(H,K,X,Ae(he._payload),Te)}if(ct(he)||oe(he))return H=H.get(X)||null,ae(K,H,he,Te,null);Hf(K,he)}return null}function ve(H,K,X,he){for(var Te=null,Ae=null,Pe=K,Le=K=0,on=null;Pe!==null&&Le<X.length;Le++){Pe.index>Le?(on=Pe,Pe=null):on=Pe.sibling;var et=se(H,Pe,X[Le],he);if(et===null){Pe===null&&(Pe=on);break}a&&Pe&&et.alternate===null&&c(H,Pe),K=x(et,K,Le),Ae===null?Te=et:Ae.sibling=et,Ae=et,Pe=on}if(Le===X.length)return d(H,Pe),It&&Ia(H,Le),Te;if(Pe===null){for(;Le<X.length;Le++)Pe=ce(H,X[Le],he),Pe!==null&&(K=x(Pe,K,Le),Ae===null?Te=Pe:Ae.sibling=Pe,Ae=Pe);return It&&Ia(H,Le),Te}for(Pe=m(H,Pe);Le<X.length;Le++)on=ye(Pe,H,Le,X[Le],he),on!==null&&(a&&on.alternate!==null&&Pe.delete(on.key===null?Le:on.key),K=x(on,K,Le),Ae===null?Te=on:Ae.sibling=on,Ae=on);return a&&Pe.forEach(function(To){return c(H,To)}),It&&Ia(H,Le),Te}function we(H,K,X,he){var Te=oe(X);if(typeof Te!="function")throw Error(t(150));if(X=Te.call(X),X==null)throw Error(t(151));for(var Ae=Te=null,Pe=K,Le=K=0,on=null,et=X.next();Pe!==null&&!et.done;Le++,et=X.next()){Pe.index>Le?(on=Pe,Pe=null):on=Pe.sibling;var To=se(H,Pe,et.value,he);if(To===null){Pe===null&&(Pe=on);break}a&&Pe&&To.alternate===null&&c(H,Pe),K=x(To,K,Le),Ae===null?Te=To:Ae.sibling=To,Ae=To,Pe=on}if(et.done)return d(H,Pe),It&&Ia(H,Le),Te;if(Pe===null){for(;!et.done;Le++,et=X.next())et=ce(H,et.value,he),et!==null&&(K=x(et,K,Le),Ae===null?Te=et:Ae.sibling=et,Ae=et);return It&&Ia(H,Le),Te}for(Pe=m(H,Pe);!et.done;Le++,et=X.next())et=ye(Pe,H,Le,et.value,he),et!==null&&(a&&et.alternate!==null&&Pe.delete(et.key===null?Le:et.key),K=x(et,K,Le),Ae===null?Te=et:Ae.sibling=et,Ae=et);return a&&Pe.forEach(function(OM){return c(H,OM)}),It&&Ia(H,Le),Te}function jt(H,K,X,he){if(typeof X=="object"&&X!==null&&X.type===b&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case F:e:{for(var Te=X.key,Ae=K;Ae!==null;){if(Ae.key===Te){if(Te=X.type,Te===b){if(Ae.tag===7){d(H,Ae.sibling),K=_(Ae,X.props.children),K.return=H,H=K;break e}}else if(Ae.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&_E(Te)===Ae.type){d(H,Ae.sibling),K=_(Ae,X.props),K.ref=ch(H,Ae,X),K.return=H,H=K;break e}d(H,Ae);break}else c(H,Ae);Ae=Ae.sibling}X.type===b?(K=Na(X.props.children,H.mode,he,X.key),K.return=H,H=K):(he=yg(X.type,X.key,X.props,null,H.mode,he),he.ref=ch(H,K,X),he.return=H,H=he)}return A(H);case B:e:{for(Ae=X.key;K!==null;){if(K.key===Ae)if(K.tag===4&&K.stateNode.containerInfo===X.containerInfo&&K.stateNode.implementation===X.implementation){d(H,K.sibling),K=_(K,X.children||[]),K.return=H,H=K;break e}else{d(H,K);break}else c(H,K);K=K.sibling}K=L_(X,H.mode,he),K.return=H,H=K}return A(H);case ge:return Ae=X._init,jt(H,K,Ae(X._payload),he)}if(ct(X))return ve(H,K,X,he);if(oe(X))return we(H,K,X,he);Hf(H,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,K!==null&&K.tag===6?(d(H,K.sibling),K=_(K,X),K.return=H,H=K):(d(H,K),K=M_(X,H.mode,he),K.return=H,H=K),A(H)):d(H,K)}return jt}var cc=vE(!0),xE=vE(!1),qf=ho(null),Xf=null,uc=null,Wy=null;function $y(){Wy=uc=Xf=null}function Ky(a){var c=qf.current;wt(qf),a._currentValue=c}function Hy(a,c,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===d)break;a=a.return}}function hc(a,c){Xf=a,Wy=uc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(Xn=!0),a.firstContext=null)}function Fi(a){var c=a._currentValue;if(Wy!==a)if(a={context:a,memoizedValue:c,next:null},uc===null){if(Xf===null)throw Error(t(308));uc=a,Xf.dependencies={lanes:0,firstContext:a}}else uc=uc.next=a;return c}var Ca=null;function qy(a){Ca===null?Ca=[a]:Ca.push(a)}function wE(a,c,d,m){var _=c.interleaved;return _===null?(d.next=d,qy(c)):(d.next=_.next,_.next=d),c.interleaved=d,Cs(a,m)}function Cs(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var po=!1;function Xy(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Rs(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function mo(a,c,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Qe&2)!==0){var _=m.pending;return _===null?c.next=c:(c.next=_.next,_.next=c),m.pending=c,Cs(a,d)}return _=m.interleaved,_===null?(c.next=c,qy(m)):(c.next=_.next,_.next=c),m.interleaved=c,Cs(a,d)}function Yf(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Wu(a,d)}}function TE(a,c){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var _=null,x=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};x===null?_=x=A:x=x.next=A,d=d.next}while(d!==null);x===null?_=x=c:x=x.next=c}else _=x=c;d={baseState:m.baseState,firstBaseUpdate:_,lastBaseUpdate:x,shared:m.shared,effects:m.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function Zf(a,c,d,m){var _=a.updateQueue;po=!1;var x=_.firstBaseUpdate,A=_.lastBaseUpdate,U=_.shared.pending;if(U!==null){_.shared.pending=null;var G=U,J=G.next;G.next=null,A===null?x=J:A.next=J,A=G;var ae=a.alternate;ae!==null&&(ae=ae.updateQueue,U=ae.lastBaseUpdate,U!==A&&(U===null?ae.firstBaseUpdate=J:U.next=J,ae.lastBaseUpdate=G))}if(x!==null){var ce=_.baseState;A=0,ae=J=G=null,U=x;do{var se=U.lane,ye=U.eventTime;if((m&se)===se){ae!==null&&(ae=ae.next={eventTime:ye,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ve=a,we=U;switch(se=c,ye=d,we.tag){case 1:if(ve=we.payload,typeof ve=="function"){ce=ve.call(ye,ce,se);break e}ce=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=we.payload,se=typeof ve=="function"?ve.call(ye,ce,se):ve,se==null)break e;ce=ne({},ce,se);break e;case 2:po=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,se=_.effects,se===null?_.effects=[U]:se.push(U))}else ye={eventTime:ye,lane:se,tag:U.tag,payload:U.payload,callback:U.callback,next:null},ae===null?(J=ae=ye,G=ce):ae=ae.next=ye,A|=se;if(U=U.next,U===null){if(U=_.shared.pending,U===null)break;se=U,U=se.next,se.next=null,_.lastBaseUpdate=se,_.shared.pending=null}}while(!0);if(ae===null&&(G=ce),_.baseState=G,_.firstBaseUpdate=J,_.lastBaseUpdate=ae,c=_.shared.interleaved,c!==null){_=c;do A|=_.lane,_=_.next;while(_!==c)}else x===null&&(_.shared.lanes=0);Pa|=A,a.lanes=A,a.memoizedState=ce}}function SE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var m=a[c],_=m.callback;if(_!==null){if(m.callback=null,m=d,typeof _!="function")throw Error(t(191,_));_.call(m)}}}var uh={},$r=ho(uh),hh=ho(uh),dh=ho(uh);function Ra(a){if(a===uh)throw Error(t(174));return a}function Yy(a,c){switch(_t(dh,c),_t(hh,a),_t($r,uh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ji(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=Ji(c,a)}wt($r),_t($r,c)}function dc(){wt($r),wt(hh),wt(dh)}function IE(a){Ra(dh.current);var c=Ra($r.current),d=Ji(c,a.type);c!==d&&(_t(hh,a),_t($r,d))}function Zy(a){hh.current===a&&(wt($r),wt(hh))}var At=ho(0);function Qf(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Qy=[];function Jy(){for(var a=0;a<Qy.length;a++)Qy[a]._workInProgressVersionPrimary=null;Qy.length=0}var Jf=L.ReactCurrentDispatcher,e_=L.ReactCurrentBatchConfig,Aa=0,Pt=null,Xt=null,rn=null,eg=!1,fh=!1,gh=0,rM=0;function An(){throw Error(t(321))}function t_(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!ir(a[d],c[d]))return!1;return!0}function n_(a,c,d,m,_,x){if(Aa=x,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Jf.current=a===null||a.memoizedState===null?lM:cM,a=d(m,_),fh){x=0;do{if(fh=!1,gh=0,25<=x)throw Error(t(301));x+=1,rn=Xt=null,c.updateQueue=null,Jf.current=uM,a=d(m,_)}while(fh)}if(Jf.current=ig,c=Xt!==null&&Xt.next!==null,Aa=0,rn=Xt=Pt=null,eg=!1,c)throw Error(t(300));return a}function i_(){var a=gh!==0;return gh=0,a}function Kr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Pt.memoizedState=rn=a:rn=rn.next=a,rn}function Vi(){if(Xt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=Xt.next;var c=rn===null?Pt.memoizedState:rn.next;if(c!==null)rn=c,Xt=a;else{if(a===null)throw Error(t(310));Xt=a,a={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},rn===null?Pt.memoizedState=rn=a:rn=rn.next=a}return rn}function ph(a,c){return typeof c=="function"?c(a):c}function r_(a){var c=Vi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=Xt,_=m.baseQueue,x=d.pending;if(x!==null){if(_!==null){var A=_.next;_.next=x.next,x.next=A}m.baseQueue=_=x,d.pending=null}if(_!==null){x=_.next,m=m.baseState;var U=A=null,G=null,J=x;do{var ae=J.lane;if((Aa&ae)===ae)G!==null&&(G=G.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),m=J.hasEagerState?J.eagerState:a(m,J.action);else{var ce={lane:ae,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};G===null?(U=G=ce,A=m):G=G.next=ce,Pt.lanes|=ae,Pa|=ae}J=J.next}while(J!==null&&J!==x);G===null?A=m:G.next=U,ir(m,c.memoizedState)||(Xn=!0),c.memoizedState=m,c.baseState=A,c.baseQueue=G,d.lastRenderedState=m}if(a=d.interleaved,a!==null){_=a;do x=_.lane,Pt.lanes|=x,Pa|=x,_=_.next;while(_!==a)}else _===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function s_(a){var c=Vi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=d.dispatch,_=d.pending,x=c.memoizedState;if(_!==null){d.pending=null;var A=_=_.next;do x=a(x,A.action),A=A.next;while(A!==_);ir(x,c.memoizedState)||(Xn=!0),c.memoizedState=x,c.baseQueue===null&&(c.baseState=x),d.lastRenderedState=x}return[x,m]}function CE(){}function RE(a,c){var d=Pt,m=Vi(),_=c(),x=!ir(m.memoizedState,_);if(x&&(m.memoizedState=_,Xn=!0),m=m.queue,o_(bE.bind(null,d,m,a),[a]),m.getSnapshot!==c||x||rn!==null&&rn.memoizedState.tag&1){if(d.flags|=2048,mh(9,PE.bind(null,d,m,_,c),void 0,null),sn===null)throw Error(t(349));(Aa&30)!==0||AE(d,c,_)}return _}function AE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function PE(a,c,d,m){c.value=d,c.getSnapshot=m,kE(c)&&DE(a)}function bE(a,c,d){return d(function(){kE(c)&&DE(a)})}function kE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!ir(a,d)}catch{return!0}}function DE(a){var c=Cs(a,1);c!==null&&lr(c,a,1,-1)}function NE(a){var c=Kr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ph,lastRenderedState:a},c.queue=a,a=a.dispatch=aM.bind(null,Pt,a),[c.memoizedState,a]}function mh(a,c,d,m){return a={tag:a,create:c,destroy:d,deps:m,next:null},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,c.lastEffect=a)),a}function ME(){return Vi().memoizedState}function tg(a,c,d,m){var _=Kr();Pt.flags|=a,_.memoizedState=mh(1|c,d,void 0,m===void 0?null:m)}function ng(a,c,d,m){var _=Vi();m=m===void 0?null:m;var x=void 0;if(Xt!==null){var A=Xt.memoizedState;if(x=A.destroy,m!==null&&t_(m,A.deps)){_.memoizedState=mh(c,d,x,m);return}}Pt.flags|=a,_.memoizedState=mh(1|c,d,x,m)}function LE(a,c){return tg(8390656,8,a,c)}function o_(a,c){return ng(2048,8,a,c)}function OE(a,c){return ng(4,2,a,c)}function FE(a,c){return ng(4,4,a,c)}function VE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function jE(a,c,d){return d=d!=null?d.concat([a]):null,ng(4,4,VE.bind(null,c,a),d)}function a_(){}function UE(a,c){var d=Vi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&t_(c,m[1])?m[0]:(d.memoizedState=[a,c],a)}function zE(a,c){var d=Vi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&t_(c,m[1])?m[0]:(a=a(),d.memoizedState=[a,c],a)}function BE(a,c,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,Xn=!0),a.memoizedState=d):(ir(d,c)||(d=Bu(),Pt.lanes|=d,Pa|=d,a.baseState=!0),c)}function sM(a,c){var d=He;He=d!==0&&4>d?d:4,a(!0);var m=e_.transition;e_.transition={};try{a(!1),c()}finally{He=d,e_.transition=m}}function GE(){return Vi().memoizedState}function oM(a,c,d){var m=xo(a);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},WE(a))$E(c,d);else if(d=wE(a,c,d,m),d!==null){var _=Un();lr(d,a,m,_),KE(d,c,m)}}function aM(a,c,d){var m=xo(a),_={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(WE(a))$E(c,_);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=c.lastRenderedReducer,x!==null))try{var A=c.lastRenderedState,U=x(A,d);if(_.hasEagerState=!0,_.eagerState=U,ir(U,A)){var G=c.interleaved;G===null?(_.next=_,qy(c)):(_.next=G.next,G.next=_),c.interleaved=_;return}}catch{}d=wE(a,c,_,m),d!==null&&(_=Un(),lr(d,a,m,_),KE(d,c,m))}}function WE(a){var c=a.alternate;return a===Pt||c!==null&&c===Pt}function $E(a,c){fh=eg=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function KE(a,c,d){if((d&4194240)!==0){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Wu(a,d)}}var ig={readContext:Fi,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},lM={readContext:Fi,useCallback:function(a,c){return Kr().memoizedState=[a,c===void 0?null:c],a},useContext:Fi,useEffect:LE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,tg(4194308,4,VE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return tg(4194308,4,a,c)},useInsertionEffect:function(a,c){return tg(4,2,a,c)},useMemo:function(a,c){var d=Kr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var m=Kr();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},m.queue=a,a=a.dispatch=oM.bind(null,Pt,a),[m.memoizedState,a]},useRef:function(a){var c=Kr();return a={current:a},c.memoizedState=a},useState:NE,useDebugValue:a_,useDeferredValue:function(a){return Kr().memoizedState=a},useTransition:function(){var a=NE(!1),c=a[0];return a=sM.bind(null,a[1]),Kr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var m=Pt,_=Kr();if(It){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),sn===null)throw Error(t(349));(Aa&30)!==0||AE(m,c,d)}_.memoizedState=d;var x={value:d,getSnapshot:c};return _.queue=x,LE(bE.bind(null,m,x,a),[a]),m.flags|=2048,mh(9,PE.bind(null,m,x,d,c),void 0,null),d},useId:function(){var a=Kr(),c=sn.identifierPrefix;if(It){var d=Is,m=Ss;d=(m&~(1<<32-hi(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=gh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=rM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},cM={readContext:Fi,useCallback:UE,useContext:Fi,useEffect:o_,useImperativeHandle:jE,useInsertionEffect:OE,useLayoutEffect:FE,useMemo:zE,useReducer:r_,useRef:ME,useState:function(){return r_(ph)},useDebugValue:a_,useDeferredValue:function(a){var c=Vi();return BE(c,Xt.memoizedState,a)},useTransition:function(){var a=r_(ph)[0],c=Vi().memoizedState;return[a,c]},useMutableSource:CE,useSyncExternalStore:RE,useId:GE,unstable_isNewReconciler:!1},uM={readContext:Fi,useCallback:UE,useContext:Fi,useEffect:o_,useImperativeHandle:jE,useInsertionEffect:OE,useLayoutEffect:FE,useMemo:zE,useReducer:s_,useRef:ME,useState:function(){return s_(ph)},useDebugValue:a_,useDeferredValue:function(a){var c=Vi();return Xt===null?c.memoizedState=a:BE(c,Xt.memoizedState,a)},useTransition:function(){var a=s_(ph)[0],c=Vi().memoizedState;return[a,c]},useMutableSource:CE,useSyncExternalStore:RE,useId:GE,unstable_isNewReconciler:!1};function sr(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function l_(a,c,d,m){c=a.memoizedState,d=d(m,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var rg={isMounted:function(a){return(a=a._reactInternals)?tr(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var m=Un(),_=xo(a),x=Rs(m,_);x.payload=c,d!=null&&(x.callback=d),c=mo(a,x,_),c!==null&&(lr(c,a,_,m),Yf(c,a,_))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var m=Un(),_=xo(a),x=Rs(m,_);x.tag=1,x.payload=c,d!=null&&(x.callback=d),c=mo(a,x,_),c!==null&&(lr(c,a,_,m),Yf(c,a,_))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=Un(),m=xo(a),_=Rs(d,m);_.tag=2,c!=null&&(_.callback=c),c=mo(a,_,m),c!==null&&(lr(c,a,m,d),Yf(c,a,m))}};function HE(a,c,d,m,_,x,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,x,A):c.prototype&&c.prototype.isPureReactComponent?!nh(d,m)||!nh(_,x):!0}function qE(a,c,d){var m=!1,_=fo,x=c.contextType;return typeof x=="object"&&x!==null?x=Fi(x):(_=qn(c)?Ta:Rn.current,m=c.contextTypes,x=(m=m!=null)?sc(a,_):fo),c=new c(d,x),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=rg,a.stateNode=c,c._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=_,a.__reactInternalMemoizedMaskedChildContext=x),c}function XE(a,c,d,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==a&&rg.enqueueReplaceState(c,c.state,null)}function c_(a,c,d,m){var _=a.stateNode;_.props=d,_.state=a.memoizedState,_.refs={},Xy(a);var x=c.contextType;typeof x=="object"&&x!==null?_.context=Fi(x):(x=qn(c)?Ta:Rn.current,_.context=sc(a,x)),_.state=a.memoizedState,x=c.getDerivedStateFromProps,typeof x=="function"&&(l_(a,c,x,d),_.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(c=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),c!==_.state&&rg.enqueueReplaceState(_,_.state,null),Zf(a,d,_,m),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308)}function fc(a,c){try{var d="",m=c;do d+=xe(m),m=m.return;while(m);var _=d}catch(x){_=`
Error generating stack: `+x.message+`
`+x.stack}return{value:a,source:c,stack:_,digest:null}}function u_(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function h_(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var hM=typeof WeakMap=="function"?WeakMap:Map;function YE(a,c,d){d=Rs(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){hg||(hg=!0,C_=m),h_(a,c)},d}function ZE(a,c,d){d=Rs(-1,d),d.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var _=c.value;d.payload=function(){return m(_)},d.callback=function(){h_(a,c)}}var x=a.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(d.callback=function(){h_(a,c),typeof m!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})}),d}function QE(a,c,d){var m=a.pingCache;if(m===null){m=a.pingCache=new hM;var _=new Set;m.set(c,_)}else _=m.get(c),_===void 0&&(_=new Set,m.set(c,_));_.has(d)||(_.add(d),a=IM.bind(null,a,c,d),c.then(a,a))}function JE(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function eT(a,c,d,m,_){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=Rs(-1,1),c.tag=2,mo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=_,a)}var dM=L.ReactCurrentOwner,Xn=!1;function jn(a,c,d,m){c.child=a===null?xE(c,null,d,m):cc(c,a.child,d,m)}function tT(a,c,d,m,_){d=d.render;var x=c.ref;return hc(c,_),m=n_(a,c,d,m,x,_),d=i_(),a!==null&&!Xn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~_,As(a,c,_)):(It&&d&&jy(c),c.flags|=1,jn(a,c,m,_),c.child)}function nT(a,c,d,m,_){if(a===null){var x=d.type;return typeof x=="function"&&!N_(x)&&x.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=x,iT(a,c,x,m,_)):(a=yg(d.type,null,m,c,c.mode,_),a.ref=c.ref,a.return=c,c.child=a)}if(x=a.child,(a.lanes&_)===0){var A=x.memoizedProps;if(d=d.compare,d=d!==null?d:nh,d(A,m)&&a.ref===c.ref)return As(a,c,_)}return c.flags|=1,a=Eo(x,m),a.ref=c.ref,a.return=c,c.child=a}function iT(a,c,d,m,_){if(a!==null){var x=a.memoizedProps;if(nh(x,m)&&a.ref===c.ref)if(Xn=!1,c.pendingProps=m=x,(a.lanes&_)!==0)(a.flags&131072)!==0&&(Xn=!0);else return c.lanes=a.lanes,As(a,c,_)}return d_(a,c,d,m,_)}function rT(a,c,d){var m=c.pendingProps,_=m.children,x=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(pc,_i),_i|=d;else{if((d&1073741824)===0)return a=x!==null?x.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,_t(pc,_i),_i|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=x!==null?x.baseLanes:d,_t(pc,_i),_i|=m}else x!==null?(m=x.baseLanes|d,c.memoizedState=null):m=d,_t(pc,_i),_i|=m;return jn(a,c,_,d),c.child}function sT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function d_(a,c,d,m,_){var x=qn(d)?Ta:Rn.current;return x=sc(c,x),hc(c,_),d=n_(a,c,d,m,x,_),m=i_(),a!==null&&!Xn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~_,As(a,c,_)):(It&&m&&jy(c),c.flags|=1,jn(a,c,d,_),c.child)}function oT(a,c,d,m,_){if(qn(d)){var x=!0;Bf(c)}else x=!1;if(hc(c,_),c.stateNode===null)og(a,c),qE(c,d,m),c_(c,d,m,_),m=!0;else if(a===null){var A=c.stateNode,U=c.memoizedProps;A.props=U;var G=A.context,J=d.contextType;typeof J=="object"&&J!==null?J=Fi(J):(J=qn(d)?Ta:Rn.current,J=sc(c,J));var ae=d.getDerivedStateFromProps,ce=typeof ae=="function"||typeof A.getSnapshotBeforeUpdate=="function";ce||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==m||G!==J)&&XE(c,A,m,J),po=!1;var se=c.memoizedState;A.state=se,Zf(c,m,A,_),G=c.memoizedState,U!==m||se!==G||Hn.current||po?(typeof ae=="function"&&(l_(c,d,ae,m),G=c.memoizedState),(U=po||HE(c,d,U,m,se,G,J))?(ce||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=G),A.props=m,A.state=G,A.context=J,m=U):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{A=c.stateNode,EE(a,c),U=c.memoizedProps,J=c.type===c.elementType?U:sr(c.type,U),A.props=J,ce=c.pendingProps,se=A.context,G=d.contextType,typeof G=="object"&&G!==null?G=Fi(G):(G=qn(d)?Ta:Rn.current,G=sc(c,G));var ye=d.getDerivedStateFromProps;(ae=typeof ye=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==ce||se!==G)&&XE(c,A,m,G),po=!1,se=c.memoizedState,A.state=se,Zf(c,m,A,_);var ve=c.memoizedState;U!==ce||se!==ve||Hn.current||po?(typeof ye=="function"&&(l_(c,d,ye,m),ve=c.memoizedState),(J=po||HE(c,d,J,m,se,ve,G)||!1)?(ae||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,ve,G),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,ve,G)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=ve),A.props=m,A.state=ve,A.context=G,m=J):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),m=!1)}return f_(a,c,d,m,x,_)}function f_(a,c,d,m,_,x){sT(a,c);var A=(c.flags&128)!==0;if(!m&&!A)return _&&hE(c,d,!1),As(a,c,x);m=c.stateNode,dM.current=c;var U=A&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,a!==null&&A?(c.child=cc(c,a.child,null,x),c.child=cc(c,null,U,x)):jn(a,c,U,x),c.memoizedState=m.state,_&&hE(c,d,!0),c.child}function aT(a){var c=a.stateNode;c.pendingContext?cE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&cE(a,c.context,!1),Yy(a,c.containerInfo)}function lT(a,c,d,m,_){return lc(),Gy(_),c.flags|=256,jn(a,c,d,m),c.child}var g_={dehydrated:null,treeContext:null,retryLane:0};function p_(a){return{baseLanes:a,cachePool:null,transitions:null}}function cT(a,c,d){var m=c.pendingProps,_=At.current,x=!1,A=(c.flags&128)!==0,U;if((U=A)||(U=a!==null&&a.memoizedState===null?!1:(_&2)!==0),U?(x=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(_|=1),_t(At,_&1),a===null)return By(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(A=m.children,a=m.fallback,x?(m=c.mode,x=c.child,A={mode:"hidden",children:A},(m&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=A):x=_g(A,m,0,null),a=Na(a,m,d,null),x.return=c,a.return=c,x.sibling=a,c.child=x,c.child.memoizedState=p_(d),c.memoizedState=g_,a):m_(c,A));if(_=a.memoizedState,_!==null&&(U=_.dehydrated,U!==null))return fM(a,c,A,m,U,_,d);if(x){x=m.fallback,A=c.mode,_=a.child,U=_.sibling;var G={mode:"hidden",children:m.children};return(A&1)===0&&c.child!==_?(m=c.child,m.childLanes=0,m.pendingProps=G,c.deletions=null):(m=Eo(_,G),m.subtreeFlags=_.subtreeFlags&14680064),U!==null?x=Eo(U,x):(x=Na(x,A,d,null),x.flags|=2),x.return=c,m.return=c,m.sibling=x,c.child=m,m=x,x=c.child,A=a.child.memoizedState,A=A===null?p_(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},x.memoizedState=A,x.childLanes=a.childLanes&~d,c.memoizedState=g_,m}return x=a.child,a=x.sibling,m=Eo(x,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=m,c.memoizedState=null,m}function m_(a,c){return c=_g({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function sg(a,c,d,m){return m!==null&&Gy(m),cc(c,a.child,null,d),a=m_(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function fM(a,c,d,m,_,x,A){if(d)return c.flags&256?(c.flags&=-257,m=u_(Error(t(422))),sg(a,c,A,m)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(x=m.fallback,_=c.mode,m=_g({mode:"visible",children:m.children},_,0,null),x=Na(x,_,A,null),x.flags|=2,m.return=c,x.return=c,m.sibling=x,c.child=m,(c.mode&1)!==0&&cc(c,a.child,null,A),c.child.memoizedState=p_(A),c.memoizedState=g_,x);if((c.mode&1)===0)return sg(a,c,A,null);if(_.data==="$!"){if(m=_.nextSibling&&_.nextSibling.dataset,m)var U=m.dgst;return m=U,x=Error(t(419)),m=u_(x,m,void 0),sg(a,c,A,m)}if(U=(A&a.childLanes)!==0,Xn||U){if(m=sn,m!==null){switch(A&-A){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(m.suspendedLanes|A))!==0?0:_,_!==0&&_!==x.retryLane&&(x.retryLane=_,Cs(a,_),lr(m,a,_,-1))}return D_(),m=u_(Error(t(421))),sg(a,c,A,m)}return _.data==="$?"?(c.flags|=128,c.child=a.child,c=CM.bind(null,a),_._reactRetry=c,null):(a=x.treeContext,yi=uo(_.nextSibling),mi=c,It=!0,rr=null,a!==null&&(Li[Oi++]=Ss,Li[Oi++]=Is,Li[Oi++]=Sa,Ss=a.id,Is=a.overflow,Sa=c),c=m_(c,m.children),c.flags|=4096,c)}function uT(a,c,d){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),Hy(a.return,c,d)}function y_(a,c,d,m,_){var x=a.memoizedState;x===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:_}:(x.isBackwards=c,x.rendering=null,x.renderingStartTime=0,x.last=m,x.tail=d,x.tailMode=_)}function hT(a,c,d){var m=c.pendingProps,_=m.revealOrder,x=m.tail;if(jn(a,c,m.children,d),m=At.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&uT(a,d,c);else if(a.tag===19)uT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(_t(At,m),(c.mode&1)===0)c.memoizedState=null;else switch(_){case"forwards":for(d=c.child,_=null;d!==null;)a=d.alternate,a!==null&&Qf(a)===null&&(_=d),d=d.sibling;d=_,d===null?(_=c.child,c.child=null):(_=d.sibling,d.sibling=null),y_(c,!1,_,d,x);break;case"backwards":for(d=null,_=c.child,c.child=null;_!==null;){if(a=_.alternate,a!==null&&Qf(a)===null){c.child=_;break}a=_.sibling,_.sibling=d,d=_,_=a}y_(c,!0,d,null,x);break;case"together":y_(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function og(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function As(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),Pa|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=Eo(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=Eo(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function gM(a,c,d){switch(c.tag){case 3:aT(c),lc();break;case 5:IE(c);break;case 1:qn(c.type)&&Bf(c);break;case 4:Yy(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,_=c.memoizedProps.value;_t(qf,m._currentValue),m._currentValue=_;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(_t(At,At.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?cT(a,c,d):(_t(At,At.current&1),a=As(a,c,d),a!==null?a.sibling:null);_t(At,At.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(a.flags&128)!==0){if(m)return hT(a,c,d);c.flags|=128}if(_=c.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),_t(At,At.current),m)break;return null;case 22:case 23:return c.lanes=0,rT(a,c,d)}return As(a,c,d)}var dT,__,fT,gT;dT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},__=function(){},fT=function(a,c,d,m){var _=a.memoizedProps;if(_!==m){a=c.stateNode,Ra($r.current);var x=null;switch(d){case"input":_=$n(a,_),m=$n(a,m),x=[];break;case"select":_=ne({},_,{value:void 0}),m=ne({},m,{value:void 0}),x=[];break;case"textarea":_=Ai(a,_),m=Ai(a,m),x=[];break;default:typeof _.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=jf)}On(d,m);var A;d=null;for(J in _)if(!m.hasOwnProperty(J)&&_.hasOwnProperty(J)&&_[J]!=null)if(J==="style"){var U=_[J];for(A in U)U.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?x||(x=[]):(x=x||[]).push(J,null));for(J in m){var G=m[J];if(U=_?.[J],m.hasOwnProperty(J)&&G!==U&&(G!=null||U!=null))if(J==="style")if(U){for(A in U)!U.hasOwnProperty(A)||G&&G.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in G)G.hasOwnProperty(A)&&U[A]!==G[A]&&(d||(d={}),d[A]=G[A])}else d||(x||(x=[]),x.push(J,d)),d=G;else J==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,U=U?U.__html:void 0,G!=null&&U!==G&&(x=x||[]).push(J,G)):J==="children"?typeof G!="string"&&typeof G!="number"||(x=x||[]).push(J,""+G):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(r.hasOwnProperty(J)?(G!=null&&J==="onScroll"&&xt("scroll",a),x||U===G||(x=[])):(x=x||[]).push(J,G))}d&&(x=x||[]).push("style",d);var J=x;(c.updateQueue=J)&&(c.flags|=4)}},gT=function(a,c,d,m){d!==m&&(c.flags|=4)};function yh(a,c){if(!It)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function Pn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(c)for(var _=a.child;_!==null;)d|=_.lanes|_.childLanes,m|=_.subtreeFlags&14680064,m|=_.flags&14680064,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)d|=_.lanes|_.childLanes,m|=_.subtreeFlags,m|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=m,a.childLanes=d,c}function pM(a,c,d){var m=c.pendingProps;switch(Uy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(c),null;case 1:return qn(c.type)&&zf(),Pn(c),null;case 3:return m=c.stateNode,dc(),wt(Hn),wt(Rn),Jy(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(Kf(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,rr!==null&&(P_(rr),rr=null))),__(a,c),Pn(c),null;case 5:Zy(c);var _=Ra(dh.current);if(d=c.type,a!==null&&c.stateNode!=null)fT(a,c,d,m,_),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return Pn(c),null}if(a=Ra($r.current),Kf(c)){m=c.stateNode,d=c.type;var x=c.memoizedProps;switch(m[Wr]=c,m[ah]=x,a=(c.mode&1)!==0,d){case"dialog":xt("cancel",m),xt("close",m);break;case"iframe":case"object":case"embed":xt("load",m);break;case"video":case"audio":for(_=0;_<rh.length;_++)xt(rh[_],m);break;case"source":xt("error",m);break;case"img":case"image":case"link":xt("error",m),xt("load",m);break;case"details":xt("toggle",m);break;case"input":hn(m,x),xt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!x.multiple},xt("invalid",m);break;case"textarea":St(m,x),xt("invalid",m)}On(d,x),_=null;for(var A in x)if(x.hasOwnProperty(A)){var U=x[A];A==="children"?typeof U=="string"?m.textContent!==U&&(x.suppressHydrationWarning!==!0&&Vf(m.textContent,U,a),_=["children",U]):typeof U=="number"&&m.textContent!==""+U&&(x.suppressHydrationWarning!==!0&&Vf(m.textContent,U,a),_=["children",""+U]):r.hasOwnProperty(A)&&U!=null&&A==="onScroll"&&xt("scroll",m)}switch(d){case"input":Qi(m),Ri(m,x,!0);break;case"textarea":Qi(m),Pi(m);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(m.onclick=jf)}m=_,c.updateQueue=m,m!==null&&(c.flags|=4)}else{A=_.nodeType===9?_:_.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Cr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=A.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=A.createElement(d,{is:m.is}):(a=A.createElement(d),d==="select"&&(A=a,m.multiple?A.multiple=!0:m.size&&(A.size=m.size))):a=A.createElementNS(a,d),a[Wr]=c,a[ah]=m,dT(a,c,!1,!1),c.stateNode=a;e:{switch(A=gs(d,m),d){case"dialog":xt("cancel",a),xt("close",a),_=m;break;case"iframe":case"object":case"embed":xt("load",a),_=m;break;case"video":case"audio":for(_=0;_<rh.length;_++)xt(rh[_],a);_=m;break;case"source":xt("error",a),_=m;break;case"img":case"image":case"link":xt("error",a),xt("load",a),_=m;break;case"details":xt("toggle",a),_=m;break;case"input":hn(a,m),_=$n(a,m),xt("invalid",a);break;case"option":_=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},_=ne({},m,{value:void 0}),xt("invalid",a);break;case"textarea":St(a,m),_=Ai(a,m),xt("invalid",a);break;default:_=m}On(d,_),U=_;for(x in U)if(U.hasOwnProperty(x)){var G=U[x];x==="style"?fs(a,G):x==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,G!=null&&ca(a,G)):x==="children"?typeof G=="string"?(d!=="textarea"||G!=="")&&Ar(a,G):typeof G=="number"&&Ar(a,""+G):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(r.hasOwnProperty(x)?G!=null&&x==="onScroll"&&xt("scroll",a):G!=null&&D(a,x,G,A))}switch(d){case"input":Qi(a),Ri(a,m,!1);break;case"textarea":Qi(a),Pi(a);break;case"option":m.value!=null&&a.setAttribute("value",""+Ve(m.value));break;case"select":a.multiple=!!m.multiple,x=m.value,x!=null?tn(a,!!m.multiple,x,!1):m.defaultValue!=null&&tn(a,!!m.multiple,m.defaultValue,!0);break;default:typeof _.onClick=="function"&&(a.onclick=jf)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Pn(c),null;case 6:if(a&&c.stateNode!=null)gT(a,c,a.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(d=Ra(dh.current),Ra($r.current),Kf(c)){if(m=c.stateNode,d=c.memoizedProps,m[Wr]=c,(x=m.nodeValue!==d)&&(a=mi,a!==null))switch(a.tag){case 3:Vf(m.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Vf(m.nodeValue,d,(a.mode&1)!==0)}x&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[Wr]=c,c.stateNode=m}return Pn(c),null;case 13:if(wt(At),m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(It&&yi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)yE(),lc(),c.flags|=98560,x=!1;else if(x=Kf(c),m!==null&&m.dehydrated!==null){if(a===null){if(!x)throw Error(t(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[Wr]=c}else lc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Pn(c),x=!1}else rr!==null&&(P_(rr),rr=null),x=!0;if(!x)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(At.current&1)!==0?Yt===0&&(Yt=3):D_())),c.updateQueue!==null&&(c.flags|=4),Pn(c),null);case 4:return dc(),__(a,c),a===null&&sh(c.stateNode.containerInfo),Pn(c),null;case 10:return Ky(c.type._context),Pn(c),null;case 17:return qn(c.type)&&zf(),Pn(c),null;case 19:if(wt(At),x=c.memoizedState,x===null)return Pn(c),null;if(m=(c.flags&128)!==0,A=x.rendering,A===null)if(m)yh(x,!1);else{if(Yt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(A=Qf(a),A!==null){for(c.flags|=128,yh(x,!1),m=A.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)x=d,a=m,x.flags&=14680066,A=x.alternate,A===null?(x.childLanes=0,x.lanes=a,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=A.childLanes,x.lanes=A.lanes,x.child=A.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=A.memoizedProps,x.memoizedState=A.memoizedState,x.updateQueue=A.updateQueue,x.type=A.type,a=A.dependencies,x.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return _t(At,At.current&1|2),c.child}a=a.sibling}x.tail!==null&&vt()>mc&&(c.flags|=128,m=!0,yh(x,!1),c.lanes=4194304)}else{if(!m)if(a=Qf(A),a!==null){if(c.flags|=128,m=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),yh(x,!0),x.tail===null&&x.tailMode==="hidden"&&!A.alternate&&!It)return Pn(c),null}else 2*vt()-x.renderingStartTime>mc&&d!==1073741824&&(c.flags|=128,m=!0,yh(x,!1),c.lanes=4194304);x.isBackwards?(A.sibling=c.child,c.child=A):(d=x.last,d!==null?d.sibling=A:c.child=A,x.last=A)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=vt(),c.sibling=null,d=At.current,_t(At,m?d&1|2:d&1),c):(Pn(c),null);case 22:case 23:return k_(),m=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(_i&1073741824)!==0&&(Pn(c),c.subtreeFlags&6&&(c.flags|=8192)):Pn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function mM(a,c){switch(Uy(c),c.tag){case 1:return qn(c.type)&&zf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return dc(),wt(Hn),wt(Rn),Jy(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return Zy(c),null;case 13:if(wt(At),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));lc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return wt(At),null;case 4:return dc(),null;case 10:return Ky(c.type._context),null;case 22:case 23:return k_(),null;case 24:return null;default:return null}}var ag=!1,bn=!1,yM=typeof WeakSet=="function"?WeakSet:Set,_e=null;function gc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){Nt(a,c,m)}else d.current=null}function v_(a,c,d){try{d()}catch(m){Nt(a,c,m)}}var pT=!1;function _M(a,c){if(ky=vs,a=Hw(),Ty(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var _=m.anchorOffset,x=m.focusNode;m=m.focusOffset;try{d.nodeType,x.nodeType}catch{d=null;break e}var A=0,U=-1,G=-1,J=0,ae=0,ce=a,se=null;t:for(;;){for(var ye;ce!==d||_!==0&&ce.nodeType!==3||(U=A+_),ce!==x||m!==0&&ce.nodeType!==3||(G=A+m),ce.nodeType===3&&(A+=ce.nodeValue.length),(ye=ce.firstChild)!==null;)se=ce,ce=ye;for(;;){if(ce===a)break t;if(se===d&&++J===_&&(U=A),se===x&&++ae===m&&(G=A),(ye=ce.nextSibling)!==null)break;ce=se,se=ce.parentNode}ce=ye}d=U===-1||G===-1?null:{start:U,end:G}}else d=null}d=d||{start:0,end:0}}else d=null;for(Dy={focusedElem:a,selectionRange:d},vs=!1,_e=c;_e!==null;)if(c=_e,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,_e=a;else for(;_e!==null;){c=_e;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var we=ve.memoizedProps,jt=ve.memoizedState,H=c.stateNode,K=H.getSnapshotBeforeUpdate(c.elementType===c.type?we:sr(c.type,we),jt);H.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var X=c.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Nt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,_e=a;break}_e=c.return}return ve=pT,pT=!1,ve}function _h(a,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var _=m=m.next;do{if((_.tag&a)===a){var x=_.destroy;_.destroy=void 0,x!==void 0&&v_(c,d,x)}_=_.next}while(_!==m)}}function lg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function x_(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function mT(a){var c=a.alternate;c!==null&&(a.alternate=null,mT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Wr],delete c[ah],delete c[Oy],delete c[eM],delete c[tM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function yT(a){return a.tag===5||a.tag===3||a.tag===4}function _T(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||yT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function w_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=jf));else if(m!==4&&(a=a.child,a!==null))for(w_(a,c,d),a=a.sibling;a!==null;)w_(a,c,d),a=a.sibling}function E_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(E_(a,c,d),a=a.sibling;a!==null;)E_(a,c,d),a=a.sibling}var _n=null,or=!1;function yo(a,c,d){for(d=d.child;d!==null;)vT(a,c,d),d=d.sibling}function vT(a,c,d){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(fa,d)}catch{}switch(d.tag){case 5:bn||gc(d,c);case 6:var m=_n,_=or;_n=null,yo(a,c,d),_n=m,or=_,_n!==null&&(or?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(or?(a=_n,d=d.stateNode,a.nodeType===8?Ly(a.parentNode,d):a.nodeType===1&&Ly(a,d),oo(a)):Ly(_n,d.stateNode));break;case 4:m=_n,_=or,_n=d.stateNode.containerInfo,or=!0,yo(a,c,d),_n=m,or=_;break;case 0:case 11:case 14:case 15:if(!bn&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){_=m=m.next;do{var x=_,A=x.destroy;x=x.tag,A!==void 0&&((x&2)!==0||(x&4)!==0)&&v_(d,c,A),_=_.next}while(_!==m)}yo(a,c,d);break;case 1:if(!bn&&(gc(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(U){Nt(d,c,U)}yo(a,c,d);break;case 21:yo(a,c,d);break;case 22:d.mode&1?(bn=(m=bn)||d.memoizedState!==null,yo(a,c,d),bn=m):yo(a,c,d);break;default:yo(a,c,d)}}function xT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new yM),c.forEach(function(m){var _=RM.bind(null,a,m);d.has(m)||(d.add(m),m.then(_,_))})}}function ar(a,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var _=d[m];try{var x=a,A=c,U=A;e:for(;U!==null;){switch(U.tag){case 5:_n=U.stateNode,or=!1;break e;case 3:_n=U.stateNode.containerInfo,or=!0;break e;case 4:_n=U.stateNode.containerInfo,or=!0;break e}U=U.return}if(_n===null)throw Error(t(160));vT(x,A,_),_n=null,or=!1;var G=_.alternate;G!==null&&(G.return=null),_.return=null}catch(J){Nt(_,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)wT(c,a),c=c.sibling}function wT(a,c){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ar(c,a),Hr(a),m&4){try{_h(3,a,a.return),lg(3,a)}catch(we){Nt(a,a.return,we)}try{_h(5,a,a.return)}catch(we){Nt(a,a.return,we)}}break;case 1:ar(c,a),Hr(a),m&512&&d!==null&&gc(d,d.return);break;case 5:if(ar(c,a),Hr(a),m&512&&d!==null&&gc(d,d.return),a.flags&32){var _=a.stateNode;try{Ar(_,"")}catch(we){Nt(a,a.return,we)}}if(m&4&&(_=a.stateNode,_!=null)){var x=a.memoizedProps,A=d!==null?d.memoizedProps:x,U=a.type,G=a.updateQueue;if(a.updateQueue=null,G!==null)try{U==="input"&&x.type==="radio"&&x.name!=null&&dn(_,x),gs(U,A);var J=gs(U,x);for(A=0;A<G.length;A+=2){var ae=G[A],ce=G[A+1];ae==="style"?fs(_,ce):ae==="dangerouslySetInnerHTML"?ca(_,ce):ae==="children"?Ar(_,ce):D(_,ae,ce,J)}switch(U){case"input":Kn(_,x);break;case"textarea":eo(_,x);break;case"select":var se=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!x.multiple;var ye=x.value;ye!=null?tn(_,!!x.multiple,ye,!1):se!==!!x.multiple&&(x.defaultValue!=null?tn(_,!!x.multiple,x.defaultValue,!0):tn(_,!!x.multiple,x.multiple?[]:"",!1))}_[ah]=x}catch(we){Nt(a,a.return,we)}}break;case 6:if(ar(c,a),Hr(a),m&4){if(a.stateNode===null)throw Error(t(162));_=a.stateNode,x=a.memoizedProps;try{_.nodeValue=x}catch(we){Nt(a,a.return,we)}}break;case 3:if(ar(c,a),Hr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{oo(c.containerInfo)}catch(we){Nt(a,a.return,we)}break;case 4:ar(c,a),Hr(a);break;case 13:ar(c,a),Hr(a),_=a.child,_.flags&8192&&(x=_.memoizedState!==null,_.stateNode.isHidden=x,!x||_.alternate!==null&&_.alternate.memoizedState!==null||(I_=vt())),m&4&&xT(a);break;case 22:if(ae=d!==null&&d.memoizedState!==null,a.mode&1?(bn=(J=bn)||ae,ar(c,a),bn=J):ar(c,a),Hr(a),m&8192){if(J=a.memoizedState!==null,(a.stateNode.isHidden=J)&&!ae&&(a.mode&1)!==0)for(_e=a,ae=a.child;ae!==null;){for(ce=_e=ae;_e!==null;){switch(se=_e,ye=se.child,se.tag){case 0:case 11:case 14:case 15:_h(4,se,se.return);break;case 1:gc(se,se.return);var ve=se.stateNode;if(typeof ve.componentWillUnmount=="function"){m=se,d=se.return;try{c=m,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(we){Nt(m,d,we)}}break;case 5:gc(se,se.return);break;case 22:if(se.memoizedState!==null){ST(ce);continue}}ye!==null?(ye.return=se,_e=ye):ST(ce)}ae=ae.sibling}e:for(ae=null,ce=a;;){if(ce.tag===5){if(ae===null){ae=ce;try{_=ce.stateNode,J?(x=_.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(U=ce.stateNode,G=ce.memoizedProps.style,A=G!=null&&G.hasOwnProperty("display")?G.display:null,U.style.display=Pr("display",A))}catch(we){Nt(a,a.return,we)}}}else if(ce.tag===6){if(ae===null)try{ce.stateNode.nodeValue=J?"":ce.memoizedProps}catch(we){Nt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;ae===ce&&(ae=null),ce=ce.return}ae===ce&&(ae=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:ar(c,a),Hr(a),m&4&&xT(a);break;case 21:break;default:ar(c,a),Hr(a)}}function Hr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(yT(d)){var m=d;break e}d=d.return}throw Error(t(160))}switch(m.tag){case 5:var _=m.stateNode;m.flags&32&&(Ar(_,""),m.flags&=-33);var x=_T(a);E_(a,x,_);break;case 3:case 4:var A=m.stateNode.containerInfo,U=_T(a);w_(a,U,A);break;default:throw Error(t(161))}}catch(G){Nt(a,a.return,G)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function vM(a,c,d){_e=a,ET(a)}function ET(a,c,d){for(var m=(a.mode&1)!==0;_e!==null;){var _=_e,x=_.child;if(_.tag===22&&m){var A=_.memoizedState!==null||ag;if(!A){var U=_.alternate,G=U!==null&&U.memoizedState!==null||bn;U=ag;var J=bn;if(ag=A,(bn=G)&&!J)for(_e=_;_e!==null;)A=_e,G=A.child,A.tag===22&&A.memoizedState!==null?IT(_):G!==null?(G.return=A,_e=G):IT(_);for(;x!==null;)_e=x,ET(x),x=x.sibling;_e=_,ag=U,bn=J}TT(a)}else(_.subtreeFlags&8772)!==0&&x!==null?(x.return=_,_e=x):TT(a)}}function TT(a){for(;_e!==null;){var c=_e;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:bn||lg(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!bn)if(d===null)m.componentDidMount();else{var _=c.elementType===c.type?d.memoizedProps:sr(c.type,d.memoizedProps);m.componentDidUpdate(_,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var x=c.updateQueue;x!==null&&SE(c,x,m);break;case 3:var A=c.updateQueue;if(A!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}SE(c,A,d)}break;case 5:var U=c.stateNode;if(d===null&&c.flags&4){d=U;var G=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":G.autoFocus&&d.focus();break;case"img":G.src&&(d.src=G.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var ae=J.memoizedState;if(ae!==null){var ce=ae.dehydrated;ce!==null&&oo(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}bn||c.flags&512&&x_(c)}catch(se){Nt(c,c.return,se)}}if(c===a){_e=null;break}if(d=c.sibling,d!==null){d.return=c.return,_e=d;break}_e=c.return}}function ST(a){for(;_e!==null;){var c=_e;if(c===a){_e=null;break}var d=c.sibling;if(d!==null){d.return=c.return,_e=d;break}_e=c.return}}function IT(a){for(;_e!==null;){var c=_e;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{lg(4,c)}catch(G){Nt(c,d,G)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var _=c.return;try{m.componentDidMount()}catch(G){Nt(c,_,G)}}var x=c.return;try{x_(c)}catch(G){Nt(c,x,G)}break;case 5:var A=c.return;try{x_(c)}catch(G){Nt(c,A,G)}}}catch(G){Nt(c,c.return,G)}if(c===a){_e=null;break}var U=c.sibling;if(U!==null){U.return=c.return,_e=U;break}_e=c.return}}var xM=Math.ceil,cg=L.ReactCurrentDispatcher,T_=L.ReactCurrentOwner,ji=L.ReactCurrentBatchConfig,Qe=0,sn=null,Wt=null,vn=0,_i=0,pc=ho(0),Yt=0,vh=null,Pa=0,ug=0,S_=0,xh=null,Yn=null,I_=0,mc=1/0,Ps=null,hg=!1,C_=null,_o=null,dg=!1,vo=null,fg=0,wh=0,R_=null,gg=-1,pg=0;function Un(){return(Qe&6)!==0?vt():gg!==-1?gg:gg=vt()}function xo(a){return(a.mode&1)===0?1:(Qe&2)!==0&&vn!==0?vn&-vn:iM.transition!==null?(pg===0&&(pg=Bu()),pg):(a=He,a!==0||(a=window.event,a=a===void 0?16:$l(a.type)),a)}function lr(a,c,d,m){if(50<wh)throw wh=0,R_=null,Error(t(185));ya(a,d,m),((Qe&2)===0||a!==sn)&&(a===sn&&((Qe&2)===0&&(ug|=d),Yt===4&&wo(a,vn)),Zn(a,m),d===1&&Qe===0&&(c.mode&1)===0&&(mc=vt()+500,Gf&&go()))}function Zn(a,c){var d=a.callbackNode;ma(a,c);var m=ms(a,a===sn?vn:0);if(m===0)d!==null&&Vl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=m&-m,a.callbackPriority!==c){if(d!=null&&Vl(d),c===1)a.tag===0?nM(RT.bind(null,a)):dE(RT.bind(null,a)),QN(function(){(Qe&6)===0&&go()}),d=null;else{switch(Mr(m)){case 1:d=jl;break;case 4:d=ju;break;case 16:d=da;break;case 536870912:d=Ul;break;default:d=da}d=LT(d,CT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function CT(a,c){if(gg=-1,pg=0,(Qe&6)!==0)throw Error(t(327));var d=a.callbackNode;if(yc()&&a.callbackNode!==d)return null;var m=ms(a,a===sn?vn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||c)c=mg(a,m);else{c=m;var _=Qe;Qe|=2;var x=PT();(sn!==a||vn!==c)&&(Ps=null,mc=vt()+500,ka(a,c));do try{TM();break}catch(U){AT(a,U)}while(!0);$y(),cg.current=x,Qe=_,Wt!==null?c=0:(sn=null,vn=0,c=Yt)}if(c!==0){if(c===2&&(_=zu(a),_!==0&&(m=_,c=A_(a,_))),c===1)throw d=vh,ka(a,0),wo(a,m),Zn(a,vt()),d;if(c===6)wo(a,m);else{if(_=a.current.alternate,(m&30)===0&&!wM(_)&&(c=mg(a,m),c===2&&(x=zu(a),x!==0&&(m=x,c=A_(a,x))),c===1))throw d=vh,ka(a,0),wo(a,m),Zn(a,vt()),d;switch(a.finishedWork=_,a.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:Da(a,Yn,Ps);break;case 3:if(wo(a,m),(m&130023424)===m&&(c=I_+500-vt(),10<c)){if(ms(a,0)!==0)break;if(_=a.suspendedLanes,(_&m)!==m){Un(),a.pingedLanes|=a.suspendedLanes&_;break}a.timeoutHandle=My(Da.bind(null,a,Yn,Ps),c);break}Da(a,Yn,Ps);break;case 4:if(wo(a,m),(m&4194240)===m)break;for(c=a.eventTimes,_=-1;0<m;){var A=31-hi(m);x=1<<A,A=c[A],A>_&&(_=A),m&=~x}if(m=_,m=vt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*xM(m/1960))-m,10<m){a.timeoutHandle=My(Da.bind(null,a,Yn,Ps),m);break}Da(a,Yn,Ps);break;case 5:Da(a,Yn,Ps);break;default:throw Error(t(329))}}}return Zn(a,vt()),a.callbackNode===d?CT.bind(null,a):null}function A_(a,c){var d=xh;return a.current.memoizedState.isDehydrated&&(ka(a,c).flags|=256),a=mg(a,c),a!==2&&(c=Yn,Yn=d,c!==null&&P_(c)),a}function P_(a){Yn===null?Yn=a:Yn.push.apply(Yn,a)}function wM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var _=d[m],x=_.getSnapshot;_=_.value;try{if(!ir(x(),_))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function wo(a,c){for(c&=~S_,c&=~ug,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-hi(c),m=1<<d;a[d]=-1,c&=~m}}function RT(a){if((Qe&6)!==0)throw Error(t(327));yc();var c=ms(a,0);if((c&1)===0)return Zn(a,vt()),null;var d=mg(a,c);if(a.tag!==0&&d===2){var m=zu(a);m!==0&&(c=m,d=A_(a,m))}if(d===1)throw d=vh,ka(a,0),wo(a,c),Zn(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Da(a,Yn,Ps),Zn(a,vt()),null}function b_(a,c){var d=Qe;Qe|=1;try{return a(c)}finally{Qe=d,Qe===0&&(mc=vt()+500,Gf&&go())}}function ba(a){vo!==null&&vo.tag===0&&(Qe&6)===0&&yc();var c=Qe;Qe|=1;var d=ji.transition,m=He;try{if(ji.transition=null,He=1,a)return a()}finally{He=m,ji.transition=d,Qe=c,(Qe&6)===0&&go()}}function k_(){_i=pc.current,wt(pc)}function ka(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,ZN(d)),Wt!==null)for(d=Wt.return;d!==null;){var m=d;switch(Uy(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&zf();break;case 3:dc(),wt(Hn),wt(Rn),Jy();break;case 5:Zy(m);break;case 4:dc();break;case 13:wt(At);break;case 19:wt(At);break;case 10:Ky(m.type._context);break;case 22:case 23:k_()}d=d.return}if(sn=a,Wt=a=Eo(a.current,null),vn=_i=c,Yt=0,vh=null,S_=ug=Pa=0,Yn=xh=null,Ca!==null){for(c=0;c<Ca.length;c++)if(d=Ca[c],m=d.interleaved,m!==null){d.interleaved=null;var _=m.next,x=d.pending;if(x!==null){var A=x.next;x.next=_,m.next=A}d.pending=m}Ca=null}return a}function AT(a,c){do{var d=Wt;try{if($y(),Jf.current=ig,eg){for(var m=Pt.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}eg=!1}if(Aa=0,rn=Xt=Pt=null,fh=!1,gh=0,T_.current=null,d===null||d.return===null){Yt=1,vh=c,Wt=null;break}e:{var x=a,A=d.return,U=d,G=c;if(c=vn,U.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var J=G,ae=U,ce=ae.tag;if((ae.mode&1)===0&&(ce===0||ce===11||ce===15)){var se=ae.alternate;se?(ae.updateQueue=se.updateQueue,ae.memoizedState=se.memoizedState,ae.lanes=se.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var ye=JE(A);if(ye!==null){ye.flags&=-257,eT(ye,A,U,x,c),ye.mode&1&&QE(x,J,c),c=ye,G=J;var ve=c.updateQueue;if(ve===null){var we=new Set;we.add(G),c.updateQueue=we}else ve.add(G);break e}else{if((c&1)===0){QE(x,J,c),D_();break e}G=Error(t(426))}}else if(It&&U.mode&1){var jt=JE(A);if(jt!==null){(jt.flags&65536)===0&&(jt.flags|=256),eT(jt,A,U,x,c),Gy(fc(G,U));break e}}x=G=fc(G,U),Yt!==4&&(Yt=2),xh===null?xh=[x]:xh.push(x),x=A;do{switch(x.tag){case 3:x.flags|=65536,c&=-c,x.lanes|=c;var H=YE(x,G,c);TE(x,H);break e;case 1:U=G;var K=x.type,X=x.stateNode;if((x.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(_o===null||!_o.has(X)))){x.flags|=65536,c&=-c,x.lanes|=c;var he=ZE(x,U,c);TE(x,he);break e}}x=x.return}while(x!==null)}kT(d)}catch(Te){c=Te,Wt===d&&d!==null&&(Wt=d=d.return);continue}break}while(!0)}function PT(){var a=cg.current;return cg.current=ig,a===null?ig:a}function D_(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),sn===null||(Pa&268435455)===0&&(ug&268435455)===0||wo(sn,vn)}function mg(a,c){var d=Qe;Qe|=2;var m=PT();(sn!==a||vn!==c)&&(Ps=null,ka(a,c));do try{EM();break}catch(_){AT(a,_)}while(!0);if($y(),Qe=d,cg.current=m,Wt!==null)throw Error(t(261));return sn=null,vn=0,Yt}function EM(){for(;Wt!==null;)bT(Wt)}function TM(){for(;Wt!==null&&!ha();)bT(Wt)}function bT(a){var c=MT(a.alternate,a,_i);a.memoizedProps=a.pendingProps,c===null?kT(a):Wt=c,T_.current=null}function kT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=pM(d,c,_i),d!==null){Wt=d;return}}else{if(d=mM(d,c),d!==null){d.flags&=32767,Wt=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Yt=6,Wt=null;return}}if(c=c.sibling,c!==null){Wt=c;return}Wt=c=a}while(c!==null);Yt===0&&(Yt=5)}function Da(a,c,d){var m=He,_=ji.transition;try{ji.transition=null,He=1,SM(a,c,d,m)}finally{ji.transition=_,He=m}return null}function SM(a,c,d,m){do yc();while(vo!==null);if((Qe&6)!==0)throw Error(t(327));d=a.finishedWork;var _=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var x=d.lanes|d.childLanes;if(_y(a,x),a===sn&&(Wt=sn=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||dg||(dg=!0,LT(da,function(){return yc(),null})),x=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||x){x=ji.transition,ji.transition=null;var A=He;He=1;var U=Qe;Qe|=4,T_.current=null,_M(a,d),wT(d,a),WN(Dy),vs=!!ky,Dy=ky=null,a.current=d,vM(d),ps(),Qe=U,He=A,ji.transition=x}else a.current=d;if(dg&&(dg=!1,vo=a,fg=_),x=a.pendingLanes,x===0&&(_o=null),Tf(d.stateNode),Zn(a,vt()),c!==null)for(m=a.onRecoverableError,d=0;d<c.length;d++)_=c[d],m(_.value,{componentStack:_.stack,digest:_.digest});if(hg)throw hg=!1,a=C_,C_=null,a;return(fg&1)!==0&&a.tag!==0&&yc(),x=a.pendingLanes,(x&1)!==0?a===R_?wh++:(wh=0,R_=a):wh=0,go(),null}function yc(){if(vo!==null){var a=Mr(fg),c=ji.transition,d=He;try{if(ji.transition=null,He=16>a?16:a,vo===null)var m=!1;else{if(a=vo,vo=null,fg=0,(Qe&6)!==0)throw Error(t(331));var _=Qe;for(Qe|=4,_e=a.current;_e!==null;){var x=_e,A=x.child;if((_e.flags&16)!==0){var U=x.deletions;if(U!==null){for(var G=0;G<U.length;G++){var J=U[G];for(_e=J;_e!==null;){var ae=_e;switch(ae.tag){case 0:case 11:case 15:_h(8,ae,x)}var ce=ae.child;if(ce!==null)ce.return=ae,_e=ce;else for(;_e!==null;){ae=_e;var se=ae.sibling,ye=ae.return;if(mT(ae),ae===J){_e=null;break}if(se!==null){se.return=ye,_e=se;break}_e=ye}}}var ve=x.alternate;if(ve!==null){var we=ve.child;if(we!==null){ve.child=null;do{var jt=we.sibling;we.sibling=null,we=jt}while(we!==null)}}_e=x}}if((x.subtreeFlags&2064)!==0&&A!==null)A.return=x,_e=A;else e:for(;_e!==null;){if(x=_e,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:_h(9,x,x.return)}var H=x.sibling;if(H!==null){H.return=x.return,_e=H;break e}_e=x.return}}var K=a.current;for(_e=K;_e!==null;){A=_e;var X=A.child;if((A.subtreeFlags&2064)!==0&&X!==null)X.return=A,_e=X;else e:for(A=K;_e!==null;){if(U=_e,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:lg(9,U)}}catch(Te){Nt(U,U.return,Te)}if(U===A){_e=null;break e}var he=U.sibling;if(he!==null){he.return=U.return,_e=he;break e}_e=U.return}}if(Qe=_,go(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(fa,a)}catch{}m=!0}return m}finally{He=d,ji.transition=c}}return!1}function DT(a,c,d){c=fc(d,c),c=YE(a,c,1),a=mo(a,c,1),c=Un(),a!==null&&(ya(a,1,c),Zn(a,c))}function Nt(a,c,d){if(a.tag===3)DT(a,a,d);else for(;c!==null;){if(c.tag===3){DT(c,a,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(_o===null||!_o.has(m))){a=fc(d,a),a=ZE(c,a,1),c=mo(c,a,1),a=Un(),c!==null&&(ya(c,1,a),Zn(c,a));break}}c=c.return}}function IM(a,c,d){var m=a.pingCache;m!==null&&m.delete(c),c=Un(),a.pingedLanes|=a.suspendedLanes&d,sn===a&&(vn&d)===d&&(Yt===4||Yt===3&&(vn&130023424)===vn&&500>vt()-I_?ka(a,0):S_|=d),Zn(a,c)}function NT(a,c){c===0&&((a.mode&1)===0?c=1:(c=io,io<<=1,(io&130023424)===0&&(io=4194304)));var d=Un();a=Cs(a,c),a!==null&&(ya(a,c,d),Zn(a,d))}function CM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),NT(a,d)}function RM(a,c){var d=0;switch(a.tag){case 13:var m=a.stateNode,_=a.memoizedState;_!==null&&(d=_.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),NT(a,d)}var MT;MT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Hn.current)Xn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return Xn=!1,gM(a,c,d);Xn=(a.flags&131072)!==0}else Xn=!1,It&&(c.flags&1048576)!==0&&fE(c,$f,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;og(a,c),a=c.pendingProps;var _=sc(c,Rn.current);hc(c,d),_=n_(null,c,m,a,_,d);var x=i_();return c.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,qn(m)?(x=!0,Bf(c)):x=!1,c.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Xy(c),_.updater=rg,c.stateNode=_,_._reactInternals=c,c_(c,m,a,d),c=f_(null,c,m,!0,x,d)):(c.tag=0,It&&x&&jy(c),jn(null,c,_,d),c=c.child),c;case 16:m=c.elementType;e:{switch(og(a,c),a=c.pendingProps,_=m._init,m=_(m._payload),c.type=m,_=c.tag=PM(m),a=sr(m,a),_){case 0:c=d_(null,c,m,a,d);break e;case 1:c=oT(null,c,m,a,d);break e;case 11:c=tT(null,c,m,a,d);break e;case 14:c=nT(null,c,m,sr(m.type,a),d);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),d_(a,c,m,_,d);case 1:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),oT(a,c,m,_,d);case 3:e:{if(aT(c),a===null)throw Error(t(387));m=c.pendingProps,x=c.memoizedState,_=x.element,EE(a,c),Zf(c,m,null,d);var A=c.memoizedState;if(m=A.element,x.isDehydrated)if(x={element:m,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},c.updateQueue.baseState=x,c.memoizedState=x,c.flags&256){_=fc(Error(t(423)),c),c=lT(a,c,m,d,_);break e}else if(m!==_){_=fc(Error(t(424)),c),c=lT(a,c,m,d,_);break e}else for(yi=uo(c.stateNode.containerInfo.firstChild),mi=c,It=!0,rr=null,d=xE(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(lc(),m===_){c=As(a,c,d);break e}jn(a,c,m,d)}c=c.child}return c;case 5:return IE(c),a===null&&By(c),m=c.type,_=c.pendingProps,x=a!==null?a.memoizedProps:null,A=_.children,Ny(m,_)?A=null:x!==null&&Ny(m,x)&&(c.flags|=32),sT(a,c),jn(a,c,A,d),c.child;case 6:return a===null&&By(c),null;case 13:return cT(a,c,d);case 4:return Yy(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=cc(c,null,m,d):jn(a,c,m,d),c.child;case 11:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),tT(a,c,m,_,d);case 7:return jn(a,c,c.pendingProps,d),c.child;case 8:return jn(a,c,c.pendingProps.children,d),c.child;case 12:return jn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,_=c.pendingProps,x=c.memoizedProps,A=_.value,_t(qf,m._currentValue),m._currentValue=A,x!==null)if(ir(x.value,A)){if(x.children===_.children&&!Hn.current){c=As(a,c,d);break e}}else for(x=c.child,x!==null&&(x.return=c);x!==null;){var U=x.dependencies;if(U!==null){A=x.child;for(var G=U.firstContext;G!==null;){if(G.context===m){if(x.tag===1){G=Rs(-1,d&-d),G.tag=2;var J=x.updateQueue;if(J!==null){J=J.shared;var ae=J.pending;ae===null?G.next=G:(G.next=ae.next,ae.next=G),J.pending=G}}x.lanes|=d,G=x.alternate,G!==null&&(G.lanes|=d),Hy(x.return,d,c),U.lanes|=d;break}G=G.next}}else if(x.tag===10)A=x.type===c.type?null:x.child;else if(x.tag===18){if(A=x.return,A===null)throw Error(t(341));A.lanes|=d,U=A.alternate,U!==null&&(U.lanes|=d),Hy(A,d,c),A=x.sibling}else A=x.child;if(A!==null)A.return=x;else for(A=x;A!==null;){if(A===c){A=null;break}if(x=A.sibling,x!==null){x.return=A.return,A=x;break}A=A.return}x=A}jn(a,c,_.children,d),c=c.child}return c;case 9:return _=c.type,m=c.pendingProps.children,hc(c,d),_=Fi(_),m=m(_),c.flags|=1,jn(a,c,m,d),c.child;case 14:return m=c.type,_=sr(m,c.pendingProps),_=sr(m.type,_),nT(a,c,m,_,d);case 15:return iT(a,c,c.type,c.pendingProps,d);case 17:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),og(a,c),c.tag=1,qn(m)?(a=!0,Bf(c)):a=!1,hc(c,d),qE(c,m,_),c_(c,m,_,d),f_(null,c,m,!0,a,d);case 19:return hT(a,c,d);case 22:return rT(a,c,d)}throw Error(t(156,c.tag))};function LT(a,c){return Vu(a,c)}function AM(a,c,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(a,c,d,m){return new AM(a,c,d,m)}function N_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function PM(a){if(typeof a=="function")return N_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===z)return 11;if(a===pe)return 14}return 2}function Eo(a,c){var d=a.alternate;return d===null?(d=Ui(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function yg(a,c,d,m,_,x){var A=2;if(m=a,typeof a=="function")N_(a)&&(A=1);else if(typeof a=="string")A=5;else e:switch(a){case b:return Na(d.children,_,x,c);case R:A=8,_|=8;break;case M:return a=Ui(12,d,c,_|2),a.elementType=M,a.lanes=x,a;case k:return a=Ui(13,d,c,_),a.elementType=k,a.lanes=x,a;case re:return a=Ui(19,d,c,_),a.elementType=re,a.lanes=x,a;case ue:return _g(d,_,x,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:A=10;break e;case j:A=9;break e;case z:A=11;break e;case pe:A=14;break e;case ge:A=16,m=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Ui(A,d,c,_),c.elementType=a,c.type=m,c.lanes=x,c}function Na(a,c,d,m){return a=Ui(7,a,m,c),a.lanes=d,a}function _g(a,c,d,m){return a=Ui(22,a,m,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function M_(a,c,d){return a=Ui(6,a,null,c),a.lanes=d,a}function L_(a,c,d){return c=Ui(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function bM(a,c,d,m,_){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=m,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function O_(a,c,d,m,_,x,A,U,G){return a=new bM(a,c,d,U,G),c===1?(c=1,x===!0&&(c|=8)):c=0,x=Ui(3,null,null,c),a.current=x,x.stateNode=a,x.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xy(x),a}function kM(a,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:m==null?null:""+m,children:a,containerInfo:c,implementation:d}}function OT(a){if(!a)return fo;a=a._reactInternals;e:{if(tr(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(qn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(qn(d))return uE(a,d,c)}return c}function FT(a,c,d,m,_,x,A,U,G){return a=O_(d,m,!0,a,_,x,A,U,G),a.context=OT(null),d=a.current,m=Un(),_=xo(d),x=Rs(m,_),x.callback=c??null,mo(d,x,_),a.current.lanes=_,ya(a,_,m),Zn(a,m),a}function vg(a,c,d,m){var _=c.current,x=Un(),A=xo(_);return d=OT(d),c.context===null?c.context=d:c.pendingContext=d,c=Rs(x,A),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=mo(_,c,A),a!==null&&(lr(a,_,A,x),Yf(a,_,A)),A}function xg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function VT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function F_(a,c){VT(a,c),(a=a.alternate)&&VT(a,c)}function DM(){return null}var jT=typeof reportError=="function"?reportError:function(a){console.error(a)};function V_(a){this._internalRoot=a}wg.prototype.render=V_.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));vg(a,c,null,null)},wg.prototype.unmount=V_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;ba(function(){vg(null,a,null,null)}),c[Es]=null}};function wg(a){this._internalRoot=a}wg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Hu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<di.length&&c!==0&&c<di[d].priority;d++);di.splice(d,0,a),d===0&&Gl(a)}};function j_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Eg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function UT(){}function NM(a,c,d,m,_){if(_){if(typeof m=="function"){var x=m;m=function(){var J=xg(A);x.call(J)}}var A=FT(c,m,a,0,null,!1,!1,"",UT);return a._reactRootContainer=A,a[Es]=A.current,sh(a.nodeType===8?a.parentNode:a),ba(),A}for(;_=a.lastChild;)a.removeChild(_);if(typeof m=="function"){var U=m;m=function(){var J=xg(G);U.call(J)}}var G=O_(a,0,!1,null,null,!1,!1,"",UT);return a._reactRootContainer=G,a[Es]=G.current,sh(a.nodeType===8?a.parentNode:a),ba(function(){vg(c,G,d,m)}),G}function Tg(a,c,d,m,_){var x=d._reactRootContainer;if(x){var A=x;if(typeof _=="function"){var U=_;_=function(){var G=xg(A);U.call(G)}}vg(c,A,a,_)}else A=NM(d,c,a,_,m);return xg(A)}$u=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=st(c.pendingLanes);d!==0&&(Wu(c,d|1),Zn(c,vt()),(Qe&6)===0&&(mc=vt()+500,go()))}break;case 13:ba(function(){var m=Cs(a,1);if(m!==null){var _=Un();lr(m,a,1,_)}}),F_(a,1)}},zl=function(a){if(a.tag===13){var c=Cs(a,134217728);if(c!==null){var d=Un();lr(c,a,134217728,d)}F_(a,134217728)}},Ku=function(a){if(a.tag===13){var c=xo(a),d=Cs(a,c);if(d!==null){var m=Un();lr(d,a,c,m)}F_(a,c)}},Hu=function(){return He},qu=function(a,c){var d=He;try{return He=a,c()}finally{He=d}},Fn=function(a,c,d){switch(c){case"input":if(Kn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==a&&m.form===a.form){var _=Uf(m);if(!_)throw Error(t(90));ds(m),Kn(m,_)}}}break;case"textarea":eo(a,d);break;case"select":c=d.value,c!=null&&tn(a,!!d.multiple,c,!1)}},ki=b_,fn=ba;var MM={usingClientEntryPoint:!1,Events:[lh,ic,Uf,er,Ot,b_]},Eh={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LM={bundleType:Eh.bundleType,version:Eh.version,rendererPackageName:Eh.rendererPackageName,rendererConfig:Eh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Ef(a),a===null?null:a.stateNode},findFiberByHostInstance:Eh.findFiberByHostInstance||DM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sg.isDisabled&&Sg.supportsFiber)try{fa=Sg.inject(LM),ui=Sg}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MM,Qn.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j_(c))throw Error(t(200));return kM(a,c,null,d)},Qn.createRoot=function(a,c){if(!j_(a))throw Error(t(299));var d=!1,m="",_=jT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(_=c.onRecoverableError)),c=O_(a,1,!1,null,null,d,!1,m,_),a[Es]=c.current,sh(a.nodeType===8?a.parentNode:a),new V_(c)},Qn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Ef(c),a=a===null?null:a.stateNode,a},Qn.flushSync=function(a){return ba(a)},Qn.hydrate=function(a,c,d){if(!Eg(c))throw Error(t(200));return Tg(null,a,c,!0,d)},Qn.hydrateRoot=function(a,c,d){if(!j_(a))throw Error(t(405));var m=d!=null&&d.hydratedSources||null,_=!1,x="",A=jT;if(d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),c=FT(c,null,a,1,d??null,_,!1,x,A),a[Es]=c.current,sh(a),m)for(a=0;a<m.length;a++)d=m[a],_=d._getVersion,_=_(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,_]:c.mutableSourceEagerHydrationData.push(d,_);return new wg(c)},Qn.render=function(a,c,d){if(!Eg(c))throw Error(t(200));return Tg(null,a,c,!1,d)},Qn.unmountComponentAtNode=function(a){if(!Eg(a))throw Error(t(40));return a._reactRootContainer?(ba(function(){Tg(null,null,a,!1,function(){a._reactRootContainer=null,a[Es]=null})}),!0):!1},Qn.unstable_batchedUpdates=b_,Qn.unstable_renderSubtreeIntoContainer=function(a,c,d,m){if(!Eg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Tg(a,c,d,!1,m)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var qT;function GM(){if(qT)return B_.exports;qT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),B_.exports=BM(),B_.exports}var XT;function WM(){if(XT)return Ig;XT=1;var n=GM();return Ig.createRoot=n.createRoot,Ig.hydrateRoot=n.hydrateRoot,Ig}var $M=WM();const KM=w1($M);var Z=$d();const HM=w1(Z),E1=Z.createContext({});function T1(n){const e=Z.useRef(null);return e.current===null&&(e.current=n()),e.current}const _m=Z.createContext(null),S1=Z.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class qM extends Z.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function XM({children:n,isPresent:e}){const t=Z.useId(),i=Z.useRef(null),r=Z.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=Z.useContext(S1);return Z.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),v.jsx(qM,{isPresent:e,childRef:i,sizeRef:r,children:Z.cloneElement(n,{ref:i})})}const YM=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=T1(ZM),u=Z.useId(),h=Z.useCallback(p=>{l.set(p,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=Z.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return Z.useMemo(()=>{l.forEach((p,y)=>l.set(y,!1))},[t]),Z.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=v.jsx(XM,{isPresent:t,children:n})),v.jsx(_m.Provider,{value:f,children:n})};function ZM(){return new Map}function DA(n=!0){const e=Z.useContext(_m);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=Z.useId();Z.useEffect(()=>{n&&r(s)},[n]);const o=Z.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Cg=n=>n.key||"";function YT(n){const e=[];return Z.Children.forEach(n,t=>{Z.isValidElement(t)&&e.push(t)}),e}const I1=typeof window<"u",NA=I1?Z.useLayoutEffect:Z.useEffect,ls=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=DA(o),h=Z.useMemo(()=>YT(n),[n]),f=o&&!l?[]:h.map(Cg),p=Z.useRef(!0),y=Z.useRef(h),E=T1(()=>new Map),[T,I]=Z.useState(h),[S,P]=Z.useState(h);NA(()=>{p.current=!1,y.current=h;for(let L=0;L<S.length;L++){const F=Cg(S[L]);f.includes(F)?E.delete(F):E.get(F)!==!0&&E.set(F,!1)}},[S,f.length,f.join("-")]);const N=[];if(h!==T){let L=[...h];for(let F=0;F<S.length;F++){const B=S[F],b=Cg(B);f.includes(b)||(L.splice(F,0,B),N.push(B))}s==="wait"&&N.length&&(L=N),P(YT(L)),I(h);return}const{forceRender:D}=Z.useContext(E1);return v.jsx(v.Fragment,{children:S.map(L=>{const F=Cg(L),B=o&&!l?!1:h===S||f.includes(F),b=()=>{if(E.has(F))E.set(F,!0);else return;let R=!0;E.forEach(M=>{M||(R=!1)}),R&&(D?.(),P(y.current),o&&u?.(),i&&i())};return v.jsx(YM,{isPresent:B,initial:!p.current||t?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:B?void 0:b,children:L},F)})})},Ti=n=>n;let MA=Ti;function C1(n){let e;return()=>(e===void 0&&(e=n()),e)}const tu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},js=n=>n*1e3,Us=n=>n/1e3,QM={useManualTiming:!1};function JM(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const E=p&&i?e:t;return f&&s.add(h),E.has(h)||E.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Rg=["read","resolveKeyframes","update","preRender","render","postRender"],eL=40;function LA(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Rg.reduce((P,N)=>(P[N]=JM(s),P),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:y}=o,E=()=>{const P=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(P-r.timestamp,eL),1),r.timestamp=P,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(E))},T=()=>{t=!0,i=!0,r.isProcessing||n(E)};return{schedule:Rg.reduce((P,N)=>{const D=o[N];return P[N]=(L,F=!1,B=!1)=>(t||T(),D.schedule(L,F,B)),P},{}),cancel:P=>{for(let N=0;N<Rg.length;N++)o[Rg[N]].cancel(P)},state:r,steps:o}}const{schedule:Et,cancel:Qo,state:xn,steps:$_}=LA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ti,!0),OA=Z.createContext({strict:!1}),ZT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},nu={};for(const n in ZT)nu[n]={isEnabled:e=>ZT[n].some(t=>!!e[t])};function tL(n){for(const e in n)nu[e]={...nu[e],...n[e]}}const nL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function xp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||nL.has(n)}let FA=n=>!xp(n);function iL(n){n&&(FA=e=>e.startsWith("on")?!xp(e):n(e))}try{iL(require("@emotion/is-prop-valid").default)}catch{}function rL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(FA(r)||t===!0&&xp(r)||!e&&!xp(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function sL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const vm=Z.createContext({});function dd(n){return typeof n=="string"||Array.isArray(n)}function xm(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const R1=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],A1=["initial",...R1];function wm(n){return xm(n.animate)||A1.some(e=>dd(n[e]))}function VA(n){return!!(wm(n)||n.variants)}function oL(n,e){if(wm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||dd(t)?t:void 0,animate:dd(i)?i:void 0}}return n.inherit!==!1?e:{}}function aL(n){const{initial:e,animate:t}=oL(n,Z.useContext(vm));return Z.useMemo(()=>({initial:e,animate:t}),[QT(e),QT(t)])}function QT(n){return Array.isArray(n)?n.join(" "):n}const lL=Symbol.for("motionComponentSymbol");function jc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function cL(n,e,t){return Z.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):jc(t)&&(t.current=i))},[e])}const P1=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),uL="framerAppearId",jA="data-"+P1(uL),{schedule:b1}=LA(queueMicrotask,!1),UA=Z.createContext({});function hL(n,e,t,i,r){var s,o;const{visualElement:l}=Z.useContext(vm),u=Z.useContext(OA),h=Z.useContext(_m),f=Z.useContext(S1).reducedMotion,p=Z.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=p.current,E=Z.useContext(UA);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&dL(p.current,t,r,E);const T=Z.useRef(!1);Z.useInsertionEffect(()=>{y&&T.current&&y.update(t,h)});const I=t[jA],S=Z.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return NA(()=>{y&&(T.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),b1.render(y.render),S.current&&y.animationState&&y.animationState.animateChanges())}),Z.useEffect(()=>{y&&(!S.current&&y.animationState&&y.animationState.animateChanges(),S.current&&(queueMicrotask(()=>{var P;(P=window.MotionHandoffMarkAsComplete)===null||P===void 0||P.call(window,I)}),S.current=!1))}),y}function dL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:zA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&jc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function zA(n){if(n)return n.options.allowProjection!==!1?n.projection:zA(n.parent)}function fL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&tL(n);function l(h,f){let p;const y={...Z.useContext(S1),...h,layoutId:gL(h)},{isStatic:E}=y,T=aL(h),I=i(h,E);if(!E&&I1){pL();const S=mL(y);p=S.MeasureLayout,T.visualElement=hL(r,I,y,e,S.ProjectionNode)}return v.jsxs(vm.Provider,{value:T,children:[p&&T.visualElement?v.jsx(p,{visualElement:T.visualElement,...y}):null,t(r,h,cL(I,T.visualElement,f),I,E,T.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=Z.forwardRef(l);return u[lL]=r,u}function gL({layoutId:n}){const e=Z.useContext(E1).id;return e&&n!==void 0?e+"-"+n:n}function pL(n,e){Z.useContext(OA).strict}function mL(n){const{drag:e,layout:t}=nu;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const yL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function k1(n){return typeof n!="string"||n.includes("-")?!1:!!(yL.indexOf(n)>-1||/[A-Z]/u.test(n))}function JT(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function D1(n,e,t,i){if(typeof e=="function"){const[r,s]=JT(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=JT(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const ev=n=>Array.isArray(n),_L=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),vL=n=>ev(n)?n[n.length-1]||0:n,Ln=n=>!!(n&&n.getVelocity);function tp(n){const e=Ln(n)?n.get():n;return _L(e)?e.toValue():e}function xL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:wL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const BA=n=>(e,t)=>{const i=Z.useContext(vm),r=Z.useContext(_m),s=()=>xL(n,e,i,r);return t?s():T1(s)};function wL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=tp(s[y]);let{initial:o,animate:l}=n;const u=wm(n),h=VA(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!xm(p)){const y=Array.isArray(p)?p:[p];for(let E=0;E<y.length;E++){const T=D1(n,y[E]);if(T){const{transitionEnd:I,transition:S,...P}=T;for(const N in P){let D=P[N];if(Array.isArray(D)){const L=f?D.length-1:0;D=D[L]}D!==null&&(r[N]=D)}for(const N in I)r[N]=I[N]}}}return r}const Au=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pl=new Set(Au),GA=n=>e=>typeof e=="string"&&e.startsWith(n),WA=GA("--"),EL=GA("var(--"),N1=n=>EL(n)?TL.test(n.split("/*")[0].trim()):!1,TL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,$A=(n,e)=>e&&typeof n=="number"?e.transform(n):n,$s=(n,e,t)=>t>e?e:t<n?n:t,Pu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},fd={...Pu,transform:n=>$s(0,1,n)},Ag={...Pu,default:1},Kd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Mo=Kd("deg"),ts=Kd("%"),ke=Kd("px"),SL=Kd("vh"),IL=Kd("vw"),eS={...ts,parse:n=>ts.parse(n)/100,transform:n=>ts.transform(n*100)},CL={borderWidth:ke,borderTopWidth:ke,borderRightWidth:ke,borderBottomWidth:ke,borderLeftWidth:ke,borderRadius:ke,radius:ke,borderTopLeftRadius:ke,borderTopRightRadius:ke,borderBottomRightRadius:ke,borderBottomLeftRadius:ke,width:ke,maxWidth:ke,height:ke,maxHeight:ke,top:ke,right:ke,bottom:ke,left:ke,padding:ke,paddingTop:ke,paddingRight:ke,paddingBottom:ke,paddingLeft:ke,margin:ke,marginTop:ke,marginRight:ke,marginBottom:ke,marginLeft:ke,backgroundPositionX:ke,backgroundPositionY:ke},RL={rotate:Mo,rotateX:Mo,rotateY:Mo,rotateZ:Mo,scale:Ag,scaleX:Ag,scaleY:Ag,scaleZ:Ag,skew:Mo,skewX:Mo,skewY:Mo,distance:ke,translateX:ke,translateY:ke,translateZ:ke,x:ke,y:ke,z:ke,perspective:ke,transformPerspective:ke,opacity:fd,originX:eS,originY:eS,originZ:ke},tS={...Pu,transform:Math.round},M1={...CL,...RL,zIndex:tS,size:ke,fillOpacity:fd,strokeOpacity:fd,numOctaves:tS},AL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},PL=Au.length;function bL(n,e,t){let i="",r=!0;for(let s=0;s<PL;s++){const o=Au[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=$A(l,M1[o]);if(!u){r=!1;const f=AL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function L1(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Pl.has(u)){o=!0;continue}else if(WA(u)){r[u]=h;continue}else{const f=$A(h,M1[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=bL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const kL={offset:"stroke-dashoffset",array:"stroke-dasharray"},DL={offset:"strokeDashoffset",array:"strokeDasharray"};function NL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?kL:DL;n[s.offset]=ke.transform(-i);const o=ke.transform(e),l=ke.transform(t);n[s.array]=`${o} ${l}`}function nS(n,e,t){return typeof n=="string"?n:ke.transform(e+t*n)}function ML(n,e,t){const i=nS(e,n.x,n.width),r=nS(t,n.y,n.height);return`${i} ${r}`}function O1(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if(L1(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:E,dimensions:T}=n;y.transform&&(T&&(E.transform=y.transform),delete y.transform),T&&(r!==void 0||s!==void 0||E.transform)&&(E.transformOrigin=ML(T,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&NL(y,o,l,u,!1)}const F1=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),KA=()=>({...F1(),attrs:{}}),V1=n=>typeof n=="string"&&n.toLowerCase()==="svg";function HA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const qA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function XA(n,e,t,i){HA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(qA.has(r)?r:P1(r),e.attrs[r])}const wp={};function LL(n){Object.assign(wp,n)}function YA(n,{layout:e,layoutId:t}){return Pl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!wp[n]||n==="opacity")}function j1(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Ln(r[o])||e.style&&Ln(e.style[o])||YA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function ZA(n,e,t){const i=j1(n,e,t);for(const r in n)if(Ln(n[r])||Ln(e[r])){const s=Au.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function OL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const iS=["x","y","width","height","cx","cy","r"],FL={useVisualState:BA({scrapeMotionValuesFromProps:ZA,createRenderState:KA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Pl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<iS.length;l++){const u=iS[l];n[u]!==e[u]&&(o=!0)}o&&Et.read(()=>{OL(t,i),Et.render(()=>{O1(i,r,V1(t.tagName),n.transformTemplate),XA(t,i)})})}})},VL={useVisualState:BA({scrapeMotionValuesFromProps:j1,createRenderState:F1})};function QA(n,e,t){for(const i in e)!Ln(e[i])&&!YA(i,t)&&(n[i]=e[i])}function jL({transformTemplate:n},e){return Z.useMemo(()=>{const t=F1();return L1(t,e,n),Object.assign({},t.vars,t.style)},[e])}function UL(n,e){const t=n.style||{},i={};return QA(i,t,n),Object.assign(i,jL(n,e)),i}function zL(n,e){const t={},i=UL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function BL(n,e,t,i){const r=Z.useMemo(()=>{const s=KA();return O1(s,e,V1(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};QA(s,n.style,n),r.style={...s,...r.style}}return r}function GL(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(k1(t)?BL:zL)(i,s,o,t),h=rL(i,typeof t=="string",n),f=t!==Z.Fragment?{...h,...u,ref:r}:{},{children:p}=i,y=Z.useMemo(()=>Ln(p)?p.get():p,[p]);return Z.createElement(t,{...f,children:y})}}function WL(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...k1(i)?FL:VL,preloadedFeatures:n,useRender:GL(r),createVisualElement:e,Component:i};return fL(o)}}function JA(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Em(n,e,t){const i=n.getProps();return D1(i,e,t!==void 0?t:i.custom,n)}const $L=C1(()=>window.ScrollTimeline!==void 0);class KL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if($L()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class HL extends KL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function U1(n,e){return n?n[e]||n.default||n:void 0}const tv=2e4;function e2(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<tv;)e+=t,i=n.next(e);return e>=tv?1/0:e}function z1(n){return typeof n=="function"}function rS(n,e){n.timeline=e,n.onfinish=null}const B1=n=>Array.isArray(n)&&typeof n[0]=="number",qL={linearEasing:void 0};function XL(n,e){const t=C1(n);return()=>{var i;return(i=qL[e])!==null&&i!==void 0?i:t()}}const Ep=XL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),t2=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(tu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function n2(n){return!!(typeof n=="function"&&Ep()||!n||typeof n=="string"&&(n in nv||Ep())||B1(n)||Array.isArray(n)&&n.every(n2))}const Fh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,nv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Fh([0,.65,.55,1]),circOut:Fh([.55,0,1,.45]),backIn:Fh([.31,.01,.66,-.59]),backOut:Fh([.33,1.53,.69,.99])};function i2(n,e){if(n)return typeof n=="function"&&Ep()?t2(n,e):B1(n)?Fh(n):Array.isArray(n)?n.map(t=>i2(t,e)||nv.easeOut):nv[n]}const ur={x:!1,y:!1};function r2(){return ur.x||ur.y}function YL(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function s2(n,e){const t=YL(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function sS(n){return e=>{e.pointerType==="touch"||r2()||n(e)}}function ZL(n,e,t={}){const[i,r,s]=s2(n,t),o=sS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=sS(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const o2=(n,e)=>e?n===e?!0:o2(n,e.parentElement):!1,G1=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,QL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function JL(n){return QL.has(n.tagName)||n.tabIndex!==-1}const Vh=new WeakSet;function oS(n){return e=>{e.key==="Enter"&&n(e)}}function K_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const eO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=oS(()=>{if(Vh.has(t))return;K_(t,"down");const r=oS(()=>{K_(t,"up")}),s=()=>K_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function aS(n){return G1(n)&&!r2()}function tO(n,e,t={}){const[i,r,s]=s2(n,t),o=l=>{const u=l.currentTarget;if(!aS(l)||Vh.has(u))return;Vh.add(u);const h=e(l),f=(E,T)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),!(!aS(E)||!Vh.has(u))&&(Vh.delete(u),typeof h=="function"&&h(E,{success:T}))},p=E=>{f(E,t.useGlobalTarget||o2(u,E.target))},y=E=>{f(E,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!JL(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>eO(h,r),r)}),s}function nO(n){return n==="x"||n==="y"?ur[n]?null:(ur[n]=!0,()=>{ur[n]=!1}):ur.x||ur.y?null:(ur.x=ur.y=!0,()=>{ur.x=ur.y=!1})}const a2=new Set(["width","height","top","left","right","bottom",...Au]);let np;function iO(){np=void 0}const ns={now:()=>(np===void 0&&ns.set(xn.isProcessing||QM.useManualTiming?xn.timestamp:performance.now()),np),set:n=>{np=n,queueMicrotask(iO)}};function W1(n,e){n.indexOf(e)===-1&&n.push(e)}function $1(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class K1{constructor(){this.subscriptions=[]}add(e){return W1(this.subscriptions,e),()=>$1(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function l2(n,e){return e?n*(1e3/e):0}const lS=30,rO=n=>!isNaN(parseFloat(n));class sO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=ns.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ns.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=rO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new K1);const i=this.events[e].add(t);return e==="change"?()=>{i(),Et.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ns.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>lS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,lS);return l2(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gd(n,e){return new sO(n,e)}function oO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,gd(t))}function aO(n,e){const t=Em(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=vL(s[o]);oO(n,o,l)}}function lO(n){return!!(Ln(n)&&n.add)}function iv(n,e){const t=n.getValue("willChange");if(lO(t))return t.add(e)}function c2(n){return n.props[jA]}const u2=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,cO=1e-7,uO=12;function hO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=u2(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>cO&&++l<uO);return o}function Hd(n,e,t,i){if(n===e&&t===i)return Ti;const r=s=>hO(s,0,1,n,t);return s=>s===0||s===1?s:u2(r(s),e,i)}const h2=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,d2=n=>e=>1-n(1-e),f2=Hd(.33,1.53,.69,.99),H1=d2(f2),g2=h2(H1),p2=n=>(n*=2)<1?.5*H1(n):.5*(2-Math.pow(2,-10*(n-1))),q1=n=>1-Math.sin(Math.acos(n)),m2=d2(q1),y2=h2(q1),_2=n=>/^0[^.\s]+$/u.test(n);function dO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||_2(n):!0}const Xh=n=>Math.round(n*1e5)/1e5,X1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function fO(n){return n==null}const gO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Y1=(n,e)=>t=>!!(typeof t=="string"&&gO.test(t)&&t.startsWith(n)||e&&!fO(t)&&Object.prototype.hasOwnProperty.call(t,e)),v2=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(X1);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},pO=n=>$s(0,255,n),H_={...Pu,transform:n=>Math.round(pO(n))},Ya={test:Y1("rgb","red"),parse:v2("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+H_.transform(n)+", "+H_.transform(e)+", "+H_.transform(t)+", "+Xh(fd.transform(i))+")"};function mO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const rv={test:Y1("#"),parse:mO,transform:Ya.transform},Uc={test:Y1("hsl","hue"),parse:v2("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+ts.transform(Xh(e))+", "+ts.transform(Xh(t))+", "+Xh(fd.transform(i))+")"},Nn={test:n=>Ya.test(n)||rv.test(n)||Uc.test(n),parse:n=>Ya.test(n)?Ya.parse(n):Uc.test(n)?Uc.parse(n):rv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ya.transform(n):Uc.transform(n)},yO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function _O(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(X1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(yO))===null||t===void 0?void 0:t.length)||0)>0}const x2="number",w2="color",vO="var",xO="var(",cS="${}",wO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function pd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(wO,u=>(Nn.test(u)?(i.color.push(s),r.push(w2),t.push(Nn.parse(u))):u.startsWith(xO)?(i.var.push(s),r.push(vO),t.push(u)):(i.number.push(s),r.push(x2),t.push(parseFloat(u))),++s,cS)).split(cS);return{values:t,split:l,indexes:i,types:r}}function E2(n){return pd(n).values}function T2(n){const{split:e,types:t}=pd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===x2?s+=Xh(r[o]):l===w2?s+=Nn.transform(r[o]):s+=r[o]}return s}}const EO=n=>typeof n=="number"?0:n;function TO(n){const e=E2(n);return T2(n)(e.map(EO))}const Jo={test:_O,parse:E2,createTransformer:T2,getAnimatableNone:TO},SO=new Set(["brightness","contrast","saturate","opacity"]);function IO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(X1)||[];if(!i)return n;const r=t.replace(i,"");let s=SO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const CO=/\b([a-z-]*)\(.*?\)/gu,sv={...Jo,getAnimatableNone:n=>{const e=n.match(CO);return e?e.map(IO).join(" "):n}},RO={...M1,color:Nn,backgroundColor:Nn,outlineColor:Nn,fill:Nn,stroke:Nn,borderColor:Nn,borderTopColor:Nn,borderRightColor:Nn,borderBottomColor:Nn,borderLeftColor:Nn,filter:sv,WebkitFilter:sv},Z1=n=>RO[n];function S2(n,e){let t=Z1(n);return t!==sv&&(t=Jo),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const AO=new Set(["auto","none","0"]);function PO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!AO.has(s)&&pd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=S2(t,r)}const uS=n=>n===Pu||n===ke,hS=(n,e)=>parseFloat(n.split(", ")[e]),dS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return hS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?hS(s[1],n):0}},bO=new Set(["x","y","z"]),kO=Au.filter(n=>!bO.has(n));function DO(n){const e=[];return kO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const iu={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:dS(4,13),y:dS(5,14)};iu.translateX=iu.x;iu.translateY=iu.y;const rl=new Set;let ov=!1,av=!1;function I2(){if(av){const n=Array.from(rl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=DO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}av=!1,ov=!1,rl.forEach(n=>n.complete()),rl.clear()}function C2(){rl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(av=!0)})}function NO(){C2(),I2()}class Q1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rl.add(this),ov||(ov=!0,Et.read(C2),Et.resolveKeyframes(I2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),rl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const R2=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),MO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function LO(n){const e=MO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function A2(n,e,t=1){const[i,r]=LO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return R2(o)?parseFloat(o):o}return N1(r)?A2(r,e,t+1):r}const P2=n=>e=>e.test(n),OO={test:n=>n==="auto",parse:n=>n},b2=[Pu,ke,ts,Mo,IL,SL,OO],fS=n=>b2.find(P2(n));class k2 extends Q1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),N1(h))){const f=A2(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!a2.has(i)||e.length!==2)return;const[r,s]=e,o=fS(r),l=fS(s);if(o!==l)if(uS(o)&&uS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)dO(e[r])&&i.push(r);i.length&&PO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=iu[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=iu[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const gS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Jo.test(n)||n==="0")&&!n.startsWith("url("));function FO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function VO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=gS(r,e),l=gS(s,e);return!o||!l?!1:FO(n)||(t==="spring"||z1(t))&&i}const jO=n=>n!==null;function Tm(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(jO),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const UO=40;class D2{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ns.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>UO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&NO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ns.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!VO(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Tm(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const kt=(n,e,t)=>n+(e-n)*t;function q_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function zO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=q_(u,l,n+1/3),s=q_(u,l,n),o=q_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Tp(n,e){return t=>t>0?e:n}const X_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},BO=[rv,Ya,Uc],GO=n=>BO.find(e=>e.test(n));function pS(n){const e=GO(n);if(!e)return!1;let t=e.parse(n);return e===Uc&&(t=zO(t)),t}const mS=(n,e)=>{const t=pS(n),i=pS(e);if(!t||!i)return Tp(n,e);const r={...t};return s=>(r.red=X_(t.red,i.red,s),r.green=X_(t.green,i.green,s),r.blue=X_(t.blue,i.blue,s),r.alpha=kt(t.alpha,i.alpha,s),Ya.transform(r))},WO=(n,e)=>t=>e(n(t)),qd=(...n)=>n.reduce(WO),lv=new Set(["none","hidden"]);function $O(n,e){return lv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function KO(n,e){return t=>kt(n,e,t)}function J1(n){return typeof n=="number"?KO:typeof n=="string"?N1(n)?Tp:Nn.test(n)?mS:XO:Array.isArray(n)?N2:typeof n=="object"?Nn.test(n)?mS:HO:Tp}function N2(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>J1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function HO(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=J1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function qO(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const XO=(n,e)=>{const t=Jo.createTransformer(e),i=pd(n),r=pd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?lv.has(n)&&!r.values.length||lv.has(e)&&!i.values.length?$O(n,e):qd(N2(qO(i,r),r.values),t):Tp(n,e)};function M2(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kt(n,e,t):J1(n)(n,e)}const YO=5;function L2(n,e,t){const i=Math.max(e-YO,0);return l2(t-n(i),e-i)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Y_=.001;function ZO({duration:n=Lt.duration,bounce:e=Lt.bounce,velocity:t=Lt.velocity,mass:i=Lt.mass}){let r,s,o=1-e;o=$s(Lt.minDamping,Lt.maxDamping,o),n=$s(Lt.minDuration,Lt.maxDuration,Us(n)),o<1?(r=h=>{const f=h*o,p=f*n,y=f-t,E=cv(h,o),T=Math.exp(-p);return Y_-y/E*T},s=h=>{const p=h*o*n,y=p*t+t,E=Math.pow(o,2)*Math.pow(h,2)*n,T=Math.exp(-p),I=cv(Math.pow(h,2),o);return(-r(h)+Y_>0?-1:1)*((y-E)*T)/I}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-Y_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=JO(r,s,l);if(n=js(n),isNaN(u))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const QO=12;function JO(n,e,t){let i=t;for(let r=1;r<QO;r++)i=i-n(i)/e(i);return i}function cv(n,e){return n*Math.sqrt(1-e*e)}const eF=["duration","bounce"],tF=["stiffness","damping","mass"];function yS(n,e){return e.some(t=>n[t]!==void 0)}function nF(n){let e={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...n};if(!yS(n,tF)&&yS(n,eF))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*$s(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Lt.mass,stiffness:r,damping:s}}else{const t=ZO(n);e={...e,...t,mass:Lt.mass},e.isResolvedFromDuration=!0}return e}function O2(n=Lt.visualDuration,e=Lt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:y,isResolvedFromDuration:E}=nF({...t,velocity:-Us(t.velocity||0)}),T=y||0,I=h/(2*Math.sqrt(u*f)),S=o-s,P=Us(Math.sqrt(u/f)),N=Math.abs(S)<5;i||(i=N?Lt.restSpeed.granular:Lt.restSpeed.default),r||(r=N?Lt.restDelta.granular:Lt.restDelta.default);let D;if(I<1){const F=cv(P,I);D=B=>{const b=Math.exp(-I*P*B);return o-b*((T+I*P*S)/F*Math.sin(F*B)+S*Math.cos(F*B))}}else if(I===1)D=F=>o-Math.exp(-P*F)*(S+(T+P*S)*F);else{const F=P*Math.sqrt(I*I-1);D=B=>{const b=Math.exp(-I*P*B),R=Math.min(F*B,300);return o-b*((T+I*P*S)*Math.sinh(R)+F*S*Math.cosh(R))/F}}const L={calculatedDuration:E&&p||null,next:F=>{const B=D(F);if(E)l.done=F>=p;else{let b=0;I<1&&(b=F===0?js(T):L2(D,F,B));const R=Math.abs(b)<=i,M=Math.abs(o-B)<=r;l.done=R&&M}return l.value=l.done?o:B,l},toString:()=>{const F=Math.min(e2(L),tv),B=t2(b=>L.next(F*b).value,F,30);return F+"ms "+B}};return L}function _S({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],y={done:!1,value:p},E=R=>l!==void 0&&R<l||u!==void 0&&R>u,T=R=>l===void 0?u:u===void 0||Math.abs(l-R)<Math.abs(u-R)?l:u;let I=t*e;const S=p+I,P=o===void 0?S:o(S);P!==S&&(I=P-p);const N=R=>-I*Math.exp(-R/i),D=R=>P+N(R),L=R=>{const M=N(R),V=D(R);y.done=Math.abs(M)<=h,y.value=y.done?P:V};let F,B;const b=R=>{E(y.value)&&(F=R,B=O2({keyframes:[y.value,T(y.value)],velocity:L2(D,R,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return b(0),{calculatedDuration:null,next:R=>{let M=!1;return!B&&F===void 0&&(M=!0,L(R),b(R)),F!==void 0&&R>=F?B.next(R-F):(!M&&L(R),y)}}}const iF=Hd(.42,0,1,1),rF=Hd(0,0,.58,1),F2=Hd(.42,0,.58,1),sF=n=>Array.isArray(n)&&typeof n[0]!="number",oF={linear:Ti,easeIn:iF,easeInOut:F2,easeOut:rF,circIn:q1,circInOut:y2,circOut:m2,backIn:H1,backInOut:g2,backOut:f2,anticipate:p2},vS=n=>{if(B1(n)){MA(n.length===4);const[e,t,i,r]=n;return Hd(e,t,i,r)}else if(typeof n=="string")return oF[n];return n};function aF(n,e,t){const i=[],r=t||M2,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ti:e;l=qd(u,l)}i.push(l)}return i}function lF(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(MA(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=aF(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const y=tu(n[p],n[p+1],f);return l[p](y)};return t?f=>h($s(n[0],n[s-1],f)):h}function cF(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=tu(0,e,i);n.push(kt(t,1,r))}}function uF(n){const e=[0];return cF(e,n.length-1),e}function hF(n,e){return n.map(t=>t*e)}function dF(n,e){return n.map(()=>e||F2).splice(0,n.length-1)}function Sp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=sF(i)?i.map(vS):vS(i),s={done:!1,value:e[0]},o=hF(t&&t.length===e.length?t:uF(e),n),l=lF(o,e,{ease:Array.isArray(r)?r:dF(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const fF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Et.update(e,!0),stop:()=>Qo(e),now:()=>xn.isProcessing?xn.timestamp:ns.now()}},gF={decay:_S,inertia:_S,tween:Sp,keyframes:Sp,spring:O2},pF=n=>n/100;class ex extends D2{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||Q1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=z1(t)?t:gF[t]||Sp;let u,h;l!==Sp&&typeof e[0]!="number"&&(u=qd(pF,M2(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=e2(f));const{calculatedDuration:p}=f,y=p+r,E=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:y,totalDuration:E}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:E,repeatType:T,repeatDelay:I,onUpdate:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const P=this.currentTime-y*(this.speed>=0?1:-1),N=this.speed>=0?P<0:P>f;this.currentTime=Math.max(P,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let D=this.currentTime,L=s;if(E){const R=Math.min(this.currentTime,f)/p;let M=Math.floor(R),V=R%1;!V&&R>=1&&(V=1),V===1&&M--,M=Math.min(M,E+1),M%2&&(T==="reverse"?(V=1-V,I&&(V-=I/p)):T==="mirror"&&(L=o)),D=$s(0,1,V)*p}const F=N?{done:!1,value:u[0]}:L.next(D);l&&(F.value=l(F.value));let{done:B}=F;!N&&h!==null&&(B=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const b=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return b&&r!==void 0&&(F.value=Tm(u,this.options,r)),S&&S(F.value),b&&this.finish(),F}get duration(){const{resolved:e}=this;return e?Us(e.calculatedDuration):0}get time(){return Us(this.currentTime)}set time(e){e=js(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Us(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=fF,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const mF=new Set(["opacity","clipPath","filter","transform"]);function yF(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=i2(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const _F=C1(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Ip=10,vF=2e4;function xF(n){return z1(n.type)||n.type==="spring"||!n2(n.ease)}function wF(n,e){const t=new ex({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<vF;)i=t.sample(s),r.push(i.value),s+=Ip;return{times:void 0,keyframes:r,duration:s-Ip,ease:"linear"}}const V2={anticipate:p2,backInOut:g2,circInOut:y2};function EF(n){return n in V2}class xS extends D2{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new k2(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Ep()&&EF(s)&&(s=V2[s]),xF(this.options)){const{onComplete:p,onUpdate:y,motionValue:E,element:T,...I}=this.options,S=wF(e,I);e=S.keyframes,e.length===1&&(e[1]=e[0]),i=S.duration,r=S.times,s=S.ease,o="keyframes"}const f=yF(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(rS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(Tm(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Us(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Us(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=js(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ti;const{animation:i}=t;rS(i,e)}return Ti}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:y,...E}=this.options,T=new ex({...E,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=js(this.time);h.setWithVelocity(T.sample(I-Ip).value,T.sample(I).value,Ip)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return _F()&&i&&mF.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const TF={type:"spring",stiffness:500,damping:25,restSpeed:10},SF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),IF={type:"keyframes",duration:.8},CF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},RF=(n,{keyframes:e})=>e.length>2?IF:Pl.has(n)?n.startsWith("scale")?SF(e[1]):TF:CF;function AF({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const tx=(n,e,t,i={},r,s)=>o=>{const l=U1(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-js(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};AF(l)||(f={...f,...RF(n,f)}),f.duration&&(f.duration=js(f.duration)),f.repeatDelay&&(f.repeatDelay=js(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const y=Tm(f.keyframes,l);if(y!==void 0)return Et.update(()=>{f.onUpdate(y),f.onComplete()}),new HL([])}return!s&&xS.supports(f)?new xS(f):new ex(f)};function PF({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function j2(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const y=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),E=u[p];if(E===void 0||f&&PF(f,p))continue;const T={delay:t,...U1(o||{},p)};let I=!1;if(window.MotionHandoffAnimation){const P=c2(n);if(P){const N=window.MotionHandoffAnimation(P,p,Et);N!==null&&(T.startTime=N,I=!0)}}iv(n,p),y.start(tx(p,y,E,n.shouldReduceMotion&&a2.has(p)?{type:!1}:T,n,I));const S=y.animation;S&&h.push(S)}return l&&Promise.all(h).then(()=>{Et.update(()=>{l&&aO(n,l)})}),h}function uv(n,e,t={}){var i;const r=Em(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(j2(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:y}=s;return bF(n,e,f+h,p,y,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function bF(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(kF).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(uv(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function kF(n,e){return n.sortNodePosition(e)}function DF(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>uv(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=uv(n,e,t);else{const r=typeof e=="function"?Em(n,e,t.custom):e;i=Promise.all(j2(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const NF=A1.length;function U2(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?U2(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<NF;t++){const i=A1[t],r=n.props[i];(dd(r)||r===!1)&&(e[i]=r)}return e}const MF=[...R1].reverse(),LF=R1.length;function OF(n){return e=>Promise.all(e.map(({animation:t,options:i})=>DF(n,t,i)))}function FF(n){let e=OF(n),t=wS(),i=!0;const r=u=>(h,f)=>{var p;const y=Em(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(y){const{transition:E,transitionEnd:T,...I}=y;h={...h,...I,...T}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=U2(n.parent)||{},p=[],y=new Set;let E={},T=1/0;for(let S=0;S<LF;S++){const P=MF[S],N=t[P],D=h[P]!==void 0?h[P]:f[P],L=dd(D),F=P===u?N.isActive:null;F===!1&&(T=S);let B=D===f[P]&&D!==h[P]&&L;if(B&&i&&n.manuallyAnimateOnMount&&(B=!1),N.protectedKeys={...E},!N.isActive&&F===null||!D&&!N.prevProp||xm(D)||typeof D=="boolean")continue;const b=VF(N.prevProp,D);let R=b||P===u&&N.isActive&&!B&&L||S>T&&L,M=!1;const V=Array.isArray(D)?D:[D];let j=V.reduce(r(P),{});F===!1&&(j={});const{prevResolvedValues:z={}}=N,k={...z,...j},re=ue=>{R=!0,y.has(ue)&&(M=!0,y.delete(ue)),N.needsAnimating[ue]=!0;const Q=n.getValue(ue);Q&&(Q.liveStyle=!1)};for(const ue in k){const Q=j[ue],oe=z[ue];if(E.hasOwnProperty(ue))continue;let ne=!1;ev(Q)&&ev(oe)?ne=!JA(Q,oe):ne=Q!==oe,ne?Q!=null?re(ue):y.add(ue):Q!==void 0&&y.has(ue)?re(ue):N.protectedKeys[ue]=!0}N.prevProp=D,N.prevResolvedValues=j,N.isActive&&(E={...E,...j}),i&&n.blockInitialAnimation&&(R=!1),R&&(!(B&&b)||M)&&p.push(...V.map(ue=>({animation:ue,options:{type:P}})))}if(y.size){const S={};y.forEach(P=>{const N=n.getBaseTarget(P),D=n.getValue(P);D&&(D.liveStyle=!0),S[P]=N??null}),p.push({animation:S})}let I=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var E;return(E=y.animationState)===null||E===void 0?void 0:E.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const y in t)t[y].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=wS(),i=!0}}}function VF(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!JA(e,n):!1}function Ma(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wS(){return{animate:Ma(!0),whileInView:Ma(),whileHover:Ma(),whileTap:Ma(),whileDrag:Ma(),whileFocus:Ma(),exit:Ma()}}let sa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class jF extends sa{constructor(e){super(e),e.animationState||(e.animationState=FF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();xm(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let UF=0;class zF extends sa{constructor(){super(...arguments),this.id=UF++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const BF={animation:{Feature:jF},exit:{Feature:zF}};function md(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Xd(n){return{point:{x:n.pageX,y:n.pageY}}}const GF=n=>e=>G1(e)&&n(e,Xd(e));function Yh(n,e,t,i){return md(n,e,GF(t),i)}const ES=(n,e)=>Math.abs(n-e);function WF(n,e){const t=ES(n.x,e.x),i=ES(n.y,e.y);return Math.sqrt(t**2+i**2)}class z2{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Q_(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,E=WF(p.offset,{x:0,y:0})>=3;if(!y&&!E)return;const{point:T}=p,{timestamp:I}=xn;this.history.push({...T,timestamp:I});const{onStart:S,onMove:P}=this.handlers;y||(S&&S(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,p)},this.handlePointerMove=(p,y)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=Z_(y,this.transformPagePoint),Et.update(this.updatePoint,!0)},this.handlePointerUp=(p,y)=>{this.end();const{onEnd:E,onSessionEnd:T,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=Q_(p.type==="pointercancel"?this.lastMoveEventInfo:Z_(y,this.transformPagePoint),this.history);this.startEvent&&E&&E(p,S),T&&T(p,S)},!G1(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=Xd(e),l=Z_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=xn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,Q_(l,this.history)),this.removeListeners=qd(Yh(this.contextWindow,"pointermove",this.handlePointerMove),Yh(this.contextWindow,"pointerup",this.handlePointerUp),Yh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Qo(this.updatePoint)}}function Z_(n,e){return e?{point:e(n.point)}:n}function TS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Q_({point:n},e){return{point:n,delta:TS(n,B2(e)),offset:TS(n,$F(e)),velocity:KF(e,.1)}}function $F(n){return n[0]}function B2(n){return n[n.length-1]}function KF(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=B2(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>js(e)));)t--;if(!i)return{x:0,y:0};const s=Us(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const G2=1e-4,HF=1-G2,qF=1+G2,W2=.01,XF=0-W2,YF=0+W2;function Si(n){return n.max-n.min}function ZF(n,e,t){return Math.abs(n-e)<=t}function SS(n,e,t,i=.5){n.origin=i,n.originPoint=kt(e.min,e.max,n.origin),n.scale=Si(t)/Si(e),n.translate=kt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=HF&&n.scale<=qF||isNaN(n.scale))&&(n.scale=1),(n.translate>=XF&&n.translate<=YF||isNaN(n.translate))&&(n.translate=0)}function Zh(n,e,t,i){SS(n.x,e.x,t.x,i?i.originX:void 0),SS(n.y,e.y,t.y,i?i.originY:void 0)}function IS(n,e,t){n.min=t.min+e.min,n.max=n.min+Si(e)}function QF(n,e,t){IS(n.x,e.x,t.x),IS(n.y,e.y,t.y)}function CS(n,e,t){n.min=e.min-t.min,n.max=n.min+Si(e)}function Qh(n,e,t){CS(n.x,e.x,t.x),CS(n.y,e.y,t.y)}function JF(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?kt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?kt(t,n,i.max):Math.min(n,t)),n}function RS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function eV(n,{top:e,left:t,bottom:i,right:r}){return{x:RS(n.x,t,r),y:RS(n.y,e,i)}}function AS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function tV(n,e){return{x:AS(n.x,e.x),y:AS(n.y,e.y)}}function nV(n,e){let t=.5;const i=Si(n),r=Si(e);return r>i?t=tu(e.min,e.max-i,n.min):i>r&&(t=tu(n.min,n.max-r,e.min)),$s(0,1,t)}function iV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const hv=.35;function rV(n=hv){return n===!1?n=0:n===!0&&(n=hv),{x:PS(n,"left","right"),y:PS(n,"top","bottom")}}function PS(n,e,t){return{min:bS(n,e),max:bS(n,t)}}function bS(n,e){return typeof n=="number"?n:n[e]||0}const kS=()=>({translate:0,scale:1,origin:0,originPoint:0}),zc=()=>({x:kS(),y:kS()}),DS=()=>({min:0,max:0}),Ut=()=>({x:DS(),y:DS()});function Gi(n){return[n("x"),n("y")]}function $2({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function sV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function oV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function J_(n){return n===void 0||n===1}function dv({scale:n,scaleX:e,scaleY:t}){return!J_(n)||!J_(e)||!J_(t)}function Va(n){return dv(n)||K2(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function K2(n){return NS(n.x)||NS(n.y)}function NS(n){return n&&n!=="0%"}function Cp(n,e,t){const i=n-t,r=e*i;return t+r}function MS(n,e,t,i,r){return r!==void 0&&(n=Cp(n,r,i)),Cp(n,t,i)+e}function fv(n,e=0,t=1,i,r){n.min=MS(n.min,e,t,i,r),n.max=MS(n.max,e,t,i,r)}function H2(n,{x:e,y:t}){fv(n.x,e.translate,e.scale,e.originPoint),fv(n.y,t.translate,t.scale,t.originPoint)}const LS=.999999999999,OS=1.0000000000001;function aV(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,H2(n,o)),i&&Va(s.latestValues)&&Gc(n,s.latestValues))}e.x<OS&&e.x>LS&&(e.x=1),e.y<OS&&e.y>LS&&(e.y=1)}function Bc(n,e){n.min=n.min+e,n.max=n.max+e}function FS(n,e,t,i,r=.5){const s=kt(n.min,n.max,r);fv(n,e,t,s,i)}function Gc(n,e){FS(n.x,e.x,e.scaleX,e.scale,e.originX),FS(n.y,e.y,e.scaleY,e.scale,e.originY)}function q2(n,e){return $2(oV(n.getBoundingClientRect(),e))}function lV(n,e,t){const i=q2(n,t),{scroll:r}=e;return r&&(Bc(i.x,r.offset.x),Bc(i.y,r.offset.y)),i}const X2=({current:n})=>n?n.ownerDocument.defaultView:null,cV=new WeakMap;class uV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Xd(f).point)},s=(f,p)=>{const{drag:y,dragPropagation:E,onDragStart:T}=this.getProps();if(y&&!E&&(this.openDragLock&&this.openDragLock(),this.openDragLock=nO(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Gi(S=>{let P=this.getAxisMotionValue(S).get()||0;if(ts.test(P)){const{projection:N}=this.visualElement;if(N&&N.layout){const D=N.layout.layoutBox[S];D&&(P=Si(D)*(parseFloat(P)/100))}}this.originPoint[S]=P}),T&&Et.postRender(()=>T(f,p)),iv(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:y,dragDirectionLock:E,onDirectionLock:T,onDrag:I}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:S}=p;if(E&&this.currentDirection===null){this.currentDirection=hV(S),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",p.point,S),this.updateAxis("y",p.point,S),this.visualElement.render(),I&&I(f,p)},l=(f,p)=>this.stop(f,p),u=()=>Gi(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new z2(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:X2(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Et.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Pg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=JF(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&jc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=eV(r.layoutBox,t):this.constraints=!1,this.elastic=rV(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Gi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=iV(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!jc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=lV(i,r.root,this.visualElement.getTransformPagePoint());let o=tV(r.layout.layoutBox,s);if(t){const l=t(sV(o));this.hasMutatedConstraints=!!l,l&&(o=$2(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Gi(f=>{if(!Pg(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const y=r?200:1e6,E=r?40:1e7,T={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:E,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,T)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return iv(this.visualElement,e),i.start(tx(e,i,0,t,this.visualElement,!1))}stopAnimation(){Gi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Gi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Gi(t=>{const{drag:i}=this.getProps();if(!Pg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-kt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!jc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Gi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=nV({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Gi(o=>{if(!Pg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(kt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;cV.set(this.visualElement,this);const e=this.visualElement.current,t=Yh(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();jc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Et.read(i);const o=md(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Gi(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=hv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Pg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function hV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class dV extends sa{constructor(e){super(e),this.removeGroupControls=Ti,this.removeListeners=Ti,this.controls=new uV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ti}unmount(){this.removeGroupControls(),this.removeListeners()}}const VS=n=>(e,t)=>{n&&Et.postRender(()=>n(e,t))};class fV extends sa{constructor(){super(...arguments),this.removePointerDownListener=Ti}onPointerDown(e){this.session=new z2(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:X2(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:VS(e),onStart:VS(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Et.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Yh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ip={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function jS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Sh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(ke.test(n))n=parseFloat(n);else return n;const t=jS(n,e.target.x),i=jS(n,e.target.y);return`${t}% ${i}%`}},gV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=Jo.parse(n);if(r.length>5)return i;const s=Jo.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=kt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class pV extends Z.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;LL(mV),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),ip.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Et.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),b1.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Y2(n){const[e,t]=DA(),i=Z.useContext(E1);return v.jsx(pV,{...n,layoutGroup:i,switchLayoutGroup:Z.useContext(UA),isPresent:e,safeToRemove:t})}const mV={borderRadius:{...Sh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Sh,borderTopRightRadius:Sh,borderBottomLeftRadius:Sh,borderBottomRightRadius:Sh,boxShadow:gV};function yV(n,e,t){const i=Ln(n)?n:gd(n);return i.start(tx("",i,e,t)),i.animation}function _V(n){return n instanceof SVGElement&&n.tagName!=="svg"}const vV=(n,e)=>n.depth-e.depth;class xV{constructor(){this.children=[],this.isDirty=!1}add(e){W1(this.children,e),this.isDirty=!0}remove(e){$1(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(vV),this.isDirty=!1,this.children.forEach(e)}}function wV(n,e){const t=ns.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Qo(i),n(s-e))};return Et.read(i,!0),()=>Qo(i)}const Z2=["TopLeft","TopRight","BottomLeft","BottomRight"],EV=Z2.length,US=n=>typeof n=="string"?parseFloat(n):n,zS=n=>typeof n=="number"||ke.test(n);function TV(n,e,t,i,r,s){r?(n.opacity=kt(0,t.opacity!==void 0?t.opacity:1,SV(i)),n.opacityExit=kt(e.opacity!==void 0?e.opacity:1,0,IV(i))):s&&(n.opacity=kt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<EV;o++){const l=`border${Z2[o]}Radius`;let u=BS(e,l),h=BS(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||zS(u)===zS(h)?(n[l]=Math.max(kt(US(u),US(h),i),0),(ts.test(h)||ts.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=kt(e.rotate||0,t.rotate||0,i))}function BS(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const SV=Q2(0,.5,m2),IV=Q2(.5,.95,Ti);function Q2(n,e,t){return i=>i<n?0:i>e?1:t(tu(n,e,i))}function GS(n,e){n.min=e.min,n.max=e.max}function zi(n,e){GS(n.x,e.x),GS(n.y,e.y)}function WS(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function $S(n,e,t,i,r){return n-=e,n=Cp(n,1/t,i),r!==void 0&&(n=Cp(n,1/r,i)),n}function CV(n,e=0,t=1,i=.5,r,s=n,o=n){if(ts.test(e)&&(e=parseFloat(e),e=kt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=kt(s.min,s.max,i);n===s&&(l-=e),n.min=$S(n.min,e,t,l,r),n.max=$S(n.max,e,t,l,r)}function KS(n,e,[t,i,r],s,o){CV(n,e[t],e[i],e[r],e.scale,s,o)}const RV=["x","scaleX","originX"],AV=["y","scaleY","originY"];function HS(n,e,t,i){KS(n.x,e,RV,t?t.x:void 0,i?i.x:void 0),KS(n.y,e,AV,t?t.y:void 0,i?i.y:void 0)}function qS(n){return n.translate===0&&n.scale===1}function J2(n){return qS(n.x)&&qS(n.y)}function XS(n,e){return n.min===e.min&&n.max===e.max}function PV(n,e){return XS(n.x,e.x)&&XS(n.y,e.y)}function YS(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function eP(n,e){return YS(n.x,e.x)&&YS(n.y,e.y)}function ZS(n){return Si(n.x)/Si(n.y)}function QS(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class bV{constructor(){this.members=[]}add(e){W1(this.members,e),e.scheduleRender()}remove(e){if($1(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function kV(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:y,skewX:E,skewY:T}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),y&&(i+=`rotateY(${y}deg) `),E&&(i+=`skewX(${E}deg) `),T&&(i+=`skewY(${T}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const ja={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},jh=typeof window<"u"&&window.MotionDebug!==void 0,e0=["","X","Y","Z"],DV={visibility:"hidden"},JS=1e3;let NV=0;function t0(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function tP(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=c2(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Et,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&tP(i)}function nP({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=NV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jh&&(ja.totalNodes=ja.resolvedTargetDeltas=ja.recalculatedProjection=0),this.nodes.forEach(OV),this.nodes.forEach(zV),this.nodes.forEach(BV),this.nodes.forEach(FV),jh&&window.MotionDebug.record(ja)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new xV)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new K1),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=_V(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=wV(y,250),ip.hasAnimatedSinceResize&&(ip.hasAnimatedSinceResize=!1,this.nodes.forEach(tI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y,hasRelativeTargetChanged:E,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||HV,{onLayoutAnimationStart:S,onLayoutAnimationComplete:P}=f.getProps(),N=!this.targetLayout||!eP(this.targetLayout,T)||E,D=!y&&E;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||D||y&&(N||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,D);const L={...U1(I,"layout"),onPlay:S,onComplete:P};(f.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else y||tI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Qo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(GV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&tP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(eI);return}this.isUpdating||this.nodes.forEach(jV),this.isUpdating=!1,this.nodes.forEach(UV),this.nodes.forEach(MV),this.nodes.forEach(LV),this.clearAllSnapshots();const l=ns.now();xn.delta=$s(0,1e3/60,l-xn.timestamp),xn.timestamp=l,xn.isProcessing=!0,$_.update.process(xn),$_.preRender.process(xn),$_.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,b1.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(VV),this.sharedNodes.forEach(WV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Et.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Et.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!J2(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Va(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),qV(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(XV))){const{scroll:f}=this.root;f&&(Bc(u.x,f.offset.x),Bc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(zi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:y}=f;f!==this.root&&p&&y.layoutScroll&&(p.wasRoot&&zi(u,o),Bc(u.x,p.offset.x),Bc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();zi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Gc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Va(f.latestValues)&&Gc(u,f.latestValues)}return Va(this.latestValues)&&Gc(u,this.latestValues),u}removeTransform(o){const l=Ut();zi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Va(h.latestValues))continue;dv(h.latestValues)&&h.updateSnapshot();const f=Ut(),p=h.measurePageBox();zi(f,p),HS(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Va(this.latestValues)&&HS(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:y}=this.options;if(!(!this.layout||!(p||y))){if(this.resolvedRelativeTargetAt=xn.timestamp,!this.targetDelta&&!this.relativeTarget){const E=this.getClosestProjectingParent();E&&E.layout&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.layout.layoutBox,E.layout.layoutBox),zi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),QF(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):zi(this.target,this.layout.layoutBox),H2(this.target,this.targetDelta)):zi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const E=this.getClosestProjectingParent();E&&!!E.resumingFrom==!!this.resumingFrom&&!E.options.layoutScroll&&E.target&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.target,E.target),zi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}jh&&ja.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||dv(this.parent.latestValues)||K2(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;zi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,E=this.treeScale.y;aV(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:T}=l;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(WS(this.prevProjectionDelta.x,this.projectionDelta.x),WS(this.prevProjectionDelta.y,this.projectionDelta.y)),Zh(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==E||!QS(this.projectionDelta.x,this.prevProjectionDelta.x)||!QS(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T)),jh&&ja.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=zc(),this.projectionDelta=zc(),this.projectionDeltaWithTransform=zc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=zc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),E=u?u.source:void 0,T=this.layout?this.layout.source:void 0,I=E!==T,S=this.getStack(),P=!S||S.members.length<=1,N=!!(I&&!P&&this.options.crossfade===!0&&!this.path.some(KV));this.animationProgress=0;let D;this.mixTargetDelta=L=>{const F=L/1e3;nI(p.x,o.x,F),nI(p.y,o.y,F),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qh(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),$V(this.relativeTarget,this.relativeTargetOrigin,y,F),D&&PV(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=Ut()),zi(D,this.relativeTarget)),I&&(this.animationValues=f,TV(f,h,this.latestValues,F,N,P)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Qo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Et.update(()=>{ip.hasAnimatedSinceResize=!0,this.currentAnimation=yV(0,JS,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(JS),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&iP(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const p=Si(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const y=Si(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}zi(l,u),Gc(l,f),Zh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new bV),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&t0("z",o,h,this.animationValues);for(let f=0;f<e0.length;f++)t0(`rotate${e0[f]}`,o,h,this.animationValues),t0(`skew${e0[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return DV;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=tp(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=tp(o?.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const y=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=kV(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x:E,y:T}=this.projectionDelta;h.transformOrigin=`${E.origin*100}% ${T.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=p===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const I in wp){if(y[I]===void 0)continue;const{correct:S,applyTo:P}=wp[I],N=h.transform==="none"?y[I]:S(y[I],p);if(P){const D=P.length;for(let L=0;L<D;L++)h[P[L]]=N}else h[I]=N}return this.options.layoutId&&(h.pointerEvents=p===this?tp(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(eI),this.root.sharedNodes.clear()}}}function MV(n){n.updateLayout()}function LV(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Gi(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],E=Si(y);y.min=i[p].min,y.max=y.min+E}):iP(s,t.layoutBox,i)&&Gi(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],E=Si(i[p]);y.max=y.min+E,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+E)});const l=zc();Zh(l,i,t.layoutBox);const u=zc();o?Zh(u,n.applyTransform(r,!0),t.measuredBox):Zh(u,i,t.layoutBox);const h=!J2(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:y,layout:E}=p;if(y&&E){const T=Ut();Qh(T,t.layoutBox,y.layoutBox);const I=Ut();Qh(I,i,E.layoutBox),eP(T,I)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=T,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function OV(n){jh&&ja.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function FV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function VV(n){n.clearSnapshot()}function eI(n){n.clearMeasurements()}function jV(n){n.isLayoutDirty=!1}function UV(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function tI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function zV(n){n.resolveTargetDelta()}function BV(n){n.calcProjection()}function GV(n){n.resetSkewAndRotation()}function WV(n){n.removeLeadSnapshot()}function nI(n,e,t){n.translate=kt(e.translate,0,t),n.scale=kt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function iI(n,e,t,i){n.min=kt(e.min,t.min,i),n.max=kt(e.max,t.max,i)}function $V(n,e,t,i){iI(n.x,e.x,t.x,i),iI(n.y,e.y,t.y,i)}function KV(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const HV={duration:.45,ease:[.4,0,.1,1]},rI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),sI=rI("applewebkit/")&&!rI("chrome/")?Math.round:Ti;function oI(n){n.min=sI(n.min),n.max=sI(n.max)}function qV(n){oI(n.x),oI(n.y)}function iP(n,e,t){return n==="position"||n==="preserve-aspect"&&!ZF(ZS(e),ZS(t),.2)}function XV(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const YV=nP({attachResizeListener:(n,e)=>md(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),n0={current:void 0},rP=nP({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!n0.current){const n=new YV({});n.mount(window),n.setOptions({layoutScroll:!0}),n0.current=n}return n0.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),ZV={pan:{Feature:fV},drag:{Feature:dV,ProjectionNode:rP,MeasureLayout:Y2}};function aI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Et.postRender(()=>s(e,Xd(e)))}class QV extends sa{mount(){const{current:e}=this.node;e&&(this.unmount=ZL(e,t=>(aI(this.node,t,"Start"),i=>aI(this.node,i,"End"))))}unmount(){}}class JV extends sa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=qd(md(this.node.current,"focus",()=>this.onFocus()),md(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function lI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Et.postRender(()=>s(e,Xd(e)))}class e5 extends sa{mount(){const{current:e}=this.node;e&&(this.unmount=tO(e,t=>(lI(this.node,t,"Start"),(i,{success:r})=>lI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const gv=new WeakMap,i0=new WeakMap,t5=n=>{const e=gv.get(n.target);e&&e(n)},n5=n=>{n.forEach(t5)};function i5({root:n,...e}){const t=n||document;i0.has(t)||i0.set(t,{});const i=i0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(n5,{root:n,...e})),i[r]}function r5(n,e,t){const i=i5(e);return gv.set(n,t),i.observe(n),()=>{gv.delete(n),i.unobserve(n)}}const s5={some:0,all:1};class o5 extends sa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:s5[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),y=h?f:p;y&&y(u)};return r5(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(a5(e,t))&&this.startObserver()}unmount(){}}function a5({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const l5={inView:{Feature:o5},tap:{Feature:e5},focus:{Feature:JV},hover:{Feature:QV}},c5={layout:{ProjectionNode:rP,MeasureLayout:Y2}},pv={current:null},sP={current:!1};function u5(){if(sP.current=!0,!!I1)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>pv.current=n.matches;n.addListener(e),e()}else pv.current=!1}const h5=[...b2,Nn,Jo],d5=n=>h5.find(P2(n)),cI=new WeakMap;function f5(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Ln(r))n.addValue(i,r);else if(Ln(s))n.addValue(i,gd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,gd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const uI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class g5{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Q1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const E=ns.now();this.renderScheduledAt<E&&(this.renderScheduledAt=E,Et.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=wm(t),this.isVariantNode=VA(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const E in y){const T=y[E];u[E]!==void 0&&Ln(T)&&T.set(u[E],!1)}}mount(e){this.current=e,cI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),sP.current||u5(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:pv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){cI.delete(this.current),this.projection&&this.projection.unmount(),Qo(this.notifyUpdate),Qo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Pl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Et.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in nu){const t=nu[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<uI.length;i++){const r=uI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=f5(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=gd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(R2(r)||_2(r))?r=parseFloat(r):!d5(r)&&Jo.test(t)&&(r=S2(e,t)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=D1(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ln(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new K1),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class oP extends g5{constructor(){super(...arguments),this.KeyframeResolver=k2}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function p5(n){return window.getComputedStyle(n)}class m5 extends oP{constructor(){super(...arguments),this.type="html",this.renderInstance=HA}readValueFromInstance(e,t){if(Pl.has(t)){const i=Z1(t);return i&&i.default||0}else{const i=p5(e),r=(WA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return q2(e,t)}build(e,t,i){L1(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return j1(e,t,i)}}class y5 extends oP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Pl.has(t)){const i=Z1(t);return i&&i.default||0}return t=qA.has(t)?t:P1(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return ZA(e,t,i)}build(e,t,i){O1(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){XA(e,t,i,r)}mount(e){this.isSVGTag=V1(e.tagName),super.mount(e)}}const _5=(n,e)=>k1(n)?new y5(e):new m5(e,{allowProjection:n!==Z.Fragment}),v5=WL({...BF,...l5,...ZV,...c5},_5),Je=sL(v5),ei={ADD:"add",REMOVE:"remove"},ru={PROPERTYCHANGE:"propertychange"},Be={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Sm{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function x5(n,e,t){let i,r;t=t||zs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function zs(n,e){return n>e?1:n<e?-1:0}function w5(n,e){return n<e?1:n>e?-1:0}function nx(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function E5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function ix(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function oa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function T5(n,e,t){const i=e||zs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function yd(){return!0}function Im(){return!1}function _d(){}function aP(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!oa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function S5(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Yd(n){for(const e in n)delete n[e]}function su(n){let e;for(e in n)return!1;return!e}class Ys{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Cm extends Sm{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ys(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,_d);delete o[i]}return u}disposeInternal(){this.listeners_&&Yd(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=_d,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function nt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Rp(n,e,t,i){return nt(n,e,t,i,!0)}function Rt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Yd(n))}class Zd extends Cm{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Be.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=nt(this,e[s],t);return r}return nt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Rp(this,e[s],t)}else i=Rp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)I5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Zd.prototype.on;Zd.prototype.once;Zd.prototype.un;function I5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Rt(n[e]);else Rt(n)}function tt(){throw new Error("Unimplemented abstract method.")}let C5=0;function it(n){return n.ol_uid||(n.ol_uid=String(++C5))}class hI extends Ys{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class cs extends Zd{constructor(e){super(),this.on,this.once,this.un,it(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new hI(i,e,t)),i=ru.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new hI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],su(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const dI={LENGTH:"length"};class bg extends Ys{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Ki extends cs{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(dI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new bg(ei.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new bg(ei.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new bg(ei.REMOVE,r,e)),this.dispatchEvent(new bg(ei.ADD,t,e))}updateLength_(){this.set(dI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function at(n,e){if(!n)throw new Error(e)}class ou extends cs{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new ou(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nt(e,Be.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?R5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function R5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(at(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const an={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function fI(n){const e=Zi();for(let t=0,i=n.length;t<i;++t)Jh(e,n[t]);return e}function rx(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function lP(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function cP(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function au(n,e){return uP(n,e[0],e[1])}function Uh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function uP(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function mv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=an.UNKNOWN;return o<t?u=u|an.LEFT:o>r&&(u=u|an.RIGHT),l<i?u=u|an.BELOW:l>s&&(u=u|an.ABOVE),u===an.UNKNOWN&&(u=an.INTERSECTING),u}function Zi(){return[1/0,1/0,-1/0,-1/0]}function ea(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Rm(n){return ea(1/0,1/0,-1/0,-1/0,n)}function hP(n,e){const t=n[0],i=n[1];return ea(t,i,t,i,e)}function sx(n,e,t,i,r){const s=Rm(r);return dP(s,n,e,t,i)}function vd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function A5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Jh(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function dP(n,e,t,i,r){for(;t<i;t+=r)P5(n,e[t],e[t+1]);return n}function P5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function fP(n,e){let t;return t=e(Am(n)),t||(t=e(Pm(n)),t)||(t=e(bm(n)),t)||(t=e(bl(n)),t)?t:!1}function yv(n){let e=0;return km(n)||(e=dt(n)*Bn(n)),e}function Am(n){return[n[0],n[1]]}function Pm(n){return[n[2],n[1]]}function fl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function b5(n,e){let t;if(e==="bottom-left")t=Am(n);else if(e==="bottom-right")t=Pm(n);else if(e==="top-left")t=bl(n);else if(e==="top-right")t=bm(n);else throw new Error("Invalid corner");return t}function _v(n,e,t,i,r){const[s,o,l,u,h,f,p,y]=gP(n,e,t,i);return ea(Math.min(s,l,h,p),Math.min(o,u,f,y),Math.max(s,l,h,p),Math.max(o,u,f,y),r)}function gP(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,y=n[0],E=n[1];return[y-u+p,E-h-f,y-u-p,E-h+f,y+u-p,E+h+f,y+u+p,E+h-f,y-u+p,E-h-f]}function Bn(n){return n[3]-n[1]}function sl(n,e,t){const i=t||Zi();return ri(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Rm(i),i}function bl(n){return[n[0],n[3]]}function bm(n){return[n[2],n[3]]}function dt(n){return n[2]-n[0]}function ri(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function km(n){return n[2]<n[0]||n[3]<n[1]}function k5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function D5(n,e,t){let i=!1;const r=mv(n,e),s=mv(n,t);if(r===an.INTERSECTING||s===an.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],y=t[0],E=t[1],T=(E-p)/(y-f);let I,S;s&an.ABOVE&&!(r&an.ABOVE)&&(I=y-(E-h)/T,i=I>=o&&I<=u),!i&&s&an.RIGHT&&!(r&an.RIGHT)&&(S=E-(y-u)*T,i=S>=l&&S<=h),!i&&s&an.BELOW&&!(r&an.BELOW)&&(I=y-(E-l)/T,i=I>=o&&I<=u),!i&&s&an.LEFT&&!(r&an.LEFT)&&(S=E-(y-o)*T,i=S>=l&&S<=h)}return i}function pP(n,e){const t=e.getExtent(),i=fl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=dt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function mP(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];pP(n,e);const r=dt(i);if(dt(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function N5(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Hc(n,e,t,i)}function Hc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function M5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function gI(n){return n*180/Math.PI}function Ko(n){return n*Math.PI/180}function ol(n,e){const t=n%e;return t*e<0?t+e:t}function xi(n,e,t){return n+t*(e-n)}function Qd(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function lq(n,e){return Math.round(Qd(n,e))}function kg(n,e){return Math.floor(Qd(n,e))}function Dg(n,e){return Math.ceil(Qd(n,e))}function vv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function L5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Ap(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function ox(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function O5(n,e){return n[0]*=e,n[1]*=e,n}function yP(n,e){if(e.canWrapX()){const t=dt(e.getExtent()),i=F5(n,e,t);i&&(n[0]-=i*t)}return n}function F5(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||dt(i),r=Math.floor((n[0]-i[0])/t)),r}function _P(...n){console.warn(...n)}const lu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class ax{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||lu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Jd=6378137,Wc=Math.PI*Jd,V5=[-Wc,-Wc,Wc,Wc],j5=[-180,-85,180,85],Ng=Jd*Math.log(Math.tan(Math.PI/2));class _c extends ax{constructor(e){super({code:e,units:"m",extent:V5,global:!0,worldExtent:j5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/Jd)}})}}const pI=[new _c("EPSG:3857"),new _c("EPSG:102100"),new _c("EPSG:102113"),new _c("EPSG:900913"),new _c("http://www.opengis.net/def/crs/EPSG/0/3857"),new _c("http://www.opengis.net/gml/srs/epsg.xml#3857")];function U5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Wc*n[s]/180;let o=Jd*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Ng?o=Ng:o<-Ng&&(o=-Ng),e[s+1]=o}return e}function z5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Wc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Jd))/Math.PI-90;return e}const B5=6378137,mI=[-180,-90,180,90],G5=Math.PI*B5/180;class La extends ax{constructor(e,t){super({code:e,units:"degrees",extent:mI,axisOrientation:t,global:!0,metersPerUnit:G5,worldExtent:mI})}}const yI=[new La("CRS:84"),new La("EPSG:4326","neu"),new La("urn:ogc:def:crs:OGC:1.3:CRS84"),new La("urn:ogc:def:crs:OGC:2:84"),new La("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new La("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new La("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let xv={};function W5(n){return xv[n]||xv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function $5(n,e){xv[n]=e}let qc={};function xd(n,e,t){const i=n.getCode(),r=e.getCode();i in qc||(qc[i]={}),qc[i][r]=t}function r0(n,e){return n in qc&&e in qc[n]?qc[n][e]:null}const Pp=.9996,Xi=.00669438,Dm=Xi*Xi,Nm=Dm*Xi,Za=Xi/(1-Xi),_I=Math.sqrt(1-Xi),cu=(1-_I)/(1+_I),vP=cu*cu,lx=vP*cu,cx=lx*cu,xP=cx*cu,wP=1-Xi/4-3*Dm/64-5*Nm/256,K5=3*Xi/8+3*Dm/32+45*Nm/1024,H5=15*Dm/256+45*Nm/1024,q5=35*Nm/3072,X5=3/2*cu-27/32*lx+269/512*xP,Y5=21/16*vP-55/32*cx,Z5=151/96*lx-417/128*xP,Q5=1097/512*cx,bp=6378137;function J5(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Pp/(bp*wP),l=o+X5*Math.sin(2*o)+Y5*Math.sin(4*o)+Z5*Math.sin(6*o)+Q5*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,y=p*p,E=y*y,T=1-Xi*h,I=Math.sqrt(1-Xi*h),S=bp/I,P=(1-Xi)/T,N=Za*f**2,D=N*N,L=i/(S*Pp),F=L*L,B=F*L,b=B*L,R=b*L,M=R*L,V=l-p/P*(F/2-b/24*(5+3*y+10*N-4*D-9*Za))+M/720*(61+90*y+298*N+45*E-252*Za-3*D);let j=(L-B/6*(1+2*y+N)+R/120*(5-2*N+28*y-3*D+8*Za+24*E))/f;return j=vv(j+Ko(EP(t.number)),-Math.PI,Math.PI),[gI(j),gI(V)]}const vI=-80,xI=84,e3=-180,t3=180;function n3(n,e,t){n=vv(n,e3,t3),e<vI?e=vI:e>xI&&(e=xI);const i=Ko(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Ko(n),f=EP(t.number),p=Ko(f),y=bp/Math.sqrt(1-Xi*r**2),E=Za*s**2,T=s*vv(h-p,-Math.PI,Math.PI),I=T*T,S=I*T,P=S*T,N=P*T,D=N*T,L=bp*(wP*i-K5*Math.sin(2*i)+H5*Math.sin(4*i)-q5*Math.sin(6*i)),F=Pp*y*(T+S/6*(1-l+E)+N/120*(5-18*l+u+72*E-58*Za))+5e5;let B=Pp*(L+y*o*(I/2+P/24*(5-l+9*E+4*E**2)+D/720*(61-58*l+u+600*E-330*Za)));return t.north||(B+=1e7),[F,B]}function EP(n){return(n-1)*6-180+3}const i3=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function TP(n){let e=0;for(const r of i3){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function wI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function r3(n){return TP(n)?new ax({code:n,units:"m"}):null}function s3(n){const e=TP(n.getCode());return e?{forward:wI(n3,e),inverse:wI(J5,e)}:null}const o3=63710088e-1;function EI(n,e,t){t=t||o3;const i=Ko(n[1]),r=Ko(e[1]),s=(r-i)/2,o=Ko(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const a3=[s3],l3=[r3];let wv=!0;function SP(n){wv=!1}function ux(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Ev(n){$5(n.getCode(),n),xd(n,n,ux)}function c3(n){n.forEach(Ev)}function ai(n){if(typeof n!="string")return n;const e=W5(n);if(e)return e;for(const t of l3){const i=t(n);if(i)return i}return null}function kp(n,e,t,i){n=ai(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/lu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=dx(n,ai("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=EI(h.slice(0,2),h.slice(2,4)),p=EI(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?lu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function TI(n){c3(n),n.forEach(function(e){n.forEach(function(t){e!==t&&xd(e,t,ux)})})}function u3(n,e,t,i){n.forEach(function(r){e.forEach(function(s){xd(r,s,t),xd(s,r,i)})})}function hx(n,e){return n?typeof n=="string"?ai(n):n:ai(e)}function h3(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function gl(n,e){return SP(),Mm(n,"EPSG:4326","EPSG:3857")}function SI(n,e){const t=Mm(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=ol(i+180,360)-180),t}function rp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||dx(n,e)===ux)&&t}function dx(n,e){const t=n.getCode(),i=e.getCode();let r=r0(t,i);if(r)return r;let s=null,o=null;for(const u of a3)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=s0(s.inverse,o.forward);else{const u=r0(t,l);u&&(r=s0(u,o.forward))}else{const u=r0(l,i);u&&(r=s0(s.inverse,u))}return r&&(Ev(n),Ev(e),xd(n,e,r)),r}function s0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Dp(n,e){const t=ai(n),i=ai(e);return dx(t,i)}function Mm(n,e,t){const i=Dp(e,t);if(!i){const r=ai(e).getCode(),s=ai(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Tv(n,e){return n}function Ds(n,e){return wv&&!Ap(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(wv=!1,_P("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function IP(n,e){return n}function Bo(n,e){return n}function d3(){TI(pI),TI(yI),u3(yI,pI,U5,z5)}d3();new Array(6);function xr(){return[1,0,0,1,0,0]}function f3(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Ks(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function CP(n,e){const t=g3(e);at(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function g3(n){return n[0]*n[3]-n[1]*n[2]}const p3=[1e5,1e5,1e5,1e5,2,2];function m3(n){return"matrix("+n.join(", ")+")"}function Sv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function y3(n,e){const t=Sv(n),i=Sv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*p3[r])!==0)return!1;return!0}function Ho(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function RP(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let y=e;y<t;y+=i){const E=n[y]-h,T=n[y+1]-f;o[p++]=h+E*l-T*u,o[p++]=f+E*u+T*l;for(let I=y+2;I<y+i;++I)o[p++]=n[I]}return o&&o.length!=p&&(o.length=p),o}function _3(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const y=n[p]-u,E=n[p+1]-h;l[f++]=u+r*y,l[f++]=h+s*E;for(let T=p+2;T<p+i;++T)l[f++]=n[T]}return l&&l.length!=f&&(l.length=f),l}function v3(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const II=xr(),x3=[NaN,NaN];class w3 extends cs{constructor(){super(),this.extent_=Zi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=aP((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return tt()}closestPointXY(e,t,i,r){return tt()}containsXY(e,t){return this.closestPointXY(e,t,x3,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return tt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Rm(t),this.extentRevision_=this.getRevision()}return k5(this.extent_,e)}rotate(e,t){tt()}scale(e,t,i){tt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return tt()}getType(){return tt()}applyTransform(e){tt()}intersectsExtent(e){return tt()}translate(e,t){tt()}transform(e,t){const i=ai(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(u);Ks(II,h[0],h[3],f,-f,0,0,0);const p=Ho(s,0,s.length,l,II,o),y=Dp(i,t);return y?y(p,p,l):p}:Dp(i,t);return this.applyTransform(r),this}}class fx extends w3{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return sx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return tt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=CI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){tt()}setLayout(e,t,i){let r;if(e)r=CI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=E3(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();RP(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=fl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();_3(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();v3(i,0,i.length,r,e,t,i),this.changed()}}}function E3(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function CI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function T3(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Ho(i,0,i.length,r,e,t)}function RI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const y=((r-l)*h+(s-u)*f)/(h*h+f*f);if(y>1)p=t;else if(y>0){for(let E=0;E<i;++E)o[E]=xi(n[e+E],n[t+E],y);o.length=i;return}else p=e}for(let y=0;y<i;++y)o[y]=n[p+y];o.length=i}function AP(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Hc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function PP(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=AP(n,e,l,i,r),e=l}return r}function cq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=PP(n,e,l,i,r),e=l[l.length-1]}return r}function bP(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,y;if(r===0){if(y=Hc(o,l,n[e],n[e+1]),y<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,y}return h}f=f||[NaN,NaN];let E=e+i;for(;E<t;)if(RI(n,E-i,E,i,o,l,f),y=Hc(o,l,f[0],f[1]),y<h){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i,E+=i}else E+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(RI(n,t-i,e,i,o,l,f),y=Hc(o,l,f[0],f[1]),y<h)){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function kP(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const E=t[p];h=bP(n,e,E,i,r,s,o,l,u,h,f),e=E}return h}function uq(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const E=t[p];h=kP(n,e,E,i,r,s,o,l,u,h,f),e=E[E.length-1]}return h}function S3(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function DP(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function NP(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=DP(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function hq(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=NP(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function $c(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Np(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=$c(n,e,u,i,r[s]),e=u}return r.length=s,r}function AI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Np(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function PI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],y=0;const E=[0];for(let S=e+i;S<t;S+=i){const P=n[S],N=n[S+1];y+=Math.sqrt((P-f)*(P-f)+(N-p)*(N-p)),E.push(y),f=P,p=N}const T=r*y,I=x5(E,T);I<0?(u=(T-E[-I-2])/(E[-I-1]-E[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:xi(n[l+f],n[l+i+f],u);return s}function bI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const y=l+u>>1;r<n[(y+1)*i-1]?u=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(xi(n[(l-1)*i+y],n[l*i+y],p));return o.push(r),o}function dq(n,e,t,i,r,s,o){if(o)return bI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return bI(n,e,f,i,r,!1);e=f}}return null}function I3(n,e,t,i,r){return!fP(r,function(o){return!Qa(n,e,t,i,o[0],o[1])})}function Qa(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function gx(n,e,t,i,r,s){if(t.length===0||!Qa(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Qa(n,t[o-1],t[o],i,r,s))return!1;return!0}function fq(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(gx(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function C3(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function px(n,e,t,i,r,s){return s=s??dP(Zi(),n,e,t,i),ri(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:C3(n,e,t,i,function(o,l){return D5(r,o,l)}):!1}function gq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(px(n,e,t[s],i,r))return!0;e=t[s]}return!1}function MP(n,e,t,i,r){return!!(px(n,e,t,i,r)||Qa(n,e,t,i,r[0],r[1])||Qa(n,e,t,i,r[0],r[3])||Qa(n,e,t,i,r[2],r[1])||Qa(n,e,t,i,r[2],r[3]))}function LP(n,e,t,i,r){if(!MP(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(I3(n,t[s-1],t[s],i,r)&&!px(n,t[s-1],t[s],i,r))return!1;return!0}function pq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(LP(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function R3(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function mx(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),y=h.pop();let E=0;const T=n[y],I=n[y+1],S=n[p],P=n[p+1];for(let N=y+i;N<p;N+=i){const D=n[N],L=n[N+1],F=N5(D,L,T,I,S,P);F>E&&(f=N,E=F)}E>r&&(u[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function A3(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=mx(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function P3(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=Ua(n[e],r),y=Ua(n[e+1],r);if(e+=i,p==h&&y==f)continue;const E=h-l,T=f-u,I=p-l,S=y-u;if(E*S==T*I&&(E<0&&I<E||E==I||E>0&&I>E)&&(T<0&&S<T||T==S||T>0&&S>T)){h=p,f=y;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=y}return s[o++]=h,s[o++]=f,o}function yx(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=P3(n,e,f,i,r,s,o),l.push(o),e=f}return o}function mq(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=yx(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class pl extends fx{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new pl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Hc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return hP(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return uP(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=S3(this.flatCoordinates,0,e,this.stride),this.changed()}}const Hi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ml=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",b3=ml.includes("safari")&&!ml.includes("chrom");b3&&(ml.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ml));const k3=ml.includes("webkit")&&!ml.includes("edge"),OP=ml.includes("macintosh"),D3=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ei=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,FP=typeof Image<"u"&&Image.prototype.decode,VP=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),ze={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Qt(n,e,t,i){let r;return t&&t.length?r=t.shift():Ei?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let o0;function Mp(){return o0||(o0=Qt(1,1)),o0}function Lm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function kI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function N3(n){for(;n.lastChild;)n.lastChild.remove()}function M3(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function jP(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Go(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const _x=[NaN,NaN,NaN,0];let a0;function L3(){return a0||(a0=Qt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),a0}const O3=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,F3=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,V3=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,j3=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Mg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ed(n){throw new Error('failed to parse "'+n+'" as color')}function UP(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(F3)||n.match(O3)||n.match(V3);if(s){const o=s[4],l=100/255;return[Dt(Mg(s[1],l)+.5|0,0,255),Dt(Mg(s[2],l)+.5|0,0,255),Dt(Mg(s[3],l)+.5|0,0,255),o!==void 0?Dt(Mg(o,100),0,1):1]}ed(n)}if(n.startsWith("#")){if(j3.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}ed(n)}const e=L3();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ed(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return UP(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=Qd(r[3]/255,3),r}function U3(n){return typeof n=="string"?n:xx(n)}const z3=1024,Ih={};let l0=0;function B3(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function c0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function u0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function h0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function d0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function DI(n){const e=h0(n[0]),t=h0(n[1]),i=h0(n[2]),r=d0(e*.222488403+t*.716873169+i*.06060791),s=500*(d0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-d0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function G3(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=u0(e),s=u0(e+t/500*Math.cos(i)),o=u0(e-t/200*Math.sin(i)),l=c0(s*3.021973625-r*1.617392459-o*.404875592),u=c0(s*-.943766287+r*1.916279586+o*.027607165),h=c0(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(u+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function vx(n){if(n==="none")return _x;if(Ih.hasOwnProperty(n))return Ih[n];if(l0>=z3){let t=0;for(const i in Ih)(t++&3)===0&&(delete Ih[i],--l0)}const e=UP(n);e.length!==4&&ed(n);for(const t of e)isNaN(t)&&ed(n);return Ih[n]=e,++l0,e}function uu(n){return Array.isArray(n)?n:vx(n)}function xx(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function W3(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Rp(i,Be.LOAD,function(){o=!0,s||e()})];return i.src&&FP?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(Rp(i,Be.ERROR,t)),function(){r=!1,l.forEach(Rt)}}function $3(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function K3(n,e){return e&&(n.src=e),n.src&&FP?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):$3(n)}class H3{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=f0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=f0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=f0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===ze.IDLE&&r.load(),r.getImageState()===ze.LOADING?r.ready().then(()=>{this.patternCache_[o]=Mp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Mp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function f0(n,e,t){const i=t?uu(t):"null";return e+":"+n+":"+i}const qi=new H3;let Ch=null;class zP extends Cm{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?ze.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ze.LOADED){Ch||(Ch=Qt(1,1,void 0,{willReadFrequently:!0})),Ch.drawImage(this.image_,0,0);try{Ch.getImageData(0,0,1,1),this.tainted_=!1}catch{Ch=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Be.CHANGE)}handleImageError_(){this.imageState_=ze.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ze.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Qt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ze.IDLE){this.image_||this.initializeImage_(),this.imageState_=ze.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&K3(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ze.LOADED)return;const t=this.image_,i=Qt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=U3(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)e();else{const t=()=>{(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)&&(this.removeEventListener(Be.CHANGE,t),e())};this.addEventListener(Be.CHANGE,t)}})),this.ready_}}function Lp(n,e,t,i,r,s){let o=e===void 0?void 0:qi.get(e,t,r);return o||(o=new zP(n,n&&"src"in n?n.src||void 0:e,t,i,r),qi.set(e,t,r,o,s)),s&&o&&!qi.getPattern(e,t,r)&&qi.set(e,t,r,o,s),o}function Zr(n){return n?Array.isArray(n)?xx(n):typeof n=="object"&&"src"in n?q3(n):n:null}function q3(n){if(!n.offset||!n.size)return qi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=qi.getPattern(e,void 0,n.color);if(t)return t;const i=qi.get(n.src,"anonymous",null);if(i.getImageState()!==ze.LOADED)return null;const r=Qt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Lp(r.canvas,e,void 0,ze.LOADED,n.color,!0),qi.getPattern(e,void 0,n.color)}class BP{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Lg="ol-hidden",ef="ol-unselectable",wx="ol-control",NI="ol-collapsed",X3=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),MI=["style","variant","weight","size","lineHeight","family"],Iv={normal:400,bold:700},Cv=function(n){const e=n.match(X3);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=MI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[MI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Iv&&(t.weight=Iv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},GP="10px sans-serif",ti="#000",hu="round",Bs=[],Gs=0,du="round",wd=10,Ed="#000",Td="center",Op="middle",Ja=[0,0,0,0],Sd=1,kc=new cs;let Rh=null,LI;const Rv={},Y3=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function Z3(n,e,t){return`${n} ${e} 16px "${t}"`}const Q3=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Cv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Iv[f.weight]||f.weight;return p===u&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=kc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(Yd(Rv),kc.set(h,100)):(f+=10,kc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ei?self.fonts:document.fonts);const o=Cv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(Y3.has(h))continue;const f=Z3(o.style,o.weight,h);kc.get(f)===void 0&&(kc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),J3=(function(){let n;return function(e){let t=Rv[e];if(t==null){if(Ei){const i=Cv(e),r=WP(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Rv[e]=t}return t}})();function WP(n,e){return Rh||(Rh=Qt(1,1)),n!=LI&&(Rh.font=n,LI=Rh.font),Rh.measureText(e)}function $P(n,e){return WP(n,e).width}function OI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,$P(n,s)),0);return t[e]=i,i}function e4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const y=e[h+1]||n.font,E=$P(y,p);t.push(E),o+=E;const T=J3(y);i.push(T),u=Math.max(u,T)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function t4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),n4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function n4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class i4 extends BP{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Qd(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=xr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Ho(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const y=s[f]-this.imageAnchorX_,E=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const T=y+this.imageAnchorX_,I=E+this.imageAnchorY_;Ks(l,T,I,1,1,h,-T,-I),o.save(),o.transform.apply(o,l),o.translate(T,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,E,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Ho(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Ho(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=T3(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ri(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),oa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Td;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Zr(i||ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Bs;this.strokeState_={lineCap:r!==void 0?r:hu,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Gs)*this.pixelRatio_,lineJoin:l!==void 0?l:du,lineWidth:(u!==void 0?u:Sd)*this.pixelRatio_,miterLimit:h!==void 0?h:wd,strokeStyle:Zr(i||Ed)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const E=t.getColor();this.textFillState_={fillStyle:Zr(E||ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const E=i.getColor(),T=i.getLineCap(),I=i.getLineDash(),S=i.getLineDashOffset(),P=i.getLineJoin(),N=i.getWidth(),D=i.getMiterLimit();this.textStrokeState_={lineCap:T!==void 0?T:hu,lineDash:I||Bs,lineDashOffset:S||Gs,lineJoin:P!==void 0?P:du,lineWidth:N!==void 0?N:Sd,miterLimit:D!==void 0?D:wd,strokeStyle:Zr(E||Ed)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:GP,textAlign:p!==void 0?p:Td,textBaseline:y!==void 0?y:Op},this.text_=f!==void 0?Array.isArray(f)?f.reduce((E,T,I)=>E+=I%2?" ":T,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const r4=.5,KP={Point:d4,LineString:c4,Polygon:g4,MultiPoint:f4,MultiLineString:u4,MultiPolygon:h4,GeometryCollection:l4,Circle:o4};function s4(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function FI(n,e){const t=HP(n,e);return t*t}function HP(n,e){return r4*n/e}function o4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function VI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let y=!0;const E=h.getImageState();E==ze.LOADED||E==ze.ERROR?y=!1:E==ze.IDLE&&h.load(),y&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),a4(n,e,t,i,s,o,l),p}function a4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())qP(n,u,t,e,o);else{const f=KP[u.getType()];f(n,u,t,e,o,s)}}function qP(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)qP(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function l4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=KP[o[l].getType()];h(n,o[l],t,i,r,s)}}function c4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function u4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function h4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function d4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=ze.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function f4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=ze.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function g4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let p4=!1;function m4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=p4,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function jI(n,e){return function(t,i,r,s,o){m4(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function y4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function _4(n,e,t,i){const r=[];let s=Zi();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=sx(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function Ex(n,e,t,i,r,s,o){let l,u,h,f,p,y,E;const T=r[s+1],I=[];for(let N=0,D=t.length;N<D;++N){const L=t[N];for(f=n[L-i],y=n[L-i+1],l=e;l<L;l+=i)p=n[l],E=n[l+1],(T<=y&&E<=T||y<=T&&T<=E)&&(h=(T-y)/(E-y)*(p-f)+f,I.push(h)),f=p,y=E}let S=NaN,P=-1/0;for(I.sort(zs),f=I[0],l=1,u=I.length;l<u;++l){p=I[l];const N=Math.abs(p-f);N>P&&(h=(f+p)/2,gx(n,e,t,i,h,T)&&(S=h,P=N)),f=p}return isNaN(S)&&(S=r[s]),o?(o.push(S,T,P),o):[S,T,P]}function v4(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=Ex(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function x4(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function Tx(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function XP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=Tx(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function yq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!XP(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Av(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=Tx(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&x4(n,e,l,i),e=l}return e}function _q(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Av(n,e,t[s],i,r);return e}function w4(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=Tx(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function YP(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function ZP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=YP(n,e,l,i),e=l}return r}function vq(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=ZP(n,e,l,i),e=l[l.length-1]}return r}class Id extends fx{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Id(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<cP(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(AP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return YP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=mx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Id(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=DP(this.flatCoordinates,0,e,this.stride),this.changed()}}class Cd extends fx{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?ix(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Cd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<cP(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(PP(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),kP(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return gx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return ZP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Av(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Np(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=fl(this.getExtent());this.flatInteriorPoint_=Ex(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Id(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Id(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;XP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Av(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=yx(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Cd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return LP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=NP(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function UI(n){if(km(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Cd(s,"XY",[s.length])}const zI=xr();class dr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?hP(this.flatCoordinates_):sx(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=fl(this.getExtent());this.flatInteriorPoints_=Ex(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=w4(this.flatCoordinates_,this.ends_),t=_4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=v4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=PI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=PI(e,t,o,2,.5);ix(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ai(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Ks(zI,i[0],i[3],r,-r,0,0,0),Ho(this.flatCoordinates_,0,this.flatCoordinates_.length,2,zI,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new dr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=aP((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=mx(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=A3(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=yx(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new dr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}dr.prototype.getFlatCoordinates=dr.prototype.getOrientedFlatCoordinates;function QP(n,e,t=0,i=n.length-1,r=E4){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),E=Math.max(t,Math.floor(e-h*p/u+y)),T=Math.min(i,Math.floor(e+(u-h)*p/u+y));QP(n,e,E,T,r)}const s=n[e];let o=t,l=i;for(Ah(n,t,e),r(n[i],s)>0&&Ah(n,t,i);o<l;){for(Ah(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Ah(n,t,l):(l++,Ah(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Ah(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function E4(n,e){return n<e?-1:n>e?1:0}let JP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Fg(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;Fg(e,u)&&(t.leaf?i.push(l):p0(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!Fg(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Fg(e,o)){if(t.leaf||p0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Dc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=T4(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&p0(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Dc(e.slice(t,i+1)),vc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Dc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));BI(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);BI(e,f,p,u,this.compareMinY);for(let y=f;y<=p;y+=u){const E=Math.min(y+u-1,p);l.children.push(this._build(e,y,E,r-1))}}return vc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=g0(h),p=C4(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Bh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Dc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,vc(i,this.toBBox),vc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Dc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,vc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=zh(e,0,l,this.toBBox),h=zh(e,l,i,this.toBBox),f=R4(u,h),p=g0(u)+g0(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:S4,s=e.leaf?this.compareMinY:I4,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=zh(e,0,t,s),l=zh(e,i-t,i,s);let u=Og(o)+Og(l);for(let h=t;h<i-t;h++){const f=e.children[h];Bh(o,e.leaf?s(f):f),u+=Og(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Bh(l,e.leaf?s(f):f),u+=Og(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Bh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():vc(e[t],this.toBBox)}};function T4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function vc(n,e){zh(n,0,n.children.length,e,n)}function zh(n,e,t,i,r){r||(r=Dc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Bh(r,n.leaf?i(o):o)}return r}function Bh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function S4(n,e){return n.minX-e.minX}function I4(n,e){return n.minY-e.minY}function g0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Og(n){return n.maxX-n.minX+(n.maxY-n.minY)}function C4(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function R4(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function p0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Fg(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Dc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function BI(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;QP(n,o,e,t,r),s.push(e,o,o,t)}}class GI{constructor(e){this.rbush_=new JP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[it(l)]=u}this.rbush_.load(i)}remove(e){const t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];vd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return su(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ea(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class eb extends cs{constructor(e){super(),this.projection=ai(e.projection),this.attributions_=WI(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=WI(e),this.changed()}setState(e){this.state_=e,this.changed()}}function WI(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Bi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class So extends Ys{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class Sx extends eb{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=_d,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(at(this.format_,"`format` must be set when `url` is set"),this.loader_=jI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:y4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new GI:null,this.loadedExtentsRtree_=new GI,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Ki(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=it(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new So(Bi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof dr||(this.featureChangeKeys_[e]=[nt(t,Be.CHANGE,this.handleFeatureChange_,this),nt(t,ru.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof dr){const s=this.idIndex_[r];s instanceof dr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(at(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=it(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=it(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Bi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new So(Bi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Bi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Bi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ei.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ei.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new So(Bi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof dr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof dr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),su(this.nullGeometryFeatures_)||ix(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=mP(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||yd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof dr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const y=Math.sqrt(l);u[0]=i-y,u[1]=r-y,u[2]=i+y,u[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=it(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new So(Bi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:it(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&su(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Uh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new So(Bi.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new So(Bi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new So(Bi.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(vd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=it(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Rt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Bi.REMOVEFEATURE)&&this.dispatchEvent(new So(Bi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){at(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(jI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Tr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Tr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Lp(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===ze.IDLE&&t.load(),t.getImageState()===ze.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?it(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:uu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class bu{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new bu({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function $I(n){return n[0]>0&&n[1]>0}function A4(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function oi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Om{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=oi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Om({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return tt()}getImage(e){return tt()}getHitDetectionImage(){return tt()}getPixelRatio(e){return 1}getImageState(){return tt()}getImageSize(){return tt()}getOrigin(){return tt()}getSize(){return tt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e)}listenImageChange(e){tt()}load(){tt()}unlistenImageChange(e){tt()}ready(){return Promise.resolve()}}class Fm extends Om{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ze.LOADING:ze.LOADED,this.imageState_===ze.LOADING&&this.ready().then(()=>this.imageState_=ze.LOADED),this.render()}clone(){const e=this.getScale(),t=new Fm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=qi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Qt(o,o);this.draw_(s,l,e),r=l.canvas,qi.set(i,null,null,new zP(r,void 0,null,ze.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const B=r;r=s,s=B}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),y=p/u;if(e==="miter"&&y<=i)return y*t;const E=t/2/y,T=t/2*(f/p),S=Math.sqrt((r+E)*(r+E)+T*T)-r;if(this.radius2_===void 0||e==="bevel")return S*2;const P=r*Math.sin(l),N=Math.sqrt(r*r-P*P),D=s-N,F=Math.sqrt(P*P+D*D)/P;if(F<=i){const B=F*t/2-s-r;return 2*Math.max(S,B)}return S*2}createRenderOptions(){let e=hu,t=du,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Zr(this.stroke_.getColor()??Ed),l=this.stroke_.getWidth()??Sd,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??du,e=this.stroke_.getLineCap()??hu,i=this.stroke_.getMiterLimit()??wd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ti),t.fillStyle=Zr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=uu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Qt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class kl extends Fm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new kl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Yi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=KI,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Yi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=KI,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function P4(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(at(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let m0=null;function tb(n,e){if(!m0){const t=new Tr({color:"rgba(255,255,255,0.4)"}),i=new bu({color:"#3399CC",width:1.25});m0=[new Yi({image:new kl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return m0}function KI(n){return n.getGeometry()}const b4="#333";class tf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=oi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Tr({color:b4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new tf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Tr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Mn={ANIMATING:0,INTERACTING:1},Ie={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Vg=[Ie.FILL],Wo=[Ie.STROKE],el=[Ie.BEGIN_PATH],HI=[Ie.CLOSE_PATH];class nf extends BP{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],au(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const y=this.tmpCoordinate_;let E=!0,T,I,S;for(T=t+r;T<i;T+=r)y[0]=e[T],y[1]=e[T+1],S=mv(h,y),S!==I?(E&&(l[u++]=f,l[u++]=p,E=!1),l[u++]=y[0],l[u++]=y[1]):S===an.INTERSECTING?(l[u++]=y[0],l[u++]=y[1],E=!1):E=!0,f=y[0],p=y[1],I=S;return(s&&E||T===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,y,E;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const T=e.getEndss();E=0;for(let I=0,S=T.length;I<S;++I){const P=[];E=this.drawCustomCoordinates_(h,E,T[I],l,P),y.push(P)}this.instructions.push([Ie.CUSTOM,u,y,e,i,AI,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,y,e,r||i,AI,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),E=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([Ie.CUSTOM,u,p,e,i,Np,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,p,e,r||i,Np,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Ie.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,$c,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Ie.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,$c,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Ie.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ie.END_GEOMETRY?o=t:s==Ie.BEGIN_GEOMETRY&&(r[2]=t,E5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Zr(i||ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Zr(i||Ed);const r=e.getLineCap();t.lineCap=r!==void 0?r:hu;const s=e.getLineDash();t.lineDash=s?s.slice():Bs;const o=e.getLineDashOffset();t.lineDashOffset=o||Gs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:du;const u=e.getWidth();t.lineWidth=u!==void 0?u:Sd;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:wd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ie.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ie.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!oa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ie.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=lP(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;rx(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class k4 extends nf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!au(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||au(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class D4 extends nf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Ie.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs],el);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(Wo),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs],el);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push(Wo),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Wo),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Wo),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(el)}}class qI extends nf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(el),this.hitDetectionInstructions.push(el);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),E=[Ie.MOVE_TO_LINE_TO,p,y];this.instructions.push(E),this.hitDetectionInstructions.push(E),l&&(this.instructions.push(HI),this.hitDetectionInstructions.push(HI)),t=f}return o&&(this.instructions.push(Vg),this.hitDetectionInstructions.push(Vg)),l&&(this.instructions.push(Wo),this.hitDetectionInstructions.push(Wo)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Ie.CIRCLE,h];this.instructions.push(el,f),this.hitDetectionInstructions.push(el,f),r.fillStyle!==void 0&&(this.instructions.push(Vg),this.hitDetectionInstructions.push(Vg)),r.strokeStyle!==void 0&&(this.instructions.push(Wo),this.hitDetectionInstructions.push(Wo)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function N4(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],y=e[o+r+1],E=Math.sqrt((p-h)*(p-h)+(y-f)*(y-f));if(l+=E,l>=n){const T=(n-l+E)/E,I=xi(h,p,T),S=xi(f,y,T);u.push(I,S),s.push(u),u=[I,S],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const T=E-l,I=xi(h,p,T/E),S=xi(f,y,T/E);u.push(I,S),s.push(u),u=[I,S],l=0,o+=r}}return l>0&&s.push(u),s}function M4(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,y,E,T,I,S,P,N,D;for(p=t;p<i;p+=r){const L=e[p],F=e[p+1];T!==void 0&&(N=L-T,D=F-I,E=Math.sqrt(N*N+D*D),S!==void 0&&(u+=y,f=Math.acos((S*N+P*D)/(y*E)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),y=E,S=N,P=D),T=L,I=F}return u+=E,u>l?[h,p]:[s,o]}const Fp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class L4 extends nf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ti]={fillStyle:ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ri(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const S=e.getEndss();y=[];for(let P=0,N=S.length;P<N;++P)y.push(S[P][0])}this.beginGeometry(e,t,i);const E=o.repeat,T=E?void 0:o.textAlign;let I=0;for(let S=0,P=y.length;S<P;++S){let N;E?N=N4(E*this.resolution,f,I,y[S],p):N=[f.slice(I,y[S])];for(let D=0,L=N.length;D<L;++D){const F=N[D];let B=0,b=F.length;if(T==null){const M=M4(o.maxAngle,F,0,F.length,2);B=M[0],b=M[1]}for(let M=B;M<b;M+=p)l.push(F[M],F[M+1]);const R=l.length;I=y[S],this.drawChars_(u,R),u=R}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();f=[];for(let F=0,B=L.length;F<B;F+=3)o.overflow||y.push(L[F+2]/this.resolution),f.push(L[F],L[F+1]);if(f.length===0)return;p=2;break}const E=this.appendFlatPointCoordinates(f,p);if(E===u)return;if(y&&(E-u)/2!==f.length/p){let L=u/2;y=y.filter((F,B)=>{const b=l[(L+B)*2]===f[B*p]&&l[(L+B)*2+1]===f[B*p+1];return b||--L,b})}this.saveTextStates_();const T=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let S=o.padding;if(S!=Ja&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],F=o.padding[1],B=o.padding[2],b=o.padding[3];o.scale[0]<0&&(F=-F,b=-b),o.scale[1]<0&&(L=-L,B=-B),S=[L,F,B,b]}const P=this.pixelRatio;this.instructions.push([Ie.DRAW_IMAGE,u,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,S==Ja?Ja:S.map(function(L){return L*P}),T,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const N=1/P,D=T?T.slice(0):null;D&&(D[1]=ti),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,u,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[N,N],NaN,this.declutterMode_,this.declutterImageWithText_,S,D,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Td,justify:t.justify,textBaseline:t.textBaseline||Op,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Fp[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,y*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l&&ti,r.maxAngle,u,f,s,y*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Zr(o.getColor()||ti)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),S=l.getLineDashOffset(),P=l.getWidth(),N=l.getMiterLimit();s.lineCap=l.getLineCap()||hu,s.lineDash=I?I.slice():Bs,s.lineDashOffset=S===void 0?Gs:S,s.lineJoin=l.getLineJoin()||du,s.lineWidth=P===void 0?Sd:P,s.miterLimit=N===void 0?wd:N,s.strokeStyle=Zr(l.getColor()||Ed)}i=this.textState_;const u=e.getFont()||GP;Q3(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Op,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Ja,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),y=e.getRotateWithView(),E=e.getKeepUpright(),T=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=E===void 0?!0:E,this.textRotation_=T===void 0?0:T,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+it(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const O4={Circle:qI,Default:nf,Image:k4,LineString:D4,Polygon:qI,Text:L4};class F4{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=O4[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function V4(n,e,t,i,r,s,o,l,u,h,f,p,y=!0){let E=n[e],T=n[e+1],I=0,S=0,P=0,N=0;function D(){I=E,S=T,e+=i,E=n[e],T=n[e+1],N+=P,P=Math.sqrt((E-I)*(E-I)+(T-S)*(T-S))}do D();while(e<t-i&&N+P<s);let L=P===0?0:(s-N)/P;const F=xi(I,E,L),B=xi(S,T,L),b=e-i,R=N,M=s+l*u(h,r,f);for(;e<t-i&&N+P<M;)D();L=P===0?0:(M-N)/P;const V=xi(I,E,L),j=xi(S,T,L);let z=!1;if(y)if(p){const ue=[F,B,V,j];RP(ue,0,4,2,p,ue,ue),z=ue[0]>ue[2]}else z=F>V;const k=Math.PI,re=[],pe=b+i===e;e=b,P=0,N=R,E=n[e],T=n[e+1];let ge;if(pe){D(),ge=Math.atan2(T-S,E-I),z&&(ge+=ge>0?-k:k);const ue=(V+F)/2,Q=(j+B)/2;return re[0]=[ue,Q,(M-s)/2,ge,r],re}r=r.replace(/\n/g," ");for(let ue=0,Q=r.length;ue<Q;){D();let oe=Math.atan2(T-S,E-I);if(z&&(oe+=oe>0?-k:k),ge!==void 0){let xe=oe-ge;if(xe+=xe>k?-2*k:xe<-k?2*k:0,Math.abs(xe)>o)return null}ge=oe;const ne=ue;let W=0;for(;ue<Q;++ue){const xe=z?Q-ue-1:ue,be=l*u(h,r[xe],f);if(e+i<t&&N+P<s+W+be/2)break;W+=be}if(ue===ne)continue;const $=z?r.substring(Q-ne,Q-ue):r.substring(ne,ue);L=P===0?0:(s+W/2-N)/P;const ie=xi(I,E,L),me=xi(S,T,L);re.push([ie,me,W/2,oe,$]),s+=W}return re}class nb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Mp(),{get:(e,t)=>{if(typeof Mp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const xc=Zi(),Io=[],bs=[],ks=[],Co=[];function XI(n){return n[3].declutterBox}const YI=new RegExp("[-----]");function y0(n,e){return e==="start"?e=YI.test(n)?"right":"left":e==="end"&&(e=YI.test(n)?"left":"right"),Fp[e]}function j4(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function U4(n,e,t){return t%2===0&&(n+=e),n}class z4{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=xr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new nb:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?Fp[u.justify]:y0(Array.isArray(e)?e[0]:e,u.textAlign||Td),y=r&&o.lineWidth?o.lineWidth:0,E=Array.isArray(e)?e:String(e).split(`
`).reduce(j4,[]),{width:T,height:I,widths:S,heights:P,lineWidths:N}=e4(u,E),D=T+y,L=[],F=(D+2)*f[0],B=(I+y)*f[1],b={width:F<0?Math.floor(F):Math.ceil(F),height:B<0?Math.floor(B):Math.ceil(B),contextInstructions:L};(f[0]!=1||f[1]!=1)&&L.push("scale",f),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",y),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",l.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const R=.5-p;let M=p*D+R*y;const V=[],j=[];let z=0,k=0,re=0,pe=0,ge;for(let ue=0,Q=E.length;ue<Q;ue+=2){const oe=E[ue];if(oe===`
`){k+=z,z=0,M=p*D+R*y,++pe;continue}const ne=E[ue+1]||u.font;ne!==ge&&(r&&V.push("font",ne),i&&j.push("font",ne),ge=ne),z=Math.max(z,P[re]);const W=[oe,M+R*S[re]+p*(S[re]-N[pe]),.5*(y+z)+k];M+=S[re],r&&V.push("strokeText",W),i&&j.push("fillText",W),++re}return Array.prototype.push.apply(L,V),Array.prototype.push.apply(L,j),this.labels_[s]=b,b}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,y,E,T,I,S){l*=y[0],u*=y[1];let P=i-l,N=r-u;const D=s+h>e?e-h:s,L=o+f>t?t-f:o,F=T[3]+D*y[0]+T[1],B=T[0]+L*y[1]+T[2],b=P-T[3],R=N-T[0];(I||p!==0)&&(Io[0]=b,Co[0]=b,Io[1]=R,bs[1]=R,bs[0]=b+F,ks[0]=bs[0],ks[1]=R+B,Co[1]=ks[1]);let M;return p!==0?(M=Ks(xr(),i,r,1,1,p,-i,-r),un(M,Io),un(M,bs),un(M,ks),un(M,Co),ea(Math.min(Io[0],bs[0],ks[0],Co[0]),Math.min(Io[1],bs[1],ks[1],Co[1]),Math.max(Io[0],bs[0],ks[0],Co[0]),Math.max(Io[1],bs[1],ks[1],Co[1]),xc)):ea(Math.min(b,b+F),Math.min(R,R+B),Math.max(b,b+F),Math.max(R,R+B),xc),E&&(P=Math.round(P),N=Math.round(N)),{drawImageX:P,drawImageY:N,drawImageW:D,drawImageH:L,originX:h,originY:f,declutterBox:{minX:xc[0],minY:xc[1],maxX:xc[2],maxY:xc[3],value:S},canvasTransform:M,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Io,bs,ks,Co,o,l),t4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=y0(Array.isArray(e)?e[0]:e,s.textAlign||Td),f=Fp[s.textBaseline||Op],p=l&&l.lineWidth?l.lineWidth:0,y=o.width/u-2*s.scale[0],E=h*y+2*(.5-h)*p,T=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:E,anchorY:T}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&oa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Ho(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),f3(this.renderedTransform_,i));let p=0;const y=r.length;let E=0,T,I,S,P,N,D,L,F,B,b,R,M,V,j=0,z=0;const k=this.coordinateCache_,re=this.viewRotation_,pe=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:re},ue=this.instructions!=r||this.overlaps?0:200;let Q,oe,ne,W;for(;p<y;){const $=r[p];switch($[0]){case Ie.BEGIN_GEOMETRY:Q=$[1],W=$[3],Q.getGeometry()?l!==void 0&&!ri(l,W.getExtent())?p=$[2]+1:++p:p=$[2],h&&(h.zIndex=$[4]);break;case Ie.BEGIN_PATH:j>ue&&(this.fill_(e),j=0),z>ue&&(e.stroke(),z=0),!j&&!z&&(e.beginPath(),N=NaN,D=NaN),++p;break;case Ie.CIRCLE:E=$[1];const me=f[E],xe=f[E+1],be=f[E+2],Me=f[E+3],Ve=be-me,Ge=Me-xe,lt=Math.sqrt(Ve*Ve+Ge*Ge);e.moveTo(me+lt,xe),e.arc(me,xe,lt,0,2*Math.PI,!0),++p;break;case Ie.CLOSE_PATH:e.closePath(),++p;break;case Ie.CUSTOM:E=$[1],T=$[2];const Qi=$[3],ds=$[4],Wn=$[5];ge.geometry=Qi,ge.feature=Q,p in k||(k[p]=[]);const $n=k[p];Wn?Wn(f,E,T,2,$n):($n[0]=f[E],$n[1]=f[E+1],$n.length=2),h&&(h.zIndex=$[6]),ds($n,ge),++p;break;case Ie.DRAW_IMAGE:E=$[1],T=$[2],B=$[3],I=$[4],S=$[5];let hn=$[6];const dn=$[7],Kn=$[8],Ri=$[9],yt=$[10];let ct=$[11];const tn=$[12];let Ai=$[13];P=$[14]||"declutter";const St=$[15];if(!B&&$.length>=20){b=$[19],R=$[20],M=$[21],V=$[22];const Ot=this.drawLabelWithPointPlacement_(b,R,M,V);B=Ot.label,$[3]=B;const ki=$[23];I=(Ot.anchorX-ki)*this.pixelRatio,$[4]=I;const fn=$[24];S=(Ot.anchorY-fn)*this.pixelRatio,$[5]=S,hn=B.height,$[6]=hn,Ai=B.width,$[13]=Ai}let eo;$.length>25&&(eo=$[25]);let Pi,Cr,Ji;$.length>17?(Pi=$[16],Cr=$[17],Ji=$[18]):(Pi=Ja,Cr=null,Ji=null),yt&&pe?ct+=re:!yt&&!pe&&(ct-=re);let Rr=0;for(;E<T;E+=2){if(eo&&eo[Rr++]<Ai/this.pixelRatio)continue;const Ot=this.calculateImageOrLabelDimensions_(B.width,B.height,f[E],f[E+1],Ai,hn,I,S,Kn,Ri,ct,tn,s,Pi,!!Cr||!!Ji,Q),ki=[e,t,B,Ot,dn,Cr,Ji];if(u){let fn,Ft,gn;if(St){const rt=T-E;if(!St[rt]){St[rt]={args:ki,declutterMode:P};continue}const Bt=St[rt];fn=Bt.args,Ft=Bt.declutterMode,delete St[rt],gn=XI(fn)}let pn,nn;if(fn&&(Ft!=="declutter"||!u.collides(gn))&&(pn=!0),(P!=="declutter"||!u.collides(Ot.declutterBox))&&(nn=!0),Ft==="declutter"&&P==="declutter"){const rt=pn&&nn;pn=rt,nn=rt}pn&&(Ft!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),nn&&(P!=="none"&&u.insert(Ot.declutterBox),this.replayImageOrLabel_.apply(this,ki))}else this.replayImageOrLabel_.apply(this,ki)}++p;break;case Ie.DRAW_CHARS:const ca=$[1],Ar=$[2],bi=$[3],Ol=$[4];V=$[5];const Pr=$[6],fs=$[7],to=$[8];M=$[9];const On=$[10];b=$[11],Array.isArray(b)&&(b=b.reduce(U4,"")),R=$[12];const gs=[$[13],$[13]];P=$[14]||"declutter";const br=$[15],kr=this.textStates[R],Fn=kr.font,Vn=[kr.scale[0]*fs,kr.scale[1]*fs];let ft;Fn in this.widths_?ft=this.widths_[Fn]:(ft={},this.widths_[Fn]=ft);const no=R3(f,ca,Ar,2),er=Math.abs(Vn[0])*OI(Fn,b,ft);if(Ol||er<=no){const Ot=this.textStates[R].textAlign,ki=(no-er)*y0(b,Ot),fn=V4(f,ca,Ar,2,b,ki,Pr,Math.abs(Vn[0]),OI,Fn,ft,pe?0:this.viewRotation_,br);e:if(fn){const Ft=[];let gn,pn,nn,rt,Bt;if(M)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,"",M),I=Bt[2]+(Vn[0]<0?-On:On),S=bi*rt.height+(.5-bi)*2*On*Vn[1]/Vn[0]-to;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,I,S,0,0,Bt[3],gs,!1,Ja,!1,Q);if(u&&P==="declutter"&&u.collides(qt.declutterBox))break e;Ft.push([e,t,rt,qt,1,null,null])}if(V)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,V,""),I=Bt[2],S=bi*rt.height-to;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,I,S,0,0,Bt[3],gs,!1,Ja,!1,Q);if(u&&P==="declutter"&&u.collides(qt.declutterBox))break e;Ft.push([e,t,rt,qt,1,null,null])}u&&P!=="none"&&u.load(Ft.map(XI));for(let qt=0,Di=Ft.length;qt<Di;++qt)this.replayImageOrLabel_.apply(this,Ft[qt])}}++p;break;case Ie.END_GEOMETRY:if(o!==void 0){Q=$[1];const Ot=o(Q,W,P);if(Ot)return Ot}++p;break;case Ie.FILL:ue?j++:this.fill_(e),++p;break;case Ie.MOVE_TO_LINE_TO:for(E=$[1],T=$[2],oe=f[E],ne=f[E+1],e.moveTo(oe,ne),N=oe+.5|0,D=ne+.5|0,E+=2;E<T;E+=2)oe=f[E],ne=f[E+1],L=oe+.5|0,F=ne+.5|0,(E==T-2||L!==N||F!==D)&&(e.lineTo(oe,ne),N=L,D=F);++p;break;case Ie.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],j&&(this.fill_(e),j=0,z&&(e.stroke(),z=0)),e.fillStyle=$[1],++p;break;case Ie.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,$),++p;break;case Ie.STROKE:ue?z++:e.stroke(),++p;break;default:++p;break}}j&&this.fill_(e),z&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const $a=["Polygon","Circle","LineString","Image","Text","Default"],ib=["Image","Text"],B4=$a.filter(n=>!ib.includes(n));class G4{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=xr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new z4(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Ks(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Qt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=Zi(),Jh(p,e),rx(p,t*(this.renderBuffer_+r),p));const y=W4(r);let E;function T(F,B,b){const R=f.getImageData(0,0,l,l).data;for(let M=0,V=y.length;M<V;M++)if(R[y[M]]>0){if(!o||b==="none"||E!=="Image"&&E!=="Text"||o.includes(F)){const j=(y[M]-3)/4,z=r-j%l,k=r-(j/l|0),re=s(F,B,z*z+k*k);if(re)return re}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(zs);let S,P,N,D,L;for(S=I.length-1;S>=0;--S){const F=I[S].toString();for(N=this.executorsByZIndex_[F],P=$a.length-1;P>=0;--P)if(E=$a[P],D=N[E],D!==void 0&&(L=D.executeHitDetection(f,u,i,T,p),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Ho(l,0,8,2,e,l),l}isEmpty(){return su(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?w5:zs),o=o||$a;const h=$a.length;for(let f=0,p=u.length;f<p;++f){const y=u[f].toString(),E=this.executorsByZIndex_[y];for(let T=0,I=o.length;T<I;++T){const S=o[T],P=E[S];if(P!==void 0){const N=l===null?void 0:P.getZIndexContext(),D=N?N.getContext():e,L=this.maxExtent_&&S!=="Image"&&S!=="Text";if(L&&(D.save(),this.clip(D,i)),!N||S==="Text"||S==="Image"?P.execute(D,t,i,r,s,l):N.pushFunction(F=>P.execute(F,t,i,r,s,l)),L&&D.restore(),N){N.offset();const F=u[f]*h+$a.indexOf(S);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(N)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(zs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const _0={};function W4(n){if(_0[n]!==void 0)return _0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return _0[n]=r,r}function ZI(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let Ix=class rb extends Om{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;at(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||it(o)),at(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),at(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=ze.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?ze.LOADED:ze.IDLE:u=ze.LOADING:u=ze.LOADED),this.color_=e.color!==void 0?uu(e.color):null,this.iconImage_=Lp(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const E=this.iconImage_.getSize();this.setScale(ZI(E[0],E[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(ZI(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new rb({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Lp(null,e,this.crossOrigin_,ze.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Be.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Be.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Xr=.5;function $4(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Xr,p=n[1]*Xr,y=Qt(f,p);y.imageSmoothingEnabled=!1;const E=y.canvas,T=new i4(y,Xr,r,null,o,l,null),I=t.length,S=Math.floor((256*256*256-1)/I),P={};for(let D=1;D<=I;++D){const L=t[D-1],F=L.getStyleFunction()||i;if(!F)continue;let B=F(L,s);if(!B)continue;Array.isArray(B)||(B=[B]);const R=(D*S).toString(16).padStart(7,"#00000");for(let M=0,V=B.length;M<V;++M){const j=B[M],z=j.getGeometryFunction()(L);if(!z||!ri(h,z.getExtent()))continue;const k=j.clone(),re=k.getFill();re&&re.setColor(R);const pe=k.getStroke();pe&&(pe.setColor(R),pe.setLineDash(null)),k.setText(void 0);const ge=j.getImage();if(ge){const ne=ge.getImageSize();if(!ne)continue;const W=Qt(ne[0],ne[1],void 0,{alpha:!1}),$=W.canvas;W.fillStyle=R,W.fillRect(0,0,$.width,$.height),k.setImage(new Ix({img:$,anchor:ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ge.getOrigin(),opacity:1,size:ge.getSize(),scale:ge.getScale(),rotation:ge.getRotation(),rotateWithView:ge.getRotateWithView()}))}const ue=k.getZIndex()||0;let Q=P[ue];Q||(Q={},P[ue]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const oe=z.getType();if(oe==="GeometryCollection"){const ne=z.getGeometriesArrayRecursive();for(let W=0,$=ne.length;W<$;++W){const ie=ne[W];Q[ie.getType().replace("Multi","")].push(ie,k)}}else Q[oe.replace("Multi","")].push(z,k)}}const N=Object.keys(P).map(Number).sort(zs);for(let D=0,L=N.length;D<L;++D){const F=P[N[D]];for(const B in F){const b=F[B];for(let R=0,M=b.length;R<M;R+=2){T.setStyle(b[R+1]);for(let V=0,j=e.length;V<j;++V)T.setTransform(e[V]),T.drawGeometry(b[R])}}}return y.getImageData(0,0,E.width,E.height)}function K4(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Xr),s=Math.floor(Math.round(n[1])*Xr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class sb extends Ys{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const H4=5;class q4 extends Zd{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=H4}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return tt()}getData(e){return null}prepareFrame(e){return tt()}renderFrame(e,t){return tt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===ze.LOADED||t.getState()===ze.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=ze.LOADED&&t!=ze.ERROR&&e.addEventListener(Be.CHANGE,this.boundHandleImageChange_),t==ze.IDLE&&(e.load(),t=e.getState()),t==ze.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const QI=[];let Nc=null;function X4(){Nc=Qt(1,1,void 0,{willReadFrequently:!0})}class ob extends q4{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=xr(),this.pixelTransform=xr(),this.inversePixelTransform=xr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Nc||X4(),Nc.clearRect(0,0,1,1);let r;try{Nc.drawImage(e,t,i,1,1,0,0,1,1),r=Nc.getImageData(0,0,1,1).data}catch{return Nc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&oa(uu(e.style.backgroundColor),uu(i)))){const l=e.firstElementChild;Go(l)&&(o=l.getContext("2d"))}if(o&&y3(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ei?jP():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Qt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=bl(i),s=bm(i),o=Pm(i),l=Am(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(dt(i)/r*o),u=Math.round(Bn(i)/r*o);Ks(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),CP(this.inversePixelTransform,this.pixelTransform);const h=m3(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new sb(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Hi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Hi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new nb),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Hi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Hi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,y=-e[0]+l,E=-e[1];return Ks(this.tempTransform,u,h,f,p,-i,y,E)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class Y4 extends ob{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Zi(),this.wrappedRenderedExtent_=Zi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),E=t.pixelRatio,T=t.viewHints,I=!(T[Mn.ANIMATING]||T[Mn.INTERACTING]),S=this.context,P=Math.round(dt(r)/l*E),N=Math.round(Bn(r)/l*E),D=p.getWrapX()&&u.canWrapX(),L=D?dt(f):null,F=D?Math.ceil((r[2]-f[2])/L)+1:1;let B=D?Math.floor((r[0]-f[0])/L):0;do{let b=this.getRenderTransform(o,l,0,E,P,N,B*L);t.declutter&&(b=b.slice(0)),e.execute(S,[S.canvas.width,S.canvas.height],b,h,I,i===void 0?$a:i?ib:B4,i?y&&t.declutter[y]:void 0)}while(++B<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Qt(this.context.canvas.width,this.context.canvas.height,QI))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Lm(this.context),QI.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Hi.PRERENDER)||this.getLayer().hasListener(Hi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=Bo(i.extent);l=ri(u,e.extent),this.clipped_=l&&!Uh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*Xr,y=i[1]*Xr;f.push(this.getRenderTransform(r,s,o,Xr,p,y,0).slice());const E=h.getSource(),T=l.getExtent();if(E.getWrapX()&&l.canWrapX()&&!Uh(T,u)){let I=u[0];const S=dt(T);let P=0,N;for(;I<T[0];)--P,N=S*P,f.push(this.getRenderTransform(r,s,o,Xr,p,y,N).slice()),I+=S;for(P=0,I=u[2];I>T[2];)++P,N=S*P,f.push(this.getRenderTransform(r,s,o,Xr,p,y,N).slice()),I-=S}this.hitDetectionImageData_=$4(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,FI(s,this.renderedPixelRatio_))}t(K4(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(y,E,T){const I=it(y),S=h[I];if(S){if(S!==!0&&T<S.distanceSq){if(T===0)return h[I]=!0,s.splice(s.lastIndexOf(S),1),r(y,u,E);S.geometry=E,S.distanceSq=T}}else{if(T===0)return h[I]=!0,r(y,u,E);s.push(h[I]={feature:y,layer:u,geometry:E,distanceSq:T,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Mn.ANIMATING],s=e.viewHints[Mn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,y=e.pixelRatio,E=t.getRevision(),T=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=s4);const S=h.center.slice(),P=rx(u,T*p),N=P.slice(),D=[P.slice()],L=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Uh(L,e.extent)){const re=dt(L),pe=Math.max(dt(P)/2,re);P[0]=L[0]-pe,P[2]=L[2]+pe,yP(S,f);const ge=pP(D[0],f);ge[0]<L[0]&&ge[2]<L[2]?D.push([ge[0]+re,ge[1],ge[2]+re,ge[3]]):ge[0]>L[0]&&ge[2]>L[2]&&D.push([ge[0]-re,ge[1],ge[2]-re,ge[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==E&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Uh(this.wrappedRenderedExtent_,P))return oa(this.renderedExtent_,N)||(this.hitDetectionImageData_=null,this.renderedExtent_=N),this.renderedCenter_=S,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new F4(HP(p,y),P,p,y);let B;for(let re=0,pe=D.length;re<pe;++re)i.loadFeatures(D[re],p,f);const b=FI(p,y);let R=!0;const M=(re,pe)=>{let ge;const ue=re.getStyleFunction()||t.getStyleFunction();if(ue&&(ge=ue(re,p)),ge){const Q=this.renderFeature(re,b,ge,F,B,this.getLayer().getDeclutter(),pe);R=R&&!Q}},V=IP(P),j=i.getFeaturesInExtent(V);I&&j.sort(I);for(let re=0,pe=j.length;re<pe;++re)M(j[re],re);this.renderedFeatures_=j,this.ready=R;const z=F.finish(),k=new G4(P,p,y,i.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=E,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=N,this.wrappedRenderedExtent_=P,this.renderedCenter_=S,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=k,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=VI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=VI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Dl=0;const zn=1<<Dl++,qe=1<<Dl++,ni=1<<Dl++,fr=1<<Dl++,yl=1<<Dl++,Gh=1<<Dl++,jg=Math.pow(2,Dl)-1,Cx={[zn]:"boolean",[qe]:"number",[ni]:"string",[fr]:"color",[yl]:"number[]",[Gh]:"size"},Z4=Object.keys(Cx).map(Number).sort(zs);function Q4(n){return n in Cx}function Wh(n){const e=[];for(const t of Z4)$h(n,t)&&e.push(Cx[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function $h(n,e){return(n&e)===e}function Ro(n,e){return n===e}class Zt{constructor(e,t){if(!Q4(e))throw new Error(`literal expressions must have a specific type, got ${Wh(e)}`);this.type=e,this.value=t}}class J4{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function ab(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function In(n,e,t){switch(typeof n){case"boolean":{if(Ro(e,ni))return new Zt(ni,n?"true":"false");if(!$h(e,zn))throw new Error(`got a boolean, but expected ${Wh(e)}`);return new Zt(zn,n)}case"number":{if(Ro(e,Gh))return new Zt(Gh,oi(n));if(Ro(e,zn))return new Zt(zn,!!n);if(Ro(e,ni))return new Zt(ni,n.toString());if(!$h(e,qe))throw new Error(`got a number, but expected ${Wh(e)}`);return new Zt(qe,n)}case"string":{if(Ro(e,fr))return new Zt(fr,vx(n));if(Ro(e,zn))return new Zt(zn,!!n);if(!$h(e,ni))throw new Error(`got a string, but expected ${Wh(e)}`);return new Zt(ni,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return uj(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Ro(e,Gh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Zt(Gh,n)}if(Ro(e,fr)){if(n.length===3)return new Zt(fr,[...n,1]);if(n.length===4)return new Zt(fr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!$h(e,yl))throw new Error(`got an array of numbers, but expected ${Wh(e)}`);return new Zt(yl,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},ej={[te.Get]:Oe(Ue(1,1/0),JI),[te.Var]:Oe(Ue(1,1),tj),[te.Has]:Oe(Ue(1,1/0),JI),[te.Id]:Oe(nj,wc),[te.Concat]:Oe(Ue(2,1/0),ot(ni)),[te.GeometryType]:Oe(ij,wc),[te.LineMetric]:Oe(wc),[te.Resolution]:Oe(v0,wc),[te.Zoom]:Oe(v0,wc),[te.Time]:Oe(v0,wc),[te.Any]:Oe(Ue(2,1/0),ot(zn)),[te.All]:Oe(Ue(2,1/0),ot(zn)),[te.Not]:Oe(Ue(1,1),ot(zn)),[te.Equal]:Oe(Ue(2,2),ot(jg)),[te.NotEqual]:Oe(Ue(2,2),ot(jg)),[te.GreaterThan]:Oe(Ue(2,2),ot(qe)),[te.GreaterThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.LessThan]:Oe(Ue(2,2),ot(qe)),[te.LessThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.Multiply]:Oe(Ue(2,1/0),eC),[te.Coalesce]:Oe(Ue(2,1/0),eC),[te.Divide]:Oe(Ue(2,2),ot(qe)),[te.Add]:Oe(Ue(2,1/0),ot(qe)),[te.Subtract]:Oe(Ue(2,2),ot(qe)),[te.Clamp]:Oe(Ue(3,3),ot(qe)),[te.Mod]:Oe(Ue(2,2),ot(qe)),[te.Pow]:Oe(Ue(2,2),ot(qe)),[te.Abs]:Oe(Ue(1,1),ot(qe)),[te.Floor]:Oe(Ue(1,1),ot(qe)),[te.Ceil]:Oe(Ue(1,1),ot(qe)),[te.Round]:Oe(Ue(1,1),ot(qe)),[te.Sin]:Oe(Ue(1,1),ot(qe)),[te.Cos]:Oe(Ue(1,1),ot(qe)),[te.Atan]:Oe(Ue(1,2),ot(qe)),[te.Sqrt]:Oe(Ue(1,1),ot(qe)),[te.Match]:Oe(Ue(4,1/0),tC,sj),[te.Between]:Oe(Ue(3,3),ot(qe)),[te.Interpolate]:Oe(Ue(6,1/0),tC,oj),[te.Case]:Oe(Ue(3,1/0),rj,aj),[te.In]:Oe(Ue(2,2),lj),[te.Number]:Oe(Ue(1,1/0),ot(jg)),[te.String]:Oe(Ue(1,1/0),ot(jg)),[te.Array]:Oe(Ue(1,1/0),ot(qe)),[te.Color]:Oe(Ue(1,4),ot(qe)),[te.Band]:Oe(Ue(1,3),ot(qe)),[te.Palette]:Oe(Ue(2,2),cj),[te.ToString]:Oe(Ue(1,1),ot(zn|qe|ni|fr))};function JI(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Zt(qe,o);break}case"string":{r[s]=new Zt(ni,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function tj(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Zt(ni,i)]}function nj(n,e,t){t.featureId=!0}function ij(n,e,t){t.geometryType=!0}function v0(n,e,t){t.mapState=!0}function wc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ue(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function eC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=In(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=In(e[o+1],n,i);s[o]=l}return s}}function rj(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function tC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function sj(n,e,t){const i=n.length-1,r=ni|qe|zn,s=In(n[1],r,t),o=In(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=In(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=In(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function oj(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Zt(qe,r);let o;try{o=In(n[2],qe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=In(n[u+3],qe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=In(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function aj(n,e,t){const i=In(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=In(n[s+1],zn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=In(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function lj(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ni}else r=qe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=In(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[In(n[1],r,t),...s]}function cj(n,e,t){let i;try{i=In(n[1],qe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=In(r[o],fr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Zt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Oe(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new J4(t,r,...s)}}function uj(n,e,t){const i=n[0],r=ej[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function lb(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return lb(n.getGeometries()[0]);default:return""}}function cb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Zs(n,e,t){const i=In(n,e,t);return Sr(i)}function Sr(n,e){if(n instanceof Zt){if(n.type===fr&&typeof n.value=="string"){const i=vx(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return hj(n);case te.Get:case te.Var:case te.Has:return dj(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Sr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return gj(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return fj(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return pj(n);case te.Case:return mj(n);case te.Match:return yj(n);case te.Interpolate:return _j(n);case te.ToString:return vj(n);default:throw new Error(`Unsupported operator ${t}`)}}function hj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Sr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function dj(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function fj(n,e){const t=n.operator,i=Sr(n.args[0]),r=Sr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function gj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Sr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function pj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Sr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function mj(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Sr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function yj(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Sr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function _j(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Sr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const y=Array.isArray(p);if(y&&(p=B3(p)),f>=o)return h===2?p:y?xj(s,o,l,u,f,p):Kh(s,o,l,u,f,p);l=f,u=p}return u}}function vj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Sr(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===fr?xx(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Kh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function xj(n,e,t,i,r,s){if(r-t===0)return i;const l=DI(i),u=DI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Kh(n,e,t,l[0],r,u[0]),Kh(n,e,t,l[1],r,u[1]),l[2]+Kh(n,e,t,0,r,h),Kh(n,e,t,i[3],r,s[3])];return G3(f)}function wj(n){return!0}function Ej(n){const e=ab(),t=Tj(n,e),i=cb();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=lb(r.getGeometry())),t(i)}}function nC(n){const e=ab(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Pv(n[o],e);const r=cb(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function Tj(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Zs(s.filter,zn,e):wj;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Pv(s.style[h],e)}else l=[Pv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Pv(n,e){const t=Rd(n,"",e),i=Ad(n,"",e),r=Sj(n,e),s=Ij(n,e),o=si(n,"z-index",e);if(!t&&!i&&!r&&!s&&!su(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Yi;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Rd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=Pj(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=Rx(n,e+"fill-color",t)}if(!i)return null;const r=new Tr;return function(s){const o=i(s);return o===_x?null:(r.setColor(o),r)}}function Ad(n,e,t){const i=si(n,e+"stroke-width",t),r=Rx(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ns(n,e+"stroke-line-cap",t),o=Ns(n,e+"stroke-line-join",t),l=ub(n,e+"stroke-line-dash",t),u=si(n,e+"stroke-line-dash-offset",t),h=si(n,e+"stroke-miter-limit",t),f=new bu;return function(p){if(r){const y=r(p);if(y===_x)return null;f.setColor(y)}if(i&&f.setWidth(i(p)),s){const y=s(p);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(p);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function Sj(n,e){const t="text-",i=Ns(n,t+"value",e);if(!i)return null;const r=Rd(n,t,e),s=Rd(n,t+"background-",e),o=Ad(n,t,e),l=Ad(n,t+"background-",e),u=Ns(n,t+"font",e),h=si(n,t+"max-angle",e),f=si(n,t+"offset-x",e),p=si(n,t+"offset-y",e),y=Xc(n,t+"overflow",e),E=Ns(n,t+"placement",e),T=si(n,t+"repeat",e),I=Vm(n,t+"scale",e),S=Xc(n,t+"rotate-with-view",e),P=si(n,t+"rotation",e),N=Ns(n,t+"align",e),D=Ns(n,t+"justify",e),L=Ns(n,t+"baseline",e),F=Xc(n,t+"keep-upright",e),B=ub(n,t+"padding",e),b=jm(n,t+"declutter-mode"),R=new tf({declutterMode:b});return function(M){if(R.setText(i(M)),r&&R.setFill(r(M)),s&&R.setBackgroundFill(s(M)),o&&R.setStroke(o(M)),l&&R.setBackgroundStroke(l(M)),u&&R.setFont(u(M)),h&&R.setMaxAngle(h(M)),f&&R.setOffsetX(f(M)),p&&R.setOffsetY(p(M)),y&&R.setOverflow(y(M)),E){const V=E(M);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(V)}if(T&&R.setRepeat(T(M)),I&&R.setScale(I(M)),S&&R.setRotateWithView(S(M)),P&&R.setRotation(P(M)),N){const V=N(M);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(V)}if(D){const V=D(M);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(V)}if(L){const V=L(M);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(V)}return B&&R.setPadding(B(M)),F&&R.setKeepUpright(F(M)),R}}function Ij(n,e){return"icon-src"in n?Cj(n,e):"shape-points"in n?Rj(n,e):"circle-radius"in n?Aj(n,e):null}function Cj(n,e){const t="icon-",i=t+"src",r=hb(n[i],i),s=Vp(n,t+"anchor",e),o=Vm(n,t+"scale",e),l=si(n,t+"opacity",e),u=Vp(n,t+"displacement",e),h=si(n,t+"rotation",e),f=Xc(n,t+"rotate-with-view",e),p=rC(n,t+"anchor-origin"),y=sC(n,t+"anchor-x-units"),E=sC(n,t+"anchor-y-units"),T=Nj(n,t+"color"),I=kj(n,t+"cross-origin"),S=Dj(n,t+"offset"),P=rC(n,t+"offset-origin"),N=jp(n,t+"width"),D=jp(n,t+"height"),L=bj(n,t+"size"),F=jm(n,t+"declutter-mode"),B=new Ix({src:r,anchorOrigin:p,anchorXUnits:y,anchorYUnits:E,color:T,crossOrigin:I,offset:S,offsetOrigin:P,height:D,width:N,size:L,declutterMode:F});return function(b){return l&&B.setOpacity(l(b)),u&&B.setDisplacement(u(b)),h&&B.setRotation(h(b)),f&&B.setRotateWithView(f(b)),o&&B.setScale(o(b)),s&&B.setAnchor(s(b)),B}}function Rj(n,e){const t="shape-",i=t+"points",r=t+"radius",s=bv(n[i],i),o=bv(n[r],r),l=Rd(n,t,e),u=Ad(n,t,e),h=Vm(n,t+"scale",e),f=Vp(n,t+"displacement",e),p=si(n,t+"rotation",e),y=Xc(n,t+"rotate-with-view",e),E=jp(n,t+"radius2"),T=jp(n,t+"angle"),I=jm(n,t+"declutter-mode"),S=new Fm({points:s,radius:o,radius2:E,angle:T,declutterMode:I});return function(P){return l&&S.setFill(l(P)),u&&S.setStroke(u(P)),f&&S.setDisplacement(f(P)),p&&S.setRotation(p(P)),y&&S.setRotateWithView(y(P)),h&&S.setScale(h(P)),S}}function Aj(n,e){const t="circle-",i=Rd(n,t,e),r=Ad(n,t,e),s=si(n,t+"radius",e),o=Vm(n,t+"scale",e),l=Vp(n,t+"displacement",e),u=si(n,t+"rotation",e),h=Xc(n,t+"rotate-with-view",e),f=jm(n,t+"declutter-mode"),p=new kl({radius:5,declutterMode:f});return function(y){return s&&p.setRadius(s(y)),i&&p.setFill(i(y)),r&&p.setStroke(r(y)),l&&p.setDisplacement(l(y)),u&&p.setRotation(u(y)),h&&p.setRotateWithView(h(y)),o&&p.setScale(o(y)),p}}function si(n,e,t){if(!(e in n))return;const i=Zs(n[e],qe,t);return function(r){return bv(i(r),e)}}function Ns(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ni,t);return function(r){return hb(i(r),e)}}function Pj(n,e,t){const i=Ns(n,e+"pattern-src",t),r=iC(n,e+"pattern-offset",t),s=iC(n,e+"pattern-size",t),o=Rx(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Xc(n,e,t){if(!(e in n))return null;const i=Zs(n[e],zn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Rx(n,e,t){if(!(e in n))return null;const i=Zs(n[e],fr,t);return function(r){return db(i(r),e)}}function ub(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){return rf(i(r),e)}}function Vp(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){const s=rf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function iC(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){return fb(i(r),e)}}function Vm(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl|qe,t);return function(r){return Mj(i(r),e)}}function jp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function bj(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return oi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function kj(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function rC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function sC(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function Dj(n,e){const t=n[e];if(t!==void 0)return rf(t,e)}function jm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function Nj(n,e){const t=n[e];if(t!==void 0)return db(t,e)}function rf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function hb(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function bv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function db(n,e){if(typeof n=="string")return n;const t=rf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function fb(n,e){const t=rf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function Mj(n,e){return typeof n=="number"?n:fb(n,e)}const cr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function oC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let y=n[0]+u/2+f,E=n[2]-u/2+f,T=n[1]+h/2+p,I=n[3]-h/2+p;y>E&&(y=(E+y)/2,E=y),T>I&&(T=(I+T)/2,I=T);let S=Dt(i[0],y,E),P=Dt(i[1],T,I);if(o&&t&&r){const N=30*r;S+=-N*Math.log(1+Math.max(0,y-i[0])/N)+N*Math.log(1+Math.max(0,i[0]-E)/N),P+=-N*Math.log(1+Math.max(0,T-i[1])/N)+N*Math.log(1+Math.max(0,i[1]-I)/N)}return[S,P]})}function Lj(n){return n}function gb(n){return Math.pow(n,3)}function ku(n){return 1-gb(1-n)}function Oj(n){return 3*n*n-2*n*n*n}function Fj(n){return n}function Ax(n,e,t,i){const r=dt(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Px(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function Vj(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?Ax(u,t,o,i):u;if(l)return e?Px(r,f,h):Dt(r,h,f);const p=Math.min(f,r),y=Math.floor(nx(n,p,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function jj(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?Ax(e,r,u,s):e;if(h)return i?Px(o,f,t):Dt(o,t,f);const p=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-p),E=-l*(.5-p)+.5,T=Math.min(f,o),I=Math.floor(Math.log(e/T)/Math.log(n)+E),S=Math.max(y,I),P=e/Math.pow(n,S);return Dt(P,t,f)}})}function aC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?Ax(n,i,l,r):n;return!t||!u?Dt(s,e,h):Px(s,h,e)}})}function bx(n){if(n!==void 0)return 0}function lC(n){if(n!==void 0)return n}function Uj(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function zj(n){const e=Ko(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const Bj=42,kx=256,x0=0;class Yr extends cs{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=hx(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&SP(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=Bo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in cr)delete t[l];this.setProperties(t,!0);const i=Wj(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=Gj(e),s=i.constraint,o=$j(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&Ug(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||Oj,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const y=ol(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+y,u=p.targetRotation}Kj(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Mn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Mn.ANIMATING]>0}getInteracting(){return this.hints_[Mn.INTERACTING]>0}cancelAnimations(){this.setHint(Mn.ANIMATING,-this.hints_[Mn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Ug(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const y=u.sourceCenter[0],E=u.sourceCenter[1],T=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const S=y+p*(T-y),P=E+p*(I-E);this.targetCenter_=[S,P]}if(u.sourceResolution&&u.targetResolution){const y=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const E=this.getViewportSize_(this.getRotation()),T=this.constraints_.resolution(y,0,E,!0);this.targetCenter_=this.calculateCenterZoom(T,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=p===1?ol(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const E=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(E,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Mn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Ug(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],ox(i,e-this.getRotation()),L5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Tv(e,this.getProjection())}getCenterInternal(){return this.get(cr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return IP(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();at(t,"The view center is not defined");const i=this.getResolution();at(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return at(r!==void 0,"The view rotation is not defined"),_v(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(cr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Bo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=dt(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(cr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=w0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=nx(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(at(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){at(!km(e),"Cannot fit empty extent provided as `geometry`");const r=Bo(e,this.getProjection());i=UI(r)}else if(e.getType()==="Circle"){const r=Bo(e.getExtent(),this.getProjection());i=UI(r),i.rotate(this.getRotation(),fl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,y=s.length;p<y;p+=o){const E=s[p]*i-s[p+1]*r,T=s[p]*r+s[p+1]*i;l=Math.min(l,E),u=Math.min(u,T),h=Math.max(h,E),f=Math.max(f,T)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),y=fl(l);y[0]+=(r[1]-r[3])/2*u,y[1]+=(r[0]-r[2])/2*u;const E=y[0]*p-y[1]*f,T=y[1]*p+y[0]*f,I=this.getConstrainedCenter([E,T],u),S=t.callback?t.callback:_d;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},S):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),Ug(S,!0))}centerOn(e,t,i){this.centerOnInternal(Ds(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(w0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=w0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Tv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(cr.ROTATION)!==r&&this.set(cr.ROTATION,r),this.get(cr.RESOLUTION)!==o&&(this.set(cr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(cr.CENTER)||!Ap(this.get(cr.CENTER),l))&&this.set(cr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Ap(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:ku,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Mn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ds(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Mn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Ug(n,e){setTimeout(function(){n(e)},0)}function Gj(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return oC(n.extent,n.constrainOnlyCenter,t)}const e=hx(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,oC(t,!1,!1)}return Lj}function Wj(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:x0,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,y=hx(n.projection,"EPSG:3857"),E=y.getExtent();let T=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&y.isGlobal()&&(T=!1,I=E),n.resolutions!==void 0){const S=n.resolutions;t=S[o],i=S[l]!==void 0?S[l]:S[S.length-1],n.constrainResolution?e=Vj(S,f,!T&&I,p):e=aC(t,i,f,!T&&I,p)}else{const P=(E?Math.max(dt(E),Bn(E)):360*lu.degrees/y.getMetersPerUnit())/kx/Math.pow(2,x0),N=P/Math.pow(2,28-x0);t=n.maxResolution,t!==void 0?o=0:t=P/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=P/Math.pow(u,l):i=N),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=jj(u,t,i,f,!T&&I,p):e=aC(t,i,f,!T&&I,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function $j(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?zj():t===!1?lC:typeof t=="number"?Uj(t):lC}return bx}function Kj(n){return!(n.sourceCenter&&n.targetCenter&&!Ap(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function w0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const ht={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class pb extends cs{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ht.OPACITY]=e.opacity!==void 0?e.opacity:1,at(typeof t[ht.OPACITY]=="number","Layer opacity must be a number"),t[ht.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ht.Z_INDEX]=e.zIndex,t[ht.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ht.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ht.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ht.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return tt()}getLayerStatesArray(e){return tt()}getExtent(){return this.get(ht.EXTENT)}getMaxResolution(){return this.get(ht.MAX_RESOLUTION)}getMinResolution(){return this.get(ht.MIN_RESOLUTION)}getMinZoom(){return this.get(ht.MIN_ZOOM)}getMaxZoom(){return this.get(ht.MAX_ZOOM)}getOpacity(){return this.get(ht.OPACITY)}getSourceState(){return tt()}getVisible(){return this.get(ht.VISIBLE)}getZIndex(){return this.get(ht.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ht.EXTENT,e)}setMaxResolution(e){this.set(ht.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ht.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ht.MAX_ZOOM,e)}setMinZoom(e){this.set(ht.MIN_ZOOM,e)}setOpacity(e){at(typeof e=="number","Layer opacity must be a number"),this.set(ht.OPACITY,e)}setVisible(e){this.set(ht.VISIBLE,e)}setZIndex(e){this.set(ht.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Um extends pb{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ht.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ht.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nt(e,Be.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Yr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return Dx(r,t.viewState)&&(!s||ri(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Yr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ht.MAP,e)}getMapInternal(){return this.get(ht.MAP)}setMap(e){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nt(e,Hi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nt(this,Be.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);at(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ht.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Dx(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const cC={RENDER_ORDER:"renderOrder"};class mb extends Um{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(cC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new JP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(cC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?tb:e;const t=Hj(e);this.styleFunction_=e===null?void 0:P4(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function Hj(n){if(n===void 0)return tb;if(!n)return null;if(typeof n=="function"||n instanceof Yi)return n;if(!Array.isArray(n))return nC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Yi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Yi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return Ej(r)}return nC(n)}class Nx extends mb{constructor(e){super(e)}createRenderer(){return new Y4(this)}}const Ao={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Fo extends Ys{constructor(e,t){super(e),this.layer=t}}const E0={LAYERS:"layers"};class Du extends pb{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(E0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Ki(i.slice(),{unique:!0}):at(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Ki(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nt(e,ei.ADD,this.handleLayersAdd_,this),nt(e,ei.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Rt);Yd(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Fo(Ao.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[nt(e,ru.PROPERTYCHANGE,this.handleLayerChange_,this),nt(e,Be.CHANGE,this.handleLayerChange_,this)];e instanceof Du&&t.push(nt(e,Ao.ADDLAYER,this.handleLayerGroupAdd_,this),nt(e,Ao.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[it(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Fo(Ao.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Fo(Ao.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Fo(Ao.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=it(t);this.listenerKeys_[i].forEach(Rt),delete this.listenerKeys_[i],this.dispatchEvent(new Fo(Ao.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(E0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Fo(Ao.REMOVELAYER,i[r]))}this.set(E0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=sl(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class Mx extends Cm{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Be.CHANGE)}release(){this.setState(Ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ce.EMPTY){if(this.state!==Ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){tt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:gb(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function kv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const qj=new Error("disposed"),Xj=[256,256];class uC extends Mx{constructor(e){const t=Ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=kv(this.data_);return e?[e.width,e.height]:Xj}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ce.IDLE&&this.state!==Ce.ERROR)return;this.state=Ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ce.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(qj),this.controller_=null),super.disposeInternal()}}class yb extends Mx{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ei?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ce.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ce.ERROR,this.unlistenImage_(),this.image_=Yj(),this.changed()}handleImageLoad_(){if(Ei)this.state=Ce.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ce.LOADED:this.state=Ce.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ce.ERROR&&(this.state=Ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ce.IDLE&&(this.state=Ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=W3(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function Yj(){const n=Qt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let T0;const Yc=[];function hC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function S0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function Zj(){if(T0===void 0){const n=Qt(6,6,Yc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",hC(n,4,5,4,0),hC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;T0=S0(e,0)||S0(e,4)||S0(e,8),Lm(n),Yc.push(n.canvas)}return T0}function dC(n,e,t,i){const r=Mm(t,e,n);let s=kp(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||au(u,r)){const h=kp(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function Qj(n,e,t,i){const r=fl(t);let s=dC(n,e,r,i);return(!isFinite(s)||s<=0)&&fP(t,function(o){return s=dC(n,e,o,i),isFinite(s)&&s>0}),s}function Jj(n,e,t,i,r,s,o,l,u,h,f,p,y,E){const T=Qt(Math.round(t*n),Math.round(t*e),Yc);if(p||(T.imageSmoothingEnabled=!1),u.length===0)return T.canvas;T.scale(t,t);function I(F){return Math.round(F*t)/t}T.globalCompositeOperation="lighter";const S=Zi();u.forEach(function(F,B,b){A5(S,F.extent)});let P;const N=t/i,D=(p?1:1+Math.pow(2,-24))/N;P=Qt(Math.round(dt(S)*N),Math.round(Bn(S)*N),Yc),p||(P.imageSmoothingEnabled=!1),u.forEach(function(F,B,b){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){P.save();const z=(F.clipExtent[0]-S[0])*N,k=-(F.clipExtent[3]-S[3])*N,re=dt(F.clipExtent)*N,pe=Bn(F.clipExtent)*N;P.rect(p?z:Math.round(z),p?k:Math.round(k),p?re:Math.round(z+re)-Math.round(z),p?pe:Math.round(k+pe)-Math.round(k)),P.clip()}const R=(F.extent[0]-S[0])*N,M=-(F.extent[3]-S[3])*N,V=dt(F.extent)*N,j=Bn(F.extent)*N;P.drawImage(F.image,h,h,F.image.width-2*h,F.image.height-2*h,p?R:Math.round(R),p?M:Math.round(M),p?V:Math.round(R+V)-Math.round(R),p?j:Math.round(M+j)-Math.round(M)),F.clipExtent&&P.restore()}});const L=bl(o);return l.getTriangles().forEach(function(F,B,b){const R=F.source,M=F.target;let V=R[0][0],j=R[0][1],z=R[1][0],k=R[1][1],re=R[2][0],pe=R[2][1];const ge=I((M[0][0]-L[0])/s),ue=I(-(M[0][1]-L[1])/s),Q=I((M[1][0]-L[0])/s),oe=I(-(M[1][1]-L[1])/s),ne=I((M[2][0]-L[0])/s),W=I(-(M[2][1]-L[1])/s),$=V,ie=j;V=0,j=0,z-=$,k-=ie,re-=$,pe-=ie;const me=[[z,k,0,0,Q-ge],[re,pe,0,0,ne-ge],[0,0,z,k,oe-ue],[0,0,re,pe,W-ue]],xe=M5(me);if(!xe)return;if(T.save(),T.beginPath(),Zj()||!p){T.moveTo(Q,oe);const Me=4,Ve=ge-Q,Ge=ue-oe;for(let lt=0;lt<Me;lt++)T.lineTo(Q+I((lt+1)*Ve/Me),oe+I(lt*Ge/(Me-1))),lt!=Me-1&&T.lineTo(Q+I((lt+1)*Ve/Me),oe+I((lt+1)*Ge/(Me-1)));T.lineTo(ne,W)}else T.moveTo(Q,oe),T.lineTo(ge,ue),T.lineTo(ne,W);T.clip(),T.transform(xe[0],xe[2],xe[1],xe[3],ge,ue),T.translate(S[0]-$,S[3]-ie);let be;if(P)be=P.canvas,T.scale(D,-D);else{const Me=u[0],Ve=Me.extent;be=Me.image,T.scale(dt(Ve)/be.width,-Bn(Ve)/be.height)}T.drawImage(be,0,0),T.restore()}),P&&(Lm(P),Yc.push(P.canvas)),f&&(T.save(),T.globalCompositeOperation="source-over",T.strokeStyle="black",T.lineWidth=1,l.getTriangles().forEach(function(F,B,b){const R=F.target,M=(R[0][0]-L[0])/s,V=-(R[0][1]-L[1])/s,j=(R[1][0]-L[0])/s,z=-(R[1][1]-L[1])/s,k=(R[2][0]-L[0])/s,re=-(R[2][1]-L[1])/s;T.beginPath(),T.moveTo(j,z),T.lineTo(M,V),T.lineTo(k,re),T.closePath(),T.stroke()}),T.restore()),T.canvas}const e6=10,fC=.25;class t6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?h3(D=>un(l,Mm(D,this.targetProj_,this.sourceProj_))):Dp(this.targetProj_,this.sourceProj_);this.transformInv_=function(D){const L=D[0]+"/"+D[1];return u[L]||(u[L]=h(D)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&dt(r)>=dt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?dt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?dt(this.targetProj_.getExtent()):null;const f=bl(i),p=bm(i),y=Pm(i),E=Am(i),T=this.transformInv_(f),I=this.transformInv_(p),S=this.transformInv_(y),P=this.transformInv_(E),N=e6+(o?Math.max(0,Math.ceil(Math.log2(yv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,y,E,T,I,S,P,N),this.wrapsXInSource_){let D=1/0;this.triangles_.forEach(function(L,F,B){D=Math.min(D,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-D>this.sourceWorldWidth_/2){const F=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];F[0][0]-D>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-D>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-D>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const B=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-B<this.sourceWorldWidth_/2&&(L.source=F)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=fI([s,o,l,u]),p=this.sourceWorldWidth_?dt(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,E=this.sourceProj_.canWrapX()&&p>.5&&p<1;let T=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const S=fI([e,t,i,r]);T=dt(S)/this.targetWorldWidth_>fC||T}!E&&this.sourceProj_.isGlobal()&&p&&(T=p>fC||T)}if(!T&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ri(f,this.maxSourceExtent_))return;let I=0;if(!T&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)T=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!T){const S=[(e[0]+i[0])/2,(e[1]+i[1])/2],P=this.transformInv_(S);let N;E?N=(ol(s[0],y)+ol(l[0],y))/2-ol(P[0],y):N=(s[0]+l[0])/2-P[0];const D=(s[1]+l[1])/2-P[1];T=N*N+D*D>this.errorThresholdSquared_}if(T){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const S=[(t[0]+i[0])/2,(t[1]+i[1])/2],P=this.transformInv_(S),N=[(r[0]+e[0])/2,(r[1]+e[1])/2],D=this.transformInv_(N);this.addQuad_(e,t,S,N,s,o,P,D,h-1),this.addQuad_(N,S,i,r,D,P,l,u,h-1)}else{const S=[(e[0]+t[0])/2,(e[1]+t[1])/2],P=this.transformInv_(S),N=[(i[0]+r[0])/2,(i[1]+r[1])/2],D=this.transformInv_(N);this.addQuad_(e,S,N,r,s,P,D,u,h-1),this.addQuad_(S,t,i,N,P,o,l,D,h-1)}return}}if(E){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=Zi();return this.triangles_.forEach(function(t,i,r){const s=t.source;Jh(e,s[0]),Jh(e,s[1]),Jh(e,s[2])}),e}getTriangles(){return this.triangles_}}const n6=.5;class _b extends Mx{constructor(e,t,i,r,s,o,l,u,h,f,p,y){super(s,Ce.IDLE,y),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const E=r.getTileCoordExtent(this.wrappedTileCoord_),T=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const S=T?sl(E,T):E;if(yv(S)===0){this.state=Ce.EMPTY;return}const P=e.getExtent();P&&(I?I=sl(I,P):I=P);const N=r.getResolution(this.wrappedTileCoord_[0]),D=Qj(e,i,S,N);if(!isFinite(D)||D<=0){this.state=Ce.EMPTY;return}const L=f!==void 0?f:n6;if(this.triangulation_=new t6(e,i,S,I,D*L,N),this.triangulation_.getTriangles().length===0){this.state=Ce.EMPTY;return}this.sourceZ_=t.getZForResolution(D);let F=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(F[1]=Dt(F[1],I[1],I[3]),F[3]=Dt(F[3],I[1],I[3])):F=sl(F,I)),!yv(F))this.state=Ce.EMPTY;else{let B=0,b=0;e.canWrapX()&&(B=dt(P),b=Math.floor((F[0]-P[0])/B)),mP(F.slice(),e,!0).forEach(M=>{const V=t.getTileRangeForExtentAndZ(M,this.sourceZ_);for(let j=V.minX;j<=V.maxX;j++)for(let z=V.minY;z<=V.maxY;z++){const k=h(this.sourceZ_,j,z,l);if(k){const re=b*B;this.sourceTiles_.push({tile:k,offset:re})}}++b}),this.sourceTiles_.length===0&&(this.state=Ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ce.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Jj(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ce.LOADED}this.changed()}load(){if(this.state==Ce.IDLE){this.state=Ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ce.IDLE||i==Ce.LOADING){e++;const r=nt(t,Be.CHANGE,s=>{const o=t.getState();(o==Ce.LOADED||o==Ce.ERROR||o==Ce.EMPTY)&&(Rt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Rt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Lm(this.canvas_.getContext("2d")),Yc.push(this.canvas_),this.canvas_=null),super.release()}}class Lx{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ec(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new Lx(n,e,t,i)}class gC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Sm&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return at(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return at(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){at(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Up(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function i6(n,e,t){return n+"/"+e+"/"+t}function sp(n,e,t,i,r){return`${it(n)},${e},${i6(t,i,r)}`}function r6(n){return s6(n[0],n[1],n[2])}function s6(n,e,t){return(e<<n)+t}function o6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function I0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function a6(n,e,t){const i=n[t];return i?i.delete(e):!1}function pC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=sl(e,Bo(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=sl(e,r))}return e}class l6 extends ob{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Zi(),this.tempTileRange_=new Lx(0,0,0,0),this.tempTileCoord_=Up(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new gC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new gC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=sp(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||rp(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!au(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,p[1],p[2],t);if(!y||y.getState()!==Ce.LOADED)continue;const E=u.getOrigin(f),T=oi(u.getTileSize(f)),I=u.getResolution(f);let S;if(y instanceof yb||y instanceof _b)S=y.getImage();else if(y instanceof uC){if(S=kv(y.getData()),!S)continue}else continue;const P=Math.floor(h*((r[0]-E[0])/I-p[1]*T[0])),N=Math.floor(h*((E[1]-r[1])/I-p[2]*T[1])),D=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(S,P+D,N+D)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=it(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],y=l.getMapInternal(),E=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),T=o.rotation,I=T?gP(o.center,o.resolution,T,e.size):void 0;for(let S=i;S>=E;--S){const P=h.getTileRangeForExtentAndZ(t,S,this.tempTileRange_),N=h.getResolution(S);for(let D=P.minX;D<=P.maxX;++D)for(let L=P.minY;L<=P.maxY;++L){if(T&&!h.tileCoordIntersectsViewport([S,D,L],I))continue;const F=this.getTile(S,D,L,e);if(!F||!I0(r,F,S))continue;const b=F.getKey();if(p[b]=!0,F.getState()===Ce.IDLE&&!e.tileQueue.isKeyQueued(b)){const R=Up(S,D,L,this.tempTileCoord_);e.tileQueue.enqueue([F,f,h.getTileCoordCenter(R),N])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=sp(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ce.LOADED)return f.endTransition(it(this)),I0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const y=sp(u,h,i,f,p);let E=!1;if(l.containsKey(y)){const T=l.peek(y);T.getState()===Ce.LOADED&&(I0(r,T,i),E=!0)}E||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),y=p.getZForResolution(o,f.zDirection),E=p.getResolution(y),T=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==T&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=T):this.renderedSourceKey_=T;let I=e.extent;const S=f.getTilePixelRatio(u);this.prepareContainer(e,t);const P=this.context.canvas.width,N=this.context.canvas.height,D=i.extent&&Bo(i.extent);D&&(I=sl(I,Bo(i.extent)));const L=E*P/2/S,F=E*N/2/S,B=[l[0]-L,l[1]-F,l[0]+L,l[1]+F],b={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=p.getZForResolution(r.nextResolution,f.zDirection),oe=pC(e,e.nextExtent);this.enqueueTiles(e,oe,Q,b,R)}const M=pC(e,I);if(this.enqueueTiles(e,M,y,b,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,M,y-1,b,R-1)},0),!(y in b))return this.container;const V=it(this),j=e.time;for(const Q of b[y]){const oe=Q.getState();if(oe===Ce.EMPTY)continue;const ne=Q.tileCoord;if(oe===Ce.LOADED&&Q.getAlpha(V,j)===1){Q.endTransition(V);continue}if(oe!==Ce.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,b)){a6(b,Q,y),e.animate=!0;continue}if(this.findAltTiles_(p,ne,y+1,b))continue;const ie=p.getMinZoom();for(let me=y-1;me>=ie&&!this.findAltTiles_(p,ne,me,b);--me);}const z=E/o*u/S,k=this.getRenderContext(e);Ks(this.tempTransform,P/2,N/2,z,z,0,-P/2,-N/2),i.extent&&this.clipUnrotated(k,e,D),f.getInterpolate()||(k.imageSmoothingEnabled=!1),this.preRender(k,e);const re=Object.keys(b).map(Number);re.sort(zs);let pe;const ge=[],ue=[];for(let Q=re.length-1;Q>=0;--Q){const oe=re[Q],ne=f.getTilePixelSize(oe,u,s),$=p.getResolution(oe)/E,ie=ne[0]*$*z,me=ne[1]*$*z,xe=p.getTileCoordForCoordAndZ(bl(B),oe),be=p.getTileCoordExtent(xe),Me=un(this.tempTransform,[S*(be[0]-B[0])/E,S*(B[3]-be[3])/E]),Ve=S*f.getGutterForProjection(s);for(const Ge of b[oe]){if(Ge.getState()!==Ce.LOADED)continue;const lt=Ge.tileCoord,Qi=xe[1]-lt[1],ds=Math.round(Me[0]-(Qi-1)*ie),Wn=xe[2]-lt[2],$n=Math.round(Me[1]-(Wn-1)*me),hn=Math.round(Me[0]-Qi*ie),dn=Math.round(Me[1]-Wn*me),Kn=ds-hn,Ri=$n-dn,yt=re.length===1;let ct=!1;pe=[hn,dn,hn+Kn,dn,hn+Kn,dn+Ri,hn,dn+Ri];for(let tn=0,Ai=ge.length;tn<Ai;++tn)if(!yt&&oe<ue[tn]){const St=ge[tn];ri([hn,dn,hn+Kn,dn+Ri],[St[0],St[3],St[4],St[7]])&&(ct||(k.save(),ct=!0),k.beginPath(),k.moveTo(pe[0],pe[1]),k.lineTo(pe[2],pe[3]),k.lineTo(pe[4],pe[5]),k.lineTo(pe[6],pe[7]),k.moveTo(St[6],St[7]),k.lineTo(St[4],St[5]),k.lineTo(St[2],St[3]),k.lineTo(St[0],St[1]),k.clip())}ge.push(pe),ue.push(oe),this.drawTile(Ge,e,hn,dn,Kn,Ri,Ve,yt),ct&&k.restore(),this.renderedTiles.unshift(Ge),this.updateUsedTiles(e.usedTiles,f,Ge)}}if(this.renderedResolution=E,this.extentChanged=!this.renderedExtent_||!vd(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&k.restore(),k.imageSmoothingEnabled=!0,this.renderComplete){const Q=(oe,ne)=>{const W=it(f),$=ne.wantedTiles[W],ie=$?Object.keys($).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof uC){if(h=kv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=it(this),y=t.layerStatesArray[t.layerIndex],E=y.opacity*(u?e.getAlpha(p,t.time):1),T=E!==f.globalAlpha;T&&(f.save(),f.globalAlpha=E),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),T&&f.restore(),E!==y.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=it(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const zg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class c6 extends Um{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(zg.PRELOAD)}setPreload(e){this.set(zg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(zg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(zg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class C0 extends c6{constructor(e){super(e)}createRenderer(){return new l6(this,{cacheSize:this.getCacheSize()})}}const Tc=[0,0,0],Po=5;class vb{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,at(T5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,at(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=bl(i)),at(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,at(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:kx,at(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new Lx(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Ec(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ec(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ec(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Ec(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,y=Math.floor(u*(o+1))-1;return Ec(h,p,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Tc);const r=Tc[1],s=Tc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Tc);const o=Tc[1],l=Tc[2];return Ec(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=oi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=oi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return ea(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=oi(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=Dg(f,Po)-1,p=Dg(p,Po)-1):(f=kg(f,Po),p=kg(p,Po)),Up(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=oi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=Dg(h,Po)-1,f=Dg(f,Po)-1):(h=kg(h,Po),f=kg(f,Po)),Up(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=nx(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return MP(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function xb(n){let e=n.getDefaultTileGrid();return e||(e=f6(n),n.setDefaultTileGrid(e)),e}function u6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=Ox(t);if(!au(s,r)){const o=dt(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function h6(n,e,t,i){i=i!==void 0?i:"top-left";const r=wb(n,e,t);return new vb({extent:n,origin:b5(n,i),resolutions:r,tileSize:t})}function d6(n){const e=n||{},t=e.extent||ai("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:wb(t,e.maxZoom,e.tileSize,e.maxResolution)};return new vb(i)}function wb(n,e,t,i){e=e!==void 0?e:Bj,t=oi(t!==void 0?t:kx);const r=Bn(n),s=dt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function f6(n,e,t,i){const r=Ox(n);return h6(r,e,t,i)}function Ox(n){n=ai(n);let e=n.getExtent();if(!e){const t=180*lu.degrees/n.getMetersPerUnit();e=ea(-t,-t,t,t)}return e}function wq(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const g6=/\{z\}/g,p6=/\{x\}/g,m6=/\{y\}/g,y6=/\{-y\}/g;function _6(n,e,t,i,r){return n.replace(g6,e.toString()).replace(p6,t.toString()).replace(m6,i.toString()).replace(y6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function v6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function x6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return _6(n,o,t[1],t[2],s)})}function w6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=x6(n[r],e);return E6(i)}function E6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=r6(e),s=ol(r,n.length);return n[s](e,t,i)})}class T6 extends eb{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&oi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||it(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return tt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:xb(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=oi(r.getTileSize(e),this.tmpSize);return s==1?o:A4(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=u6(r,e,i)),o6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class S6 extends Ys{constructor(e,t){super(e),this.tile=t}}const R0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class Fx extends T6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Fx.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=it(t),r=t.getState();let s;r==Ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=R0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ce.ERROR?R0.TILELOADERROR:r==Ce.LOADED?R0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new S6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=v6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(w6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class I6 extends Fx{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Eb,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:yb,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!rp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||rp(t,e)))return this.tileGrid;const i=it(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=xb(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ce.IDLE:Ce.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(Be.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||rp(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(u,s),E=new _b(l,f,s,p,u,y,this.getTilePixelRatio(r),this.getGutter(),(T,I,S,P)=>this.getTileInternal(T,I,S,P,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return E.key=h,E}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=sp(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=ai(e);if(i){const r=it(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function Eb(n,e){if(Ei){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Dv extends I6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:d6({extent:Ox(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const C6="modulepreload",R6=function(n){return"/visapp/"+n},mC={},Bg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=R6(h),h in mC)return;mC[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":C6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((E,T)=>{y.addEventListener("load",E),y.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},A6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class P6 extends Dv{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[A6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ei&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||Eb)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const zp=1/0;class b6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Yd(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){at(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=zp?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==zp?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class k6 extends b6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Be.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ce.LOADED||i===Ce.ERROR||i===Ce.EMPTY){i!==Ce.ERROR&&t.removeEventListener(Be.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ce.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function D6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return zp;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Mc extends Ys{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Lo extends Mc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Mt={SINGLECLICK:"singleclick",CLICK:Be.CLICK,DBLCLICK:Be.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Nv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class N6 extends Cm{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=nt(i,Nv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nt(i,Nv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Be.TOUCHMOVE,this.boundHandleTouchMove_,VP?{passive:!1}:!1)}emulateClick_(e){let t=new Lo(Mt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Lo(Mt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Lo(Mt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Mt.POINTERUP||t.type==Mt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Mt.POINTERDOWN||t.type==Mt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Lo(Mt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Lo(Mt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nt(i,Mt.POINTERMOVE,this.handlePointerMove_,this),nt(i,Mt.POINTERUP,this.handlePointerUp_,this),nt(this.element_,Mt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(nt(this.element_.getRootNode(),Mt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Lo(Mt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Lo(Mt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Be.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Oo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Dn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class zm extends cs{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Rt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==_d&&this.listenerKeys.push(nt(e,Oo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class M6 extends zm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Be.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+ef+" "+wx+(this.collapsed_&&this.collapsible_?" "+NI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>S5(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!oa(t,this.renderedAttributions_)){N3(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(NI),this.collapsed_?kI(this.collapseLabel_,this.label_):kI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class L6 extends zm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Be.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+ef+" "+wx,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Lg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ku}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Lg);!s&&i===0?this.element.classList.add(Lg):s&&i!==0&&this.element.classList.remove(Lg)}this.label_.style.transform=r}this.rotation_=i}}class O6 extends zm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Be.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(Be.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+ef+" "+wx,E=this.element;E.className=y,E.appendChild(f),E.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:ku})):i.setZoom(s)}}}function F6(n){n=n||{};const e=new Ki;return(n.zoom===void 0||n.zoom)&&e.push(new O6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new L6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new M6(n.attributionOptions)),e}class V6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const yC={ACTIVE:"active"};class sf extends cs{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(yC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(yC.ACTIVE,e)}setMap(e){this.map_=e}}function j6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:Fj,center:n.getConstrainedCenter(r)})}}function Vx(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:ku})}class U6 extends sf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Mt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();Vx(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Mv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const z6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},B6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},Tb=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?B6(n):!0},G6=yd,Sb=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(k3&&OP&&e.ctrlKey)},Ib=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},W6=function(n){const e=n.originalEvent;return OP?e.metaKey:e.ctrlKey},$6=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Cb=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},A0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},K6=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class of extends sf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Mt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Mt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Mt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Mt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function jx(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class H6 extends of{constructor(e){super({stopDown:Im}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Mv(Ib,K6);this.condition_=e.onFocusOnly?Mv(Tb,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(jx(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();O5(s,l.getResolution()),ox(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:ku})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class q6 extends of{constructor(e){e=e||{},super({stopDown:Im}),this.condition_=e.condition?e.condition:z6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!A0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===bx)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return A0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return A0(e)&&Sb(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class X6 extends Sm{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Cd([r])}getGeometry(){return this.geometry_}}const Sc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ph extends Ys{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class Y6 extends of{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new X6(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??Sb,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ph(Sc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ph(t?Sc.BOXEND:Sc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ph(Sc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Sc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Sc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class Z6 extends Y6{constructor(e){e=e||{};const t=e.condition?e.condition:$6;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:ku})}}const Oa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class Q6 extends sf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return Ib(t)&&Cb(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Be.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Oa.DOWN||r==Oa.LEFT||r==Oa.RIGHT||r==Oa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Oa.DOWN?h=-l:r==Oa.LEFT?u=-l:r==Oa.RIGHT?u=l:h=l;const f=[u,h];ox(f,o.getRotation()),j6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class J6 extends sf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!W6(t)&&Cb(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Be.KEYDOWN||e.type==Be.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();Vx(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const eU=40,tU=300;class nU extends sf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:G6;this.condition_=e.onFocusOnly?Mv(Tb,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Be.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=eU;break;case WheelEvent.DOM_DELTA_PAGE:s*=tU;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Vx(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class iU extends of{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Im),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==bx&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(jx(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class rU extends of{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Im),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(jx(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function sU(n){n=n||{};const e=new Ki,t=new V6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new q6),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new U6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new H6({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new iU),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new rU({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new Q6),e.push(new J6({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new nU({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new Z6({duration:n.zoomDuration})),e}class oU extends Sm{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){tt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Ks(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),CP(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(L,F,B,b){return s.call(o,F,L?B:null,b)}const y=f.projection,E=yP(e.slice(),y),T=[[0,0]];if(y.canWrapX()&&r){const L=y.getExtent(),F=dt(L);T.push([-F,0],[F,0])}const I=t.layerStatesArray,S=I.length,P=[],N=[];for(let L=0;L<T.length;L++)for(let F=S-1;F>=0;--F){const B=I[F],b=B.layer;if(b.hasRenderer()&&Dx(B,f)&&l.call(u,b)){const R=b.getRenderer(),M=b.getSource();if(R&&M){const V=M.getWrapX()?E:e,j=p.bind(null,B.managed);N[0]=V[0]+T[L][0],N[1]=V[1]+T[L][1],h=R.forEachFeatureAtCoordinate(N,t,i,j,P)}if(h)return h}}if(P.length===0)return;const D=1/P.length;return P.forEach((L,F)=>L.distanceSq+=F*D),P.sort((L,F)=>L.distanceSq-F.distanceSq),P.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,yd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){tt()}scheduleExpireIconCache(e){qi.canExpireCache()&&e.postRenderFunctions.push(aU)}}function aU(n,e){qi.expire()}class lU extends oU{constructor(e){super(e),this.fontChangeListenerKey_=nt(kc,ru.PROPERTYCHANGE,e.redrawText,e),this.element_=Ei?jP():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=ef+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new sb(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Hi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof mb&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const y=p.layer,E=y.getSourceState();if(!Dx(p,r)||E!="ready"&&E!="undefined"){y.unrender();continue}const T=y.render(e,o);T&&(T!==o&&(this.children_.push(T),o=T),s.push(p))}this.declutter(e,s),M3(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Go(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Go(p)||p.width>0)&&(h.fillStyle=y,h.fillRect(0,0,u.width,u.height)),Go(p)&&p.width>0){const E=f.style.opacity||p.style.opacity;h.globalAlpha=E===""?1:Number(E);const T=p.style.transform;if(T)h.setTransform(...Sv(T));else{const I=parseFloat(p.style.width)/p.width,S=parseFloat(p.style.height)/p.height;h.setTransform(I,0,0,S,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Hi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function Rb(n){if(n instanceof Um){n.setMapInternal(null);return}n instanceof Du&&n.getLayers().forEach(Rb)}function Ab(n,e){if(n instanceof Um){n.setMapInternal(e);return}if(n instanceof Du){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)Ab(t[i],e)}}let cU=class extends cs{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=uU(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:D3,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=xr(),this.pixelToCoordinateTransform_=xr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ei||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ei||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ei?new Ki:F6()),this.interactions=t.interactions||(Ei?new Ki:sU({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new k6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Dn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Dn.VIEW,this.handleViewChanged_),this.addChangeListener(Dn.SIZE,this.handleSizeChanged_),this.addChangeListener(Dn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Yr)&&e.view.then(function(r){i.setView(new Yr(r))}),this.controls.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ei.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ei.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){Ab(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:yd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Du?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:yd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Dn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Tv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Dn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ki){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Dn.SIZE)}getView(){return this.get(Dn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return D6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Lo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Nv.POINTERDOWN||i===Be.WHEEL||i===Be.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Mn.ANIMATING]||o[Mn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Hi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Hi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Mc(Oo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Mc(Oo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Rt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Be.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Be.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Go(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Go(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new lU(this)),!Go(t)){this.mapBrowserEventHandler_=new N6(this,this.moveTolerance_);for(const r in Mt)this.mapBrowserEventHandler_.addEventListener(Mt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Be.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Be.WHEEL,this.boundHandleBrowserEvent_,VP?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[nt(i,Be.KEYDOWN,this.handleBrowserEvent,this),nt(i,Be.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nt(e,ru.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(e,Be.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Fo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nt(e,ru.PROPERTYCHANGE,this.render,this),nt(e,Be.CHANGE,this.render,this),nt(e,"addlayer",this.handleLayerAdd_,this),nt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){Rb(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&$I(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:_v(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:it(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=_v(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!km(this.previousExtent_)&&!vd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Mc(Oo.MOVESTART,this,r)),this.previousExtent_=Rm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Mn.ANIMATING]&&!s.viewHints[Mn.INTERACTING]&&!vd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Mc(Oo.MOVEEND,this,s)),lP(s.extent,this.previousExtent_))),this.dispatchEvent(new Mc(Oo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Oo.LOADSTART)||this.hasListener(Oo.LOADEND)||this.hasListener(Hi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Fo("removelayer",t)),this.set(Dn.LAYERGROUP,e)}setSize(e){this.set(Dn.SIZE,e)}setTarget(e){this.set(Dn.TARGET,e)}setView(e){if(!e||e instanceof Yr){this.set(Dn.VIEW,e);return}this.set(Dn.VIEW,new Yr);const t=this;e.then(function(i){t.setView(new Yr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Go(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!$I(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&_P("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!oa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function uU(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Du({layers:n.layers});t[Dn.LAYERGROUP]=i,t[Dn.TARGET]=n.target,t[Dn.VIEW]=n.view instanceof Yr?n.view:new Yr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ki(n.controls.slice()):(at(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ki(n.interactions.slice()):(at(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Ki(n.overlays.slice()):(at(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Ki,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const P0="units",hU=[1,2,5],bh=25.4/.28;class dU extends zm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+ef,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(P0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(P0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(P0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=kp(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||bh)/bh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||bh)/bh:void 0;let h=l*o,f="";if(r=="degrees"){const D=lu.degrees;h*=D,h<D/60?(f="",o*=3600):h<D?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),y,E,T,I=0,S,P;for(;;){T=Math.floor(p/3);const D=Math.pow(10,T);if(y=hU[(p%3+3)%3]*D,E=Math.round(y/o),isNaN(E)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&E>=u){y=I,E=S,T=P;break}else if(E>=l)break;I=y,S=E,P=T,++p}const N=this.scaleBar_?this.createScaleBar(E,y,f):y.toFixed(T<0?-T:0)+" "+f;this.renderedHTML_!=N&&(this.innerElement_.innerHTML=N,this.renderedHTML_=N),this.renderedWidth_!=E&&(this.innerElement_.style.width=E+"px",this.renderedWidth_=E),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=kp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||bh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const fU={},_C=n=>{let e;const t=new Set,i=(f,p)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const E=e;e=p??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(T=>T(e,E))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(fU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},gU=n=>n?_C(n):_C;var b0={exports:{}},k0={},D0={exports:{}},N0={};var vC;function pU(){if(vC)return N0;vC=1;var n=$d();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,y){var E=y(),T=i({inst:{value:E,getSnapshot:y}}),I=T[0].inst,S=T[1];return s(function(){I.value=E,I.getSnapshot=y,u(I)&&S({inst:I})},[p,E,y]),r(function(){return u(I)&&S({inst:I}),p(function(){u(I)&&S({inst:I})})},[p]),o(E),E}function u(p){var y=p.getSnapshot;p=p.value;try{var E=y();return!t(p,E)}catch{return!0}}function h(p,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return N0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,N0}var xC;function mU(){return xC||(xC=1,D0.exports=pU()),D0.exports}var wC;function yU(){if(wC)return k0;wC=1;var n=$d(),e=mU();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return k0.useSyncExternalStoreWithSelector=function(h,f,p,y,E){var T=s(null);if(T.current===null){var I={hasValue:!1,value:null};T.current=I}else I=T.current;T=l(function(){function P(B){if(!N){if(N=!0,D=B,B=y(B),E!==void 0&&I.hasValue){var b=I.value;if(E(b,B))return L=b}return L=B}if(b=L,i(D,B))return b;var R=y(B);return E!==void 0&&E(b,R)?(D=B,b):(D=B,L=R)}var N=!1,D,L,F=p===void 0?null:p;return[function(){return P(f())},F===null?void 0:function(){return P(F())}]},[f,p,y,E]);var S=r(h,T[0],T[1]);return o(function(){I.hasValue=!0,I.value=S},[S]),u(S),S},k0}var EC;function _U(){return EC||(EC=1,b0.exports=yU()),b0.exports}var vU=_U();const xU=w1(vU),Pb={},{useDebugValue:wU}=HM,{useSyncExternalStoreWithSelector:EU}=xU;let TC=!1;const TU=n=>n;function SU(n,e=TU,t){(Pb?"production":void 0)!=="production"&&t&&!TC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),TC=!0);const i=EU(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return wU(i),i}const SC=n=>{(Pb?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?gU(n):n,t=(i,r)=>SU(e,i,r);return Object.assign(t,e),t},Ir=n=>n?SC(n):SC;var bb=Symbol.for("immer-nothing"),IC=Symbol.for("immer-draftable"),Ii=Symbol.for("immer-state");function gr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Pd=Object.getPrototypeOf;function fu(n){return!!n&&!!n[Ii]}function _l(n){return n?kb(n)||Array.isArray(n)||!!n[IC]||!!n.constructor?.[IC]||af(n)||Gm(n):!1}var IU=Object.prototype.constructor.toString(),CC=new WeakMap;function kb(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=CC.get(t);return i===void 0&&(i=Function.toString.call(t),CC.set(t,i)),i===IU}function Bp(n,e,t=!0){Bm(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Bm(n){const e=n[Ii];return e?e.type_:Array.isArray(n)?1:af(n)?2:Gm(n)?3:0}function Lv(n,e){return Bm(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function Db(n,e,t){const i=Bm(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function CU(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function af(n){return n instanceof Map}function Gm(n){return n instanceof Set}function za(n){return n.copy_||n.base_}function Ov(n,e){if(af(n))return new Map(n);if(Gm(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=kb(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ii];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Pd(n),i)}else{const i=Pd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function Ux(n,e=!1){return Wm(n)||fu(n)||!_l(n)||(Bm(n)>1&&Object.defineProperties(n,{set:Gg,add:Gg,clear:Gg,delete:Gg}),Object.freeze(n),e&&Object.values(n).forEach(t=>Ux(t,!0))),n}function RU(){gr(2)}var Gg={value:RU};function Wm(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var AU={};function vl(n){const e=AU[n];return e||gr(0,n),e}var bd;function Nb(){return bd}function PU(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function RC(n,e){e&&(vl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Fv(n){Vv(n),n.drafts_.forEach(bU),n.drafts_=null}function Vv(n){n===bd&&(bd=n.parent_)}function AC(n){return bd=PU(bd,n)}function bU(n){const e=n[Ii];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function PC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ii].modified_&&(Fv(e),gr(4)),_l(n)&&(n=Gp(e,n),e.parent_||Wp(e,n)),e.patches_&&vl("Patches").generateReplacementPatches_(t[Ii].base_,n,e.patches_,e.inversePatches_)):n=Gp(e,t,[]),Fv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==bb?n:void 0}function Gp(n,e,t){if(Wm(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ii];if(!r)return Bp(e,(s,o)=>bC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Wp(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Bp(o,(u,h)=>bC(n,r,s,u,h,t,l),i),Wp(n,s,!1),t&&n.patches_&&vl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function bC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Wm(r);if(!(l&&!o)){if(fu(r)){const u=s&&e&&e.type_!==3&&!Lv(e.assigned_,i)?s.concat(i):void 0,h=Gp(n,r,u);if(Db(t,i,h),fu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(_l(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;Gp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(af(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Wp(n,r)}}}function Wp(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Ux(e,t)}function kU(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:Nb(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=zx;t&&(r=[i],s=kd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var zx={get(n,e){if(e===Ii)return n;const t=za(n);if(!Lv(t,e))return DU(n,t,e);const i=t[e];return n.finalized_||!_l(i)?i:i===M0(n.base_,e)?(L0(n),n.copy_[e]=Uv(i,n)):i},has(n,e){return e in za(n)},ownKeys(n){return Reflect.ownKeys(za(n))},set(n,e,t){const i=Mb(za(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=M0(za(n),e),s=r?.[Ii];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(CU(t,r)&&(t!==void 0||Lv(n.base_,e)))return!0;L0(n),jv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return M0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,L0(n),jv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=za(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){gr(11)},getPrototypeOf(n){return Pd(n.base_)},setPrototypeOf(){gr(12)}},kd={};Bp(zx,(n,e)=>{kd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});kd.deleteProperty=function(n,e){return kd.set.call(this,n,e,void 0)};kd.set=function(n,e,t){return zx.set.call(this,n[0],e,t,n[0])};function M0(n,e){const t=n[Ii];return(t?za(t):n)[e]}function DU(n,e,t){const i=Mb(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function Mb(n,e){if(!(e in n))return;let t=Pd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Pd(t)}}function jv(n){n.modified_||(n.modified_=!0,n.parent_&&jv(n.parent_))}function L0(n){n.copy_||(n.copy_=Ov(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var NU=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&gr(6),i!==void 0&&typeof i!="function"&&gr(7);let r;if(_l(e)){const s=AC(this),o=Uv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Fv(s):Vv(s)}return RC(s,i),PC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===bb&&(r=void 0),this.autoFreeze_&&Ux(r,!0),i){const s=[],o=[];vl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else gr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){_l(n)||gr(8),fu(n)&&(n=MU(n));const e=AC(this),t=Uv(n,void 0);return t[Ii].isManual_=!0,Vv(e),t}finishDraft(n,e){const t=n&&n[Ii];(!t||!t.isManual_)&&gr(9);const{scope_:i}=t;return RC(i,e),PC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=vl("Patches").applyPatches_;return fu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Uv(n,e){const t=af(n)?vl("MapSet").proxyMap_(n,e):Gm(n)?vl("MapSet").proxySet_(n,e):kU(n,e);return(e?e.scope_:Nb()).drafts_.push(t),t}function MU(n){return fu(n)||gr(10,n),Lb(n)}function Lb(n){if(!_l(n)||Wm(n))return n;const e=n[Ii];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Ov(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Ov(n,!0);return Bp(t,(r,s)=>{Db(t,r,Lb(s))},i),e&&(e.finalized_=!1),t}var LU=new NU,OU=LU.produce;const FU=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?OU(r):r;return e(l,s,...o)},n(i.setState,t,i)),$m=FU,Wi=Ir()($m((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),Ob={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Bg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-4erDpAzY.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Bg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-Dukg-Vc-.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Bg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-DdPJg6Hk.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Bg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-vujNBosZ.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function VU(){return Object.values(Ob).filter(n=>n.immediateLoad)}const Qs=Ir()($m((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),qo=Ir()($m((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=Ob[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=Qs.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),ii=Ir()($m(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),jU={};function UU(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Dd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Dd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Dd(i)(t)}}}},zU=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:S=>S,version:0,merge:(S,P)=>({...P,...S}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...S)},i,r);const f=Dd(s.serialize),p=()=>{const S=s.partialize({...i()});let P;const N=f({state:S,version:s.version}).then(D=>h.setItem(s.name,D)).catch(D=>{P=D});if(P)throw P;return N},y=r.setState;r.setState=(S,P)=>{y(S,P),p()};const E=n((...S)=>{t(...S),p()},i,r);let T;const I=()=>{var S;if(!h)return;o=!1,l.forEach(N=>N(i()));const P=((S=s.onRehydrateStorage)==null?void 0:S.call(s,i()))||void 0;return Dd(h.getItem.bind(h))(s.name).then(N=>{if(N)return s.deserialize(N)}).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==s.version){if(s.migrate)return s.migrate(N.state,N.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return N.state}).then(N=>{var D;return T=s.merge(N,(D=i())!=null?D:E),t(T,!0),p()}).then(()=>{P?.(T,void 0),o=!0,u.forEach(N=>N(T))}).catch(N=>{P?.(void 0,N)})};return r.persist={setOptions:S=>{s={...s,...S},S.getStorage&&(h=S.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:S=>(l.add(S),()=>{l.delete(S)}),onFinishHydration:S=>(u.add(S),()=>{u.delete(S)})},I(),T||E},BU=(n,e)=>(t,i,r)=>{let s={storage:UU(()=>localStorage),partialize:I=>I,version:0,merge:(I,S)=>({...S,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},p=r.setState;r.setState=(I,S)=>{p(I,S),f()};const y=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>y;let E;const T=()=>{var I,S;if(!h)return;o=!1,l.forEach(N=>{var D;return N((D=i())!=null?D:y)});const P=((S=s.onRehydrateStorage)==null?void 0:S.call(s,(I=i())!=null?I:y))||void 0;return Dd(h.getItem.bind(h))(s.name).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==s.version){if(s.migrate)return[!0,s.migrate(N.state,N.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,N.state];return[!1,void 0]}).then(N=>{var D;const[L,F]=N;if(E=s.merge(F,(D=i())!=null?D:y),t(E,!0),L)return f()}).then(()=>{P?.(E,void 0),E=i(),o=!0,u.forEach(N=>N(E))}).catch(N=>{P?.(void 0,N)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||T(),E||y},GU=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((jU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),zU(n,e)):BU(n,e),lf=GU,ln=Ir()(lf(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,widgetOrder:["wind","tide","forecast","waterData"],setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e}),setWidgetOrder:e=>n({widgetOrder:e})}),{name:"visapp-settings"})),Fb=Ir()(lf((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),Vb=Ir((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],precipitation15min:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code,precipitation",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code,precipitation_probability,precipitation",minutely_15:"precipitation",past_hours:"24",forecast_hours:"48",past_minutely_15:"0",forecast_minutely_15:"8",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[],h=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((f,p)=>({time:f,pressure:o.hourly.surface_pressure[p]})),u=o.hourly.time.map((f,p)=>({time:f,temperature:o.hourly.temperature_2m[p],windSpeed:o.hourly.wind_speed_10m[p],windDirection:o.hourly.wind_direction_10m[p],pressure:o.hourly.surface_pressure[p],weatherCode:o.hourly.weather_code[p],precipitationProbability:o.hourly.precipitation_probability?.[p]||0,precipitation:o.hourly.precipitation?.[p]||0}))),o.minutely_15?.time&&o.minutely_15?.precipitation&&(h=o.minutely_15.time.map((f,p)=>({time:f,precipitation:o.minutely_15.precipitation[p]||0}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,precipitation15min:h,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),jb=Ir()(lf(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),kC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],DC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],WU=Ir()(lf((n,e)=>({presets:kC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=qo.getState().setLayerVisibility;DC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=qo.getState().visible,r=DC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:kC})}}),{name:"visapp-presets"})),$U=()=>{};var NC={};const Ub=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},KU=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},zb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,E=h&63;u||(E=64,o||(y=64)),i.push(t[f],t[p],t[y],t[E])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ub(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):KU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new HU;const y=s<<2|l>>4;if(i.push(y),h!==64){const E=l<<4&240|h>>2;if(i.push(E),p!==64){const T=h<<6&192|p;i.push(T)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class HU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qU=function(n){const e=Ub(n);return zb.encodeByteArray(e,!0)},$p=function(n){return qU(n).replace(/\./g,"")},Bb=function(n){try{return zb.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Gb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const XU=()=>Gb().__FIREBASE_DEFAULTS__,YU=()=>{if(typeof process>"u"||typeof NC>"u")return;const n=NC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ZU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Bb(n[1]);return e&&JSON.parse(e)},Km=()=>{try{return $U()||XU()||YU()||ZU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Wb=n=>Km()?.emulatorHosts?.[n],$b=n=>{const e=Wb(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Kb=()=>Km()?.config,Hb=n=>Km()?.[`_${n}`];class QU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Nl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Bx(n){return(await fetch(n,{credentials:"include"})).ok}function qb(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[$p(JSON.stringify(t)),$p(JSON.stringify(o)),""].join(".")}const td={};function JU(){const n={prod:[],emulator:[]};for(const e of Object.keys(td))td[e]?n.emulator.push(e):n.prod.push(e);return n}function e9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let MC=!1;function Gx(n,e){if(typeof window>"u"||typeof document>"u"||!Nl(window.location.host)||td[n]===e||td[n]||MC)return;td[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=JU().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,E){y.setAttribute("width","24"),y.setAttribute("id",E),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{MC=!0,o()},y}function f(y,E){y.setAttribute("id",E),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){const y=e9(i),E=t("text"),T=document.getElementById(E)||document.createElement("span"),I=t("learnmore"),S=document.getElementById(I)||document.createElement("a"),P=t("preprendIcon"),N=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const D=y.element;l(D),f(S,I);const L=h();u(N,P),D.append(N,T,S,L),document.body.appendChild(D)}s?(T.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function Xb(){const n=Km()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function i9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function r9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function s9(){const n=Jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Yb(){return!Xb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zb(){return!Xb()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Qb(){try{return typeof indexedDB=="object"}catch{return!1}}function o9(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const a9="FirebaseError";class us extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=a9,Object.setPrototypeOf(this,us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cf.prototype.create)}}class cf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?l9(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new us(r,l,i)}}function l9(n,e){return n.replace(c9,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const c9=/\{\$([^}]+)}/g;function u9(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function xl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(LC(s)&&LC(o)){if(!xl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function LC(n){return n!==null&&typeof n=="object"}function uf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function h9(n,e){const t=new d9(n,e);return t.subscribe.bind(t)}class d9{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");f9(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=O0),r.error===void 0&&(r.error=O0),r.complete===void 0&&(r.complete=O0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function f9(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function O0(){}function Js(n){return n&&n._delegate?n._delegate:n}class ta{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ba="[DEFAULT]";class g9{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new QU;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(m9(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:p9(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function p9(n){return n===Ba?void 0:n}function m9(n){return n.instantiationMode==="EAGER"}class y9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new g9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const _9={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},v9=Ke.INFO,x9={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},w9=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=x9[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wx{constructor(e){this.name=e,this._logLevel=v9,this._logHandler=w9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const E9=(n,e)=>e.some(t=>n instanceof t);let OC,FC;function T9(){return OC||(OC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function S9(){return FC||(FC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jb=new WeakMap,zv=new WeakMap,ek=new WeakMap,F0=new WeakMap,$x=new WeakMap;function I9(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Xo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Jb.set(t,n)}).catch(()=>{}),$x.set(e,n),e}function C9(n){if(zv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});zv.set(n,e)}let Bv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return zv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ek.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function R9(n){Bv=n(Bv)}function A9(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(V0(this),e,...t);return ek.set(i,e.sort?e.sort():[e]),Xo(i)}:S9().includes(n)?function(...e){return n.apply(V0(this),e),Xo(Jb.get(this))}:function(...e){return Xo(n.apply(V0(this),e))}}function P9(n){return typeof n=="function"?A9(n):(n instanceof IDBTransaction&&C9(n),E9(n,T9())?new Proxy(n,Bv):n)}function Xo(n){if(n instanceof IDBRequest)return I9(n);if(F0.has(n))return F0.get(n);const e=P9(n);return e!==n&&(F0.set(n,e),$x.set(e,n)),e}const V0=n=>$x.get(n);function b9(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Xo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Xo(o.result),u.oldVersion,u.newVersion,Xo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const k9=["get","getKey","getAll","getAllKeys","count"],D9=["put","add","delete","clear"],j0=new Map;function VC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(j0.get(e))return j0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=D9.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||k9.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return j0.set(e,s),s}R9(n=>({...n,get:(e,t,i)=>VC(e,t)||n.get(e,t,i),has:(e,t)=>!!VC(e,t)||n.has(e,t)}));class N9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(M9(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function M9(n){return n.getComponent()?.type==="VERSION"}const Gv="@firebase/app",jC="0.14.6";const Hs=new Wx("@firebase/app"),L9="@firebase/app-compat",O9="@firebase/analytics-compat",F9="@firebase/analytics",V9="@firebase/app-check-compat",j9="@firebase/app-check",U9="@firebase/auth",z9="@firebase/auth-compat",B9="@firebase/database",G9="@firebase/data-connect",W9="@firebase/database-compat",$9="@firebase/functions",K9="@firebase/functions-compat",H9="@firebase/installations",q9="@firebase/installations-compat",X9="@firebase/messaging",Y9="@firebase/messaging-compat",Z9="@firebase/performance",Q9="@firebase/performance-compat",J9="@firebase/remote-config",ez="@firebase/remote-config-compat",tz="@firebase/storage",nz="@firebase/storage-compat",iz="@firebase/firestore",rz="@firebase/ai",sz="@firebase/firestore-compat",oz="firebase",az="12.6.0";const Wv="[DEFAULT]",lz={[Gv]:"fire-core",[L9]:"fire-core-compat",[F9]:"fire-analytics",[O9]:"fire-analytics-compat",[j9]:"fire-app-check",[V9]:"fire-app-check-compat",[U9]:"fire-auth",[z9]:"fire-auth-compat",[B9]:"fire-rtdb",[G9]:"fire-data-connect",[W9]:"fire-rtdb-compat",[$9]:"fire-fn",[K9]:"fire-fn-compat",[H9]:"fire-iid",[q9]:"fire-iid-compat",[X9]:"fire-fcm",[Y9]:"fire-fcm-compat",[Z9]:"fire-perf",[Q9]:"fire-perf-compat",[J9]:"fire-rc",[ez]:"fire-rc-compat",[tz]:"fire-gcs",[nz]:"fire-gcs-compat",[iz]:"fire-fst",[sz]:"fire-fst-compat",[rz]:"fire-vertex","fire-js":"fire-js",[oz]:"fire-js-all"};const Kp=new Map,cz=new Map,$v=new Map;function UC(n,e){try{n.container.addComponent(e)}catch(t){Hs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wl(n){const e=n.name;if($v.has(e))return Hs.debug(`There were multiple attempts to register component ${e}.`),!1;$v.set(e,n);for(const t of Kp.values())UC(t,n);for(const t of cz.values())UC(t,n);return!0}function Hm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $i(n){return n==null?!1:n.settings!==void 0}const uz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yo=new cf("app","Firebase",uz);class hz{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ta("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yo.create("app-deleted",{appName:this._name})}}const Ml=az;function tk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Wv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Yo.create("bad-app-name",{appName:String(r)});if(t||(t=Kb()),!t)throw Yo.create("no-options");const s=Kp.get(r);if(s){if(xl(t,s.options)&&xl(i,s.config))return s;throw Yo.create("duplicate-app",{appName:r})}const o=new y9(r);for(const u of $v.values())o.addComponent(u);const l=new hz(t,i,o);return Kp.set(r,l),l}function Kx(n=Wv){const e=Kp.get(n);if(!e&&n===Wv&&Kb())return tk();if(!e)throw Yo.create("no-app",{appName:n});return e}function is(n,e,t){let i=lz[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hs.warn(o.join(" "));return}wl(new ta(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const dz="firebase-heartbeat-database",fz=1,Nd="firebase-heartbeat-store";let U0=null;function nk(){return U0||(U0=b9(dz,fz,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Nd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Yo.create("idb-open",{originalErrorMessage:n.message})})),U0}async function gz(n){try{const t=(await nk()).transaction(Nd),i=await t.objectStore(Nd).get(ik(n));return await t.done,i}catch(e){if(e instanceof us)Hs.warn(e.message);else{const t=Yo.create("idb-get",{originalErrorMessage:e?.message});Hs.warn(t.message)}}}async function zC(n,e){try{const i=(await nk()).transaction(Nd,"readwrite");await i.objectStore(Nd).put(e,ik(n)),await i.done}catch(t){if(t instanceof us)Hs.warn(t.message);else{const i=Yo.create("idb-set",{originalErrorMessage:t?.message});Hs.warn(i.message)}}}function ik(n){return`${n.name}!${n.options.appId}`}const pz=1024,mz=30;class yz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new vz(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=BC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>mz){const r=xz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Hs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=BC(),{heartbeatsToSend:t,unsentEntries:i}=_z(this._heartbeatsCache.heartbeats),r=$p(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Hs.warn(e),""}}}function BC(){return new Date().toISOString().substring(0,10)}function _z(n,e=pz){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),GC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),GC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class vz{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Qb()?o9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await gz(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return zC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return zC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function GC(n){return $p(JSON.stringify({version:2,heartbeats:n})).length}function xz(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function wz(n){wl(new ta("platform-logger",e=>new N9(e),"PRIVATE")),wl(new ta("heartbeat",e=>new yz(e),"PRIVATE")),is(Gv,jC,n),is(Gv,jC,"esm2020"),is("fire-js","")}wz("");function rk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ez=rk,sk=new cf("auth","Firebase",rk());const Hp=new Wx("@firebase/auth");function Tz(n,...e){Hp.logLevel<=Ke.WARN&&Hp.warn(`Auth (${Ml}): ${n}`,...e)}function op(n,...e){Hp.logLevel<=Ke.ERROR&&Hp.error(`Auth (${Ml}): ${n}`,...e)}function ss(n,...e){throw qx(n,...e)}function wr(n,...e){return qx(n,...e)}function Hx(n,e,t){const i={...Ez(),[e]:t};return new cf("auth","Firebase",i).create(e,{appName:n.name})}function al(n){return Hx(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Sz(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ss(n,"argument-error"),Hx(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function qx(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return sk.create(n,...e)}function Fe(n,e,...t){if(!n)throw qx(e,...t)}function Os(n){const e="INTERNAL ASSERTION FAILED: "+n;throw op(e),new Error(e)}function qs(n,e){n||Os(e)}function Kv(){return typeof self<"u"&&self.location?.href||""}function Iz(){return WC()==="http:"||WC()==="https:"}function WC(){return typeof self<"u"&&self.location?.protocol||null}function Cz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Iz()||i9()||"connection"in navigator)?navigator.onLine:!0}function Rz(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class hf{constructor(e,t){this.shortDelay=e,this.longDelay=t,qs(t>e,"Short delay should be less than long delay!"),this.isMobile=t9()||r9()}get(){return Cz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xx(n,e){qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class ok{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Az={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Pz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bz=new hf(3e4,6e4);function Yx(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Nu(n,e,t,i,r={}){return ak(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=uf({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return n9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Nl(n.emulatorConfig.host)&&(h.credentials="include"),ok.fetch()(await lk(n,n.config.apiHost,t,l),h)})}async function ak(n,e,t){n._canInitEmulator=!1;const i={...Az,...e};try{const r=new Dz(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Wg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Wg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Wg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Wg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Hx(n,f,h);ss(n,f)}}catch(r){if(r instanceof us)throw r;ss(n,"network-request-failed",{message:String(r)})}}async function kz(n,e,t,i,r={}){const s=await Nu(n,e,t,i,r);return"mfaPendingCredential"in s&&ss(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function lk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?Xx(n.config,r):`${n.config.apiScheme}://${r}`;return Pz.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class Dz{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(wr(this.auth,"network-request-failed")),bz.get())})}}function Wg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=wr(n,e,i);return r.customData._tokenResponse=t,r}async function Nz(n,e){return Nu(n,"POST","/v1/accounts:delete",e)}async function qp(n,e){return Nu(n,"POST","/v1/accounts:lookup",e)}function nd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Mz(n,e=!1){const t=Js(n),i=await t.getIdToken(e),r=Zx(i);Fe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:nd(z0(r.auth_time)),issuedAtTime:nd(z0(r.iat)),expirationTime:nd(z0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function z0(n){return Number(n)*1e3}function Zx(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return op("JWT malformed, contained fewer than 3 sections"),null;try{const r=Bb(t);return r?JSON.parse(r):(op("Failed to decode base64 JWT payload"),null)}catch(r){return op("Caught error parsing JWT payload as JSON",r?.toString()),null}}function $C(n){const e=Zx(n);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Md(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof us&&Lz(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Lz({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Oz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Hv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Xp(n){const e=n.auth,t=await n.getIdToken(),i=await Md(n,qp(e,{idToken:t}));Fe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?ck(r.providerUserInfo):[],o=Vz(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Hv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function Fz(n){const e=Js(n);await Xp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Vz(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function ck(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function jz(n,e){const t=await ak(n,{},async()=>{const i=uf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await lk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Nl(n.emulatorConfig.host)&&(u.credentials="include"),ok.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Uz(n,e){return Nu(n,"POST","/v2/accounts:revokeToken",Yx(n,e))}class Zc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$C(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const t=$C(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await jz(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Zc;return i&&(Fe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Fe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zc,this.toJSON())}_performRefresh(){return Os("not implemented")}}function bo(n,e){Fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class mr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new Oz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Hv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Md(this,this.stsTokenManager.getToken(this.auth,e));return Fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Mz(this,e)}reload(){return Fz(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Xp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($i(this.auth.app))return Promise.reject(al(this.auth));const e=await this.getIdToken();return await Md(this,Nz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:y,isAnonymous:E,providerData:T,stsTokenManager:I}=t;Fe(p&&I,e,"internal-error");const S=Zc.fromJSON(this.name,I);Fe(typeof p=="string",e,"internal-error"),bo(i,e.name),bo(r,e.name),Fe(typeof y=="boolean",e,"internal-error"),Fe(typeof E=="boolean",e,"internal-error"),bo(s,e.name),bo(o,e.name),bo(l,e.name),bo(u,e.name),bo(h,e.name),bo(f,e.name);const P=new mr({uid:p,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:E,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:S,createdAt:h,lastLoginAt:f});return T&&Array.isArray(T)&&(P.providerData=T.map(N=>({...N}))),u&&(P._redirectEventId=u),P}static async _fromIdTokenResponse(e,t,i=!1){const r=new Zc;r.updateFromServerResponse(t);const s=new mr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Xp(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Fe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?ck(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Zc;l.updateFromIdToken(i);const u=new mr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Hv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const KC=new Map;function Fs(n){qs(n instanceof Function,"Expected a class definition");let e=KC.get(n);return e?(qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,KC.set(n,e),e)}class uk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}uk.type="NONE";const HC=uk;function ap(n,e,t){return`firebase:${n}:${e}:${t}`}class Qc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=ap(this.userKey,r.apiKey,s),this.fullPersistenceKey=ap("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await qp(this.auth,{idToken:e}).catch(()=>{});return t?mr._fromGetAccountInfoResponse(this.auth,t,e):null}return mr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Qc(Fs(HC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Fs(HC);const o=ap(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const y=await qp(e,{idToken:f}).catch(()=>{});if(!y)break;p=await mr._fromGetAccountInfoResponse(e,y,f)}else p=mr._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Qc(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Qc(s,e,i))}}function qC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mk(e))return"Blackberry";if(yk(e))return"Webos";if(dk(e))return"Safari";if((e.includes("chrome/")||fk(e))&&!e.includes("edge/"))return"Chrome";if(pk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function hk(n=Jt()){return/firefox\//i.test(n)}function dk(n=Jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fk(n=Jt()){return/crios\//i.test(n)}function gk(n=Jt()){return/iemobile/i.test(n)}function pk(n=Jt()){return/android/i.test(n)}function mk(n=Jt()){return/blackberry/i.test(n)}function yk(n=Jt()){return/webos/i.test(n)}function Qx(n=Jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function zz(n=Jt()){return Qx(n)&&!!window.navigator?.standalone}function Bz(){return s9()&&document.documentMode===10}function _k(n=Jt()){return Qx(n)||pk(n)||yk(n)||mk(n)||/windows phone/i.test(n)||gk(n)}function vk(n,e=[]){let t;switch(n){case"Browser":t=qC(Jt());break;case"Worker":t=`${qC(Jt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ml}/${i}`}class Gz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Wz(n,e={}){return Nu(n,"GET","/v2/passwordPolicy",Yx(n,e))}const $z=6;class Kz{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??$z,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class Hz{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new XC(this),this.idTokenSubscription=new XC(this),this.beforeStateQueue=new Gz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Fs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await qp(this,{idToken:e}),i=await mr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if($i(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Xp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Rz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($i(this.app))return Promise.reject(al(this));const t=e?Js(e):null;return t&&Fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $i(this.app)?Promise.reject(al(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $i(this.app)?Promise.reject(al(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Wz(this),t=new Kz(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new cf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Uz(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Fs(e)||this._popupRedirectResolver;Fe(t,this,"argument-error"),this.redirectPersistenceManager=await Qc.create(this,[Fs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if($i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Tz(`Error while retrieving App Check token: ${e.error}`),e?.token}}function qm(n){return Js(n)}class XC{constructor(e){this.auth=e,this.observer=null,this.addObserver=h9(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Jx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qz(n){Jx=n}function Xz(n){return Jx.loadJS(n)}function Yz(){return Jx.gapiScript}function Zz(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Qz(n,e){const t=Hm(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(xl(s,e??{}))return r;ss(r,"already-initialized")}return t.initialize({options:e})}function Jz(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Fs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function eB(n,e,t){const i=qm(n);Fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=xk(e),{host:o,port:l}=tB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Fe(xl(h,i.config.emulator)&&xl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Nl(o)?(Bx(`${s}//${o}${u}`),Gx("Auth",!0)):nB()}function xk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function tB(n){const e=xk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:YC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:YC(o)}}}function YC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function nB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class wk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Os("not implemented")}_getIdTokenResponse(e){return Os("not implemented")}_linkToIdToken(e,t){return Os("not implemented")}_getReauthenticationResolver(e){return Os("not implemented")}}async function Jc(n,e){return kz(n,"POST","/v1/accounts:signInWithIdp",Yx(n,e))}const iB="http://localhost";class El extends wk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new El(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ss("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new El(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Jc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jc(e,t)}buildRequest(){const e={requestUri:iB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=uf(t)}return e}}class ew{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class df extends ew{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Vo extends df{constructor(){super("facebook.com")}static credential(e){return El._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vo.credential(e.oauthAccessToken)}catch{return null}}}Vo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vo.PROVIDER_ID="facebook.com";class Ms extends df{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return El._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ms.credential(t,i)}catch{return null}}}Ms.GOOGLE_SIGN_IN_METHOD="google.com";Ms.PROVIDER_ID="google.com";class jo extends df{constructor(){super("github.com")}static credential(e){return El._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.GITHUB_SIGN_IN_METHOD="github.com";jo.PROVIDER_ID="github.com";class Uo extends df{constructor(){super("twitter.com")}static credential(e,t){return El._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Uo.credential(t,i)}catch{return null}}}Uo.TWITTER_SIGN_IN_METHOD="twitter.com";Uo.PROVIDER_ID="twitter.com";class gu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await mr._fromIdTokenResponse(e,i,r),o=ZC(i);return new gu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=ZC(i);return new gu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function ZC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Yp extends us{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Yp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Yp(e,t,i,r)}}function Ek(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Yp._fromErrorAndOperation(n,s,e,i):s})}async function rB(n,e,t=!1){const i=await Md(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return gu._forOperation(n,"link",i)}async function sB(n,e,t=!1){const{auth:i}=n;if($i(i.app))return Promise.reject(al(i));const r="reauthenticate";try{const s=await Md(n,Ek(i,r,e,n),t);Fe(s.idToken,i,"internal-error");const o=Zx(s.idToken);Fe(o,i,"internal-error");const{sub:l}=o;return Fe(n.uid===l,i,"user-mismatch"),gu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&ss(i,"user-mismatch"),s}}async function oB(n,e,t=!1){if($i(n.app))return Promise.reject(al(n));const i="signIn",r=await Ek(n,i,e),s=await gu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function aB(n,e,t,i){return Js(n).onIdTokenChanged(e,t,i)}function lB(n,e,t){return Js(n).beforeAuthStateChanged(e,t)}function cB(n,e,t,i){return Js(n).onAuthStateChanged(e,t,i)}function uB(n){return Js(n).signOut()}const Zp="__sak";class Tk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Zp,"1"),this.storage.removeItem(Zp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const hB=1e3,dB=10;class Sk extends Tk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_k(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);Bz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,dB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},hB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sk.type="LOCAL";const fB=Sk;class Ik extends Tk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ik.type="SESSION";const Ck=Ik;function gB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Xm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Xm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await gB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xm.receivers=[];function tw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class pB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=tw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const y=p;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function rs(){return window}function mB(n){rs().location.href=n}function Rk(){return typeof rs().WorkerGlobalScope<"u"&&typeof rs().importScripts=="function"}async function yB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _B(){return navigator?.serviceWorker?.controller||null}function vB(){return Rk()?self:null}const Ak="firebaseLocalStorageDb",xB=1,Qp="firebaseLocalStorage",Pk="fbase_key";class ff{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ym(n,e){return n.transaction([Qp],e?"readwrite":"readonly").objectStore(Qp)}function wB(){const n=indexedDB.deleteDatabase(Ak);return new ff(n).toPromise()}function qv(){const n=indexedDB.open(Ak,xB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Qp,{keyPath:Pk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Qp)?e(i):(i.close(),await wB(),e(await qv()))})})}async function QC(n,e,t){const i=Ym(n,!0).put({[Pk]:e,value:t});return new ff(i).toPromise()}async function EB(n,e){const t=Ym(n,!1).get(e),i=await new ff(t).toPromise();return i===void 0?null:i.value}function JC(n,e){const t=Ym(n,!0).delete(e);return new ff(t).toPromise()}const TB=800,SB=3;class bk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>SB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xm._getInstance(vB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await yB(),!this.activeServiceWorker)return;this.sender=new pB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_B()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qv();return await QC(e,Zp,"1"),await JC(e,Zp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>QC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>EB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>JC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Ym(r,!1).getAll();return new ff(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),TB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bk.type="LOCAL";const IB=bk;new hf(3e4,6e4);function kk(n,e){return e?Fs(e):(Fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class nw extends wk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function CB(n){return oB(n.auth,new nw(n),n.bypassAuthState)}function RB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),sB(t,new nw(n),n.bypassAuthState)}async function AB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),rB(t,new nw(n),n.bypassAuthState)}class Dk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CB;case"linkViaPopup":case"linkViaRedirect":return AB;case"reauthViaPopup":case"reauthViaRedirect":return RB;default:ss(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const PB=new hf(2e3,1e4);async function bB(n,e,t){if($i(n.app))return Promise.reject(wr(n,"operation-not-supported-in-this-environment"));const i=qm(n);Sz(n,e,ew);const r=kk(i,t);return new tl(i,"signInViaPopup",e,r).executeNotNull()}class tl extends Dk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=tw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PB.get())};e()}}tl.currentPopupAction=null;const kB="pendingRedirect",lp=new Map;class DB extends Dk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=lp.get(this.auth._key());if(!e){try{const i=await NB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}lp.set(this.auth._key(),e)}return this.bypassAuthState||lp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function NB(n,e){const t=OB(e),i=LB(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function MB(n,e){lp.set(n._key(),e)}function LB(n){return Fs(n._redirectPersistence)}function OB(n){return ap(kB,n.config.apiKey,n.name)}async function FB(n,e,t=!1){if($i(n.app))return Promise.reject(al(n));const i=qm(n),r=kk(i,e),o=await new DB(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const VB=600*1e3;class jB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Nk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(wr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=VB&&this.cachedEventUids.clear(),this.cachedEventUids.has(eR(e))}saveEventToCache(e){this.cachedEventUids.add(eR(e)),this.lastProcessedEventTime=Date.now()}}function eR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Nk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function UB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Nk(n);default:return!1}}async function zB(n,e={}){return Nu(n,"GET","/v1/projects",e)}const BB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GB=/^https?/;async function WB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await zB(n);for(const t of e)try{if($B(t))return}catch{}ss(n,"unauthorized-domain")}function $B(n){const e=Kv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!GB.test(t))return!1;if(BB.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const KB=new hf(3e4,6e4);function tR(){const n=rs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function HB(n){return new Promise((e,t)=>{function i(){tR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tR(),t(wr(n,"network-request-failed"))},timeout:KB.get()})}if(rs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rs().gapi?.load)i();else{const r=Zz("iframefcb");return rs()[r]=()=>{gapi.load?i():t(wr(n,"network-request-failed"))},Xz(`${Yz()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw cp=null,e})}let cp=null;function qB(n){return cp=cp||HB(n),cp}const XB=new hf(5e3,15e3),YB="__/auth/iframe",ZB="emulator/auth/iframe",QB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function e8(n){const e=n.config;Fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Xx(e,ZB):`https://${n.config.authDomain}/${YB}`,i={apiKey:e.apiKey,appName:n.name,v:Ml},r=JB.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${uf(i).slice(1)}`}async function t8(n){const e=await qB(n),t=rs().gapi;return Fe(t,n,"internal-error"),e.open({where:document.body,url:e8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QB,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=wr(n,"network-request-failed"),l=rs().setTimeout(()=>{s(o)},XB.get());function u(){rs().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const n8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},i8=500,r8=600,s8="_blank",o8="http://localhost";class nR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function a8(n,e,t,i=i8,r=r8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...n8,width:i.toString(),height:r.toString(),top:s,left:o},h=Jt().toLowerCase();t&&(l=fk(h)?s8:t),hk(h)&&(e=e||o8,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[E,T])=>`${y}${E}=${T},`,"");if(zz(h)&&l!=="_self")return l8(e||"",l),new nR(null);const p=window.open(e||"",l,f);Fe(p,n,"popup-blocked");try{p.focus()}catch{}return new nR(p)}function l8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const c8="__/auth/handler",u8="emulator/auth/handler",h8=encodeURIComponent("fac");async function iR(n,e,t,i,r,s){Fe(n.config.authDomain,n,"auth-domain-config-required"),Fe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ml,eventId:r};if(e instanceof ew){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",u9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof df){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${h8}=${encodeURIComponent(u)}`:"";return`${d8(n)}?${uf(l).slice(1)}${h}`}function d8({config:n}){return n.emulator?Xx(n,u8):`https://${n.authDomain}/${c8}`}const B0="webStorageSupport";class f8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ck,this._completeRedirectFn=FB,this._overrideRedirectResult=MB}async _openPopup(e,t,i,r){qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await iR(e,t,i,Kv(),r);return a8(e,s,tw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await iR(e,t,i,Kv(),r);return mB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(qs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await t8(e),i=new jB(e);return t.register("authEvent",r=>(Fe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(B0,{type:B0},r=>{const s=r?.[0]?.[B0];s!==void 0&&t(!!s),ss(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=WB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _k()||dk()||Qx()}}const g8=f8;var rR="@firebase/auth",sR="1.12.0";class p8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function m8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function y8(n){wl(new ta("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vk(n)},h=new Hz(i,r,s,u);return Jz(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),wl(new ta("auth-internal",e=>{const t=qm(e.getProvider("auth").getImmediate());return(i=>new p8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),is(rR,sR,m8(n)),is(rR,sR,"esm2020")}const _8=300,v8=Hb("authIdTokenMaxAge")||_8;let oR=null;const x8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>v8)return;const r=t?.token;oR!==r&&(oR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function w8(n=Kx()){const e=Hm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Qz(n,{popupRedirectResolver:g8,persistence:[IB,fB,Ck]}),i=Hb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=x8(s.toString());lB(t,o,()=>o(t.currentUser)),aB(t,l=>o(l))}}const r=Wb("auth");return r&&eB(t,`http://${r}`),t}function E8(){return document.getElementsByTagName("head")?.[0]??document}qz({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=wr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",E8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});y8("Browser");var T8="firebase",S8="12.7.0";is(T8,S8,"app");var aR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var iw;(function(){var n;function e(b,R){function M(){}M.prototype=R.prototype,b.F=R.prototype,b.prototype=new M,b.prototype.constructor=b,b.D=function(V,j,z){for(var k=Array(arguments.length-2),re=2;re<arguments.length;re++)k[re-2]=arguments[re];return R.prototype[j].apply(V,k)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(b,R,M){M||(M=0);const V=Array(16);if(typeof R=="string")for(var j=0;j<16;++j)V[j]=R.charCodeAt(M++)|R.charCodeAt(M++)<<8|R.charCodeAt(M++)<<16|R.charCodeAt(M++)<<24;else for(j=0;j<16;++j)V[j]=R[M++]|R[M++]<<8|R[M++]<<16|R[M++]<<24;R=b.g[0],M=b.g[1],j=b.g[2];let z=b.g[3],k;k=R+(z^M&(j^z))+V[0]+3614090360&4294967295,R=M+(k<<7&4294967295|k>>>25),k=z+(j^R&(M^j))+V[1]+3905402710&4294967295,z=R+(k<<12&4294967295|k>>>20),k=j+(M^z&(R^M))+V[2]+606105819&4294967295,j=z+(k<<17&4294967295|k>>>15),k=M+(R^j&(z^R))+V[3]+3250441966&4294967295,M=j+(k<<22&4294967295|k>>>10),k=R+(z^M&(j^z))+V[4]+4118548399&4294967295,R=M+(k<<7&4294967295|k>>>25),k=z+(j^R&(M^j))+V[5]+1200080426&4294967295,z=R+(k<<12&4294967295|k>>>20),k=j+(M^z&(R^M))+V[6]+2821735955&4294967295,j=z+(k<<17&4294967295|k>>>15),k=M+(R^j&(z^R))+V[7]+4249261313&4294967295,M=j+(k<<22&4294967295|k>>>10),k=R+(z^M&(j^z))+V[8]+1770035416&4294967295,R=M+(k<<7&4294967295|k>>>25),k=z+(j^R&(M^j))+V[9]+2336552879&4294967295,z=R+(k<<12&4294967295|k>>>20),k=j+(M^z&(R^M))+V[10]+4294925233&4294967295,j=z+(k<<17&4294967295|k>>>15),k=M+(R^j&(z^R))+V[11]+2304563134&4294967295,M=j+(k<<22&4294967295|k>>>10),k=R+(z^M&(j^z))+V[12]+1804603682&4294967295,R=M+(k<<7&4294967295|k>>>25),k=z+(j^R&(M^j))+V[13]+4254626195&4294967295,z=R+(k<<12&4294967295|k>>>20),k=j+(M^z&(R^M))+V[14]+2792965006&4294967295,j=z+(k<<17&4294967295|k>>>15),k=M+(R^j&(z^R))+V[15]+1236535329&4294967295,M=j+(k<<22&4294967295|k>>>10),k=R+(j^z&(M^j))+V[1]+4129170786&4294967295,R=M+(k<<5&4294967295|k>>>27),k=z+(M^j&(R^M))+V[6]+3225465664&4294967295,z=R+(k<<9&4294967295|k>>>23),k=j+(R^M&(z^R))+V[11]+643717713&4294967295,j=z+(k<<14&4294967295|k>>>18),k=M+(z^R&(j^z))+V[0]+3921069994&4294967295,M=j+(k<<20&4294967295|k>>>12),k=R+(j^z&(M^j))+V[5]+3593408605&4294967295,R=M+(k<<5&4294967295|k>>>27),k=z+(M^j&(R^M))+V[10]+38016083&4294967295,z=R+(k<<9&4294967295|k>>>23),k=j+(R^M&(z^R))+V[15]+3634488961&4294967295,j=z+(k<<14&4294967295|k>>>18),k=M+(z^R&(j^z))+V[4]+3889429448&4294967295,M=j+(k<<20&4294967295|k>>>12),k=R+(j^z&(M^j))+V[9]+568446438&4294967295,R=M+(k<<5&4294967295|k>>>27),k=z+(M^j&(R^M))+V[14]+3275163606&4294967295,z=R+(k<<9&4294967295|k>>>23),k=j+(R^M&(z^R))+V[3]+4107603335&4294967295,j=z+(k<<14&4294967295|k>>>18),k=M+(z^R&(j^z))+V[8]+1163531501&4294967295,M=j+(k<<20&4294967295|k>>>12),k=R+(j^z&(M^j))+V[13]+2850285829&4294967295,R=M+(k<<5&4294967295|k>>>27),k=z+(M^j&(R^M))+V[2]+4243563512&4294967295,z=R+(k<<9&4294967295|k>>>23),k=j+(R^M&(z^R))+V[7]+1735328473&4294967295,j=z+(k<<14&4294967295|k>>>18),k=M+(z^R&(j^z))+V[12]+2368359562&4294967295,M=j+(k<<20&4294967295|k>>>12),k=R+(M^j^z)+V[5]+4294588738&4294967295,R=M+(k<<4&4294967295|k>>>28),k=z+(R^M^j)+V[8]+2272392833&4294967295,z=R+(k<<11&4294967295|k>>>21),k=j+(z^R^M)+V[11]+1839030562&4294967295,j=z+(k<<16&4294967295|k>>>16),k=M+(j^z^R)+V[14]+4259657740&4294967295,M=j+(k<<23&4294967295|k>>>9),k=R+(M^j^z)+V[1]+2763975236&4294967295,R=M+(k<<4&4294967295|k>>>28),k=z+(R^M^j)+V[4]+1272893353&4294967295,z=R+(k<<11&4294967295|k>>>21),k=j+(z^R^M)+V[7]+4139469664&4294967295,j=z+(k<<16&4294967295|k>>>16),k=M+(j^z^R)+V[10]+3200236656&4294967295,M=j+(k<<23&4294967295|k>>>9),k=R+(M^j^z)+V[13]+681279174&4294967295,R=M+(k<<4&4294967295|k>>>28),k=z+(R^M^j)+V[0]+3936430074&4294967295,z=R+(k<<11&4294967295|k>>>21),k=j+(z^R^M)+V[3]+3572445317&4294967295,j=z+(k<<16&4294967295|k>>>16),k=M+(j^z^R)+V[6]+76029189&4294967295,M=j+(k<<23&4294967295|k>>>9),k=R+(M^j^z)+V[9]+3654602809&4294967295,R=M+(k<<4&4294967295|k>>>28),k=z+(R^M^j)+V[12]+3873151461&4294967295,z=R+(k<<11&4294967295|k>>>21),k=j+(z^R^M)+V[15]+530742520&4294967295,j=z+(k<<16&4294967295|k>>>16),k=M+(j^z^R)+V[2]+3299628645&4294967295,M=j+(k<<23&4294967295|k>>>9),k=R+(j^(M|~z))+V[0]+4096336452&4294967295,R=M+(k<<6&4294967295|k>>>26),k=z+(M^(R|~j))+V[7]+1126891415&4294967295,z=R+(k<<10&4294967295|k>>>22),k=j+(R^(z|~M))+V[14]+2878612391&4294967295,j=z+(k<<15&4294967295|k>>>17),k=M+(z^(j|~R))+V[5]+4237533241&4294967295,M=j+(k<<21&4294967295|k>>>11),k=R+(j^(M|~z))+V[12]+1700485571&4294967295,R=M+(k<<6&4294967295|k>>>26),k=z+(M^(R|~j))+V[3]+2399980690&4294967295,z=R+(k<<10&4294967295|k>>>22),k=j+(R^(z|~M))+V[10]+4293915773&4294967295,j=z+(k<<15&4294967295|k>>>17),k=M+(z^(j|~R))+V[1]+2240044497&4294967295,M=j+(k<<21&4294967295|k>>>11),k=R+(j^(M|~z))+V[8]+1873313359&4294967295,R=M+(k<<6&4294967295|k>>>26),k=z+(M^(R|~j))+V[15]+4264355552&4294967295,z=R+(k<<10&4294967295|k>>>22),k=j+(R^(z|~M))+V[6]+2734768916&4294967295,j=z+(k<<15&4294967295|k>>>17),k=M+(z^(j|~R))+V[13]+1309151649&4294967295,M=j+(k<<21&4294967295|k>>>11),k=R+(j^(M|~z))+V[4]+4149444226&4294967295,R=M+(k<<6&4294967295|k>>>26),k=z+(M^(R|~j))+V[11]+3174756917&4294967295,z=R+(k<<10&4294967295|k>>>22),k=j+(R^(z|~M))+V[2]+718787259&4294967295,j=z+(k<<15&4294967295|k>>>17),k=M+(z^(j|~R))+V[9]+3951481745&4294967295,b.g[0]=b.g[0]+R&4294967295,b.g[1]=b.g[1]+(j+(k<<21&4294967295|k>>>11))&4294967295,b.g[2]=b.g[2]+j&4294967295,b.g[3]=b.g[3]+z&4294967295}i.prototype.v=function(b,R){R===void 0&&(R=b.length);const M=R-this.blockSize,V=this.C;let j=this.h,z=0;for(;z<R;){if(j==0)for(;z<=M;)r(this,b,z),z+=this.blockSize;if(typeof b=="string"){for(;z<R;)if(V[j++]=b.charCodeAt(z++),j==this.blockSize){r(this,V),j=0;break}}else for(;z<R;)if(V[j++]=b[z++],j==this.blockSize){r(this,V),j=0;break}}this.h=j,this.o+=R},i.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var R=1;R<b.length-8;++R)b[R]=0;R=this.o*8;for(var M=b.length-8;M<b.length;++M)b[M]=R&255,R/=256;for(this.v(b),b=Array(16),R=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)b[R++]=this.g[M]>>>V&255;return b};function s(b,R){var M=l;return Object.prototype.hasOwnProperty.call(M,b)?M[b]:M[b]=R(b)}function o(b,R){this.h=R;const M=[];let V=!0;for(let j=b.length-1;j>=0;j--){const z=b[j]|0;V&&z==R||(M[j]=z,V=!1)}this.g=M}var l={};function u(b){return-128<=b&&b<128?s(b,function(R){return new o([R|0],R<0?-1:0)}):new o([b|0],b<0?-1:0)}function h(b){if(isNaN(b)||!isFinite(b))return p;if(b<0)return S(h(-b));const R=[];let M=1;for(let V=0;b>=M;V++)R[V]=b/M|0,M*=4294967296;return new o(R,0)}function f(b,R){if(b.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(b.charAt(0)=="-")return S(f(b.substring(1),R));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=h(Math.pow(R,8));let V=p;for(let z=0;z<b.length;z+=8){var j=Math.min(8,b.length-z);const k=parseInt(b.substring(z,z+j),R);j<8?(j=h(Math.pow(R,j)),V=V.j(j).add(h(k))):(V=V.j(M),V=V.add(h(k)))}return V}var p=u(0),y=u(1),E=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-S(this).m();let b=0,R=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);b+=(V>=0?V:4294967296+V)*R,R*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(T(this))return"0";if(I(this))return"-"+S(this).toString(b);const R=h(Math.pow(b,6));var M=this;let V="";for(;;){const j=L(M,R).g;M=P(M,j.j(R));let z=((M.g.length>0?M.g[0]:M.h)>>>0).toString(b);if(M=j,T(M))return z+V;for(;z.length<6;)z="0"+z;V=z+V}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function T(b){if(b.h!=0)return!1;for(let R=0;R<b.g.length;R++)if(b.g[R]!=0)return!1;return!0}function I(b){return b.h==-1}n.l=function(b){return b=P(this,b),I(b)?-1:T(b)?0:1};function S(b){const R=b.g.length,M=[];for(let V=0;V<R;V++)M[V]=~b.g[V];return new o(M,~b.h).add(y)}n.abs=function(){return I(this)?S(this):this},n.add=function(b){const R=Math.max(this.g.length,b.g.length),M=[];let V=0;for(let j=0;j<=R;j++){let z=V+(this.i(j)&65535)+(b.i(j)&65535),k=(z>>>16)+(this.i(j)>>>16)+(b.i(j)>>>16);V=k>>>16,z&=65535,k&=65535,M[j]=k<<16|z}return new o(M,M[M.length-1]&-2147483648?-1:0)};function P(b,R){return b.add(S(R))}n.j=function(b){if(T(this)||T(b))return p;if(I(this))return I(b)?S(this).j(S(b)):S(S(this).j(b));if(I(b))return S(this.j(S(b)));if(this.l(E)<0&&b.l(E)<0)return h(this.m()*b.m());const R=this.g.length+b.g.length,M=[];for(var V=0;V<2*R;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let j=0;j<b.g.length;j++){const z=this.i(V)>>>16,k=this.i(V)&65535,re=b.i(j)>>>16,pe=b.i(j)&65535;M[2*V+2*j]+=k*pe,N(M,2*V+2*j),M[2*V+2*j+1]+=z*pe,N(M,2*V+2*j+1),M[2*V+2*j+1]+=k*re,N(M,2*V+2*j+1),M[2*V+2*j+2]+=z*re,N(M,2*V+2*j+2)}for(b=0;b<R;b++)M[b]=M[2*b+1]<<16|M[2*b];for(b=R;b<2*R;b++)M[b]=0;return new o(M,0)};function N(b,R){for(;(b[R]&65535)!=b[R];)b[R+1]+=b[R]>>>16,b[R]&=65535,R++}function D(b,R){this.g=b,this.h=R}function L(b,R){if(T(R))throw Error("division by zero");if(T(b))return new D(p,p);if(I(b))return R=L(S(b),R),new D(S(R.g),S(R.h));if(I(R))return R=L(b,S(R)),new D(S(R.g),R.h);if(b.g.length>30){if(I(b)||I(R))throw Error("slowDivide_ only works with positive integers.");for(var M=y,V=R;V.l(b)<=0;)M=F(M),V=F(V);var j=B(M,1),z=B(V,1);for(V=B(V,2),M=B(M,2);!T(V);){var k=z.add(V);k.l(b)<=0&&(j=j.add(M),z=k),V=B(V,1),M=B(M,1)}return R=P(b,j.j(R)),new D(j,R)}for(j=p;b.l(R)>=0;){for(M=Math.max(1,Math.floor(b.m()/R.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),z=h(M),k=z.j(R);I(k)||k.l(b)>0;)M-=V,z=h(M),k=z.j(R);T(z)&&(z=y),j=j.add(z),b=P(b,k)}return new D(j,b)}n.B=function(b){return L(this,b).h},n.and=function(b){const R=Math.max(this.g.length,b.g.length),M=[];for(let V=0;V<R;V++)M[V]=this.i(V)&b.i(V);return new o(M,this.h&b.h)},n.or=function(b){const R=Math.max(this.g.length,b.g.length),M=[];for(let V=0;V<R;V++)M[V]=this.i(V)|b.i(V);return new o(M,this.h|b.h)},n.xor=function(b){const R=Math.max(this.g.length,b.g.length),M=[];for(let V=0;V<R;V++)M[V]=this.i(V)^b.i(V);return new o(M,this.h^b.h)};function F(b){const R=b.g.length+1,M=[];for(let V=0;V<R;V++)M[V]=b.i(V)<<1|b.i(V-1)>>>31;return new o(M,b.h)}function B(b,R){const M=R>>5;R%=32;const V=b.g.length-M,j=[];for(let z=0;z<V;z++)j[z]=R>0?b.i(z+M)>>>R|b.i(z+M+1)<<32-R:b.i(z+M);return new o(j,b.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,iw=o}).apply(typeof aR<"u"?aR:typeof self<"u"?self:typeof window<"u"?window:{});var $g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Mk,Hh,Lk,up,Xv,Ok,Fk,Vk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof $g=="object"&&$g];for(var w=0;w<g.length;++w){var C=g[w];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(g,w){if(w)e:{var C=i;g=g.split(".");for(var O=0;O<g.length-1;O++){var q=g[O];if(!(q in C))break e;C=C[q]}g=g[g.length-1],O=C[g],w=w(O),w!=O&&w!=null&&e(C,g,{configurable:!0,writable:!0,value:w})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(w){var C=[],O;for(O in w)Object.prototype.hasOwnProperty.call(w,O)&&C.push([O,w[O]]);return C}});var s=s||{},o=this||self;function l(g){var w=typeof g;return w=="object"&&g!=null||w=="function"}function u(g,w,C){return g.call.apply(g.bind,arguments)}function h(g,w,C){return h=u,h.apply(null,arguments)}function f(g,w){var C=Array.prototype.slice.call(arguments,1);return function(){var O=C.slice();return O.push.apply(O,arguments),g.apply(this,O)}}function p(g,w){function C(){}C.prototype=w.prototype,g.Z=w.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(O,q,ee){for(var de=Array(arguments.length-2),je=2;je<arguments.length;je++)de[je-2]=arguments[je];return w.prototype[q].apply(O,de)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function E(g){const w=g.length;if(w>0){const C=Array(w);for(let O=0;O<w;O++)C[O]=g[O];return C}return[]}function T(g,w){for(let O=1;O<arguments.length;O++){const q=arguments[O];var C=typeof q;if(C=C!="object"?C:q?Array.isArray(q)?"array":C:"null",C=="array"||C=="object"&&typeof q.length=="number"){C=g.length||0;const ee=q.length||0;g.length=C+ee;for(let de=0;de<ee;de++)g[C+de]=q[de]}else g.push(q)}}class I{constructor(w,C){this.i=w,this.j=C,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function S(g){o.setTimeout(()=>{throw g},0)}function P(){var g=b;let w=null;return g.g&&(w=g.g,g.g=g.g.next,g.g||(g.h=null),w.next=null),w}class N{constructor(){this.h=this.g=null}add(w,C){const O=D.get();O.set(w,C),this.h?this.h.next=O:this.g=O,this.h=O}}var D=new I(()=>new L,g=>g.reset());class L{constructor(){this.next=this.g=this.h=null}set(w,C){this.h=w,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let F,B=!1,b=new N,R=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(M)}};function M(){for(var g;g=P();){try{g.h.call(g.g)}catch(C){S(C)}var w=D;w.j(g),w.h<100&&(w.h++,g.next=w.g,w.g=g)}B=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,w){this.type=g,this.g=this.target=w,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,w=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};o.addEventListener("test",C,w),o.removeEventListener("test",C,w)}catch{}return g})();function k(g){return/^[\s\xa0]*$/.test(g)}function re(g,w){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,w)}p(re,j),re.prototype.init=function(g,w){const C=this.type=g.type,O=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=w,w=g.relatedTarget,w||(C=="mouseover"?w=g.fromElement:C=="mouseout"&&(w=g.toElement)),this.relatedTarget=w,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&re.Z.h.call(this)},re.prototype.h=function(){re.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var pe="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ue(g,w,C,O,q){this.listener=g,this.proxy=null,this.src=w,this.type=C,this.capture=!!O,this.ha=q,this.key=++ge,this.da=this.fa=!1}function Q(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function oe(g,w,C){for(const O in g)w.call(C,g[O],O,g)}function ne(g,w){for(const C in g)w.call(void 0,g[C],C,g)}function W(g){const w={};for(const C in g)w[C]=g[C];return w}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(g,w){let C,O;for(let q=1;q<arguments.length;q++){O=arguments[q];for(C in O)g[C]=O[C];for(let ee=0;ee<$.length;ee++)C=$[ee],Object.prototype.hasOwnProperty.call(O,C)&&(g[C]=O[C])}}function me(g){this.src=g,this.g={},this.h=0}me.prototype.add=function(g,w,C,O,q){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const de=be(g,w,O,q);return de>-1?(w=g[de],C||(w.fa=!1)):(w=new ue(w,this.src,ee,!!O,q),w.fa=C,g.push(w)),w};function xe(g,w){const C=w.type;if(C in g.g){var O=g.g[C],q=Array.prototype.indexOf.call(O,w,void 0),ee;(ee=q>=0)&&Array.prototype.splice.call(O,q,1),ee&&(Q(w),g.g[C].length==0&&(delete g.g[C],g.h--))}}function be(g,w,C,O){for(let q=0;q<g.length;++q){const ee=g[q];if(!ee.da&&ee.listener==w&&ee.capture==!!C&&ee.ha==O)return q}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),Ve={};function Ge(g,w,C,O,q){if(Array.isArray(w)){for(let ee=0;ee<w.length;ee++)Ge(g,w[ee],C,O,q);return null}return C=Ri(C),g&&g[pe]?g.J(w,C,l(O)?!!O.capture:!1,q):lt(g,w,C,!1,O,q)}function lt(g,w,C,O,q,ee){if(!w)throw Error("Invalid event type");const de=l(q)?!!q.capture:!!q;let je=dn(g);if(je||(g[Me]=je=new me(g)),C=je.add(w,C,O,de,ee),C.proxy)return C;if(O=Qi(),C.proxy=O,O.src=g,O.listener=C,g.addEventListener)z||(q=de),q===void 0&&(q=!1),g.addEventListener(w.toString(),O,q);else if(g.attachEvent)g.attachEvent($n(w.toString()),O);else if(g.addListener&&g.removeListener)g.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Qi(){function g(C){return w.call(g.src,g.listener,C)}const w=hn;return g}function ds(g,w,C,O,q){if(Array.isArray(w))for(var ee=0;ee<w.length;ee++)ds(g,w[ee],C,O,q);else O=l(O)?!!O.capture:!!O,C=Ri(C),g&&g[pe]?(g=g.i,ee=String(w).toString(),ee in g.g&&(w=g.g[ee],C=be(w,C,O,q),C>-1&&(Q(w[C]),Array.prototype.splice.call(w,C,1),w.length==0&&(delete g.g[ee],g.h--)))):g&&(g=dn(g))&&(w=g.g[w.toString()],g=-1,w&&(g=be(w,C,O,q)),(C=g>-1?w[g]:null)&&Wn(C))}function Wn(g){if(typeof g!="number"&&g&&!g.da){var w=g.src;if(w&&w[pe])xe(w.i,g);else{var C=g.type,O=g.proxy;w.removeEventListener?w.removeEventListener(C,O,g.capture):w.detachEvent?w.detachEvent($n(C),O):w.addListener&&w.removeListener&&w.removeListener(O),(C=dn(w))?(xe(C,g),C.h==0&&(C.src=null,w[Me]=null)):Q(g)}}}function $n(g){return g in Ve?Ve[g]:Ve[g]="on"+g}function hn(g,w){if(g.da)g=!0;else{w=new re(w,this);const C=g.listener,O=g.ha||g.src;g.fa&&Wn(g),g=C.call(O,w)}return g}function dn(g){return g=g[Me],g instanceof me?g:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ri(g){return typeof g=="function"?g:(g[Kn]||(g[Kn]=function(w){return g.handleEvent(w)}),g[Kn])}function yt(){V.call(this),this.i=new me(this),this.M=this,this.G=null}p(yt,V),yt.prototype[pe]=!0,yt.prototype.removeEventListener=function(g,w,C,O){ds(this,g,w,C,O)};function ct(g,w){var C,O=g.G;if(O)for(C=[];O;O=O.G)C.push(O);if(g=g.M,O=w.type||w,typeof w=="string")w=new j(w,g);else if(w instanceof j)w.target=w.target||g;else{var q=w;w=new j(O,g),ie(w,q)}q=!0;let ee,de;if(C)for(de=C.length-1;de>=0;de--)ee=w.g=C[de],q=tn(ee,O,!0,w)&&q;if(ee=w.g=g,q=tn(ee,O,!0,w)&&q,q=tn(ee,O,!1,w)&&q,C)for(de=0;de<C.length;de++)ee=w.g=C[de],q=tn(ee,O,!1,w)&&q}yt.prototype.N=function(){if(yt.Z.N.call(this),this.i){var g=this.i;for(const w in g.g){const C=g.g[w];for(let O=0;O<C.length;O++)Q(C[O]);delete g.g[w],g.h--}}this.G=null},yt.prototype.J=function(g,w,C,O){return this.i.add(String(g),w,!1,C,O)},yt.prototype.K=function(g,w,C,O){return this.i.add(String(g),w,!0,C,O)};function tn(g,w,C,O){if(w=g.i.g[String(w)],!w)return!0;w=w.concat();let q=!0;for(let ee=0;ee<w.length;++ee){const de=w[ee];if(de&&!de.da&&de.capture==C){const je=de.listener,Vt=de.ha||de.src;de.fa&&xe(g.i,de),q=je.call(Vt,O)!==!1&&q}}return q&&!O.defaultPrevented}function Ai(g,w){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:o.setTimeout(g,w||0)}function St(g){g.g=Ai(()=>{g.g=null,g.i&&(g.i=!1,St(g))},g.l);const w=g.h;g.h=null,g.m.apply(null,w)}class eo extends V{constructor(w,C){super(),this.m=w,this.l=C,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:St(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pi(g){V.call(this),this.h=g,this.g={}}p(Pi,V);var Cr=[];function Ji(g){oe(g.g,function(w,C){this.g.hasOwnProperty(C)&&Wn(w)},g),g.g={}}Pi.prototype.N=function(){Pi.Z.N.call(this),Ji(this)},Pi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rr=o.JSON.stringify,ca=o.JSON.parse,Ar=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function bi(){}function Ol(){}var Pr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fs(){j.call(this,"d")}p(fs,j);function to(){j.call(this,"c")}p(to,j);var On={},gs=null;function br(){return gs=gs||new yt}On.Ia="serverreachability";function kr(g){j.call(this,On.Ia,g)}p(kr,j);function Fn(g){const w=br();ct(w,new kr(w))}On.STAT_EVENT="statevent";function Vn(g,w){j.call(this,On.STAT_EVENT,g),this.stat=w}p(Vn,j);function ft(g){const w=br();ct(w,new Vn(w,g))}On.Ja="timingevent";function no(g,w){j.call(this,On.Ja,g),this.size=w}p(no,j);function er(g,w){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},w)}function Ot(){this.g=!0}Ot.prototype.ua=function(){this.g=!1};function ki(g,w,C,O,q,ee){g.info(function(){if(g.g)if(ee){var de="",je=ee.split("&");for(let ut=0;ut<je.length;ut++){var Vt=je[ut].split("=");if(Vt.length>1){const Gt=Vt[0];Vt=Vt[1];const pi=Gt.split("_");de=pi.length>=2&&pi[1]=="type"?de+(Gt+"="+Vt+"&"):de+(Gt+"=redacted&")}}}else de=null;else de=ee;return"XMLHTTP REQ ("+O+") [attempt "+q+"]: "+w+`
`+C+`
`+de})}function fn(g,w,C,O,q,ee,de){g.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+q+"]: "+w+`
`+C+`
`+ee+" "+de})}function Ft(g,w,C,O){g.info(function(){return"XMLHTTP TEXT ("+w+"): "+pn(g,C)+(O?" "+O:"")})}function gn(g,w){g.info(function(){return"TIMEOUT: "+w})}Ot.prototype.info=function(){};function pn(g,w){if(!g.g)return w;if(!w)return null;try{const ee=JSON.parse(w);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var C=ee[g];if(!(C.length<2)){var O=C[1];if(Array.isArray(O)&&!(O.length<1)){var q=O[0];if(q!="noop"&&q!="stop"&&q!="close")for(let de=1;de<O.length;de++)O[de]=""}}}}return Rr(ee)}catch{return w}}var nn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bt;function qt(){}p(qt,bi),qt.prototype.g=function(){return new XMLHttpRequest},Bt=new qt;function Di(g){return encodeURIComponent(String(g))}function Fl(g){var w=1;g=g.split(":");const C=[];for(;w>0&&g.length;)C.push(g.shift()),w--;return g.length&&C.push(g.join(":")),C}function Ni(g,w,C,O){this.j=g,this.i=w,this.l=C,this.S=O||1,this.V=new Pi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new _f}function _f(){this.i=null,this.g="",this.h=!1}var vf={},Ou={};function tr(g,w,C){g.M=1,g.A=ms(Mi(w)),g.u=C,g.R=!0,Fu(g,null)}function Fu(g,w){g.F=Date.now(),ua(g),g.B=Mi(g.A);var C=g.B,O=g.S;Array.isArray(O)||(O=[String(O)]),Hu(C.i,"t",O),g.C=0,C=g.j.L,g.h=new _f,g.g=Pf(g.j,C?w:null,!g.u),g.P>0&&(g.O=new eo(h(g.Y,g,g.g),g.P)),w=g.V,C=g.g,O=g.ba;var q="readystatechange";Array.isArray(q)||(q&&(Cr[0]=q.toString()),q=Cr);for(let ee=0;ee<q.length;ee++){const de=Ge(C,q[ee],O||w.handleEvent,!1,w.h||w);if(!de)break;w.g[de.key]=de}w=g.J?W(g.J):{},g.u?(g.v||(g.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,w)):(g.v="GET",g.g.ea(g.B,g.v,null,w)),Fn(),ki(g.i,g.v,g.B,g.l,g.S,g.u)}Ni.prototype.ba=function(g){g=g.target;const w=this.O;w&&Vr(g)==3?w.j():this.Y(g)},Ni.prototype.Y=function(g){try{if(g==this.g)e:{const je=Vr(this.g),Vt=this.g.ya(),ut=this.g.ca();if(!(je<3)&&(je!=3||this.g&&(this.h.h||this.g.la()||Rf(this.g)))){this.K||je!=4||Vt==7||(Vt==8||ut<=0?Fn(3):Fn(2)),Vl(this);var w=this.g.ca();this.X=w;var C=xf(this);if(this.o=w==200,fn(this.i,this.v,this.B,this.l,this.S,je,w),this.o){if(this.U&&!this.L){t:{if(this.g){var O,q=this.g;if((O=q.g?q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(O)){var ee=O;break t}}ee=null}if(g=ee)Ft(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,g);else{this.o=!1,this.m=3,ft(12),ps(this),ha(this);break e}}if(this.R){g=!0;let Gt;for(;!this.K&&this.C<C.length;)if(Gt=Ef(this,C),Gt==Ou){je==4&&(this.m=4,ft(14),g=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==vf){this.m=4,ft(15),Ft(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else Ft(this.i,this.l,Gt,null),vt(this,Gt);if(wf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||C.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Ft(this.i,this.l,C,"[Invalid Chunked Response]"),ps(this),ha(this);else if(C.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),xa(de),de.P=!0,ft(11))}}else Ft(this.i,this.l,C,null),vt(this,C);je==4&&ps(this),this.o&&!this.K&&(je==4?ql(this.j,this):(this.o=!1,ua(this)))}else Xu(this.g),w==400&&C.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),ps(this),ha(this)}}}catch{}};function xf(g){if(!wf(g))return g.g.la();const w=Rf(g.g);if(w==="")return"";let C="";const O=w.length,q=Vr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ps(g),ha(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<O;ee++)g.h.h=!0,C+=g.h.i.decode(w[ee],{stream:!(q&&ee==O-1)});return w.length=0,g.h.g+=C,g.C=0,g.h.g}function wf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Ef(g,w){var C=g.C,O=w.indexOf(`
`,C);return O==-1?Ou:(C=Number(w.substring(C,O)),isNaN(C)?vf:(O+=1,O+C>w.length?Ou:(w=w.slice(O,O+C),g.C=O+C,w)))}Ni.prototype.cancel=function(){this.K=!0,ps(this)};function ua(g){g.T=Date.now()+g.H,Vu(g,g.H)}function Vu(g,w){if(g.D!=null)throw Error("WatchDog timer not null");g.D=er(h(g.aa,g),w)}function Vl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Ni.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Fn(),ft(17)),ps(this),this.m=2,ha(this)):Vu(this,this.T-g)};function ha(g){g.j.I==0||g.K||ql(g.j,g)}function ps(g){Vl(g);var w=g.O;w&&typeof w.dispose=="function"&&w.dispose(),g.O=null,Ji(g.V),g.g&&(w=g.g,g.g=null,w.abort(),w.dispose())}function vt(g,w){try{var C=g.j;if(C.I!=0&&(C.g==g||Uu(C.h,g))){if(!g.L&&Uu(C.h,g)&&C.I==3){try{var O=C.Ba.g.parse(w)}catch{O=null}if(Array.isArray(O)&&O.length==3){var q=O;if(q[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)Hl(C),fi(C);else break e;zr(C),ft(18)}}else C.xa=q[1],0<C.xa-C.K&&q[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=er(h(C.Va,C),6e3));da(C.h)<=1&&C.ta&&(C.ta=void 0)}else gi(C,11)}else if((g.L||C.g==g)&&Hl(C),!k(w))for(q=C.Ba.g.parse(w),w=0;w<q.length;w++){let ut=q[w];const Gt=ut[0];if(!(Gt<=C.K))if(C.K=Gt,ut=ut[1],C.I==2)if(ut[0]=="c"){C.M=ut[1],C.ba=ut[2];const pi=ut[3];pi!=null&&(C.ka=pi,C.j.info("VER="+C.ka));const ws=ut[4];ws!=null&&(C.za=ws,C.j.info("SVER="+C.za));const Br=ut[5];Br!=null&&typeof Br=="number"&&Br>0&&(O=1.5*Br,C.O=O,C.j.info("backChannelRequestTimeoutMs_="+O)),O=C;const Gr=g.g;if(Gr){const Zl=Gr.g?Gr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zl){var ee=O.h;ee.g||Zl.indexOf("spdy")==-1&&Zl.indexOf("quic")==-1&&Zl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Ul(ee,ee.h),ee.h=null))}if(O.G){const Qu=Gr.g?Gr.g.getResponseHeader("X-HTTP-Session-Id"):null;Qu&&(O.wa=Qu,st(O.J,O.G,Qu))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),O=C;var de=g;if(O.na=Zu(O,O.L?O.ba:null,O.W),de.L){fa(O.h,de);var je=de,Vt=O.O;Vt&&(je.H=Vt),je.D&&(Vl(je),ua(je)),O.g=de}else Cn(O);C.i.length>0&&xs(C)}else ut[0]!="stop"&&ut[0]!="close"||gi(C,7);else C.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?gi(C,7):$l(C):ut[0]!="noop"&&C.l&&C.l.qa(ut),C.A=0)}}Fn(4)}catch{}}var yy=class{constructor(g,w){this.g=g,this.map=w}};function jl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ju(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function da(g){return g.h?1:g.g?g.g.size:0}function Uu(g,w){return g.h?g.h==w:g.g?g.g.has(w):!1}function Ul(g,w){g.g?g.g.add(w):g.h=w}function fa(g,w){g.h&&g.h==w?g.h=null:g.g&&g.g.has(w)&&g.g.delete(w)}jl.prototype.cancel=function(){if(this.i=ui(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ui(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let w=g.i;for(const C of g.g.values())w=w.concat(C.G);return w}return E(g.i)}var Tf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hi(g,w){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const O=g[C].indexOf("=");let q,ee=null;O>=0?(q=g[C].substring(0,O),ee=g[C].substring(O+1)):q=g[C],w(q,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Dr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;g instanceof Dr?(this.l=g.l,ga(this,g.j),this.o=g.o,this.g=g.g,Nr(this,g.u),this.h=g.h,io(this,qu(g.i)),this.m=g.m):g&&(w=String(g).match(Tf))?(this.l=!1,ga(this,w[1]||"",!0),this.o=pa(w[2]||""),this.g=pa(w[3]||"",!0),Nr(this,w[4]),this.h=pa(w[5]||"",!0),io(this,w[6]||"",!0),this.m=pa(w[7]||"")):(this.l=!1,this.i=new He(null,this.l))}Dr.prototype.toString=function(){const g=[];var w=this.j;w&&g.push(ma(w,Bu,!0),":");var C=this.g;return(C||w=="file")&&(g.push("//"),(w=this.o)&&g.push(ma(w,Bu,!0),"@"),g.push(Di(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ma(C,C.charAt(0)=="/"?ya:Gu,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ma(C,Wu)),g.join("")},Dr.prototype.resolve=function(g){const w=Mi(this);let C=!!g.j;C?ga(w,g.j):C=!!g.o,C?w.o=g.o:C=!!g.g,C?w.g=g.g:C=g.u!=null;var O=g.h;if(C)Nr(w,g.u);else if(C=!!g.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var q=w.h.lastIndexOf("/");q!=-1&&(O=w.h.slice(0,q+1)+O)}if(q=O,q==".."||q==".")O="";else if(q.indexOf("./")!=-1||q.indexOf("/.")!=-1){O=q.lastIndexOf("/",0)==0,q=q.split("/");const ee=[];for(let de=0;de<q.length;){const je=q[de++];je=="."?O&&de==q.length&&ee.push(""):je==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),O&&de==q.length&&ee.push("")):(ee.push(je),O=!0)}O=ee.join("/")}else O=q}return C?w.h=O:C=g.i.toString()!=="",C?io(w,qu(g.i)):C=!!g.m,C&&(w.m=g.m),w};function Mi(g){return new Dr(g)}function ga(g,w,C){g.j=C?pa(w,!0):w,g.j&&(g.j=g.j.replace(/:$/,""))}function Nr(g,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);g.u=w}else g.u=null}function io(g,w,C){w instanceof He?(g.i=w,Bl(g.i,g.l)):(C||(w=ma(w,_y)),g.i=new He(w,g.l))}function st(g,w,C){g.i.set(w,C)}function ms(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,w){return g?w?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ma(g,w,C){return typeof g=="string"?(g=encodeURI(g).replace(w,zu),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function zu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Bu=/[#\/\?@]/g,Gu=/[#\?:]/g,ya=/[#\?]/g,_y=/[#\?@]/g,Wu=/#/g;function He(g,w){this.h=this.g=null,this.i=g||null,this.j=!!w}function Mr(g){g.g||(g.g=new Map,g.h=0,g.i&&hi(g.i,function(w,C){g.add(decodeURIComponent(w.replace(/\+/g," ")),C)}))}n=He.prototype,n.add=function(g,w){Mr(this),this.i=null,g=Lr(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(w),this.h+=1,this};function $u(g,w){Mr(g),w=Lr(g,w),g.g.has(w)&&(g.i=null,g.h-=g.g.get(w).length,g.g.delete(w))}function zl(g,w){return Mr(g),w=Lr(g,w),g.g.has(w)}n.forEach=function(g,w){Mr(this),this.g.forEach(function(C,O){C.forEach(function(q){g.call(w,q,O,this)},this)},this)};function Ku(g,w){Mr(g);let C=[];if(typeof w=="string")zl(g,w)&&(C=C.concat(g.g.get(Lr(g,w))));else for(g=Array.from(g.g.values()),w=0;w<g.length;w++)C=C.concat(g[w]);return C}n.set=function(g,w){return Mr(this),this.i=null,g=Lr(this,g),zl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[w]),this.h+=1,this},n.get=function(g,w){return g?(g=Ku(this,g),g.length>0?String(g[0]):w):w};function Hu(g,w,C){$u(g,w),C.length>0&&(g.i=null,g.g.set(Lr(g,w),E(C)),g.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],w=Array.from(this.g.keys());for(let O=0;O<w.length;O++){var C=w[O];const q=Di(C);C=Ku(this,C);for(let ee=0;ee<C.length;ee++){let de=q;C[ee]!==""&&(de+="="+Di(C[ee])),g.push(de)}}return this.i=g.join("&")};function qu(g){const w=new He;return w.i=g.i,g.g&&(w.g=new Map(g.g),w.h=g.h),w}function Lr(g,w){return w=String(w),g.j&&(w=w.toLowerCase()),w}function Bl(g,w){w&&!g.j&&(Mr(g),g.i=null,g.g.forEach(function(C,O){const q=O.toLowerCase();O!=q&&($u(this,O),Hu(this,q,C))},g)),g.j=w}function Or(g,w){const C=new Ot;if(o.Image){const O=new Image;O.onload=f(mn,C,"TestLoadImage: loaded",!0,w,O),O.onerror=f(mn,C,"TestLoadImage: error",!1,w,O),O.onabort=f(mn,C,"TestLoadImage: abort",!1,w,O),O.ontimeout=f(mn,C,"TestLoadImage: timeout",!1,w,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=g}else w(!1)}function Fr(g,w){const C=new Ot,O=new AbortController,q=setTimeout(()=>{O.abort(),mn(C,"TestPingServer: timeout",!1,w)},1e4);fetch(g,{signal:O.signal}).then(ee=>{clearTimeout(q),ee.ok?mn(C,"TestPingServer: ok",!0,w):mn(C,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(q),mn(C,"TestPingServer: error",!1,w)})}function mn(g,w,C,O,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),O(C)}catch{}}function _a(){this.g=new Ar}function ys(g){this.i=g.Sb||null,this.h=g.ab||!1}p(ys,bi),ys.prototype.g=function(){return new di(this.i,this.h)};function di(g,w){yt.call(this),this.H=g,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(di,yt),n=di.prototype,n.open=function(g,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=w,this.readyState=1,nr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(w.body=g),(this.H||o).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ro(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,nr(this)),this.g&&(this.readyState=3,nr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Sf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Sf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var w=g.value?g.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!g.done}))&&(this.response=this.responseText+=w)}g.done?ro(this):nr(this),this.readyState==3&&Sf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,ro(this))},n.Na=function(g){this.g&&(this.response=g,ro(this))},n.ga=function(){this.g&&ro(this)};function ro(g){g.readyState=4,g.l=null,g.j=null,g.B=null,nr(g)}n.setRequestHeader=function(g,w){this.A.append(g,w)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],w=this.h.entries();for(var C=w.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=w.next();return g.join(`\r
`)};function nr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function If(g){let w="";return oe(g,function(C,O){w+=O,w+=":",w+=C,w+=`\r
`}),w}function Gl(g,w,C){e:{for(O in C){var O=!1;break e}O=!0}O||(C=If(C),typeof g=="string"?C!=null&&Di(C):st(g,w,C))}function pt(g){yt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(pt,yt);var Cf=/^https?$/i,vy=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,w,C,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);w=w?w.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(w,String(g),!0),this.B=!1}catch(ee){so(this,ee);return}if(g=C||"",C=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var q in O)C.set(q,O[q]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ee of O.keys())C.set(ee,O.get(ee));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(C.keys()).find(ee=>ee.toLowerCase()=="content-type"),q=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(vy,w,void 0)>=0)||O||q||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,de]of C)this.g.setRequestHeader(ee,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){so(this,ee)}};function so(g,w){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=w,g.o=5,oo(g),vs(g)}function oo(g){g.A||(g.A=!0,ct(g,"complete"),ct(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ct(this,"complete"),ct(this,"abort"),vs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?_s(this):this.Xa())},n.Xa=function(){_s(this)};function _s(g){if(g.h&&typeof s<"u"){if(g.v&&Vr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ct(g,"readystatechange"),Vr(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var C;if(!(C=w)){var O;if(O=ee===0){let de=String(g.D).match(Tf)[1]||null;!de&&o.self&&o.self.location&&(de=o.self.location.protocol.slice(0,-1)),O=!Cf.test(de?de.toLowerCase():"")}C=O}if(C)ct(g,"complete"),ct(g,"success");else{g.o=6;try{var q=Vr(g)>2?g.g.statusText:""}catch{q=""}g.l=q+" ["+g.ca()+"]",oo(g)}}finally{vs(g)}}}}function vs(g,w){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,w||ct(g,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Vr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Vr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var w=this.g.responseText;return g&&w.indexOf(g)==0&&(w=w.substring(g.length)),ca(w)}};function Rf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Xu(g){const w={};g=(g.g&&Vr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<g.length;O++){if(k(g[O]))continue;var C=Fl(g[O]);const q=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ee=w[q]||[];w[q]=ee,ee.push(C)}ne(w,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function jr(g,w,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||w}function Wl(g){this.za=0,this.i=[],this.j=new Ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=jr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=jr("baseRetryDelayMs",5e3,g),this.Za=jr("retryDelaySeedMs",1e4,g),this.Ta=jr("forwardChannelMaxRetries",2,g),this.va=jr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new jl(g&&g.concurrentRequestLimit),this.Ba=new _a,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wl.prototype,n.ka=8,n.I=1,n.connect=function(g,w,C,O){ft(0),this.W=g,this.H=w||{},C&&O!==void 0&&(this.H.OSID=C,this.H.OAID=O),this.F=this.X,this.J=Zu(this,null,this.W),xs(this)};function $l(g){if(Kl(g),g.I==3){var w=g.V++,C=Mi(g.J);if(st(C,"SID",g.M),st(C,"RID",w),st(C,"TYPE","terminate"),Ur(g,C),w=new Ni(g,g.j,w),w.M=2,w.A=ms(Mi(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(w.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=w.A,C=!0),C||(w.g=Pf(w.j,null),w.g.ea(w.A)),w.F=Date.now(),ua(w)}wa(g)}function fi(g){g.g&&(xa(g),g.g.cancel(),g.g=null)}function Kl(g){fi(g),g.v&&(o.clearTimeout(g.v),g.v=null),Hl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function xs(g){if(!ju(g.h)&&!g.m){g.m=!0;var w=g.Ea;F||R(),B||(F(),B=!0),b.add(w,g),g.D=0}}function Af(g,w){return da(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=w.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=er(h(g.Ea,g,w),Xl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const q=new Ni(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=W(ee),ie(ee,this.U)):ee=this.U),this.u!==null||this.R||(q.J=ee,ee=null),this.S)e:{for(var w=0,C=0;C<this.i.length;C++){t:{var O=this.i[C];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(w+=O,w>4096){w=C;break e}if(w===4096||C===this.i.length-1){w=C+1;break e}}w=1e3}else w=1e3;w=Yu(this,q,w),C=Mi(this.J),st(C,"RID",g),st(C,"CVER",22),this.G&&st(C,"X-HTTP-Session-Id",this.G),Ur(this,C),ee&&(this.R?w="headers="+Di(If(ee))+"&"+w:this.u&&Gl(C,this.u,ee)),Ul(this.h,q),this.Ra&&st(C,"TYPE","init"),this.S?(st(C,"$req",w),st(C,"SID","null"),q.U=!0,tr(q,C,null)):tr(q,C,w),this.I=2}}else this.I==3&&(g?va(this,g):this.i.length==0||ju(this.h)||va(this))};function va(g,w){var C;w?C=w.l:C=g.V++;const O=Mi(g.J);st(O,"SID",g.M),st(O,"RID",C),st(O,"AID",g.K),Ur(g,O),g.u&&g.o&&Gl(O,g.u,g.o),C=new Ni(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),w&&(g.i=w.G.concat(g.i)),w=Yu(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Ul(g.h,C),tr(C,O,w)}function Ur(g,w){g.H&&oe(g.H,function(C,O){st(w,O,C)}),g.l&&oe({},function(C,O){st(w,O,C)})}function Yu(g,w,C){C=Math.min(g.i.length,C);const O=g.l?h(g.l.Ka,g.l,g):null;e:{var q=g.i;let je=-1;for(;;){const Vt=["count="+C];je==-1?C>0?(je=q[0].g,Vt.push("ofs="+je)):je=0:Vt.push("ofs="+je);let ut=!0;for(let Gt=0;Gt<C;Gt++){var ee=q[Gt].g;const pi=q[Gt].map;if(ee-=je,ee<0)je=Math.max(0,q[Gt].g-100),ut=!1;else try{ee="req"+ee+"_"||"";try{var de=pi instanceof Map?pi:Object.entries(pi);for(const[ws,Br]of de){let Gr=Br;l(Br)&&(Gr=Rr(Br)),Vt.push(ee+ws+"="+encodeURIComponent(Gr))}}catch(ws){throw Vt.push(ee+"type="+encodeURIComponent("_badmap")),ws}}catch{O&&O(pi)}}if(ut){de=Vt.join("&");break e}}de=void 0}return g=g.i.splice(0,C),w.G=g,de}function Cn(g){if(!g.g&&!g.v){g.Y=1;var w=g.Da;F||R(),B||(F(),B=!0),b.add(w,g),g.A=0}}function zr(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=er(h(g.Da,g),Xl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,ao(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=er(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),fi(this),ao(this))};function xa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function ao(g){g.g=new Ni(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var w=Mi(g.na);st(w,"RID","rpc"),st(w,"SID",g.M),st(w,"AID",g.K),st(w,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(w,"TO",g.ia),st(w,"TYPE","xmlhttp"),Ur(g,w),g.u&&g.o&&Gl(w,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=ms(Mi(w)),C.u=null,C.R=!0,Fu(C,g)}n.Va=function(){this.C!=null&&(this.C=null,fi(this),zr(this),ft(19))};function Hl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function ql(g,w){var C=null;if(g.g==w){Hl(g),xa(g),g.g=null;var O=2}else if(Uu(g.h,w))C=w.G,fa(g.h,w),O=1;else return;if(g.I!=0){if(w.o)if(O==1){C=w.u?w.u.length:0,w=Date.now()-w.F;var q=g.D;O=br(),ct(O,new no(O,C)),xs(g)}else Cn(g);else if(q=w.m,q==3||q==0&&w.X>0||!(O==1&&Af(g,w)||O==2&&zr(g)))switch(C&&C.length>0&&(w=g.h,w.i=w.i.concat(C)),q){case 1:gi(g,5);break;case 4:gi(g,10);break;case 3:gi(g,6);break;default:gi(g,2)}}}function Xl(g,w){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*w}function gi(g,w){if(g.j.info("Error code "+w),w==2){var C=h(g.bb,g),O=g.Ua;const q=!O;O=new Dr(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ga(O,"https"),ms(O),q?Or(O.toString(),C):Fr(O.toString(),C)}else ft(2);g.I=0,g.l&&g.l.pa(w),wa(g),Kl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function wa(g){if(g.I=0,g.ja=[],g.l){const w=ui(g.h);(w.length!=0||g.i.length!=0)&&(T(g.ja,w),T(g.ja,g.i),g.h.i.length=0,E(g.i),g.i.length=0),g.l.oa()}}function Zu(g,w,C){var O=C instanceof Dr?Mi(C):new Dr(C);if(O.g!="")w&&(O.g=w+"."+O.g),Nr(O,O.u);else{var q=o.location;O=q.protocol,w=w?w+"."+q.hostname:q.hostname,q=+q.port;const ee=new Dr(null);O&&ga(ee,O),w&&(ee.g=w),q&&Nr(ee,q),C&&(ee.h=C),O=ee}return C=g.G,w=g.wa,C&&w&&st(O,C,w),st(O,"VER",g.ka),Ur(g,O),O}function Pf(g,w,C){if(w&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=g.Aa&&!g.ma?new pt(new ys({ab:C})):new pt(g.ma),w.Fa(g.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bf(){}n=bf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Yl(){}Yl.prototype.g=function(g,w){return new yn(g,w)};function yn(g,w){yt.call(this),this.g=new Wl(w),this.l=g,this.h=w&&w.messageUrlParams||null,g=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(g?g["X-WebChannel-Content-Type"]=w.messageContentType:g={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(g?g["X-WebChannel-Client-Profile"]=w.sa:g={"X-WebChannel-Client-Profile":w.sa}),this.g.U=g,(g=w&&w.Qb)&&!k(g)&&(this.g.u=g),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!k(w)&&(this.g.G=w,g=this.h,g!==null&&w in g&&(g=this.h,w in g&&delete g[w])),this.j=new lo(this)}p(yn,yt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){$l(this.g)},yn.prototype.o=function(g){var w=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=Rr(g),g=C);w.i.push(new yy(w.Ya++,g)),w.I==3&&xs(w)},yn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,yn.Z.N.call(this)};function kf(g){fs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var w=g.__sm__;if(w){e:{for(const C in w){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,w=w!==null&&g in w?w[g]:void 0),this.data=w}else this.data=g}p(kf,fs);function Df(){to.call(this),this.status=1}p(Df,to);function lo(g){this.g=g}p(lo,bf),lo.prototype.ra=function(){ct(this.g,"a")},lo.prototype.qa=function(g){ct(this.g,new kf(g))},lo.prototype.pa=function(g){ct(this.g,new Df)},lo.prototype.oa=function(){ct(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Vk=function(){return new Yl},Fk=function(){return br()},Ok=On,Xv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nn.NO_ERROR=0,nn.TIMEOUT=8,nn.HTTP_ERROR=6,up=nn,rt.COMPLETE="complete",Lk=rt,Ol.EventType=Pr,Pr.OPEN="a",Pr.CLOSE="b",Pr.ERROR="c",Pr.MESSAGE="d",yt.prototype.listen=yt.prototype.J,Hh=Ol,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Mk=pt}).apply(typeof $g<"u"?$g:typeof self<"u"?self:typeof window<"u"?window:{});const lR="@firebase/firestore",cR="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Mu="12.7.0";const Tl=new Wx("@firebase/firestore");function Lc(){return Tl.logLevel}function fe(n,...e){if(Tl.logLevel<=Ke.DEBUG){const t=e.map(rw);Tl.debug(`Firestore (${Mu}): ${n}`,...t)}}function wi(n,...e){if(Tl.logLevel<=Ke.ERROR){const t=e.map(rw);Tl.error(`Firestore (${Mu}): ${n}`,...t)}}function Zm(n,...e){if(Tl.logLevel<=Ke.WARN){const t=e.map(rw);Tl.warn(`Firestore (${Mu}): ${n}`,...t)}}function rw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Re(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,jk(n,i,t)}function jk(n,e,t){let i=`FIRESTORE (${Mu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw wi(i),new Error(i)}function Ne(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||jk(e,r,i)}function Tt(n,e){return n}const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ll{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Uk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class C8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class R8{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ne(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new ll;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ll,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ll)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ne(typeof i.accessToken=="string",31837,{l:i}),new Uk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class A8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class P8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new A8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class uR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class b8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$i(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ne(this.o===void 0,3512);const i=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new uR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new uR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function k8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class zk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=k8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function $e(n,e){return n<e?-1:n>e?1:0}function Yv(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return G0(r)===G0(s)?$e(r,s):G0(r)?1:-1}return $e(n.length,e.length)}const D8=55296,N8=57343;function G0(n){const e=n.charCodeAt(0);return e>=D8&&e<=N8}function pu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Bk(n){return n+"\0"}const hR="__name__";class qr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Re(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return qr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=qr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return $e(e.length,t.length)}static compareSegments(e,t){const i=qr.isNumericId(e),r=qr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?qr.extractNumericId(e).compare(qr.extractNumericId(t)):Yv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return iw.fromString(e.substring(4,e.length-2))}}class Ct extends qr{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(le.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const M8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends qr{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return M8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hR}static keyField(){return new zt([hR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Se(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Se(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Se(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Se(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Ct.fromString(e))}static fromName(e){return new Ee(Ct.fromString(e).popFirst(5))}static empty(){return new Ee(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Ct(e.slice()))}}function L8(n,e,t,i){if(e===!0&&i===!0)throw new Se(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function O8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function F8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function Gk(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=F8(n);throw new Se(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Ht(n,e){const t={typeString:n};return e&&(t.value=e),t}function gf(n,e){if(!O8(n))throw new Se(le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Se(le.INVALID_ARGUMENT,t);return!0}const dR=-62135596800,fR=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*fR);return new bt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<dR)throw new Se(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fR}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gf(e,bt._jsonSchema))return new bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bt._jsonSchemaVersion="firestore/timestamp/1.0",bt._jsonSchema={type:Ht("string",bt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};class Ze{static fromTimestamp(e){return new Ze(e)}static min(){return new Ze(new bt(0,0))}static max(){return new Ze(new bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ld=-1;class Jp{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Zv(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}Jp.UNKNOWN_ID=-1;class hp{constructor(e,t){this.fieldPath=e,this.kind=t}}class Od{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Od(0,Ci.min())}}function V8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ze.fromTimestamp(i===1e9?new bt(t+1,0):new bt(t,i));return new Ci(r,Ee.empty(),e)}function Wk(n){return new Ci(n.readTime,n.key,Ld)}class Ci{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ci(Ze.min(),Ee.empty(),Ld)}static max(){return new Ci(Ze.max(),Ee.empty(),Ld)}}function sw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}const $k="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Kk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Qm(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==$k)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Y(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Y?t:Y.resolve(t)}catch(t){return Y.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.reject(t)}static resolve(e){return new Y(((t,i)=>{t(e)}))}static reject(e){return new Y(((t,i)=>{i(e)}))}static waitFor(e){return new Y(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Y.resolve(!1);for(const i of e)t=t.next((r=>r?Y.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Y(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Y(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const vi="SimpleDb";class Jm{static open(e,t,i,r){try{return new Jm(t,e.transaction(r,i))}catch(s){throw new id(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ll,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new id(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=ow(i.target.error);this.S.reject(new id(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(vi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new U8(t)}}class Zo{static delete(e){return fe(vi,"Removing database:",e),Ka(Gb().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Qb())return!1;if(Zo.F())return!0;const e=Jt(),t=Zo.M(e),i=0<t&&t<10,r=Hk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Zo.M(Jt())===12.2&&wi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(vi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new id(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Se(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Se(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new id(e,o))},r.onupgradeneeded=s=>{fe(vi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{fe(vi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Jm.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Y.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(fe(vi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Hk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class j8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ka(this.U.delete())}}class id extends Se{constructor(e,t){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ll(n){return n.name==="IndexedDbTransactionError"}class U8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(fe(vi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(fe(vi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ka(i)}add(e){return fe(vi,"ADD",this.store.name,e,e),Ka(this.store.add(e))}get(e){return Ka(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(vi,"GET",this.store.name,e,t),t)))}delete(e){return fe(vi,"DELETE",this.store.name,e),Ka(this.store.delete(e))}count(){return fe(vi,"COUNT",this.store.name),Ka(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Y(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Y(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){fe(vi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Y(((i,r)=>{t.onerror=s=>{const o=ow(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Y(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new j8(l),h=t(l.primaryKey,l.value,u);if(h instanceof Y){const f=h.catch((p=>(u.done(),Y.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Y.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ka(n){return new Y(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=ow(i.target.error);t(r)}}))}let gR=!1;function ow(n){const e=Zo.M(Jt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gR||(gR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const rd="IndexBackfiller";class z8{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(rd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(rd,`Documents written: ${t}`)}catch(t){Ll(t)?fe(rd,"Ignoring IndexedDB error during index backfill: ",t):await Qm(t)}await this.re(6e4)}))}}class B8{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Y.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return fe(rd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(fe(rd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Wk(s);sw(o,i)>0&&(i=o)})),new Ci(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class yr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yr.ce=-1;const cl=-1;function ey(n){return n==null}function em(n){return n===0&&1/n==-1/0}const tm="";function Gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pR(e)),e=G8(n.get(t),e);return pR(e)}function G8(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case tm:t+="";break;default:t+=s}}return t}function pR(n){return n+tm+""}function Qr(n){const e=n.length;if(Ne(e>=2,64408,{path:n}),e===2)return Ne(n.charAt(0)===tm&&n.charAt(1)==="",56145,{path:n}),Ct.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(tm,s);switch((o<0||o>t)&&Re(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Re(61167,{path:n})}s=o+2}return new Ct(i)}const Wa="remoteDocuments",pf="owner",Ic="owner",Fd="mutationQueues",W8="userId",hr="mutations",mR="batchId",nl="userMutationsIndex",yR=["userId","batchId"];function dp(n,e){return[n,Gn(e)]}function qk(n,e,t){return[n,Gn(e),t]}const $8={},mu="documentMutations",nm="remoteDocumentsV14",K8=["prefixPath","collectionGroup","readTime","documentId"],fp="documentKeyIndex",H8=["prefixPath","collectionGroup","documentId"],Xk="collectionGroupIndex",q8=["collectionGroup","readTime","prefixPath","documentId"],Vd="remoteDocumentGlobal",Qv="remoteDocumentGlobalKey",yu="targets",Yk="queryTargetsIndex",X8=["canonicalId","targetId"],_u="targetDocuments",Y8=["targetId","path"],aw="documentTargetsIndex",Z8=["path","targetId"],im="targetGlobalKey",ul="targetGlobal",jd="collectionParents",Q8=["collectionId","parent"],vu="clientMetadata",J8="clientId",ty="bundles",eG="bundleId",ny="namedQueries",tG="name",lw="indexConfiguration",nG="indexId",Jv="collectionGroupIndex",iG="collectionGroup",sd="indexState",rG=["indexId","uid"],Zk="sequenceNumberIndex",sG=["uid","sequenceNumber"],od="indexEntries",oG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Qk="documentKeyIndex",aG=["indexId","uid","orderedDocumentKey"],iy="documentOverlays",lG=["userId","collectionPath","documentId"],e1="collectionPathOverlayIndex",cG=["userId","collectionPath","largestBatchId"],Jk="collectionGroupOverlayIndex",uG=["userId","collectionGroup","largestBatchId"],cw="globals",hG="name",eD=[Fd,hr,mu,Wa,yu,pf,ul,_u,vu,Vd,jd,ty,ny],dG=[...eD,iy],tD=[Fd,hr,mu,nm,yu,pf,ul,_u,vu,Vd,jd,ty,ny,iy],nD=tD,uw=[...nD,lw,sd,od],fG=uw,iD=[...uw,cw],gG=iD;class t1 extends Kk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function en(n,e){const t=Tt(n);return Zo.O(t.le,e)}function _R(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function hw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function pG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class li{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new li(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new li(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kg(this.root,e,this.comparator,!0)}}class Kg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new li(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vR(this.data.getIterator())}getIteratorFrom(e){return new vR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class vR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cc(n){return n.hasNext()?n.getNext():void 0}class Vs{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new Vs([])}unionWith(e){let t=new mt(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class mG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ci{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new mG("Invalid base64 string: "+s):s}})(e);return new ci(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new ci(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ci.EMPTY_BYTE_STRING=new ci("");const yG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function na(n){if(Ne(!!n,39018),typeof n=="string"){let e=0;const t=yG.exec(n);if(Ne(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Kt(n.seconds),nanos:Kt(n.nanos)}}function Kt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xu(n){return typeof n=="string"?ci.fromBase64String(n):ci.fromUint8Array(n)}const rD="server_timestamp",sD="__type__",oD="__previous_value__",aD="__local_write_time__";function dw(n){return(n?.mapValue?.fields||{})[sD]?.stringValue===rD}function lD(n){const e=n.mapValue.fields[oD];return dw(e)?lD(e):e}function rm(n){const e=na(n.mapValue.fields[aD].timestampValue);return new bt(e.seconds,e.nanos)}class _G{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const sm="(default)";class wu{constructor(e,t){this.projectId=e,this.database=t||sm}static empty(){return new wu("","")}get isDefaultDatabase(){return this.database===sm}isEqual(e){return e instanceof wu&&e.projectId===this.projectId&&e.database===this.database}}const cD="__type__",uD="__max__",$o={mapValue:{fields:{__type__:{stringValue:uD}}}},hD="__vector__",om="value",gp={nullValue:"NULL_VALUE"};function Eu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dw(n)?4:dD(n)?9007199254740991:ry(n)?10:11:Re(28295,{value:n})}function os(n,e){if(n===e)return!0;const t=Eu(n);if(t!==Eu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return rm(n).isEqual(rm(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=na(r.timestampValue),l=na(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return xu(r.bytesValue).isEqual(xu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Kt(r.geoPointValue.latitude)===Kt(s.geoPointValue.latitude)&&Kt(r.geoPointValue.longitude)===Kt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Kt(r.integerValue)===Kt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Kt(r.doubleValue),l=Kt(s.doubleValue);return o===l?em(o)===em(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return pu(n.arrayValue.values||[],e.arrayValue.values||[],os);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(_R(o)!==_R(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!os(o[u],l[u])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function Ud(n,e){return(n.values||[]).find((t=>os(t,e)))!==void 0}function ia(n,e){if(n===e)return 0;const t=Eu(n),i=Eu(e);if(t!==i)return $e(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Kt(s.integerValue||s.doubleValue),u=Kt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return xR(n.timestampValue,e.timestampValue);case 4:return xR(rm(n),rm(e));case 5:return Yv(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=xu(s),u=xu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=$e(l[h],u[h]);if(f!==0)return f}return $e(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=$e(Kt(s.latitude),Kt(o.latitude));return l!==0?l:$e(Kt(s.longitude),Kt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return wR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[om]?.arrayValue,f=u[om]?.arrayValue,p=$e(h?.values?.length||0,f?.values?.length||0);return p!==0?p:wR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===$o.mapValue&&o===$o.mapValue)return 0;if(s===$o.mapValue)return 1;if(o===$o.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const y=Yv(u[p],f[p]);if(y!==0)return y;const E=ia(l[u[p]],h[f[p]]);if(E!==0)return E}return $e(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function xR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=na(n),i=na(e),r=$e(t.seconds,i.seconds);return r!==0?r:$e(t.nanos,i.nanos)}function wR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=ia(t[r],i[r]);if(s)return s}return $e(t.length,i.length)}function Tu(n){return n1(n)}function n1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=na(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return xu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=n1(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${n1(t.fields[o])}`;return r+"}"})(n.mapValue):Re(61005,{value:n})}function fw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function i1(n){return!!n&&"integerValue"in n}function zd(n){return!!n&&"arrayValue"in n}function ER(n){return!!n&&"nullValue"in n}function TR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function W0(n){return!!n&&"mapValue"in n}function ry(n){return(n?.mapValue?.fields||{})[cD]?.stringValue===hD}function ad(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return hw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ad(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ad(n.arrayValue.values[t]);return e}return{...n}}function dD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===uD}const fD={mapValue:{fields:{[cD]:{stringValue:hD},[om]:{arrayValue:{}}}}};function vG(n){return"nullValue"in n?gp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?fw(wu.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ry(n)?fD:{mapValue:{}}:Re(35942,{value:n})}function xG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?fw(wu.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fD:"mapValue"in n?ry(n)?{mapValue:{}}:$o:Re(61959,{value:n})}function SR(n,e){const t=ia(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function IR(n,e){const t=ia(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pr{constructor(e){this.value=e}static empty(){return new pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!W0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ad(t)}setAll(e){let t=zt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=ad(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());W0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return os(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];W0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){hw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new pr(ad(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Ze.min(),Ze.min(),Ze.min(),pr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Ze.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Ze.min(),Ze.min(),pr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Ze.min(),Ze.min(),pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Su{constructor(e,t){this.position=e,this.inclusive=t}}function CR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=ia(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function RR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!os(n.position[t],e.position[t]))return!1;return!0}class am{constructor(e,t="asc"){this.field=e,this.dir=t}}function wG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class gD{}class Xe extends gD{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new EG(e,t,i):t==="array-contains"?new IG(e,i):t==="in"?new xD(e,i):t==="not-in"?new CG(e,i):t==="array-contains-any"?new RG(e,i):new Xe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new TG(e,i):new SG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ia(t,this.value)):t!==null&&Eu(this.value)===Eu(t)&&this.matchesComparison(ia(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gt extends gD{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gt(e,t)}matches(e){return Iu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Iu(n){return n.op==="and"}function r1(n){return n.op==="or"}function gw(n){return pD(n)&&Iu(n)}function pD(n){for(const e of n.filters)if(e instanceof gt)return!1;return!0}function s1(n){if(n instanceof Xe)return n.field.canonicalString()+n.op.toString()+Tu(n.value);if(gw(n))return n.filters.map((e=>s1(e))).join(",");{const e=n.filters.map((t=>s1(t))).join(",");return`${n.op}(${e})`}}function mD(n,e){return n instanceof Xe?(function(i,r){return r instanceof Xe&&i.op===r.op&&i.field.isEqual(r.field)&&os(i.value,r.value)})(n,e):n instanceof gt?(function(i,r){return r instanceof gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&mD(o,r.filters[l])),!0):!1})(n,e):void Re(19439)}function yD(n,e){const t=n.filters.concat(e);return gt.create(t,n.op)}function _D(n){return n instanceof Xe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Tu(t.value)}`})(n):n instanceof gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(_D).join(" ,")+"}"})(n):"Filter"}class EG extends Xe{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class TG extends Xe{constructor(e,t){super(e,"in",t),this.keys=vD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class SG extends Xe{constructor(e,t){super(e,"not-in",t),this.keys=vD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function vD(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class IG extends Xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return zd(t)&&Ud(t.arrayValue,this.value)}}class xD extends Xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ud(this.value.arrayValue,t)}}class CG extends Xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ud(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ud(this.value.arrayValue,t)}}class RG extends Xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!zd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Ud(this.value.arrayValue,i)))}}class AG{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function o1(n,e=null,t=[],i=[],r=null,s=null,o=null){return new AG(n,e,t,i,r,s,o)}function Sl(n){const e=Tt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>s1(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),ey(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Tu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Tu(i))).join(",")),e.Te=t}return e.Te}function mf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!RR(n.startAt,e.startAt)&&RR(n.endAt,e.endAt)}function PG(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function lm(n,e){return n.filters.filter((t=>t instanceof Xe&&t.field.isEqual(e)))}function AR(n,e,t){let i=gp,r=!0;for(const s of lm(n,e)){let o=gp,l=!0;switch(s.op){case"<":case"<=":o=vG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=gp}SR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];SR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function PR(n,e,t){let i=$o,r=!0;for(const s of lm(n,e)){let o=$o,l=!0;switch(s.op){case">=":case">":o=xG(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=$o}IR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];IR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class sy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function bG(n,e,t,i,r,s,o,l){return new sy(n,e,t,i,r,s,o,l)}function wD(n){return new sy(n)}function bR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function kG(n){return n.collectionGroup!==null}function ld(n){const e=Tt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mt(zt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new am(s,i))})),t.has(zt.keyField().canonicalString())||e.Ie.push(new am(zt.keyField(),i))}return e.Ie}function Ws(n){const e=Tt(n);return e.Ee||(e.Ee=DG(e,ld(n))),e.Ee}function DG(n,e){if(n.limitType==="F")return o1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new am(r.field,s)}));const t=n.endAt?new Su(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Su(n.startAt.position,n.startAt.inclusive):null;return o1(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function a1(n,e,t){return new sy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ED(n,e){return mf(Ws(n),Ws(e))&&n.limitType===e.limitType}function TD(n){return`${Sl(Ws(n))}|lt:${n.limitType}`}function kh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>_D(r))).join(", ")}]`),ey(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Tu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Tu(r))).join(",")),`Target(${i})`})(Ws(n))}; limitType=${n.limitType})`}function oy(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of ld(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=CR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,ld(i),r)||i.endAt&&!(function(o,l,u){const h=CR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,ld(i),r))})(n,e)}function NG(n){return(e,t)=>{let i=!1;for(const r of ld(n)){const s=MG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function MG(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?ia(u,h):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:n.dir})}}class aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){hw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return pG(this.inner)}size(){return this.innerSize}}const LG=new li(Ee.comparator);function il(){return LG}const SD=new li(Ee.comparator);function Hg(...n){let e=SD;for(const t of n)e=e.insert(t.key,t);return e}function OG(n){let e=SD;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Jr(){return cd()}function ID(){return cd()}function cd(){return new aa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const FG=new li(Ee.comparator),VG=new mt(Ee.comparator);function Sn(...n){let e=VG;for(const t of n)e=e.add(t);return e}const jG=new mt($e);function UG(){return jG}function zG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:em(e)?"-0":e}}function BG(n){return{integerValue:""+n}}class ay{constructor(){this._=void 0}}function GG(n,e,t){return n instanceof Bd?(function(r,s){const o={fields:{[sD]:{stringValue:rD},[aD]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&dw(s)&&(s=lD(s)),s&&(o.fields[oD]=s),{mapValue:o}})(t,e):n instanceof Cu?CD(n,e):n instanceof Ru?RD(n,e):(function(r,s){const o=$G(r,s),l=kR(o)+kR(r.Ae);return i1(o)&&i1(r.Ae)?BG(l):zG(r.serializer,l)})(n,e)}function WG(n,e,t){return n instanceof Cu?CD(n,e):n instanceof Ru?RD(n,e):t}function $G(n,e){return n instanceof Gd?(function(i){return i1(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Bd extends ay{}class Cu extends ay{constructor(e){super(),this.elements=e}}function CD(n,e){const t=AD(e);for(const i of n.elements)t.some((r=>os(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Ru extends ay{constructor(e){super(),this.elements=e}}function RD(n,e){let t=AD(e);for(const i of n.elements)t=t.filter((r=>!os(r,i)));return{arrayValue:{values:t}}}class Gd extends ay{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kR(n){return Kt(n.integerValue||n.doubleValue)}function AD(n){return zd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class KG{constructor(e,t){this.field=e,this.transform=t}}function HG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Cu&&r instanceof Cu||i instanceof Ru&&r instanceof Ru?pu(i.elements,r.elements,os):i instanceof Gd&&r instanceof Gd?os(i.Ae,r.Ae):i instanceof Bd&&r instanceof Bd})(n.transform,e.transform)}class qG{constructor(e,t){this.version=e,this.transformResults=t}}class _r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _r}static exists(e){return new _r(void 0,e)}static updateTime(e){return new _r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ly{}function PD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new pw(n.key,_r.none()):new yf(n.key,n.data,_r.none());{const t=n.data,i=pr.empty();let r=new mt(zt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Lu(n.key,i,new Vs(r.toArray()),_r.none())}}function XG(n,e,t){n instanceof yf?(function(r,s,o){const l=r.value.clone(),u=NR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Lu?(function(r,s,o){if(!pp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=NR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(bD(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function ud(n,e,t,i){return n instanceof yf?(function(s,o,l,u){if(!pp(s.precondition,o))return l;const h=s.value.clone(),f=MR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Lu?(function(s,o,l,u){if(!pp(s.precondition,o))return l;const h=MR(s.fieldTransforms,u,o),f=o.data;return f.setAll(bD(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return pp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function DR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&pu(i,r,((s,o)=>HG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class yf extends ly{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Lu extends ly{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function bD(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function NR(n,e,t){const i=new Map;Ne(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,WG(o,l,t[r]))}return i}function MR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,GG(s,o,e))}return i}class pw extends ly{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kD extends ly{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&XG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ud(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ud(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=ID();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=PD(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Ze.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&pu(this.mutations,e.mutations,((t,i)=>DR(t,i)))&&pu(this.baseMutations,e.baseMutations,((t,i)=>DR(t,i)))}}class yw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ne(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return FG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new yw(e,t,i,r)}}class _w{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var $t,Ye;function YG(n){switch(n){case le.OK:return Re(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function ZG(n){if(n===void 0)return wi("GRPC error has no .code"),le.UNKNOWN;switch(n){case $t.OK:return le.OK;case $t.CANCELLED:return le.CANCELLED;case $t.UNKNOWN:return le.UNKNOWN;case $t.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case $t.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case $t.INTERNAL:return le.INTERNAL;case $t.UNAVAILABLE:return le.UNAVAILABLE;case $t.UNAUTHENTICATED:return le.UNAUTHENTICATED;case $t.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case $t.NOT_FOUND:return le.NOT_FOUND;case $t.ALREADY_EXISTS:return le.ALREADY_EXISTS;case $t.PERMISSION_DENIED:return le.PERMISSION_DENIED;case $t.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case $t.ABORTED:return le.ABORTED;case $t.OUT_OF_RANGE:return le.OUT_OF_RANGE;case $t.UNIMPLEMENTED:return le.UNIMPLEMENTED;case $t.DATA_LOSS:return le.DATA_LOSS;default:return Re(39323,{code:n})}}(Ye=$t||($t={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";new iw([4294967295,4294967295],0);const QG={asc:"ASCENDING",desc:"DESCENDING"},JG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},e7={and:"AND",or:"OR"};class t7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function n7(n,e){return n.useProto3Json||ey(e)?e:{value:e}}function l1(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function i7(n,e){return l1(n,e.toTimestamp())}function Er(n){return Ne(!!n,49232),Ze.fromTimestamp((function(t){const i=na(t);return new bt(i.seconds,i.nanos)})(n))}function DD(n,e){return c1(n,e).canonicalString()}function c1(n,e){const t=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function ND(n){const e=Ct.fromString(n);return Ne(f7(e),10190,{key:e.toString()}),e}function cm(n,e){return DD(n.databaseId,e.path)}function mp(n,e){const t=ND(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(OD(t))}function MD(n,e){return DD(n.databaseId,e)}function LD(n){const e=ND(n);return e.length===4?Ct.emptyPath():OD(e)}function r7(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function OD(n){return Ne(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function LR(n,e,t){return{name:cm(n,e),fields:t.value.mapValue.fields}}function s7(n,e,t){const i=mp(n,e.name),r=Er(e.updateTime),s=e.createTime?Er(e.createTime):Ze.min(),o=new pr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function um(n,e){let t;if(e instanceof yf)t={update:LR(n,e.key,e.value)};else if(e instanceof pw)t={delete:cm(n,e.key)};else if(e instanceof Lu)t={update:LR(n,e.key,e.data),updateMask:d7(e.fieldMask)};else{if(!(e instanceof kD))return Re(16599,{Vt:e.type});t={verify:cm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Bd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Cu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ru)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Gd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Re(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:i7(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re(27497)})(n,e.precondition)),t}function u1(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?_r.updateTime(Er(s.updateTime)):s.exists!==void 0?_r.exists(s.exists):_r.none()})(e.currentDocument):_r.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)Ne(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Bd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Cu(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Ru(f)}else"increment"in l?u=new Gd(o,l.increment):Re(16584,{proto:l});const h=zt.fromServerFormat(l.fieldPath);return new KG(h,u)})(n,r))):[];if(e.update){e.update.name;const r=mp(n,e.update.name),s=new pr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new Vs(h.map((f=>zt.fromServerFormat(f))))})(e.updateMask);return new Lu(r,s,o,t,i)}return new yf(r,s,t,i)}if(e.delete){const r=mp(n,e.delete);return new pw(r,t)}if(e.verify){const r=mp(n,e.verify);return new kD(r,t)}return Re(1463,{proto:e})}function o7(n,e){return n&&n.length>0?(Ne(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Er(r.updateTime):Er(s);return o.isEqual(Ze.min())&&(o=Er(s)),new qG(o,r.transformResults||[])})(t,e)))):[]}function a7(n,e){return{documents:[MD(n,e.path)]}}function l7(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=MD(n,r);const s=(function(h){if(h.length!==0)return jD(gt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Oc(y.field),direction:c7(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=n7(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function FD(n){let e=LD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ne(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const y=VD(p);return y instanceof gt&&gw(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((y=>(function(T){return new am(Fc(T.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let y;return y=typeof p=="object"?p.value:p,ey(y)?null:y})(t.limit));let u=null;t.startAt&&(u=(function(p){const y=!!p.before,E=p.values||[];return new Su(E,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const y=!p.before,E=p.values||[];return new Su(E,y)})(t.endAt)),bG(e,r,o,s,l,"F",u,h)}function VD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Fc(t.unaryFilter.field);return Xe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Fc(t.unaryFilter.field);return Xe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Fc(t.unaryFilter.field);return Xe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fc(t.unaryFilter.field);return Xe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Xe.create(Fc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gt.create(t.compositeFilter.filters.map((i=>VD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function c7(n){return QG[n]}function u7(n){return JG[n]}function h7(n){return e7[n]}function Oc(n){return{fieldPath:n.canonicalString()}}function Fc(n){return zt.fromServerFormat(n.fieldPath)}function jD(n){return n instanceof Xe?(function(t){if(t.op==="=="){if(TR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NAN"}};if(ER(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(TR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NAN"}};if(ER(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oc(t.field),op:u7(t.op),value:t.value}}})(n):n instanceof gt?(function(t){const i=t.getFilters().map((r=>jD(r)));return i.length===1?i[0]:{compositeFilter:{op:h7(t.op),filters:i}}})(n):Re(54877,{filter:n})}function d7(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function f7(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Kc{constructor(e,t,i,r,s=Ze.min(),o=Ze.min(),l=ci.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Kc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class UD{constructor(e){this.yt=e}}function g7(n,e){let t;if(e.document)t=s7(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Cl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Cl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new bt(r[0],r[1]);return Ze.fromTimestamp(s)})(e.readTime)),t}function OR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:hm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:cm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:l1(s,o.version.toTimestamp()),createTime:l1(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Il(e.version)};else{if(!e.isUnknownDocument())return Re(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Il(e.version)}}return i}function hm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Il(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cl(n){const e=new bt(n.seconds,n.nanoseconds);return Ze.fromTimestamp(e)}function Ha(n,e){const t=(e.baseMutations||[]).map((s=>u1(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>u1(n.yt,s))),r=bt.fromMillis(e.localWriteTimeMs);return new mw(e.batchId,r,t,i)}function qh(n){const e=Cl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cl(n.lastLimboFreeSnapshotVersion):Ze.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Ne(o===1,1966,{count:o}),Ws(wD(LD(s.documents[0])))})(n.query):(function(s){return Ws(FD(s))})(n.query),new Kc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ci.fromBase64String(n.resumeToken))}function zD(n,e){const t=Il(e.snapshotVersion),i=Il(e.lastLimboFreeSnapshotVersion);let r;r=PG(e.target)?a7(n.yt,e.target):l7(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Sl(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function BD(n){const e=FD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?a1(e,e.limit,"L"):e}function $0(n,e){return new _w(e.largestBatchId,u1(n.yt,e.overlayMutation))}function FR(n,e){const t=e.path.lastSegment();return[n,Gn(e.path.popLast()),t]}function VR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Il(i.readTime),documentKey:Gn(i.documentKey.path),largestBatchId:i.largestBatchId}}class p7{getBundleMetadata(e,t){return jR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Cl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return jR(e).put((function(r){return{bundleId:r.id,createTime:Il(Er(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return UR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:BD(s.bundledQuery),readTime:Cl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return UR(e).put((function(r){return{name:r.name,readTime:Il(Er(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function jR(n){return en(n,ty)}function UR(n){return en(n,ny)}class cy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new cy(e,i)}getOverlay(e,t){return Dh(e).get(FR(this.userId,t)).next((i=>i?$0(this.serializer,i):null))}getOverlays(e,t){const i=Jr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new _w(t,o);r.push(this.St(e,l))})),Y.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Gn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dh(e).Z(e1,l))})),Y.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Jr(),s=Gn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dh(e).J(e1,o).next((l=>{for(const u of l){const h=$0(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=Jr();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dh(e).ee({index:Jk,range:l},((u,h,f)=>{const p=$0(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Dh(e).put((function(r,s,o){const[l,u,h]=FR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:um(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dh(n){return en(n,iy)}class m7{bt(e){return en(e,cw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?ci.fromUint8Array(i):ci.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class qa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Kt(e.integerValue));else if("doubleValue"in e){const i=Kt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),em(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=na(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(xu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?dD(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ry(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Re(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=om,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Kt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}qa.Kt=new qa;const Rc=255;function y7(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function zR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=y7(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class _7{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=zR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=zR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Rc),this.sn(255)}_n(){this.an(Rc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Rc?(this.sn(Rc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Rc?(this.an(Rc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class v7{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class x7{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Nh{constructor(){this.cn=new _7,this.ln=new v7(this.cn),this.hn=new x7(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Xa{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Xa(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:yp(this.En),directionalValue:yp(this.dn),orderedDocumentKey:yp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function ko(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=BR(n.En,e.En),t!==0?t:(t=BR(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function BR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function yp(n){return Zb()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function GR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class WR{constructor(e){this.mn=new mt(((t,i)=>zt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ne(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Zv(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(zt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new hp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new hp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new hp(i.field,i.dir==="asc"?0:1)));return new Jp(Jp.UNKNOWN_ID,this.collectionId,t,Od.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function GD(n){if(Ne(n instanceof Xe||n instanceof gt,20012),n instanceof Xe){if(n instanceof xD){const t=n.value.arrayValue?.values?.map((i=>Xe.create(n.field,"==",i)))||[];return gt.create(t,"or")}return n}const e=n.filters.map((t=>GD(t)));return gt.create(e,n.op)}function w7(n){if(n.getFilters().length===0)return[];const e=f1(GD(n));return Ne(WD(e),7391),h1(e)||d1(e)?[e]:e.getFilters()}function h1(n){return n instanceof Xe}function d1(n){return n instanceof gt&&gw(n)}function WD(n){return h1(n)||d1(n)||(function(t){if(t instanceof gt&&r1(t)){for(const i of t.getFilters())if(!h1(i)&&!d1(i))return!1;return!0}return!1})(n)}function f1(n){if(Ne(n instanceof Xe||n instanceof gt,34018),n instanceof Xe)return n;if(n.filters.length===1)return f1(n.filters[0]);const e=n.filters.map((i=>f1(i)));let t=gt.create(e,n.op);return t=dm(t),WD(t)?t:(Ne(t instanceof gt,64498),Ne(Iu(t),40251),Ne(t.filters.length>1,57927),t.filters.reduce(((i,r)=>vw(i,r))))}function vw(n,e){let t;return Ne(n instanceof Xe||n instanceof gt,38388),Ne(e instanceof Xe||e instanceof gt,25473),t=n instanceof Xe?e instanceof Xe?(function(r,s){return gt.create([r,s],"and")})(n,e):$R(n,e):e instanceof Xe?$R(e,n):(function(r,s){if(Ne(r.filters.length>0&&s.filters.length>0,48005),Iu(r)&&Iu(s))return yD(r,s.getFilters());const o=r1(r)?r:s,l=r1(r)?s:r,u=o.filters.map((h=>vw(h,l)));return gt.create(u,"or")})(n,e),dm(t)}function $R(n,e){if(Iu(e))return yD(e,n.getFilters());{const t=e.filters.map((i=>vw(n,i)));return gt.create(t,"or")}}function dm(n){if(Ne(n instanceof Xe||n instanceof gt,11850),n instanceof Xe)return n;const e=n.getFilters();if(e.length===1)return dm(e[0]);if(pD(n))return n;const t=e.map((r=>dm(r))),i=[];return t.forEach((r=>{r instanceof Xe?i.push(r):r instanceof gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:gt.create(i,n.op)}class E7{constructor(){this.Cn=new xw}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(Ci.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(Ci.min())}updateCollectionGroup(e,t,i){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}}class xw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new mt(Ct.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mt(Ct.comparator)).toArray()}}const KR="IndexedDbIndexManager",qg=new Uint8Array(0);class T7{constructor(e,t){this.databaseId=t,this.vn=new xw,this.Fn=new aa((i=>Sl(i)),((i,r)=>mf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Gn(r)};return HR(e).put(s)}return Y.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Bk(t),""],!1,!0);return HR(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Qr(o.parent))}return i}))}addFieldIndex(e,t){const i=Mh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Pc(e);return s.next((l=>{o.put(VR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Mh(e),r=Pc(e),s=Ac(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Mh(e),i=Ac(e),r=Pc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Y.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new WR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ac(e);let r=!0;const s=new Map;return Y.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Sn();const l=[];return Y.forEach(s,((u,h)=>{fe(KR,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${Sl(t)}`);const f=(function(D,L){const F=Zv(L);if(F===void 0)return null;for(const B of lm(D,F.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(h,u),p=(function(D,L){const F=new Map;for(const B of Ga(L))for(const b of lm(D,B.fieldPath))switch(b.op){case"==":case"in":F.set(B.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return F.set(B.fieldPath.canonicalString(),b.value),Array.from(F.values())}return null})(h,u),y=(function(D,L){const F=[];let B=!0;for(const b of Ga(L)){const R=b.kind===0?AR(D,b.fieldPath,D.startAt):PR(D,b.fieldPath,D.startAt);F.push(R.value),B&&(B=R.inclusive)}return new Su(F,B)})(h,u),E=(function(D,L){const F=[];let B=!0;for(const b of Ga(L)){const R=b.kind===0?PR(D,b.fieldPath,D.endAt):AR(D,b.fieldPath,D.endAt);F.push(R.value),B&&(B=R.inclusive)}return new Su(F,B)})(h,u),T=this.On(u,h,y),I=this.On(u,h,E),S=this.Nn(u,h,p),P=this.Bn(u.indexId,f,T,y.inclusive,I,E.inclusive,S);return Y.forEach(P,(N=>i.Y(N,t.limit).next((D=>{D.forEach((L=>{const F=Ee.fromSegments(L.documentKey);o.has(F)||(o=o.add(F),l.push(F))}))}))))})).next((()=>l))}return Y.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=w7(gt.create(e.filters,"and")).map((i=>o1(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const y=t?this.Ln(t[p/h]):qg,E=this.kn(e,y,i[p%h],r),T=this.qn(e,y,s[p%h],o),I=l.map((S=>this.kn(e,y,S,!0)));f.push(...this.createRange(E,T,I))}return f}kn(e,t,i,r){const s=new Xa(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Xa(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new WR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Y.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new mt(zt.comparator),f=!1;for(const p of u.filters)for(const y of p.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Nh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);qa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Nh;return qa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Nh;return qa.Kt.Dt(fw(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Nh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&zd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);qa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Nh;u.seed(l.un()),qa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Xe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Mh(e),r=Pc(e);return(t?i.J(Jv,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Y.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const y=p?new Od(p.sequenceNumber,new Ci(Cl(p.readTime),new Ee(Qr(p.documentKey)),p.largestBatchId)):Od.empty(),E=f.fields.map((([T,I])=>new hp(zt.fromServerFormat(T),I)));return new Jp(f.indexId,f.collectionGroup,E,y)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:$e(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Mh(e),s=Pc(e);return this.Gn(e).next((o=>r.J(Jv,IDBKeyRange.bound(t,t)).next((l=>Y.forEach(l,(u=>s.put(VR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Y.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Y.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Y.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Y.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Ac(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ac(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ac(e);let s=new mt(ko);return r.ee({index:Qk,range:IDBKeyRange.only([i.indexId,this.uid,yp(this.$n(i,t))])},((o,l)=>{s=s.add(new Xa(i.indexId,t,GR(l.arrayValue),GR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new mt(ko);const r=this.Qn(t,e);if(r==null)return i;const s=Zv(t);if(s!=null){const o=e.data.field(s.fieldPath);if(zd(o))for(const l of o.arrayValue.values||[])i=i.add(new Xa(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Xa(t.indexId,e.key,qg,r));return i}Jn(e,t,i,r,s){fe(KR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,y){const E=u.getIterator(),T=h.getIterator();let I=Cc(E),S=Cc(T);for(;I||S;){let P=!1,N=!1;if(I&&S){const D=f(I,S);D<0?N=!0:D>0&&(P=!0)}else I!=null?N=!0:P=!0;P?(p(S),S=Cc(T)):N?(y(I),I=Cc(E)):(I=Cc(E),S=Cc(T))}})(r,s,ko,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Y.waitFor(o)}Gn(e){let t=1;return Pc(e).ee({index:Zk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>ko(o,l))).filter(((o,l,u)=>!l||ko(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=ko(o,e),u=ko(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,qg,Ee.empty()),u=r[o+1].Vn(this.uid,qg,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return ko(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(qR)}getMinOffset(e,t){return Y.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Re(44426))))).next(qR)}}function HR(n){return en(n,jd)}function Ac(n){return en(n,od)}function Mh(n){return en(n,lw)}function Pc(n){return en(n,sd)}function qR(n){Ne(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;sw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ci(e.readTime,e.documentKey,t)}const XR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$D=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function KD(n,e,t){const i=n.store(hr),r=n.store(mu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,y)=>(l++,y.delete())));s.push(u.next((()=>{Ne(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=qk(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return Y.waitFor(s).next((()=>h))}function fm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re(14731);e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn($D,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class uy{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Ne(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new uy(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).ee({index:nl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Vc(e),o=Do(e);return o.add({}).next((l=>{Ne(typeof l=="number",49019);const u=new mw(l,t,i,r),h=(function(E,T,I){const S=I.baseMutations.map((N=>um(E.yt,N))),P=I.mutations.map((N=>um(E.yt,N)));return{userId:T,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:S,mutations:P}})(this.serializer,this.userId,u),f=[];let p=new mt(((y,E)=>$e(y.canonicalString(),E.canonicalString())));for(const y of r){const E=qk(this.userId,y.key.path,l);p=p.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(E,$8))}return p.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Y.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Do(e).get(t).next((i=>i?(Ne(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Ha(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Y.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Do(e).ee({index:nl,range:r},((o,l,u)=>{l.userId===this.userId&&(Ne(l.batchId>=i,47524,{tr:i}),s=Ha(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=cl;return Do(e).ee({index:nl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,cl],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).J(nl,t).next((i=>i.map((r=>Ha(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=dp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,y=Qr(f);if(h===this.userId&&t.path.isEqual(y))return Do(e).get(p).next((E=>{if(!E)throw Re(61480,{nr:o,batchId:p});Ne(E.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:E.userId,batchId:p}),s.push(Ha(this.serializer,E))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt($e);const r=[];return t.forEach((s=>{const o=dp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Vc(e).ee({range:l},((h,f,p)=>{const[y,E,T]=h,I=Qr(E);y===this.userId&&s.path.isEqual(I)?i=i.add(T):p.done()}));r.push(u)})),Y.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=dp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new mt($e);return Vc(e).ee({range:o},((u,h,f)=>{const[p,y,E]=u,T=Qr(y);p===this.userId&&i.isPrefixOf(T)?T.length===r&&(l=l.add(E)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Do(e).get(s).next((o=>{if(o===null)throw Re(35274,{batchId:s});Ne(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Ha(this.serializer,o))})))})),Y.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return KD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Y.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Y.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Vc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=Qr(s[1]);r.push(u)}else l.done()})).next((()=>{Ne(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return HD(e,this.userId,t)}_r(e){return qD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:cl,lastStreamToken:""}))}}function HD(n,e,t){const i=dp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Vc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,y]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function Do(n){return en(n,hr)}function Vc(n){return en(n,mu)}function qD(n){return en(n,Fd)}class Rl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rl(0)}static cr(){return new Rl(-1)}}class S7{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Rl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ze.fromTimestamp(new bt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>bc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ne(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return bc(e).ee(((o,l)=>{const u=qh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Y.waitFor(s))).next((()=>r))}forEachTarget(e,t){return bc(e).ee(((i,r)=>{const s=qh(r);t(s)}))}lr(e){return YR(e).get(im).next((t=>(Ne(t!==null,2888),t)))}hr(e,t){return YR(e).put(im,t)}Pr(e,t){return bc(e).put(zD(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Sl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return bc(e).ee({range:r,index:Yk},((o,l,u)=>{const h=qh(l);mf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=zo(e);return t.forEach((o=>{const l=Gn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Y.waitFor(r)}removeMatchingKeys(e,t,i){const r=zo(e);return Y.forEach(t,(s=>{const o=Gn(s.path);return Y.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=zo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=zo(e);let s=Sn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=Qr(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Gn(t.path),r=IDBKeyRange.bound([i],[Bk(i)],!1,!0);let s=0;return zo(e).ee({index:aw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return bc(e).get(t).next((i=>i?qh(i):null))}}function bc(n){return en(n,yu)}function YR(n){return en(n,ul)}function zo(n){return en(n,_u)}const ZR="LruGarbageCollector",I7=1048576;function QR([n,e],[t,i]){const r=$e(n,t);return r===0?$e(e,i):r}class C7{constructor(e){this.Ir=e,this.buffer=new mt(QR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();QR(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class R7{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(ZR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ll(t)?fe(ZR,"Ignoring IndexedDB error during garbage collection: ",t):await Qm(t)}await this.Vr(3e5)}))}}class A7{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(yr.ce);const i=new C7(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(XR)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),XR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),Lc()<=Ke.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function P7(n,e){return new A7(n,e)}class b7{constructor(e,t){this.db=e,this.garbageCollector=P7(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Xg(e,i)}removeReference(e,t,i){return Xg(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Xg(e,t)}br(e,t){return(function(r,s){let o=!1;return qD(r).te((l=>HD(r,l,s).next((u=>(u&&(o=!0),Y.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Ze.min()),zo(e).delete((function(p){return[0,Gn(p.path)]})(o)))))}));r.push(u)}})).next((()=>Y.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Xg(e,t)}Sr(e,t){const i=zo(e);let r,s=yr.ce;return i.ee({index:aw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==yr.ce&&t(new Ee(Qr(r)),s),s=h,r=u):s=yr.ce})).next((()=>{s!==yr.ce&&t(new Ee(Qr(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Xg(n,e){return zo(n).put((function(i,r){return{targetId:0,path:Gn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class XD{constructor(){this.changes=new aa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Y.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class k7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Fa(e).put(i)}removeEntry(e,t,i){return Fa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],hm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Fa(e).ee({index:fp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Fa(e).ee({index:fp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i={document:this.Cr(t,s),size:fm(s)}})).next((()=>i))}getEntries(e,t){let i=il();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=il(),r=new li(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,fm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Y.resolve();let r=new mt(tA);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Lh(r.first()),Lh(r.last())),o=r.getIterator();let l=o.getNext();return Fa(e).ee({index:fp,range:s},((u,h,f)=>{const p=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&tA(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Lh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),hm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fa(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=il();for(const p of h){const y=this.Cr(Ee.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);y.isFoundDocument()&&(oy(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=il();const o=eA(t,i),l=eA(t,Ci.max());return Fa(e).ee({index:Xk,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new D7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return JR(e).get(Qv).next((t=>(Ne(!!t,20021),t)))}Dr(e,t){return JR(e).put(Qv,t)}Cr(e,t){if(t){const i=g7(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ze.min())))return i}return Tn.newInvalidDocument(e)}}function YD(n){return new k7(n)}class D7 extends XD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new aa((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new mt(((s,o)=>$e(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=OR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=fm(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=OR(this.Nr.serializer,o.convertToNoDocument(Ze.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Y.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function JR(n){return en(n,Vd)}function Fa(n){return en(n,nm)}function Lh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function eA(n,e){const t=e.documentKey.path.toArray();return[n,hm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function tA(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=$e(t[s],i[s]),r)return r;return r=$e(t.length,i.length),r||(r=$e(t[t.length-2],i[i.length-2]),r||$e(t[t.length-1],i[i.length-1]))}class N7{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&ud(i.mutation,r,Vs.empty(),bt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Sn()){const r=Jr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Hg();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=Jr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Sn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=il();const o=cd(),l=(function(){return cd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Lu)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),ud(f.mutation,h,f.mutation.getFieldMask(),bt.now())):o.set(h.key,Vs.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new N7(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=cd();let r=new li(((o,l)=>o-l)),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||Vs.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||Sn()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=ID();f.forEach((y=>{if(!s.has(y)){const E=PD(t.get(y),i.get(y));E!==null&&p.set(y,E),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Y.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):kG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Y.resolve(Jr());let l=Ld,u=s;return o.next((h=>Y.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?Y.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{u=u.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Sn()))).next((f=>({batchId:l,changes:OG(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=Hg();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Hg();return this.indexManager.getCollectionParents(e,s).next((l=>Y.forEach(l,(u=>{const h=(function(p,y){return new sy(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,y)=>{o=o.insert(p,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=Hg();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&ud(f.mutation,h,Vs.empty(),bt.now()),oy(t,h)&&(l=l.insert(u,h))})),l}))}}class M7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Er(r.createTime)}})(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:BD(r.bundledQuery),readTime:Er(r.readTime)}})(t)),Y.resolve()}}class L7{constructor(){this.overlays=new li(Ee.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Jr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Y.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Y.resolve()}getOverlaysForCollection(e,t,i){const r=Jr(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Y.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new li(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=Jr(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=Jr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Y.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new _w(t,i));let s=this.qr.get(t);s===void 0&&(s=Sn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class O7{constructor(){this.sessionToken=ci.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}}class ww{constructor(){this.Qr=new mt(cn.$r),this.Ur=new mt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Ct([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Ct([])),i=new cn(t,e),r=new cn(t,e+1);let s=Sn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||$e(e.Yr,t.Yr)}static Kr(e,t){return $e(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class F7{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mt(cn.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new mw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?cl:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt($e);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Y.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ee(s),0);let l=new mt($e);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Y.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ne(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Y.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Y.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class V7{constructor(e){this.ri=e,this.docs=(function(){return new li(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Y.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=il();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Y.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=il();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||sw(Wk(f),i)<=0||(r.has(f.key)||oy(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Y.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Re(9500)}ii(e,t){return Y.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new j7(this)}getSize(e){return Y.resolve(this.size)}}class j7 extends XD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class U7{constructor(e){this.persistence=e,this.si=new aa((t=>Sl(t)),mf),this.lastRemoteSnapshotVersion=Ze.min(),this.highestTargetId=0,this.oi=0,this._i=new ww,this.targetCount=0,this.ai=Rl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Y.waitFor(s).next((()=>r))}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Y.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Y.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Y.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Y.resolve(i)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}}class QD{constructor(e,t){this.ui={},this.overlays={},this.ci=new yr(0),this.li=!1,this.li=!0,this.hi=new O7,this.referenceDelegate=e(this),this.Pi=new U7(this),this.indexManager=new E7,this.remoteDocumentCache=(function(r){return new V7(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new UD(t),this.Ii=new M7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new L7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new F7(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe("MemoryPersistence","Starting transaction:",e);const r=new z7(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Y.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class z7 extends Kk{constructor(e){super(),this.currentSequenceNumber=e}}class hy{constructor(e){this.persistence=e,this.Ri=new ww,this.Vi=null}static mi(e){return new hy(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Y.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Ze.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class B7{constructor(e){this.serializer=e}k(e,t,i,r){const s=new Jm("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(pf)})(e),(function(u){u.createObjectStore(Fd,{keyPath:W8}),u.createObjectStore(hr,{keyPath:mR,autoIncrement:!0}).createIndex(nl,yR,{unique:!0}),u.createObjectStore(mu)})(e),nA(e),(function(u){u.createObjectStore(Wa)})(e));let o=Y.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(_u),u.deleteObjectStore(yu),u.deleteObjectStore(ul)})(e),nA(e)),o=o.next((()=>(function(u){const h=u.store(ul),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ze.min().toTimestamp(),targetCount:0};return h.put(im,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(hr).J().next((p=>{u.deleteObjectStore(hr),u.createObjectStore(hr,{keyPath:mR,autoIncrement:!0}).createIndex(nl,yR,{unique:!0});const y=h.store(hr),E=p.map((T=>y.put(T)));return Y.waitFor(E)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(vu,{keyPath:J8})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Vd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(ty,{keyPath:eG})})(e),(function(u){u.createObjectStore(ny,{keyPath:tG})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(iy,{keyPath:lG});h.createIndex(e1,cG,{unique:!1}),h.createIndex(Jk,uG,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(nm,{keyPath:K8});h.createIndex(fp,H8),h.createIndex(Xk,q8)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Wa)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(lw,{keyPath:nG,autoIncrement:!0}).createIndex(Jv,iG,{unique:!1}),u.createObjectStore(sd,{keyPath:rG}).createIndex(Zk,sG,{unique:!1}),u.createObjectStore(od,{keyPath:oG}).createIndex(Qk,aG,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(cw,{keyPath:hG})})(e)}))),i<18&&r>=18&&Zb()&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),o}wi(e){let t=0;return e.store(Wa).ee(((i,r)=>{t+=fm(r)})).next((()=>{const i={byteSize:t};return e.store(Vd).put(Qv,i)}))}yi(e){const t=e.store(Fd),i=e.store(hr);return t.J().next((r=>Y.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,cl],[s.userId,s.lastAcknowledgedBatchId]);return i.J(nl,o).next((l=>Y.forEach(l,(u=>{Ne(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Ha(this.serializer,u);return KD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(_u),i=e.store(Wa);return e.store(ul).get(im).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Ct(o),h=(function(p){return[0,Gn(p)]})(u);s.push(t.get(h).next((f=>f?Y.resolve():(p=>t.put({targetId:0,path:Gn(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Y.waitFor(s)))}))}bi(e,t){e.createObjectStore(jd,{keyPath:Q8});const i=t.store(jd),r=new xw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Gn(u)})}};return t.store(Wa).ee({X:!0},((o,l)=>{const u=new Ct(o);return s(u.popLast())})).next((()=>t.store(mu).ee({X:!0},(([o,l,u],h)=>{const f=Qr(l);return s(f.popLast())}))))}Di(e){const t=e.store(yu);return t.ee(((i,r)=>{const s=qh(r),o=zD(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Wa),r=[];return i.ee(((s,o)=>{const l=t.store(nm),u=(function(p){return p.document?new Ee(Ct.fromString(p.document.name).popFirst(5)):p.noDocument?Ee.fromSegments(p.noDocument.path):p.unknownDocument?Ee.fromSegments(p.unknownDocument.path):Re(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Y.waitFor(r)))}Fi(e,t){const i=t.store(hr),r=YD(this.serializer),s=new QD(hy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Sn();Ha(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Y.forEach(l,((u,h)=>{const f=new wn(h),p=cy.wt(this.serializer,f),y=s.getIndexManager(f),E=uy.wt(f,this.serializer,y,s.referenceDelegate);return new ZD(r,E,p,y).recalculateAndSaveOverlaysForDocumentKeys(new t1(t,yr.ce),u).next()}))}))}}function nA(n){n.createObjectStore(_u,{keyPath:Y8}).createIndex(aw,Z8,{unique:!0}),n.createObjectStore(yu,{keyPath:"targetId"}).createIndex(Yk,X8,{unique:!0}),n.createObjectStore(ul)}const No="IndexedDbPersistence",K0=18e5,H0=5e3,q0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",G7="main";class Ew{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!Ew.v())throw new Se(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new b7(this,r),this.$i=t+G7,this.serializer=new UD(u),this.Ui=new Zo(this.$i,this.Ni,new B7(this.serializer)),this.hi=new m7,this.Pi=new S7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=YD(this.serializer),this.Ii=new p7,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&wi(No,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Se(le.FAILED_PRECONDITION,q0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new yr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Yg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ll(e))return fe(No,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(No,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Oh(e).get(Ic).next((t=>Y.resolve(this.es(t))))}ts(e){return Yg(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,K0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=en(t,vu);return i.J().next((r=>{const s=this.ss(r,K0),o=r.filter((l=>s.indexOf(l)===-1));return Y.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Y.resolve(!0):Oh(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,H0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Se(le.FAILED_PRECONDITION,q0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Yg(e).J().next((i=>this.ss(i,H0).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(No,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[pf,vu],(e=>{const t=new t1(e,yr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Yg(e).J().next((t=>this.ss(t,K0).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return uy.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new T7(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return cy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe(No,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?gG:u===17?iD:u===16?fG:u===15?uw:u===14?nD:u===13?tD:u===12?dG:u===11?eD:void Re(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new t1(l,this.ci?this.ci.next():yr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw wi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Se(le.FAILED_PRECONDITION,$k);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Oh(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,H0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Se(le.FAILED_PRECONDITION,q0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oh(e).put(Ic,t)}static v(){return Zo.v()}Zi(e){const t=Oh(e);return t.get(Ic).next((i=>this.es(i)?(fe(No,"Releasing primary lease."),t.delete(Ic)):Y.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(wi(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Yb()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(No,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return wi(No,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){wi("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Oh(n){return en(n,pf)}function Yg(n){return en(n,vu)}function W7(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Tw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Tw(e,t.fromCache,i,r)}}class $7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class JD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Yb()?8:Hk(Jt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new $7;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Lc()<=Ke.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",kh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Y.resolve()):(Lc()<=Ke.DEBUG&&fe("QueryEngine","Query:",kh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Lc()<=Ke.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",kh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ws(t))):Y.resolve())}ys(e,t){if(bR(t))return Y.resolve(null);let i=Ws(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=a1(t,null,"F"),i=Ws(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Sn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,a1(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return bR(t)||r.isEqual(Ze.min())?Y.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Y.resolve(null):(Lc()<=Ke.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kh(t)),this.vs(e,o,t,V8(r,Ld)).next((l=>l)))}))}Ds(e,t){let i=new mt(NG(e));return t.forEach(((r,s)=>{oy(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Lc()<=Ke.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",kh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ci.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const K7="LocalStore";class H7{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new li($e),this.xs=new aa((s=>Sl(s)),mf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function eN(n,e,t,i){return new H7(n,e,t,i)}async function q7(n,e){const t=Tt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Sn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function X7(n,e){const t=Tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,y=p.keys();let E=Y.resolve();return y.forEach((T=>{E=E.next((()=>f.getEntry(u,T))).next((I=>{const S=h.docVersions.get(T);Ne(S!==null,48541),I.version.compareTo(S)<0&&(p.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),E.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Sn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function Y7(n){const e=Tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Z7(n,e){const t=Tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=cl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class iA{constructor(){this.activeTargetIds=UG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tN{constructor(){this.Mo=new iA,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new iA,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Q7{Oo(e){}shutdown(){}}const rA="ConnectivityMonitor";class sA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(rA,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(rA,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Zg=null;function g1(){return Zg===null?Zg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Zg++,"0x"+Zg.toString(16)}const X0="RestConnection",J7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===sm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=g1(),l=this.zo(e,t.toUriEncodedString());fe(X0,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Nl(h);return this.Jo(e,l,u,i,f).then((p=>(fe(X0,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Zm(X0,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=J7[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class tW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class nW extends eW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=g1();return new Promise(((l,u)=>{const h=new Mk;h.setWithCredentials(!0),h.listenOnce(Lk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case up.NO_ERROR:const p=h.getResponseJson();fe(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case up.TIMEOUT:fe(kn,`RPC '${e}' ${o} timed out`),u(new Se(le.DEADLINE_EXCEEDED,"Request time out"));break;case up.HTTP_ERROR:const y=h.getStatus();if(fe(kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const T=E?.error;if(T&&T.status&&T.message){const I=(function(P){const N=P.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(N)>=0?N:le.UNKNOWN})(T.status);u(new Se(I,T.message))}else u(new Se(le.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Se(le.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{fe(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);fe(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=g1(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Vk(),l=Fk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");fe(kn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let y=!1,E=!1;const T=new tW({Yo:S=>{E?fe(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,S):(y||(fe(kn,`Opening RPC '${e}' stream ${r} transport.`),p.open(),y=!0),fe(kn,`RPC '${e}' stream ${r} sending:`,S),p.send(S))},Zo:()=>p.close()}),I=(S,P,N)=>{S.listen(P,(D=>{try{N(D)}catch(L){setTimeout((()=>{throw L}),0)}}))};return I(p,Hh.EventType.OPEN,(()=>{E||(fe(kn,`RPC '${e}' stream ${r} transport opened.`),T.o_())})),I(p,Hh.EventType.CLOSE,(()=>{E||(E=!0,fe(kn,`RPC '${e}' stream ${r} transport closed`),T.a_(),this.E_(p))})),I(p,Hh.EventType.ERROR,(S=>{E||(E=!0,Zm(kn,`RPC '${e}' stream ${r} transport errored. Name:`,S.name,"Message:",S.message),T.a_(new Se(le.UNAVAILABLE,"The operation could not be completed")))})),I(p,Hh.EventType.MESSAGE,(S=>{if(!E){const P=S.data[0];Ne(!!P,16349);const N=P,D=N?.error||N[0]?.error;if(D){fe(kn,`RPC '${e}' stream ${r} received error:`,D);const L=D.status;let F=(function(R){const M=$t[R];if(M!==void 0)return ZG(M)})(L),B=D.message;F===void 0&&(F=le.INTERNAL,B="Unknown error status: "+L+" with message "+D.message),E=!0,T.a_(new Se(F,B)),p.close()}else fe(kn,`RPC '${e}' stream ${r} received:`,P),T.u_(P)}})),I(l,Ok.STAT_EVENT,(S=>{S.stat===Xv.PROXY?fe(kn,`RPC '${e}' stream ${r} detected buffering proxy`):S.stat===Xv.NOPROXY&&fe(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function iW(){return typeof window<"u"?window:null}function _p(){return typeof document<"u"?document:null}function nN(n){return new t7(n,!0)}class iN{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const oA="PersistentStream";class rW{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new iN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(wi(t.toString()),wi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Se(le.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(oA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(oA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class sW extends rW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=o7(e.writeResults,e.commitTime),i=Er(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=r7(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>um(this.serializer,i)))};this.q_(t)}}class oW{}class aW extends oW{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Se(le.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,c1(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Se(le.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,c1(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(le.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class lW{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(wi(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const dy="RemoteStore";class cW{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{gy(this)&&(fe(dy,"Restarting streams for network reachability change."),await(async function(u){const h=Tt(u);h.Ea.add(4),await fy(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Sw(h)})(this))}))})),this.Ra=new lW(i,r)}}async function Sw(n){if(gy(n))for(const e of n.da)await e(!0)}async function fy(n){for(const e of n.da)await e(!1)}function gy(n){return Tt(n).Ea.size===0}async function rN(n,e,t){if(!Ll(e))throw e;n.Ea.add(1),await fy(n),n.Ra.set("Offline"),t||(t=()=>Y7(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(dy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Sw(n)}))}function sN(n,e){return e().catch((t=>rN(n,t,e)))}async function py(n){const e=Tt(n),t=ra(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cl;for(;uW(e);)try{const r=await Z7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,hW(e,r)}catch(r){await rN(e,r)}oN(e)&&aN(e)}function uW(n){return gy(n)&&n.Ta.length<10}function hW(n,e){n.Ta.push(e);const t=ra(n);t.O_()&&t.X_&&t.ea(e.mutations)}function oN(n){return gy(n)&&!ra(n).x_()&&n.Ta.length>0}function aN(n){ra(n).start()}async function dW(n){ra(n).ra()}async function fW(n){const e=ra(n);for(const t of n.Ta)e.ea(t.mutations)}async function gW(n,e,t){const i=n.Ta.shift(),r=yw.from(i,e,t);await sN(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await py(n)}async function pW(n,e){e&&ra(n).X_&&await(async function(i,r){if((function(o){return YG(o)&&o!==le.ABORTED})(r.code)){const s=i.Ta.shift();ra(i).B_(),await sN(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await py(i)}})(n,e),oN(n)&&aN(n)}async function mW(n,e){const t=Tt(n);e?(t.Ea.delete(2),await Sw(t)):e||(t.Ea.add(2),await fy(t),t.Ra.set("Unknown"))}function ra(n){return n.fa||(n.fa=(function(t,i,r){const s=Tt(t);return s.sa(),new sW(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:dW.bind(null,n),r_:pW.bind(null,n),ta:fW.bind(null,n),na:gW.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await py(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(dy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Iw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Iw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yW(n,e){if(wi("AsyncQueue",`${e}: ${n}`),Ll(n))return new Se(le.UNAVAILABLE,`${e}: ${n}`);throw n}class _W{constructor(){this.queries=aA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Tt(t),s=r.queries;r.queries=aA(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Se(le.ABORTED,"Firestore shutting down"))}}function aA(){return new aa((n=>TD(n)),ED)}function vW(n){n.Ca.forEach((e=>{e.next()}))}var lA,cA;(cA=lA||(lA={})).Ma="default",cA.Cache="cache";const xW="SyncEngine";class wW{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new aa((l=>TD(l)),ED),this.Iu=new Map,this.Eu=new Set,this.du=new li(Ee.comparator),this.Au=new Map,this.Ru=new ww,this.Vu={},this.mu=new Map,this.fu=Rl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function uA(n,e,t){const i=Tt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=Tt(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const y of p.Sa)y.va(l)&&(h=!0)})),h&&vW(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function EW(n,e){const t=Tt(n),i=e.batch.batchId;try{const r=await X7(t.localStore,e);cN(t,i,null),lN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Cw(t,r)}catch(r){await Qm(r)}}async function TW(n,e,t){const i=Tt(n);try{const r=await(function(o,l){const u=Tt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(Ne(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);cN(i,e,t),lN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Cw(i,r)}catch(r){await Qm(r)}}function lN(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function cN(n,e,t){const i=Tt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Cw(n,e,t){const i=Tt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Tw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=Tt(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Y.forEach(h,(y=>Y.forEach(y.Es,(E=>f.persistence.referenceDelegate.addReference(p,y.targetId,E))).next((()=>Y.forEach(y.ds,(E=>f.persistence.referenceDelegate.removeReference(p,y.targetId,E)))))))))}catch(p){if(!Ll(p))throw p;fe(K7,"Failed to update sequence numbers: "+p)}for(const p of h){const y=p.targetId;if(!p.fromCache){const E=f.Ms.get(y),T=E.snapshotVersion,I=E.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(y,I)}}})(i.localStore,s))}async function SW(n,e){const t=Tt(n);if(!t.currentUser.isEqual(e)){fe(xW,"User change. New user:",e.toKey());const i=await q7(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Se(le.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Cw(t,i.Ls)}}function IW(n){const e=Tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=TW.bind(null,e),e}class p1{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nN(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return eN(this.persistence,new JD,e.initialUser,this.serializer)}Cu(e){return new QD(hy.mi,this.serializer)}Du(e){return new tN}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}p1.provider={build:()=>new p1};class CW extends p1{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await IW(this.xu.syncEngine),await py(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return eN(this.persistence,new JD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new R7(i,e.asyncQueue,t)}Mu(e,t){const i=new B8(t,this.persistence);return new z8(e.asyncQueue,i)}Cu(e){const t=W7(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new Ew(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,iW(),_p(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new tN}}class m1{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>uA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=SW.bind(null,this.syncEngine),await mW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new _W})()}createDatastore(e){const t=nN(e.databaseInfo.databaseId),i=(function(s){return new nW(s)})(e.databaseInfo);return(function(s,o,l,u){return new aW(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new cW(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>uA(this.syncEngine,t,0)),(function(){return sA.v()?new sA:new Q7})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new wW(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Tt(t);fe(dy,"RemoteStore shutting down."),i.Ea.add(5),await fy(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}m1.provider={build:()=>new m1};const hA="FirestoreClient";class RW{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=zk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{fe(hA,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(fe(hA,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=yW(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function uN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const dA=new Map;const hN="firestore.googleapis.com",fA=!0;class gA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hN,this.ssl=fA}else this.host=e.host,this.ssl=e.ssl??fA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$D;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<I7)throw new Se(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}L8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dN{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new I8;switch(i.type){case"firstParty":return new P8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=dA.get(t);i&&(fe("ComponentProvider","Removing Datastore"),dA.delete(t),i.terminate())})(this),Promise.resolve()}}function AW(n,e,t,i={}){n=Gk(n,dN);const r=Nl(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(Bx(`https://${l}`),Gx("Firestore",!0)),s.host!==hN&&s.host!==l&&Zm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!xl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=qb(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Se(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(p)}n._authCredentials=new C8(new Uk(h,f))}}class Rw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Rw(this.firestore,e,this._query)}}class es{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Aw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new es(this.firestore,e,this._key)}toJSON(){return{type:es._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(gf(t,es._jsonSchema))return new es(e,i||null,new Ee(Ct.fromString(t.referencePath)))}}es._jsonSchemaVersion="firestore/documentReference/1.0",es._jsonSchema={type:Ht("string",es._jsonSchemaVersion),referencePath:Ht("string")};class Aw extends Rw{constructor(e,t,i){super(e,t,wD(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new es(this.firestore,null,new Ee(e))}withConverter(e){return new Aw(this.firestore,e,this._path)}}const pA="AsyncQueue";class mA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new iN(this,"async_queue_retry"),this._c=()=>{const i=_p();i&&fe(pA,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=_p();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=_p();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ll;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ll(e))throw e;fe(pA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,wi("INTERNAL UNHANDLED ERROR: ",yA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Iw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Re(47125,{Pc:yA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function yA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class fN extends dN{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new mA,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mA(e),this._firestoreClient=void 0,await e}}}function PW(n,e){const t=typeof n=="object"?n:Kx(),i=typeof n=="string"?n:sm,r=Hm(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=$b("firestore");s&&AW(r,...s)}return r}function bW(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new _G(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,uN(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new RW(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function kW(n,e){Zm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return DW(n,m1.provider,{build:i=>new CW(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function DW(n,e,t){if((n=Gk(n,fN))._firestoreClient||n._terminated)throw new Se(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Se(le.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},bW(n)}class Ls{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ls(ci.fromBase64String(e))}catch(t){throw new Se(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ls(ci.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ls._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gf(e,Ls._jsonSchema))return Ls.fromBase64String(e.bytes)}}Ls._jsonSchemaVersion="firestore/bytes/1.0",Ls._jsonSchema={type:Ht("string",Ls._jsonSchemaVersion),bytes:Ht("string")};class gN{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hl._jsonSchemaVersion}}static fromJSON(e){if(gf(e,hl._jsonSchema))return new hl(e.latitude,e.longitude)}}hl._jsonSchemaVersion="firestore/geoPoint/1.0",hl._jsonSchema={type:Ht("string",hl._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};class dl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:dl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gf(e,dl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new dl(e.vectorValues);throw new Se(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dl._jsonSchemaVersion="firestore/vectorValue/1.0",dl._jsonSchema={type:Ht("string",dl._jsonSchemaVersion),vectorValues:Ht("object")};const NW=new RegExp("[~\\*/\\[\\]]");function MW(n,e,t){if(e.search(NW)>=0)throw _A(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new gN(...e.split("."))._internalPath}catch{throw _A(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function _A(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Se(le.INVALID_ARGUMENT,s+n+o)}class pN{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new es(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mN("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class LW extends pN{data(){return super.data()}}function mN(n,e){return typeof e=="string"?MW(n,e):e instanceof gN?e._internalPath:e._delegate._internalPath}class Qg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class eu extends pN{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(mN("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=eu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}eu._jsonSchemaVersion="firestore/documentSnapshot/1.0",eu._jsonSchema={type:Ht("string",eu._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class vp extends eu{data(e={}){return super.data(e)}}class hd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Qg(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new vp(this._firestore,this._userDataWriter,i.key,i,new Qg(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new vp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Qg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new vp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Qg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:OW(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=zk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function OW(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}hd._jsonSchemaVersion="firestore/querySnapshot/1.0",hd._jsonSchema={type:Ht("string",hd._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};(function(e,t=!0){(function(r){Mu=r})(Ml),wl(new ta("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new fN(new R8(i.getProvider("auth-internal")),new b8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Se(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),is(lR,cR,e),is(lR,cR,"esm2020")})();const yN="firebasestorage.googleapis.com",FW="storageBucket",VW=120*1e3,jW=600*1e3;class hs extends us{constructor(e,t,i=0){super(Y0(e),`Firebase Storage: ${t} (${Y0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,hs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Y0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var as;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(as||(as={}));function Y0(n){return"storage/"+n}function UW(){const n="An unknown error occurred, please check the error payload for server response.";return new hs(as.UNKNOWN,n)}function zW(){return new hs(as.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BW(){return new hs(as.CANCELED,"User canceled the upload/download.")}function GW(n){return new hs(as.INVALID_URL,"Invalid URL '"+n+"'.")}function WW(n){return new hs(as.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function vA(n){return new hs(as.INVALID_ARGUMENT,n)}function _N(){return new hs(as.APP_DELETED,"The Firebase app was deleted.")}function $W(n){return new hs(as.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class vr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=vr.makeFromUrl(e,t)}catch{return new vr(e,"")}if(i.path==="")return i;throw WW(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",E=new RegExp(`^https?://${p}/${f}/b/${r}/o${y}`,"i"),T={bucket:1,path:3},I=t===yN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",P=new RegExp(`^https?://${I}/${r}/${S}`,"i"),D=[{regex:l,indices:u,postModify:s},{regex:E,indices:T,postModify:h},{regex:P,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<D.length;L++){const F=D[L],B=F.regex.exec(e);if(B){const b=B[F.indices.bucket];let R=B[F.indices.path];R||(R=""),i=new vr(b,R),F.postModify(i);break}}if(i==null)throw GW(e);return i}}class KW{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function HW(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...S){h||(h=!0,e.apply(null,S))}function p(S){r=setTimeout(()=>{r=null,n(E,u())},S)}function y(){s&&clearTimeout(s)}function E(S,...P){if(h){y();return}if(S){y(),f.call(null,S,...P);return}if(u()||o){y(),f.call(null,S,...P);return}i<64&&(i*=2);let D;l===1?(l=2,D=0):D=(i+Math.random())*1e3,p(D)}let T=!1;function I(S){T||(T=!0,y(),!h&&(r!==null?(S||(l=2),clearTimeout(r),p(0)):S||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function qW(n){n(!1)}function XW(n){return n!==void 0}function xA(n,e,t,i){if(i<e)throw vA(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw vA(`Invalid value for '${n}'. Expected ${t} or less.`)}function YW(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var gm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(gm||(gm={}));function ZW(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class QW{constructor(e,t,i,r,s,o,l,u,h,f,p,y=!0,E=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=y,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,I)=>{this.resolve_=T,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Jg(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===gm.NO_ERROR,u=s.getStatus();if(!l||ZW(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===gm.ABORT;i(!1,new Jg(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new Jg(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());XW(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=UW();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?_N():BW();o(u)}else{const u=zW();o(u)}};this.canceled_?t(!1,new Jg(!1,null,!0)):this.backoffId_=HW(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&qW(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Jg{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function JW(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function e$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function t$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function n$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function i$(n,e,t,i,r,s,o=!0,l=!1){const u=YW(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return t$(f,e),JW(f,t),e$(f,s),n$(f,i),new QW(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function r$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function s$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class pm{constructor(e,t){this._service=e,t instanceof vr?this._location=t:this._location=vr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new pm(e,t)}get root(){const e=new vr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return s$(this._location.path)}get storage(){return this._service}get parent(){const e=r$(this._location.path);if(e===null)return null;const t=new vr(this._location.bucket,e);return new pm(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $W(e)}}function wA(n,e){const t=e?.[FW];return t==null?null:vr.makeFromBucketSpec(t,n)}function o$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Nl(e);r&&(Bx(`https://${n.host}/b`),Gx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:qb(s,n.app.options.projectId))}class a${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=yN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=VW,this._maxUploadRetryTime=jW,this._requests=new Set,r!=null?this._bucket=vr.makeFromBucketSpec(r,this._host):this._bucket=wA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vr.makeFromBucketSpec(this._url,e):this._bucket=wA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if($i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new pm(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new KW(_N());{const o=i$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const EA="@firebase/storage",TA="0.14.0";const vN="storage";function l$(n=Kx(),e){n=Js(n);const i=Hm(n,vN).getImmediate({identifier:e}),r=$b("storage");return r&&c$(i,...r),i}function c$(n,e,t,i={}){o$(n,e,t,i)}function u$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new a$(t,i,r,e,Ml)}function h$(){wl(new ta(vN,u$,"PUBLIC").setMultipleInstances(!0)),is(EA,TA,""),is(EA,TA,"esm2020")}h$();const d$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Pw=tk(d$),Z0=w8(Pw),f$=PW(Pw);l$(Pw);kW(f$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const g$="visvriend2024",p$=new Ms,xN=Ir()(lf((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===g$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await bB(Z0,p$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await uB(Z0),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{cB(Z0,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),bw="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",y1=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function m$(n,e){let t=y1[0],i=1/0;for(const r of y1){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function y$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${bw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function _$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${bw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function v$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${bw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function x$(n){const[e,t,i]=await Promise.all([y$(n),_$(n),v$(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function SA(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const w$=Ir((n,e)=>({station:y1[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=m$(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=SA(t):r=await x$(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=SA(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})}));function E$({target:n}){const e=Z.useRef(null),t=Z.useRef(null),i=Qs(s=>s.setMap),r=ln(s=>s.showScaleBar);return Z.useEffect(()=>{if(!e.current){const s=new cU({target:n,controls:[],view:new Yr({center:gl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),Z.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new dU({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const T$=["OpenStreetMap","Luchtfoto"];function S$(){const n=Z.useRef(null),e=Z.useRef(!1);E$({target:"map"});const t=Qs(u=>u.map),i=qo(u=>u.registerLayer),r=qo(u=>u.setLayerVisibility),s=ln(u=>u.defaultBackground),o=ln(u=>u.gpsAutoStart),l=Wi(u=>u.startTracking);return Z.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=new C0({properties:{title:"OpenStreetMap",type:"base"},visible:!0,source:new P6}),h=new C0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Dv({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),f=new C0({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Dv({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(u),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",u),i("Luchtfoto",h),i("Labels Overlay",f),t.updateSize(),p();async function p(){const y=VU();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async T=>{try{const I=await T.factory();return I?{name:T.name,layer:I}:null}catch(I){return console.warn(`Failed to create ${T.name}:`,I),null}}))).forEach(T=>{if(T.status==="fulfilled"&&T.value){const{name:I,layer:S}=T.value;t.addLayer(S),i(I,S)}})}},[t,i]),Z.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";T$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),Z.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),v.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const I$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),C$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),IA=n=>{const e=C$(n);return e.charAt(0).toUpperCase()+e.slice(1)},wN=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),R$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var A$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const P$=Z.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>Z.createElement("svg",{ref:u,...A$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:wN("lucide",r),...!s&&!R$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>Z.createElement(h,f)),...Array.isArray(s)?s:[s]]));const De=(n,e)=>{const t=Z.forwardRef(({className:i,...r},s)=>Z.createElement(P$,{ref:s,iconNode:e,className:wN(`lucide-${I$(IA(n))}`,`lucide-${n}`,i),...r}));return t.displayName=IA(n),t};const b$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],EN=De("anchor",b$);const k$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],D$=De("book-open",k$);const N$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],kw=De("camera",N$);const M$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],L$=De("chart-column",M$);const O$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_1=De("check",O$);const F$=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],V$=De("chevron-down",F$);const j$=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],TN=De("chevron-up",j$);const U$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],z$=De("cloud-fog",U$);const B$=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],G$=De("cloud-lightning",B$);const W$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],$$=De("cloud-rain",W$);const K$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],H$=De("cloud-snow",K$);const q$=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],Wd=De("cloud",q$);const X$=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],SN=De("external-link",X$);const Y$=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Z$=De("eye-off",Y$);const Q$=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],J$=De("eye",Q$);const eK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tK=De("file-text",eK);const nK=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Xs=De("fish",nK);const iK=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],rK=De("image-plus",iK);const sK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],IN=De("info",sK);const oK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],mm=De("layers",oK);const aK=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],lK=De("loader-circle",aK);const cK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uK=De("locate-fixed",cK);const hK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],dK=De("lock",hK);const fK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],gK=De("log-out",fK);const pK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Al=De("map-pin",pK);const mK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],my=De("map",mK);const yK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],_K=De("menu",yK);const vK=[["path",{d:"M5 12h14",key:"1ays0h"}]],xK=De("minus",vK);const wK=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Dw=De("navigation",wK);const EK=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],TK=De("person-standing",EK);const SK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],IK=De("plus",SK);const CK=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],RK=De("refresh-cw",CK);const AK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],PK=De("rotate-ccw",AK);const bK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],kK=De("ruler",bK);const DK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],NK=De("save",DK);const MK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],LK=De("scale",MK);const OK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],CA=De("search",OK);const FK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],VK=De("settings",FK);const jK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],UK=De("ship",jK);const zK=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],BK=De("sparkles",zK);const GK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],v1=De("star",GK);const WK=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],$K=De("sun",WK);const KK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],HK=De("tag",KK);const qK=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],XK=De("thermometer",qK);const YK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ZK=De("trending-down",YK);const QK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],JK=De("trending-up",QK);const eH=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],tH=De("user",eH);const nH=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],x1=De("waves",nH);const iH=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],RA=De("wind",iH);const rH=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],la=De("x",rH);async function sH(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,y=oH(r,f,p);e(y);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function oH(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const y=i+2+p*12;if(n.getUint16(y,t)===34853){s=e+n.getUint32(y+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const y=s+2+p*12,E=n.getUint16(y,t),T=n.getUint16(y+2,t),I=n.getUint32(y+4,t),S=y+8;switch(E){case 1:l=String.fromCharCode(n.getUint8(S));break;case 2:u=AA(n,e+n.getUint32(S,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(S));break;case 4:f=AA(n,e+n.getUint32(S,t),3,t);break}}if(u&&f&&l&&h){const p=PA(u[0],u[1],u[2],l),y=PA(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(y))return{lat:p,lng:y}}return null}catch{return null}}function AA(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function PA(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const CN=200,aH=.7;async function lH(n,e=CN){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",aH)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function cH(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function RN(n){const e=await lH(n,CN),t=await cH(e);return{thumbnailBlob:e,thumbnailBase64:t}}function AN(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function uH(){const n=Qs(D=>D.map),e=ii(D=>D.openCatchForm),[t,i]=Z.useState(null),[r,s]=Z.useState(!1),[o,l]=Z.useState(!1),u=Z.useRef(null),h=Z.useRef(null);Z.useEffect(()=>{if(!n)return;const D=n.getViewport();if(!D)return;const L=600,F=15,B=k=>{if(k.touches.length!==1)return;const re=k.touches[0];h.current={x:re.clientX,y:re.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const pe=window.__olMap;if(!pe)return;const ge=D.getBoundingClientRect(),ue=[h.current.x-ge.left,h.current.y-ge.top],Q=pe.getCoordinateFromPixel(ue);if(Q){const oe=SI(Q);k.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:oe}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},L)},b=k=>{if(!u.current||!h.current)return;const re=k.touches[0],pe=re.clientX-h.current.x,ge=re.clientY-h.current.y;Math.sqrt(pe*pe+ge*ge)>F&&(clearTimeout(u.current),u.current=null)},R=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},M=k=>{r&&k.preventDefault()},V=k=>{k.button===0&&(h.current={x:k.clientX,y:k.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const re=window.__olMap;if(!re)return;const pe=D.getBoundingClientRect(),ge=[h.current.x-pe.left,h.current.y-pe.top],ue=re.getCoordinateFromPixel(ge);if(ue){const Q=SI(ue);i({pixel:[h.current.x,h.current.y],coordinate:Q}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},L))},j=k=>{if(!u.current||!h.current)return;const re=k.clientX-h.current.x,pe=k.clientY-h.current.y;Math.sqrt(re*re+pe*pe)>F&&(clearTimeout(u.current),u.current=null)},z=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return D.addEventListener("touchstart",B,{passive:!1}),D.addEventListener("touchmove",b,{passive:!0}),D.addEventListener("touchend",R),D.addEventListener("touchcancel",R),D.addEventListener("contextmenu",M),D.addEventListener("mousedown",V),D.addEventListener("mousemove",j),D.addEventListener("mouseup",z),D.addEventListener("mouseleave",z),()=>{D.removeEventListener("touchstart",B),D.removeEventListener("touchmove",b),D.removeEventListener("touchend",R),D.removeEventListener("touchcancel",R),D.removeEventListener("contextmenu",M),D.removeEventListener("mousedown",V),D.removeEventListener("mousemove",j),D.removeEventListener("mouseup",z),D.removeEventListener("mouseleave",z),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},p=()=>{s(!1),i(null),l(!1)},y=Z.useRef(null),E=()=>{if(!t)return;const[D,L]=t.coordinate;e({location:{lat:L,lng:D},locationSource:"map"}),p()},T=()=>{y.current?.click()},I=async D=>{const L=D.target.files?.[0];if(!(!L||!t)){try{const F=await sH(L),{thumbnailBase64:B}=await RN(L),b={id:AN(),thumbnailBase64:B,createdAt:new Date().toISOString(),pendingUpload:!0};if(F)e({location:F,locationSource:"photo",photos:[b]});else{const[R,M]=t.coordinate;e({location:{lat:M,lng:R},locationSource:"map",photos:[b]})}}catch(F){console.error("Failed to process photo:",F);const[B,b]=t.coordinate;e({location:{lat:b,lng:B},locationSource:"map"})}D.target.value="",p()}},S=()=>{if(!t)return;const[D,L]=t.coordinate,F=`https://www.google.com/maps?q=${L},${D}`;window.open(F,"_blank"),p()},P=()=>{if(!t)return;const[D,L]=t.coordinate,F=`https://www.google.com/maps?layer=c&cbll=${L},${D}`;window.open(F,"_blank"),p()},N=D=>{const[L,F]=D;return`${F.toFixed(5)}N, ${L.toFixed(5)}E`};return v.jsx(ls,{children:r&&t&&v.jsxs(v.Fragment,{children:[v.jsx(Je.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),v.jsxs(Je.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[v.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:v.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[v.jsx(Al,{size:16}),v.jsx("span",{className:"text-xs font-mono",children:N(t.coordinate)})]})}),v.jsxs("div",{className:"bg-white",children:[v.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[v.jsx(kw,{size:20,className:"text-green-500"}),v.jsx("span",{className:"font-medium",children:"Maak foto"})]}),v.jsxs("button",{onClick:E,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[v.jsx(Xs,{size:20,className:"text-orange-500"}),v.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),v.jsxs("button",{onClick:P,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[v.jsx(TK,{size:20,className:"text-yellow-600"}),v.jsx("span",{className:"font-medium",children:"Street View"})]}),v.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[v.jsx(SN,{size:20,className:"text-blue-600"}),v.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),v.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:I,className:"hidden"}),v.jsx("div",{className:"bg-white",children:v.jsxs("button",{onClick:p,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[v.jsx(la,{size:18}),v.jsx("span",{children:"Annuleren"})]})})]})]})})}function hH(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=Wi(),s=Z.useCallback(l=>{i(l)},[i]),o=Z.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return Z.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function dH(){const{tracking:n,toggle:e}=hH();return v.jsx(Je.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:v.jsx(uK,{size:22,strokeWidth:2})})}const fH="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function gH(){const n=Qs(y=>y.map),e=Wi(y=>y.position),t=Wi(y=>y.accuracy),i=Wi(y=>y.tracking),r=Wi(y=>y.smoothHeading),s=ln(y=>y.showAccuracyCircle),o=Wi(y=>y.firstFix),l=Wi(y=>y.resetFirstFix),u=Z.useRef(null),h=Z.useRef(null),f=Z.useRef(null),p=Z.useMemo(()=>y=>new Yi({image:new Ix({src:fH,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return Z.useEffect(()=>{if(!n||!i&&!e)return;const y=gl([5.1214,52.0907]);return u.current=new ou({geometry:new pl(y)}),u.current.setStyle(p(0)),h.current=new ou({geometry:new pl(y)}),f.current=new Nx({source:new Sx({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),Z.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=gl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const E=n.getView().getResolution()||1,T=Math.min(t/E,80);h.current.setStyle(new Yi({image:new kl({radius:T,fill:new Tr({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Yi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),Z.useEffect(()=>{if(!u.current)return;const y=r!==null?r*Math.PI/180:0;u.current.setStyle(p(y))},[r,p]),null}function pH(){const n=Qs(D=>D.map),[e,t]=Z.useState(!1),[i,r]=Z.useState(""),[s,o]=Z.useState([]),[l,u]=Z.useState(!1),[h,f]=Z.useState(!1),p=Z.useRef(null),y=Z.useRef(null),E=Z.useRef();Z.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),Z.useEffect(()=>{if(!e)return;const D=L=>{y.current&&!y.current.contains(L.target)&&T()};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[e]),Z.useEffect(()=>{if(!e)return;const D=L=>{L.key==="Escape"&&T()};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[e]),Z.useEffect(()=>{if(E.current&&clearTimeout(E.current),i.length<2){o([]);return}return E.current=window.setTimeout(async()=>{f(!0);try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();L.response?.docs&&o(L.response.docs)}catch(D){console.error("Search error:",D),o([])}finally{f(!1)}},300),()=>{E.current&&clearTimeout(E.current)}},[i]);const T=()=>{t(!1),r(""),o([]),u(!1)},I=async D=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(D)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const b=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(b)return{lng:parseFloat(b[1]),lat:parseFloat(b[2])}}}catch(L){console.error("Lookup error:",L)}return null},S=async D=>{if(!n)return;const L=await I(D.id);L&&n.getView().animate({center:gl([L.lng,L.lat]),zoom:16,duration:1e3}),T()},P=async(D,L)=>{L.stopPropagation();const F=await I(D.id);if(F){const B=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(B,"_blank")}T()},N={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?v.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:N,children:[v.jsxs(Je.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[v.jsx(CA,{size:18,className:"search-icon"}),v.jsx("input",{ref:p,type:"text",value:i,onChange:D=>{r(D.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),v.jsx("button",{onClick:T,className:"search-clear",title:"Sluiten",children:v.jsx(la,{size:18})})]}),v.jsx(ls,{children:l&&s.length>0&&v.jsx(Je.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(D=>v.jsxs("li",{className:"search-result-item",children:[v.jsx("div",{className:"search-result-content",onClick:()=>S(D),children:v.jsx("span",{className:"search-result-text",children:D.weergavenaam})}),v.jsx("button",{className:"search-navigate-btn",onClick:L=>P(D,L),title:"Open in Google Maps",children:v.jsx(SN,{size:20})})]},D.id))})}),l&&h&&v.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):v.jsx(Je.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:N,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:v.jsx(CA,{size:22,className:"text-gray-600"})})}function mH({size:n=18}){return v.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[v.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),v.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),v.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),v.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function yH(){const[n,e]=Z.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=ii(),{user:r,loading:s,signInWithGoogle:o,logout:l}=xN(),u=ln(S=>S.showCatchButton),h=ln(S=>S.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),y=()=>{p(),t()},E=()=>{p(),i()},T=()=>{p(),o()},I=()=>{p(),l()};return v.jsxs(v.Fragment,{children:[v.jsx(Je.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?v.jsx(la,{size:22,className:"text-white"}):v.jsx(_K,{size:22,className:"text-gray-600"})}),v.jsx(ls,{children:n&&v.jsxs(v.Fragment,{children:[v.jsx(Je.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),v.jsxs(Je.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[v.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:v.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?v.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:v.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?v.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:v.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?v.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:v.jsx(tH,{size:16,className:"text-white"})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),v.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),v.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:v.jsx(gK,{size:16})})]})}):v.jsxs("button",{onClick:T,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[v.jsx(mH,{size:18}),v.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),v.jsx("div",{className:"py-1",children:v.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[v.jsx(IN,{size:18,className:"text-blue-500"}),v.jsx("span",{children:"Info & handleiding"})]})}),v.jsx("div",{className:"py-1 border-t border-gray-100",children:v.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Xs,{size:18,className:"text-green-500"}),v.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),v.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:v.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),v.jsx("div",{className:"mt-auto border-t border-gray-100",children:v.jsxs("button",{onClick:E,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[v.jsx(VK,{size:18,className:"text-gray-500"}),v.jsx("span",{children:"Instellingen"})]})}),v.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function _H(){const{infoPanelOpen:n,toggleInfoPanel:e}=ii(),[t,i]=Z.useState("info"),r=[{id:"info",label:"Info",icon:v.jsx(IN,{size:14})},{id:"functies",label:"Functies",icon:v.jsx(tK,{size:14})},{id:"handleiding",label:"Handleiding",icon:v.jsx(D$,{size:14})}];return v.jsx(ls,{children:n&&v.jsxs(v.Fragment,{children:[v.jsx(Je.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),v.jsxs(Je.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[v.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[v.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),v.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:v.jsx(la,{size:18,className:"text-white",strokeWidth:2.5})})]}),v.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>v.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&v.jsx(vH,{}),t==="functies"&&v.jsx(xH,{}),t==="handleiding"&&v.jsx(wH,{}),v.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:v.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function vH(){return v.jsxs(v.Fragment,{children:[v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),v.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),v.jsxs("ul",{className:"space-y-2 text-gray-600",children:[v.jsxs("li",{children:[v.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",v.jsx("br",{}),v.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),v.jsxs("li",{children:[v.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",v.jsx("br",{}),v.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),v.jsxs("li",{children:[v.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",v.jsx("br",{}),v.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),v.jsxs("div",{className:"text-gray-600 space-y-2",children:[v.jsxs("p",{children:[v.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),v.jsxs("p",{children:[v.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function xH(){return v.jsxs(v.Fragment,{children:[v.jsxs("section",{children:[v.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[v.jsx(my,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),v.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[v.jsxs("li",{children:[v.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),v.jsxs("li",{children:[v.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),v.jsxs("li",{children:[v.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),v.jsxs("li",{children:[v.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),v.jsxs("li",{children:[v.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),v.jsxs("section",{children:[v.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[v.jsx(Xs,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),v.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[v.jsx("li",{children:"Registreer soort, gewicht en lengte"}),v.jsx("li",{children:"Vismethode en aas bijhouden"}),v.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),v.jsx("li",{children:"GPS locatie per vangst"})]})]}),v.jsxs("section",{children:[v.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[v.jsx(Al,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),v.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[v.jsx("li",{children:"Markeer je beste visplekken"}),v.jsx("li",{children:"Voeg notities en ratings toe"}),v.jsx("li",{children:"Welke vis zit waar?"})]})]}),v.jsxs("section",{children:[v.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[v.jsx(Wd,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),v.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[v.jsx("li",{children:"Live weergegevens op je locatie"}),v.jsx("li",{children:"Windsnelheid en richting"}),v.jsx("li",{children:"Luchtdruk"}),v.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),v.jsxs("section",{children:[v.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[v.jsx(Dw,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),v.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[v.jsx("li",{children:"Live GPS tracking"}),v.jsx("li",{children:"Zoek adressen en plaatsen"}),v.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function wH(){return v.jsxs(v.Fragment,{children:[v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),v.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[v.jsxs("li",{children:["Tik op de ",v.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),v.jsxs("li",{children:["Gebruik het ",v.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),v.jsxs("li",{children:["Tik op de ",v.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),v.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[v.jsxs("p",{children:[v.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),v.jsxs("p",{children:[v.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),v.jsxs("p",{children:[v.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),v.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[v.jsxs("p",{children:[v.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),v.jsxs("p",{children:[v.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),v.jsxs("p",{children:[v.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),v.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[v.jsxs("p",{children:[v.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),v.jsxs("p",{children:[v.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),v.jsxs("p",{children:[v.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),v.jsxs("section",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),v.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[v.jsxs("li",{children:["Gebruik de ",v.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),v.jsxs("li",{children:["Check de ",v.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),v.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),v.jsxs("li",{children:["Markeer succesvolle plekken als ",v.jsx("strong",{children:"favoriet"})]})]})]})]})}const EH=gl([5.1214,52.0907]),TH=8;function SH(){const n=Qs(r=>r.map),e=qo(r=>r.setLayerVisibility),t=Wi(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:EH,zoom:TH,rotation:0,duration:500})};return v.jsx(Je.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:v.jsx(PK,{size:18,className:"text-gray-600"})})}const IH={Map:my,Fish:Xs,Anchor:EN,Layers:mm,Star:v1},CH={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},RH={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function AH(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=WU(),[r,s]=Z.useState(!1),[o,l]=Z.useState(null),[u,h]=Z.useState(!1),[f,p]=Z.useState(""),y=I=>{e(I),s(!1)},E=(I,S)=>{I.stopPropagation();const{useLayerStore:P}=require("../../store"),N=P.getState().visible,D=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(L=>N[L]);t(S,{layers:D}),l(S),setTimeout(()=>l(null),2e3)},T=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return v.jsxs(v.Fragment,{children:[v.jsx(Je.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?v.jsx(TN,{size:20,className:"text-blue-600"}):v.jsx(mm,{size:20,className:"text-gray-600"})}),v.jsx(ls,{children:r&&v.jsxs(v.Fragment,{children:[v.jsx(Je.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),v.jsxs(Je.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[v.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:v.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),v.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const S=IH[I.icon]||mm,P=CH[I.icon]||"text-blue-600",N=RH[I.icon]||"hover:bg-blue-50",D=o===I.id;return v.jsxs("button",{onClick:()=>y(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${N} rounded text-left transition-colors border-0 outline-none bg-transparent ${D?"bg-green-50":""}`,children:[v.jsx(S,{size:16,className:`${P} flex-shrink-0`}),v.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),D?v.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:v.jsx(_1,{size:14,className:"text-green-500"})}):v.jsx("span",{onClick:L=>E(L,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:v.jsx(NK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),v.jsx("div",{className:"border-t border-gray-200 p-2",children:u?v.jsxs("div",{className:"flex gap-1",children:[v.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),onKeyDown:I=>{I.key==="Enter"&&T(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),v.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):v.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[v.jsx(IK,{size:14}),v.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const Q0={lat:52.1326,lng:5.2913},PH={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijpmist",51:"Lichte motregen",53:"Motregen",55:"Zware motregen",61:"Lichte regen",63:"Regen",65:"Zware regen",71:"Lichte sneeuw",73:"Sneeuw",75:"Zware sneeuw",80:"Lichte buien",81:"Buien",82:"Zware buien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer"};function PN({code:n,size:e=18}){return n===0?v.jsx($K,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?v.jsx(Wd,{size:e,className:"text-gray-400"}):n===45||n===48?v.jsx(z$,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?v.jsx($$,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?v.jsx(H$,{size:e,className:"text-cyan-500"}):n>=95?v.jsx(G$,{size:e,className:"text-purple-500"}):v.jsx(Wd,{size:e,className:"text-gray-400"})}function bH({degrees:n,size:e=14}){return v.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:v.jsx(Dw,{size:e,className:"text-blue-500"})})}function kH({size:n=16,className:e=""}){return v.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[v.jsx("path",{d:"M3 12h18"}),v.jsx("path",{d:"M21 12c-1.5 0-3-1-3-3s1.5-3 3-3"}),v.jsx("path",{d:"M21 12c-1.5 0-3 1-3 3s1.5 3 3 3"}),v.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),v.jsx("path",{d:"M8 12l2-3"}),v.jsx("path",{d:"M8 12l2 3"}),v.jsx("path",{d:"M12 12l2-3"}),v.jsx("path",{d:"M12 12l2 3"}),v.jsx("path",{d:"M16 12l1.5-2"}),v.jsx("path",{d:"M16 12l1.5 2"})]})}function bA({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return v.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[v.jsx("defs",{children:v.jsx("clipPath",{id:i,children:v.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),v.jsxs("g",{clipPath:`url(#${i})`,children:[v.jsx("path",{d:"M6.5 12c0-3.5 3-6 7-6 2.5 0 4.5 1 6 2.5.8.8 1.5 1.8 2 3-.5 1.2-1.2 2.2-2 3-1.5 1.5-3.5 2.5-6 2.5-4 0-7-2.5-7-5z"}),v.jsx("path",{d:"M2.5 12l3-3v6l-3-3z"}),v.jsx("circle",{cx:"17",cy:"11",r:"1",fill:"white"})]})]})}function DH({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1>=.5,s=[];for(let o=0;o<i&&o<e;o++)s.push(v.jsx(bA,{size:16,className:t},o));return r&&i<e&&s.push(v.jsx(bA,{size:16,className:t,clipPercent:50},"half")),v.jsx("div",{className:"flex items-center gap-0.5",children:s.length>0?s:v.jsx(kH,{size:16,className:t})})}function bN(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function NH(n){return n<.03||n>.97?"Nieuwe maan":n<.22?"Wassende sikkel":n<.28?"Eerste kwartier":n<.47?"Wassende maan":n<.53?"Volle maan":n<.72?"Afnemende maan":n<.78?"Laatste kwartier":"Afnemende sikkel"}function MH({phase:n,size:e=20}){const t=n<.5?(.5-n)*2:(n-.5)*2,i=n<.5;return v.jsxs("div",{className:"relative rounded-full overflow-hidden",style:{width:e,height:e,background:"linear-gradient(145deg, #f5f5dc 0%, #e8e4c9 50%, #d4d0b8 100%)",boxShadow:`inset 0 0 ${e*.1}px rgba(0,0,0,0.1), 0 ${e*.05}px ${e*.1}px rgba(0,0,0,0.2)`},children:[v.jsx("div",{className:"absolute inset-0 rounded-full opacity-30",style:{background:"radial-gradient(circle at 30% 30%, transparent 0%, rgba(139,119,101,0.3) 100%)"}}),v.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:i?`linear-gradient(to left, transparent ${(1-t)*100}%, rgba(20,20,30,0.95) ${(1-t)*100+15}%)`:`linear-gradient(to right, transparent ${(1-t)*100}%, rgba(20,20,30,0.95) ${(1-t)*100+15}%)`}})]})}function LH(n){const e=bN(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=(i+12)%24,l=[i,o],u=[r,s];let h=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(h+=.3),l.forEach(f=>{const p=Math.abs(t-f);p<=1||p>=23?h+=.3:(p<=2||p>=22)&&(h+=.15)}),u.forEach(f=>{Math.abs(t-f)<=1&&(h-=.1)}),{activity:Math.max(.1,Math.min(1,h)),besteTijden:l,slechteTijden:u}}function OH(n){return n<.1||n>.9||n>.4&&n<.6?{type:"Springtij",color:"text-green-600"}:n>.2&&n<.3||n>.7&&n<.8?{type:"Doodtij",color:"text-orange-600"}:{type:"Normaal",color:"text-blue-600"}}function FH(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),s=745;for(let o=0;o<e;o++){const l=new Date(n);l.setDate(l.getDate()+o),l.setHours(0,0,0,0);const h=(l.getTime()-r.getTime())/(1e3*60*60*24)%i/i;let f=h*s*2%1440;for(let p=0;p<4;p++){const y=p%2===0,E=p*(s/2);let T=f+E;const I=Math.floor(T/1440);T=T%1440;const S=Math.floor(T/60),P=Math.floor(T%60),N=new Date(l);N.setDate(N.getDate()+I),N.setHours(S,P,0,0);const D=Math.abs(Math.sin(h*Math.PI*2)),L=y?1.8:.4,F=D*.5;t.push({time:N,height:y?L+F:L-F*.5,type:y?"high":"low"})}}return t.sort((o,l)=>o.time.getTime()-l.time.getTime())}function VH({data:n}){if(!n||n.length===0)return null;const e=Math.max(...n.map(r=>r.precipitation),.5),t=n.some(r=>r.precipitation>0),i=r=>{const s=new Date(r);return`${s.getHours()}:${s.getMinutes().toString().padStart(2,"0")}`};return v.jsxs("div",{className:"space-y-1",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"}),!t&&v.jsx("span",{className:"text-[10px] text-green-600 font-medium",children:"Droog"})]}),v.jsxs("div",{className:"relative h-10 bg-gray-100 rounded-lg overflow-hidden",children:[v.jsx("div",{className:"absolute inset-0 flex",children:[...Array(8)].map((r,s)=>v.jsx("div",{className:"flex-1 border-r border-gray-200/50"},s))}),v.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((r,s)=>{const o=r.precipitation/e*100,l=r.precipitation>2?"bg-blue-600":r.precipitation>.5?"bg-blue-500":r.precipitation>0?"bg-blue-400":"bg-transparent";return v.jsx("div",{className:"flex-1 mx-px",title:`${i(r.time)}: ${r.precipitation.toFixed(1)} mm`,children:v.jsx("div",{className:`w-full rounded-t transition-all ${l}`,style:{height:`${Math.max(o,r.precipitation>0?8:0)}%`}})},s)})}),v.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[v.jsx("span",{children:"Nu"}),v.jsx("span",{children:"+1u"}),v.jsx("span",{children:"+2u"})]})]}),t&&v.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-500",children:[v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-400"}),v.jsx("span",{children:"Licht"})]}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-500"}),v.jsx("span",{children:"Matig"})]}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-600"}),v.jsx("span",{children:"Zwaar"})]})]})]})}function jH({hourly:n}){const e=new Date,t=e.getHours(),i=n.filter(r=>new Date(r.time)>=e).slice(0,8);return i.length===0?null:v.jsxs("div",{className:"space-y-1",children:[v.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),v.jsx("div",{className:"flex gap-1 overflow-x-auto py-1 -mx-1 px-1",children:i.map((r,s)=>{const o=new Date(r.time),l=o.getHours()===t;return v.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg min-w-[36px] ${l?"bg-blue-100":"bg-gray-50"}`,children:[v.jsx("span",{className:"text-[9px] text-gray-500",children:l?"Nu":`${o.getHours()}:00`}),v.jsx(PN,{code:r.weatherCode,size:14}),v.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(r.temperature),""]}),r.precipitationProbability>20&&v.jsxs("span",{className:"text-[8px] text-blue-500",children:[r.precipitationProbability,"%"]})]},r.time)})})]})}function UH(){const{current:n,loading:e,fetchWeather:t,getFishingScore:i,pressureHistory:r,getPressureTrend:s,hourlyForecast:o,precipitation15min:l}=Vb(),u=Wi(k=>k.position),h=ln(k=>k.showWeatherWidget),{waterData:f,station:p,fetchData:y}=w$(),[E,T]=Z.useState(!1),I={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};Z.useEffect(()=>{const k=u||Q0;t(k.lat,k.lng),y()},[]),Z.useEffect(()=>{u&&t(u.lat,u.lng)},[u,t]),Z.useEffect(()=>{const k=u||Q0,re=setInterval(()=>{t(k.lat,k.lng),y()},600*1e3);return()=>clearInterval(re)},[u,t,y]);const S=new Date,P=bN(S),N=LH(S),D=OH(P),F=Z.useMemo(()=>{const k=new Date;return k.setHours(0,0,0,0),FH(k,2)},[]).filter(k=>k.time>S).slice(0,4),B=i?i():1,b=Math.min(3,B/2+N.activity*1.5),R=k=>k>=2.5?"text-green-500":k>=1.5?"text-lime-500":k>=.8?"text-amber-500":"text-red-500",M=k=>k>=2.5?"bg-green-50 border-green-200":k>=1.5?"bg-lime-50 border-lime-200":k>=.8?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200",V=k=>k>=2.5?"Uitstekend":k>=1.5?"Goed":k>=.8?"Matig":"Slecht",j=k=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(k/45)%8],z=k=>k.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return h?v.jsx(Je.div,{className:`fixed left-2 z-[700] backdrop-blur-sm rounded-xl shadow-sm border transition-all ${M(b)}`,style:I,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e&&!n?v.jsxs("div",{className:"p-3 flex items-center gap-2",children:[v.jsx(RK,{size:16,className:"animate-spin text-blue-500"}),v.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):n?v.jsxs("div",{className:"p-2.5 min-w-[160px]",children:[v.jsxs("button",{onClick:()=>T(!E),className:"w-full border-0 outline-none bg-transparent p-0",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(PN,{code:n.weatherCode,size:24}),v.jsx("div",{className:"flex flex-col leading-tight",children:v.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(n.temperature),""]})})]}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx(RA,{size:14,className:"text-gray-400"}),v.jsx("span",{className:"text-sm text-gray-600",children:Math.round(n.windSpeed)}),v.jsx(bH,{degrees:n.windDirection,size:12})]}),v.jsx("div",{className:"ml-auto",children:E?v.jsx(TN,{size:16,className:"text-gray-400"}):v.jsx(V$,{size:16,className:"text-gray-400"})})]}),v.jsxs("div",{className:"flex items-center gap-2 mt-1.5 pt-1.5 border-t border-gray-200/50",children:[v.jsx(DH,{value:b,color:R(b)}),v.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full transition-all ${b>=2.5?"bg-green-500":b>=1.5?"bg-lime-500":b>=.8?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(b/3*100,5)}%`}})}),v.jsx("span",{className:`text-[10px] font-medium ${R(b)}`,children:V(b)})]})]}),v.jsx(ls,{children:E&&v.jsx(Je.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:v.jsxs("div",{className:"pt-3 mt-2 border-t border-gray-200/50 space-y-3",children:[v.jsx("div",{className:"text-xs text-gray-600",children:PH[n.weatherCode]||"Onbekend"}),v.jsxs("div",{className:"bg-slate-800 rounded-lg p-3 flex items-center gap-3",children:[v.jsx(MH,{phase:P,size:36}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"text-white text-sm font-medium",children:NH(P)}),v.jsxs("div",{className:"text-slate-400 text-[10px]",children:[Math.round(P*100),"% verlicht"]}),v.jsx("div",{className:`text-[10px] font-medium ${D.color}`,children:D.type})]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[v.jsx("span",{className:"text-gray-500",children:"Maanactiviteit"}),v.jsxs("span",{className:"text-gray-600",children:[Math.round(N.activity*100),"%"]})]}),v.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full transition-all ${N.activity>=.7?"bg-green-500":N.activity>=.5?"bg-lime-500":N.activity>=.3?"bg-amber-500":"bg-red-400"}`,style:{width:`${N.activity*100}%`}})})]}),f&&v.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.temperature!==void 0&&v.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[v.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[v.jsx(XK,{size:12,className:"text-cyan-500"}),v.jsx("span",{children:"Water"})]}),v.jsxs("div",{className:"text-sm font-bold text-cyan-600",children:[f.temperature.toFixed(1),"C"]})]}),f.waveHeight!==void 0&&v.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[v.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[v.jsx(x1,{size:12,className:"text-blue-500"}),v.jsx("span",{children:"Golven"})]}),v.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[f.waveHeight," cm"]})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[v.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[v.jsx(RA,{size:12,className:"text-gray-400"}),v.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",j(n.windDirection)]})]}),v.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[v.jsx(L$,{size:12,className:"text-gray-400"}),v.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const k=s();return k==="rising"?v.jsx(JK,{size:12,className:"text-green-500"}):k==="falling"?v.jsx(ZK,{size:12,className:"text-red-500"}):v.jsx(xK,{size:12,className:"text-gray-400"})})()]})]}),l.length>0&&v.jsx(VH,{data:l}),o.length>0&&v.jsx(jH,{hourly:o}),F.length>0&&v.jsxs("div",{className:"space-y-1",children:[v.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[v.jsx(x1,{size:12}),v.jsx("span",{children:"Volgende getijden"})]}),v.jsx("div",{className:"flex gap-1",children:F.map((k,re)=>v.jsxs("div",{className:`flex-1 p-1.5 rounded text-center ${k.type==="high"?"bg-green-50":"bg-red-50"}`,children:[v.jsx("div",{className:`text-[9px] font-medium ${k.type==="high"?"text-green-600":"text-red-600"}`,children:k.type==="high"?"HW":"LW"}),v.jsx("div",{className:"text-[10px] font-medium",children:z(k.time)})]},re))})]}),p&&v.jsxs("div",{className:"text-[9px] text-gray-400 text-center",children:["Waterdata: ",p.name]})]})})})]}):v.jsxs("button",{onClick:()=>{const k=u||Q0;t(k.lat,k.lng)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[v.jsx(Wd,{size:18,className:"text-gray-400"}),v.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]})}):null}const ym=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],zH=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],BH=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],J0=5;function GH({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=Z.useRef(null),s=Z.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=J0-n.length,p=Array.from(h).slice(0,f);for(const y of p)try{const{thumbnailBase64:E}=await RN(y),T={id:AN(),thumbnailBase64:E,createdAt:new Date().toISOString(),pendingUpload:!0};e(T)}catch(E){console.error("Failed to process image:",E)}u.target.value=""},l=n.length<J0;return v.jsxs("div",{className:"space-y-2",children:[v.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",J0,")"]}),v.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>v.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[v.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&v.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:v.jsx(la,{size:12,className:"text-white"})}),u.pendingUpload&&v.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&v.jsxs(v.Fragment,{children:[v.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[v.jsx(kw,{size:20,className:"text-gray-400"}),v.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),v.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[v.jsx(rK,{size:20,className:"text-gray-400"}),v.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),v.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),v.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const WH={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function $H(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,p=0,y=0,E=0,T=0,I=0;const S=h.length/4;for(let L=0;L<h.length;L+=4){const F=h[L],B=h[L+1],b=h[L+2];f+=F,p+=B,B>F&&B>b&&y++,F>100&&B>80&&B<150&&b<100&&E++,F>150&&B>150&&b>150&&T++,F<80&&B<80&&b<80&&I++}const P=[];y/S>.2&&P.push("green"),E/S>.2&&P.push("brown"),T/S>.2&&P.push("silver"),I/S>.3&&P.push("dark");const N=f/S,D=p/S;N>150&&D>100&&D<180&&P.push("gold"),e(P)},t.src=n})}function KH(n){const e=[];for(const[t,i]of Object.entries(WH)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function HH(n){try{const e=await $H(n),t=KH(e);if(t.length===0)return{species:"",confidence:0,suggestions:ym.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:ym.slice(0,5).map(t=>t.name)}}}function qH(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function XH({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=Fb(ie=>ie.addCatch),s=Vb(ie=>ie.current),o=Wi(ie=>ie.position),[l,u]=Z.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=Z.useState(t||(o?"gps":null)),[p,y]=Z.useState(""),[E,T]=Z.useState(""),[I,S]=Z.useState(""),[P,N]=Z.useState(""),[D,L]=Z.useState(""),[F,B]=Z.useState(""),[b,R]=Z.useState(i),[M,V]=Z.useState(!1),[j,z]=Z.useState([]),[k,re]=Z.useState(0),pe=async ie=>{if(R(me=>[...me,ie]),ie.dataUrl&&!p){V(!0);try{const me=await HH(ie.dataUrl);if(z(me.suggestions),re(me.confidence),me.species&&me.confidence>.4){y(me.species);const xe=qH(me.species)}}catch(me){console.error("AI recognition failed:",me)}finally{V(!1)}}},ge=ie=>{y(ie),z([])},ue=ie=>{R(me=>me.filter(xe=>xe.id!==ie))},Q=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},oe=ie=>{if(ie.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:E?parseInt(E):void 0,length:I?parseInt(I):void 0,photos:b.length>0?b:void 0,method:P||"Anders",bait:D||void 0,notes:F||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},W=(()=>{switch(h){case"gps":return{icon:Dw,label:"GPS",color:"text-blue-500"};case"photo":return{icon:kw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:my,label:"Kaart",color:"text-orange-500"};default:return{icon:Al,label:"Locatie",color:"text-gray-500"}}})(),$=W.icon;return v.jsx(Je.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:v.jsxs(Je.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ie=>ie.stopPropagation(),children:[v.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Xs,{className:"text-white",size:24}),v.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),v.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:v.jsx(la,{size:20})})]}),v.jsxs("form",{onSubmit:oe,className:"p-4 space-y-4",children:[v.jsx("div",{className:"space-y-2",children:l?v.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx($,{size:16,className:W.color}),v.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),v.jsx("span",{className:`text-xs ${W.color} font-medium`,children:W.label})]}):v.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Al,{size:16}),v.jsx("span",{children:"Geen locatie"})]}),o&&v.jsx("button",{type:"button",onClick:Q,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",M&&v.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[v.jsx(lK,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),v.jsx(ls,{children:j.length>0&&!p&&v.jsxs(Je.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[v.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[v.jsx(BK,{size:12}),v.jsxs("span",{children:["AI suggesties ",k>.3?`(${Math.round(k*100)}% zeker)`:""]})]}),v.jsx("div",{className:"flex flex-wrap gap-1",children:j.map(ie=>v.jsx("button",{type:"button",onClick:()=>ge(ie),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:ie},ie))})]})}),v.jsxs("select",{value:p,onChange:ie=>{y(ie.target.value),z([])},className:"form-select",required:!0,children:[v.jsx("option",{value:"",children:"Selecteer vissoort..."}),ym.map(ie=>v.jsx("option",{value:ie.name,children:ie.name},ie.name))]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[v.jsx(LK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),v.jsx("input",{type:"number",value:E,onChange:ie=>T(ie.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[v.jsx(kK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),v.jsx("input",{type:"number",value:I,onChange:ie=>S(ie.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),v.jsxs("select",{value:P,onChange:ie=>N(ie.target.value),className:"form-select",children:[v.jsx("option",{value:"",children:"Selecteer methode..."}),zH.map(ie=>v.jsx("option",{value:ie,children:ie},ie))]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),v.jsxs("select",{value:D,onChange:ie=>L(ie.target.value),className:"form-select",children:[v.jsx("option",{value:"",children:"Selecteer aas..."}),BH.map(ie=>v.jsx("option",{value:ie,children:ie},ie))]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),v.jsx("textarea",{value:F,onChange:ie=>B(ie.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),v.jsx(GH,{photos:b,onAddPhoto:pe,onRemovePhoto:ue}),v.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function YH(){const n=ii(h=>h.catchFormOpen),e=ii(h=>h.catchFormLocation),t=ii(h=>h.catchFormLocationSource),i=ii(h=>h.catchFormInitialPhotos),r=ii(h=>h.openCatchForm),s=ii(h=>h.closeCatchForm),o=Wi(h=>h.position),l=ln(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return v.jsxs(v.Fragment,{children:[l&&v.jsx(Je.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:v.jsx(Xs,{size:22,strokeWidth:2})}),v.jsx(ls,{children:n&&v.jsx(XH,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function ZH(){const n=Qs(r=>r.map),e=Fb(r=>r.catches),t=Z.useRef(null),i=Z.useRef(null);return Z.useEffect(()=>{if(n)return i.current=new Sx,t.current=new Nx({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),Z.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new ou({geometry:new pl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Yi({image:new kl({radius:14,fill:new Tr({color:"#22c55e"}),stroke:new bu({color:"#fff",width:2})}),text:new tf({text:l,font:"bold 12px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function QH(){const n=Qs(r=>r.map),e=jb(r=>r.spots),t=Z.useRef(null),i=Z.useRef(null);return Z.useEffect(()=>{if(n)return i.current=new Sx,t.current=new Nx({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),Z.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new ou({geometry:new pl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Yi({image:new kl({radius:12,fill:new Tr({color:l}),stroke:new bu({color:"#fff",width:2})}),text:new tf({text:"",font:"bold 14px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function JH({onClose:n,initialLocation:e}){const t=jb(S=>S.addSpot),[i,r]=Z.useState(""),[s,o]=Z.useState(""),[l,u]=Z.useState([]),[h,f]=Z.useState(""),[p,y]=Z.useState(3),E=e,T=S=>{u(P=>P.includes(S)?P.filter(N=>N!==S):[...P,S])},I=S=>{if(S.preventDefault(),!i||!E){alert("Geef een naam op voor deze locatie");return}t({name:i,location:E,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return v.jsx(Je.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:v.jsxs(Je.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:S=>S.stopPropagation(),children:[v.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(v1,{className:"text-white",size:24}),v.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),v.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:v.jsx(la,{size:20})})]}),v.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[E&&v.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[v.jsx(Al,{size:16}),v.jsxs("span",{children:[E.lat.toFixed(5),", ",E.lng.toFixed(5)]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),v.jsx("input",{type:"text",value:i,onChange:S=>r(S.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),v.jsx("input",{type:"text",value:s,onChange:S=>o(S.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),v.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(S=>v.jsx("button",{type:"button",onClick:()=>y(S),className:"p-1 border-0 outline-none bg-transparent",children:v.jsx(v1,{size:28,className:S<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},S))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),v.jsx("div",{className:"flex flex-wrap gap-2",children:ym.slice(0,12).map(S=>v.jsx("button",{type:"button",onClick:()=>T(S.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(S.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.name))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),v.jsx("textarea",{value:h,onChange:S=>f(S.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),v.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const eq=[{name:"Aanlegsteigers",icon:EN,color:"#2196F3"},{name:"Boothellingen",icon:UK,color:"#4CAF50"},{name:"Dieptekaart",icon:x1,color:"#00BCD4"},{name:"Viswater",icon:Al,color:"#9C27B0"}],kA=[{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function tq(){const[n,e]=Z.useState(!1),t=qo(l=>l.visible),i=qo(l=>l.toggleLayer),r=qo(l=>l.setLayerVisibility),s=l=>{kA.forEach(u=>{r(u.name,u.name===l)}),l==="Luchtfoto"?r("Labels Overlay",!0):r("Labels Overlay",!1)},o=()=>{r("Labels Overlay",!t["Labels Overlay"])};return v.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[v.jsx(Je.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:v.jsx(mm,{size:22})}),v.jsx(ls,{children:n&&v.jsxs(v.Fragment,{children:[v.jsx(Je.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),v.jsxs(Je.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg overflow-hidden min-w-[200px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},children:[v.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:v.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})}),v.jsxs("div",{className:"p-2",children:[v.jsxs("div",{className:"mb-2 pb-2 border-b border-gray-100",children:[v.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Achtergrond"}),v.jsx("div",{className:"flex gap-1",children:kA.map(l=>v.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[l.name]?"bg-blue-500 text-white":"bg-transparent text-gray-600 hover:bg-blue-50"}`,onClick:()=>s(l.name),children:l.label},l.name))}),t.Luchtfoto&&v.jsxs("button",{onClick:o,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[v.jsxs("span",{className:"flex items-center gap-1.5",children:[v.jsx(HK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&v.jsx(_1,{size:12})]})]}),v.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Kaartlagen"}),v.jsx("div",{className:"space-y-0.5",children:eq.map(l=>{const u=l.icon,h=t[l.name];return v.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors border-0 outline-none ${h?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>i(l.name),children:[v.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center transition-colors",style:{backgroundColor:h?l.color:"#e5e7eb"},children:v.jsx(u,{size:14,className:"text-white"})}),v.jsx("span",{className:`text-sm ${h?"text-blue-700":"text-gray-600"}`,children:l.name}),v.jsx("div",{className:"ml-auto",children:v.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center transition-all",style:{backgroundColor:h?"#3b82f6":"transparent",border:h?"2px solid #3b82f6":"2px solid #93c5fd"},children:h&&v.jsx(_1,{size:10,className:"text-white",strokeWidth:3})})})]},l.name)})})]})]})]})})]})}function nq(){const n=ii(y=>y.settingsPanelOpen),e=ii(y=>y.toggleSettingsPanel),t=ln(y=>y.showCatchButton),i=ln(y=>y.setShowCatchButton),r=ln(y=>y.showCatches),s=ln(y=>y.setShowCatches),o=ln(y=>y.showFavoriteSpots),l=ln(y=>y.setShowFavoriteSpots),u=ln(y=>y.defaultBackground),h=ln(y=>y.setDefaultBackground),f=ln(y=>y.showWeatherWidget),p=ln(y=>y.setShowWeatherWidget);return n?v.jsx(Je.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:v.jsxs(Je.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:y=>y.stopPropagation(),children:[v.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[v.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),v.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:v.jsx(la,{size:20,className:"text-white"})})]}),v.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[v.jsxs("div",{className:"space-y-3",children:[v.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),v.jsx(ep,{icon:v.jsx(Xs,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),v.jsx(ep,{icon:v.jsx(Xs,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),v.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[v.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),v.jsx(ep,{icon:v.jsx(Al,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),v.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[v.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:v.jsx(my,{size:18,className:"text-gray-500"})}),v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),v.jsxs("select",{value:u,onChange:y=>h(y.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[v.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),v.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),v.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[v.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer & Water"}),v.jsx(ep,{icon:v.jsx(Wd,{size:18,className:"text-blue-400"}),label:"Vis-weer widget",description:"Weer, getijden, waterdata, maanstand",checked:f,onChange:p})]})]}),v.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function ep({icon:n,label:e,description:t,checked:i,onChange:r}){return v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),v.jsx("p",{className:"text-xs text-gray-400",children:t})]}),v.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:v.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function iq({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=xN(),[l,u]=Z.useState(""),[h,f]=Z.useState(!1),[p,y]=Z.useState(!1),[E,T]=Z.useState(null);if(Z.useEffect(()=>{o()},[o]),s)return v.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:v.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return v.jsx(v.Fragment,{children:n});const I=P=>{P.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},S=async()=>{try{T(null),await i()}catch{T("Google login mislukt"),setTimeout(()=>T(null),3e3)}};return v.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:v.jsxs(Je.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[v.jsxs("div",{className:"flex flex-col items-center mb-6",children:[v.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:v.jsx(Xs,{size:40,className:"text-white"})}),v.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),v.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),v.jsxs(Je.button,{onClick:S,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[v.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[v.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),v.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),v.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),v.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),E&&v.jsx(Je.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:E}),v.jsxs("div",{className:"flex items-center gap-3 my-4",children:[v.jsx("div",{className:"flex-1 h-px bg-gray-200"}),v.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),v.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),v.jsxs("form",{onSubmit:I,className:"space-y-4",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(dK,{size:20})}),v.jsx("input",{type:p?"text":"password",value:l,onChange:P=>u(P.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),v.jsx("button",{type:"button",onClick:()=>y(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?v.jsx(Z$,{size:20}):v.jsx(J$,{size:20})})]}),h&&v.jsx(Je.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),v.jsx(Je.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),v.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function rq(){const n=ii(i=>i.spotFormOpen),e=ii(i=>i.spotFormLocation),t=ii(i=>i.closeSpotForm);return v.jsx(iq,{children:v.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[v.jsx(S$,{}),v.jsx(gH,{}),v.jsx(ZH,{}),v.jsx(QH,{}),v.jsx(uH,{}),v.jsx(UH,{}),v.jsx(pH,{}),v.jsx(yH,{}),v.jsx(AH,{}),v.jsx(SH,{}),v.jsx(tq,{}),v.jsx(YH,{}),v.jsx(dH,{}),v.jsx(_H,{}),v.jsx(nq,{}),v.jsx(ls,{children:n&&v.jsx(JH,{onClose:t,initialLocation:e||void 0})})]})})}const sq="1.2.13";console.log(`%c VisApp v${sq}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");KM.createRoot(document.getElementById("root")).render(v.jsx(rq,{}));export{_q as $,DP as A,Rt as B,kl as C,nt as D,Be as E,Tr as F,w3 as G,Rm as H,A5 as I,fl as J,PP as K,kP as L,dq as M,Np as N,A3 as O,gq as P,NP as Q,Hc as R,Yi as S,I6 as T,pl as U,Sx as V,uP as W,cq as X,uq as Y,fq as Z,vq as _,Nx as a,AI as a0,_4 as a1,v4 as a2,yq as a3,mq as a4,Cd as a5,pq as a6,hq as a7,dr as a8,ou as a9,tt as aa,rp as ab,Dp as ac,XP as ad,Av as ae,su as af,E3 as ag,bu as b,Bn as c,wq as d,Zi as e,ai as f,dt as g,dC as h,rx as i,r6 as j,C0 as k,fx as l,ol as m,ix as n,cP as o,AP as p,bP as q,lq as r,C3 as s,Mm as t,bI as u,$c as v,PI as w,R3 as x,mx as y,px as z};
//# sourceMappingURL=index-BId_6pJ6.js.map
