const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-CSSkNolW.js","assets/GeoJSON-CnCa2d4C.js","assets/boothellingenOL-DQg9BW59.js","assets/viswaterOL-IF77fQlh.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Px(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var X_={exports:{}},Ch={},q_={exports:{}},$e={};var QT;function eL(){if(QT)return $e;QT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function y(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,I={};function S(G,$,ie){this.props=G,this.context=$,this.refs=I,this.updater=ie||x}S.prototype.isReactComponent={},S.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},S.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function b(){}b.prototype=S.prototype;function N(G,$,ie){this.props=G,this.context=$,this.refs=I,this.updater=ie||x}var M=N.prototype=new b;M.constructor=N,T(M,S.prototype),M.isPureReactComponent=!0;var R=Array.isArray,D=Object.prototype.hasOwnProperty,j={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function A(G,$,ie){var pe,xe={},ke=null,Le=null;if($!=null)for(pe in $.ref!==void 0&&(Le=$.ref),$.key!==void 0&&(ke=""+$.key),$)D.call($,pe)&&!k.hasOwnProperty(pe)&&(xe[pe]=$[pe]);var je=arguments.length-2;if(je===1)xe.children=ie;else if(1<je){for(var Ge=Array(je),ct=0;ct<je;ct++)Ge[ct]=arguments[ct+2];xe.children=Ge}if(G&&G.defaultProps)for(pe in je=G.defaultProps,je)xe[pe]===void 0&&(xe[pe]=je[pe]);return{$$typeof:n,type:G,key:ke,ref:Le,props:xe,_owner:j.current}}function L(G,$){return{$$typeof:n,type:G.type,key:$,ref:G.ref,props:G.props,_owner:G._owner}}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function z(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ie){return $[ie]})}var B=/\/+/g;function O(G,$){return typeof G=="object"&&G!==null&&G.key!=null?z(""+G.key):$.toString(36)}function le(G,$,ie,pe,xe){var ke=typeof G;(ke==="undefined"||ke==="boolean")&&(G=null);var Le=!1;if(G===null)Le=!0;else switch(ke){case"string":case"number":Le=!0;break;case"object":switch(G.$$typeof){case n:case e:Le=!0}}if(Le)return Le=G,xe=xe(Le),G=pe===""?"."+O(Le,0):pe,R(xe)?(ie="",G!=null&&(ie=G.replace(B,"$&/")+"/"),le(xe,$,ie,"",function(ct){return ct})):xe!=null&&(V(xe)&&(xe=L(xe,ie+(!xe.key||Le&&Le.key===xe.key?"":(""+xe.key).replace(B,"$&/")+"/")+G)),$.push(xe)),1;if(Le=0,pe=pe===""?".":pe+":",R(G))for(var je=0;je<G.length;je++){ke=G[je];var Ge=pe+O(ke,je);Le+=le(ke,$,ie,Ge,xe)}else if(Ge=y(G),typeof Ge=="function")for(G=Ge.call(G),je=0;!(ke=G.next()).done;)ke=ke.value,Ge=pe+O(ke,je++),Le+=le(ke,$,ie,Ge,xe);else if(ke==="object")throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Le}function me(G,$,ie){if(G==null)return G;var pe=[],xe=0;return le(G,pe,"","",function(ke){return $.call(ie,ke,xe++)}),pe}function ge(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(ie){(G._status===0||G._status===-1)&&(G._status=1,G._result=ie)},function(ie){(G._status===0||G._status===-1)&&(G._status=2,G._result=ie)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var ue={current:null},Q={transition:null},se={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Q,ReactCurrentOwner:j};function ne(){throw Error("act(...) is not supported in production builds of React.")}return $e.Children={map:me,forEach:function(G,$,ie){me(G,function(){$.apply(this,arguments)},ie)},count:function(G){var $=0;return me(G,function(){$++}),$},toArray:function(G){return me(G,function($){return $})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},$e.Component=S,$e.Fragment=t,$e.Profiler=r,$e.PureComponent=N,$e.StrictMode=i,$e.Suspense=u,$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,$e.act=ne,$e.cloneElement=function(G,$,ie){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var pe=T({},G.props),xe=G.key,ke=G.ref,Le=G._owner;if($!=null){if($.ref!==void 0&&(ke=$.ref,Le=j.current),$.key!==void 0&&(xe=""+$.key),G.type&&G.type.defaultProps)var je=G.type.defaultProps;for(Ge in $)D.call($,Ge)&&!k.hasOwnProperty(Ge)&&(pe[Ge]=$[Ge]===void 0&&je!==void 0?je[Ge]:$[Ge])}var Ge=arguments.length-2;if(Ge===1)pe.children=ie;else if(1<Ge){je=Array(Ge);for(var ct=0;ct<Ge;ct++)je[ct]=arguments[ct+2];pe.children=je}return{$$typeof:n,type:G.type,key:xe,ref:ke,props:pe,_owner:Le}},$e.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:s,_context:G},G.Consumer=G},$e.createElement=A,$e.createFactory=function(G){var $=A.bind(null,G);return $.type=G,$},$e.createRef=function(){return{current:null}},$e.forwardRef=function(G){return{$$typeof:l,render:G}},$e.isValidElement=V,$e.lazy=function(G){return{$$typeof:f,_payload:{_status:-1,_result:G},_init:ge}},$e.memo=function(G,$){return{$$typeof:h,type:G,compare:$===void 0?null:$}},$e.startTransition=function(G){var $=Q.transition;Q.transition={};try{G()}finally{Q.transition=$}},$e.unstable_act=ne,$e.useCallback=function(G,$){return ue.current.useCallback(G,$)},$e.useContext=function(G){return ue.current.useContext(G)},$e.useDebugValue=function(){},$e.useDeferredValue=function(G){return ue.current.useDeferredValue(G)},$e.useEffect=function(G,$){return ue.current.useEffect(G,$)},$e.useId=function(){return ue.current.useId()},$e.useImperativeHandle=function(G,$,ie){return ue.current.useImperativeHandle(G,$,ie)},$e.useInsertionEffect=function(G,$){return ue.current.useInsertionEffect(G,$)},$e.useLayoutEffect=function(G,$){return ue.current.useLayoutEffect(G,$)},$e.useMemo=function(G,$){return ue.current.useMemo(G,$)},$e.useReducer=function(G,$,ie){return ue.current.useReducer(G,$,ie)},$e.useRef=function(G){return ue.current.useRef(G)},$e.useState=function(G){return ue.current.useState(G)},$e.useSyncExternalStore=function(G,$,ie){return ue.current.useSyncExternalStore(G,$,ie)},$e.useTransition=function(){return ue.current.useTransition()},$e.version="18.3.1",$e}var JT;function Jd(){return JT||(JT=1,q_.exports=eL()),q_.exports}var eS;function tL(){if(eS)return Ch;eS=1;var n=Jd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,m={},y=null,x=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(m[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)m[f]===void 0&&(m[f]=u[f]);return{$$typeof:e,type:l,key:y,ref:x,props:m,_owner:r.current}}return Ch.Fragment=t,Ch.jsx=o,Ch.jsxs=o,Ch}var tS;function nL(){return tS||(tS=1,X_.exports=tL()),X_.exports}var _=nL(),Dg={},Y_={exports:{}},Jn={},Z_={exports:{}},Q_={};var nS;function iL(){return nS||(nS=1,(function(n){function e(Q,se){var ne=Q.length;Q.push(se);e:for(;0<ne;){var G=ne-1>>>1,$=Q[G];if(0<r($,se))Q[G]=se,Q[ne]=$,ne=G;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var se=Q[0],ne=Q.pop();if(ne!==se){Q[0]=ne;e:for(var G=0,$=Q.length,ie=$>>>1;G<ie;){var pe=2*(G+1)-1,xe=Q[pe],ke=pe+1,Le=Q[ke];if(0>r(xe,ne))ke<$&&0>r(Le,xe)?(Q[G]=Le,Q[ke]=ne,G=ke):(Q[G]=xe,Q[pe]=ne,G=pe);else if(ke<$&&0>r(Le,ne))Q[G]=Le,Q[ke]=ne,G=ke;else break e}}return se}function r(Q,se){var ne=Q.sortIndex-se.sortIndex;return ne!==0?ne:Q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,m=null,y=3,x=!1,T=!1,I=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(Q){for(var se=t(h);se!==null;){if(se.callback===null)i(h);else if(se.startTime<=Q)i(h),se.sortIndex=se.expirationTime,e(u,se);else break;se=t(h)}}function R(Q){if(I=!1,M(Q),!T)if(t(u)!==null)T=!0,ge(D);else{var se=t(h);se!==null&&ue(R,se.startTime-Q)}}function D(Q,se){T=!1,I&&(I=!1,b(A),A=-1),x=!0;var ne=y;try{for(M(se),m=t(u);m!==null&&(!(m.expirationTime>se)||Q&&!z());){var G=m.callback;if(typeof G=="function"){m.callback=null,y=m.priorityLevel;var $=G(m.expirationTime<=se);se=n.unstable_now(),typeof $=="function"?m.callback=$:m===t(u)&&i(u),M(se)}else i(u);m=t(u)}if(m!==null)var ie=!0;else{var pe=t(h);pe!==null&&ue(R,pe.startTime-se),ie=!1}return ie}finally{m=null,y=ne,x=!1}}var j=!1,k=null,A=-1,L=5,V=-1;function z(){return!(n.unstable_now()-V<L)}function B(){if(k!==null){var Q=n.unstable_now();V=Q;var se=!0;try{se=k(!0,Q)}finally{se?O():(j=!1,k=null)}}else j=!1}var O;if(typeof N=="function")O=function(){N(B)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,me=le.port2;le.port1.onmessage=B,O=function(){me.postMessage(null)}}else O=function(){S(B,0)};function ge(Q){k=Q,j||(j=!0,O())}function ue(Q,se){A=S(function(){Q(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){T||x||(T=!0,ge(D))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var ne=y;y=se;try{return Q()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,se){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ne=y;y=Q;try{return se()}finally{y=ne}},n.unstable_scheduleCallback=function(Q,se,ne){var G=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?G+ne:G):ne=G,Q){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,Q={id:f++,callback:se,priorityLevel:Q,startTime:ne,expirationTime:$,sortIndex:-1},ne>G?(Q.sortIndex=ne,e(h,Q),t(u)===null&&Q===t(h)&&(I?(b(A),A=-1):I=!0,ue(R,ne-G))):(Q.sortIndex=$,e(u,Q),T||x||(T=!0,ge(D))),Q},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(Q){var se=y;return function(){var ne=y;y=se;try{return Q.apply(this,arguments)}finally{y=ne}}}})(Q_)),Q_}var iS;function rL(){return iS||(iS=1,Z_.exports=iL()),Z_.exports}var rS;function sL(){if(rS)return Jn;rS=1;var n=Jd(),e=rL();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function y(a){return u.call(m,a)?!0:u.call(f,a)?!1:h.test(a)?m[a]=!0:(f[a]=!0,!1)}function x(a,c,d,p){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return p?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function T(a,c,d,p){if(c===null||typeof c>"u"||x(a,c,d,p))return!0;if(p)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,p,v,w,P){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=p,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=P}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){S[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];S[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){S[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){S[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){S[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){S[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){S[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){S[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){S[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function N(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(b,N);S[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(b,N);S[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(b,N);S[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){S[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),S.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){S[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function M(a,c,d,p){var v=S.hasOwnProperty(c)?S[c]:null;(v!==null?v.type!==0:p||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(T(c,d,v,p)&&(d=null),p||v===null?y(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(c=v.attributeName,p=v.attributeNamespace,d===null?a.removeAttribute(c):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,p?a.setAttributeNS(p,c,d):a.setAttribute(c,d))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),j=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),z=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Q=Symbol.iterator;function se(a){return a===null||typeof a!="object"?null:(a=Q&&a[Q]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,G;function $(a){if(G===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);G=c&&c[1]||""}return`
`+G+a}var ie=!1;function pe(a,c){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var p=J}Reflect.construct(a,[],c)}else{try{c.call()}catch(J){p=J}a.call(c.prototype)}else{try{throw Error()}catch(J){p=J}a()}}catch(J){if(J&&p&&typeof J.stack=="string"){for(var v=J.stack.split(`
`),w=p.stack.split(`
`),P=v.length-1,U=w.length-1;1<=P&&0<=U&&v[P]!==w[U];)U--;for(;1<=P&&0<=U;P--,U--)if(v[P]!==w[U]){if(P!==1||U!==1)do if(P--,U--,0>U||v[P]!==w[U]){var W=`
`+v[P].replace(" at new "," at ");return a.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",a.displayName)),W}while(1<=P&&0<=U);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function xe(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=pe(a.type,!1),a;case 11:return a=pe(a.type.render,!1),a;case 1:return a=pe(a.type,!0),a;default:return""}}function ke(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case k:return"Fragment";case j:return"Portal";case L:return"Profiler";case A:return"StrictMode";case O:return"Suspense";case le:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case z:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case B:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case me:return c=a.displayName||null,c!==null?c:ke(a.type)||"Memo";case ge:c=a._payload,a=a._init;try{return ke(a(c))}catch{}}return null}function Le(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(c);case 8:return c===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function je(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ge(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ct(a){var c=Ge(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),p=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return v.call(this)},set:function(P){p=""+P,w.call(this,P)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(P){p=""+P},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function er(a){a._valueTracker||(a._valueTracker=ct(a))}function fs(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),p="";return a&&(p=Ge(a)?a.checked?"true":"false":a.value),a=p,a!==d?(c.setValue(a),!0):!1}function $n(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Kn(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,p=c.checked!=null?c.checked:c.defaultChecked;d=je(c.value!=null?c.value:d),a._wrapperState={initialChecked:p,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&M(a,"checked",c,!1)}function Hn(a,c){dn(a,c);var d=je(c.value),p=c.type;if(d!=null)p==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(p==="submit"||p==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?_t(a,c.type,d):c.hasOwnProperty("defaultValue")&&_t(a,c.type,je(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Pi(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var p=c.type;if(!(p!=="submit"&&p!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function _t(a,c,d){(c!=="number"||$n(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ut=Array.isArray;function nn(a,c,d,p){if(a=a.options,c){c={};for(var v=0;v<d.length;v++)c["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=c.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&p&&(a[d].defaultSelected=!0)}else{for(d=""+je(d),c=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,p&&(a[v].defaultSelected=!0);return}c!==null||a[v].disabled||(c=a[v])}c!==null&&(c.selected=!0)}}function ki(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ut(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:je(d)}}function no(a,c){var d=je(c.value),p=je(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),p!=null&&(a.defaultValue=""+p)}function Ni(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Ar(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Ar(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var br,ua=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,p,v){MSApp.execUnsafeLocalFunction(function(){return a(c,d,p,v)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(br=br||document.createElement("div"),br.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=br.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Pr(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vl=["Webkit","ms","Moz","O"];Object.keys(Di).forEach(function(a){Vl.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Di[c]=Di[a]})});function kr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Di.hasOwnProperty(a)&&Di[a]?(""+c).trim():c+"px"}function gs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var p=d.indexOf("--")===0,v=kr(d,c[d],p);d==="float"&&(d="cssFloat"),p?a.setProperty(d,v):a[d]=v}}var io=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,c){if(c){if(io[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ms(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nr=null;function Dr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Fn=null,Vn=null,gt=null;function ro(a){if(a=hh(a)){if(typeof Fn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Xf(c),Fn(a.stateNode,a.type,c))}}function nr(a){Vn?gt?gt.push(a):gt=[a]:Vn=a}function Ft(){if(Vn){var a=Vn,c=gt;if(gt=Vn=null,ro(a),c)for(a=0;a<c.length;a++)ro(c[a])}}function Mi(a,c){return a(c)}function fn(){}var Vt=!1;function gn(a,c,d){if(Vt)return a(c,d);Vt=!0;try{return Mi(a,c,d)}finally{Vt=!1,(Vn!==null||gt!==null)&&(fn(),Ft())}}function mn(a,c){var d=a.stateNode;if(d===null)return null;var p=Xf(d);if(p===null)return null;d=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var rn=!1;if(l)try{var st={};Object.defineProperty(st,"passive",{get:function(){rn=!0}}),window.addEventListener("test",st,st),window.removeEventListener("test",st,st)}catch{rn=!1}function Wt(a,c,d,p,v,w,P,U,W){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(oe){this.onError(oe)}}var qt=!1,Li=null,jl=!1,Oi=null,Cf={onError:function(a){qt=!0,Li=a}};function Rf(a,c,d,p,v,w,P,U,W){qt=!1,Li=null,Wt.apply(Cf,arguments)}function ju(a,c,d,p,v,w,P,U,W){if(Rf.apply(this,arguments),qt){if(qt){var J=Li;qt=!1,Li=null}else throw Error(t(198));jl||(jl=!0,Oi=J)}}function ir(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function zu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function Af(a){if(ir(a)!==a)throw Error(t(188))}function bf(a){var c=a.alternate;if(!c){if(c=ir(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,p=c;;){var v=d.return;if(v===null)break;var w=v.alternate;if(w===null){if(p=v.return,p!==null){d=p;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===d)return Af(v),a;if(w===p)return Af(v),c;w=w.sibling}throw Error(t(188))}if(d.return!==p.return)d=v,p=w;else{for(var P=!1,U=v.child;U;){if(U===d){P=!0,d=v,p=w;break}if(U===p){P=!0,p=v,d=w;break}U=U.sibling}if(!P){for(U=w.child;U;){if(U===d){P=!0,d=w,p=v;break}if(U===p){P=!0,p=w,d=v;break}U=U.sibling}if(!P)throw Error(t(189))}}if(d.alternate!==p)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Pf(a){return a=bf(a),a!==null?ha(a):null}function ha(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ha(a);if(c!==null)return c;a=a.sibling}return null}var Uu=e.unstable_scheduleCallback,zl=e.unstable_cancelCallback,da=e.unstable_shouldYield,ps=e.unstable_requestPaint,wt=e.unstable_now,Iy=e.unstable_getCurrentPriorityLevel,Ul=e.unstable_ImmediatePriority,Bu=e.unstable_UserBlockingPriority,fa=e.unstable_NormalPriority,Wu=e.unstable_LowPriority,Bl=e.unstable_IdlePriority,ga=null,di=null;function kf(a){if(di&&typeof di.onCommitFiberRoot=="function")try{di.onCommitFiberRoot(ga,a,void 0,(a.current.flags&128)===128)}catch{}}var fi=Math.clz32?Math.clz32:ma,Mr=Math.log,Fi=Math.LN2;function ma(a){return a>>>=0,a===0?32:31-(Mr(a)/Fi|0)|0}var Lr=64,so=4194304;function ot(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ys(a,c){var d=a.pendingLanes;if(d===0)return 0;var p=0,v=a.suspendedLanes,w=a.pingedLanes,P=d&268435455;if(P!==0){var U=P&~v;U!==0?p=ot(U):(w&=P,w!==0&&(p=ot(w)))}else P=d&~v,P!==0?p=ot(P):w!==0&&(p=ot(w));if(p===0)return 0;if(c!==0&&c!==p&&(c&v)===0&&(v=p&-p,w=c&-c,v>=w||v===16&&(w&4194240)!==0))return c;if((p&4)!==0&&(p|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=p;0<c;)d=31-fi(c),v=1<<d,p|=a[d],c&=~v;return p}function pa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ya(a,c){for(var d=a.suspendedLanes,p=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var P=31-fi(w),U=1<<P,W=v[P];W===-1?((U&d)===0||(U&p)!==0)&&(v[P]=pa(U,c)):W<=c&&(a.expiredLanes|=U),w&=~U}}function Gu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function $u(){var a=Lr;return Lr<<=1,(Lr&4194240)===0&&(Lr=64),a}function Ku(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function _a(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-fi(c),a[c]=d}function Cy(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var p=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-fi(d),w=1<<v;c[v]=0,p[v]=-1,a[v]=-1,d&=~w}}function Hu(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var p=31-fi(d),v=1<<p;v&c|a[p]&c&&(a[p]|=c),d&=~v}}var Xe=0;function Or(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Xu,Wl,qu,Yu,Zu,Fr=!1,Gl=[],Vr=null,jr=null,pn=null,va=new Map,_s=new Map,gi=[],Nf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oo(a,c){switch(a){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":pn=null;break;case"pointerover":case"pointerout":va.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_s.delete(c.pointerId)}}function rr(a,c,d,p,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:p,nativeEvent:w,targetContainers:[v]},c!==null&&(c=hh(c),c!==null&&Wl(c)),a):(a.eventSystemFlags|=p,c=a.targetContainers,v!==null&&c.indexOf(v)===-1&&c.push(v),a)}function Df(a,c,d,p,v){switch(c){case"focusin":return Vr=rr(Vr,a,c,d,p,v),!0;case"dragenter":return jr=rr(jr,a,c,d,p,v),!0;case"mouseover":return pn=rr(pn,a,c,d,p,v),!0;case"pointerover":var w=v.pointerId;return va.set(w,rr(va.get(w)||null,a,c,d,p,v)),!0;case"gotpointercapture":return w=v.pointerId,_s.set(w,rr(_s.get(w)||null,a,c,d,p,v)),!0}return!1}function $l(a){var c=Ta(a.target);if(c!==null){var d=ir(c);if(d!==null){if(c=d.tag,c===13){if(c=zu(d),c!==null){a.blockedOn=c,Zu(a.priority,function(){qu(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Kl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var p=new d.constructor(d.type,d);Nr=p,d.target.dispatchEvent(p),Nr=null}else return c=hh(d),c!==null&&Wl(c),a.blockedOn=d,!1;c.shift()}return!0}function Mf(a,c,d){pt(a)&&d.delete(c)}function Ry(){Fr=!1,Vr!==null&&pt(Vr)&&(Vr=null),jr!==null&&pt(jr)&&(jr=null),pn!==null&&pt(pn)&&(pn=null),va.forEach(Mf),_s.forEach(Mf)}function ao(a,c){a.blockedOn===c&&(a.blockedOn=null,Fr||(Fr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ry)))}function lo(a){function c(v){return ao(v,a)}if(0<Gl.length){ao(Gl[0],a);for(var d=1;d<Gl.length;d++){var p=Gl[d];p.blockedOn===a&&(p.blockedOn=null)}}for(Vr!==null&&ao(Vr,a),jr!==null&&ao(jr,a),pn!==null&&ao(pn,a),va.forEach(c),_s.forEach(c),d=0;d<gi.length;d++)p=gi[d],p.blockedOn===a&&(p.blockedOn=null);for(;0<gi.length&&(d=gi[0],d.blockedOn===null);)$l(d),d.blockedOn===null&&gi.shift()}var vs=R.ReactCurrentBatchConfig,xs=!0;function zr(a,c,d,p){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=1,Qu(a,c,d,p)}finally{Xe=v,vs.transition=w}}function Lf(a,c,d,p){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=4,Qu(a,c,d,p)}finally{Xe=v,vs.transition=w}}function Qu(a,c,d,p){if(xs){var v=Kl(a,c,d,p);if(v===null)Vy(a,c,p,Ur,d),oo(a,p);else if(Df(v,a,c,d,p))p.stopPropagation();else if(oo(a,p),c&4&&-1<Nf.indexOf(a)){for(;v!==null;){var w=hh(v);if(w!==null&&Xu(w),w=Kl(a,c,d,p),w===null&&Vy(a,c,p,Ur,d),w===v)break;v=w}v!==null&&p.stopPropagation()}else Vy(a,c,p,null,d)}}var Ur=null;function Kl(a,c,d,p){if(Ur=null,a=Dr(p),a=Ta(a),a!==null)if(c=ir(a),c===null)a=null;else if(d=c.tag,d===13){if(a=zu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return Ur=a,null}function Hl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Iy()){case Ul:return 1;case Bu:return 4;case fa:case Wu:return 16;case Bl:return 536870912;default:return 16}default:return 16}}var mi=null,Xl=null,ws=null;function Of(){if(ws)return ws;var a,c=Xl,d=c.length,p,v="value"in mi?mi.value:mi.textContent,w=v.length;for(a=0;a<d&&c[a]===v[a];a++);var P=d-a;for(p=1;p<=P&&c[d-p]===v[w-p];p++);return ws=v.slice(a,1<p?1-p:void 0)}function xa(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Br(){return!0}function Ju(){return!1}function Rn(a){function c(d,p,v,w,P){this._reactName=d,this._targetInst=v,this.type=p,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(w):w[U]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Br:Ju,this.isPropagationStopped=Ju,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Br)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Br)},persist:function(){},isPersistent:Br}),c}var Wr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=Rn(Wr),co=ne({},Wr,{view:0,detail:0}),ql=Rn(co),Yl,Zl,pi,Ea=ne({},co,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ze,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==pi&&(pi&&a.type==="mousemove"?(Yl=a.screenX-pi.screenX,Zl=a.screenY-pi.screenY):Zl=Yl=0,pi=a),Yl)},movementY:function(a){return"movementY"in a?a.movementY:Zl}}),eh=Rn(Ea),Ff=ne({},Ea,{dataTransfer:0}),Vf=Rn(Ff),Ql=ne({},co,{relatedTarget:0}),yn=Rn(Ql),jf=ne({},Wr,{animationName:0,elapsedTime:0,pseudoElement:0}),zf=Rn(jf),uo=ne({},Wr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Rn(uo),E=ne({},Wr,{data:0}),C=Rn(E),F={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function ze(){return de}var jt=ne({},co,{key:function(a){if(a.key){var c=F[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=xa(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?q[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ze,charCode:function(a){return a.type==="keypress"?xa(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?xa(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ht=Rn(jt),Gt=ne({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yi=Rn(Gt),Es=ne({},co,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ze}),Gr=Rn(Es),$r=ne({},Wr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jl=Rn($r),th=ne({},Ea,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),XD=Rn(th),qD=[9,13,27,32],Ay=l&&"CompositionEvent"in window,nh=null;l&&"documentMode"in document&&(nh=document.documentMode);var YD=l&&"TextEvent"in window&&!nh,Gw=l&&(!Ay||nh&&8<nh&&11>=nh),$w=" ",Kw=!1;function Hw(a,c){switch(a){case"keyup":return qD.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ec=!1;function ZD(a,c){switch(a){case"compositionend":return Xw(c);case"keypress":return c.which!==32?null:(Kw=!0,$w);case"textInput":return a=c.data,a===$w&&Kw?null:a;default:return null}}function QD(a,c){if(ec)return a==="compositionend"||!Ay&&Hw(a,c)?(a=Of(),ws=Xl=mi=null,ec=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Gw&&c.locale!=="ko"?null:c.data;default:return null}}var JD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!JD[a.type]:c==="textarea"}function Yw(a,c,d,p){nr(p),c=$f(c,"onChange"),0<c.length&&(d=new wa("onChange","change",null,d,p),a.push({event:d,listeners:c}))}var ih=null,rh=null;function eM(a){gE(a,0)}function Uf(a){var c=sc(a);if(fs(c))return a}function tM(a,c){if(a==="change")return c}var Zw=!1;if(l){var by;if(l){var Py="oninput"in document;if(!Py){var Qw=document.createElement("div");Qw.setAttribute("oninput","return;"),Py=typeof Qw.oninput=="function"}by=Py}else by=!1;Zw=by&&(!document.documentMode||9<document.documentMode)}function Jw(){ih&&(ih.detachEvent("onpropertychange",eE),rh=ih=null)}function eE(a){if(a.propertyName==="value"&&Uf(rh)){var c=[];Yw(c,rh,a,Dr(a)),gn(eM,c)}}function nM(a,c,d){a==="focusin"?(Jw(),ih=c,rh=d,ih.attachEvent("onpropertychange",eE)):a==="focusout"&&Jw()}function iM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Uf(rh)}function rM(a,c){if(a==="click")return Uf(c)}function sM(a,c){if(a==="input"||a==="change")return Uf(c)}function oM(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var sr=typeof Object.is=="function"?Object.is:oM;function sh(a,c){if(sr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),p=Object.keys(c);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var v=d[p];if(!u.call(c,v)||!sr(a[v],c[v]))return!1}return!0}function tE(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function nE(a,c){var d=tE(a);a=0;for(var p;d;){if(d.nodeType===3){if(p=a+d.textContent.length,a<=c&&p>=c)return{node:d,offset:c-a};a=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=tE(d)}}function iE(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?iE(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function rE(){for(var a=window,c=$n();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=$n(a.document)}return c}function ky(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function aM(a){var c=rE(),d=a.focusedElem,p=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&iE(d.ownerDocument.documentElement,d)){if(p!==null&&ky(d)){if(c=p.start,a=p.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,w=Math.min(p.start,v);p=p.end===void 0?w:Math.min(p.end,v),!a.extend&&w>p&&(v=p,p=w,w=v),v=nE(d,w);var P=nE(d,p);v&&P&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==P.node||a.focusOffset!==P.offset)&&(c=c.createRange(),c.setStart(v.node,v.offset),a.removeAllRanges(),w>p?(a.addRange(c),a.extend(P.node,P.offset)):(c.setEnd(P.node,P.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var lM=l&&"documentMode"in document&&11>=document.documentMode,tc=null,Ny=null,oh=null,Dy=!1;function sE(a,c,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Dy||tc==null||tc!==$n(p)||(p=tc,"selectionStart"in p&&ky(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),oh&&sh(oh,p)||(oh=p,p=$f(Ny,"onSelect"),0<p.length&&(c=new wa("onSelect","select",null,c,d),a.push({event:c,listeners:p}),c.target=tc)))}function Bf(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var nc={animationend:Bf("Animation","AnimationEnd"),animationiteration:Bf("Animation","AnimationIteration"),animationstart:Bf("Animation","AnimationStart"),transitionend:Bf("Transition","TransitionEnd")},My={},oE={};l&&(oE=document.createElement("div").style,"AnimationEvent"in window||(delete nc.animationend.animation,delete nc.animationiteration.animation,delete nc.animationstart.animation),"TransitionEvent"in window||delete nc.transitionend.transition);function Wf(a){if(My[a])return My[a];if(!nc[a])return a;var c=nc[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in oE)return My[a]=c[d];return a}var aE=Wf("animationend"),lE=Wf("animationiteration"),cE=Wf("animationstart"),uE=Wf("transitionend"),hE=new Map,dE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ho(a,c){hE.set(a,c),s(c,[a])}for(var Ly=0;Ly<dE.length;Ly++){var Oy=dE[Ly],cM=Oy.toLowerCase(),uM=Oy[0].toUpperCase()+Oy.slice(1);ho(cM,"on"+uM)}ho(aE,"onAnimationEnd"),ho(lE,"onAnimationIteration"),ho(cE,"onAnimationStart"),ho("dblclick","onDoubleClick"),ho("focusin","onFocus"),ho("focusout","onBlur"),ho(uE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ah="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hM=new Set("cancel close invalid load scroll toggle".split(" ").concat(ah));function fE(a,c,d){var p=a.type||"unknown-event";a.currentTarget=d,ju(p,c,void 0,a),a.currentTarget=null}function gE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var p=a[d],v=p.event;p=p.listeners;e:{var w=void 0;if(c)for(var P=p.length-1;0<=P;P--){var U=p[P],W=U.instance,J=U.currentTarget;if(U=U.listener,W!==w&&v.isPropagationStopped())break e;fE(v,U,J),w=W}else for(P=0;P<p.length;P++){if(U=p[P],W=U.instance,J=U.currentTarget,U=U.listener,W!==w&&v.isPropagationStopped())break e;fE(v,U,J),w=W}}}if(jl)throw a=Oi,jl=!1,Oi=null,a}function Et(a,c){var d=c[Gy];d===void 0&&(d=c[Gy]=new Set);var p=a+"__bubble";d.has(p)||(mE(c,a,2,!1),d.add(p))}function Fy(a,c,d){var p=0;c&&(p|=4),mE(d,a,p,c)}var Gf="_reactListening"+Math.random().toString(36).slice(2);function lh(a){if(!a[Gf]){a[Gf]=!0,i.forEach(function(d){d!=="selectionchange"&&(hM.has(d)||Fy(d,!1,a),Fy(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Gf]||(c[Gf]=!0,Fy("selectionchange",!1,c))}}function mE(a,c,d,p){switch(Hl(c)){case 1:var v=zr;break;case 4:v=Lf;break;default:v=Qu}d=v.bind(null,c,d,a),v=void 0,!rn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(v=!0),p?v!==void 0?a.addEventListener(c,d,{capture:!0,passive:v}):a.addEventListener(c,d,!0):v!==void 0?a.addEventListener(c,d,{passive:v}):a.addEventListener(c,d,!1)}function Vy(a,c,d,p,v){var w=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var P=p.tag;if(P===3||P===4){var U=p.stateNode.containerInfo;if(U===v||U.nodeType===8&&U.parentNode===v)break;if(P===4)for(P=p.return;P!==null;){var W=P.tag;if((W===3||W===4)&&(W=P.stateNode.containerInfo,W===v||W.nodeType===8&&W.parentNode===v))return;P=P.return}for(;U!==null;){if(P=Ta(U),P===null)return;if(W=P.tag,W===5||W===6){p=w=P;continue e}U=U.parentNode}}p=p.return}gn(function(){var J=w,oe=Dr(d),ce=[];e:{var re=hE.get(a);if(re!==void 0){var ye=wa,ve=a;switch(a){case"keypress":if(xa(d)===0)break e;case"keydown":case"keyup":ye=ht;break;case"focusin":ve="focus",ye=yn;break;case"focusout":ve="blur",ye=yn;break;case"beforeblur":case"afterblur":ye=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=eh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Vf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Gr;break;case aE:case lE:case cE:ye=zf;break;case uE:ye=Jl;break;case"scroll":ye=ql;break;case"wheel":ye=XD;break;case"copy":case"cut":case"paste":ye=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=yi}var we=(c&4)!==0,zt=!we&&a==="scroll",X=we?re!==null?re+"Capture":null:re;we=[];for(var K=J,Y;K!==null;){Y=K;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,X!==null&&(he=mn(K,X),he!=null&&we.push(ch(K,he,Y)))),zt)break;K=K.return}0<we.length&&(re=new ye(re,ve,null,d,oe),ce.push({event:re,listeners:we}))}}if((c&7)===0){e:{if(re=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",re&&d!==Nr&&(ve=d.relatedTarget||d.fromElement)&&(Ta(ve)||ve[Ts]))break e;if((ye||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,ye?(ve=d.relatedTarget||d.toElement,ye=J,ve=ve?Ta(ve):null,ve!==null&&(zt=ir(ve),ve!==zt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(ye=null,ve=J),ye!==ve)){if(we=eh,he="onMouseLeave",X="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(we=yi,he="onPointerLeave",X="onPointerEnter",K="pointer"),zt=ye==null?re:sc(ye),Y=ve==null?re:sc(ve),re=new we(he,K+"leave",ye,d,oe),re.target=zt,re.relatedTarget=Y,he=null,Ta(oe)===J&&(we=new we(X,K+"enter",ve,d,oe),we.target=Y,we.relatedTarget=zt,he=we),zt=he,ye&&ve)t:{for(we=ye,X=ve,K=0,Y=we;Y;Y=ic(Y))K++;for(Y=0,he=X;he;he=ic(he))Y++;for(;0<K-Y;)we=ic(we),K--;for(;0<Y-K;)X=ic(X),Y--;for(;K--;){if(we===X||X!==null&&we===X.alternate)break t;we=ic(we),X=ic(X)}we=null}else we=null;ye!==null&&pE(ce,re,ye,we,!1),ve!==null&&zt!==null&&pE(ce,zt,ve,we,!0)}}e:{if(re=J?sc(J):window,ye=re.nodeName&&re.nodeName.toLowerCase(),ye==="select"||ye==="input"&&re.type==="file")var Te=tM;else if(qw(re))if(Zw)Te=sM;else{Te=iM;var be=nM}else(ye=re.nodeName)&&ye.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Te=rM);if(Te&&(Te=Te(a,J))){Yw(ce,Te,d,oe);break e}be&&be(a,re,J),a==="focusout"&&(be=re._wrapperState)&&be.controlled&&re.type==="number"&&_t(re,"number",re.value)}switch(be=J?sc(J):window,a){case"focusin":(qw(be)||be.contentEditable==="true")&&(tc=be,Ny=J,oh=null);break;case"focusout":oh=Ny=tc=null;break;case"mousedown":Dy=!0;break;case"contextmenu":case"mouseup":case"dragend":Dy=!1,sE(ce,d,oe);break;case"selectionchange":if(lM)break;case"keydown":case"keyup":sE(ce,d,oe)}var Pe;if(Ay)e:{switch(a){case"compositionstart":var Oe="onCompositionStart";break e;case"compositionend":Oe="onCompositionEnd";break e;case"compositionupdate":Oe="onCompositionUpdate";break e}Oe=void 0}else ec?Hw(a,d)&&(Oe="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Oe="onCompositionStart");Oe&&(Gw&&d.locale!=="ko"&&(ec||Oe!=="onCompositionStart"?Oe==="onCompositionEnd"&&ec&&(Pe=Of()):(mi=oe,Xl="value"in mi?mi.value:mi.textContent,ec=!0)),be=$f(J,Oe),0<be.length&&(Oe=new C(Oe,a,null,d,oe),ce.push({event:Oe,listeners:be}),Pe?Oe.data=Pe:(Pe=Xw(d),Pe!==null&&(Oe.data=Pe)))),(Pe=YD?ZD(a,d):QD(a,d))&&(J=$f(J,"onBeforeInput"),0<J.length&&(oe=new C("onBeforeInput","beforeinput",null,d,oe),ce.push({event:oe,listeners:J}),oe.data=Pe))}gE(ce,c)})}function ch(a,c,d){return{instance:a,listener:c,currentTarget:d}}function $f(a,c){for(var d=c+"Capture",p=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=mn(a,d),w!=null&&p.unshift(ch(a,w,v)),w=mn(a,c),w!=null&&p.push(ch(a,w,v))),a=a.return}return p}function ic(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function pE(a,c,d,p,v){for(var w=c._reactName,P=[];d!==null&&d!==p;){var U=d,W=U.alternate,J=U.stateNode;if(W!==null&&W===p)break;U.tag===5&&J!==null&&(U=J,v?(W=mn(d,w),W!=null&&P.unshift(ch(d,W,U))):v||(W=mn(d,w),W!=null&&P.push(ch(d,W,U)))),d=d.return}P.length!==0&&a.push({event:c,listeners:P})}var dM=/\r\n?/g,fM=/\u0000|\uFFFD/g;function yE(a){return(typeof a=="string"?a:""+a).replace(dM,`
`).replace(fM,"")}function Kf(a,c,d){if(c=yE(c),yE(a)!==c&&d)throw Error(t(425))}function Hf(){}var jy=null,zy=null;function Uy(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var By=typeof setTimeout=="function"?setTimeout:void 0,gM=typeof clearTimeout=="function"?clearTimeout:void 0,_E=typeof Promise=="function"?Promise:void 0,mM=typeof queueMicrotask=="function"?queueMicrotask:typeof _E<"u"?function(a){return _E.resolve(null).then(a).catch(pM)}:By;function pM(a){setTimeout(function(){throw a})}function Wy(a,c){var d=c,p=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(p===0){a.removeChild(v),lo(c);return}p--}else d!=="$"&&d!=="$?"&&d!=="$!"||p++;d=v}while(d);lo(c)}function fo(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function vE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var rc=Math.random().toString(36).slice(2),Kr="__reactFiber$"+rc,uh="__reactProps$"+rc,Ts="__reactContainer$"+rc,Gy="__reactEvents$"+rc,yM="__reactListeners$"+rc,_M="__reactHandles$"+rc;function Ta(a){var c=a[Kr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Ts]||d[Kr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=vE(a);a!==null;){if(d=a[Kr])return d;a=vE(a)}return c}a=d,d=a.parentNode}return null}function hh(a){return a=a[Kr]||a[Ts],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function sc(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Xf(a){return a[uh]||null}var $y=[],oc=-1;function go(a){return{current:a}}function Tt(a){0>oc||(a.current=$y[oc],$y[oc]=null,oc--)}function vt(a,c){oc++,$y[oc]=a.current,a.current=c}var mo={},An=go(mo),Xn=go(!1),Sa=mo;function ac(a,c){var d=a.type.contextTypes;if(!d)return mo;var p=a.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===c)return p.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in d)v[w]=c[w];return p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=v),v}function qn(a){return a=a.childContextTypes,a!=null}function qf(){Tt(Xn),Tt(An)}function xE(a,c,d){if(An.current!==mo)throw Error(t(168));vt(An,c),vt(Xn,d)}function wE(a,c,d){var p=a.stateNode;if(c=c.childContextTypes,typeof p.getChildContext!="function")return d;p=p.getChildContext();for(var v in p)if(!(v in c))throw Error(t(108,Le(a)||"Unknown",v));return ne({},d,p)}function Yf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||mo,Sa=An.current,vt(An,a),vt(Xn,Xn.current),!0}function EE(a,c,d){var p=a.stateNode;if(!p)throw Error(t(169));d?(a=wE(a,c,Sa),p.__reactInternalMemoizedMergedChildContext=a,Tt(Xn),Tt(An),vt(An,a)):Tt(Xn),vt(Xn,d)}var Ss=null,Zf=!1,Ky=!1;function TE(a){Ss===null?Ss=[a]:Ss.push(a)}function vM(a){Zf=!0,TE(a)}function po(){if(!Ky&&Ss!==null){Ky=!0;var a=0,c=Xe;try{var d=Ss;for(Xe=1;a<d.length;a++){var p=d[a];do p=p(!0);while(p!==null)}Ss=null,Zf=!1}catch(v){throw Ss!==null&&(Ss=Ss.slice(a+1)),Uu(Ul,po),v}finally{Xe=c,Ky=!1}}return null}var lc=[],cc=0,Qf=null,Jf=0,Vi=[],ji=0,Ia=null,Is=1,Cs="";function Ca(a,c){lc[cc++]=Jf,lc[cc++]=Qf,Qf=a,Jf=c}function SE(a,c,d){Vi[ji++]=Is,Vi[ji++]=Cs,Vi[ji++]=Ia,Ia=a;var p=Is;a=Cs;var v=32-fi(p)-1;p&=~(1<<v),d+=1;var w=32-fi(c)+v;if(30<w){var P=v-v%5;w=(p&(1<<P)-1).toString(32),p>>=P,v-=P,Is=1<<32-fi(c)+v|d<<v|p,Cs=w+a}else Is=1<<w|d<<v|p,Cs=a}function Hy(a){a.return!==null&&(Ca(a,1),SE(a,1,0))}function Xy(a){for(;a===Qf;)Qf=lc[--cc],lc[cc]=null,Jf=lc[--cc],lc[cc]=null;for(;a===Ia;)Ia=Vi[--ji],Vi[ji]=null,Cs=Vi[--ji],Vi[ji]=null,Is=Vi[--ji],Vi[ji]=null}var _i=null,vi=null,Ct=!1,or=null;function IE(a,c){var d=Wi(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function CE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,_i=a,vi=fo(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,_i=a,vi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Ia!==null?{id:Is,overflow:Cs}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Wi(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,_i=a,vi=null,!0):!1;default:return!1}}function qy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Yy(a){if(Ct){var c=vi;if(c){var d=c;if(!CE(a,c)){if(qy(a))throw Error(t(418));c=fo(d.nextSibling);var p=_i;c&&CE(a,c)?IE(p,d):(a.flags=a.flags&-4097|2,Ct=!1,_i=a)}}else{if(qy(a))throw Error(t(418));a.flags=a.flags&-4097|2,Ct=!1,_i=a}}}function RE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;_i=a}function eg(a){if(a!==_i)return!1;if(!Ct)return RE(a),Ct=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Uy(a.type,a.memoizedProps)),c&&(c=vi)){if(qy(a))throw AE(),Error(t(418));for(;c;)IE(a,c),c=fo(c.nextSibling)}if(RE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){vi=fo(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}vi=null}}else vi=_i?fo(a.stateNode.nextSibling):null;return!0}function AE(){for(var a=vi;a;)a=fo(a.nextSibling)}function uc(){vi=_i=null,Ct=!1}function Zy(a){or===null?or=[a]:or.push(a)}var xM=R.ReactCurrentBatchConfig;function dh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var p=d.stateNode}if(!p)throw Error(t(147,a));var v=p,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(P){var U=v.refs;P===null?delete U[w]:U[w]=P},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function tg(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function bE(a){var c=a._init;return c(a._payload)}function PE(a){function c(X,K){if(a){var Y=X.deletions;Y===null?(X.deletions=[K],X.flags|=16):Y.push(K)}}function d(X,K){if(!a)return null;for(;K!==null;)c(X,K),K=K.sibling;return null}function p(X,K){for(X=new Map;K!==null;)K.key!==null?X.set(K.key,K):X.set(K.index,K),K=K.sibling;return X}function v(X,K){return X=So(X,K),X.index=0,X.sibling=null,X}function w(X,K,Y){return X.index=Y,a?(Y=X.alternate,Y!==null?(Y=Y.index,Y<K?(X.flags|=2,K):Y):(X.flags|=2,K)):(X.flags|=1048576,K)}function P(X){return a&&X.alternate===null&&(X.flags|=2),X}function U(X,K,Y,he){return K===null||K.tag!==6?(K=B_(Y,X.mode,he),K.return=X,K):(K=v(K,Y),K.return=X,K)}function W(X,K,Y,he){var Te=Y.type;return Te===k?oe(X,K,Y.props.children,he,Y.key):K!==null&&(K.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&bE(Te)===K.type)?(he=v(K,Y.props),he.ref=dh(X,K,Y),he.return=X,he):(he=Ig(Y.type,Y.key,Y.props,null,X.mode,he),he.ref=dh(X,K,Y),he.return=X,he)}function J(X,K,Y,he){return K===null||K.tag!==4||K.stateNode.containerInfo!==Y.containerInfo||K.stateNode.implementation!==Y.implementation?(K=W_(Y,X.mode,he),K.return=X,K):(K=v(K,Y.children||[]),K.return=X,K)}function oe(X,K,Y,he,Te){return K===null||K.tag!==7?(K=Ma(Y,X.mode,he,Te),K.return=X,K):(K=v(K,Y),K.return=X,K)}function ce(X,K,Y){if(typeof K=="string"&&K!==""||typeof K=="number")return K=B_(""+K,X.mode,Y),K.return=X,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case D:return Y=Ig(K.type,K.key,K.props,null,X.mode,Y),Y.ref=dh(X,null,K),Y.return=X,Y;case j:return K=W_(K,X.mode,Y),K.return=X,K;case ge:var he=K._init;return ce(X,he(K._payload),Y)}if(ut(K)||se(K))return K=Ma(K,X.mode,Y,null),K.return=X,K;tg(X,K)}return null}function re(X,K,Y,he){var Te=K!==null?K.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Te!==null?null:U(X,K,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:return Y.key===Te?W(X,K,Y,he):null;case j:return Y.key===Te?J(X,K,Y,he):null;case ge:return Te=Y._init,re(X,K,Te(Y._payload),he)}if(ut(Y)||se(Y))return Te!==null?null:oe(X,K,Y,he,null);tg(X,Y)}return null}function ye(X,K,Y,he,Te){if(typeof he=="string"&&he!==""||typeof he=="number")return X=X.get(Y)||null,U(K,X,""+he,Te);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case D:return X=X.get(he.key===null?Y:he.key)||null,W(K,X,he,Te);case j:return X=X.get(he.key===null?Y:he.key)||null,J(K,X,he,Te);case ge:var be=he._init;return ye(X,K,Y,be(he._payload),Te)}if(ut(he)||se(he))return X=X.get(Y)||null,oe(K,X,he,Te,null);tg(K,he)}return null}function ve(X,K,Y,he){for(var Te=null,be=null,Pe=K,Oe=K=0,an=null;Pe!==null&&Oe<Y.length;Oe++){Pe.index>Oe?(an=Pe,Pe=null):an=Pe.sibling;var tt=re(X,Pe,Y[Oe],he);if(tt===null){Pe===null&&(Pe=an);break}a&&Pe&&tt.alternate===null&&c(X,Pe),K=w(tt,K,Oe),be===null?Te=tt:be.sibling=tt,be=tt,Pe=an}if(Oe===Y.length)return d(X,Pe),Ct&&Ca(X,Oe),Te;if(Pe===null){for(;Oe<Y.length;Oe++)Pe=ce(X,Y[Oe],he),Pe!==null&&(K=w(Pe,K,Oe),be===null?Te=Pe:be.sibling=Pe,be=Pe);return Ct&&Ca(X,Oe),Te}for(Pe=p(X,Pe);Oe<Y.length;Oe++)an=ye(Pe,X,Oe,Y[Oe],he),an!==null&&(a&&an.alternate!==null&&Pe.delete(an.key===null?Oe:an.key),K=w(an,K,Oe),be===null?Te=an:be.sibling=an,be=an);return a&&Pe.forEach(function(Io){return c(X,Io)}),Ct&&Ca(X,Oe),Te}function we(X,K,Y,he){var Te=se(Y);if(typeof Te!="function")throw Error(t(150));if(Y=Te.call(Y),Y==null)throw Error(t(151));for(var be=Te=null,Pe=K,Oe=K=0,an=null,tt=Y.next();Pe!==null&&!tt.done;Oe++,tt=Y.next()){Pe.index>Oe?(an=Pe,Pe=null):an=Pe.sibling;var Io=re(X,Pe,tt.value,he);if(Io===null){Pe===null&&(Pe=an);break}a&&Pe&&Io.alternate===null&&c(X,Pe),K=w(Io,K,Oe),be===null?Te=Io:be.sibling=Io,be=Io,Pe=an}if(tt.done)return d(X,Pe),Ct&&Ca(X,Oe),Te;if(Pe===null){for(;!tt.done;Oe++,tt=Y.next())tt=ce(X,tt.value,he),tt!==null&&(K=w(tt,K,Oe),be===null?Te=tt:be.sibling=tt,be=tt);return Ct&&Ca(X,Oe),Te}for(Pe=p(X,Pe);!tt.done;Oe++,tt=Y.next())tt=ye(Pe,X,Oe,tt.value,he),tt!==null&&(a&&tt.alternate!==null&&Pe.delete(tt.key===null?Oe:tt.key),K=w(tt,K,Oe),be===null?Te=tt:be.sibling=tt,be=tt);return a&&Pe.forEach(function(JM){return c(X,JM)}),Ct&&Ca(X,Oe),Te}function zt(X,K,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===k&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:e:{for(var Te=Y.key,be=K;be!==null;){if(be.key===Te){if(Te=Y.type,Te===k){if(be.tag===7){d(X,be.sibling),K=v(be,Y.props.children),K.return=X,X=K;break e}}else if(be.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&bE(Te)===be.type){d(X,be.sibling),K=v(be,Y.props),K.ref=dh(X,be,Y),K.return=X,X=K;break e}d(X,be);break}else c(X,be);be=be.sibling}Y.type===k?(K=Ma(Y.props.children,X.mode,he,Y.key),K.return=X,X=K):(he=Ig(Y.type,Y.key,Y.props,null,X.mode,he),he.ref=dh(X,K,Y),he.return=X,X=he)}return P(X);case j:e:{for(be=Y.key;K!==null;){if(K.key===be)if(K.tag===4&&K.stateNode.containerInfo===Y.containerInfo&&K.stateNode.implementation===Y.implementation){d(X,K.sibling),K=v(K,Y.children||[]),K.return=X,X=K;break e}else{d(X,K);break}else c(X,K);K=K.sibling}K=W_(Y,X.mode,he),K.return=X,X=K}return P(X);case ge:return be=Y._init,zt(X,K,be(Y._payload),he)}if(ut(Y))return ve(X,K,Y,he);if(se(Y))return we(X,K,Y,he);tg(X,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,K!==null&&K.tag===6?(d(X,K.sibling),K=v(K,Y),K.return=X,X=K):(d(X,K),K=B_(Y,X.mode,he),K.return=X,X=K),P(X)):d(X,K)}return zt}var hc=PE(!0),kE=PE(!1),ng=go(null),ig=null,dc=null,Qy=null;function Jy(){Qy=dc=ig=null}function e_(a){var c=ng.current;Tt(ng),a._currentValue=c}function t_(a,c,d){for(;a!==null;){var p=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),a===d)break;a=a.return}}function fc(a,c){ig=a,Qy=dc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(Yn=!0),a.firstContext=null)}function zi(a){var c=a._currentValue;if(Qy!==a)if(a={context:a,memoizedValue:c,next:null},dc===null){if(ig===null)throw Error(t(308));dc=a,ig.dependencies={lanes:0,firstContext:a}}else dc=dc.next=a;return c}var Ra=null;function n_(a){Ra===null?Ra=[a]:Ra.push(a)}function NE(a,c,d,p){var v=c.interleaved;return v===null?(d.next=d,n_(c)):(d.next=v.next,v.next=d),c.interleaved=d,Rs(a,p)}function Rs(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var yo=!1;function i_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function DE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function As(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function _o(a,c,d){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(et&2)!==0){var v=p.pending;return v===null?c.next=c:(c.next=v.next,v.next=c),p.pending=c,Rs(a,d)}return v=p.interleaved,v===null?(c.next=c,n_(p)):(c.next=v.next,v.next=c),p.interleaved=c,Rs(a,d)}function rg(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var p=c.lanes;p&=a.pendingLanes,d|=p,c.lanes=d,Hu(a,d)}}function ME(a,c){var d=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var v=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var P={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?v=w=P:w=w.next=P,d=d.next}while(d!==null);w===null?v=w=c:w=w.next=c}else v=w=c;d={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:p.shared,effects:p.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function sg(a,c,d,p){var v=a.updateQueue;yo=!1;var w=v.firstBaseUpdate,P=v.lastBaseUpdate,U=v.shared.pending;if(U!==null){v.shared.pending=null;var W=U,J=W.next;W.next=null,P===null?w=J:P.next=J,P=W;var oe=a.alternate;oe!==null&&(oe=oe.updateQueue,U=oe.lastBaseUpdate,U!==P&&(U===null?oe.firstBaseUpdate=J:U.next=J,oe.lastBaseUpdate=W))}if(w!==null){var ce=v.baseState;P=0,oe=J=W=null,U=w;do{var re=U.lane,ye=U.eventTime;if((p&re)===re){oe!==null&&(oe=oe.next={eventTime:ye,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ve=a,we=U;switch(re=c,ye=d,we.tag){case 1:if(ve=we.payload,typeof ve=="function"){ce=ve.call(ye,ce,re);break e}ce=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=we.payload,re=typeof ve=="function"?ve.call(ye,ce,re):ve,re==null)break e;ce=ne({},ce,re);break e;case 2:yo=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,re=v.effects,re===null?v.effects=[U]:re.push(U))}else ye={eventTime:ye,lane:re,tag:U.tag,payload:U.payload,callback:U.callback,next:null},oe===null?(J=oe=ye,W=ce):oe=oe.next=ye,P|=re;if(U=U.next,U===null){if(U=v.shared.pending,U===null)break;re=U,U=re.next,re.next=null,v.lastBaseUpdate=re,v.shared.pending=null}}while(!0);if(oe===null&&(W=ce),v.baseState=W,v.firstBaseUpdate=J,v.lastBaseUpdate=oe,c=v.shared.interleaved,c!==null){v=c;do P|=v.lane,v=v.next;while(v!==c)}else w===null&&(v.shared.lanes=0);Pa|=P,a.lanes=P,a.memoizedState=ce}}function LE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var p=a[c],v=p.callback;if(v!==null){if(p.callback=null,p=d,typeof v!="function")throw Error(t(191,v));v.call(p)}}}var fh={},Hr=go(fh),gh=go(fh),mh=go(fh);function Aa(a){if(a===fh)throw Error(t(174));return a}function r_(a,c){switch(vt(mh,c),vt(gh,a),vt(Hr,fh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:tr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=tr(c,a)}Tt(Hr),vt(Hr,c)}function gc(){Tt(Hr),Tt(gh),Tt(mh)}function OE(a){Aa(mh.current);var c=Aa(Hr.current),d=tr(c,a.type);c!==d&&(vt(gh,a),vt(Hr,d))}function s_(a){gh.current===a&&(Tt(Hr),Tt(gh))}var Pt=go(0);function og(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var o_=[];function a_(){for(var a=0;a<o_.length;a++)o_[a]._workInProgressVersionPrimary=null;o_.length=0}var ag=R.ReactCurrentDispatcher,l_=R.ReactCurrentBatchConfig,ba=0,kt=null,Yt=null,sn=null,lg=!1,ph=!1,yh=0,wM=0;function bn(){throw Error(t(321))}function c_(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!sr(a[d],c[d]))return!1;return!0}function u_(a,c,d,p,v,w){if(ba=w,kt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ag.current=a===null||a.memoizedState===null?IM:CM,a=d(p,v),ph){w=0;do{if(ph=!1,yh=0,25<=w)throw Error(t(301));w+=1,sn=Yt=null,c.updateQueue=null,ag.current=RM,a=d(p,v)}while(ph)}if(ag.current=hg,c=Yt!==null&&Yt.next!==null,ba=0,sn=Yt=kt=null,lg=!1,c)throw Error(t(300));return a}function h_(){var a=yh!==0;return yh=0,a}function Xr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?kt.memoizedState=sn=a:sn=sn.next=a,sn}function Ui(){if(Yt===null){var a=kt.alternate;a=a!==null?a.memoizedState:null}else a=Yt.next;var c=sn===null?kt.memoizedState:sn.next;if(c!==null)sn=c,Yt=a;else{if(a===null)throw Error(t(310));Yt=a,a={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},sn===null?kt.memoizedState=sn=a:sn=sn.next=a}return sn}function _h(a,c){return typeof c=="function"?c(a):c}function d_(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=Yt,v=p.baseQueue,w=d.pending;if(w!==null){if(v!==null){var P=v.next;v.next=w.next,w.next=P}p.baseQueue=v=w,d.pending=null}if(v!==null){w=v.next,p=p.baseState;var U=P=null,W=null,J=w;do{var oe=J.lane;if((ba&oe)===oe)W!==null&&(W=W.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),p=J.hasEagerState?J.eagerState:a(p,J.action);else{var ce={lane:oe,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};W===null?(U=W=ce,P=p):W=W.next=ce,kt.lanes|=oe,Pa|=oe}J=J.next}while(J!==null&&J!==w);W===null?P=p:W.next=U,sr(p,c.memoizedState)||(Yn=!0),c.memoizedState=p,c.baseState=P,c.baseQueue=W,d.lastRenderedState=p}if(a=d.interleaved,a!==null){v=a;do w=v.lane,kt.lanes|=w,Pa|=w,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function f_(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=d.dispatch,v=d.pending,w=c.memoizedState;if(v!==null){d.pending=null;var P=v=v.next;do w=a(w,P.action),P=P.next;while(P!==v);sr(w,c.memoizedState)||(Yn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,p]}function FE(){}function VE(a,c){var d=kt,p=Ui(),v=c(),w=!sr(p.memoizedState,v);if(w&&(p.memoizedState=v,Yn=!0),p=p.queue,g_(UE.bind(null,d,p,a),[a]),p.getSnapshot!==c||w||sn!==null&&sn.memoizedState.tag&1){if(d.flags|=2048,vh(9,zE.bind(null,d,p,v,c),void 0,null),on===null)throw Error(t(349));(ba&30)!==0||jE(d,c,v)}return v}function jE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=kt.updateQueue,c===null?(c={lastEffect:null,stores:null},kt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function zE(a,c,d,p){c.value=d,c.getSnapshot=p,BE(c)&&WE(a)}function UE(a,c,d){return d(function(){BE(c)&&WE(a)})}function BE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!sr(a,d)}catch{return!0}}function WE(a){var c=Rs(a,1);c!==null&&ur(c,a,1,-1)}function GE(a){var c=Xr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_h,lastRenderedState:a},c.queue=a,a=a.dispatch=SM.bind(null,kt,a),[c.memoizedState,a]}function vh(a,c,d,p){return a={tag:a,create:c,destroy:d,deps:p,next:null},c=kt.updateQueue,c===null?(c={lastEffect:null,stores:null},kt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(p=d.next,d.next=a,a.next=p,c.lastEffect=a)),a}function $E(){return Ui().memoizedState}function cg(a,c,d,p){var v=Xr();kt.flags|=a,v.memoizedState=vh(1|c,d,void 0,p===void 0?null:p)}function ug(a,c,d,p){var v=Ui();p=p===void 0?null:p;var w=void 0;if(Yt!==null){var P=Yt.memoizedState;if(w=P.destroy,p!==null&&c_(p,P.deps)){v.memoizedState=vh(c,d,w,p);return}}kt.flags|=a,v.memoizedState=vh(1|c,d,w,p)}function KE(a,c){return cg(8390656,8,a,c)}function g_(a,c){return ug(2048,8,a,c)}function HE(a,c){return ug(4,2,a,c)}function XE(a,c){return ug(4,4,a,c)}function qE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function YE(a,c,d){return d=d!=null?d.concat([a]):null,ug(4,4,qE.bind(null,c,a),d)}function m_(){}function ZE(a,c){var d=Ui();c=c===void 0?null:c;var p=d.memoizedState;return p!==null&&c!==null&&c_(c,p[1])?p[0]:(d.memoizedState=[a,c],a)}function QE(a,c){var d=Ui();c=c===void 0?null:c;var p=d.memoizedState;return p!==null&&c!==null&&c_(c,p[1])?p[0]:(a=a(),d.memoizedState=[a,c],a)}function JE(a,c,d){return(ba&21)===0?(a.baseState&&(a.baseState=!1,Yn=!0),a.memoizedState=d):(sr(d,c)||(d=$u(),kt.lanes|=d,Pa|=d,a.baseState=!0),c)}function EM(a,c){var d=Xe;Xe=d!==0&&4>d?d:4,a(!0);var p=l_.transition;l_.transition={};try{a(!1),c()}finally{Xe=d,l_.transition=p}}function eT(){return Ui().memoizedState}function TM(a,c,d){var p=Eo(a);if(d={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null},tT(a))nT(c,d);else if(d=NE(a,c,d,p),d!==null){var v=zn();ur(d,a,p,v),iT(d,c,p)}}function SM(a,c,d){var p=Eo(a),v={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null};if(tT(a))nT(c,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var P=c.lastRenderedState,U=w(P,d);if(v.hasEagerState=!0,v.eagerState=U,sr(U,P)){var W=c.interleaved;W===null?(v.next=v,n_(c)):(v.next=W.next,W.next=v),c.interleaved=v;return}}catch{}d=NE(a,c,v,p),d!==null&&(v=zn(),ur(d,a,p,v),iT(d,c,p))}}function tT(a){var c=a.alternate;return a===kt||c!==null&&c===kt}function nT(a,c){ph=lg=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function iT(a,c,d){if((d&4194240)!==0){var p=c.lanes;p&=a.pendingLanes,d|=p,c.lanes=d,Hu(a,d)}}var hg={readContext:zi,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useInsertionEffect:bn,useLayoutEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useMutableSource:bn,useSyncExternalStore:bn,useId:bn,unstable_isNewReconciler:!1},IM={readContext:zi,useCallback:function(a,c){return Xr().memoizedState=[a,c===void 0?null:c],a},useContext:zi,useEffect:KE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,cg(4194308,4,qE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return cg(4194308,4,a,c)},useInsertionEffect:function(a,c){return cg(4,2,a,c)},useMemo:function(a,c){var d=Xr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var p=Xr();return c=d!==void 0?d(c):c,p.memoizedState=p.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},p.queue=a,a=a.dispatch=TM.bind(null,kt,a),[p.memoizedState,a]},useRef:function(a){var c=Xr();return a={current:a},c.memoizedState=a},useState:GE,useDebugValue:m_,useDeferredValue:function(a){return Xr().memoizedState=a},useTransition:function(){var a=GE(!1),c=a[0];return a=EM.bind(null,a[1]),Xr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var p=kt,v=Xr();if(Ct){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),on===null)throw Error(t(349));(ba&30)!==0||jE(p,c,d)}v.memoizedState=d;var w={value:d,getSnapshot:c};return v.queue=w,KE(UE.bind(null,p,w,a),[a]),p.flags|=2048,vh(9,zE.bind(null,p,w,d,c),void 0,null),d},useId:function(){var a=Xr(),c=on.identifierPrefix;if(Ct){var d=Cs,p=Is;d=(p&~(1<<32-fi(p)-1)).toString(32)+d,c=":"+c+"R"+d,d=yh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=wM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},CM={readContext:zi,useCallback:ZE,useContext:zi,useEffect:g_,useImperativeHandle:YE,useInsertionEffect:HE,useLayoutEffect:XE,useMemo:QE,useReducer:d_,useRef:$E,useState:function(){return d_(_h)},useDebugValue:m_,useDeferredValue:function(a){var c=Ui();return JE(c,Yt.memoizedState,a)},useTransition:function(){var a=d_(_h)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:FE,useSyncExternalStore:VE,useId:eT,unstable_isNewReconciler:!1},RM={readContext:zi,useCallback:ZE,useContext:zi,useEffect:g_,useImperativeHandle:YE,useInsertionEffect:HE,useLayoutEffect:XE,useMemo:QE,useReducer:f_,useRef:$E,useState:function(){return f_(_h)},useDebugValue:m_,useDeferredValue:function(a){var c=Ui();return Yt===null?c.memoizedState=a:JE(c,Yt.memoizedState,a)},useTransition:function(){var a=f_(_h)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:FE,useSyncExternalStore:VE,useId:eT,unstable_isNewReconciler:!1};function ar(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function p_(a,c,d,p){c=a.memoizedState,d=d(p,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var dg={isMounted:function(a){return(a=a._reactInternals)?ir(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var p=zn(),v=Eo(a),w=As(p,v);w.payload=c,d!=null&&(w.callback=d),c=_o(a,w,v),c!==null&&(ur(c,a,v,p),rg(c,a,v))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var p=zn(),v=Eo(a),w=As(p,v);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=_o(a,w,v),c!==null&&(ur(c,a,v,p),rg(c,a,v))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=zn(),p=Eo(a),v=As(d,p);v.tag=2,c!=null&&(v.callback=c),c=_o(a,v,p),c!==null&&(ur(c,a,p,d),rg(c,a,p))}};function rT(a,c,d,p,v,w,P){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,w,P):c.prototype&&c.prototype.isPureReactComponent?!sh(d,p)||!sh(v,w):!0}function sT(a,c,d){var p=!1,v=mo,w=c.contextType;return typeof w=="object"&&w!==null?w=zi(w):(v=qn(c)?Sa:An.current,p=c.contextTypes,w=(p=p!=null)?ac(a,v):mo),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=dg,a.stateNode=c,c._reactInternals=a,p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),c}function oT(a,c,d,p){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,p),c.state!==a&&dg.enqueueReplaceState(c,c.state,null)}function y_(a,c,d,p){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},i_(a);var w=c.contextType;typeof w=="object"&&w!==null?v.context=zi(w):(w=qn(c)?Sa:An.current,v.context=ac(a,w)),v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(p_(a,c,w,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(c=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),c!==v.state&&dg.enqueueReplaceState(v,v.state,null),sg(a,d,v,p),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function mc(a,c){try{var d="",p=c;do d+=xe(p),p=p.return;while(p);var v=d}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:v,digest:null}}function __(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function v_(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var AM=typeof WeakMap=="function"?WeakMap:Map;function aT(a,c,d){d=As(-1,d),d.tag=3,d.payload={element:null};var p=c.value;return d.callback=function(){vg||(vg=!0,M_=p),v_(a,c)},d}function lT(a,c,d){d=As(-1,d),d.tag=3;var p=a.type.getDerivedStateFromError;if(typeof p=="function"){var v=c.value;d.payload=function(){return p(v)},d.callback=function(){v_(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){v_(a,c),typeof p!="function"&&(xo===null?xo=new Set([this]):xo.add(this));var P=c.stack;this.componentDidCatch(c.value,{componentStack:P!==null?P:""})}),d}function cT(a,c,d){var p=a.pingCache;if(p===null){p=a.pingCache=new AM;var v=new Set;p.set(c,v)}else v=p.get(c),v===void 0&&(v=new Set,p.set(c,v));v.has(d)||(v.add(d),a=BM.bind(null,a,c,d),c.then(a,a))}function uT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function hT(a,c,d,p,v){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=As(-1,1),c.tag=2,_o(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var bM=R.ReactCurrentOwner,Yn=!1;function jn(a,c,d,p){c.child=a===null?kE(c,null,d,p):hc(c,a.child,d,p)}function dT(a,c,d,p,v){d=d.render;var w=c.ref;return fc(c,v),p=u_(a,c,d,p,w,v),d=h_(),a!==null&&!Yn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(Ct&&d&&Hy(c),c.flags|=1,jn(a,c,p,v),c.child)}function fT(a,c,d,p,v){if(a===null){var w=d.type;return typeof w=="function"&&!U_(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,gT(a,c,w,p,v)):(a=Ig(d.type,null,p,c,c.mode,v),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&v)===0){var P=w.memoizedProps;if(d=d.compare,d=d!==null?d:sh,d(P,p)&&a.ref===c.ref)return bs(a,c,v)}return c.flags|=1,a=So(w,p),a.ref=c.ref,a.return=c,c.child=a}function gT(a,c,d,p,v){if(a!==null){var w=a.memoizedProps;if(sh(w,p)&&a.ref===c.ref)if(Yn=!1,c.pendingProps=p=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(Yn=!0);else return c.lanes=a.lanes,bs(a,c,v)}return x_(a,c,d,p,v)}function mT(a,c,d){var p=c.pendingProps,v=p.children,w=a!==null?a.memoizedState:null;if(p.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(yc,xi),xi|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,vt(yc,xi),xi|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=w!==null?w.baseLanes:d,vt(yc,xi),xi|=p}else w!==null?(p=w.baseLanes|d,c.memoizedState=null):p=d,vt(yc,xi),xi|=p;return jn(a,c,v,d),c.child}function pT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function x_(a,c,d,p,v){var w=qn(d)?Sa:An.current;return w=ac(c,w),fc(c,v),d=u_(a,c,d,p,w,v),p=h_(),a!==null&&!Yn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(Ct&&p&&Hy(c),c.flags|=1,jn(a,c,d,v),c.child)}function yT(a,c,d,p,v){if(qn(d)){var w=!0;Yf(c)}else w=!1;if(fc(c,v),c.stateNode===null)gg(a,c),sT(c,d,p),y_(c,d,p,v),p=!0;else if(a===null){var P=c.stateNode,U=c.memoizedProps;P.props=U;var W=P.context,J=d.contextType;typeof J=="object"&&J!==null?J=zi(J):(J=qn(d)?Sa:An.current,J=ac(c,J));var oe=d.getDerivedStateFromProps,ce=typeof oe=="function"||typeof P.getSnapshotBeforeUpdate=="function";ce||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(U!==p||W!==J)&&oT(c,P,p,J),yo=!1;var re=c.memoizedState;P.state=re,sg(c,p,P,v),W=c.memoizedState,U!==p||re!==W||Xn.current||yo?(typeof oe=="function"&&(p_(c,d,oe,p),W=c.memoizedState),(U=yo||rT(c,d,U,p,re,W,J))?(ce||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=W),P.props=p,P.state=W,P.context=J,p=U):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{P=c.stateNode,DE(a,c),U=c.memoizedProps,J=c.type===c.elementType?U:ar(c.type,U),P.props=J,ce=c.pendingProps,re=P.context,W=d.contextType,typeof W=="object"&&W!==null?W=zi(W):(W=qn(d)?Sa:An.current,W=ac(c,W));var ye=d.getDerivedStateFromProps;(oe=typeof ye=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(U!==ce||re!==W)&&oT(c,P,p,W),yo=!1,re=c.memoizedState,P.state=re,sg(c,p,P,v);var ve=c.memoizedState;U!==ce||re!==ve||Xn.current||yo?(typeof ye=="function"&&(p_(c,d,ye,p),ve=c.memoizedState),(J=yo||rT(c,d,J,p,re,ve,W)||!1)?(oe||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(p,ve,W),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(p,ve,W)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=ve),P.props=p,P.state=ve,P.context=W,p=J):(typeof P.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),p=!1)}return w_(a,c,d,p,w,v)}function w_(a,c,d,p,v,w){pT(a,c);var P=(c.flags&128)!==0;if(!p&&!P)return v&&EE(c,d,!1),bs(a,c,w);p=c.stateNode,bM.current=c;var U=P&&typeof d.getDerivedStateFromError!="function"?null:p.render();return c.flags|=1,a!==null&&P?(c.child=hc(c,a.child,null,w),c.child=hc(c,null,U,w)):jn(a,c,U,w),c.memoizedState=p.state,v&&EE(c,d,!0),c.child}function _T(a){var c=a.stateNode;c.pendingContext?xE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&xE(a,c.context,!1),r_(a,c.containerInfo)}function vT(a,c,d,p,v){return uc(),Zy(v),c.flags|=256,jn(a,c,d,p),c.child}var E_={dehydrated:null,treeContext:null,retryLane:0};function T_(a){return{baseLanes:a,cachePool:null,transitions:null}}function xT(a,c,d){var p=c.pendingProps,v=Pt.current,w=!1,P=(c.flags&128)!==0,U;if((U=P)||(U=a!==null&&a.memoizedState===null?!1:(v&2)!==0),U?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),vt(Pt,v&1),a===null)return Yy(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(P=p.children,a=p.fallback,w?(p=c.mode,w=c.child,P={mode:"hidden",children:P},(p&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=Cg(P,p,0,null),a=Ma(a,p,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=T_(d),c.memoizedState=E_,a):S_(c,P));if(v=a.memoizedState,v!==null&&(U=v.dehydrated,U!==null))return PM(a,c,P,p,U,v,d);if(w){w=p.fallback,P=c.mode,v=a.child,U=v.sibling;var W={mode:"hidden",children:p.children};return(P&1)===0&&c.child!==v?(p=c.child,p.childLanes=0,p.pendingProps=W,c.deletions=null):(p=So(v,W),p.subtreeFlags=v.subtreeFlags&14680064),U!==null?w=So(U,w):(w=Ma(w,P,d,null),w.flags|=2),w.return=c,p.return=c,p.sibling=w,c.child=p,p=w,w=c.child,P=a.child.memoizedState,P=P===null?T_(d):{baseLanes:P.baseLanes|d,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=a.childLanes&~d,c.memoizedState=E_,p}return w=a.child,a=w.sibling,p=So(w,{mode:"visible",children:p.children}),(c.mode&1)===0&&(p.lanes=d),p.return=c,p.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=p,c.memoizedState=null,p}function S_(a,c){return c=Cg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function fg(a,c,d,p){return p!==null&&Zy(p),hc(c,a.child,null,d),a=S_(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function PM(a,c,d,p,v,w,P){if(d)return c.flags&256?(c.flags&=-257,p=__(Error(t(422))),fg(a,c,P,p)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=p.fallback,v=c.mode,p=Cg({mode:"visible",children:p.children},v,0,null),w=Ma(w,v,P,null),w.flags|=2,p.return=c,w.return=c,p.sibling=w,c.child=p,(c.mode&1)!==0&&hc(c,a.child,null,P),c.child.memoizedState=T_(P),c.memoizedState=E_,w);if((c.mode&1)===0)return fg(a,c,P,null);if(v.data==="$!"){if(p=v.nextSibling&&v.nextSibling.dataset,p)var U=p.dgst;return p=U,w=Error(t(419)),p=__(w,p,void 0),fg(a,c,P,p)}if(U=(P&a.childLanes)!==0,Yn||U){if(p=on,p!==null){switch(P&-P){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(p.suspendedLanes|P))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,Rs(a,v),ur(p,a,v,-1))}return z_(),p=__(Error(t(421))),fg(a,c,P,p)}return v.data==="$?"?(c.flags|=128,c.child=a.child,c=WM.bind(null,a),v._reactRetry=c,null):(a=w.treeContext,vi=fo(v.nextSibling),_i=c,Ct=!0,or=null,a!==null&&(Vi[ji++]=Is,Vi[ji++]=Cs,Vi[ji++]=Ia,Is=a.id,Cs=a.overflow,Ia=c),c=S_(c,p.children),c.flags|=4096,c)}function wT(a,c,d){a.lanes|=c;var p=a.alternate;p!==null&&(p.lanes|=c),t_(a.return,c,d)}function I_(a,c,d,p,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:v}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=d,w.tailMode=v)}function ET(a,c,d){var p=c.pendingProps,v=p.revealOrder,w=p.tail;if(jn(a,c,p.children,d),p=Pt.current,(p&2)!==0)p=p&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&wT(a,d,c);else if(a.tag===19)wT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}p&=1}if(vt(Pt,p),(c.mode&1)===0)c.memoizedState=null;else switch(v){case"forwards":for(d=c.child,v=null;d!==null;)a=d.alternate,a!==null&&og(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=c.child,c.child=null):(v=d.sibling,d.sibling=null),I_(c,!1,v,d,w);break;case"backwards":for(d=null,v=c.child,c.child=null;v!==null;){if(a=v.alternate,a!==null&&og(a)===null){c.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}I_(c,!0,d,null,w);break;case"together":I_(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function gg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function bs(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),Pa|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=So(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=So(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function kM(a,c,d){switch(c.tag){case 3:_T(c),uc();break;case 5:OE(c);break;case 1:qn(c.type)&&Yf(c);break;case 4:r_(c,c.stateNode.containerInfo);break;case 10:var p=c.type._context,v=c.memoizedProps.value;vt(ng,p._currentValue),p._currentValue=v;break;case 13:if(p=c.memoizedState,p!==null)return p.dehydrated!==null?(vt(Pt,Pt.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?xT(a,c,d):(vt(Pt,Pt.current&1),a=bs(a,c,d),a!==null?a.sibling:null);vt(Pt,Pt.current&1);break;case 19:if(p=(d&c.childLanes)!==0,(a.flags&128)!==0){if(p)return ET(a,c,d);c.flags|=128}if(v=c.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),vt(Pt,Pt.current),p)break;return null;case 22:case 23:return c.lanes=0,mT(a,c,d)}return bs(a,c,d)}var TT,C_,ST,IT;TT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},C_=function(){},ST=function(a,c,d,p){var v=a.memoizedProps;if(v!==p){a=c.stateNode,Aa(Hr.current);var w=null;switch(d){case"input":v=Kn(a,v),p=Kn(a,p),w=[];break;case"select":v=ne({},v,{value:void 0}),p=ne({},p,{value:void 0}),w=[];break;case"textarea":v=ki(a,v),p=ki(a,p),w=[];break;default:typeof v.onClick!="function"&&typeof p.onClick=="function"&&(a.onclick=Hf)}On(d,p);var P;d=null;for(J in v)if(!p.hasOwnProperty(J)&&v.hasOwnProperty(J)&&v[J]!=null)if(J==="style"){var U=v[J];for(P in U)U.hasOwnProperty(P)&&(d||(d={}),d[P]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?w||(w=[]):(w=w||[]).push(J,null));for(J in p){var W=p[J];if(U=v?.[J],p.hasOwnProperty(J)&&W!==U&&(W!=null||U!=null))if(J==="style")if(U){for(P in U)!U.hasOwnProperty(P)||W&&W.hasOwnProperty(P)||(d||(d={}),d[P]="");for(P in W)W.hasOwnProperty(P)&&U[P]!==W[P]&&(d||(d={}),d[P]=W[P])}else d||(w||(w=[]),w.push(J,d)),d=W;else J==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,U=U?U.__html:void 0,W!=null&&U!==W&&(w=w||[]).push(J,W)):J==="children"?typeof W!="string"&&typeof W!="number"||(w=w||[]).push(J,""+W):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(r.hasOwnProperty(J)?(W!=null&&J==="onScroll"&&Et("scroll",a),w||U===W||(w=[])):(w=w||[]).push(J,W))}d&&(w=w||[]).push("style",d);var J=w;(c.updateQueue=J)&&(c.flags|=4)}},IT=function(a,c,d,p){d!==p&&(c.flags|=4)};function xh(a,c){if(!Ct)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function Pn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,p=0;if(c)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,p|=v.subtreeFlags&14680064,p|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=p,a.childLanes=d,c}function NM(a,c,d){var p=c.pendingProps;switch(Xy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(c),null;case 1:return qn(c.type)&&qf(),Pn(c),null;case 3:return p=c.stateNode,gc(),Tt(Xn),Tt(An),a_(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(eg(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,or!==null&&(F_(or),or=null))),C_(a,c),Pn(c),null;case 5:s_(c);var v=Aa(mh.current);if(d=c.type,a!==null&&c.stateNode!=null)ST(a,c,d,p,v),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!p){if(c.stateNode===null)throw Error(t(166));return Pn(c),null}if(a=Aa(Hr.current),eg(c)){p=c.stateNode,d=c.type;var w=c.memoizedProps;switch(p[Kr]=c,p[uh]=w,a=(c.mode&1)!==0,d){case"dialog":Et("cancel",p),Et("close",p);break;case"iframe":case"object":case"embed":Et("load",p);break;case"video":case"audio":for(v=0;v<ah.length;v++)Et(ah[v],p);break;case"source":Et("error",p);break;case"img":case"image":case"link":Et("error",p),Et("load",p);break;case"details":Et("toggle",p);break;case"input":hn(p,w),Et("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!w.multiple},Et("invalid",p);break;case"textarea":It(p,w),Et("invalid",p)}On(d,w),v=null;for(var P in w)if(w.hasOwnProperty(P)){var U=w[P];P==="children"?typeof U=="string"?p.textContent!==U&&(w.suppressHydrationWarning!==!0&&Kf(p.textContent,U,a),v=["children",U]):typeof U=="number"&&p.textContent!==""+U&&(w.suppressHydrationWarning!==!0&&Kf(p.textContent,U,a),v=["children",""+U]):r.hasOwnProperty(P)&&U!=null&&P==="onScroll"&&Et("scroll",p)}switch(d){case"input":er(p),Pi(p,w,!0);break;case"textarea":er(p),Ni(p);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(p.onclick=Hf)}p=v,c.updateQueue=p,p!==null&&(c.flags|=4)}else{P=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Ar(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=P.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof p.is=="string"?a=P.createElement(d,{is:p.is}):(a=P.createElement(d),d==="select"&&(P=a,p.multiple?P.multiple=!0:p.size&&(P.size=p.size))):a=P.createElementNS(a,d),a[Kr]=c,a[uh]=p,TT(a,c,!1,!1),c.stateNode=a;e:{switch(P=ms(d,p),d){case"dialog":Et("cancel",a),Et("close",a),v=p;break;case"iframe":case"object":case"embed":Et("load",a),v=p;break;case"video":case"audio":for(v=0;v<ah.length;v++)Et(ah[v],a);v=p;break;case"source":Et("error",a),v=p;break;case"img":case"image":case"link":Et("error",a),Et("load",a),v=p;break;case"details":Et("toggle",a),v=p;break;case"input":hn(a,p),v=Kn(a,p),Et("invalid",a);break;case"option":v=p;break;case"select":a._wrapperState={wasMultiple:!!p.multiple},v=ne({},p,{value:void 0}),Et("invalid",a);break;case"textarea":It(a,p),v=ki(a,p),Et("invalid",a);break;default:v=p}On(d,v),U=v;for(w in U)if(U.hasOwnProperty(w)){var W=U[w];w==="style"?gs(a,W):w==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,W!=null&&ua(a,W)):w==="children"?typeof W=="string"?(d!=="textarea"||W!=="")&&Pr(a,W):typeof W=="number"&&Pr(a,""+W):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?W!=null&&w==="onScroll"&&Et("scroll",a):W!=null&&M(a,w,W,P))}switch(d){case"input":er(a),Pi(a,p,!1);break;case"textarea":er(a),Ni(a);break;case"option":p.value!=null&&a.setAttribute("value",""+je(p.value));break;case"select":a.multiple=!!p.multiple,w=p.value,w!=null?nn(a,!!p.multiple,w,!1):p.defaultValue!=null&&nn(a,!!p.multiple,p.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=Hf)}switch(d){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Pn(c),null;case 6:if(a&&c.stateNode!=null)IT(a,c,a.memoizedProps,p);else{if(typeof p!="string"&&c.stateNode===null)throw Error(t(166));if(d=Aa(mh.current),Aa(Hr.current),eg(c)){if(p=c.stateNode,d=c.memoizedProps,p[Kr]=c,(w=p.nodeValue!==d)&&(a=_i,a!==null))switch(a.tag){case 3:Kf(p.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Kf(p.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else p=(d.nodeType===9?d:d.ownerDocument).createTextNode(p),p[Kr]=c,c.stateNode=p}return Pn(c),null;case 13:if(Tt(Pt),p=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ct&&vi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)AE(),uc(),c.flags|=98560,w=!1;else if(w=eg(c),p!==null&&p.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[Kr]=c}else uc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Pn(c),w=!1}else or!==null&&(F_(or),or=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(p=p!==null,p!==(a!==null&&a.memoizedState!==null)&&p&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(Pt.current&1)!==0?Zt===0&&(Zt=3):z_())),c.updateQueue!==null&&(c.flags|=4),Pn(c),null);case 4:return gc(),C_(a,c),a===null&&lh(c.stateNode.containerInfo),Pn(c),null;case 10:return e_(c.type._context),Pn(c),null;case 17:return qn(c.type)&&qf(),Pn(c),null;case 19:if(Tt(Pt),w=c.memoizedState,w===null)return Pn(c),null;if(p=(c.flags&128)!==0,P=w.rendering,P===null)if(p)xh(w,!1);else{if(Zt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(P=og(a),P!==null){for(c.flags|=128,xh(w,!1),p=P.updateQueue,p!==null&&(c.updateQueue=p,c.flags|=4),c.subtreeFlags=0,p=d,d=c.child;d!==null;)w=d,a=p,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,a=P.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return vt(Pt,Pt.current&1|2),c.child}a=a.sibling}w.tail!==null&&wt()>_c&&(c.flags|=128,p=!0,xh(w,!1),c.lanes=4194304)}else{if(!p)if(a=og(P),a!==null){if(c.flags|=128,p=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),xh(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Ct)return Pn(c),null}else 2*wt()-w.renderingStartTime>_c&&d!==1073741824&&(c.flags|=128,p=!0,xh(w,!1),c.lanes=4194304);w.isBackwards?(P.sibling=c.child,c.child=P):(d=w.last,d!==null?d.sibling=P:c.child=P,w.last=P)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=wt(),c.sibling=null,d=Pt.current,vt(Pt,p?d&1|2:d&1),c):(Pn(c),null);case 22:case 23:return j_(),p=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==p&&(c.flags|=8192),p&&(c.mode&1)!==0?(xi&1073741824)!==0&&(Pn(c),c.subtreeFlags&6&&(c.flags|=8192)):Pn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function DM(a,c){switch(Xy(c),c.tag){case 1:return qn(c.type)&&qf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return gc(),Tt(Xn),Tt(An),a_(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return s_(c),null;case 13:if(Tt(Pt),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));uc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Tt(Pt),null;case 4:return gc(),null;case 10:return e_(c.type._context),null;case 22:case 23:return j_(),null;case 24:return null;default:return null}}var mg=!1,kn=!1,MM=typeof WeakSet=="function"?WeakSet:Set,_e=null;function pc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(p){Mt(a,c,p)}else d.current=null}function R_(a,c,d){try{d()}catch(p){Mt(a,c,p)}}var CT=!1;function LM(a,c){if(jy=xs,a=rE(),ky(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var v=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var P=0,U=-1,W=-1,J=0,oe=0,ce=a,re=null;t:for(;;){for(var ye;ce!==d||v!==0&&ce.nodeType!==3||(U=P+v),ce!==w||p!==0&&ce.nodeType!==3||(W=P+p),ce.nodeType===3&&(P+=ce.nodeValue.length),(ye=ce.firstChild)!==null;)re=ce,ce=ye;for(;;){if(ce===a)break t;if(re===d&&++J===v&&(U=P),re===w&&++oe===p&&(W=P),(ye=ce.nextSibling)!==null)break;ce=re,re=ce.parentNode}ce=ye}d=U===-1||W===-1?null:{start:U,end:W}}else d=null}d=d||{start:0,end:0}}else d=null;for(zy={focusedElem:a,selectionRange:d},xs=!1,_e=c;_e!==null;)if(c=_e,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,_e=a;else for(;_e!==null;){c=_e;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var we=ve.memoizedProps,zt=ve.memoizedState,X=c.stateNode,K=X.getSnapshotBeforeUpdate(c.elementType===c.type?we:ar(c.type,we),zt);X.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Mt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,_e=a;break}_e=c.return}return ve=CT,CT=!1,ve}function wh(a,c,d){var p=c.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var v=p=p.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&R_(c,d,w)}v=v.next}while(v!==p)}}function pg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var p=d.create;d.destroy=p()}d=d.next}while(d!==c)}}function A_(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function RT(a){var c=a.alternate;c!==null&&(a.alternate=null,RT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Kr],delete c[uh],delete c[Gy],delete c[yM],delete c[_M])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function AT(a){return a.tag===5||a.tag===3||a.tag===4}function bT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||AT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function b_(a,c,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Hf));else if(p!==4&&(a=a.child,a!==null))for(b_(a,c,d),a=a.sibling;a!==null;)b_(a,c,d),a=a.sibling}function P_(a,c,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(p!==4&&(a=a.child,a!==null))for(P_(a,c,d),a=a.sibling;a!==null;)P_(a,c,d),a=a.sibling}var _n=null,lr=!1;function vo(a,c,d){for(d=d.child;d!==null;)PT(a,c,d),d=d.sibling}function PT(a,c,d){if(di&&typeof di.onCommitFiberUnmount=="function")try{di.onCommitFiberUnmount(ga,d)}catch{}switch(d.tag){case 5:kn||pc(d,c);case 6:var p=_n,v=lr;_n=null,vo(a,c,d),_n=p,lr=v,_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?Wy(a.parentNode,d):a.nodeType===1&&Wy(a,d),lo(a)):Wy(_n,d.stateNode));break;case 4:p=_n,v=lr,_n=d.stateNode.containerInfo,lr=!0,vo(a,c,d),_n=p,lr=v;break;case 0:case 11:case 14:case 15:if(!kn&&(p=d.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){v=p=p.next;do{var w=v,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&R_(d,c,P),v=v.next}while(v!==p)}vo(a,c,d);break;case 1:if(!kn&&(pc(d,c),p=d.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=d.memoizedProps,p.state=d.memoizedState,p.componentWillUnmount()}catch(U){Mt(d,c,U)}vo(a,c,d);break;case 21:vo(a,c,d);break;case 22:d.mode&1?(kn=(p=kn)||d.memoizedState!==null,vo(a,c,d),kn=p):vo(a,c,d);break;default:vo(a,c,d)}}function kT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new MM),c.forEach(function(p){var v=GM.bind(null,a,p);d.has(p)||(d.add(p),p.then(v,v))})}}function cr(a,c){var d=c.deletions;if(d!==null)for(var p=0;p<d.length;p++){var v=d[p];try{var w=a,P=c,U=P;e:for(;U!==null;){switch(U.tag){case 5:_n=U.stateNode,lr=!1;break e;case 3:_n=U.stateNode.containerInfo,lr=!0;break e;case 4:_n=U.stateNode.containerInfo,lr=!0;break e}U=U.return}if(_n===null)throw Error(t(160));PT(w,P,v),_n=null,lr=!1;var W=v.alternate;W!==null&&(W.return=null),v.return=null}catch(J){Mt(v,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)NT(c,a),c=c.sibling}function NT(a,c){var d=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(cr(c,a),qr(a),p&4){try{wh(3,a,a.return),pg(3,a)}catch(we){Mt(a,a.return,we)}try{wh(5,a,a.return)}catch(we){Mt(a,a.return,we)}}break;case 1:cr(c,a),qr(a),p&512&&d!==null&&pc(d,d.return);break;case 5:if(cr(c,a),qr(a),p&512&&d!==null&&pc(d,d.return),a.flags&32){var v=a.stateNode;try{Pr(v,"")}catch(we){Mt(a,a.return,we)}}if(p&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,P=d!==null?d.memoizedProps:w,U=a.type,W=a.updateQueue;if(a.updateQueue=null,W!==null)try{U==="input"&&w.type==="radio"&&w.name!=null&&dn(v,w),ms(U,P);var J=ms(U,w);for(P=0;P<W.length;P+=2){var oe=W[P],ce=W[P+1];oe==="style"?gs(v,ce):oe==="dangerouslySetInnerHTML"?ua(v,ce):oe==="children"?Pr(v,ce):M(v,oe,ce,J)}switch(U){case"input":Hn(v,w);break;case"textarea":no(v,w);break;case"select":var re=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ye=w.value;ye!=null?nn(v,!!w.multiple,ye,!1):re!==!!w.multiple&&(w.defaultValue!=null?nn(v,!!w.multiple,w.defaultValue,!0):nn(v,!!w.multiple,w.multiple?[]:"",!1))}v[uh]=w}catch(we){Mt(a,a.return,we)}}break;case 6:if(cr(c,a),qr(a),p&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(we){Mt(a,a.return,we)}}break;case 3:if(cr(c,a),qr(a),p&4&&d!==null&&d.memoizedState.isDehydrated)try{lo(c.containerInfo)}catch(we){Mt(a,a.return,we)}break;case 4:cr(c,a),qr(a);break;case 13:cr(c,a),qr(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(D_=wt())),p&4&&kT(a);break;case 22:if(oe=d!==null&&d.memoizedState!==null,a.mode&1?(kn=(J=kn)||oe,cr(c,a),kn=J):cr(c,a),qr(a),p&8192){if(J=a.memoizedState!==null,(a.stateNode.isHidden=J)&&!oe&&(a.mode&1)!==0)for(_e=a,oe=a.child;oe!==null;){for(ce=_e=oe;_e!==null;){switch(re=_e,ye=re.child,re.tag){case 0:case 11:case 14:case 15:wh(4,re,re.return);break;case 1:pc(re,re.return);var ve=re.stateNode;if(typeof ve.componentWillUnmount=="function"){p=re,d=re.return;try{c=p,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(we){Mt(p,d,we)}}break;case 5:pc(re,re.return);break;case 22:if(re.memoizedState!==null){LT(ce);continue}}ye!==null?(ye.return=re,_e=ye):LT(ce)}oe=oe.sibling}e:for(oe=null,ce=a;;){if(ce.tag===5){if(oe===null){oe=ce;try{v=ce.stateNode,J?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(U=ce.stateNode,W=ce.memoizedProps.style,P=W!=null&&W.hasOwnProperty("display")?W.display:null,U.style.display=kr("display",P))}catch(we){Mt(a,a.return,we)}}}else if(ce.tag===6){if(oe===null)try{ce.stateNode.nodeValue=J?"":ce.memoizedProps}catch(we){Mt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;oe===ce&&(oe=null),ce=ce.return}oe===ce&&(oe=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:cr(c,a),qr(a),p&4&&kT(a);break;case 21:break;default:cr(c,a),qr(a)}}function qr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(AT(d)){var p=d;break e}d=d.return}throw Error(t(160))}switch(p.tag){case 5:var v=p.stateNode;p.flags&32&&(Pr(v,""),p.flags&=-33);var w=bT(a);P_(a,w,v);break;case 3:case 4:var P=p.stateNode.containerInfo,U=bT(a);b_(a,U,P);break;default:throw Error(t(161))}}catch(W){Mt(a,a.return,W)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function OM(a,c,d){_e=a,DT(a)}function DT(a,c,d){for(var p=(a.mode&1)!==0;_e!==null;){var v=_e,w=v.child;if(v.tag===22&&p){var P=v.memoizedState!==null||mg;if(!P){var U=v.alternate,W=U!==null&&U.memoizedState!==null||kn;U=mg;var J=kn;if(mg=P,(kn=W)&&!J)for(_e=v;_e!==null;)P=_e,W=P.child,P.tag===22&&P.memoizedState!==null?OT(v):W!==null?(W.return=P,_e=W):OT(v);for(;w!==null;)_e=w,DT(w),w=w.sibling;_e=v,mg=U,kn=J}MT(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,_e=w):MT(a)}}function MT(a){for(;_e!==null;){var c=_e;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:kn||pg(5,c);break;case 1:var p=c.stateNode;if(c.flags&4&&!kn)if(d===null)p.componentDidMount();else{var v=c.elementType===c.type?d.memoizedProps:ar(c.type,d.memoizedProps);p.componentDidUpdate(v,d.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&LE(c,w,p);break;case 3:var P=c.updateQueue;if(P!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}LE(c,P,d)}break;case 5:var U=c.stateNode;if(d===null&&c.flags&4){d=U;var W=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":W.autoFocus&&d.focus();break;case"img":W.src&&(d.src=W.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var oe=J.memoizedState;if(oe!==null){var ce=oe.dehydrated;ce!==null&&lo(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}kn||c.flags&512&&A_(c)}catch(re){Mt(c,c.return,re)}}if(c===a){_e=null;break}if(d=c.sibling,d!==null){d.return=c.return,_e=d;break}_e=c.return}}function LT(a){for(;_e!==null;){var c=_e;if(c===a){_e=null;break}var d=c.sibling;if(d!==null){d.return=c.return,_e=d;break}_e=c.return}}function OT(a){for(;_e!==null;){var c=_e;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{pg(4,c)}catch(W){Mt(c,d,W)}break;case 1:var p=c.stateNode;if(typeof p.componentDidMount=="function"){var v=c.return;try{p.componentDidMount()}catch(W){Mt(c,v,W)}}var w=c.return;try{A_(c)}catch(W){Mt(c,w,W)}break;case 5:var P=c.return;try{A_(c)}catch(W){Mt(c,P,W)}}}catch(W){Mt(c,c.return,W)}if(c===a){_e=null;break}var U=c.sibling;if(U!==null){U.return=c.return,_e=U;break}_e=c.return}}var FM=Math.ceil,yg=R.ReactCurrentDispatcher,k_=R.ReactCurrentOwner,Bi=R.ReactCurrentBatchConfig,et=0,on=null,$t=null,vn=0,xi=0,yc=go(0),Zt=0,Eh=null,Pa=0,_g=0,N_=0,Th=null,Zn=null,D_=0,_c=1/0,Ps=null,vg=!1,M_=null,xo=null,xg=!1,wo=null,wg=0,Sh=0,L_=null,Eg=-1,Tg=0;function zn(){return(et&6)!==0?wt():Eg!==-1?Eg:Eg=wt()}function Eo(a){return(a.mode&1)===0?1:(et&2)!==0&&vn!==0?vn&-vn:xM.transition!==null?(Tg===0&&(Tg=$u()),Tg):(a=Xe,a!==0||(a=window.event,a=a===void 0?16:Hl(a.type)),a)}function ur(a,c,d,p){if(50<Sh)throw Sh=0,L_=null,Error(t(185));_a(a,d,p),((et&2)===0||a!==on)&&(a===on&&((et&2)===0&&(_g|=d),Zt===4&&To(a,vn)),Qn(a,p),d===1&&et===0&&(c.mode&1)===0&&(_c=wt()+500,Zf&&po()))}function Qn(a,c){var d=a.callbackNode;ya(a,c);var p=ys(a,a===on?vn:0);if(p===0)d!==null&&zl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=p&-p,a.callbackPriority!==c){if(d!=null&&zl(d),c===1)a.tag===0?vM(VT.bind(null,a)):TE(VT.bind(null,a)),mM(function(){(et&6)===0&&po()}),d=null;else{switch(Or(p)){case 1:d=Ul;break;case 4:d=Bu;break;case 16:d=fa;break;case 536870912:d=Bl;break;default:d=fa}d=KT(d,FT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function FT(a,c){if(Eg=-1,Tg=0,(et&6)!==0)throw Error(t(327));var d=a.callbackNode;if(vc()&&a.callbackNode!==d)return null;var p=ys(a,a===on?vn:0);if(p===0)return null;if((p&30)!==0||(p&a.expiredLanes)!==0||c)c=Sg(a,p);else{c=p;var v=et;et|=2;var w=zT();(on!==a||vn!==c)&&(Ps=null,_c=wt()+500,Na(a,c));do try{zM();break}catch(U){jT(a,U)}while(!0);Jy(),yg.current=w,et=v,$t!==null?c=0:(on=null,vn=0,c=Zt)}if(c!==0){if(c===2&&(v=Gu(a),v!==0&&(p=v,c=O_(a,v))),c===1)throw d=Eh,Na(a,0),To(a,p),Qn(a,wt()),d;if(c===6)To(a,p);else{if(v=a.current.alternate,(p&30)===0&&!VM(v)&&(c=Sg(a,p),c===2&&(w=Gu(a),w!==0&&(p=w,c=O_(a,w))),c===1))throw d=Eh,Na(a,0),To(a,p),Qn(a,wt()),d;switch(a.finishedWork=v,a.finishedLanes=p,c){case 0:case 1:throw Error(t(345));case 2:Da(a,Zn,Ps);break;case 3:if(To(a,p),(p&130023424)===p&&(c=D_+500-wt(),10<c)){if(ys(a,0)!==0)break;if(v=a.suspendedLanes,(v&p)!==p){zn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=By(Da.bind(null,a,Zn,Ps),c);break}Da(a,Zn,Ps);break;case 4:if(To(a,p),(p&4194240)===p)break;for(c=a.eventTimes,v=-1;0<p;){var P=31-fi(p);w=1<<P,P=c[P],P>v&&(v=P),p&=~w}if(p=v,p=wt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*FM(p/1960))-p,10<p){a.timeoutHandle=By(Da.bind(null,a,Zn,Ps),p);break}Da(a,Zn,Ps);break;case 5:Da(a,Zn,Ps);break;default:throw Error(t(329))}}}return Qn(a,wt()),a.callbackNode===d?FT.bind(null,a):null}function O_(a,c){var d=Th;return a.current.memoizedState.isDehydrated&&(Na(a,c).flags|=256),a=Sg(a,c),a!==2&&(c=Zn,Zn=d,c!==null&&F_(c)),a}function F_(a){Zn===null?Zn=a:Zn.push.apply(Zn,a)}function VM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var p=0;p<d.length;p++){var v=d[p],w=v.getSnapshot;v=v.value;try{if(!sr(w(),v))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function To(a,c){for(c&=~N_,c&=~_g,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-fi(c),p=1<<d;a[d]=-1,c&=~p}}function VT(a){if((et&6)!==0)throw Error(t(327));vc();var c=ys(a,0);if((c&1)===0)return Qn(a,wt()),null;var d=Sg(a,c);if(a.tag!==0&&d===2){var p=Gu(a);p!==0&&(c=p,d=O_(a,p))}if(d===1)throw d=Eh,Na(a,0),To(a,c),Qn(a,wt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Da(a,Zn,Ps),Qn(a,wt()),null}function V_(a,c){var d=et;et|=1;try{return a(c)}finally{et=d,et===0&&(_c=wt()+500,Zf&&po())}}function ka(a){wo!==null&&wo.tag===0&&(et&6)===0&&vc();var c=et;et|=1;var d=Bi.transition,p=Xe;try{if(Bi.transition=null,Xe=1,a)return a()}finally{Xe=p,Bi.transition=d,et=c,(et&6)===0&&po()}}function j_(){xi=yc.current,Tt(yc)}function Na(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,gM(d)),$t!==null)for(d=$t.return;d!==null;){var p=d;switch(Xy(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&qf();break;case 3:gc(),Tt(Xn),Tt(An),a_();break;case 5:s_(p);break;case 4:gc();break;case 13:Tt(Pt);break;case 19:Tt(Pt);break;case 10:e_(p.type._context);break;case 22:case 23:j_()}d=d.return}if(on=a,$t=a=So(a.current,null),vn=xi=c,Zt=0,Eh=null,N_=_g=Pa=0,Zn=Th=null,Ra!==null){for(c=0;c<Ra.length;c++)if(d=Ra[c],p=d.interleaved,p!==null){d.interleaved=null;var v=p.next,w=d.pending;if(w!==null){var P=w.next;w.next=v,p.next=P}d.pending=p}Ra=null}return a}function jT(a,c){do{var d=$t;try{if(Jy(),ag.current=hg,lg){for(var p=kt.memoizedState;p!==null;){var v=p.queue;v!==null&&(v.pending=null),p=p.next}lg=!1}if(ba=0,sn=Yt=kt=null,ph=!1,yh=0,k_.current=null,d===null||d.return===null){Zt=1,Eh=c,$t=null;break}e:{var w=a,P=d.return,U=d,W=c;if(c=vn,U.flags|=32768,W!==null&&typeof W=="object"&&typeof W.then=="function"){var J=W,oe=U,ce=oe.tag;if((oe.mode&1)===0&&(ce===0||ce===11||ce===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ye=uT(P);if(ye!==null){ye.flags&=-257,hT(ye,P,U,w,c),ye.mode&1&&cT(w,J,c),c=ye,W=J;var ve=c.updateQueue;if(ve===null){var we=new Set;we.add(W),c.updateQueue=we}else ve.add(W);break e}else{if((c&1)===0){cT(w,J,c),z_();break e}W=Error(t(426))}}else if(Ct&&U.mode&1){var zt=uT(P);if(zt!==null){(zt.flags&65536)===0&&(zt.flags|=256),hT(zt,P,U,w,c),Zy(mc(W,U));break e}}w=W=mc(W,U),Zt!==4&&(Zt=2),Th===null?Th=[w]:Th.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var X=aT(w,W,c);ME(w,X);break e;case 1:U=W;var K=w.type,Y=w.stateNode;if((w.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(xo===null||!xo.has(Y)))){w.flags|=65536,c&=-c,w.lanes|=c;var he=lT(w,U,c);ME(w,he);break e}}w=w.return}while(w!==null)}BT(d)}catch(Te){c=Te,$t===d&&d!==null&&($t=d=d.return);continue}break}while(!0)}function zT(){var a=yg.current;return yg.current=hg,a===null?hg:a}function z_(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),on===null||(Pa&268435455)===0&&(_g&268435455)===0||To(on,vn)}function Sg(a,c){var d=et;et|=2;var p=zT();(on!==a||vn!==c)&&(Ps=null,Na(a,c));do try{jM();break}catch(v){jT(a,v)}while(!0);if(Jy(),et=d,yg.current=p,$t!==null)throw Error(t(261));return on=null,vn=0,Zt}function jM(){for(;$t!==null;)UT($t)}function zM(){for(;$t!==null&&!da();)UT($t)}function UT(a){var c=$T(a.alternate,a,xi);a.memoizedProps=a.pendingProps,c===null?BT(a):$t=c,k_.current=null}function BT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=NM(d,c,xi),d!==null){$t=d;return}}else{if(d=DM(d,c),d!==null){d.flags&=32767,$t=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Zt=6,$t=null;return}}if(c=c.sibling,c!==null){$t=c;return}$t=c=a}while(c!==null);Zt===0&&(Zt=5)}function Da(a,c,d){var p=Xe,v=Bi.transition;try{Bi.transition=null,Xe=1,UM(a,c,d,p)}finally{Bi.transition=v,Xe=p}return null}function UM(a,c,d,p){do vc();while(wo!==null);if((et&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if(Cy(a,w),a===on&&($t=on=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||xg||(xg=!0,KT(fa,function(){return vc(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=Bi.transition,Bi.transition=null;var P=Xe;Xe=1;var U=et;et|=4,k_.current=null,LM(a,d),NT(d,a),aM(zy),xs=!!jy,zy=jy=null,a.current=d,OM(d),ps(),et=U,Xe=P,Bi.transition=w}else a.current=d;if(xg&&(xg=!1,wo=a,wg=v),w=a.pendingLanes,w===0&&(xo=null),kf(d.stateNode),Qn(a,wt()),c!==null)for(p=a.onRecoverableError,d=0;d<c.length;d++)v=c[d],p(v.value,{componentStack:v.stack,digest:v.digest});if(vg)throw vg=!1,a=M_,M_=null,a;return(wg&1)!==0&&a.tag!==0&&vc(),w=a.pendingLanes,(w&1)!==0?a===L_?Sh++:(Sh=0,L_=a):Sh=0,po(),null}function vc(){if(wo!==null){var a=Or(wg),c=Bi.transition,d=Xe;try{if(Bi.transition=null,Xe=16>a?16:a,wo===null)var p=!1;else{if(a=wo,wo=null,wg=0,(et&6)!==0)throw Error(t(331));var v=et;for(et|=4,_e=a.current;_e!==null;){var w=_e,P=w.child;if((_e.flags&16)!==0){var U=w.deletions;if(U!==null){for(var W=0;W<U.length;W++){var J=U[W];for(_e=J;_e!==null;){var oe=_e;switch(oe.tag){case 0:case 11:case 15:wh(8,oe,w)}var ce=oe.child;if(ce!==null)ce.return=oe,_e=ce;else for(;_e!==null;){oe=_e;var re=oe.sibling,ye=oe.return;if(RT(oe),oe===J){_e=null;break}if(re!==null){re.return=ye,_e=re;break}_e=ye}}}var ve=w.alternate;if(ve!==null){var we=ve.child;if(we!==null){ve.child=null;do{var zt=we.sibling;we.sibling=null,we=zt}while(we!==null)}}_e=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,_e=P;else e:for(;_e!==null;){if(w=_e,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:wh(9,w,w.return)}var X=w.sibling;if(X!==null){X.return=w.return,_e=X;break e}_e=w.return}}var K=a.current;for(_e=K;_e!==null;){P=_e;var Y=P.child;if((P.subtreeFlags&2064)!==0&&Y!==null)Y.return=P,_e=Y;else e:for(P=K;_e!==null;){if(U=_e,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:pg(9,U)}}catch(Te){Mt(U,U.return,Te)}if(U===P){_e=null;break e}var he=U.sibling;if(he!==null){he.return=U.return,_e=he;break e}_e=U.return}}if(et=v,po(),di&&typeof di.onPostCommitFiberRoot=="function")try{di.onPostCommitFiberRoot(ga,a)}catch{}p=!0}return p}finally{Xe=d,Bi.transition=c}}return!1}function WT(a,c,d){c=mc(d,c),c=aT(a,c,1),a=_o(a,c,1),c=zn(),a!==null&&(_a(a,1,c),Qn(a,c))}function Mt(a,c,d){if(a.tag===3)WT(a,a,d);else for(;c!==null;){if(c.tag===3){WT(c,a,d);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(xo===null||!xo.has(p))){a=mc(d,a),a=lT(c,a,1),c=_o(c,a,1),a=zn(),c!==null&&(_a(c,1,a),Qn(c,a));break}}c=c.return}}function BM(a,c,d){var p=a.pingCache;p!==null&&p.delete(c),c=zn(),a.pingedLanes|=a.suspendedLanes&d,on===a&&(vn&d)===d&&(Zt===4||Zt===3&&(vn&130023424)===vn&&500>wt()-D_?Na(a,0):N_|=d),Qn(a,c)}function GT(a,c){c===0&&((a.mode&1)===0?c=1:(c=so,so<<=1,(so&130023424)===0&&(so=4194304)));var d=zn();a=Rs(a,c),a!==null&&(_a(a,c,d),Qn(a,d))}function WM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),GT(a,d)}function GM(a,c){var d=0;switch(a.tag){case 13:var p=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:p=a.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(c),GT(a,d)}var $T;$T=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Xn.current)Yn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return Yn=!1,kM(a,c,d);Yn=(a.flags&131072)!==0}else Yn=!1,Ct&&(c.flags&1048576)!==0&&SE(c,Jf,c.index);switch(c.lanes=0,c.tag){case 2:var p=c.type;gg(a,c),a=c.pendingProps;var v=ac(c,An.current);fc(c,d),v=u_(null,c,p,a,v,d);var w=h_();return c.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,qn(p)?(w=!0,Yf(c)):w=!1,c.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,i_(c),v.updater=dg,c.stateNode=v,v._reactInternals=c,y_(c,p,a,d),c=w_(null,c,p,!0,w,d)):(c.tag=0,Ct&&w&&Hy(c),jn(null,c,v,d),c=c.child),c;case 16:p=c.elementType;e:{switch(gg(a,c),a=c.pendingProps,v=p._init,p=v(p._payload),c.type=p,v=c.tag=KM(p),a=ar(p,a),v){case 0:c=x_(null,c,p,a,d);break e;case 1:c=yT(null,c,p,a,d);break e;case 11:c=dT(null,c,p,a,d);break e;case 14:c=fT(null,c,p,ar(p.type,a),d);break e}throw Error(t(306,p,""))}return c;case 0:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),x_(a,c,p,v,d);case 1:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),yT(a,c,p,v,d);case 3:e:{if(_T(c),a===null)throw Error(t(387));p=c.pendingProps,w=c.memoizedState,v=w.element,DE(a,c),sg(c,p,null,d);var P=c.memoizedState;if(p=P.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){v=mc(Error(t(423)),c),c=vT(a,c,p,d,v);break e}else if(p!==v){v=mc(Error(t(424)),c),c=vT(a,c,p,d,v);break e}else for(vi=fo(c.stateNode.containerInfo.firstChild),_i=c,Ct=!0,or=null,d=kE(c,null,p,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(uc(),p===v){c=bs(a,c,d);break e}jn(a,c,p,d)}c=c.child}return c;case 5:return OE(c),a===null&&Yy(c),p=c.type,v=c.pendingProps,w=a!==null?a.memoizedProps:null,P=v.children,Uy(p,v)?P=null:w!==null&&Uy(p,w)&&(c.flags|=32),pT(a,c),jn(a,c,P,d),c.child;case 6:return a===null&&Yy(c),null;case 13:return xT(a,c,d);case 4:return r_(c,c.stateNode.containerInfo),p=c.pendingProps,a===null?c.child=hc(c,null,p,d):jn(a,c,p,d),c.child;case 11:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),dT(a,c,p,v,d);case 7:return jn(a,c,c.pendingProps,d),c.child;case 8:return jn(a,c,c.pendingProps.children,d),c.child;case 12:return jn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(p=c.type._context,v=c.pendingProps,w=c.memoizedProps,P=v.value,vt(ng,p._currentValue),p._currentValue=P,w!==null)if(sr(w.value,P)){if(w.children===v.children&&!Xn.current){c=bs(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var U=w.dependencies;if(U!==null){P=w.child;for(var W=U.firstContext;W!==null;){if(W.context===p){if(w.tag===1){W=As(-1,d&-d),W.tag=2;var J=w.updateQueue;if(J!==null){J=J.shared;var oe=J.pending;oe===null?W.next=W:(W.next=oe.next,oe.next=W),J.pending=W}}w.lanes|=d,W=w.alternate,W!==null&&(W.lanes|=d),t_(w.return,d,c),U.lanes|=d;break}W=W.next}}else if(w.tag===10)P=w.type===c.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(t(341));P.lanes|=d,U=P.alternate,U!==null&&(U.lanes|=d),t_(P,d,c),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===c){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}jn(a,c,v.children,d),c=c.child}return c;case 9:return v=c.type,p=c.pendingProps.children,fc(c,d),v=zi(v),p=p(v),c.flags|=1,jn(a,c,p,d),c.child;case 14:return p=c.type,v=ar(p,c.pendingProps),v=ar(p.type,v),fT(a,c,p,v,d);case 15:return gT(a,c,c.type,c.pendingProps,d);case 17:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),gg(a,c),c.tag=1,qn(p)?(a=!0,Yf(c)):a=!1,fc(c,d),sT(c,p,v),y_(c,p,v,d),w_(null,c,p,!0,a,d);case 19:return ET(a,c,d);case 22:return mT(a,c,d)}throw Error(t(156,c.tag))};function KT(a,c){return Uu(a,c)}function $M(a,c,d,p){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wi(a,c,d,p){return new $M(a,c,d,p)}function U_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function KM(a){if(typeof a=="function")return U_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===B)return 11;if(a===me)return 14}return 2}function So(a,c){var d=a.alternate;return d===null?(d=Wi(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function Ig(a,c,d,p,v,w){var P=2;if(p=a,typeof a=="function")U_(a)&&(P=1);else if(typeof a=="string")P=5;else e:switch(a){case k:return Ma(d.children,v,w,c);case A:P=8,v|=8;break;case L:return a=Wi(12,d,c,v|2),a.elementType=L,a.lanes=w,a;case O:return a=Wi(13,d,c,v),a.elementType=O,a.lanes=w,a;case le:return a=Wi(19,d,c,v),a.elementType=le,a.lanes=w,a;case ue:return Cg(d,v,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:P=10;break e;case z:P=9;break e;case B:P=11;break e;case me:P=14;break e;case ge:P=16,p=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Wi(P,d,c,v),c.elementType=a,c.type=p,c.lanes=w,c}function Ma(a,c,d,p){return a=Wi(7,a,p,c),a.lanes=d,a}function Cg(a,c,d,p){return a=Wi(22,a,p,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function B_(a,c,d){return a=Wi(6,a,null,c),a.lanes=d,a}function W_(a,c,d){return c=Wi(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function HM(a,c,d,p,v){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ku(0),this.expirationTimes=Ku(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ku(0),this.identifierPrefix=p,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function G_(a,c,d,p,v,w,P,U,W){return a=new HM(a,c,d,U,W),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Wi(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:p,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},i_(w),a}function XM(a,c,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:p==null?null:""+p,children:a,containerInfo:c,implementation:d}}function HT(a){if(!a)return mo;a=a._reactInternals;e:{if(ir(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(qn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(qn(d))return wE(a,d,c)}return c}function XT(a,c,d,p,v,w,P,U,W){return a=G_(d,p,!0,a,v,w,P,U,W),a.context=HT(null),d=a.current,p=zn(),v=Eo(d),w=As(p,v),w.callback=c??null,_o(d,w,v),a.current.lanes=v,_a(a,v,p),Qn(a,p),a}function Rg(a,c,d,p){var v=c.current,w=zn(),P=Eo(v);return d=HT(d),c.context===null?c.context=d:c.pendingContext=d,c=As(w,P),c.payload={element:a},p=p===void 0?null:p,p!==null&&(c.callback=p),a=_o(v,c,P),a!==null&&(ur(a,v,P,w),rg(a,v,P)),P}function Ag(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function qT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function $_(a,c){qT(a,c),(a=a.alternate)&&qT(a,c)}function qM(){return null}var YT=typeof reportError=="function"?reportError:function(a){console.error(a)};function K_(a){this._internalRoot=a}bg.prototype.render=K_.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Rg(a,c,null,null)},bg.prototype.unmount=K_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;ka(function(){Rg(null,a,null,null)}),c[Ts]=null}};function bg(a){this._internalRoot=a}bg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Yu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<gi.length&&c!==0&&c<gi[d].priority;d++);gi.splice(d,0,a),d===0&&$l(a)}};function H_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Pg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function ZT(){}function YM(a,c,d,p,v){if(v){if(typeof p=="function"){var w=p;p=function(){var J=Ag(P);w.call(J)}}var P=XT(c,p,a,0,null,!1,!1,"",ZT);return a._reactRootContainer=P,a[Ts]=P.current,lh(a.nodeType===8?a.parentNode:a),ka(),P}for(;v=a.lastChild;)a.removeChild(v);if(typeof p=="function"){var U=p;p=function(){var J=Ag(W);U.call(J)}}var W=G_(a,0,!1,null,null,!1,!1,"",ZT);return a._reactRootContainer=W,a[Ts]=W.current,lh(a.nodeType===8?a.parentNode:a),ka(function(){Rg(c,W,d,p)}),W}function kg(a,c,d,p,v){var w=d._reactRootContainer;if(w){var P=w;if(typeof v=="function"){var U=v;v=function(){var W=Ag(P);U.call(W)}}Rg(c,P,a,v)}else P=YM(d,c,a,v,p);return Ag(P)}Xu=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=ot(c.pendingLanes);d!==0&&(Hu(c,d|1),Qn(c,wt()),(et&6)===0&&(_c=wt()+500,po()))}break;case 13:ka(function(){var p=Rs(a,1);if(p!==null){var v=zn();ur(p,a,1,v)}}),$_(a,1)}},Wl=function(a){if(a.tag===13){var c=Rs(a,134217728);if(c!==null){var d=zn();ur(c,a,134217728,d)}$_(a,134217728)}},qu=function(a){if(a.tag===13){var c=Eo(a),d=Rs(a,c);if(d!==null){var p=zn();ur(d,a,c,p)}$_(a,c)}},Yu=function(){return Xe},Zu=function(a,c){var d=Xe;try{return Xe=a,c()}finally{Xe=d}},Fn=function(a,c,d){switch(c){case"input":if(Hn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var p=d[c];if(p!==a&&p.form===a.form){var v=Xf(p);if(!v)throw Error(t(90));fs(p),Hn(p,v)}}}break;case"textarea":no(a,d);break;case"select":c=d.value,c!=null&&nn(a,!!d.multiple,c,!1)}},Mi=V_,fn=ka;var ZM={usingClientEntryPoint:!1,Events:[hh,sc,Xf,nr,Ft,V_]},Ih={findFiberByHostInstance:Ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QM={bundleType:Ih.bundleType,version:Ih.version,rendererPackageName:Ih.rendererPackageName,rendererConfig:Ih.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Pf(a),a===null?null:a.stateNode},findFiberByHostInstance:Ih.findFiberByHostInstance||qM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ng=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ng.isDisabled&&Ng.supportsFiber)try{ga=Ng.inject(QM),di=Ng}catch{}}return Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZM,Jn.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!H_(c))throw Error(t(200));return XM(a,c,null,d)},Jn.createRoot=function(a,c){if(!H_(a))throw Error(t(299));var d=!1,p="",v=YT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onRecoverableError!==void 0&&(v=c.onRecoverableError)),c=G_(a,1,!1,null,null,d,!1,p,v),a[Ts]=c.current,lh(a.nodeType===8?a.parentNode:a),new K_(c)},Jn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Pf(c),a=a===null?null:a.stateNode,a},Jn.flushSync=function(a){return ka(a)},Jn.hydrate=function(a,c,d){if(!Pg(c))throw Error(t(200));return kg(null,a,c,!0,d)},Jn.hydrateRoot=function(a,c,d){if(!H_(a))throw Error(t(405));var p=d!=null&&d.hydratedSources||null,v=!1,w="",P=YT;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(P=d.onRecoverableError)),c=XT(c,null,a,1,d??null,v,!1,w,P),a[Ts]=c.current,lh(a),p)for(a=0;a<p.length;a++)d=p[a],v=d._getVersion,v=v(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,v]:c.mutableSourceEagerHydrationData.push(d,v);return new bg(c)},Jn.render=function(a,c,d){if(!Pg(c))throw Error(t(200));return kg(null,a,c,!1,d)},Jn.unmountComponentAtNode=function(a){if(!Pg(a))throw Error(t(40));return a._reactRootContainer?(ka(function(){kg(null,null,a,!1,function(){a._reactRootContainer=null,a[Ts]=null})}),!0):!1},Jn.unstable_batchedUpdates=V_,Jn.unstable_renderSubtreeIntoContainer=function(a,c,d,p){if(!Pg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return kg(a,c,d,!1,p)},Jn.version="18.3.1-next-f1338f8080-20240426",Jn}var sS;function oL(){if(sS)return Y_.exports;sS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Y_.exports=sL(),Y_.exports}var oS;function aL(){if(oS)return Dg;oS=1;var n=oL();return Dg.createRoot=n.createRoot,Dg.hydrateRoot=n.hydrateRoot,Dg}var lL=aL();const cL=Px(lL);var H=Jd();const uL=Px(H),kx=H.createContext({});function Pl(n){const e=H.useRef(null);return e.current===null&&(e.current=n()),e.current}const Ip=H.createContext(null),Cp=H.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class hL extends H.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function dL({children:n,isPresent:e}){const t=H.useId(),i=H.useRef(null),r=H.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=H.useContext(Cp);return H.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),_.jsx(hL,{isPresent:e,childRef:i,sizeRef:r,children:H.cloneElement(n,{ref:i})})}const fL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Pl(gL),u=H.useId(),h=H.useCallback(m=>{l.set(m,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=H.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:m=>(l.set(m,!1),()=>l.delete(m))}),s?[Math.random(),h]:[t,h]);return H.useMemo(()=>{l.forEach((m,y)=>l.set(y,!1))},[t]),H.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=_.jsx(dL,{isPresent:t,children:n})),_.jsx(Ip.Provider,{value:f,children:n})};function gL(){return new Map}function K2(n=!0){const e=H.useContext(Ip);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=H.useId();H.useEffect(()=>{n&&r(s)},[n]);const o=H.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Mg=n=>n.key||"";function aS(n){const e=[];return H.Children.forEach(n,t=>{H.isValidElement(t)&&e.push(t)}),e}const Nx=typeof window<"u",Dx=Nx?H.useLayoutEffect:H.useEffect,Gn=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=K2(o),h=H.useMemo(()=>aS(n),[n]),f=o&&!l?[]:h.map(Mg),m=H.useRef(!0),y=H.useRef(h),x=Pl(()=>new Map),[T,I]=H.useState(h),[S,b]=H.useState(h);Dx(()=>{m.current=!1,y.current=h;for(let R=0;R<S.length;R++){const D=Mg(S[R]);f.includes(D)?x.delete(D):x.get(D)!==!0&&x.set(D,!1)}},[S,f.length,f.join("-")]);const N=[];if(h!==T){let R=[...h];for(let D=0;D<S.length;D++){const j=S[D],k=Mg(j);f.includes(k)||(R.splice(D,0,j),N.push(j))}s==="wait"&&N.length&&(R=N),b(aS(R)),I(h);return}const{forceRender:M}=H.useContext(kx);return _.jsx(_.Fragment,{children:S.map(R=>{const D=Mg(R),j=o&&!l?!1:h===S||f.includes(D),k=()=>{if(x.has(D))x.set(D,!0);else return;let A=!0;x.forEach(L=>{L||(A=!1)}),A&&(M?.(),b(y.current),o&&u?.(),i&&i())};return _.jsx(fL,{isPresent:j,initial:!m.current||t?void 0:!1,custom:j?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:j?void 0:k,children:R},D)})})},Ii=n=>n;let H2=Ii;function Mx(n){let e;return()=>(e===void 0&&(e=n()),e)}const iu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},zs=n=>n*1e3,Us=n=>n/1e3,mL={useManualTiming:!1};function pL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,m=!1)=>{const x=m&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Lg=["read","resolveKeyframes","update","preRender","render","postRender"],yL=40;function X2(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Lg.reduce((b,N)=>(b[N]=pL(s),b),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:m,postRender:y}=o,x=()=>{const b=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(b-r.timestamp,yL),1),r.timestamp=b,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),m.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},T=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:Lg.reduce((b,N)=>{const M=o[N];return b[N]=(R,D=!1,j=!1)=>(t||T(),M.schedule(R,D,j)),b},{}),cancel:b=>{for(let N=0;N<Lg.length;N++)o[Lg[N]].cancel(b)},state:r,steps:o}}const{schedule:xt,cancel:Ks,state:xn,steps:J_}=X2(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ii,!0),q2=H.createContext({strict:!1}),lS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ru={};for(const n in lS)ru[n]={isEnabled:e=>lS[n].some(t=>!!e[t])};function _L(n){for(const e in n)ru[e]={...ru[e],...n[e]}}const vL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Rm(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||vL.has(n)}let Y2=n=>!Rm(n);function xL(n){n&&(Y2=e=>e.startsWith("on")?!Rm(e):n(e))}try{xL(require("@emotion/is-prop-valid").default)}catch{}function wL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(Y2(r)||t===!0&&Rm(r)||!e&&!Rm(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function EL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const Rp=H.createContext({});function vd(n){return typeof n=="string"||Array.isArray(n)}function Ap(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Lx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ox=["initial",...Lx];function bp(n){return Ap(n.animate)||Ox.some(e=>vd(n[e]))}function Z2(n){return!!(bp(n)||n.variants)}function TL(n,e){if(bp(n)){const{initial:t,animate:i}=n;return{initial:t===!1||vd(t)?t:void 0,animate:vd(i)?i:void 0}}return n.inherit!==!1?e:{}}function SL(n){const{initial:e,animate:t}=TL(n,H.useContext(Rp));return H.useMemo(()=>({initial:e,animate:t}),[cS(e),cS(t)])}function cS(n){return Array.isArray(n)?n.join(" "):n}const IL=Symbol.for("motionComponentSymbol");function Uc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function CL(n,e,t){return H.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Uc(t)&&(t.current=i))},[e])}const Fx=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),RL="framerAppearId",Q2="data-"+Fx(RL),{schedule:Vx}=X2(queueMicrotask,!1),J2=H.createContext({});function AL(n,e,t,i,r){var s,o;const{visualElement:l}=H.useContext(Rp),u=H.useContext(q2),h=H.useContext(Ip),f=H.useContext(Cp).reducedMotion,m=H.useRef(null);i=i||u.renderer,!m.current&&i&&(m.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=m.current,x=H.useContext(J2);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&bL(m.current,t,r,x);const T=H.useRef(!1);H.useInsertionEffect(()=>{y&&T.current&&y.update(t,h)});const I=t[Q2],S=H.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return Dx(()=>{y&&(T.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),Vx.render(y.render),S.current&&y.animationState&&y.animationState.animateChanges())}),H.useEffect(()=>{y&&(!S.current&&y.animationState&&y.animationState.animateChanges(),S.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,I)}),S.current=!1))}),y}function bL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:eA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&Uc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function eA(n){if(n)return n.options.allowProjection!==!1?n.projection:eA(n.parent)}function PL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&_L(n);function l(h,f){let m;const y={...H.useContext(Cp),...h,layoutId:kL(h)},{isStatic:x}=y,T=SL(h),I=i(h,x);if(!x&&Nx){NL();const S=DL(y);m=S.MeasureLayout,T.visualElement=AL(r,I,y,e,S.ProjectionNode)}return _.jsxs(Rp.Provider,{value:T,children:[m&&T.visualElement?_.jsx(m,{visualElement:T.visualElement,...y}):null,t(r,h,CL(I,T.visualElement,f),I,x,T.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=H.forwardRef(l);return u[IL]=r,u}function kL({layoutId:n}){const e=H.useContext(kx).id;return e&&n!==void 0?e+"-"+n:n}function NL(n,e){H.useContext(q2).strict}function DL(n){const{drag:e,layout:t}=ru;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const ML=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function jx(n){return typeof n!="string"||n.includes("-")?!1:!!(ML.indexOf(n)>-1||/[A-Z]/u.test(n))}function uS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function zx(n,e,t,i){if(typeof e=="function"){const[r,s]=uS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=uS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const av=n=>Array.isArray(n),LL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),OL=n=>av(n)?n[n.length-1]||0:n,In=n=>!!(n&&n.getVelocity);function lm(n){const e=In(n)?n.get():n;return LL(e)?e.toValue():e}function FL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:VL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const tA=n=>(e,t)=>{const i=H.useContext(Rp),r=H.useContext(Ip),s=()=>FL(n,e,i,r);return t?s():Pl(s)};function VL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=lm(s[y]);let{initial:o,animate:l}=n;const u=bp(n),h=Z2(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const m=f?l:o;if(m&&typeof m!="boolean"&&!Ap(m)){const y=Array.isArray(m)?m:[m];for(let x=0;x<y.length;x++){const T=zx(n,y[x]);if(T){const{transitionEnd:I,transition:S,...b}=T;for(const N in b){let M=b[N];if(Array.isArray(M)){const R=f?M.length-1:0;M=M[R]}M!==null&&(r[N]=M)}for(const N in I)r[N]=I[N]}}}return r}const ku=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],kl=new Set(ku),nA=n=>e=>typeof e=="string"&&e.startsWith(n),iA=nA("--"),jL=nA("var(--"),Ux=n=>jL(n)?zL.test(n.split("/*")[0].trim()):!1,zL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,rA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Hs=(n,e,t)=>t>e?e:t<n?n:t,Nu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},xd={...Nu,transform:n=>Hs(0,1,n)},Og={...Nu,default:1},ef=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Fo=ef("deg"),is=ef("%"),Ne=ef("px"),UL=ef("vh"),BL=ef("vw"),hS={...is,parse:n=>is.parse(n)/100,transform:n=>is.transform(n*100)},WL={borderWidth:Ne,borderTopWidth:Ne,borderRightWidth:Ne,borderBottomWidth:Ne,borderLeftWidth:Ne,borderRadius:Ne,radius:Ne,borderTopLeftRadius:Ne,borderTopRightRadius:Ne,borderBottomRightRadius:Ne,borderBottomLeftRadius:Ne,width:Ne,maxWidth:Ne,height:Ne,maxHeight:Ne,top:Ne,right:Ne,bottom:Ne,left:Ne,padding:Ne,paddingTop:Ne,paddingRight:Ne,paddingBottom:Ne,paddingLeft:Ne,margin:Ne,marginTop:Ne,marginRight:Ne,marginBottom:Ne,marginLeft:Ne,backgroundPositionX:Ne,backgroundPositionY:Ne},GL={rotate:Fo,rotateX:Fo,rotateY:Fo,rotateZ:Fo,scale:Og,scaleX:Og,scaleY:Og,scaleZ:Og,skew:Fo,skewX:Fo,skewY:Fo,distance:Ne,translateX:Ne,translateY:Ne,translateZ:Ne,x:Ne,y:Ne,z:Ne,perspective:Ne,transformPerspective:Ne,opacity:xd,originX:hS,originY:hS,originZ:Ne},dS={...Nu,transform:Math.round},Bx={...WL,...GL,zIndex:dS,size:Ne,fillOpacity:xd,strokeOpacity:xd,numOctaves:dS},$L={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},KL=ku.length;function HL(n,e,t){let i="",r=!0;for(let s=0;s<KL;s++){const o=ku[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=rA(l,Bx[o]);if(!u){r=!1;const f=$L[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Wx(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(kl.has(u)){o=!0;continue}else if(iA(u)){r[u]=h;continue}else{const f=rA(h,Bx[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=HL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const XL={offset:"stroke-dashoffset",array:"stroke-dasharray"},qL={offset:"strokeDashoffset",array:"strokeDasharray"};function YL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?XL:qL;n[s.offset]=Ne.transform(-i);const o=Ne.transform(e),l=Ne.transform(t);n[s.array]=`${o} ${l}`}function fS(n,e,t){return typeof n=="string"?n:Ne.transform(e+t*n)}function ZL(n,e,t){const i=fS(e,n.x,n.width),r=fS(t,n.y,n.height);return`${i} ${r}`}function Gx(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,m){if(Wx(n,h,m),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:x,dimensions:T}=n;y.transform&&(T&&(x.transform=y.transform),delete y.transform),T&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=ZL(T,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&YL(y,o,l,u,!1)}const $x=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),sA=()=>({...$x(),attrs:{}}),Kx=n=>typeof n=="string"&&n.toLowerCase()==="svg";function oA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const aA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function lA(n,e,t,i){oA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(aA.has(r)?r:Fx(r),e.attrs[r])}const Am={};function QL(n){Object.assign(Am,n)}function cA(n,{layout:e,layoutId:t}){return kl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Am[n]||n==="opacity")}function Hx(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(In(r[o])||e.style&&In(e.style[o])||cA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function uA(n,e,t){const i=Hx(n,e,t);for(const r in n)if(In(n[r])||In(e[r])){const s=ku.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function JL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const gS=["x","y","width","height","cx","cy","r"],eO={useVisualState:tA({scrapeMotionValuesFromProps:uA,createRenderState:sA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(kl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<gS.length;l++){const u=gS[l];n[u]!==e[u]&&(o=!0)}o&&xt.read(()=>{JL(t,i),xt.render(()=>{Gx(i,r,Kx(t.tagName),n.transformTemplate),lA(t,i)})})}})},tO={useVisualState:tA({scrapeMotionValuesFromProps:Hx,createRenderState:$x})};function hA(n,e,t){for(const i in e)!In(e[i])&&!cA(i,t)&&(n[i]=e[i])}function nO({transformTemplate:n},e){return H.useMemo(()=>{const t=$x();return Wx(t,e,n),Object.assign({},t.vars,t.style)},[e])}function iO(n,e){const t=n.style||{},i={};return hA(i,t,n),Object.assign(i,nO(n,e)),i}function rO(n,e){const t={},i=iO(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function sO(n,e,t,i){const r=H.useMemo(()=>{const s=sA();return Gx(s,e,Kx(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};hA(s,n.style,n),r.style={...s,...r.style}}return r}function oO(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(jx(t)?sO:rO)(i,s,o,t),h=wL(i,typeof t=="string",n),f=t!==H.Fragment?{...h,...u,ref:r}:{},{children:m}=i,y=H.useMemo(()=>In(m)?m.get():m,[m]);return H.createElement(t,{...f,children:y})}}function aO(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...jx(i)?eO:tO,preloadedFeatures:n,useRender:oO(r),createVisualElement:e,Component:i};return PL(o)}}function dA(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Pp(n,e,t){const i=n.getProps();return zx(i,e,t!==void 0?t:i.custom,n)}const lO=Mx(()=>window.ScrollTimeline!==void 0);class cO{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(lO()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class uO extends cO{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Xx(n,e){return n?n[e]||n.default||n:void 0}const lv=2e4;function fA(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<lv;)e+=t,i=n.next(e);return e>=lv?1/0:e}function qx(n){return typeof n=="function"}function mS(n,e){n.timeline=e,n.onfinish=null}const Yx=n=>Array.isArray(n)&&typeof n[0]=="number",hO={linearEasing:void 0};function dO(n,e){const t=Mx(n);return()=>{var i;return(i=hO[e])!==null&&i!==void 0?i:t()}}const bm=dO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),gA=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(iu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function mA(n){return!!(typeof n=="function"&&bm()||!n||typeof n=="string"&&(n in cv||bm())||Yx(n)||Array.isArray(n)&&n.every(mA))}const zh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,cv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:zh([0,.65,.55,1]),circOut:zh([.55,0,1,.45]),backIn:zh([.31,.01,.66,-.59]),backOut:zh([.33,1.53,.69,.99])};function pA(n,e){if(n)return typeof n=="function"&&bm()?gA(n,e):Yx(n)?zh(n):Array.isArray(n)?n.map(t=>pA(t,e)||cv.easeOut):cv[n]}const dr={x:!1,y:!1};function yA(){return dr.x||dr.y}function fO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function _A(n,e){const t=fO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function pS(n){return e=>{e.pointerType==="touch"||yA()||n(e)}}function gO(n,e,t={}){const[i,r,s]=_A(n,t),o=pS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=pS(m=>{h(m),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const vA=(n,e)=>e?n===e?!0:vA(n,e.parentElement):!1,Zx=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,mO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function pO(n){return mO.has(n.tagName)||n.tabIndex!==-1}const Uh=new WeakSet;function yS(n){return e=>{e.key==="Enter"&&n(e)}}function e0(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const yO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=yS(()=>{if(Uh.has(t))return;e0(t,"down");const r=yS(()=>{e0(t,"up")}),s=()=>e0(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function _S(n){return Zx(n)&&!yA()}function _O(n,e,t={}){const[i,r,s]=_A(n,t),o=l=>{const u=l.currentTarget;if(!_S(l)||Uh.has(u))return;Uh.add(u);const h=e(l),f=(x,T)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",y),!(!_S(x)||!Uh.has(u))&&(Uh.delete(u),typeof h=="function"&&h(x,{success:T}))},m=x=>{f(x,t.useGlobalTarget||vA(u,x.target))},y=x=>{f(x,!1)};window.addEventListener("pointerup",m,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!pO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>yO(h,r),r)}),s}function vO(n){return n==="x"||n==="y"?dr[n]?null:(dr[n]=!0,()=>{dr[n]=!1}):dr.x||dr.y?null:(dr.x=dr.y=!0,()=>{dr.x=dr.y=!1})}const xA=new Set(["width","height","top","left","right","bottom",...ku]);let cm;function xO(){cm=void 0}const rs={now:()=>(cm===void 0&&rs.set(xn.isProcessing||mL.useManualTiming?xn.timestamp:performance.now()),cm),set:n=>{cm=n,queueMicrotask(xO)}};function Qx(n,e){n.indexOf(e)===-1&&n.push(e)}function Jx(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function wO([...n],e,t){const i=e<0?n.length+e:e;if(i>=0&&i<n.length){const r=t<0?n.length+t:t,[s]=n.splice(e,1);n.splice(r,0,s)}return n}class e1{constructor(){this.subscriptions=[]}add(e){return Qx(this.subscriptions,e),()=>Jx(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function wA(n,e){return e?n*(1e3/e):0}const vS=30,EO=n=>!isNaN(parseFloat(n)),Qh={current:void 0};class TO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=rs.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=rs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=EO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new e1);const i=this.events[e].add(t);return e==="change"?()=>{i(),xt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Qh.current&&Qh.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=rs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>vS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,vS);return wA(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function su(n,e){return new TO(n,e)}function SO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,su(t))}function IO(n,e){const t=Pp(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=OL(s[o]);SO(n,o,l)}}function CO(n){return!!(In(n)&&n.add)}function uv(n,e){const t=n.getValue("willChange");if(CO(t))return t.add(e)}function EA(n){return n.props[Q2]}const TA=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,RO=1e-7,AO=12;function bO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=TA(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>RO&&++l<AO);return o}function tf(n,e,t,i){if(n===e&&t===i)return Ii;const r=s=>bO(s,0,1,n,t);return s=>s===0||s===1?s:TA(r(s),e,i)}const SA=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,IA=n=>e=>1-n(1-e),CA=tf(.33,1.53,.69,.99),t1=IA(CA),RA=SA(t1),AA=n=>(n*=2)<1?.5*t1(n):.5*(2-Math.pow(2,-10*(n-1))),n1=n=>1-Math.sin(Math.acos(n)),bA=IA(n1),PA=SA(n1),kA=n=>/^0[^.\s]+$/u.test(n);function PO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||kA(n):!0}const Jh=n=>Math.round(n*1e5)/1e5,i1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function kO(n){return n==null}const NO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,r1=(n,e)=>t=>!!(typeof t=="string"&&NO.test(t)&&t.startsWith(n)||e&&!kO(t)&&Object.prototype.hasOwnProperty.call(t,e)),NA=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(i1);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},DO=n=>Hs(0,255,n),t0={...Nu,transform:n=>Math.round(DO(n))},Za={test:r1("rgb","red"),parse:NA("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+t0.transform(n)+", "+t0.transform(e)+", "+t0.transform(t)+", "+Jh(xd.transform(i))+")"};function MO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const hv={test:r1("#"),parse:MO,transform:Za.transform},Bc={test:r1("hsl","hue"),parse:NA("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+is.transform(Jh(e))+", "+is.transform(Jh(t))+", "+Jh(xd.transform(i))+")"},Mn={test:n=>Za.test(n)||hv.test(n)||Bc.test(n),parse:n=>Za.test(n)?Za.parse(n):Bc.test(n)?Bc.parse(n):hv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Za.transform(n):Bc.transform(n)},LO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function OO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(i1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(LO))===null||t===void 0?void 0:t.length)||0)>0}const DA="number",MA="color",FO="var",VO="var(",xS="${}",jO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function wd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(jO,u=>(Mn.test(u)?(i.color.push(s),r.push(MA),t.push(Mn.parse(u))):u.startsWith(VO)?(i.var.push(s),r.push(FO),t.push(u)):(i.number.push(s),r.push(DA),t.push(parseFloat(u))),++s,xS)).split(xS);return{values:t,split:l,indexes:i,types:r}}function LA(n){return wd(n).values}function OA(n){const{split:e,types:t}=wd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===DA?s+=Jh(r[o]):l===MA?s+=Mn.transform(r[o]):s+=r[o]}return s}}const zO=n=>typeof n=="number"?0:n;function UO(n){const e=LA(n);return OA(n)(e.map(zO))}const ta={test:OO,parse:LA,createTransformer:OA,getAnimatableNone:UO},BO=new Set(["brightness","contrast","saturate","opacity"]);function WO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(i1)||[];if(!i)return n;const r=t.replace(i,"");let s=BO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const GO=/\b([a-z-]*)\(.*?\)/gu,dv={...ta,getAnimatableNone:n=>{const e=n.match(GO);return e?e.map(WO).join(" "):n}},$O={...Bx,color:Mn,backgroundColor:Mn,outlineColor:Mn,fill:Mn,stroke:Mn,borderColor:Mn,borderTopColor:Mn,borderRightColor:Mn,borderBottomColor:Mn,borderLeftColor:Mn,filter:dv,WebkitFilter:dv},s1=n=>$O[n];function FA(n,e){let t=s1(n);return t!==dv&&(t=ta),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const KO=new Set(["auto","none","0"]);function HO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!KO.has(s)&&wd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=FA(t,r)}const wS=n=>n===Nu||n===Ne,ES=(n,e)=>parseFloat(n.split(", ")[e]),TS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return ES(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?ES(s[1],n):0}},XO=new Set(["x","y","z"]),qO=ku.filter(n=>!XO.has(n));function YO(n){const e=[];return qO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const ou={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:TS(4,13),y:TS(5,14)};ou.translateX=ou.x;ou.translateY=ou.y;const sl=new Set;let fv=!1,gv=!1;function VA(){if(gv){const n=Array.from(sl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=YO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}gv=!1,fv=!1,sl.forEach(n=>n.complete()),sl.clear()}function jA(){sl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(gv=!0)})}function ZO(){jA(),VA()}class o1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(sl.add(this),fv||(fv=!0,xt.read(jA),xt.resolveKeyframes(VA))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),sl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,sl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const zA=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),QO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function JO(n){const e=QO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function UA(n,e,t=1){const[i,r]=JO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return zA(o)?parseFloat(o):o}return Ux(r)?UA(r,e,t+1):r}const BA=n=>e=>e.test(n),eF={test:n=>n==="auto",parse:n=>n},WA=[Nu,Ne,is,Fo,BL,UL,eF],SS=n=>WA.find(BA(n));class GA extends o1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Ux(h))){const f=UA(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!xA.has(i)||e.length!==2)return;const[r,s]=e,o=SS(r),l=SS(s);if(o!==l)if(wS(o)&&wS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)PO(e[r])&&i.push(r);i.length&&HO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ou[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=ou[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const IS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ta.test(n)||n==="0")&&!n.startsWith("url("));function tF(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function nF(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=IS(r,e),l=IS(s,e);return!o||!l?!1:tF(n)||(t==="spring"||qx(t))&&i}const iF=n=>n!==null;function kp(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(iF),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const rF=40;class $A{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=rs.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>rF?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&ZO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=rs.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!nF(e,i,r,s))if(o)this.options.duration=0;else{u&&u(kp(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const At=(n,e,t)=>n+(e-n)*t;function n0(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function sF({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=n0(u,l,n+1/3),s=n0(u,l,n),o=n0(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Pm(n,e){return t=>t>0?e:n}const i0=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},oF=[hv,Za,Bc],aF=n=>oF.find(e=>e.test(n));function CS(n){const e=aF(n);if(!e)return!1;let t=e.parse(n);return e===Bc&&(t=sF(t)),t}const RS=(n,e)=>{const t=CS(n),i=CS(e);if(!t||!i)return Pm(n,e);const r={...t};return s=>(r.red=i0(t.red,i.red,s),r.green=i0(t.green,i.green,s),r.blue=i0(t.blue,i.blue,s),r.alpha=At(t.alpha,i.alpha,s),Za.transform(r))},lF=(n,e)=>t=>e(n(t)),nf=(...n)=>n.reduce(lF),mv=new Set(["none","hidden"]);function cF(n,e){return mv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function uF(n,e){return t=>At(n,e,t)}function a1(n){return typeof n=="number"?uF:typeof n=="string"?Ux(n)?Pm:Mn.test(n)?RS:fF:Array.isArray(n)?KA:typeof n=="object"?Mn.test(n)?RS:hF:Pm}function KA(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>a1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function hF(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=a1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function dF(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const fF=(n,e)=>{const t=ta.createTransformer(e),i=wd(n),r=wd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?mv.has(n)&&!r.values.length||mv.has(e)&&!i.values.length?cF(n,e):nf(KA(dF(i,r),r.values),t):Pm(n,e)};function HA(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?At(n,e,t):a1(n)(n,e)}const gF=5;function XA(n,e,t){const i=Math.max(e-gF,0);return wA(t-n(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},r0=.001;function mF({duration:n=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:i=Ot.mass}){let r,s,o=1-e;o=Hs(Ot.minDamping,Ot.maxDamping,o),n=Hs(Ot.minDuration,Ot.maxDuration,Us(n)),o<1?(r=h=>{const f=h*o,m=f*n,y=f-t,x=pv(h,o),T=Math.exp(-m);return r0-y/x*T},s=h=>{const m=h*o*n,y=m*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,T=Math.exp(-m),I=pv(Math.pow(h,2),o);return(-r(h)+r0>0?-1:1)*((y-x)*T)/I}):(r=h=>{const f=Math.exp(-h*n),m=(h-t)*n+1;return-r0+f*m},s=h=>{const f=Math.exp(-h*n),m=(t-h)*(n*n);return f*m});const l=5/n,u=yF(r,s,l);if(n=zs(n),isNaN(u))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const pF=12;function yF(n,e,t){let i=t;for(let r=1;r<pF;r++)i=i-n(i)/e(i);return i}function pv(n,e){return n*Math.sqrt(1-e*e)}const _F=["duration","bounce"],vF=["stiffness","damping","mass"];function AS(n,e){return e.some(t=>n[t]!==void 0)}function xF(n){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...n};if(!AS(n,vF)&&AS(n,_F))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Hs(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=mF(n);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function qA(n=Ot.visualDuration,e=Ot.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:m,velocity:y,isResolvedFromDuration:x}=xF({...t,velocity:-Us(t.velocity||0)}),T=y||0,I=h/(2*Math.sqrt(u*f)),S=o-s,b=Us(Math.sqrt(u/f)),N=Math.abs(S)<5;i||(i=N?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=N?Ot.restDelta.granular:Ot.restDelta.default);let M;if(I<1){const D=pv(b,I);M=j=>{const k=Math.exp(-I*b*j);return o-k*((T+I*b*S)/D*Math.sin(D*j)+S*Math.cos(D*j))}}else if(I===1)M=D=>o-Math.exp(-b*D)*(S+(T+b*S)*D);else{const D=b*Math.sqrt(I*I-1);M=j=>{const k=Math.exp(-I*b*j),A=Math.min(D*j,300);return o-k*((T+I*b*S)*Math.sinh(A)+D*S*Math.cosh(A))/D}}const R={calculatedDuration:x&&m||null,next:D=>{const j=M(D);if(x)l.done=D>=m;else{let k=0;I<1&&(k=D===0?zs(T):XA(M,D,j));const A=Math.abs(k)<=i,L=Math.abs(o-j)<=r;l.done=A&&L}return l.value=l.done?o:j,l},toString:()=>{const D=Math.min(fA(R),lv),j=gA(k=>R.next(D*k).value,D,30);return D+"ms "+j}};return R}function bS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const m=n[0],y={done:!1,value:m},x=A=>l!==void 0&&A<l||u!==void 0&&A>u,T=A=>l===void 0?u:u===void 0||Math.abs(l-A)<Math.abs(u-A)?l:u;let I=t*e;const S=m+I,b=o===void 0?S:o(S);b!==S&&(I=b-m);const N=A=>-I*Math.exp(-A/i),M=A=>b+N(A),R=A=>{const L=N(A),V=M(A);y.done=Math.abs(L)<=h,y.value=y.done?b:V};let D,j;const k=A=>{x(y.value)&&(D=A,j=qA({keyframes:[y.value,T(y.value)],velocity:XA(M,A,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return k(0),{calculatedDuration:null,next:A=>{let L=!1;return!j&&D===void 0&&(L=!0,R(A),k(A)),D!==void 0&&A>=D?j.next(A-D):(!L&&R(A),y)}}}const wF=tf(.42,0,1,1),EF=tf(0,0,.58,1),YA=tf(.42,0,.58,1),TF=n=>Array.isArray(n)&&typeof n[0]!="number",SF={linear:Ii,easeIn:wF,easeInOut:YA,easeOut:EF,circIn:n1,circInOut:PA,circOut:bA,backIn:t1,backInOut:RA,backOut:CA,anticipate:AA},PS=n=>{if(Yx(n)){H2(n.length===4);const[e,t,i,r]=n;return tf(e,t,i,r)}else if(typeof n=="string")return SF[n];return n};function IF(n,e,t){const i=[],r=t||HA,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ii:e;l=nf(u,l)}i.push(l)}return i}function ZA(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(H2(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=IF(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let m=0;if(u>1)for(;m<n.length-2&&!(f<n[m+1]);m++);const y=iu(n[m],n[m+1],f);return l[m](y)};return t?f=>h(Hs(n[0],n[s-1],f)):h}function CF(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=iu(0,e,i);n.push(At(t,1,r))}}function RF(n){const e=[0];return CF(e,n.length-1),e}function AF(n,e){return n.map(t=>t*e)}function bF(n,e){return n.map(()=>e||YA).splice(0,n.length-1)}function km({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=TF(i)?i.map(PS):PS(i),s={done:!1,value:e[0]},o=AF(t&&t.length===e.length?t:RF(e),n),l=ZA(o,e,{ease:Array.isArray(r)?r:bF(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const PF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>xt.update(e,!0),stop:()=>Ks(e),now:()=>xn.isProcessing?xn.timestamp:rs.now()}},kF={decay:bS,inertia:bS,tween:km,keyframes:km,spring:qA},NF=n=>n/100;class l1 extends $A{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||o1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=qx(t)?t:kF[t]||km;let u,h;l!==km&&typeof e[0]!="number"&&(u=nf(NF,HA(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=fA(f));const{calculatedDuration:m}=f,y=m+r,x=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:m,resolvedDuration:y,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:m}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:x,repeatType:T,repeatDelay:I,onUpdate:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-y*(this.speed>=0?1:-1),N=this.speed>=0?b<0:b>f;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let M=this.currentTime,R=s;if(x){const A=Math.min(this.currentTime,f)/m;let L=Math.floor(A),V=A%1;!V&&A>=1&&(V=1),V===1&&L--,L=Math.min(L,x+1),L%2&&(T==="reverse"?(V=1-V,I&&(V-=I/m)):T==="mirror"&&(R=o)),M=Hs(0,1,V)*m}const D=N?{done:!1,value:u[0]}:R.next(M);l&&(D.value=l(D.value));let{done:j}=D;!N&&h!==null&&(j=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return k&&r!==void 0&&(D.value=kp(u,this.options,r)),S&&S(D.value),k&&this.finish(),D}get duration(){const{resolved:e}=this;return e?Us(e.calculatedDuration):0}get time(){return Us(this.currentTime)}set time(e){e=zs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Us(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=PF,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const DF=new Set(["opacity","clipPath","filter","transform"]);function MF(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=pA(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const LF=Mx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Nm=10,OF=2e4;function FF(n){return qx(n.type)||n.type==="spring"||!mA(n.ease)}function VF(n,e){const t=new l1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<OF;)i=t.sample(s),r.push(i.value),s+=Nm;return{times:void 0,keyframes:r,duration:s-Nm,ease:"linear"}}const QA={anticipate:AA,backInOut:RA,circInOut:PA};function jF(n){return n in QA}class kS extends $A{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new GA(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&bm()&&jF(s)&&(s=QA[s]),FF(this.options)){const{onComplete:m,onUpdate:y,motionValue:x,element:T,...I}=this.options,S=VF(e,I);e=S.keyframes,e.length===1&&(e[1]=e[0]),i=S.duration,r=S.times,s=S.ease,o="keyframes"}const f=MF(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(mS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;l.set(kp(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Us(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Us(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=zs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ii;const{animation:i}=t;mS(i,e)}return Ii}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:m,element:y,...x}=this.options,T=new l1({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=zs(this.time);h.setWithVelocity(T.sample(I-Nm).value,T.sample(I).value,Nm)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return LF()&&i&&DF.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const zF={type:"spring",stiffness:500,damping:25,restSpeed:10},UF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),BF={type:"keyframes",duration:.8},WF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},GF=(n,{keyframes:e})=>e.length>2?BF:kl.has(n)?n.startsWith("scale")?UF(e[1]):zF:WF;function $F({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const c1=(n,e,t,i={},r,s)=>o=>{const l=Xx(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-zs(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};$F(l)||(f={...f,...GF(n,f)}),f.duration&&(f.duration=zs(f.duration)),f.repeatDelay&&(f.repeatDelay=zs(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!s&&e.get()!==void 0){const y=kp(f.keyframes,l);if(y!==void 0)return xt.update(()=>{f.onUpdate(y),f.onComplete()}),new uO([])}return!s&&kS.supports(f)?new kS(f):new l1(f)};function KF({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function JA(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const m in u){const y=n.getValue(m,(s=n.latestValues[m])!==null&&s!==void 0?s:null),x=u[m];if(x===void 0||f&&KF(f,m))continue;const T={delay:t,...Xx(o||{},m)};let I=!1;if(window.MotionHandoffAnimation){const b=EA(n);if(b){const N=window.MotionHandoffAnimation(b,m,xt);N!==null&&(T.startTime=N,I=!0)}}uv(n,m),y.start(c1(m,y,x,n.shouldReduceMotion&&xA.has(m)?{type:!1}:T,n,I));const S=y.animation;S&&h.push(S)}return l&&Promise.all(h).then(()=>{xt.update(()=>{l&&IO(n,l)})}),h}function yv(n,e,t={}){var i;const r=Pp(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(JA(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:y}=s;return HF(n,e,f+h,m,y,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function HF(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(XF).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(yv(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function XF(n,e){return n.sortNodePosition(e)}function qF(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>yv(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=yv(n,e,t);else{const r=typeof e=="function"?Pp(n,e,t.custom):e;i=Promise.all(JA(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const YF=Ox.length;function eb(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?eb(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<YF;t++){const i=Ox[t],r=n.props[i];(vd(r)||r===!1)&&(e[i]=r)}return e}const ZF=[...Lx].reverse(),QF=Lx.length;function JF(n){return e=>Promise.all(e.map(({animation:t,options:i})=>qF(n,t,i)))}function e5(n){let e=JF(n),t=NS(),i=!0;const r=u=>(h,f)=>{var m;const y=Pp(n,f,u==="exit"?(m=n.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(y){const{transition:x,transitionEnd:T,...I}=y;h={...h,...I,...T}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=eb(n.parent)||{},m=[],y=new Set;let x={},T=1/0;for(let S=0;S<QF;S++){const b=ZF[S],N=t[b],M=h[b]!==void 0?h[b]:f[b],R=vd(M),D=b===u?N.isActive:null;D===!1&&(T=S);let j=M===f[b]&&M!==h[b]&&R;if(j&&i&&n.manuallyAnimateOnMount&&(j=!1),N.protectedKeys={...x},!N.isActive&&D===null||!M&&!N.prevProp||Ap(M)||typeof M=="boolean")continue;const k=t5(N.prevProp,M);let A=k||b===u&&N.isActive&&!j&&R||S>T&&R,L=!1;const V=Array.isArray(M)?M:[M];let z=V.reduce(r(b),{});D===!1&&(z={});const{prevResolvedValues:B={}}=N,O={...B,...z},le=ue=>{A=!0,y.has(ue)&&(L=!0,y.delete(ue)),N.needsAnimating[ue]=!0;const Q=n.getValue(ue);Q&&(Q.liveStyle=!1)};for(const ue in O){const Q=z[ue],se=B[ue];if(x.hasOwnProperty(ue))continue;let ne=!1;av(Q)&&av(se)?ne=!dA(Q,se):ne=Q!==se,ne?Q!=null?le(ue):y.add(ue):Q!==void 0&&y.has(ue)?le(ue):N.protectedKeys[ue]=!0}N.prevProp=M,N.prevResolvedValues=z,N.isActive&&(x={...x,...z}),i&&n.blockInitialAnimation&&(A=!1),A&&(!(j&&k)||L)&&m.push(...V.map(ue=>({animation:ue,options:{type:b}})))}if(y.size){const S={};y.forEach(b=>{const N=n.getBaseTarget(b),M=n.getValue(b);M&&(M.liveStyle=!0),S[b]=N??null}),m.push({animation:S})}let I=!!m.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(m):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var x;return(x=y.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const m=o(u);for(const y in t)t[y].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=NS(),i=!0}}}function t5(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!dA(e,n):!1}function La(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function NS(){return{animate:La(!0),whileInView:La(),whileHover:La(),whileTap:La(),whileDrag:La(),whileFocus:La(),exit:La()}}let aa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class n5 extends aa{constructor(e){super(e),e.animationState||(e.animationState=e5(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Ap(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let i5=0;class r5 extends aa{constructor(){super(...arguments),this.id=i5++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const s5={animation:{Feature:n5},exit:{Feature:r5}};function Ed(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function rf(n){return{point:{x:n.pageX,y:n.pageY}}}const o5=n=>e=>Zx(e)&&n(e,rf(e));function ed(n,e,t,i){return Ed(n,e,o5(t),i)}const DS=(n,e)=>Math.abs(n-e);function a5(n,e){const t=DS(n.x,e.x),i=DS(n.y,e.y);return Math.sqrt(t**2+i**2)}class tb{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=o0(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=a5(m.offset,{x:0,y:0})>=3;if(!y&&!x)return;const{point:T}=m,{timestamp:I}=xn;this.history.push({...T,timestamp:I});const{onStart:S,onMove:b}=this.handlers;y||(S&&S(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=s0(y,this.transformPagePoint),xt.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:x,onSessionEnd:T,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=o0(m.type==="pointercancel"?this.lastMoveEventInfo:s0(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(m,S),T&&T(m,S)},!Zx(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=rf(e),l=s0(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=xn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,o0(l,this.history)),this.removeListeners=nf(ed(this.contextWindow,"pointermove",this.handlePointerMove),ed(this.contextWindow,"pointerup",this.handlePointerUp),ed(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ks(this.updatePoint)}}function s0(n,e){return e?{point:e(n.point)}:n}function MS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function o0({point:n},e){return{point:n,delta:MS(n,nb(e)),offset:MS(n,l5(e)),velocity:c5(e,.1)}}function l5(n){return n[0]}function nb(n){return n[n.length-1]}function c5(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=nb(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>zs(e)));)t--;if(!i)return{x:0,y:0};const s=Us(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const ib=1e-4,u5=1-ib,h5=1+ib,rb=.01,d5=0-rb,f5=0+rb;function Ci(n){return n.max-n.min}function g5(n,e,t){return Math.abs(n-e)<=t}function LS(n,e,t,i=.5){n.origin=i,n.originPoint=At(e.min,e.max,n.origin),n.scale=Ci(t)/Ci(e),n.translate=At(t.min,t.max,n.origin)-n.originPoint,(n.scale>=u5&&n.scale<=h5||isNaN(n.scale))&&(n.scale=1),(n.translate>=d5&&n.translate<=f5||isNaN(n.translate))&&(n.translate=0)}function td(n,e,t,i){LS(n.x,e.x,t.x,i?i.originX:void 0),LS(n.y,e.y,t.y,i?i.originY:void 0)}function OS(n,e,t){n.min=t.min+e.min,n.max=n.min+Ci(e)}function m5(n,e,t){OS(n.x,e.x,t.x),OS(n.y,e.y,t.y)}function FS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ci(e)}function nd(n,e,t){FS(n.x,e.x,t.x),FS(n.y,e.y,t.y)}function p5(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?At(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?At(t,n,i.max):Math.min(n,t)),n}function VS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function y5(n,{top:e,left:t,bottom:i,right:r}){return{x:VS(n.x,t,r),y:VS(n.y,e,i)}}function jS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function _5(n,e){return{x:jS(n.x,e.x),y:jS(n.y,e.y)}}function v5(n,e){let t=.5;const i=Ci(n),r=Ci(e);return r>i?t=iu(e.min,e.max-i,n.min):i>r&&(t=iu(n.min,n.max-r,e.min)),Hs(0,1,t)}function x5(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const _v=.35;function w5(n=_v){return n===!1?n=0:n===!0&&(n=_v),{x:zS(n,"left","right"),y:zS(n,"top","bottom")}}function zS(n,e,t){return{min:US(n,e),max:US(n,t)}}function US(n,e){return typeof n=="number"?n:n[e]||0}const BS=()=>({translate:0,scale:1,origin:0,originPoint:0}),Wc=()=>({x:BS(),y:BS()}),WS=()=>({min:0,max:0}),Ut=()=>({x:WS(),y:WS()});function Ki(n){return[n("x"),n("y")]}function sb({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function E5({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function T5(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function a0(n){return n===void 0||n===1}function vv({scale:n,scaleX:e,scaleY:t}){return!a0(n)||!a0(e)||!a0(t)}function ja(n){return vv(n)||ob(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function ob(n){return GS(n.x)||GS(n.y)}function GS(n){return n&&n!=="0%"}function Dm(n,e,t){const i=n-t,r=e*i;return t+r}function $S(n,e,t,i,r){return r!==void 0&&(n=Dm(n,r,i)),Dm(n,t,i)+e}function xv(n,e=0,t=1,i,r){n.min=$S(n.min,e,t,i,r),n.max=$S(n.max,e,t,i,r)}function ab(n,{x:e,y:t}){xv(n.x,e.translate,e.scale,e.originPoint),xv(n.y,t.translate,t.scale,t.originPoint)}const KS=.999999999999,HS=1.0000000000001;function S5(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&$c(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,ab(n,o)),i&&ja(s.latestValues)&&$c(n,s.latestValues))}e.x<HS&&e.x>KS&&(e.x=1),e.y<HS&&e.y>KS&&(e.y=1)}function Gc(n,e){n.min=n.min+e,n.max=n.max+e}function XS(n,e,t,i,r=.5){const s=At(n.min,n.max,r);xv(n,e,t,s,i)}function $c(n,e){XS(n.x,e.x,e.scaleX,e.scale,e.originX),XS(n.y,e.y,e.scaleY,e.scale,e.originY)}function lb(n,e){return sb(T5(n.getBoundingClientRect(),e))}function I5(n,e,t){const i=lb(n,t),{scroll:r}=e;return r&&(Gc(i.x,r.offset.x),Gc(i.y,r.offset.y)),i}const cb=({current:n})=>n?n.ownerDocument.defaultView:null,C5=new WeakMap;class R5{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(rf(f).point)},s=(f,m)=>{const{drag:y,dragPropagation:x,onDragStart:T}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=vO(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ki(S=>{let b=this.getAxisMotionValue(S).get()||0;if(is.test(b)){const{projection:N}=this.visualElement;if(N&&N.layout){const M=N.layout.layoutBox[S];M&&(b=Ci(M)*(parseFloat(b)/100))}}this.originPoint[S]=b}),T&&xt.postRender(()=>T(f,m)),uv(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,m)=>{const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:T,onDrag:I}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:S}=m;if(x&&this.currentDirection===null){this.currentDirection=A5(S),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",m.point,S),this.updateAxis("y",m.point,S),this.visualElement.render(),I&&I(f,m)},l=(f,m)=>this.stop(f,m),u=()=>Ki(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new tb(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:cb(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&xt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Fg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=p5(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Uc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=y5(r.layoutBox,t):this.constraints=!1,this.elastic=w5(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ki(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=x5(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Uc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=I5(i,r.root,this.visualElement.getTransformPagePoint());let o=_5(r.layout.layoutBox,s);if(t){const l=t(E5(o));this.hasMutatedConstraints=!!l,l&&(o=sb(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Ki(f=>{if(!Fg(f,t,this.currentDirection))return;let m=u&&u[f]||{};o&&(m={min:0,max:0});const y=r?200:1e6,x=r?40:1e7,T={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(f,T)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return uv(this.visualElement,e),i.start(c1(e,i,0,t,this.visualElement,!1))}stopAnimation(){Ki(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ki(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Ki(t=>{const{drag:i}=this.getProps();if(!Fg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-At(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Uc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Ki(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=v5({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Ki(o=>{if(!Fg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(At(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;C5.set(this.visualElement,this);const e=this.visualElement.current,t=ed(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();Uc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),xt.read(i);const o=Ed(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Ki(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=u[f].translate,m.set(m.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=_v,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Fg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function A5(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class b5 extends aa{constructor(e){super(e),this.removeGroupControls=Ii,this.removeListeners=Ii,this.controls=new R5(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ii}unmount(){this.removeGroupControls(),this.removeListeners()}}const qS=n=>(e,t)=>{n&&xt.postRender(()=>n(e,t))};class P5 extends aa{constructor(){super(...arguments),this.removePointerDownListener=Ii}onPointerDown(e){this.session=new tb(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:cb(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:qS(e),onStart:qS(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&xt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=ed(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const um={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function YS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Rh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ne.test(n))n=parseFloat(n);else return n;const t=YS(n,e.target.x),i=YS(n,e.target.y);return`${t}% ${i}%`}},k5={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ta.parse(n);if(r.length>5)return i;const s=ta.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=At(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class N5 extends H.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;QL(D5),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),um.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||xt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Vx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function ub(n){const[e,t]=K2(),i=H.useContext(kx);return _.jsx(N5,{...n,layoutGroup:i,switchLayoutGroup:H.useContext(J2),isPresent:e,safeToRemove:t})}const D5={borderRadius:{...Rh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Rh,borderTopRightRadius:Rh,borderBottomLeftRadius:Rh,borderBottomRightRadius:Rh,boxShadow:k5};function M5(n,e,t){const i=In(n)?n:su(n);return i.start(c1("",i,e,t)),i.animation}function L5(n){return n instanceof SVGElement&&n.tagName!=="svg"}const O5=(n,e)=>n.depth-e.depth;class F5{constructor(){this.children=[],this.isDirty=!1}add(e){Qx(this.children,e),this.isDirty=!0}remove(e){Jx(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(O5),this.isDirty=!1,this.children.forEach(e)}}function V5(n,e){const t=rs.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Ks(i),n(s-e))};return xt.read(i,!0),()=>Ks(i)}const hb=["TopLeft","TopRight","BottomLeft","BottomRight"],j5=hb.length,ZS=n=>typeof n=="string"?parseFloat(n):n,QS=n=>typeof n=="number"||Ne.test(n);function z5(n,e,t,i,r,s){r?(n.opacity=At(0,t.opacity!==void 0?t.opacity:1,U5(i)),n.opacityExit=At(e.opacity!==void 0?e.opacity:1,0,B5(i))):s&&(n.opacity=At(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<j5;o++){const l=`border${hb[o]}Radius`;let u=JS(e,l),h=JS(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||QS(u)===QS(h)?(n[l]=Math.max(At(ZS(u),ZS(h),i),0),(is.test(h)||is.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=At(e.rotate||0,t.rotate||0,i))}function JS(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const U5=db(0,.5,bA),B5=db(.5,.95,Ii);function db(n,e,t){return i=>i<n?0:i>e?1:t(iu(n,e,i))}function eI(n,e){n.min=e.min,n.max=e.max}function Gi(n,e){eI(n.x,e.x),eI(n.y,e.y)}function tI(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function nI(n,e,t,i,r){return n-=e,n=Dm(n,1/t,i),r!==void 0&&(n=Dm(n,1/r,i)),n}function W5(n,e=0,t=1,i=.5,r,s=n,o=n){if(is.test(e)&&(e=parseFloat(e),e=At(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=At(s.min,s.max,i);n===s&&(l-=e),n.min=nI(n.min,e,t,l,r),n.max=nI(n.max,e,t,l,r)}function iI(n,e,[t,i,r],s,o){W5(n,e[t],e[i],e[r],e.scale,s,o)}const G5=["x","scaleX","originX"],$5=["y","scaleY","originY"];function rI(n,e,t,i){iI(n.x,e,G5,t?t.x:void 0,i?i.x:void 0),iI(n.y,e,$5,t?t.y:void 0,i?i.y:void 0)}function sI(n){return n.translate===0&&n.scale===1}function fb(n){return sI(n.x)&&sI(n.y)}function oI(n,e){return n.min===e.min&&n.max===e.max}function K5(n,e){return oI(n.x,e.x)&&oI(n.y,e.y)}function aI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function gb(n,e){return aI(n.x,e.x)&&aI(n.y,e.y)}function lI(n){return Ci(n.x)/Ci(n.y)}function cI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class H5{constructor(){this.members=[]}add(e){Qx(this.members,e),e.scheduleRender()}remove(e){if(Jx(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function X5(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:m,rotateY:y,skewX:x,skewY:T}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),m&&(i+=`rotateX(${m}deg) `),y&&(i+=`rotateY(${y}deg) `),x&&(i+=`skewX(${x}deg) `),T&&(i+=`skewY(${T}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const za={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Bh=typeof window<"u"&&window.MotionDebug!==void 0,l0=["","X","Y","Z"],q5={visibility:"hidden"},uI=1e3;let Y5=0;function c0(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function mb(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=EA(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",xt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&mb(i)}function pb({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=Y5++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Bh&&(za.totalNodes=za.resolvedTargetDeltas=za.recalculatedProjection=0),this.nodes.forEach(J5),this.nodes.forEach(rV),this.nodes.forEach(sV),this.nodes.forEach(eV),Bh&&window.MotionDebug.record(za)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new F5)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new e1),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=L5(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let m;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=V5(y,250),um.hasAnimatedSinceResize&&(um.hasAnimatedSinceResize=!1,this.nodes.forEach(dI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:y,hasRelativeTargetChanged:x,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||uV,{onLayoutAnimationStart:S,onLayoutAnimationComplete:b}=f.getProps(),N=!this.targetLayout||!gb(this.targetLayout,T)||x,M=!y&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||M||y&&(N||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,M);const R={...Xx(I,"layout"),onPlay:S,onComplete:b};(f.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R)}else y||dI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ks(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(oV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&mb(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hI);return}this.isUpdating||this.nodes.forEach(nV),this.isUpdating=!1,this.nodes.forEach(iV),this.nodes.forEach(Z5),this.nodes.forEach(Q5),this.clearAllSnapshots();const l=rs.now();xn.delta=Hs(0,1e3/60,l-xn.timestamp),xn.timestamp=l,xn.isProcessing=!0,J_.update.process(xn),J_.preRender.process(xn),J_.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Vx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(tV),this.sharedNodes.forEach(aV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!fb(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||ja(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),hV(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(dV))){const{scroll:f}=this.root;f&&(Gc(u.x,f.offset.x),Gc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(Gi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:m,options:y}=f;f!==this.root&&m&&y.layoutScroll&&(m.wasRoot&&Gi(u,o),Gc(u.x,m.offset.x),Gc(u.y,m.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();Gi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&$c(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),ja(f.latestValues)&&$c(u,f.latestValues)}return ja(this.latestValues)&&$c(u,this.latestValues),u}removeTransform(o){const l=Ut();Gi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!ja(h.latestValues))continue;vv(h.latestValues)&&h.updateSnapshot();const f=Ut(),m=h.measurePageBox();Gi(f,m),rI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return ja(this.latestValues)&&rI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:y}=this.options;if(!(!this.layout||!(m||y))){if(this.resolvedRelativeTargetAt=xn.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),nd(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),m5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Gi(this.target,this.layout.layoutBox),ab(this.target,this.targetDelta)):Gi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),nd(this.relativeTargetOrigin,this.target,x.target),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Bh&&za.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||vv(this.parent.latestValues)||ob(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;Gi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,x=this.treeScale.y;S5(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:T}=l;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(tI(this.prevProjectionDelta.x,this.projectionDelta.x),tI(this.prevProjectionDelta.y,this.projectionDelta.y)),td(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==x||!cI(this.projectionDelta.x,this.prevProjectionDelta.x)||!cI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T)),Bh&&za.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Wc(),this.projectionDelta=Wc(),this.projectionDeltaWithTransform=Wc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},m=Wc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),x=u?u.source:void 0,T=this.layout?this.layout.source:void 0,I=x!==T,S=this.getStack(),b=!S||S.members.length<=1,N=!!(I&&!b&&this.options.crossfade===!0&&!this.path.some(cV));this.animationProgress=0;let M;this.mixTargetDelta=R=>{const D=R/1e3;fI(m.x,o.x,D),fI(m.y,o.y,D),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(nd(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),lV(this.relativeTarget,this.relativeTargetOrigin,y,D),M&&K5(this.relativeTarget,M)&&(this.isProjectionDirty=!1),M||(M=Ut()),Gi(M,this.relativeTarget)),I&&(this.animationValues=f,z5(f,h,this.latestValues,D,N,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ks(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xt.update(()=>{um.hasAnimatedSinceResize=!0,this.currentAnimation=M5(0,uI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(uI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&yb(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const m=Ci(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+m;const y=Ci(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}Gi(l,u),$c(l,f),td(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new H5),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&c0("z",o,h,this.animationValues);for(let f=0;f<l0.length;f++)c0(`rotate${l0[f]}`,o,h,this.animationValues),c0(`skew${l0[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return q5;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=lm(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=lm(o?.pointerEvents)||""),this.hasProjected&&!ja(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const y=m.animationValues||m.latestValues;this.applyTransformsToTarget(),h.transform=X5(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x,y:T}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${T.origin*100}% 0`,m.animationValues?h.opacity=m===this?(u=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=m===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const I in Am){if(y[I]===void 0)continue;const{correct:S,applyTo:b}=Am[I],N=h.transform==="none"?y[I]:S(y[I],m);if(b){const M=b.length;for(let R=0;R<M;R++)h[b[R]]=N}else h[I]=N}return this.options.layoutId&&(h.pointerEvents=m===this?lm(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(hI),this.root.sharedNodes.clear()}}}function Z5(n){n.updateLayout()}function Q5(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Ki(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],x=Ci(y);y.min=i[m].min,y.max=y.min+x}):yb(s,t.layoutBox,i)&&Ki(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],x=Ci(i[m]);y.max=y.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[m].max=n.relativeTarget[m].min+x)});const l=Wc();td(l,i,t.layoutBox);const u=Wc();o?td(u,n.applyTransform(r,!0),t.measuredBox):td(u,i,t.layoutBox);const h=!fb(l);let f=!1;if(!n.resumeFrom){const m=n.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:y,layout:x}=m;if(y&&x){const T=Ut();nd(T,t.layoutBox,y.layoutBox);const I=Ut();nd(I,i,x.layoutBox),gb(T,I)||(f=!0),m.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=T,n.relativeParent=m)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function J5(n){Bh&&za.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function eV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function tV(n){n.clearSnapshot()}function hI(n){n.clearMeasurements()}function nV(n){n.isLayoutDirty=!1}function iV(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function dI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function rV(n){n.resolveTargetDelta()}function sV(n){n.calcProjection()}function oV(n){n.resetSkewAndRotation()}function aV(n){n.removeLeadSnapshot()}function fI(n,e,t){n.translate=At(e.translate,0,t),n.scale=At(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function gI(n,e,t,i){n.min=At(e.min,t.min,i),n.max=At(e.max,t.max,i)}function lV(n,e,t,i){gI(n.x,e.x,t.x,i),gI(n.y,e.y,t.y,i)}function cV(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const uV={duration:.45,ease:[.4,0,.1,1]},mI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),pI=mI("applewebkit/")&&!mI("chrome/")?Math.round:Ii;function yI(n){n.min=pI(n.min),n.max=pI(n.max)}function hV(n){yI(n.x),yI(n.y)}function yb(n,e,t){return n==="position"||n==="preserve-aspect"&&!g5(lI(e),lI(t),.2)}function dV(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const fV=pb({attachResizeListener:(n,e)=>Ed(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),u0={current:void 0},_b=pb({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!u0.current){const n=new fV({});n.mount(window),n.setOptions({layoutScroll:!0}),u0.current=n}return u0.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),gV={pan:{Feature:P5},drag:{Feature:b5,ProjectionNode:_b,MeasureLayout:ub}};function _I(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&xt.postRender(()=>s(e,rf(e)))}class mV extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=gO(e,t=>(_I(this.node,t,"Start"),i=>_I(this.node,i,"End"))))}unmount(){}}class pV extends aa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=nf(Ed(this.node.current,"focus",()=>this.onFocus()),Ed(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function vI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&xt.postRender(()=>s(e,rf(e)))}class yV extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=_O(e,t=>(vI(this.node,t,"Start"),(i,{success:r})=>vI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const wv=new WeakMap,h0=new WeakMap,_V=n=>{const e=wv.get(n.target);e&&e(n)},vV=n=>{n.forEach(_V)};function xV({root:n,...e}){const t=n||document;h0.has(t)||h0.set(t,{});const i=h0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(vV,{root:n,...e})),i[r]}function wV(n,e,t){const i=xV(e);return wv.set(n,t),i.observe(n),()=>{wv.delete(n),i.unobserve(n)}}const EV={some:0,all:1};class TV extends aa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:EV[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),y=h?f:m;y&&y(u)};return wV(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(SV(e,t))&&this.startObserver()}unmount(){}}function SV({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const IV={inView:{Feature:TV},tap:{Feature:yV},focus:{Feature:pV},hover:{Feature:mV}},CV={layout:{ProjectionNode:_b,MeasureLayout:ub}},Ev={current:null},vb={current:!1};function RV(){if(vb.current=!0,!!Nx)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ev.current=n.matches;n.addListener(e),e()}else Ev.current=!1}const AV=[...WA,Mn,ta],bV=n=>AV.find(BA(n)),xI=new WeakMap;function PV(n,e,t){for(const i in e){const r=e[i],s=t[i];if(In(r))n.addValue(i,r);else if(In(s))n.addValue(i,su(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,su(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const wI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class kV{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=o1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=rs.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,xt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=bp(t),this.isVariantNode=Z2(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in y){const T=y[x];u[x]!==void 0&&In(T)&&T.set(u[x],!1)}}mount(e){this.current=e,xI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),vb.current||RV(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ev.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){xI.delete(this.current),this.projection&&this.projection.unmount(),Ks(this.notifyUpdate),Ks(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=kl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&xt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ru){const t=ru[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<wI.length;i++){const r=wI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=PV(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=su(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(zA(r)||kA(r))?r=parseFloat(r):!bV(r)&&ta.test(t)&&(r=FA(e,t)),this.setBaseTarget(e,In(r)?r.get():r)),In(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=zx(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!In(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new e1),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class xb extends kV{constructor(){super(...arguments),this.KeyframeResolver=GA}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;In(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function NV(n){return window.getComputedStyle(n)}class DV extends xb{constructor(){super(...arguments),this.type="html",this.renderInstance=oA}readValueFromInstance(e,t){if(kl.has(t)){const i=s1(t);return i&&i.default||0}else{const i=NV(e),r=(iA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return lb(e,t)}build(e,t,i){Wx(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return Hx(e,t,i)}}class MV extends xb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(kl.has(t)){const i=s1(t);return i&&i.default||0}return t=aA.has(t)?t:Fx(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return uA(e,t,i)}build(e,t,i){Gx(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){lA(e,t,i,r)}mount(e){this.isSVGTag=Kx(e.tagName),super.mount(e)}}const LV=(n,e)=>jx(n)?new MV(e):new DV(e,{allowProjection:n!==H.Fragment}),OV=aO({...s5,...IV,...gV,...CV},LV),Me=EL(OV);function wb(n){const e=Pl(()=>su(n)),{isStatic:t}=H.useContext(Cp);if(t){const[,i]=H.useState(n);H.useEffect(()=>e.on("change",i),[])}return e}function Eb(n,e){const t=wb(e()),i=()=>t.set(e());return i(),Dx(()=>{const r=()=>xt.preRender(i,!1,!0),s=n.map(o=>o.on("change",r));return()=>{s.forEach(o=>o()),Ks(i)}}),t}const FV=n=>n&&typeof n=="object"&&n.mix,VV=n=>FV(n)?n.mix:void 0;function jV(...n){const e=!Array.isArray(n[0]),t=e?0:-1,i=n[0+t],r=n[1+t],s=n[2+t],o=n[3+t],l=ZA(r,s,{mixer:VV(s[0]),...o});return e?l(i):l}function zV(n){Qh.current=[],n();const e=Eb(Qh.current,n);return Qh.current=void 0,e}function UV(n,e,t,i){if(typeof n=="function")return zV(n);const r=typeof e=="function"?e:jV(e,t,i);return Array.isArray(n)?EI(n,r):EI([n],([s])=>r(s))}function EI(n,e){const t=Pl(()=>[]);return Eb(n,()=>{t.length=0;const i=n.length;for(let r=0;r<i;r++)t[r]=n[r].get();return e(t)})}const Tb=H.createContext(null);function BV(n,e,t,i){if(!i)return n;const r=n.findIndex(f=>f.value===e);if(r===-1)return n;const s=i>0?1:-1,o=n[r+s];if(!o)return n;const l=n[r],u=o.layout,h=At(u.min,u.max,.5);return s===1&&l.layout.max+t>h||s===-1&&l.layout.min+t<h?wO(n,r,r+s):n}function WV({children:n,as:e="ul",axis:t="y",onReorder:i,values:r,...s},o){const l=Pl(()=>Me[e]),u=[],h=H.useRef(!1),f={axis:t,registerItem:(m,y)=>{const x=u.findIndex(T=>m===T.value);x!==-1?u[x].layout=y[t]:u.push({value:m,layout:y[t]}),u.sort(KV)},updateOrder:(m,y,x)=>{if(h.current)return;const T=BV(u,m,y,x);u!==T&&(h.current=!0,i(T.map($V).filter(I=>r.indexOf(I)!==-1)))}};return H.useEffect(()=>{h.current=!1}),_.jsx(l,{...s,ref:o,ignoreStrict:!0,children:_.jsx(Tb.Provider,{value:f,children:n})})}const GV=H.forwardRef(WV);function $V(n){return n.value}function KV(n,e){return n.layout.min-e.layout.min}function TI(n,e=0){return In(n)?n:wb(e)}function HV({children:n,style:e={},value:t,as:i="li",onDrag:r,layout:s=!0,...o},l){const u=Pl(()=>Me[i]),h=H.useContext(Tb),f={x:TI(e.x),y:TI(e.y)},m=UV([f.x,f.y],([I,S])=>I||S?1:"unset"),{axis:y,registerItem:x,updateOrder:T}=h;return _.jsx(u,{drag:y,...o,dragSnapToOrigin:!0,style:{...e,x:f.x,y:f.y,zIndex:m},layout:s,onDrag:(I,S)=>{const{velocity:b}=S;b[y]&&T(t,f[y].get(),b[y]),r&&r(I,S)},onLayoutMeasure:I=>x(t,I),ref:l,ignoreStrict:!0,children:n})}const XV=H.forwardRef(HV),ti={ADD:"add",REMOVE:"remove"},au={PROPERTYCHANGE:"propertychange"},We={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Np{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function qV(n,e,t){let i,r;t=t||Bs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Bs(n,e){return n>e?1:n<e?-1:0}function YV(n,e){return n<e?1:n>e?-1:0}function u1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function ZV(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function h1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function la(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function QV(n,e,t){const i=e||Bs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Td(){return!0}function Dp(){return!1}function Sd(){}function Sb(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!la(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function JV(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function sf(n){for(const e in n)delete n[e]}function lu(n){let e;for(e in n)return!1;return!e}class Qs{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Mp extends Np{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Qs(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,Sd);delete o[i]}return u}disposeInternal(){this.listeners_&&sf(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Sd,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function it(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Mm(n,e,t,i){return it(n,e,t,i,!0)}function bt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),sf(n))}class of extends Mp{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(We.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=it(this,e[s],t);return r}return it(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Mm(this,e[s],t)}else i=Mm(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)ej(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}of.prototype.on;of.prototype.once;of.prototype.un;function ej(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)bt(n[e]);else bt(n)}function nt(){throw new Error("Unimplemented abstract method.")}let tj=0;function rt(n){return n.ol_uid||(n.ol_uid=String(++tj))}class SI extends Qs{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class us extends of{constructor(e){super(),this.on,this.once,this.un,rt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new SI(i,e,t)),i=au.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new SI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],lu(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const II={LENGTH:"length"};class Vg extends Qs{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Xi extends us{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(II.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Vg(ti.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Vg(ti.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Vg(ti.REMOVE,r,e)),this.dispatchEvent(new Vg(ti.ADD,t,e))}updateLength_(){this.set(II.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function lt(n,e){if(!n)throw new Error(e)}class cu extends us{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new cu(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(bt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=it(e,We.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?nj(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function nj(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(lt(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ln={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function CI(n){const e=Ji();for(let t=0,i=n.length;t<i;++t)id(e,n[t]);return e}function d1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function Ib(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Cb(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function uu(n,e){return Rb(n,e[0],e[1])}function Wh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function Rb(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Tv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=ln.UNKNOWN;return o<t?u=u|ln.LEFT:o>r&&(u=u|ln.RIGHT),l<i?u=u|ln.BELOW:l>s&&(u=u|ln.ABOVE),u===ln.UNKNOWN&&(u=ln.INTERSECTING),u}function Ji(){return[1/0,1/0,-1/0,-1/0]}function na(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Lp(n){return na(1/0,1/0,-1/0,-1/0,n)}function Ab(n,e){const t=n[0],i=n[1];return na(t,i,t,i,e)}function f1(n,e,t,i,r){const s=Lp(r);return bb(s,n,e,t,i)}function Id(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function ij(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function id(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function bb(n,e,t,i,r){for(;t<i;t+=r)rj(n,e[t],e[t+1]);return n}function rj(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function Pb(n,e){let t;return t=e(Op(n)),t||(t=e(Fp(n)),t)||(t=e(Vp(n)),t)||(t=e(Nl(n)),t)?t:!1}function Sv(n){let e=0;return jp(n)||(e=ft(n)*Bn(n)),e}function Op(n){return[n[0],n[1]]}function Fp(n){return[n[2],n[1]]}function gl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function sj(n,e){let t;if(e==="bottom-left")t=Op(n);else if(e==="bottom-right")t=Fp(n);else if(e==="top-left")t=Nl(n);else if(e==="top-right")t=Vp(n);else throw new Error("Invalid corner");return t}function Iv(n,e,t,i,r){const[s,o,l,u,h,f,m,y]=kb(n,e,t,i);return na(Math.min(s,l,h,m),Math.min(o,u,f,y),Math.max(s,l,h,m),Math.max(o,u,f,y),r)}function kb(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,m=s*l,y=n[0],x=n[1];return[y-u+m,x-h-f,y-u-m,x-h+f,y+u-m,x+h+f,y+u+m,x+h-f,y-u+m,x-h-f]}function Bn(n){return n[3]-n[1]}function ol(n,e,t){const i=t||Ji();return oi(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Lp(i),i}function Nl(n){return[n[0],n[3]]}function Vp(n){return[n[2],n[3]]}function ft(n){return n[2]-n[0]}function oi(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function jp(n){return n[2]<n[0]||n[3]<n[1]}function oj(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function aj(n,e,t){let i=!1;const r=Tv(n,e),s=Tv(n,t);if(r===ln.INTERSECTING||s===ln.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],m=e[1],y=t[0],x=t[1],T=(x-m)/(y-f);let I,S;s&ln.ABOVE&&!(r&ln.ABOVE)&&(I=y-(x-h)/T,i=I>=o&&I<=u),!i&&s&ln.RIGHT&&!(r&ln.RIGHT)&&(S=x-(y-u)*T,i=S>=l&&S<=h),!i&&s&ln.BELOW&&!(r&ln.BELOW)&&(I=y-(x-l)/T,i=I>=o&&I<=u),!i&&s&ln.LEFT&&!(r&ln.LEFT)&&(S=x-(y-o)*T,i=S>=l&&S<=h)}return i}function Nb(n,e){const t=e.getExtent(),i=gl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ft(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function Db(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];Nb(n,e);const r=ft(i);if(ft(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function lj(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return qc(n,e,t,i)}function qc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function cj(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function RI(n){return n*180/Math.PI}function qo(n){return n*Math.PI/180}function al(n,e){const t=n%e;return t*e<0?t+e:t}function Ei(n,e,t){return n+t*(e-n)}function af(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function KX(n,e){return Math.round(af(n,e))}function jg(n,e){return Math.floor(af(n,e))}function zg(n,e){return Math.ceil(af(n,e))}function Cv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function uj(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Lm(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function g1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function hj(n,e){return n[0]*=e,n[1]*=e,n}function Mb(n,e){if(e.canWrapX()){const t=ft(e.getExtent()),i=dj(n,e,t);i&&(n[0]-=i*t)}return n}function dj(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ft(i),r=Math.floor((n[0]-i[0])/t)),r}function Lb(...n){console.warn(...n)}const hu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class m1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||hu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const lf=6378137,Kc=Math.PI*lf,fj=[-Kc,-Kc,Kc,Kc],gj=[-180,-85,180,85],Ug=lf*Math.log(Math.tan(Math.PI/2));class xc extends m1{constructor(e){super({code:e,units:"m",extent:fj,global:!0,worldExtent:gj,getPointResolution:function(t,i){return t/Math.cosh(i[1]/lf)}})}}const AI=[new xc("EPSG:3857"),new xc("EPSG:102100"),new xc("EPSG:102113"),new xc("EPSG:900913"),new xc("http://www.opengis.net/def/crs/EPSG/0/3857"),new xc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function mj(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Kc*n[s]/180;let o=lf*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Ug?o=Ug:o<-Ug&&(o=-Ug),e[s+1]=o}return e}function pj(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Kc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/lf))/Math.PI-90;return e}const yj=6378137,bI=[-180,-90,180,90],_j=Math.PI*yj/180;class Oa extends m1{constructor(e,t){super({code:e,units:"degrees",extent:bI,axisOrientation:t,global:!0,metersPerUnit:_j,worldExtent:bI})}}const PI=[new Oa("CRS:84"),new Oa("EPSG:4326","neu"),new Oa("urn:ogc:def:crs:OGC:1.3:CRS84"),new Oa("urn:ogc:def:crs:OGC:2:84"),new Oa("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Oa("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Oa("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Rv={};function vj(n){return Rv[n]||Rv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function xj(n,e){Rv[n]=e}let Yc={};function Cd(n,e,t){const i=n.getCode(),r=e.getCode();i in Yc||(Yc[i]={}),Yc[i][r]=t}function d0(n,e){return n in Yc&&e in Yc[n]?Yc[n][e]:null}const Om=.9996,Zi=.00669438,zp=Zi*Zi,Up=zp*Zi,Qa=Zi/(1-Zi),kI=Math.sqrt(1-Zi),du=(1-kI)/(1+kI),Ob=du*du,p1=Ob*du,y1=p1*du,Fb=y1*du,Vb=1-Zi/4-3*zp/64-5*Up/256,wj=3*Zi/8+3*zp/32+45*Up/1024,Ej=15*zp/256+45*Up/1024,Tj=35*Up/3072,Sj=3/2*du-27/32*p1+269/512*Fb,Ij=21/16*Ob-55/32*y1,Cj=151/96*p1-417/128*Fb,Rj=1097/512*y1,Fm=6378137;function Aj(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Om/(Fm*Vb),l=o+Sj*Math.sin(2*o)+Ij*Math.sin(4*o)+Cj*Math.sin(6*o)+Rj*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),m=u/f,y=m*m,x=y*y,T=1-Zi*h,I=Math.sqrt(1-Zi*h),S=Fm/I,b=(1-Zi)/T,N=Qa*f**2,M=N*N,R=i/(S*Om),D=R*R,j=D*R,k=j*R,A=k*R,L=A*R,V=l-m/b*(D/2-k/24*(5+3*y+10*N-4*M-9*Qa))+L/720*(61+90*y+298*N+45*x-252*Qa-3*M);let z=(R-j/6*(1+2*y+N)+A/120*(5-2*N+28*y-3*M+8*Qa+24*x))/f;return z=Cv(z+qo(jb(t.number)),-Math.PI,Math.PI),[RI(z),RI(V)]}const NI=-80,DI=84,bj=-180,Pj=180;function kj(n,e,t){n=Cv(n,bj,Pj),e<NI?e=NI:e>DI&&(e=DI);const i=qo(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=qo(n),f=jb(t.number),m=qo(f),y=Fm/Math.sqrt(1-Zi*r**2),x=Qa*s**2,T=s*Cv(h-m,-Math.PI,Math.PI),I=T*T,S=I*T,b=S*T,N=b*T,M=N*T,R=Fm*(Vb*i-wj*Math.sin(2*i)+Ej*Math.sin(4*i)-Tj*Math.sin(6*i)),D=Om*y*(T+S/6*(1-l+x)+N/120*(5-18*l+u+72*x-58*Qa))+5e5;let j=Om*(R+y*o*(I/2+b/24*(5-l+9*x+4*x**2)+M/720*(61-58*l+u+600*x-330*Qa)));return t.north||(j+=1e7),[D,j]}function jb(n){return(n-1)*6-180+3}const Nj=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function zb(n){let e=0;for(const r of Nj){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function MI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function Dj(n){return zb(n)?new m1({code:n,units:"m"}):null}function Mj(n){const e=zb(n.getCode());return e?{forward:MI(kj,e),inverse:MI(Aj,e)}:null}const Lj=63710088e-1;function LI(n,e,t){t=t||Lj;const i=qo(n[1]),r=qo(e[1]),s=(r-i)/2,o=qo(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const Oj=[Mj],Fj=[Dj];let Av=!0;function Ub(n){Av=!1}function _1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function bv(n){xj(n.getCode(),n),Cd(n,n,_1)}function Vj(n){n.forEach(bv)}function ci(n){if(typeof n!="string")return n;const e=vj(n);if(e)return e;for(const t of Fj){const i=t(n);if(i)return i}return null}function Vm(n,e,t,i){n=ci(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/hu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=x1(n,ci("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=LI(h.slice(0,2),h.slice(2,4)),m=LI(h.slice(4,6),h.slice(6,8));r=(f+m)/2}const u=i?hu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function OI(n){Vj(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Cd(e,t,_1)})})}function jj(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Cd(r,s,t),Cd(s,r,i)})})}function v1(n,e){return n?typeof n=="string"?ci(n):n:ci(e)}function zj(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function ml(n,e){return Ub(),Bp(n,"EPSG:4326","EPSG:3857")}function FI(n,e){const t=Bp(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=al(i+180,360)-180),t}function hm(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||x1(n,e)===_1)&&t}function x1(n,e){const t=n.getCode(),i=e.getCode();let r=d0(t,i);if(r)return r;let s=null,o=null;for(const u of Oj)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=f0(s.inverse,o.forward);else{const u=d0(t,l);u&&(r=f0(u,o.forward))}else{const u=d0(l,i);u&&(r=f0(s.inverse,u))}return r&&(bv(n),bv(e),Cd(n,e,r)),r}function f0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function jm(n,e){const t=ci(n),i=ci(e);return x1(t,i)}function Bp(n,e,t){const i=jm(e,t);if(!i){const r=ci(e).getCode(),s=ci(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Pv(n,e){return n}function Ds(n,e){return Av&&!Lm(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Av=!1,Lb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Bb(n,e){return n}function $o(n,e){return n}function Uj(){OI(AI),OI(PI),jj(PI,AI,mj,pj)}Uj();new Array(6);function Er(){return[1,0,0,1,0,0]}function Bj(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Xs(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function Wb(n,e){const t=Wj(e);lt(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function Wj(n){return n[0]*n[3]-n[1]*n[2]}const Gj=[1e5,1e5,1e5,1e5,2,2];function $j(n){return"matrix("+n.join(", ")+")"}function kv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Kj(n,e){const t=kv(n),i=kv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*Gj[r])!==0)return!1;return!0}function Yo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let m=2;m<o;m++)s[l++]=n[u+m]}return s&&s.length!=l&&(s.length=l),s}function Gb(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let m=0;for(let y=e;y<t;y+=i){const x=n[y]-h,T=n[y+1]-f;o[m++]=h+x*l-T*u,o[m++]=f+x*u+T*l;for(let I=y+2;I<y+i;++I)o[m++]=n[I]}return o&&o.length!=m&&(o.length=m),o}function Hj(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let m=e;m<t;m+=i){const y=n[m]-u,x=n[m+1]-h;l[f++]=u+r*y,l[f++]=h+s*x;for(let T=m+2;T<m+i;++T)l[f++]=n[T]}return l&&l.length!=f&&(l.length=f),l}function Xj(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const VI=Er(),qj=[NaN,NaN];class Yj extends us{constructor(){super(),this.extent_=Ji(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Sb((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return nt()}closestPointXY(e,t,i,r){return nt()}containsXY(e,t){return this.closestPointXY(e,t,qj,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return nt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Lp(t),this.extentRevision_=this.getRevision()}return oj(this.extent_,e)}rotate(e,t){nt()}scale(e,t,i){nt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return nt()}getType(){return nt()}applyTransform(e){nt()}intersectsExtent(e){return nt()}translate(e,t){nt()}transform(e,t){const i=ci(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(u);Xs(VI,h[0],h[3],f,-f,0,0,0);const m=Yo(s,0,s.length,l,VI,o),y=jm(i,t);return y?y(m,m,l):m}:jm(i,t);return this.applyTransform(r),this}}class w1 extends Yj{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return f1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return nt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=jI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){nt()}setLayout(e,t,i){let r;if(e)r=jI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=Zj(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Gb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=gl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Hj(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Xj(i,0,i.length,r,e,t,i),this.changed()}}}function Zj(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function jI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function Qj(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Yo(i,0,i.length,r,e,t)}function zI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let m;if(h===0&&f===0)m=e;else{const y=((r-l)*h+(s-u)*f)/(h*h+f*f);if(y>1)m=t;else if(y>0){for(let x=0;x<i;++x)o[x]=Ei(n[e+x],n[t+x],y);o.length=i;return}else m=e}for(let y=0;y<i;++y)o[y]=n[m+y];o.length=i}function $b(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=qc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function Kb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=$b(n,e,l,i,r),e=l}return r}function HX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=Kb(n,e,l,i,r),e=l[l.length-1]}return r}function Hb(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let m,y;if(r===0){if(y=qc(o,l,n[e],n[e+1]),y<h){for(m=0;m<i;++m)u[m]=n[e+m];return u.length=i,y}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(zI(n,x-i,x,i,o,l,f),y=qc(o,l,f[0],f[1]),y<h){for(h=y,m=0;m<i;++m)u[m]=f[m];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(zI(n,t-i,e,i,o,l,f),y=qc(o,l,f[0],f[1]),y<h)){for(h=y,m=0;m<i;++m)u[m]=f[m];u.length=i}return h}function Xb(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const x=t[m];h=Hb(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function XX(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const x=t[m];h=Xb(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function Jj(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function qb(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function Yb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=qb(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function qX(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Yb(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Hc(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function zm(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=Hc(n,e,u,i,r[s]),e=u}return r.length=s,r}function UI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:zm(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function BI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],m=n[e+1],y=0;const x=[0];for(let S=e+i;S<t;S+=i){const b=n[S],N=n[S+1];y+=Math.sqrt((b-f)*(b-f)+(N-m)*(N-m)),x.push(y),f=b,m=N}const T=r*y,I=qV(x,T);I<0?(u=(T-x[-I-2])/(x[-I-1]-x[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:Ei(n[l+f],n[l+i+f],u);return s}function WI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const y=l+u>>1;r<n[(y+1)*i-1]?u=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],m=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(Ei(n[(l-1)*i+y],n[l*i+y],m));return o.push(r),o}function YX(n,e,t,i,r,s,o){if(o)return WI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return WI(n,e,f,i,r,!1);e=f}}return null}function e4(n,e,t,i,r){return!Pb(r,function(o){return!Ja(n,e,t,i,o[0],o[1])})}function Ja(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function E1(n,e,t,i,r,s){if(t.length===0||!Ja(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Ja(n,t[o-1],t[o],i,r,s))return!1;return!0}function ZX(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(E1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function t4(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function T1(n,e,t,i,r,s){return s=s??bb(Ji(),n,e,t,i),oi(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:t4(n,e,t,i,function(o,l){return aj(r,o,l)}):!1}function QX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(T1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function Zb(n,e,t,i,r){return!!(T1(n,e,t,i,r)||Ja(n,e,t,i,r[0],r[1])||Ja(n,e,t,i,r[0],r[3])||Ja(n,e,t,i,r[2],r[1])||Ja(n,e,t,i,r[2],r[3]))}function Qb(n,e,t,i,r){if(!Zb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(e4(n,t[s-1],t[s],i,r)&&!T1(n,t[s-1],t[s],i,r))return!1;return!0}function JX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(Qb(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function n4(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function S1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const m=h.pop(),y=h.pop();let x=0;const T=n[y],I=n[y+1],S=n[m],b=n[m+1];for(let N=y+i;N<m;N+=i){const M=n[N],R=n[N+1],D=lj(M,R,T,I,S,b);D>x&&(f=N,x=D)}x>r&&(u[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<m&&h.push(f,m))}for(let m=0;m<l;++m)u[m]&&(s[o++]=n[e+m*i],s[o++]=n[e+m*i+1]);return o}function i4(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=S1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function r4(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const m=Ua(n[e],r),y=Ua(n[e+1],r);if(e+=i,m==h&&y==f)continue;const x=h-l,T=f-u,I=m-l,S=y-u;if(x*S==T*I&&(x<0&&I<x||x==I||x>0&&I>x)&&(T<0&&S<T||T==S||T>0&&S>T)){h=m,f=y;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=m,f=y}return s[o++]=h,s[o++]=f,o}function I1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=r4(n,e,f,i,r,s,o),l.push(o),e=f}return o}function eq(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],m=[];o=I1(n,e,f,i,r,s,o,m),l.push(m),e=f[f.length-1]}return o}class pl extends w1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new pl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=qc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Ab(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Rb(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Jj(this.flatCoordinates,0,e,this.stride),this.changed()}}const qi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},yl=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",s4=yl.includes("safari")&&!yl.includes("chrom");s4&&(yl.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(yl));const o4=yl.includes("webkit")&&!yl.includes("edge"),Jb=yl.includes("macintosh"),a4=typeof devicePixelRatio<"u"?devicePixelRatio:1,Si=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,eP=typeof Image<"u"&&Image.prototype.decode,tP=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Be={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Jt(n,e,t,i){let r;return t&&t.length?r=t.shift():Si?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let g0;function Um(){return g0||(g0=Jt(1,1)),g0}function Wp(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function GI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function l4(n){for(;n.lastChild;)n.lastChild.remove()}function c4(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function nP(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Ko(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const C1=[NaN,NaN,NaN,0];let m0;function u4(){return m0||(m0=Jt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),m0}const h4=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,d4=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,f4=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,g4=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Bg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function rd(n){throw new Error('failed to parse "'+n+'" as color')}function iP(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(d4)||n.match(h4)||n.match(f4);if(s){const o=s[4],l=100/255;return[Dt(Bg(s[1],l)+.5|0,0,255),Dt(Bg(s[2],l)+.5|0,0,255),Dt(Bg(s[3],l)+.5|0,0,255),o!==void 0?Dt(Bg(o,100),0,1):1]}rd(n)}if(n.startsWith("#")){if(g4.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}rd(n)}const e=u4();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&rd(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return iP(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=af(r[3]/255,3),r}function m4(n){return typeof n=="string"?n:A1(n)}const p4=1024,Ah={};let p0=0;function y4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function y0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function _0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function v0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function x0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function $I(n){const e=v0(n[0]),t=v0(n[1]),i=v0(n[2]),r=x0(e*.222488403+t*.716873169+i*.06060791),s=500*(x0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-x0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function _4(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=_0(e),s=_0(e+t/500*Math.cos(i)),o=_0(e-t/200*Math.sin(i)),l=y0(s*3.021973625-r*1.617392459-o*.404875592),u=y0(s*-.943766287+r*1.916279586+o*.027607165),h=y0(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(u+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function R1(n){if(n==="none")return C1;if(Ah.hasOwnProperty(n))return Ah[n];if(p0>=p4){let t=0;for(const i in Ah)(t++&3)===0&&(delete Ah[i],--p0)}const e=iP(n);e.length!==4&&rd(n);for(const t of e)isNaN(t)&&rd(n);return Ah[n]=e,++p0,e}function fu(n){return Array.isArray(n)?n:R1(n)}function A1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function v4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Mm(i,We.LOAD,function(){o=!0,s||e()})];return i.src&&eP?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(Mm(i,We.ERROR,t)),function(){r=!1,l.forEach(bt)}}function x4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function w4(n,e){return e&&(n.src=e),n.src&&eP?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):x4(n)}class E4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=w0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=w0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=w0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Be.IDLE&&r.load(),r.getImageState()===Be.LOADING?r.ready().then(()=>{this.patternCache_[o]=Um().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Um().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function w0(n,e,t){const i=t?fu(t):"null";return e+":"+n+":"+i}const Yi=new E4;let bh=null;class rP extends Mp{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Be.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Be.LOADED){bh||(bh=Jt(1,1,void 0,{willReadFrequently:!0})),bh.drawImage(this.image_,0,0);try{bh.getImageData(0,0,1,1),this.tainted_=!1}catch{bh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(We.CHANGE)}handleImageError_(){this.imageState_=Be.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Be.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Jt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Be.IDLE){this.image_||this.initializeImage_(),this.imageState_=Be.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&w4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Be.LOADED)return;const t=this.image_,i=Jt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=m4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)e();else{const t=()=>{(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)&&(this.removeEventListener(We.CHANGE,t),e())};this.addEventListener(We.CHANGE,t)}})),this.ready_}}function Bm(n,e,t,i,r,s){let o=e===void 0?void 0:Yi.get(e,t,r);return o||(o=new rP(n,n&&"src"in n?n.src||void 0:e,t,i,r),Yi.set(e,t,r,o,s)),s&&o&&!Yi.getPattern(e,t,r)&&Yi.set(e,t,r,o,s),o}function Jr(n){return n?Array.isArray(n)?A1(n):typeof n=="object"&&"src"in n?T4(n):n:null}function T4(n){if(!n.offset||!n.size)return Yi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Yi.getPattern(e,void 0,n.color);if(t)return t;const i=Yi.get(n.src,"anonymous",null);if(i.getImageState()!==Be.LOADED)return null;const r=Jt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Bm(r.canvas,e,void 0,Be.LOADED,n.color,!0),Yi.getPattern(e,void 0,n.color)}class sP{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Wg="ol-hidden",cf="ol-unselectable",b1="ol-control",KI="ol-collapsed",S4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),HI=["style","variant","weight","size","lineHeight","family"],Nv={normal:400,bold:700},Dv=function(n){const e=n.match(S4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=HI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[HI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Nv&&(t.weight=Nv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},oP="10px sans-serif",ni="#000",gu="round",Ws=[],Gs=0,mu="round",Rd=10,Ad="#000",bd="center",Wm="middle",el=[0,0,0,0],Pd=1,Dc=new us;let Ph=null,XI;const Mv={},I4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function C4(n,e,t){return`${n} ${e} 16px "${t}"`}const R4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Dv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const m=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Nv[f.weight]||f.weight;return m===u&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=Dc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(sf(Mv),Dc.set(h,100)):(f+=10,Dc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Si?self.fonts:document.fonts);const o=Dv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(I4.has(h))continue;const f=C4(o.style,o.weight,h);Dc.get(f)===void 0&&(Dc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),A4=(function(){let n;return function(e){let t=Mv[e];if(t==null){if(Si){const i=Dv(e),r=aP(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Mv[e]=t}return t}})();function aP(n,e){return Ph||(Ph=Jt(1,1)),n!=XI&&(Ph.font=n,XI=Ph.font),Ph.measureText(e)}function lP(n,e){return aP(n,e).width}function qI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,lP(n,s)),0);return t[e]=i,i}function b4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const m=e[h];if(m===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const y=e[h+1]||n.font,x=lP(y,m);t.push(x),o+=x;const T=A4(y);i.push(T),u=Math.max(u,T)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function P4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=m=>m.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),k4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function k4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class N4 extends sP{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?af(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Er()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,m=s.length;f<m;f+=2){const y=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const T=y+this.imageAnchorX_,I=x+this.imageAnchorY_;Xs(l,T,I,1,1,h,-T,-I),o.save(),o.transform.apply(o,l),o.translate(T,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=Qj(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(oi(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),la(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:bd;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Jr(i||ni)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Ws;this.strokeState_={lineCap:r!==void 0?r:gu,lineDash:this.pixelRatio_===1?f:f.map(m=>m*this.pixelRatio_),lineDashOffset:(o||Gs)*this.pixelRatio_,lineJoin:l!==void 0?l:mu,lineWidth:(u!==void 0?u:Pd)*this.pixelRatio_,miterLimit:h!==void 0?h:Rd,strokeStyle:Jr(i||Ad)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:Jr(x||ni)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),T=i.getLineCap(),I=i.getLineDash(),S=i.getLineDashOffset(),b=i.getLineJoin(),N=i.getWidth(),M=i.getMiterLimit();this.textStrokeState_={lineCap:T!==void 0?T:gu,lineDash:I||Ws,lineDashOffset:S||Gs,lineJoin:b!==void 0?b:mu,lineWidth:N!==void 0?N:Pd,miterLimit:M!==void 0?M:Rd,strokeStyle:Jr(x||Ad)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),m=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:oP,textAlign:m!==void 0?m:bd,textBaseline:y!==void 0?y:Wm},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,T,I)=>x+=I%2?" ":T,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const D4=.5,cP={Point:U4,LineString:V4,Polygon:W4,MultiPoint:B4,MultiLineString:j4,MultiPolygon:z4,GeometryCollection:F4,Circle:L4};function M4(n,e){return parseInt(rt(n),10)-parseInt(rt(e),10)}function YI(n,e){const t=uP(n,e);return t*t}function uP(n,e){return D4*n/e}function L4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function ZI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let y=!0;const x=h.getImageState();x==Be.LOADED||x==Be.ERROR?y=!1:x==Be.IDLE&&h.load(),y&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const m=u.length>0;return m&&Promise.all(u).then(()=>r(null)),O4(n,e,t,i,s,o,l),m}function O4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())hP(n,u,t,e,o);else{const f=cP[u.getType()];f(n,u,t,e,o,s)}}function hP(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)hP(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function F4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=cP[o[l].getType()];h(n,o[l],t,i,r,s)}}function V4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function j4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function z4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function U4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Be.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function B4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Be.LOADED)return;const m=n.getBuilder(t.getZIndex(),"Image");m.setImageStyle(o,f),m.drawMultiPoint(e,i,r)}if(h){const m=n.getBuilder(t.getZIndex(),"Text");m.setTextStyle(u,f),m.drawText(e,i,r)}}function W4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let G4=!1;function $4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=G4,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function QI(n,e){return function(t,i,r,s,o){$4(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function K4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function H4(n,e,t,i){const r=[];let s=Ji();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=f1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function P1(n,e,t,i,r,s,o){let l,u,h,f,m,y,x;const T=r[s+1],I=[];for(let N=0,M=t.length;N<M;++N){const R=t[N];for(f=n[R-i],y=n[R-i+1],l=e;l<R;l+=i)m=n[l],x=n[l+1],(T<=y&&x<=T||y<=T&&T<=x)&&(h=(T-y)/(x-y)*(m-f)+f,I.push(h)),f=m,y=x}let S=NaN,b=-1/0;for(I.sort(Bs),f=I[0],l=1,u=I.length;l<u;++l){m=I[l];const N=Math.abs(m-f);N>b&&(h=(f+m)/2,E1(n,e,t,i,h,T)&&(S=h,b=N)),f=m}return isNaN(S)&&(S=r[s]),o?(o.push(S,T,b),o):[S,T,b]}function X4(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=P1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function q4(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function k1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function dP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=k1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function tq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!dP(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Lv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=k1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&q4(n,e,l,i),e=l}return e}function nq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Lv(n,e,t[s],i,r);return e}function Y4(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=k1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function fP(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function gP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=fP(n,e,l,i),e=l}return r}function iq(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=gP(n,e,l,i),e=l[l.length-1]}return r}class kd extends w1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new kd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Cb(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($b(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return fP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Hc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=S1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new kd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qb(this.flatCoordinates,0,e,this.stride),this.changed()}}class Nd extends w1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?h1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Nd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Cb(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Kb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Xb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return E1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return gP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Lv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,zm(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=gl(this.getExtent());this.flatInteriorPoint_=P1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new kd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new kd(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;dP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Lv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=I1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Nd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Qb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Yb(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function JI(n){if(jp(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Nd(s,"XY",[s.length])}const eC=Er();class gr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Ab(this.flatCoordinates_):f1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=gl(this.getExtent());this.flatInteriorPoints_=P1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Y4(this.flatCoordinates_,this.ends_),t=H4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=X4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=BI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=BI(e,t,o,2,.5);h1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ci(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Xs(eC,i[0],i[3],r,-r,0,0,0),Yo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,eC,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new gr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Sb((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=S1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=i4(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=I1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new gr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}gr.prototype.getFlatCoordinates=gr.prototype.getOrientedFlatCoordinates;function mP(n,e,t=0,i=n.length-1,r=Z4){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),m=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*m*(u-m)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*m/u+y)),T=Math.min(i,Math.floor(e+(u-h)*m/u+y));mP(n,e,x,T,r)}const s=n[e];let o=t,l=i;for(kh(n,t,e),r(n[i],s)>0&&kh(n,t,i);o<l;){for(kh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?kh(n,t,l):(l++,kh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function kh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function Z4(n,e){return n<e?-1:n>e?1:0}let pP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!$g(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;$g(e,u)&&(t.leaf?i.push(l):T0(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!$g(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if($g(e,o)){if(t.leaf||T0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Mc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=Q4(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&T0(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Mc(e.slice(t,i+1)),wc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Mc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));tC(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const m=Math.min(f+h-1,i);tC(e,f,m,u,this.compareMinY);for(let y=f;y<=m;y+=u){const x=Math.min(y+u-1,m);l.children.push(this._build(e,y,x,r-1))}}return wc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=E0(h),m=t3(e,h)-f;m<o?(o=m,s=f<s?f:s,l=h):m===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),$h(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Mc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,wc(i,this.toBBox),wc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Mc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,wc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=Gh(e,0,l,this.toBBox),h=Gh(e,l,i,this.toBBox),f=n3(u,h),m=E0(u)+E0(h);f<s?(s=f,r=l,o=m<o?m:o):f===s&&m<o&&(o=m,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:J4,s=e.leaf?this.compareMinY:e3,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Gh(e,0,t,s),l=Gh(e,i-t,i,s);let u=Gg(o)+Gg(l);for(let h=t;h<i-t;h++){const f=e.children[h];$h(o,e.leaf?s(f):f),u+=Gg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];$h(l,e.leaf?s(f):f),u+=Gg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)$h(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():wc(e[t],this.toBBox)}};function Q4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function wc(n,e){Gh(n,0,n.children.length,e,n)}function Gh(n,e,t,i,r){r||(r=Mc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];$h(r,n.leaf?i(o):o)}return r}function $h(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function J4(n,e){return n.minX-e.minX}function e3(n,e){return n.minY-e.minY}function E0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Gg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function t3(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function n3(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function T0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function $g(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Mc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function tC(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;mP(n,o,e,t,r),s.push(e,o,o,t)}}class nC{constructor(e){this.rbush_=new pP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[rt(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[rt(l)]=u}this.rbush_.load(i)}remove(e){const t=rt(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[rt(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Id(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return lu(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return na(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class yP extends us{constructor(e){super(),this.projection=ci(e.projection),this.attributions_=iC(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=iC(e),this.changed()}setState(e){this.state_=e,this.changed()}}function iC(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const $i={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Co extends Qs{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class N1 extends yP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Sd,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(lt(this.format_,"`format` must be set when `url` is set"),this.loader_=QI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:K4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new nC:null,this.loadedExtentsRtree_=new nC,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Xi(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=rt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Co($i.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof gr||(this.featureChangeKeys_[e]=[it(t,We.CHANGE,this.handleFeatureChange_,this),it(t,au.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof gr){const s=this.idIndex_[r];s instanceof gr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(lt(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=rt(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=rt(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener($i.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Co($i.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener($i.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener($i.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ti.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ti.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(bt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Co($i.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof gr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof gr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),lu(this.nullGeometryFeatures_)||h1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=Db(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||Td,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),m=l;if(l=f instanceof gr?0:f.closestPointXY(i,r,o,l),l<m){s=h;const y=Math.sqrt(l);u[0]=i-y,u[1]=r-y,u[2]=i+y,u[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=rt(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Co($i.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:rt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&lu(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Wh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Co($i.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Co($i.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Co($i.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Id(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=rt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(bt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener($i.REMOVEFEATURE)&&this.dispatchEvent(new Co($i.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){lt(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(QI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Ir{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ir({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Bm(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Be.IDLE&&t.load(),t.getImageState()===Be.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?rt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:fu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Du{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Du({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function rC(n){return n[0]>0&&n[1]>0}function i3(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function li(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Gp{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=li(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Gp({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return nt()}getImage(e){return nt()}getHitDetectionImage(){return nt()}getPixelRatio(e){return 1}getImageState(){return nt()}getImageSize(){return nt()}getOrigin(){return nt()}getSize(){return nt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=li(e)}listenImageChange(e){nt()}load(){nt()}unlistenImageChange(e){nt()}ready(){return Promise.resolve()}}class $p extends Gp{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Be.LOADING:Be.LOADED,this.imageState_===Be.LOADING&&this.ready().then(()=>this.imageState_=Be.LOADED),this.render()}clone(){const e=this.getScale(),t=new $p({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Yi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Jt(o,o);this.draw_(s,l,e),r=l.canvas,Yi.set(i,null,null,new rP(r,void 0,null,Be.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const j=r;r=s,s=j}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,m=Math.sqrt(u*u+f*f),y=m/u;if(e==="miter"&&y<=i)return y*t;const x=t/2/y,T=t/2*(f/m),S=Math.sqrt((r+x)*(r+x)+T*T)-r;if(this.radius2_===void 0||e==="bevel")return S*2;const b=r*Math.sin(l),N=Math.sqrt(r*r-b*b),M=s-N,D=Math.sqrt(b*b+M*M)/b;if(D<=i){const j=D*t/2-s-r;return 2*Math.max(S,j)}return S*2}createRenderOptions(){let e=gu,t=mu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Jr(this.stroke_.getColor()??Ad),l=this.stroke_.getWidth()??Pd,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??mu,e=this.stroke_.getLineCap()??gu,i=this.stroke_.getMiterLimit()??Rd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ni),t.fillStyle=Jr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=fu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Jt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ni,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Dl extends $p{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Dl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Qi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=sC,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Qi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=sC,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function r3(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(lt(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let S0=null;function _P(n,e){if(!S0){const t=new Ir({color:"rgba(255,255,255,0.4)"}),i=new Du({color:"#3399CC",width:1.25});S0=[new Qi({image:new Dl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return S0}function sC(n){return n.getGeometry()}const s3="#333";class uf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=li(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ir({color:s3}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new uf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ir?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=li(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Ln={ANIMATING:0,INTERACTING:1},Ce={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Kg=[Ce.FILL],Ho=[Ce.STROKE],tl=[Ce.BEGIN_PATH],oC=[Ce.CLOSE_PATH];class hf extends sP{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],uu(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],m=e[t+1];const y=this.tmpCoordinate_;let x=!0,T,I,S;for(T=t+r;T<i;T+=r)y[0]=e[T],y[1]=e[T+1],S=Tv(h,y),S!==I?(x&&(l[u++]=f,l[u++]=m,x=!1),l[u++]=y[0],l[u++]=y[1]):S===ln.INTERSECTING?(l[u++]=y[0],l[u++]=y[1],x=!1):x=!0,f=y[0],m=y[1],I=S;return(s&&x||T===t+r)&&(l[u++]=f,l[u++]=m),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,m,y,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const T=e.getEndss();x=0;for(let I=0,S=T.length;I<S;++I){const b=[];x=this.drawCustomCoordinates_(h,x,T[I],l,b),y.push(b)}this.instructions.push([Ce.CUSTOM,u,y,e,i,UI,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,y,e,r||i,UI,s]);break;case"Polygon":case"MultiLineString":m=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,m),this.instructions.push([Ce.CUSTOM,u,m,e,i,zm,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,m,e,r||i,zm,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Ce.CUSTOM,u,f,e,i,Hc,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,f,e,r||i,Hc,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Ce.CUSTOM,u,f,e,i,Hc,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,f,e,r||i,Hc,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Ce.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ce.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ce.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ce.END_GEOMETRY?o=t:s==Ce.BEGIN_GEOMETRY&&(r[2]=t,ZV(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Jr(i||ni)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Jr(i||Ad);const r=e.getLineCap();t.lineCap=r!==void 0?r:gu;const s=e.getLineDash();t.lineDash=s?s.slice():Ws;const o=e.getLineDashOffset();t.lineDashOffset=o||Gs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:mu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Pd;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Rd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ce.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ce.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!la(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ce.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ib(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;d1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class o3 extends hf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!uu(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ce.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ce.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||uu(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ce.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ce.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class a3 extends hf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Ce.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs],tl);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(Ho),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs],tl);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinates_(u,f,l[m],h);this.hitDetectionInstructions.push(Ho),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Ho),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Ho),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(tl)}}class aC extends hf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(tl),this.hitDetectionInstructions.push(tl);for(let h=0;h<u;++h){const f=i[h],m=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[Ce.MOVE_TO_LINE_TO,m,y];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(oC),this.hitDetectionInstructions.push(oC)),t=f}return o&&(this.instructions.push(Kg),this.hitDetectionInstructions.push(Kg)),l&&(this.instructions.push(Ho),this.hitDetectionInstructions.push(Ho)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_FILL_STYLE,ni]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Ce.CIRCLE,h];this.instructions.push(tl,f),this.hitDetectionInstructions.push(tl,f),r.fillStyle!==void 0&&(this.instructions.push(Kg),this.hitDetectionInstructions.push(Kg)),r.strokeStyle!==void 0&&(this.instructions.push(Ho),this.hitDetectionInstructions.push(Ho)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_FILL_STYLE,ni]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_FILL_STYLE,ni]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinatess_(u,f,l[m],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function l3(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),m=e[o+r],y=e[o+r+1],x=Math.sqrt((m-h)*(m-h)+(y-f)*(y-f));if(l+=x,l>=n){const T=(n-l+x)/x,I=Ei(h,m,T),S=Ei(f,y,T);u.push(I,S),s.push(u),u=[I,S],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const T=x-l,I=Ei(h,m,T/x),S=Ei(f,y,T/x);u.push(I,S),s.push(u),u=[I,S],l=0,o+=r}}return l>0&&s.push(u),s}function c3(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,m,y,x,T,I,S,b,N,M;for(m=t;m<i;m+=r){const R=e[m],D=e[m+1];T!==void 0&&(N=R-T,M=D-I,x=Math.sqrt(N*N+M*M),S!==void 0&&(u+=y,f=Math.acos((S*N+b*M)/(y*x)),f>n&&(u>l&&(l=u,s=h,o=m),u=0,h=m-r)),y=x,S=N,b=M),T=R,I=D}return u+=x,u>l?[h,m]:[s,o]}const Gm={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class u3 extends hf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ni]={fillStyle:ni},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,m=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!oi(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const S=e.getEndss();y=[];for(let b=0,N=S.length;b<N;++b)y.push(S[b][0])}this.beginGeometry(e,t,i);const x=o.repeat,T=x?void 0:o.textAlign;let I=0;for(let S=0,b=y.length;S<b;++S){let N;x?N=l3(x*this.resolution,f,I,y[S],m):N=[f.slice(I,y[S])];for(let M=0,R=N.length;M<R;++M){const D=N[M];let j=0,k=D.length;if(T==null){const L=c3(o.maxAngle,D,0,D.length,2);j=L[0],k=L[1]}for(let L=j;L<k;L+=m)l.push(D[L],D[L+1]);const A=l.length;I=y[S],this.drawChars_(u,A),u=A}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),m=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),m=3;break;case"MultiPolygon":const R=e.getFlatInteriorPoints();f=[];for(let D=0,j=R.length;D<j;D+=3)o.overflow||y.push(R[D+2]/this.resolution),f.push(R[D],R[D+1]);if(f.length===0)return;m=2;break}const x=this.appendFlatPointCoordinates(f,m);if(x===u)return;if(y&&(x-u)/2!==f.length/m){let R=u/2;y=y.filter((D,j)=>{const k=l[(R+j)*2]===f[j*m]&&l[(R+j)*2+1]===f[j*m+1];return k||--R,k})}this.saveTextStates_();const T=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let S=o.padding;if(S!=el&&(o.scale[0]<0||o.scale[1]<0)){let R=o.padding[0],D=o.padding[1],j=o.padding[2],k=o.padding[3];o.scale[0]<0&&(D=-D,k=-k),o.scale[1]<0&&(R=-R,j=-j),S=[R,D,j,k]}const b=this.pixelRatio;this.instructions.push([Ce.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,S==el?el:S.map(function(R){return R*b}),T,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const N=1/b,M=T?T.slice(0):null;M&&(M[1]=ni),this.hitDetectionInstructions.push([Ce.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[N,N],NaN,this.declutterMode_,this.declutterImageWithText_,S,M,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ni:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||bd,justify:t.justify,textBaseline:t.textBaseline||Wm,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Gm[r.textBaseline],f=this.textOffsetY_*u,m=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ce.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,y*u,m,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ce.DRAW_CHARS,e,t,h,r.overflow,l&&ni,r.maxAngle,u,f,s,y*u,m,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Jr(o.getColor()||ni)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),S=l.getLineDashOffset(),b=l.getWidth(),N=l.getMiterLimit();s.lineCap=l.getLineCap()||gu,s.lineDash=I?I.slice():Ws,s.lineDashOffset=S===void 0?Gs:S,s.lineJoin=l.getLineJoin()||mu,s.lineWidth=b===void 0?Pd:b,s.miterLimit=N===void 0?Rd:N,s.strokeStyle=Jr(l.getColor()||Ad)}i=this.textState_;const u=e.getFont()||oP;R4(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Wm,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||el,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),m=e.getOffsetY(),y=e.getRotateWithView(),x=e.getKeepUpright(),T=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=m===void 0?0:m,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=T===void 0?0:T,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:rt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+rt(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const h3={Circle:aC,Default:hf,Image:o3,LineString:a3,Polygon:aC,Text:u3};class d3{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=h3[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function f3(n,e,t,i,r,s,o,l,u,h,f,m,y=!0){let x=n[e],T=n[e+1],I=0,S=0,b=0,N=0;function M(){I=x,S=T,e+=i,x=n[e],T=n[e+1],N+=b,b=Math.sqrt((x-I)*(x-I)+(T-S)*(T-S))}do M();while(e<t-i&&N+b<s);let R=b===0?0:(s-N)/b;const D=Ei(I,x,R),j=Ei(S,T,R),k=e-i,A=N,L=s+l*u(h,r,f);for(;e<t-i&&N+b<L;)M();R=b===0?0:(L-N)/b;const V=Ei(I,x,R),z=Ei(S,T,R);let B=!1;if(y)if(m){const ue=[D,j,V,z];Gb(ue,0,4,2,m,ue,ue),B=ue[0]>ue[2]}else B=D>V;const O=Math.PI,le=[],me=k+i===e;e=k,b=0,N=A,x=n[e],T=n[e+1];let ge;if(me){M(),ge=Math.atan2(T-S,x-I),B&&(ge+=ge>0?-O:O);const ue=(V+D)/2,Q=(z+j)/2;return le[0]=[ue,Q,(L-s)/2,ge,r],le}r=r.replace(/\n/g," ");for(let ue=0,Q=r.length;ue<Q;){M();let se=Math.atan2(T-S,x-I);if(B&&(se+=se>0?-O:O),ge!==void 0){let xe=se-ge;if(xe+=xe>O?-2*O:xe<-O?2*O:0,Math.abs(xe)>o)return null}ge=se;const ne=ue;let G=0;for(;ue<Q;++ue){const xe=B?Q-ue-1:ue,ke=l*u(h,r[xe],f);if(e+i<t&&N+b<s+G+ke/2)break;G+=ke}if(ue===ne)continue;const $=B?r.substring(Q-ne,Q-ue):r.substring(ne,ue);R=b===0?0:(s+G/2-N)/b;const ie=Ei(I,x,R),pe=Ei(S,T,R);le.push([ie,pe,G/2,se,$]),s+=G}return le}class vP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Um(),{get:(e,t)=>{if(typeof Um()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Ec=Ji(),Ro=[],ks=[],Ns=[],Ao=[];function lC(n){return n[3].declutterBox}const cC=new RegExp("[-----]");function I0(n,e){return e==="start"?e=cC.test(n)?"right":"left":e==="end"&&(e=cC.test(n)?"left":"right"),Gm[e]}function g3(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function m3(n,e,t){return t%2===0&&(n+=e),n}class p3{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Er(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new vP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],m=u.justify?Gm[u.justify]:I0(Array.isArray(e)?e[0]:e,u.textAlign||bd),y=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(g3,[]),{width:T,height:I,widths:S,heights:b,lineWidths:N}=b4(u,x),M=T+y,R=[],D=(M+2)*f[0],j=(I+y)*f[1],k={width:D<0?Math.floor(D):Math.ceil(D),height:j<0?Math.floor(j):Math.ceil(j),contextInstructions:R};(f[0]!=1||f[1]!=1)&&R.push("scale",f),r&&(R.push("strokeStyle",o.strokeStyle),R.push("lineWidth",y),R.push("lineCap",o.lineCap),R.push("lineJoin",o.lineJoin),R.push("miterLimit",o.miterLimit),R.push("setLineDash",[o.lineDash]),R.push("lineDashOffset",o.lineDashOffset)),i&&R.push("fillStyle",l.fillStyle),R.push("textBaseline","middle"),R.push("textAlign","center");const A=.5-m;let L=m*M+A*y;const V=[],z=[];let B=0,O=0,le=0,me=0,ge;for(let ue=0,Q=x.length;ue<Q;ue+=2){const se=x[ue];if(se===`
`){O+=B,B=0,L=m*M+A*y,++me;continue}const ne=x[ue+1]||u.font;ne!==ge&&(r&&V.push("font",ne),i&&z.push("font",ne),ge=ne),B=Math.max(B,b[le]);const G=[se,L+A*S[le]+m*(S[le]-N[me]),.5*(y+B)+O];L+=S[le],r&&V.push("strokeText",G),i&&z.push("fillText",G),++le}return Array.prototype.push.apply(R,V),Array.prototype.push.apply(R,z),this.labels_[s]=k,k}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,m,y,x,T,I,S){l*=y[0],u*=y[1];let b=i-l,N=r-u;const M=s+h>e?e-h:s,R=o+f>t?t-f:o,D=T[3]+M*y[0]+T[1],j=T[0]+R*y[1]+T[2],k=b-T[3],A=N-T[0];(I||m!==0)&&(Ro[0]=k,Ao[0]=k,Ro[1]=A,ks[1]=A,ks[0]=k+D,Ns[0]=ks[0],Ns[1]=A+j,Ao[1]=Ns[1]);let L;return m!==0?(L=Xs(Er(),i,r,1,1,m,-i,-r),un(L,Ro),un(L,ks),un(L,Ns),un(L,Ao),na(Math.min(Ro[0],ks[0],Ns[0],Ao[0]),Math.min(Ro[1],ks[1],Ns[1],Ao[1]),Math.max(Ro[0],ks[0],Ns[0],Ao[0]),Math.max(Ro[1],ks[1],Ns[1],Ao[1]),Ec)):na(Math.min(k,k+D),Math.min(A,A+j),Math.max(k,k+D),Math.max(A,A+j),Ec),x&&(b=Math.round(b),N=Math.round(N)),{drawImageX:b,drawImageY:N,drawImageW:M,drawImageH:R,originX:h,originY:f,declutterBox:{minX:Ec[0],minY:Ec[1],maxX:Ec[2],maxY:Ec[3],value:S},canvasTransform:L,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Ro,ks,Ns,Ao,o,l),P4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=I0(Array.isArray(e)?e[0]:e,s.textAlign||bd),f=Gm[s.textBaseline||Wm],m=l&&l.lineWidth?l.lineWidth:0,y=o.width/u-2*s.scale[0],x=h*y+2*(.5-h)*m,T=f*o.height/u+2*(.5-f)*m;return{label:o,anchorX:x,anchorY:T}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&la(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Yo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Bj(this.renderedTransform_,i));let m=0;const y=r.length;let x=0,T,I,S,b,N,M,R,D,j,k,A,L,V,z=0,B=0;const O=this.coordinateCache_,le=this.viewRotation_,me=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:le},ue=this.instructions!=r||this.overlaps?0:200;let Q,se,ne,G;for(;m<y;){const $=r[m];switch($[0]){case Ce.BEGIN_GEOMETRY:Q=$[1],G=$[3],Q.getGeometry()?l!==void 0&&!oi(l,G.getExtent())?m=$[2]+1:++m:m=$[2],h&&(h.zIndex=$[4]);break;case Ce.BEGIN_PATH:z>ue&&(this.fill_(e),z=0),B>ue&&(e.stroke(),B=0),!z&&!B&&(e.beginPath(),N=NaN,M=NaN),++m;break;case Ce.CIRCLE:x=$[1];const pe=f[x],xe=f[x+1],ke=f[x+2],Le=f[x+3],je=ke-pe,Ge=Le-xe,ct=Math.sqrt(je*je+Ge*Ge);e.moveTo(pe+ct,xe),e.arc(pe,xe,ct,0,2*Math.PI,!0),++m;break;case Ce.CLOSE_PATH:e.closePath(),++m;break;case Ce.CUSTOM:x=$[1],T=$[2];const er=$[3],fs=$[4],$n=$[5];ge.geometry=er,ge.feature=Q,m in O||(O[m]=[]);const Kn=O[m];$n?$n(f,x,T,2,Kn):(Kn[0]=f[x],Kn[1]=f[x+1],Kn.length=2),h&&(h.zIndex=$[6]),fs(Kn,ge),++m;break;case Ce.DRAW_IMAGE:x=$[1],T=$[2],j=$[3],I=$[4],S=$[5];let hn=$[6];const dn=$[7],Hn=$[8],Pi=$[9],_t=$[10];let ut=$[11];const nn=$[12];let ki=$[13];b=$[14]||"declutter";const It=$[15];if(!j&&$.length>=20){k=$[19],A=$[20],L=$[21],V=$[22];const Ft=this.drawLabelWithPointPlacement_(k,A,L,V);j=Ft.label,$[3]=j;const Mi=$[23];I=(Ft.anchorX-Mi)*this.pixelRatio,$[4]=I;const fn=$[24];S=(Ft.anchorY-fn)*this.pixelRatio,$[5]=S,hn=j.height,$[6]=hn,ki=j.width,$[13]=ki}let no;$.length>25&&(no=$[25]);let Ni,Ar,tr;$.length>17?(Ni=$[16],Ar=$[17],tr=$[18]):(Ni=el,Ar=null,tr=null),_t&&me?ut+=le:!_t&&!me&&(ut-=le);let br=0;for(;x<T;x+=2){if(no&&no[br++]<ki/this.pixelRatio)continue;const Ft=this.calculateImageOrLabelDimensions_(j.width,j.height,f[x],f[x+1],ki,hn,I,S,Hn,Pi,ut,nn,s,Ni,!!Ar||!!tr,Q),Mi=[e,t,j,Ft,dn,Ar,tr];if(u){let fn,Vt,gn;if(It){const st=T-x;if(!It[st]){It[st]={args:Mi,declutterMode:b};continue}const Wt=It[st];fn=Wt.args,Vt=Wt.declutterMode,delete It[st],gn=lC(fn)}let mn,rn;if(fn&&(Vt!=="declutter"||!u.collides(gn))&&(mn=!0),(b!=="declutter"||!u.collides(Ft.declutterBox))&&(rn=!0),Vt==="declutter"&&b==="declutter"){const st=mn&&rn;mn=st,rn=st}mn&&(Vt!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),rn&&(b!=="none"&&u.insert(Ft.declutterBox),this.replayImageOrLabel_.apply(this,Mi))}else this.replayImageOrLabel_.apply(this,Mi)}++m;break;case Ce.DRAW_CHARS:const ua=$[1],Pr=$[2],Di=$[3],Vl=$[4];V=$[5];const kr=$[6],gs=$[7],io=$[8];L=$[9];const On=$[10];k=$[11],Array.isArray(k)&&(k=k.reduce(m3,"")),A=$[12];const ms=[$[13],$[13]];b=$[14]||"declutter";const Nr=$[15],Dr=this.textStates[A],Fn=Dr.font,Vn=[Dr.scale[0]*gs,Dr.scale[1]*gs];let gt;Fn in this.widths_?gt=this.widths_[Fn]:(gt={},this.widths_[Fn]=gt);const ro=n4(f,ua,Pr,2),nr=Math.abs(Vn[0])*qI(Fn,k,gt);if(Vl||nr<=ro){const Ft=this.textStates[A].textAlign,Mi=(ro-nr)*I0(k,Ft),fn=f3(f,ua,Pr,2,k,Mi,kr,Math.abs(Vn[0]),qI,Fn,gt,me?0:this.viewRotation_,Nr);e:if(fn){const Vt=[];let gn,mn,rn,st,Wt;if(L)for(gn=0,mn=fn.length;gn<mn;++gn){Wt=fn[gn],rn=Wt[4],st=this.createLabel(rn,A,"",L),I=Wt[2]+(Vn[0]<0?-On:On),S=Di*st.height+(.5-Di)*2*On*Vn[1]/Vn[0]-io;const qt=this.calculateImageOrLabelDimensions_(st.width,st.height,Wt[0],Wt[1],st.width,st.height,I,S,0,0,Wt[3],ms,!1,el,!1,Q);if(u&&b==="declutter"&&u.collides(qt.declutterBox))break e;Vt.push([e,t,st,qt,1,null,null])}if(V)for(gn=0,mn=fn.length;gn<mn;++gn){Wt=fn[gn],rn=Wt[4],st=this.createLabel(rn,A,V,""),I=Wt[2],S=Di*st.height-io;const qt=this.calculateImageOrLabelDimensions_(st.width,st.height,Wt[0],Wt[1],st.width,st.height,I,S,0,0,Wt[3],ms,!1,el,!1,Q);if(u&&b==="declutter"&&u.collides(qt.declutterBox))break e;Vt.push([e,t,st,qt,1,null,null])}u&&b!=="none"&&u.load(Vt.map(lC));for(let qt=0,Li=Vt.length;qt<Li;++qt)this.replayImageOrLabel_.apply(this,Vt[qt])}}++m;break;case Ce.END_GEOMETRY:if(o!==void 0){Q=$[1];const Ft=o(Q,G,b);if(Ft)return Ft}++m;break;case Ce.FILL:ue?z++:this.fill_(e),++m;break;case Ce.MOVE_TO_LINE_TO:for(x=$[1],T=$[2],se=f[x],ne=f[x+1],e.moveTo(se,ne),N=se+.5|0,M=ne+.5|0,x+=2;x<T;x+=2)se=f[x],ne=f[x+1],R=se+.5|0,D=ne+.5|0,(x==T-2||R!==N||D!==M)&&(e.lineTo(se,ne),N=R,M=D);++m;break;case Ce.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],z&&(this.fill_(e),z=0,B&&(e.stroke(),B=0)),e.fillStyle=$[1],++m;break;case Ce.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,$),++m;break;case Ce.STROKE:ue?B++:e.stroke(),++m;break;default:++m;break}}z&&this.fill_(e),B&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ka=["Polygon","Circle","LineString","Image","Text","Default"],xP=["Image","Text"],y3=Ka.filter(n=>!xP.includes(n));class _3{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Er(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new p3(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Xs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Jt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let m;this.renderBuffer_!==void 0&&(m=Ji(),id(m,e),d1(m,t*(this.renderBuffer_+r),m));const y=v3(r);let x;function T(D,j,k){const A=f.getImageData(0,0,l,l).data;for(let L=0,V=y.length;L<V;L++)if(A[y[L]]>0){if(!o||k==="none"||x!=="Image"&&x!=="Text"||o.includes(D)){const z=(y[L]-3)/4,B=r-z%l,O=r-(z/l|0),le=s(D,j,B*B+O*O);if(le)return le}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(Bs);let S,b,N,M,R;for(S=I.length-1;S>=0;--S){const D=I[S].toString();for(N=this.executorsByZIndex_[D],b=Ka.length-1;b>=0;--b)if(x=Ka[b],M=N[x],M!==void 0&&(R=M.executeHitDetection(f,u,i,T,m),R))return R}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Yo(l,0,8,2,e,l),l}isEmpty(){return lu(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?YV:Bs),o=o||Ka;const h=Ka.length;for(let f=0,m=u.length;f<m;++f){const y=u[f].toString(),x=this.executorsByZIndex_[y];for(let T=0,I=o.length;T<I;++T){const S=o[T],b=x[S];if(b!==void 0){const N=l===null?void 0:b.getZIndexContext(),M=N?N.getContext():e,R=this.maxExtent_&&S!=="Image"&&S!=="Text";if(R&&(M.save(),this.clip(M,i)),!N||S==="Text"||S==="Image"?b.execute(M,t,i,r,s,l):N.pushFunction(D=>b.execute(D,t,i,r,s,l)),R&&M.restore(),N){N.offset();const D=u[f]*h+Ka.indexOf(S);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(N)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Bs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const C0={};function v3(n){if(C0[n]!==void 0)return C0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return C0[n]=r,r}function uC(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let D1=class wP extends Gp{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;lt(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||rt(o)),lt(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),lt(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Be.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Be.LOADED:Be.IDLE:u=Be.LOADING:u=Be.LOADED),this.color_=e.color!==void 0?fu(e.color):null,this.iconImage_=Bm(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const m=this.getImage(1);if(m.width&&m.height)h=m.width,f=m.height;else if(m instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(uC(x[0],x[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(uC(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new wP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Bm(null,e,this.crossOrigin_,Be.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(We.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(We.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Zr=.5;function x3(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Zr,m=n[1]*Zr,y=Jt(f,m);y.imageSmoothingEnabled=!1;const x=y.canvas,T=new N4(y,Zr,r,null,o,l,null),I=t.length,S=Math.floor((256*256*256-1)/I),b={};for(let M=1;M<=I;++M){const R=t[M-1],D=R.getStyleFunction()||i;if(!D)continue;let j=D(R,s);if(!j)continue;Array.isArray(j)||(j=[j]);const A=(M*S).toString(16).padStart(7,"#00000");for(let L=0,V=j.length;L<V;++L){const z=j[L],B=z.getGeometryFunction()(R);if(!B||!oi(h,B.getExtent()))continue;const O=z.clone(),le=O.getFill();le&&le.setColor(A);const me=O.getStroke();me&&(me.setColor(A),me.setLineDash(null)),O.setText(void 0);const ge=z.getImage();if(ge){const ne=ge.getImageSize();if(!ne)continue;const G=Jt(ne[0],ne[1],void 0,{alpha:!1}),$=G.canvas;G.fillStyle=A,G.fillRect(0,0,$.width,$.height),O.setImage(new D1({img:$,anchor:ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ge.getOrigin(),opacity:1,size:ge.getSize(),scale:ge.getScale(),rotation:ge.getRotation(),rotateWithView:ge.getRotateWithView()}))}const ue=O.getZIndex()||0;let Q=b[ue];Q||(Q={},b[ue]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const se=B.getType();if(se==="GeometryCollection"){const ne=B.getGeometriesArrayRecursive();for(let G=0,$=ne.length;G<$;++G){const ie=ne[G];Q[ie.getType().replace("Multi","")].push(ie,O)}}else Q[se.replace("Multi","")].push(B,O)}}const N=Object.keys(b).map(Number).sort(Bs);for(let M=0,R=N.length;M<R;++M){const D=b[N[M]];for(const j in D){const k=D[j];for(let A=0,L=k.length;A<L;A+=2){T.setStyle(k[A+1]);for(let V=0,z=e.length;V<z;++V)T.setTransform(e[V]),T.drawGeometry(k[A])}}}return y.getImageData(0,0,x.width,x.height)}function w3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Zr),s=Math.floor(Math.round(n[1])*Zr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),m=Math.floor((256*256*256-1)/e.length);f&&f%m===0&&i.push(e[f/m-1])}return i}class EP extends Qs{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const E3=5;class T3 extends of{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=E3}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return nt()}getData(e){return null}prepareFrame(e){return nt()}renderFrame(e,t){return nt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Be.LOADED||t.getState()===Be.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Be.LOADED&&t!=Be.ERROR&&e.addEventListener(We.CHANGE,this.boundHandleImageChange_),t==Be.IDLE&&(e.load(),t=e.getState()),t==Be.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const hC=[];let Lc=null;function S3(){Lc=Jt(1,1,void 0,{willReadFrequently:!0})}class TP extends T3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Er(),this.pixelTransform=Er(),this.inversePixelTransform=Er(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Lc||S3(),Lc.clearRect(0,0,1,1);let r;try{Lc.drawImage(e,t,i,1,1,0,0,1,1),r=Lc.getImageData(0,0,1,1).data}catch{return Lc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&la(fu(e.style.backgroundColor),fu(i)))){const l=e.firstElementChild;Ko(l)&&(o=l.getContext("2d"))}if(o&&Kj(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Si?nP():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Jt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Nl(i),s=Vp(i),o=Fp(i),l=Op(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(ft(i)/r*o),u=Math.round(Bn(i)/r*o);Xs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),Wb(this.inversePixelTransform,this.pixelTransform);const h=$j(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new EP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(qi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(qi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new vP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(qi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(qi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,m=-f,y=-e[0]+l,x=-e[1];return Xs(this.tempTransform,u,h,f,m,-i,y,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class I3 extends TP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Ji(),this.wrappedRenderedExtent_=Ji(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),m=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),x=t.pixelRatio,T=t.viewHints,I=!(T[Ln.ANIMATING]||T[Ln.INTERACTING]),S=this.context,b=Math.round(ft(r)/l*x),N=Math.round(Bn(r)/l*x),M=m.getWrapX()&&u.canWrapX(),R=M?ft(f):null,D=M?Math.ceil((r[2]-f[2])/R)+1:1;let j=M?Math.floor((r[0]-f[0])/R):0;do{let k=this.getRenderTransform(o,l,0,x,b,N,j*R);t.declutter&&(k=k.slice(0)),e.execute(S,[S.canvas.width,S.canvas.height],k,h,I,i===void 0?Ka:i?xP:y3,i?y&&t.declutter[y]:void 0)}while(++j<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Jt(this.context.canvas.width,this.context.canvas.height,hC))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Wp(this.context),hC.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(qi.PRERENDER)||this.getLayer().hasListener(qi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=$o(i.extent);l=oi(u,e.extent),this.clipped_=l&&!Wh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],m=i[0]*Zr,y=i[1]*Zr;f.push(this.getRenderTransform(r,s,o,Zr,m,y,0).slice());const x=h.getSource(),T=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!Wh(T,u)){let I=u[0];const S=ft(T);let b=0,N;for(;I<T[0];)--b,N=S*b,f.push(this.getRenderTransform(r,s,o,Zr,m,y,N).slice()),I+=S;for(b=0,I=u[2];I>T[2];)++b,N=S*b,f.push(this.getRenderTransform(r,s,o,Zr,m,y,N).slice()),I-=S}this.hitDetectionImageData_=x3(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,YI(s,this.renderedPixelRatio_))}t(w3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(y,x,T){const I=rt(y),S=h[I];if(S){if(S!==!0&&T<S.distanceSq){if(T===0)return h[I]=!0,s.splice(s.lastIndexOf(S),1),r(y,u,x);S.geometry=x,S.distanceSq=T}}else{if(T===0)return h[I]=!0,r(y,u,x);s.push(h[I]={feature:y,layer:u,geometry:x,distanceSq:T,callback:r})}},m=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,m?t.declutter?.[m]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Ln.ANIMATING],s=e.viewHints[Ln.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,m=h.resolution,y=e.pixelRatio,x=t.getRevision(),T=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=M4);const S=h.center.slice(),b=d1(u,T*m),N=b.slice(),M=[b.slice()],R=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Wh(R,e.extent)){const le=ft(R),me=Math.max(ft(b)/2,le);b[0]=R[0]-me,b[2]=R[2]+me,Mb(S,f);const ge=Nb(M[0],f);ge[0]<R[0]&&ge[2]<R[2]?M.push([ge[0]+le,ge[1],ge[2]+le,ge[3]]):ge[0]>R[0]&&ge[2]>R[2]&&M.push([ge[0]-le,ge[1],ge[2]-le,ge[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==x&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Wh(this.wrappedRenderedExtent_,b))return la(this.renderedExtent_,N)||(this.hitDetectionImageData_=null,this.renderedExtent_=N),this.renderedCenter_=S,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new d3(uP(m,y),b,m,y);let j;for(let le=0,me=M.length;le<me;++le)i.loadFeatures(M[le],m,f);const k=YI(m,y);let A=!0;const L=(le,me)=>{let ge;const ue=le.getStyleFunction()||t.getStyleFunction();if(ue&&(ge=ue(le,m)),ge){const Q=this.renderFeature(le,k,ge,D,j,this.getLayer().getDeclutter(),me);A=A&&!Q}},V=Bb(b),z=i.getFeaturesInExtent(V);I&&z.sort(I);for(let le=0,me=z.length;le<me;++le)L(z[le],le);this.renderedFeatures_=z,this.ready=A;const B=D.finish(),O=new _3(b,m,y,i.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=m,this.renderedRevision_=x,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=N,this.wrappedRenderedExtent_=b,this.renderedCenter_=S,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=ZI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=ZI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Ml=0;const Un=1<<Ml++,qe=1<<Ml++,ii=1<<Ml++,mr=1<<Ml++,_l=1<<Ml++,Kh=1<<Ml++,Hg=Math.pow(2,Ml)-1,M1={[Un]:"boolean",[qe]:"number",[ii]:"string",[mr]:"color",[_l]:"number[]",[Kh]:"size"},C3=Object.keys(M1).map(Number).sort(Bs);function R3(n){return n in M1}function Hh(n){const e=[];for(const t of C3)Xh(n,t)&&e.push(M1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Xh(n,e){return(n&e)===e}function bo(n,e){return n===e}class Qt{constructor(e,t){if(!R3(e))throw new Error(`literal expressions must have a specific type, got ${Hh(e)}`);this.type=e,this.value=t}}class A3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function SP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Cn(n,e,t){switch(typeof n){case"boolean":{if(bo(e,ii))return new Qt(ii,n?"true":"false");if(!Xh(e,Un))throw new Error(`got a boolean, but expected ${Hh(e)}`);return new Qt(Un,n)}case"number":{if(bo(e,Kh))return new Qt(Kh,li(n));if(bo(e,Un))return new Qt(Un,!!n);if(bo(e,ii))return new Qt(ii,n.toString());if(!Xh(e,qe))throw new Error(`got a number, but expected ${Hh(e)}`);return new Qt(qe,n)}case"string":{if(bo(e,mr))return new Qt(mr,R1(n));if(bo(e,Un))return new Qt(Un,!!n);if(!Xh(e,ii))throw new Error(`got a string, but expected ${Hh(e)}`);return new Qt(ii,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return j3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(bo(e,Kh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Qt(Kh,n)}if(bo(e,mr)){if(n.length===3)return new Qt(mr,[...n,1]);if(n.length===4)return new Qt(mr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Xh(e,_l))throw new Error(`got an array of numbers, but expected ${Hh(e)}`);return new Qt(_l,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},b3={[te.Get]:Fe(Ue(1,1/0),dC),[te.Var]:Fe(Ue(1,1),P3),[te.Has]:Fe(Ue(1,1/0),dC),[te.Id]:Fe(k3,Tc),[te.Concat]:Fe(Ue(2,1/0),at(ii)),[te.GeometryType]:Fe(N3,Tc),[te.LineMetric]:Fe(Tc),[te.Resolution]:Fe(R0,Tc),[te.Zoom]:Fe(R0,Tc),[te.Time]:Fe(R0,Tc),[te.Any]:Fe(Ue(2,1/0),at(Un)),[te.All]:Fe(Ue(2,1/0),at(Un)),[te.Not]:Fe(Ue(1,1),at(Un)),[te.Equal]:Fe(Ue(2,2),at(Hg)),[te.NotEqual]:Fe(Ue(2,2),at(Hg)),[te.GreaterThan]:Fe(Ue(2,2),at(qe)),[te.GreaterThanOrEqualTo]:Fe(Ue(2,2),at(qe)),[te.LessThan]:Fe(Ue(2,2),at(qe)),[te.LessThanOrEqualTo]:Fe(Ue(2,2),at(qe)),[te.Multiply]:Fe(Ue(2,1/0),fC),[te.Coalesce]:Fe(Ue(2,1/0),fC),[te.Divide]:Fe(Ue(2,2),at(qe)),[te.Add]:Fe(Ue(2,1/0),at(qe)),[te.Subtract]:Fe(Ue(2,2),at(qe)),[te.Clamp]:Fe(Ue(3,3),at(qe)),[te.Mod]:Fe(Ue(2,2),at(qe)),[te.Pow]:Fe(Ue(2,2),at(qe)),[te.Abs]:Fe(Ue(1,1),at(qe)),[te.Floor]:Fe(Ue(1,1),at(qe)),[te.Ceil]:Fe(Ue(1,1),at(qe)),[te.Round]:Fe(Ue(1,1),at(qe)),[te.Sin]:Fe(Ue(1,1),at(qe)),[te.Cos]:Fe(Ue(1,1),at(qe)),[te.Atan]:Fe(Ue(1,2),at(qe)),[te.Sqrt]:Fe(Ue(1,1),at(qe)),[te.Match]:Fe(Ue(4,1/0),gC,M3),[te.Between]:Fe(Ue(3,3),at(qe)),[te.Interpolate]:Fe(Ue(6,1/0),gC,L3),[te.Case]:Fe(Ue(3,1/0),D3,O3),[te.In]:Fe(Ue(2,2),F3),[te.Number]:Fe(Ue(1,1/0),at(Hg)),[te.String]:Fe(Ue(1,1/0),at(Hg)),[te.Array]:Fe(Ue(1,1/0),at(qe)),[te.Color]:Fe(Ue(1,4),at(qe)),[te.Band]:Fe(Ue(1,3),at(qe)),[te.Palette]:Fe(Ue(2,2),V3),[te.ToString]:Fe(Ue(1,1),at(Un|qe|ii|mr))};function dC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Qt(qe,o);break}case"string":{r[s]=new Qt(ii,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function P3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Qt(ii,i)]}function k3(n,e,t){t.featureId=!0}function N3(n,e,t){t.geometryType=!0}function R0(n,e,t){t.mapState=!0}function Tc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ue(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function fC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Cn(n[s+1],e,t);r[s]=o}return r}function at(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=Cn(e[o+1],n,i);s[o]=l}return s}}function D3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function gC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function M3(n,e,t){const i=n.length-1,r=ii|qe|Un,s=Cn(n[1],r,t),o=Cn(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=Cn(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Cn(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function L3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Qt(qe,r);let o;try{o=Cn(n[2],qe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=Cn(n[u+3],qe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Cn(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function O3(n,e,t){const i=Cn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Cn(n[s+1],Un,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Cn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function F3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ii}else r=qe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=Cn(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[Cn(n[1],r,t),...s]}function V3(n,e,t){let i;try{i=Cn(n[1],qe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=Cn(r[o],mr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Qt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Fe(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new A3(t,r,...s)}}function j3(n,e,t){const i=n[0],r=b3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function IP(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return IP(n.getGeometries()[0]);default:return""}}function CP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Js(n,e,t){const i=Cn(n,e,t);return Cr(i)}function Cr(n,e){if(n instanceof Qt){if(n.type===mr&&typeof n.value=="string"){const i=R1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return z3(n);case te.Get:case te.Var:case te.Has:return U3(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Cr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return W3(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return B3(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return G3(n);case te.Case:return $3(n);case te.Match:return K3(n);case te.Interpolate:return H3(n);case te.ToString:return X3(n);default:throw new Error(`Unsupported operator ${t}`)}}function z3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function U3(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function B3(n,e){const t=n.operator,i=Cr(n.args[0]),r=Cr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function W3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function G3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function $3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function K3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function H3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let m=i[h+1](r);const y=Array.isArray(m);if(y&&(m=y4(m)),f>=o)return h===2?m:y?q3(s,o,l,u,f,m):qh(s,o,l,u,f,m);l=f,u=m}return u}}function X3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===mr?A1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function qh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function q3(n,e,t,i,r,s){if(r-t===0)return i;const l=$I(i),u=$I(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[qh(n,e,t,l[0],r,u[0]),qh(n,e,t,l[1],r,u[1]),l[2]+qh(n,e,t,0,r,h),qh(n,e,t,i[3],r,s[3])];return _4(f)}function Y3(n){return!0}function Z3(n){const e=SP(),t=Q3(n,e),i=CP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=IP(r.getGeometry())),t(i)}}function mC(n){const e=SP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Ov(n[o],e);const r=CP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function Q3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Js(s.filter,Un,e):Y3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Ov(s.style[h],e)}else l=[Ov(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Ov(n,e){const t=Dd(n,"",e),i=Md(n,"",e),r=J3(n,e),s=e6(n,e),o=ai(n,"z-index",e);if(!t&&!i&&!r&&!s&&!lu(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Qi;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Dd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=r6(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=L1(n,e+"fill-color",t)}if(!i)return null;const r=new Ir;return function(s){const o=i(s);return o===C1?null:(r.setColor(o),r)}}function Md(n,e,t){const i=ai(n,e+"stroke-width",t),r=L1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ms(n,e+"stroke-line-cap",t),o=Ms(n,e+"stroke-line-join",t),l=RP(n,e+"stroke-line-dash",t),u=ai(n,e+"stroke-line-dash-offset",t),h=ai(n,e+"stroke-miter-limit",t),f=new Du;return function(m){if(r){const y=r(m);if(y===C1)return null;f.setColor(y)}if(i&&f.setWidth(i(m)),s){const y=s(m);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(m);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(m)),u&&f.setLineDashOffset(u(m)),h&&f.setMiterLimit(h(m)),f}}function J3(n,e){const t="text-",i=Ms(n,t+"value",e);if(!i)return null;const r=Dd(n,t,e),s=Dd(n,t+"background-",e),o=Md(n,t,e),l=Md(n,t+"background-",e),u=Ms(n,t+"font",e),h=ai(n,t+"max-angle",e),f=ai(n,t+"offset-x",e),m=ai(n,t+"offset-y",e),y=Zc(n,t+"overflow",e),x=Ms(n,t+"placement",e),T=ai(n,t+"repeat",e),I=Kp(n,t+"scale",e),S=Zc(n,t+"rotate-with-view",e),b=ai(n,t+"rotation",e),N=Ms(n,t+"align",e),M=Ms(n,t+"justify",e),R=Ms(n,t+"baseline",e),D=Zc(n,t+"keep-upright",e),j=RP(n,t+"padding",e),k=Hp(n,t+"declutter-mode"),A=new uf({declutterMode:k});return function(L){if(A.setText(i(L)),r&&A.setFill(r(L)),s&&A.setBackgroundFill(s(L)),o&&A.setStroke(o(L)),l&&A.setBackgroundStroke(l(L)),u&&A.setFont(u(L)),h&&A.setMaxAngle(h(L)),f&&A.setOffsetX(f(L)),m&&A.setOffsetY(m(L)),y&&A.setOverflow(y(L)),x){const V=x(L);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(V)}if(T&&A.setRepeat(T(L)),I&&A.setScale(I(L)),S&&A.setRotateWithView(S(L)),b&&A.setRotation(b(L)),N){const V=N(L);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(V)}if(M){const V=M(L);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(V)}if(R){const V=R(L);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(V)}return j&&A.setPadding(j(L)),D&&A.setKeepUpright(D(L)),A}}function e6(n,e){return"icon-src"in n?t6(n,e):"shape-points"in n?n6(n,e):"circle-radius"in n?i6(n,e):null}function t6(n,e){const t="icon-",i=t+"src",r=AP(n[i],i),s=$m(n,t+"anchor",e),o=Kp(n,t+"scale",e),l=ai(n,t+"opacity",e),u=$m(n,t+"displacement",e),h=ai(n,t+"rotation",e),f=Zc(n,t+"rotate-with-view",e),m=yC(n,t+"anchor-origin"),y=_C(n,t+"anchor-x-units"),x=_C(n,t+"anchor-y-units"),T=l6(n,t+"color"),I=o6(n,t+"cross-origin"),S=a6(n,t+"offset"),b=yC(n,t+"offset-origin"),N=Km(n,t+"width"),M=Km(n,t+"height"),R=s6(n,t+"size"),D=Hp(n,t+"declutter-mode"),j=new D1({src:r,anchorOrigin:m,anchorXUnits:y,anchorYUnits:x,color:T,crossOrigin:I,offset:S,offsetOrigin:b,height:M,width:N,size:R,declutterMode:D});return function(k){return l&&j.setOpacity(l(k)),u&&j.setDisplacement(u(k)),h&&j.setRotation(h(k)),f&&j.setRotateWithView(f(k)),o&&j.setScale(o(k)),s&&j.setAnchor(s(k)),j}}function n6(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Fv(n[i],i),o=Fv(n[r],r),l=Dd(n,t,e),u=Md(n,t,e),h=Kp(n,t+"scale",e),f=$m(n,t+"displacement",e),m=ai(n,t+"rotation",e),y=Zc(n,t+"rotate-with-view",e),x=Km(n,t+"radius2"),T=Km(n,t+"angle"),I=Hp(n,t+"declutter-mode"),S=new $p({points:s,radius:o,radius2:x,angle:T,declutterMode:I});return function(b){return l&&S.setFill(l(b)),u&&S.setStroke(u(b)),f&&S.setDisplacement(f(b)),m&&S.setRotation(m(b)),y&&S.setRotateWithView(y(b)),h&&S.setScale(h(b)),S}}function i6(n,e){const t="circle-",i=Dd(n,t,e),r=Md(n,t,e),s=ai(n,t+"radius",e),o=Kp(n,t+"scale",e),l=$m(n,t+"displacement",e),u=ai(n,t+"rotation",e),h=Zc(n,t+"rotate-with-view",e),f=Hp(n,t+"declutter-mode"),m=new Dl({radius:5,declutterMode:f});return function(y){return s&&m.setRadius(s(y)),i&&m.setFill(i(y)),r&&m.setStroke(r(y)),l&&m.setDisplacement(l(y)),u&&m.setRotation(u(y)),h&&m.setRotateWithView(h(y)),o&&m.setScale(o(y)),m}}function ai(n,e,t){if(!(e in n))return;const i=Js(n[e],qe,t);return function(r){return Fv(i(r),e)}}function Ms(n,e,t){if(!(e in n))return null;const i=Js(n[e],ii,t);return function(r){return AP(i(r),e)}}function r6(n,e,t){const i=Ms(n,e+"pattern-src",t),r=pC(n,e+"pattern-offset",t),s=pC(n,e+"pattern-size",t),o=L1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Zc(n,e,t){if(!(e in n))return null;const i=Js(n[e],Un,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function L1(n,e,t){if(!(e in n))return null;const i=Js(n[e],mr,t);return function(r){return bP(i(r),e)}}function RP(n,e,t){if(!(e in n))return null;const i=Js(n[e],_l,t);return function(r){return df(i(r),e)}}function $m(n,e,t){if(!(e in n))return null;const i=Js(n[e],_l,t);return function(r){const s=df(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function pC(n,e,t){if(!(e in n))return null;const i=Js(n[e],_l,t);return function(r){return PP(i(r),e)}}function Kp(n,e,t){if(!(e in n))return null;const i=Js(n[e],_l|qe,t);return function(r){return c6(i(r),e)}}function Km(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function s6(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return li(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function o6(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function yC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function _C(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function a6(n,e){const t=n[e];if(t!==void 0)return df(t,e)}function Hp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function l6(n,e){const t=n[e];if(t!==void 0)return bP(t,e)}function df(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function AP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Fv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function bP(n,e){if(typeof n=="string")return n;const t=df(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function PP(n,e){const t=df(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function c6(n,e){return typeof n=="number"?n:PP(n,e)}const hr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function vC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,m=l?l[1]:0;let y=n[0]+u/2+f,x=n[2]-u/2+f,T=n[1]+h/2+m,I=n[3]-h/2+m;y>x&&(y=(x+y)/2,x=y),T>I&&(T=(I+T)/2,I=T);let S=Dt(i[0],y,x),b=Dt(i[1],T,I);if(o&&t&&r){const N=30*r;S+=-N*Math.log(1+Math.max(0,y-i[0])/N)+N*Math.log(1+Math.max(0,i[0]-x)/N),b+=-N*Math.log(1+Math.max(0,T-i[1])/N)+N*Math.log(1+Math.max(0,i[1]-I)/N)}return[S,b]})}function u6(n){return n}function kP(n){return Math.pow(n,3)}function Mu(n){return 1-kP(1-n)}function h6(n){return 3*n*n-2*n*n*n}function d6(n){return n}function O1(n,e,t,i){const r=ft(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function F1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function f6(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?O1(u,t,o,i):u;if(l)return e?F1(r,f,h):Dt(r,h,f);const m=Math.min(f,r),y=Math.floor(u1(n,m,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function g6(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?O1(e,r,u,s):e;if(h)return i?F1(o,f,t):Dt(o,t,f);const m=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-m),x=-l*(.5-m)+.5,T=Math.min(f,o),I=Math.floor(Math.log(e/T)/Math.log(n)+x),S=Math.max(y,I),b=e/Math.pow(n,S);return Dt(b,t,f)}})}function xC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?O1(n,i,l,r):n;return!t||!u?Dt(s,e,h):F1(s,h,e)}})}function V1(n){if(n!==void 0)return 0}function wC(n){if(n!==void 0)return n}function m6(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function p6(n){const e=qo(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const y6=42,j1=256,A0=0;class Qr extends us{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=v1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Ub(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=$o(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in hr)delete t[l];this.setProperties(t,!0);const i=v6(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=_6(e),s=i.constraint,o=x6(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&Xg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],m={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||h6,callback:i};if(f.center&&(m.sourceCenter=o,m.targetCenter=f.center.slice(),o=m.targetCenter),f.zoom!==void 0?(m.sourceResolution=l,m.targetResolution=this.getResolutionForZoom(f.zoom),l=m.targetResolution):f.resolution&&(m.sourceResolution=l,m.targetResolution=f.resolution,l=m.targetResolution),f.rotation!==void 0){m.sourceRotation=u;const y=al(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;m.targetRotation=u+y,u=m.targetRotation}w6(m)?m.complete=!0:s+=m.duration,h.push(m)}this.animations_.push(h),this.setHint(Ln.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ln.ANIMATING]>0}getInteracting(){return this.hints_[Ln.INTERACTING]>0}cancelAnimations(){this.setHint(Ln.ANIMATING,-this.hints_[Ln.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Xg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const m=u.easing(f);if(u.sourceCenter){const y=u.sourceCenter[0],x=u.sourceCenter[1],T=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const S=y+m*(T-y),b=x+m*(I-x);this.targetCenter_=[S,b]}if(u.sourceResolution&&u.targetResolution){const y=m===1?u.targetResolution:u.sourceResolution+m*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),T=this.constraints_.resolution(y,0,x,!0);this.targetCenter_=this.calculateCenterZoom(T,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=m===1?al(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+m*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Ln.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Xg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],g1(i,e-this.getRotation()),uj(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Pv(e,this.getProjection())}getCenterInternal(){return this.get(hr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Bb(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();lt(t,"The view center is not defined");const i=this.getResolution();lt(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return lt(r!==void 0,"The view rotation is not defined"),Iv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(hr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal($o(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ft(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(hr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=b0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=u1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(lt(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){lt(!jp(e),"Cannot fit empty extent provided as `geometry`");const r=$o(e,this.getProjection());i=JI(r)}else if(e.getType()==="Circle"){const r=$o(e.getExtent(),this.getProjection());i=JI(r),i.rotate(this.getRotation(),gl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let m=0,y=s.length;m<y;m+=o){const x=s[m]*i-s[m+1]*r,T=s[m]*r+s[m+1]*i;l=Math.min(l,x),u=Math.min(u,T),h=Math.max(h,x),f=Math.max(f,T)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),m=Math.cos(h),y=gl(l);y[0]+=(r[1]-r[3])/2*u,y[1]+=(r[0]-r[2])/2*u;const x=y[0]*m-y[1]*f,T=y[1]*m+y[0]*f,I=this.getConstrainedCenter([x,T],u),S=t.callback?t.callback:Sd;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},S):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),Xg(S,!0))}centerOn(e,t,i){this.centerOnInternal(Ds(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(b0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=b0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Pv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(hr.ROTATION)!==r&&this.set(hr.ROTATION,r),this.get(hr.RESOLUTION)!==o&&(this.set(hr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(hr.CENTER)||!Lm(this.get(hr.CENTER),l))&&this.set(hr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Lm(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:Mu,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ln.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ds(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Ln.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Xg(n,e){setTimeout(function(){n(e)},0)}function _6(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return vC(n.extent,n.constrainOnlyCenter,t)}const e=v1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,vC(t,!1,!1)}return u6}function v6(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:A0,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,m=n.showFullExtent!==void 0?n.showFullExtent:!1,y=v1(n.projection,"EPSG:3857"),x=y.getExtent();let T=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&y.isGlobal()&&(T=!1,I=x),n.resolutions!==void 0){const S=n.resolutions;t=S[o],i=S[l]!==void 0?S[l]:S[S.length-1],n.constrainResolution?e=f6(S,f,!T&&I,m):e=xC(t,i,f,!T&&I,m)}else{const b=(x?Math.max(ft(x),Bn(x)):360*hu.degrees/y.getMetersPerUnit())/j1/Math.pow(2,A0),N=b/Math.pow(2,28-A0);t=n.maxResolution,t!==void 0?o=0:t=b/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=b/Math.pow(u,l):i=N),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=g6(u,t,i,f,!T&&I,m):e=xC(t,i,f,!T&&I,m)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function x6(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?p6():t===!1?wC:typeof t=="number"?m6(t):wC}return V1}function w6(n){return!(n.sourceCenter&&n.targetCenter&&!Lm(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function b0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const dt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class NP extends us{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[dt.OPACITY]=e.opacity!==void 0?e.opacity:1,lt(typeof t[dt.OPACITY]=="number","Layer opacity must be a number"),t[dt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[dt.Z_INDEX]=e.zIndex,t[dt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[dt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[dt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[dt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return nt()}getLayerStatesArray(e){return nt()}getExtent(){return this.get(dt.EXTENT)}getMaxResolution(){return this.get(dt.MAX_RESOLUTION)}getMinResolution(){return this.get(dt.MIN_RESOLUTION)}getMinZoom(){return this.get(dt.MIN_ZOOM)}getMaxZoom(){return this.get(dt.MAX_ZOOM)}getOpacity(){return this.get(dt.OPACITY)}getSourceState(){return nt()}getVisible(){return this.get(dt.VISIBLE)}getZIndex(){return this.get(dt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(dt.EXTENT,e)}setMaxResolution(e){this.set(dt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(dt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(dt.MAX_ZOOM,e)}setMinZoom(e){this.set(dt.MIN_ZOOM,e)}setOpacity(e){lt(typeof e=="number","Layer opacity must be a number"),this.set(dt.OPACITY,e)}setVisible(e){this.set(dt.VISIBLE,e)}setZIndex(e){this.set(dt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Xp extends NP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(dt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(dt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(bt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=it(e,We.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Qr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return z1(r,t.viewState)&&(!s||oi(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Qr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(dt.MAP,e)}getMapInternal(){return this.get(dt.MAP)}setMap(e){this.mapPrecomposeKey_&&(bt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(bt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=it(e,qi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=it(this,We.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);lt(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(dt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function z1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const EC={RENDER_ORDER:"renderOrder"};class DP extends Xp{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(EC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new pP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(EC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?_P:e;const t=E6(e);this.styleFunction_=e===null?void 0:r3(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function E6(n){if(n===void 0)return _P;if(!n)return null;if(typeof n=="function"||n instanceof Qi)return n;if(!Array.isArray(n))return mC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Qi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Qi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return Z3(r)}return mC(n)}class U1 extends DP{constructor(e){super(e)}createRenderer(){return new I3(this)}}const Po={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class zo extends Qs{constructor(e,t){super(e),this.layer=t}}const P0={LAYERS:"layers"};class Lu extends NP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(P0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Xi(i.slice(),{unique:!0}):lt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Xi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(bt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(it(e,ti.ADD,this.handleLayersAdd_,this),it(e,ti.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(bt);sf(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new zo(Po.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[it(e,au.PROPERTYCHANGE,this.handleLayerChange_,this),it(e,We.CHANGE,this.handleLayerChange_,this)];e instanceof Lu&&t.push(it(e,Po.ADDLAYER,this.handleLayerGroupAdd_,this),it(e,Po.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[rt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new zo(Po.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new zo(Po.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new zo(Po.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=rt(t);this.listenerKeys_[i].forEach(bt),delete this.listenerKeys_[i],this.dispatchEvent(new zo(Po.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(P0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new zo(Po.REMOVELAYER,i[r]))}this.set(P0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=ol(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Re={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class B1 extends Mp{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(We.CHANGE)}release(){this.setState(Re.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Re.EMPTY){if(this.state!==Re.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){nt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:kP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Vv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const T6=new Error("disposed"),S6=[256,256];class TC extends B1{constructor(e){const t=Re.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Vv(this.data_);return e?[e.width,e.height]:S6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Re.IDLE&&this.state!==Re.ERROR)return;this.state=Re.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Re.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Re.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(T6),this.controller_=null),super.disposeInternal()}}class MP extends B1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Si?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Re.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Re.ERROR,this.unlistenImage_(),this.image_=I6(),this.changed()}handleImageLoad_(){if(Si)this.state=Re.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Re.LOADED:this.state=Re.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Re.ERROR&&(this.state=Re.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Re.IDLE&&(this.state=Re.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=v4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function I6(){const n=Jt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let k0;const Qc=[];function SC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function N0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function C6(){if(k0===void 0){const n=Jt(6,6,Qc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",SC(n,4,5,4,0),SC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;k0=N0(e,0)||N0(e,4)||N0(e,8),Wp(n),Qc.push(n.canvas)}return k0}function IC(n,e,t,i){const r=Bp(t,e,n);let s=Vm(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||uu(u,r)){const h=Vm(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function R6(n,e,t,i){const r=gl(t);let s=IC(n,e,r,i);return(!isFinite(s)||s<=0)&&Pb(t,function(o){return s=IC(n,e,o,i),isFinite(s)&&s>0}),s}function A6(n,e,t,i,r,s,o,l,u,h,f,m,y,x){const T=Jt(Math.round(t*n),Math.round(t*e),Qc);if(m||(T.imageSmoothingEnabled=!1),u.length===0)return T.canvas;T.scale(t,t);function I(D){return Math.round(D*t)/t}T.globalCompositeOperation="lighter";const S=Ji();u.forEach(function(D,j,k){ij(S,D.extent)});let b;const N=t/i,M=(m?1:1+Math.pow(2,-24))/N;b=Jt(Math.round(ft(S)*N),Math.round(Bn(S)*N),Qc),m||(b.imageSmoothingEnabled=!1),u.forEach(function(D,j,k){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){b.save();const B=(D.clipExtent[0]-S[0])*N,O=-(D.clipExtent[3]-S[3])*N,le=ft(D.clipExtent)*N,me=Bn(D.clipExtent)*N;b.rect(m?B:Math.round(B),m?O:Math.round(O),m?le:Math.round(B+le)-Math.round(B),m?me:Math.round(O+me)-Math.round(O)),b.clip()}const A=(D.extent[0]-S[0])*N,L=-(D.extent[3]-S[3])*N,V=ft(D.extent)*N,z=Bn(D.extent)*N;b.drawImage(D.image,h,h,D.image.width-2*h,D.image.height-2*h,m?A:Math.round(A),m?L:Math.round(L),m?V:Math.round(A+V)-Math.round(A),m?z:Math.round(L+z)-Math.round(L)),D.clipExtent&&b.restore()}});const R=Nl(o);return l.getTriangles().forEach(function(D,j,k){const A=D.source,L=D.target;let V=A[0][0],z=A[0][1],B=A[1][0],O=A[1][1],le=A[2][0],me=A[2][1];const ge=I((L[0][0]-R[0])/s),ue=I(-(L[0][1]-R[1])/s),Q=I((L[1][0]-R[0])/s),se=I(-(L[1][1]-R[1])/s),ne=I((L[2][0]-R[0])/s),G=I(-(L[2][1]-R[1])/s),$=V,ie=z;V=0,z=0,B-=$,O-=ie,le-=$,me-=ie;const pe=[[B,O,0,0,Q-ge],[le,me,0,0,ne-ge],[0,0,B,O,se-ue],[0,0,le,me,G-ue]],xe=cj(pe);if(!xe)return;if(T.save(),T.beginPath(),C6()||!m){T.moveTo(Q,se);const Le=4,je=ge-Q,Ge=ue-se;for(let ct=0;ct<Le;ct++)T.lineTo(Q+I((ct+1)*je/Le),se+I(ct*Ge/(Le-1))),ct!=Le-1&&T.lineTo(Q+I((ct+1)*je/Le),se+I((ct+1)*Ge/(Le-1)));T.lineTo(ne,G)}else T.moveTo(Q,se),T.lineTo(ge,ue),T.lineTo(ne,G);T.clip(),T.transform(xe[0],xe[2],xe[1],xe[3],ge,ue),T.translate(S[0]-$,S[3]-ie);let ke;if(b)ke=b.canvas,T.scale(M,-M);else{const Le=u[0],je=Le.extent;ke=Le.image,T.scale(ft(je)/ke.width,-Bn(je)/ke.height)}T.drawImage(ke,0,0),T.restore()}),b&&(Wp(b),Qc.push(b.canvas)),f&&(T.save(),T.globalCompositeOperation="source-over",T.strokeStyle="black",T.lineWidth=1,l.getTriangles().forEach(function(D,j,k){const A=D.target,L=(A[0][0]-R[0])/s,V=-(A[0][1]-R[1])/s,z=(A[1][0]-R[0])/s,B=-(A[1][1]-R[1])/s,O=(A[2][0]-R[0])/s,le=-(A[2][1]-R[1])/s;T.beginPath(),T.moveTo(z,B),T.lineTo(L,V),T.lineTo(O,le),T.closePath(),T.stroke()}),T.restore()),T.canvas}const b6=10,CC=.25;class P6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?zj(M=>un(l,Bp(M,this.targetProj_,this.sourceProj_))):jm(this.targetProj_,this.sourceProj_);this.transformInv_=function(M){const R=M[0]+"/"+M[1];return u[R]||(u[R]=h(M)),u[R]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ft(r)>=ft(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ft(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ft(this.targetProj_.getExtent()):null;const f=Nl(i),m=Vp(i),y=Fp(i),x=Op(i),T=this.transformInv_(f),I=this.transformInv_(m),S=this.transformInv_(y),b=this.transformInv_(x),N=b6+(o?Math.max(0,Math.ceil(Math.log2(Sv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,m,y,x,T,I,S,b,N),this.wrapsXInSource_){let M=1/0;this.triangles_.forEach(function(R,D,j){M=Math.min(M,R.source[0][0],R.source[1][0],R.source[2][0])}),this.triangles_.forEach(R=>{if(Math.max(R.source[0][0],R.source[1][0],R.source[2][0])-M>this.sourceWorldWidth_/2){const D=[[R.source[0][0],R.source[0][1]],[R.source[1][0],R.source[1][1]],[R.source[2][0],R.source[2][1]]];D[0][0]-M>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-M>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-M>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const j=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-j<this.sourceWorldWidth_/2&&(R.source=D)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=CI([s,o,l,u]),m=this.sourceWorldWidth_?ft(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&m>.5&&m<1;let T=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const S=CI([e,t,i,r]);T=ft(S)/this.targetWorldWidth_>CC||T}!x&&this.sourceProj_.isGlobal()&&m&&(T=m>CC||T)}if(!T&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!oi(f,this.maxSourceExtent_))return;let I=0;if(!T&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)T=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!T){const S=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(S);let N;x?N=(al(s[0],y)+al(l[0],y))/2-al(b[0],y):N=(s[0]+l[0])/2-b[0];const M=(s[1]+l[1])/2-b[1];T=N*N+M*M>this.errorThresholdSquared_}if(T){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const S=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(S),N=[(r[0]+e[0])/2,(r[1]+e[1])/2],M=this.transformInv_(N);this.addQuad_(e,t,S,N,s,o,b,M,h-1),this.addQuad_(N,S,i,r,M,b,l,u,h-1)}else{const S=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(S),N=[(i[0]+r[0])/2,(i[1]+r[1])/2],M=this.transformInv_(N);this.addQuad_(e,S,N,r,s,b,M,u,h-1),this.addQuad_(S,t,i,N,b,o,l,M,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=Ji();return this.triangles_.forEach(function(t,i,r){const s=t.source;id(e,s[0]),id(e,s[1]),id(e,s[2])}),e}getTriangles(){return this.triangles_}}const k6=.5;class LP extends B1{constructor(e,t,i,r,s,o,l,u,h,f,m,y){super(s,Re.IDLE,y),this.renderEdges_=m!==void 0?m:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),T=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const S=T?ol(x,T):x;if(Sv(S)===0){this.state=Re.EMPTY;return}const b=e.getExtent();b&&(I?I=ol(I,b):I=b);const N=r.getResolution(this.wrappedTileCoord_[0]),M=R6(e,i,S,N);if(!isFinite(M)||M<=0){this.state=Re.EMPTY;return}const R=f!==void 0?f:k6;if(this.triangulation_=new P6(e,i,S,I,M*R,N),this.triangulation_.getTriangles().length===0){this.state=Re.EMPTY;return}this.sourceZ_=t.getZForResolution(M);let D=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(D[1]=Dt(D[1],I[1],I[3]),D[3]=Dt(D[3],I[1],I[3])):D=ol(D,I)),!Sv(D))this.state=Re.EMPTY;else{let j=0,k=0;e.canWrapX()&&(j=ft(b),k=Math.floor((D[0]-b[0])/j)),Db(D.slice(),e,!0).forEach(L=>{const V=t.getTileRangeForExtentAndZ(L,this.sourceZ_);for(let z=V.minX;z<=V.maxX;z++)for(let B=V.minY;B<=V.maxY;B++){const O=h(this.sourceZ_,z,B,l);if(O){const le=k*j;this.sourceTiles_.push({tile:O,offset:le})}}++k}),this.sourceTiles_.length===0&&(this.state=Re.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Re.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Re.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=A6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Re.LOADED}this.changed()}load(){if(this.state==Re.IDLE){this.state=Re.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Re.IDLE||i==Re.LOADING){e++;const r=it(t,We.CHANGE,s=>{const o=t.getState();(o==Re.LOADED||o==Re.ERROR||o==Re.EMPTY)&&(bt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Re.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(bt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Wp(this.canvas_.getContext("2d")),Qc.push(this.canvas_),this.canvas_=null),super.release()}}class W1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Sc(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new W1(n,e,t,i)}class RC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Np&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return lt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return lt(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){lt(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Hm(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function N6(n,e,t){return n+"/"+e+"/"+t}function dm(n,e,t,i,r){return`${rt(n)},${e},${N6(t,i,r)}`}function D6(n){return M6(n[0],n[1],n[2])}function M6(n,e,t){return(e<<n)+t}function L6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function D0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function O6(n,e,t){const i=n[t];return i?i.delete(e):!1}function AC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=ol(e,$o(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=ol(e,r))}return e}class F6 extends TP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Ji(),this.tempTileRange_=new W1(0,0,0,0),this.tempTileCoord_=Hm(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new RC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new RC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=dm(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,m=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!m||hm(m,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!uu(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const m=u.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,m[1],m[2],t);if(!y||y.getState()!==Re.LOADED)continue;const x=u.getOrigin(f),T=li(u.getTileSize(f)),I=u.getResolution(f);let S;if(y instanceof MP||y instanceof LP)S=y.getImage();else if(y instanceof TC){if(S=Vv(y.getData()),!S)continue}else continue;const b=Math.floor(h*((r[0]-x[0])/I-m[1]*T[0])),N=Math.floor(h*((x[1]-r[1])/I-m[2]*T[1])),M=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(S,b+M,N+M)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=rt(u);f in e.wantedTiles||(e.wantedTiles[f]={});const m=e.wantedTiles[f],y=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),T=o.rotation,I=T?kb(o.center,o.resolution,T,e.size):void 0;for(let S=i;S>=x;--S){const b=h.getTileRangeForExtentAndZ(t,S,this.tempTileRange_),N=h.getResolution(S);for(let M=b.minX;M<=b.maxX;++M)for(let R=b.minY;R<=b.maxY;++R){if(T&&!h.tileCoordIntersectsViewport([S,M,R],I))continue;const D=this.getTile(S,M,R,e);if(!D||!D0(r,D,S))continue;const k=D.getKey();if(m[k]=!0,D.getState()===Re.IDLE&&!e.tileQueue.isKeyQueued(k)){const A=Hm(S,M,R,this.tempTileCoord_);e.tileQueue.enqueue([D,f,h.getTileCoordCenter(A),N])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=dm(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Re.LOADED)return f.endTransition(rt(this)),D0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let m=s.minY;m<=s.maxY;++m){const y=dm(u,h,i,f,m);let x=!1;if(l.containsKey(y)){const T=l.peek(y);T.getState()===Re.LOADED&&(D0(r,T,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),m=f.getTileGridForProjection(s),y=m.getZForResolution(o,f.zDirection),x=m.getResolution(y),T=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==T&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=T):this.renderedSourceKey_=T;let I=e.extent;const S=f.getTilePixelRatio(u);this.prepareContainer(e,t);const b=this.context.canvas.width,N=this.context.canvas.height,M=i.extent&&$o(i.extent);M&&(I=ol(I,$o(i.extent)));const R=x*b/2/S,D=x*N/2/S,j=[l[0]-R,l[1]-D,l[0]+R,l[1]+D],k={};this.renderedTiles.length=0;const A=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=m.getZForResolution(r.nextResolution,f.zDirection),se=AC(e,e.nextExtent);this.enqueueTiles(e,se,Q,k,A)}const L=AC(e,I);if(this.enqueueTiles(e,L,y,k,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,L,y-1,k,A-1)},0),!(y in k))return this.container;const V=rt(this),z=e.time;for(const Q of k[y]){const se=Q.getState();if(se===Re.EMPTY)continue;const ne=Q.tileCoord;if(se===Re.LOADED&&Q.getAlpha(V,z)===1){Q.endTransition(V);continue}if(se!==Re.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,k)){O6(k,Q,y),e.animate=!0;continue}if(this.findAltTiles_(m,ne,y+1,k))continue;const ie=m.getMinZoom();for(let pe=y-1;pe>=ie&&!this.findAltTiles_(m,ne,pe,k);--pe);}const B=x/o*u/S,O=this.getRenderContext(e);Xs(this.tempTransform,b/2,N/2,B,B,0,-b/2,-N/2),i.extent&&this.clipUnrotated(O,e,M),f.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e);const le=Object.keys(k).map(Number);le.sort(Bs);let me;const ge=[],ue=[];for(let Q=le.length-1;Q>=0;--Q){const se=le[Q],ne=f.getTilePixelSize(se,u,s),$=m.getResolution(se)/x,ie=ne[0]*$*B,pe=ne[1]*$*B,xe=m.getTileCoordForCoordAndZ(Nl(j),se),ke=m.getTileCoordExtent(xe),Le=un(this.tempTransform,[S*(ke[0]-j[0])/x,S*(j[3]-ke[3])/x]),je=S*f.getGutterForProjection(s);for(const Ge of k[se]){if(Ge.getState()!==Re.LOADED)continue;const ct=Ge.tileCoord,er=xe[1]-ct[1],fs=Math.round(Le[0]-(er-1)*ie),$n=xe[2]-ct[2],Kn=Math.round(Le[1]-($n-1)*pe),hn=Math.round(Le[0]-er*ie),dn=Math.round(Le[1]-$n*pe),Hn=fs-hn,Pi=Kn-dn,_t=le.length===1;let ut=!1;me=[hn,dn,hn+Hn,dn,hn+Hn,dn+Pi,hn,dn+Pi];for(let nn=0,ki=ge.length;nn<ki;++nn)if(!_t&&se<ue[nn]){const It=ge[nn];oi([hn,dn,hn+Hn,dn+Pi],[It[0],It[3],It[4],It[7]])&&(ut||(O.save(),ut=!0),O.beginPath(),O.moveTo(me[0],me[1]),O.lineTo(me[2],me[3]),O.lineTo(me[4],me[5]),O.lineTo(me[6],me[7]),O.moveTo(It[6],It[7]),O.lineTo(It[4],It[5]),O.lineTo(It[2],It[3]),O.lineTo(It[0],It[1]),O.clip())}ge.push(me),ue.push(se),this.drawTile(Ge,e,hn,dn,Hn,Pi,je,_t),ut&&O.restore(),this.renderedTiles.unshift(Ge),this.updateUsedTiles(e.usedTiles,f,Ge)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!Id(this.renderedExtent_,j),this.renderedExtent_=j,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,this.renderComplete){const Q=(se,ne)=>{const G=rt(f),$=ne.wantedTiles[G],ie=$?Object.keys($).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof TC){if(h=Vv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),m=rt(this),y=t.layerStatesArray[t.layerIndex],x=y.opacity*(u?e.getAlpha(m,t.time):1),T=x!==f.globalAlpha;T&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),T&&f.restore(),x!==y.opacity?t.animate=!0:u&&e.endTransition(m)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=rt(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const qg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class V6 extends Xp{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(qg.PRELOAD)}setPreload(e){this.set(qg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(qg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(qg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class M0 extends V6{constructor(e){super(e)}createRenderer(){return new F6(this,{cacheSize:this.getCacheSize()})}}const Ic=[0,0,0],ko=5;class OP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,lt(QV(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,lt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Nl(i)),lt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,lt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:j1,lt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new W1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Sc(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Sc(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Sc(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Sc(h,h,f,f,i);const m=Math.floor(u*(s+1))-1,y=Math.floor(u*(o+1))-1;return Sc(h,m,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Ic);const r=Ic[1],s=Ic[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Ic);const o=Ic[1],l=Ic[2];return Sc(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=li(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=li(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return na(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=li(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],m=l*(u[1]-t)/i/h[1];return r?(f=zg(f,ko)-1,m=zg(m,ko)-1):(f=jg(f,ko),m=jg(m,ko)),Hm(o,f,m,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=li(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=zg(h,ko)-1,f=zg(f,ko)-1):(h=jg(h,ko),f=jg(f,ko)),Hm(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=u1(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Zb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function FP(n){let e=n.getDefaultTileGrid();return e||(e=B6(n),n.setDefaultTileGrid(e)),e}function j6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=G1(t);if(!uu(s,r)){const o=ft(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function z6(n,e,t,i){i=i!==void 0?i:"top-left";const r=VP(n,e,t);return new OP({extent:n,origin:sj(n,i),resolutions:r,tileSize:t})}function U6(n){const e=n||{},t=e.extent||ci("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:VP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new OP(i)}function VP(n,e,t,i){e=e!==void 0?e:y6,t=li(t!==void 0?t:j1);const r=Bn(n),s=ft(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function B6(n,e,t,i){const r=G1(n);return z6(r,e,t,i)}function G1(n){n=ci(n);let e=n.getExtent();if(!e){const t=180*hu.degrees/n.getMetersPerUnit();e=na(-t,-t,t,t)}return e}function sq(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const W6=/\{z\}/g,G6=/\{x\}/g,$6=/\{y\}/g,K6=/\{-y\}/g;function H6(n,e,t,i,r){return n.replace(W6,e.toString()).replace(G6,t.toString()).replace($6,i.toString()).replace(K6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function X6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function q6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return H6(n,o,t[1],t[2],s)})}function Y6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=q6(n[r],e);return Z6(i)}function Z6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=D6(e),s=al(r,n.length);return n[s](e,t,i)})}class Q6 extends yP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&li(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||rt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return nt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:FP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=li(r.getTileSize(e),this.tmpSize);return s==1?o:i3(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=j6(r,e,i)),L6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class J6 extends Qs{constructor(e,t){super(e),this.tile=t}}const L0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class $1 extends Q6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===$1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=rt(t),r=t.getState();let s;r==Re.LOADING?(this.tileLoadingKeys_[i]=!0,s=L0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Re.ERROR?L0.TILELOADERROR:r==Re.LOADED?L0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new J6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=X6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Y6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class e9 extends $1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:jP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:MP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!hm(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||hm(t,e)))return this.tileGrid;const i=rt(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=FP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Re.IDLE:Re.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(We.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||hm(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),m=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(u,s),x=new LP(l,f,s,m,u,y,this.getTilePixelRatio(r),this.getGutter(),(T,I,S,b)=>this.getTileInternal(T,I,S,b,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=dm(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=ci(e);if(i){const r=rt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function jP(n,e){if(Si){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class jv extends e9{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:U6({extent:G1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const t9="modulepreload",n9=function(n){return"/visapp/"+n},bC={},Yg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=n9(h),h in bC)return;bC[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":t9,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((x,T)=>{y.addEventListener("load",x),y.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},i9='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class r9 extends jv{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[i9];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Si&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||jP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Xm=1/0;class s9{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,sf(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){lt(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Xm?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Xm?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class o9 extends s9{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(We.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Re.LOADED||i===Re.ERROR||i===Re.EMPTY){i!==Re.ERROR&&t.removeEventListener(We.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Re.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function a9(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Xm;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Oc extends Qs{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Vo extends Oc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lt={SINGLECLICK:"singleclick",CLICK:We.CLICK,DBLCLICK:We.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},zv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class l9 extends Mp{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=it(i,zv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=it(i,zv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(We.TOUCHMOVE,this.boundHandleTouchMove_,tP?{passive:!1}:!1)}emulateClick_(e){let t=new Vo(Lt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Vo(Lt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Vo(Lt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Lt.POINTERUP||t.type==Lt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Lt.POINTERDOWN||t.type==Lt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Vo(Lt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Vo(Lt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(it(i,Lt.POINTERMOVE,this.handlePointerMove_,this),it(i,Lt.POINTERUP,this.handlePointerUp_,this),it(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(it(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Vo(Lt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Vo(Lt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(bt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(We.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(bt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const jo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Dn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class qp extends us{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)bt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Sd&&this.listenerKeys.push(it(e,jo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class c9 extends qp{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(We.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+cf+" "+b1+(this.collapsed_&&this.collapsible_?" "+KI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>JV(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!la(t,this.renderedAttributions_)){l4(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(KI),this.collapsed_?GI(this.collapseLabel_,this.label_):GI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class u9 extends qp{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(We.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+cf+" "+b1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Wg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Mu}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Wg);!s&&i===0?this.element.classList.add(Wg):s&&i!==0&&this.element.classList.remove(Wg)}this.label_.style.transform=r}this.rotation_=i}}class h9 extends qp{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(We.CLICK,this.handleClick_.bind(this,i),!1);const m=document.createElement("button");m.className=s,m.setAttribute("type","button"),m.title=h,m.appendChild(typeof l=="string"?document.createTextNode(l):l),m.addEventListener(We.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+cf+" "+b1,x=this.element;x.className=y,x.appendChild(f),x.appendChild(m),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Mu})):i.setZoom(s)}}}function d9(n){n=n||{};const e=new Xi;return(n.zoom===void 0||n.zoom)&&e.push(new h9(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new u9(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new c9(n.attributionOptions)),e}class f9{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const PC={ACTIVE:"active"};class ff extends us{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(PC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(PC.ACTIVE,e)}setMap(e){this.map_=e}}function g9(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:d6,center:n.getConstrainedCenter(r)})}}function K1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Mu})}class m9 extends ff{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();K1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Uv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const p9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},y9=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},zP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?y9(n):!0},_9=Td,UP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(o4&&Jb&&e.ctrlKey)},BP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},v9=function(n){const e=n.originalEvent;return Jb?e.metaKey:e.ctrlKey},x9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},WP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},O0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},w9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class gf extends ff{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Lt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Lt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function H1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class E9 extends gf{constructor(e){super({stopDown:Dp}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Uv(BP,w9);this.condition_=e.onFocusOnly?Uv(zP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(H1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();hj(s,l.getResolution()),g1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Mu})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class T9 extends gf{constructor(e){e=e||{},super({stopDown:Dp}),this.condition_=e.condition?e.condition:p9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!O0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===V1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return O0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return O0(e)&&UP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class S9 extends Np{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Nd([r])}getGeometry(){return this.geometry_}}const Cc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Nh extends Qs{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class I9 extends gf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new S9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??UP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Nh(Cc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Nh(t?Cc.BOXEND:Cc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Nh(Cc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Nh(Cc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Nh(Cc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class C9 extends I9{constructor(e){e=e||{};const t=e.condition?e.condition:x9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:Mu})}}const Fa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class R9 extends ff{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return BP(t)&&WP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==We.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Fa.DOWN||r==Fa.LEFT||r==Fa.RIGHT||r==Fa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Fa.DOWN?h=-l:r==Fa.LEFT?u=-l:r==Fa.RIGHT?u=l:h=l;const f=[u,h];g1(f,o.getRotation()),g9(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class A9 extends ff{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!v9(t)&&WP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==We.KEYDOWN||e.type==We.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();K1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const b9=40,P9=300;class k9 extends ff{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:_9;this.condition_=e.onFocusOnly?Uv(zP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==We.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=b9;break;case WheelEvent.DOM_DELTA_PAGE:s*=P9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),K1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class N9 extends gf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Dp),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==V1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(H1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class D9 extends gf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Dp),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(H1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function M9(n){n=n||{};const e=new Xi,t=new f9(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new T9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new m9({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new E9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new N9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new D9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new R9),e.push(new A9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new k9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new C9({duration:n.zoomDuration})),e}class L9 extends Np{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){nt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Xs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Wb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function m(R,D,j,k){return s.call(o,D,R?j:null,k)}const y=f.projection,x=Mb(e.slice(),y),T=[[0,0]];if(y.canWrapX()&&r){const R=y.getExtent(),D=ft(R);T.push([-D,0],[D,0])}const I=t.layerStatesArray,S=I.length,b=[],N=[];for(let R=0;R<T.length;R++)for(let D=S-1;D>=0;--D){const j=I[D],k=j.layer;if(k.hasRenderer()&&z1(j,f)&&l.call(u,k)){const A=k.getRenderer(),L=k.getSource();if(A&&L){const V=L.getWrapX()?x:e,z=m.bind(null,j.managed);N[0]=V[0]+T[R][0],N[1]=V[1]+T[R][1],h=A.forEachFeatureAtCoordinate(N,t,i,z,b)}if(h)return h}}if(b.length===0)return;const M=1/b.length;return b.forEach((R,D)=>R.distanceSq+=D*M),b.sort((R,D)=>R.distanceSq-D.distanceSq),b.some(R=>h=R.callback(R.feature,R.layer,R.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Td,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){nt()}scheduleExpireIconCache(e){Yi.canExpireCache()&&e.postRenderFunctions.push(O9)}}function O9(n,e){Yi.expire()}class F9 extends L9{constructor(e){super(e),this.fontChangeListenerKey_=it(Dc,au.PROPERTYCHANGE,e.redrawText,e),this.element_=Si?nP():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=cf+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new EP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){bt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(qi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof DP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const m=t[h];e.layerIndex=h;const y=m.layer,x=y.getSourceState();if(!z1(m,r)||x!="ready"&&x!="undefined"){y.unrender();continue}const T=y.render(e,o);T&&(T!==o&&(this.children_.push(T),o=T),s.push(m))}this.declutter(e,s),c4(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Ko(u)){const h=u.getContext("2d");for(const f of this.children_){const m=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Ko(m)||m.width>0)&&(h.fillStyle=y,h.fillRect(0,0,u.width,u.height)),Ko(m)&&m.width>0){const x=f.style.opacity||m.style.opacity;h.globalAlpha=x===""?1:Number(x);const T=m.style.transform;if(T)h.setTransform(...kv(T));else{const I=parseFloat(m.style.width)/m.width,S=parseFloat(m.style.height)/m.height;h.setTransform(I,0,0,S,0,0)}h.drawImage(m,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(qi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function GP(n){if(n instanceof Xp){n.setMapInternal(null);return}n instanceof Lu&&n.getLayers().forEach(GP)}function $P(n,e){if(n instanceof Xp){n.setMapInternal(e);return}if(n instanceof Lu){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)$P(t[i],e)}}let V9=class extends us{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=j9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:a4,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Er(),this.pixelToCoordinateTransform_=Er(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Si||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Si||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Si?new Xi:d9()),this.interactions=t.interactions||(Si?new Xi:M9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new o9(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Dn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Dn.VIEW,this.handleViewChanged_),this.addChangeListener(Dn.SIZE,this.handleSizeChanged_),this.addChangeListener(Dn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Qr)&&e.view.then(function(r){i.setView(new Qr(r))}),this.controls.addEventListener(ti.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ti.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ti.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ti.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ti.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ti.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){$P(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Td,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Lu?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Td,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Dn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Pv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Dn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Xi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Dn.SIZE)}getView(){return this.get(Dn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return a9(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Vo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===zv.POINTERDOWN||i===We.WHEEL||i===We.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Ln.ANIMATING]||o[Ln.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(qi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(qi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Oc(jo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Oc(jo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)bt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(We.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(We.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ko(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ko(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new F9(this)),!Ko(t)){this.mapBrowserEventHandler_=new l9(this,this.moveTolerance_);for(const r in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(We.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(We.WHEEL,this.boundHandleBrowserEvent_,tP?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[it(i,We.KEYDOWN,this.handleBrowserEvent,this),it(i,We.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(bt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(bt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=it(e,au.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=it(e,We.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(bt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new zo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[it(e,au.PROPERTYCHANGE,this.render,this),it(e,We.CHANGE,this.render,this),it(e,"addlayer",this.handleLayerAdd_,this),it(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){GP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&rC(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Iv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:rt(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Iv(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!jp(this.previousExtent_)&&!Id(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Oc(jo.MOVESTART,this,r)),this.previousExtent_=Lp(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Ln.ANIMATING]&&!s.viewHints[Ln.INTERACTING]&&!Id(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Oc(jo.MOVEEND,this,s)),Ib(s.extent,this.previousExtent_))),this.dispatchEvent(new Oc(jo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(jo.LOADSTART)||this.hasListener(jo.LOADEND)||this.hasListener(qi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new zo("removelayer",t)),this.set(Dn.LAYERGROUP,e)}setSize(e){this.set(Dn.SIZE,e)}setTarget(e){this.set(Dn.TARGET,e)}setView(e){if(!e||e instanceof Qr){this.set(Dn.VIEW,e);return}this.set(Dn.VIEW,new Qr);const t=this;e.then(function(i){t.setView(new Qr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Ko(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!rC(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Lb("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!la(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function j9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Lu({layers:n.layers});t[Dn.LAYERGROUP]=i,t[Dn.TARGET]=n.target,t[Dn.VIEW]=n.view instanceof Qr?n.view:new Qr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Xi(n.controls.slice()):(lt(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Xi(n.interactions.slice()):(lt(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Xi(n.overlays.slice()):(lt(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Xi,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const F0="units",z9=[1,2,5],Dh=25.4/.28;class U9 extends qp{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+cf,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(F0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(F0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(F0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Vm(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||Dh)/Dh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Dh)/Dh:void 0;let h=l*o,f="";if(r=="degrees"){const M=hu.degrees;h*=M,h<M/60?(f="",o*=3600):h<M?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let m=3*Math.floor(Math.log(l*o)/Math.log(10)),y,x,T,I=0,S,b;for(;;){T=Math.floor(m/3);const M=Math.pow(10,T);if(y=z9[(m%3+3)%3]*M,x=Math.round(y/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){y=I,x=S,T=b;break}else if(x>=l)break;I=y,S=x,b=T,++m}const N=this.scaleBar_?this.createScaleBar(x,y,f):y.toFixed(T<0?-T:0)+" "+f;this.renderedHTML_!=N&&(this.innerElement_.innerHTML=N,this.renderedHTML_=N),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const m=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${m}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Vm(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Dh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const B9={},kC=n=>{let e;const t=new Set,i=(f,m)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const x=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(T=>T(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(B9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},W9=n=>n?kC(n):kC;var V0={exports:{}},j0={},z0={exports:{}},U0={};var NC;function G9(){if(NC)return U0;NC=1;var n=Jd();function e(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(m,y){var x=y(),T=i({inst:{value:x,getSnapshot:y}}),I=T[0].inst,S=T[1];return s(function(){I.value=x,I.getSnapshot=y,u(I)&&S({inst:I})},[m,x,y]),r(function(){return u(I)&&S({inst:I}),m(function(){u(I)&&S({inst:I})})},[m]),o(x),x}function u(m){var y=m.getSnapshot;m=m.value;try{var x=y();return!t(m,x)}catch{return!0}}function h(m,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return U0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,U0}var DC;function $9(){return DC||(DC=1,z0.exports=G9()),z0.exports}var MC;function K9(){if(MC)return j0;MC=1;var n=Jd(),e=$9();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return j0.useSyncExternalStoreWithSelector=function(h,f,m,y,x){var T=s(null);if(T.current===null){var I={hasValue:!1,value:null};T.current=I}else I=T.current;T=l(function(){function b(j){if(!N){if(N=!0,M=j,j=y(j),x!==void 0&&I.hasValue){var k=I.value;if(x(k,j))return R=k}return R=j}if(k=R,i(M,j))return k;var A=y(j);return x!==void 0&&x(k,A)?(M=j,k):(M=j,R=A)}var N=!1,M,R,D=m===void 0?null:m;return[function(){return b(f())},D===null?void 0:function(){return b(D())}]},[f,m,y,x]);var S=r(h,T[0],T[1]);return o(function(){I.hasValue=!0,I.value=S},[S]),u(S),S},j0}var LC;function H9(){return LC||(LC=1,V0.exports=K9()),V0.exports}var X9=H9();const q9=Px(X9),KP={},{useDebugValue:Y9}=uL,{useSyncExternalStoreWithSelector:Z9}=q9;let OC=!1;const Q9=n=>n;function J9(n,e=Q9,t){(KP?"production":void 0)!=="production"&&t&&!OC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),OC=!0);const i=Z9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Y9(i),i}const FC=n=>{(KP?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?W9(n):n,t=(i,r)=>J9(e,i,r);return Object.assign(t,e),t},Rr=n=>n?FC(n):FC;var HP=Symbol.for("immer-nothing"),VC=Symbol.for("immer-draftable"),Ri=Symbol.for("immer-state");function pr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Ld=Object.getPrototypeOf;function pu(n){return!!n&&!!n[Ri]}function vl(n){return n?XP(n)||Array.isArray(n)||!!n[VC]||!!n.constructor?.[VC]||mf(n)||Zp(n):!1}var ez=Object.prototype.constructor.toString(),jC=new WeakMap;function XP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=jC.get(t);return i===void 0&&(i=Function.toString.call(t),jC.set(t,i)),i===ez}function qm(n,e,t=!0){Yp(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Yp(n){const e=n[Ri];return e?e.type_:Array.isArray(n)?1:mf(n)?2:Zp(n)?3:0}function Bv(n,e){return Yp(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function qP(n,e,t){const i=Yp(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function tz(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function mf(n){return n instanceof Map}function Zp(n){return n instanceof Set}function Ba(n){return n.copy_||n.base_}function Wv(n,e){if(mf(n))return new Map(n);if(Zp(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=XP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ri];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Ld(n),i)}else{const i=Ld(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function X1(n,e=!1){return Qp(n)||pu(n)||!vl(n)||(Yp(n)>1&&Object.defineProperties(n,{set:Zg,add:Zg,clear:Zg,delete:Zg}),Object.freeze(n),e&&Object.values(n).forEach(t=>X1(t,!0))),n}function nz(){pr(2)}var Zg={value:nz};function Qp(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var iz={};function xl(n){const e=iz[n];return e||pr(0,n),e}var Od;function YP(){return Od}function rz(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function zC(n,e){e&&(xl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Gv(n){$v(n),n.drafts_.forEach(sz),n.drafts_=null}function $v(n){n===Od&&(Od=n.parent_)}function UC(n){return Od=rz(Od,n)}function sz(n){const e=n[Ri];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function BC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ri].modified_&&(Gv(e),pr(4)),vl(n)&&(n=Ym(e,n),e.parent_||Zm(e,n)),e.patches_&&xl("Patches").generateReplacementPatches_(t[Ri].base_,n,e.patches_,e.inversePatches_)):n=Ym(e,t,[]),Gv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==HP?n:void 0}function Ym(n,e,t){if(Qp(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ri];if(!r)return qm(e,(s,o)=>WC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Zm(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),qm(o,(u,h)=>WC(n,r,s,u,h,t,l),i),Zm(n,s,!1),t&&n.patches_&&xl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function WC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Qp(r);if(!(l&&!o)){if(pu(r)){const u=s&&e&&e.type_!==3&&!Bv(e.assigned_,i)?s.concat(i):void 0,h=Ym(n,r,u);if(qP(t,i,h),pu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(vl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;Ym(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(mf(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Zm(n,r)}}}function Zm(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&X1(e,t)}function oz(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:YP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=q1;t&&(r=[i],s=Fd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var q1={get(n,e){if(e===Ri)return n;const t=Ba(n);if(!Bv(t,e))return az(n,t,e);const i=t[e];return n.finalized_||!vl(i)?i:i===B0(n.base_,e)?(W0(n),n.copy_[e]=Hv(i,n)):i},has(n,e){return e in Ba(n)},ownKeys(n){return Reflect.ownKeys(Ba(n))},set(n,e,t){const i=ZP(Ba(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=B0(Ba(n),e),s=r?.[Ri];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(tz(t,r)&&(t!==void 0||Bv(n.base_,e)))return!0;W0(n),Kv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return B0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,W0(n),Kv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ba(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){pr(11)},getPrototypeOf(n){return Ld(n.base_)},setPrototypeOf(){pr(12)}},Fd={};qm(q1,(n,e)=>{Fd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Fd.deleteProperty=function(n,e){return Fd.set.call(this,n,e,void 0)};Fd.set=function(n,e,t){return q1.set.call(this,n[0],e,t,n[0])};function B0(n,e){const t=n[Ri];return(t?Ba(t):n)[e]}function az(n,e,t){const i=ZP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function ZP(n,e){if(!(e in n))return;let t=Ld(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Ld(t)}}function Kv(n){n.modified_||(n.modified_=!0,n.parent_&&Kv(n.parent_))}function W0(n){n.copy_||(n.copy_=Wv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var lz=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&pr(6),i!==void 0&&typeof i!="function"&&pr(7);let r;if(vl(e)){const s=UC(this),o=Hv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Gv(s):$v(s)}return zC(s,i),BC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===HP&&(r=void 0),this.autoFreeze_&&X1(r,!0),i){const s=[],o=[];xl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else pr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){vl(n)||pr(8),pu(n)&&(n=cz(n));const e=UC(this),t=Hv(n,void 0);return t[Ri].isManual_=!0,$v(e),t}finishDraft(n,e){const t=n&&n[Ri];(!t||!t.isManual_)&&pr(9);const{scope_:i}=t;return zC(i,e),BC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=xl("Patches").applyPatches_;return pu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Hv(n,e){const t=mf(n)?xl("MapSet").proxyMap_(n,e):Zp(n)?xl("MapSet").proxySet_(n,e):oz(n,e);return(e?e.scope_:YP()).drafts_.push(t),t}function cz(n){return pu(n)||pr(10,n),QP(n)}function QP(n){if(!vl(n)||Qp(n))return n;const e=n[Ri];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Wv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Wv(n,!0);return qm(t,(r,s)=>{qP(t,r,QP(s))},i),e&&(e.finalized_=!1),t}var uz=new lz,hz=uz.produce;const dz=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?hz(r):r;return e(l,s,...o)},n(i.setState,t,i)),Jp=dz,ri=Rr()(Jp((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),JP={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Yg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-CSSkNolW.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Yg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-DQg9BW59.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Yg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-MQPU9DT1.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Yg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-IF77fQlh.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function fz(){return Object.values(JP).filter(n=>n.immediateLoad)}const eo=Rr()(Jp((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Zo=Rr()(Jp((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=JP[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=eo.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),si=Rr()(Jp(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),gz={};function mz(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Vd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Vd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Vd(i)(t)}}}},pz=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:S=>S,version:0,merge:(S,b)=>({...b,...S}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...S)},i,r);const f=Vd(s.serialize),m=()=>{const S=s.partialize({...i()});let b;const N=f({state:S,version:s.version}).then(M=>h.setItem(s.name,M)).catch(M=>{b=M});if(b)throw b;return N},y=r.setState;r.setState=(S,b)=>{y(S,b),m()};const x=n((...S)=>{t(...S),m()},i,r);let T;const I=()=>{var S;if(!h)return;o=!1,l.forEach(N=>N(i()));const b=((S=s.onRehydrateStorage)==null?void 0:S.call(s,i()))||void 0;return Vd(h.getItem.bind(h))(s.name).then(N=>{if(N)return s.deserialize(N)}).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==s.version){if(s.migrate)return s.migrate(N.state,N.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return N.state}).then(N=>{var M;return T=s.merge(N,(M=i())!=null?M:x),t(T,!0),m()}).then(()=>{b?.(T,void 0),o=!0,u.forEach(N=>N(T))}).catch(N=>{b?.(void 0,N)})};return r.persist={setOptions:S=>{s={...s,...S},S.getStorage&&(h=S.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:S=>(l.add(S),()=>{l.delete(S)}),onFinishHydration:S=>(u.add(S),()=>{u.delete(S)})},I(),T||x},yz=(n,e)=>(t,i,r)=>{let s={storage:mz(()=>localStorage),partialize:I=>I,version:0,merge:(I,S)=>({...S,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},m=r.setState;r.setState=(I,S)=>{m(I,S),f()};const y=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>y;let x;const T=()=>{var I,S;if(!h)return;o=!1,l.forEach(N=>{var M;return N((M=i())!=null?M:y)});const b=((S=s.onRehydrateStorage)==null?void 0:S.call(s,(I=i())!=null?I:y))||void 0;return Vd(h.getItem.bind(h))(s.name).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==s.version){if(s.migrate)return[!0,s.migrate(N.state,N.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,N.state];return[!1,void 0]}).then(N=>{var M;const[R,D]=N;if(x=s.merge(D,(M=i())!=null?M:y),t(x,!0),R)return f()}).then(()=>{b?.(x,void 0),x=i(),o=!0,u.forEach(N=>N(x))}).catch(N=>{b?.(void 0,N)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||T(),x||y},_z=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((gz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),pz(n,e)):yz(n,e),pf=_z,Qe=Rr()(pf(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e})}),{name:"visapp-settings"})),ek=Rr()(pf((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),jd=Rr((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code",past_hours:"24",forecast_hours:"48",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((h,f)=>({time:h,pressure:o.hourly.surface_pressure[f]})),u=o.hourly.time.map((h,f)=>({time:h,temperature:o.hourly.temperature_2m[f],windSpeed:o.hourly.wind_speed_10m[f],windDirection:o.hourly.wind_direction_10m[f],pressure:o.hourly.surface_pressure[f],weatherCode:o.hourly.weather_code[f]}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),tk=Rr()(pf(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),GC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],$C=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],vz=Rr()(pf((n,e)=>({presets:GC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Zo.getState().setLayerVisibility;$C.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Zo.getState().visible,r=$C.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:GC})}}),{name:"visapp-presets"})),xz=()=>{};var KC={};const nk=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},wz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},ik={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,m=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(y=64)),i.push(t[f],t[m],t[y],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(nk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):wz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const m=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||m==null)throw new Ez;const y=s<<2|l>>4;if(i.push(y),h!==64){const x=l<<4&240|h>>2;if(i.push(x),m!==64){const T=h<<6&192|m;i.push(T)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Ez extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Tz=function(n){const e=nk(n);return ik.encodeByteArray(e,!0)},Qm=function(n){return Tz(n).replace(/\./g,"")},rk=function(n){try{return ik.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function sk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Sz=()=>sk().__FIREBASE_DEFAULTS__,Iz=()=>{if(typeof process>"u"||typeof KC>"u")return;const n=KC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Cz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&rk(n[1]);return e&&JSON.parse(e)},ey=()=>{try{return xz()||Sz()||Iz()||Cz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ok=n=>ey()?.emulatorHosts?.[n],ak=n=>{const e=ok(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},lk=()=>ey()?.config,ck=n=>ey()?.[`_${n}`];class Rz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ll(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Y1(n){return(await fetch(n,{credentials:"include"})).ok}function uk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Qm(JSON.stringify(t)),Qm(JSON.stringify(o)),""].join(".")}const sd={};function Az(){const n={prod:[],emulator:[]};for(const e of Object.keys(sd))sd[e]?n.emulator.push(e):n.prod.push(e);return n}function bz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let HC=!1;function Z1(n,e){if(typeof window>"u"||typeof document>"u"||!Ll(window.location.host)||sd[n]===e||sd[n]||HC)return;sd[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=Az().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,x){y.setAttribute("width","24"),y.setAttribute("id",x),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{HC=!0,o()},y}function f(y,x){y.setAttribute("id",x),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function m(){const y=bz(i),x=t("text"),T=document.getElementById(x)||document.createElement("span"),I=t("learnmore"),S=document.getElementById(I)||document.createElement("a"),b=t("preprendIcon"),N=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const M=y.element;l(M),f(S,I);const R=h();u(N,b),M.append(N,T,S,R),document.body.appendChild(M)}s?(T.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function en(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Pz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function hk(){const n=ey()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Nz(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Dz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Mz(){const n=en();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function dk(){return!hk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fk(){return!hk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function gk(){try{return typeof indexedDB=="object"}catch{return!1}}function Lz(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const Oz="FirebaseError";class hs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Oz,Object.setPrototypeOf(this,hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yf.prototype.create)}}class yf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Fz(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new hs(r,l,i)}}function Fz(n,e){return n.replace(Vz,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const Vz=/\{\$([^}]+)}/g;function jz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(XC(s)&&XC(o)){if(!wl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function XC(n){return n!==null&&typeof n=="object"}function _f(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function zz(n,e){const t=new Uz(n,e);return t.subscribe.bind(t)}class Uz{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Bz(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=G0),r.error===void 0&&(r.error=G0),r.complete===void 0&&(r.complete=G0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Bz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function G0(){}function to(n){return n&&n._delegate?n._delegate:n}class ia{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Wa="[DEFAULT]";class Wz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Rz;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($z(e))try{this.getOrInitializeService({instanceIdentifier:Wa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Wa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wa){return this.instances.has(e)}getOptions(e=Wa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Gz(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Wa){return this.component?this.component.multipleInstances?e:Wa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Gz(n){return n===Wa?void 0:n}function $z(n){return n.instantiationMode==="EAGER"}class Kz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Wz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const Hz={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},Xz=He.INFO,qz={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},Yz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=qz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Q1{constructor(e){this.name=e,this._logLevel=Xz,this._logHandler=Yz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Hz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const Zz=(n,e)=>e.some(t=>n instanceof t);let qC,YC;function Qz(){return qC||(qC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Jz(){return YC||(YC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mk=new WeakMap,Xv=new WeakMap,pk=new WeakMap,$0=new WeakMap,J1=new WeakMap;function eU(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Qo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&mk.set(t,n)}).catch(()=>{}),J1.set(e,n),e}function tU(n){if(Xv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Xv.set(n,e)}let qv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Xv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||pk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nU(n){qv=n(qv)}function iU(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(K0(this),e,...t);return pk.set(i,e.sort?e.sort():[e]),Qo(i)}:Jz().includes(n)?function(...e){return n.apply(K0(this),e),Qo(mk.get(this))}:function(...e){return Qo(n.apply(K0(this),e))}}function rU(n){return typeof n=="function"?iU(n):(n instanceof IDBTransaction&&tU(n),Zz(n,Qz())?new Proxy(n,qv):n)}function Qo(n){if(n instanceof IDBRequest)return eU(n);if($0.has(n))return $0.get(n);const e=rU(n);return e!==n&&($0.set(n,e),J1.set(e,n)),e}const K0=n=>J1.get(n);function sU(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Qo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Qo(o.result),u.oldVersion,u.newVersion,Qo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const oU=["get","getKey","getAll","getAllKeys","count"],aU=["put","add","delete","clear"],H0=new Map;function ZC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(H0.get(e))return H0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=aU.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||oU.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return H0.set(e,s),s}nU(n=>({...n,get:(e,t,i)=>ZC(e,t)||n.get(e,t,i),has:(e,t)=>!!ZC(e,t)||n.has(e,t)}));class lU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(cU(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function cU(n){return n.getComponent()?.type==="VERSION"}const Yv="@firebase/app",QC="0.14.6";const qs=new Q1("@firebase/app"),uU="@firebase/app-compat",hU="@firebase/analytics-compat",dU="@firebase/analytics",fU="@firebase/app-check-compat",gU="@firebase/app-check",mU="@firebase/auth",pU="@firebase/auth-compat",yU="@firebase/database",_U="@firebase/data-connect",vU="@firebase/database-compat",xU="@firebase/functions",wU="@firebase/functions-compat",EU="@firebase/installations",TU="@firebase/installations-compat",SU="@firebase/messaging",IU="@firebase/messaging-compat",CU="@firebase/performance",RU="@firebase/performance-compat",AU="@firebase/remote-config",bU="@firebase/remote-config-compat",PU="@firebase/storage",kU="@firebase/storage-compat",NU="@firebase/firestore",DU="@firebase/ai",MU="@firebase/firestore-compat",LU="firebase",OU="12.6.0";const Zv="[DEFAULT]",FU={[Yv]:"fire-core",[uU]:"fire-core-compat",[dU]:"fire-analytics",[hU]:"fire-analytics-compat",[gU]:"fire-app-check",[fU]:"fire-app-check-compat",[mU]:"fire-auth",[pU]:"fire-auth-compat",[yU]:"fire-rtdb",[_U]:"fire-data-connect",[vU]:"fire-rtdb-compat",[xU]:"fire-fn",[wU]:"fire-fn-compat",[EU]:"fire-iid",[TU]:"fire-iid-compat",[SU]:"fire-fcm",[IU]:"fire-fcm-compat",[CU]:"fire-perf",[RU]:"fire-perf-compat",[AU]:"fire-rc",[bU]:"fire-rc-compat",[PU]:"fire-gcs",[kU]:"fire-gcs-compat",[NU]:"fire-fst",[MU]:"fire-fst-compat",[DU]:"fire-vertex","fire-js":"fire-js",[LU]:"fire-js-all"};const Jm=new Map,VU=new Map,Qv=new Map;function JC(n,e){try{n.container.addComponent(e)}catch(t){qs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function El(n){const e=n.name;if(Qv.has(e))return qs.debug(`There were multiple attempts to register component ${e}.`),!1;Qv.set(e,n);for(const t of Jm.values())JC(t,n);for(const t of VU.values())JC(t,n);return!0}function ty(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Hi(n){return n==null?!1:n.settings!==void 0}const jU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Jo=new yf("app","Firebase",jU);class zU{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ia("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jo.create("app-deleted",{appName:this._name})}}const Ol=OU;function yk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Zv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Jo.create("bad-app-name",{appName:String(r)});if(t||(t=lk()),!t)throw Jo.create("no-options");const s=Jm.get(r);if(s){if(wl(t,s.options)&&wl(i,s.config))return s;throw Jo.create("duplicate-app",{appName:r})}const o=new Kz(r);for(const u of Qv.values())o.addComponent(u);const l=new zU(t,i,o);return Jm.set(r,l),l}function ew(n=Zv){const e=Jm.get(n);if(!e&&n===Zv&&lk())return yk();if(!e)throw Jo.create("no-app",{appName:n});return e}function ss(n,e,t){let i=FU[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qs.warn(o.join(" "));return}El(new ia(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const UU="firebase-heartbeat-database",BU=1,zd="firebase-heartbeat-store";let X0=null;function _k(){return X0||(X0=sU(UU,BU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Jo.create("idb-open",{originalErrorMessage:n.message})})),X0}async function WU(n){try{const t=(await _k()).transaction(zd),i=await t.objectStore(zd).get(vk(n));return await t.done,i}catch(e){if(e instanceof hs)qs.warn(e.message);else{const t=Jo.create("idb-get",{originalErrorMessage:e?.message});qs.warn(t.message)}}}async function eR(n,e){try{const i=(await _k()).transaction(zd,"readwrite");await i.objectStore(zd).put(e,vk(n)),await i.done}catch(t){if(t instanceof hs)qs.warn(t.message);else{const i=Jo.create("idb-set",{originalErrorMessage:t?.message});qs.warn(i.message)}}}function vk(n){return`${n.name}!${n.options.appId}`}const GU=1024,$U=30;class KU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new XU(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=tR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>$U){const r=qU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){qs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=tR(),{heartbeatsToSend:t,unsentEntries:i}=HU(this._heartbeatsCache.heartbeats),r=Qm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return qs.warn(e),""}}}function tR(){return new Date().toISOString().substring(0,10)}function HU(n,e=GU){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),nR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),nR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class XU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gk()?Lz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await WU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return eR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return eR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function nR(n){return Qm(JSON.stringify({version:2,heartbeats:n})).length}function qU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function YU(n){El(new ia("platform-logger",e=>new lU(e),"PRIVATE")),El(new ia("heartbeat",e=>new KU(e),"PRIVATE")),ss(Yv,QC,n),ss(Yv,QC,"esm2020"),ss("fire-js","")}YU("");function xk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZU=xk,wk=new yf("auth","Firebase",xk());const ep=new Q1("@firebase/auth");function QU(n,...e){ep.logLevel<=He.WARN&&ep.warn(`Auth (${Ol}): ${n}`,...e)}function fm(n,...e){ep.logLevel<=He.ERROR&&ep.error(`Auth (${Ol}): ${n}`,...e)}function as(n,...e){throw nw(n,...e)}function Tr(n,...e){return nw(n,...e)}function tw(n,e,t){const i={...ZU(),[e]:t};return new yf("auth","Firebase",i).create(e,{appName:n.name})}function ll(n){return tw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function JU(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&as(n,"argument-error"),tw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function nw(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return wk.create(n,...e)}function Ve(n,e,...t){if(!n)throw nw(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw fm(e),new Error(e)}function Ys(n,e){n||Fs(e)}function Jv(){return typeof self<"u"&&self.location?.href||""}function eB(){return iR()==="http:"||iR()==="https:"}function iR(){return typeof self<"u"&&self.location?.protocol||null}function tB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(eB()||Nz()||"connection"in navigator)?navigator.onLine:!0}function nB(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class vf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ys(t>e,"Short delay should be less than long delay!"),this.isMobile=Pz()||Dz()}get(){return tB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function iw(n,e){Ys(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Ek{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const iB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const rB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sB=new vf(3e4,6e4);function rw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ou(n,e,t,i,r={}){return Tk(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=_f({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return kz()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ll(n.emulatorConfig.host)&&(h.credentials="include"),Ek.fetch()(await Sk(n,n.config.apiHost,t,l),h)})}async function Tk(n,e,t){n._canInitEmulator=!1;const i={...iB,...e};try{const r=new aB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Qg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Qg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Qg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw tw(n,f,h);as(n,f)}}catch(r){if(r instanceof hs)throw r;as(n,"network-request-failed",{message:String(r)})}}async function oB(n,e,t,i,r={}){const s=await Ou(n,e,t,i,r);return"mfaPendingCredential"in s&&as(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Sk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?iw(n.config,r):`${n.config.apiScheme}://${r}`;return rB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class aB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Tr(this.auth,"network-request-failed")),sB.get())})}}function Qg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Tr(n,e,i);return r.customData._tokenResponse=t,r}async function lB(n,e){return Ou(n,"POST","/v1/accounts:delete",e)}async function tp(n,e){return Ou(n,"POST","/v1/accounts:lookup",e)}function od(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cB(n,e=!1){const t=to(n),i=await t.getIdToken(e),r=sw(i);Ve(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:od(q0(r.auth_time)),issuedAtTime:od(q0(r.iat)),expirationTime:od(q0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function q0(n){return Number(n)*1e3}function sw(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return fm("JWT malformed, contained fewer than 3 sections"),null;try{const r=rk(t);return r?JSON.parse(r):(fm("Failed to decode base64 JWT payload"),null)}catch(r){return fm("Caught error parsing JWT payload as JSON",r?.toString()),null}}function rR(n){const e=sw(n);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ud(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hs&&uB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function uB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class hB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ex{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=od(this.lastLoginAt),this.creationTime=od(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function np(n){const e=n.auth,t=await n.getIdToken(),i=await Ud(n,tp(e,{idToken:t}));Ve(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?Ik(r.providerUserInfo):[],o=fB(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new ex(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function dB(n){const e=to(n);await np(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Ik(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function gB(n,e){const t=await Tk(n,{},async()=>{const i=_f({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await Sk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Ll(n.emulatorConfig.host)&&(u.credentials="include"),Ek.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function mB(n,e){return Ou(n,"POST","/v2/accounts:revokeToken",rw(n,e))}class Jc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rR(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const t=rR(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await gB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Jc;return i&&(Ve(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Ve(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Ve(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Jc,this.toJSON())}_performRefresh(){return Fs("not implemented")}}function No(n,e){Ve(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _r{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new hB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ex(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Ud(this,this.stsTokenManager.getToken(this.auth,e));return Ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cB(this,e)}reload(){return dB(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await np(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hi(this.auth.app))return Promise.reject(ll(this.auth));const e=await this.getIdToken();return await Ud(this,lB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:y,isAnonymous:x,providerData:T,stsTokenManager:I}=t;Ve(m&&I,e,"internal-error");const S=Jc.fromJSON(this.name,I);Ve(typeof m=="string",e,"internal-error"),No(i,e.name),No(r,e.name),Ve(typeof y=="boolean",e,"internal-error"),Ve(typeof x=="boolean",e,"internal-error"),No(s,e.name),No(o,e.name),No(l,e.name),No(u,e.name),No(h,e.name),No(f,e.name);const b=new _r({uid:m,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:S,createdAt:h,lastLoginAt:f});return T&&Array.isArray(T)&&(b.providerData=T.map(N=>({...N}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,t,i=!1){const r=new Jc;r.updateFromServerResponse(t);const s=new _r({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await np(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Ve(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?Ik(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Jc;l.updateFromIdToken(i);const u=new _r({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new ex(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const sR=new Map;function Vs(n){Ys(n instanceof Function,"Expected a class definition");let e=sR.get(n);return e?(Ys(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,sR.set(n,e),e)}class Ck{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ck.type="NONE";const oR=Ck;function gm(n,e,t){return`firebase:${n}:${e}:${t}`}class eu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=gm(this.userKey,r.apiKey,s),this.fullPersistenceKey=gm("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await tp(this.auth,{idToken:e}).catch(()=>{});return t?_r._fromGetAccountInfoResponse(this.auth,t,e):null}return _r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new eu(Vs(oR),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Vs(oR);const o=gm(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let m;if(typeof f=="string"){const y=await tp(e,{idToken:f}).catch(()=>{});if(!y)break;m=await _r._fromGetAccountInfoResponse(e,y,f)}else m=_r._fromJSON(e,f);h!==s&&(l=m),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new eu(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new eu(s,e,i))}}function aR(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Pk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Rk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Nk(e))return"Blackberry";if(Dk(e))return"Webos";if(Ak(e))return"Safari";if((e.includes("chrome/")||bk(e))&&!e.includes("edge/"))return"Chrome";if(kk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Rk(n=en()){return/firefox\//i.test(n)}function Ak(n=en()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bk(n=en()){return/crios\//i.test(n)}function Pk(n=en()){return/iemobile/i.test(n)}function kk(n=en()){return/android/i.test(n)}function Nk(n=en()){return/blackberry/i.test(n)}function Dk(n=en()){return/webos/i.test(n)}function ow(n=en()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pB(n=en()){return ow(n)&&!!window.navigator?.standalone}function yB(){return Mz()&&document.documentMode===10}function Mk(n=en()){return ow(n)||kk(n)||Dk(n)||Nk(n)||/windows phone/i.test(n)||Pk(n)}function Lk(n,e=[]){let t;switch(n){case"Browser":t=aR(en());break;case"Worker":t=`${aR(en())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ol}/${i}`}class _B{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function vB(n,e={}){return Ou(n,"GET","/v2/passwordPolicy",rw(n,e))}const xB=6;class wB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??xB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class EB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lR(this),this.idTokenSubscription=new lR(this),this.beforeStateQueue=new _B(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await eu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await tp(this,{idToken:e}),i=await _r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Hi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await np(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hi(this.app))return Promise.reject(ll(this));const t=e?to(e):null;return t&&Ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hi(this.app)?Promise.reject(ll(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hi(this.app)?Promise.reject(ll(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vB(this),t=new wB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await mB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vs(e)||this._popupRedirectResolver;Ve(t,this,"argument-error"),this.redirectPersistenceManager=await eu.create(this,[Vs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Lk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Hi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&QU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ny(n){return to(n)}class lR{constructor(e){this.auth=e,this.observer=null,this.addObserver=zz(t=>this.observer=t)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let aw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TB(n){aw=n}function SB(n){return aw.loadJS(n)}function IB(){return aw.gapiScript}function CB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function RB(n,e){const t=ty(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(wl(s,e??{}))return r;as(r,"already-initialized")}return t.initialize({options:e})}function AB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function bB(n,e,t){const i=ny(n);Ve(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=Ok(e),{host:o,port:l}=PB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Ve(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ve(wl(h,i.config.emulator)&&wl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Ll(o)?(Y1(`${s}//${o}${u}`),Z1("Auth",!0)):kB()}function Ok(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function PB(n){const e=Ok(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:cR(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:cR(o)}}}function cR(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function kB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Fk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function tu(n,e){return oB(n,"POST","/v1/accounts:signInWithIdp",rw(n,e))}const NB="http://localhost";class Tl extends Fk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):as("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Tl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return tu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,tu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,tu(e,t)}buildRequest(){const e={requestUri:NB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_f(t)}return e}}class lw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xf extends lw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uo extends xf{constructor(){super("facebook.com")}static credential(e){return Tl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";class Ls extends xf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tl._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ls.credential(t,i)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class Bo extends xf{constructor(){super("github.com")}static credential(e){return Tl._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bo.credential(e.oauthAccessToken)}catch{return null}}}Bo.GITHUB_SIGN_IN_METHOD="github.com";Bo.PROVIDER_ID="github.com";class Wo extends xf{constructor(){super("twitter.com")}static credential(e,t){return Tl._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Wo.credential(t,i)}catch{return null}}}Wo.TWITTER_SIGN_IN_METHOD="twitter.com";Wo.PROVIDER_ID="twitter.com";class yu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await _r._fromIdTokenResponse(e,i,r),o=uR(i);return new yu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=uR(i);return new yu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function uR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class ip extends hs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,ip.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new ip(e,t,i,r)}}function Vk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ip._fromErrorAndOperation(n,s,e,i):s})}async function DB(n,e,t=!1){const i=await Ud(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return yu._forOperation(n,"link",i)}async function MB(n,e,t=!1){const{auth:i}=n;if(Hi(i.app))return Promise.reject(ll(i));const r="reauthenticate";try{const s=await Ud(n,Vk(i,r,e,n),t);Ve(s.idToken,i,"internal-error");const o=sw(s.idToken);Ve(o,i,"internal-error");const{sub:l}=o;return Ve(n.uid===l,i,"user-mismatch"),yu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&as(i,"user-mismatch"),s}}async function LB(n,e,t=!1){if(Hi(n.app))return Promise.reject(ll(n));const i="signIn",r=await Vk(n,i,e),s=await yu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function OB(n,e,t,i){return to(n).onIdTokenChanged(e,t,i)}function FB(n,e,t){return to(n).beforeAuthStateChanged(e,t)}function VB(n,e,t,i){return to(n).onAuthStateChanged(e,t,i)}function jB(n){return to(n).signOut()}const rp="__sak";class jk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(rp,"1"),this.storage.removeItem(rp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const zB=1e3,UB=10;class zk extends jk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);yB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,UB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},zB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}zk.type="LOCAL";const BB=zk;class Uk extends jk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Uk.type="SESSION";const Bk=Uk;function WB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class iy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new iy(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await WB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}iy.receivers=[];function cw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class GB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=cw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(m){const y=m;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function os(){return window}function $B(n){os().location.href=n}function Wk(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function KB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HB(){return navigator?.serviceWorker?.controller||null}function XB(){return Wk()?self:null}const Gk="firebaseLocalStorageDb",qB=1,sp="firebaseLocalStorage",$k="fbase_key";class wf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ry(n,e){return n.transaction([sp],e?"readwrite":"readonly").objectStore(sp)}function YB(){const n=indexedDB.deleteDatabase(Gk);return new wf(n).toPromise()}function tx(){const n=indexedDB.open(Gk,qB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(sp,{keyPath:$k})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(sp)?e(i):(i.close(),await YB(),e(await tx()))})})}async function hR(n,e,t){const i=ry(n,!0).put({[$k]:e,value:t});return new wf(i).toPromise()}async function ZB(n,e){const t=ry(n,!1).get(e),i=await new wf(t).toPromise();return i===void 0?null:i.value}function dR(n,e){const t=ry(n,!0).delete(e);return new wf(t).toPromise()}const QB=800,JB=3;class Kk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>JB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Wk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=iy._getInstance(XB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await KB(),!this.activeServiceWorker)return;this.sender=new GB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||HB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tx();return await hR(e,rp,"1"),await dR(e,rp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>hR(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>ZB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>dR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ry(r,!1).getAll();return new wf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Kk.type="LOCAL";const e8=Kk;new vf(3e4,6e4);function Hk(n,e){return e?Vs(e):(Ve(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class uw extends Fk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return tu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return tu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function t8(n){return LB(n.auth,new uw(n),n.bypassAuthState)}function n8(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),MB(t,new uw(n),n.bypassAuthState)}async function i8(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),DB(t,new uw(n),n.bypassAuthState)}class Xk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return t8;case"linkViaPopup":case"linkViaRedirect":return i8;case"reauthViaPopup":case"reauthViaRedirect":return n8;default:as(this.auth,"internal-error")}}resolve(e){Ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const r8=new vf(2e3,1e4);async function s8(n,e,t){if(Hi(n.app))return Promise.reject(Tr(n,"operation-not-supported-in-this-environment"));const i=ny(n);JU(n,e,lw);const r=Hk(i,t);return new nl(i,"signInViaPopup",e,r).executeNotNull()}class nl extends Xk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,nl.currentPopupAction&&nl.currentPopupAction.cancel(),nl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){Ys(this.filter.length===1,"Popup operations only handle one event");const e=cw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,r8.get())};e()}}nl.currentPopupAction=null;const o8="pendingRedirect",mm=new Map;class a8 extends Xk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=mm.get(this.auth._key());if(!e){try{const i=await l8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}mm.set(this.auth._key(),e)}return this.bypassAuthState||mm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l8(n,e){const t=h8(e),i=u8(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function c8(n,e){mm.set(n._key(),e)}function u8(n){return Vs(n._redirectPersistence)}function h8(n){return gm(o8,n.config.apiKey,n.name)}async function d8(n,e,t=!1){if(Hi(n.app))return Promise.reject(ll(n));const i=ny(n),r=Hk(i,e),o=await new a8(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const f8=600*1e3;class g8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!m8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!qk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Tr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=f8&&this.cachedEventUids.clear(),this.cachedEventUids.has(fR(e))}saveEventToCache(e){this.cachedEventUids.add(fR(e)),this.lastProcessedEventTime=Date.now()}}function fR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function m8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qk(n);default:return!1}}async function p8(n,e={}){return Ou(n,"GET","/v1/projects",e)}const y8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_8=/^https?/;async function v8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await p8(n);for(const t of e)try{if(x8(t))return}catch{}as(n,"unauthorized-domain")}function x8(n){const e=Jv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!_8.test(t))return!1;if(y8.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const w8=new vf(3e4,6e4);function gR(){const n=os().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function E8(n){return new Promise((e,t)=>{function i(){gR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gR(),t(Tr(n,"network-request-failed"))},timeout:w8.get()})}if(os().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(os().gapi?.load)i();else{const r=CB("iframefcb");return os()[r]=()=>{gapi.load?i():t(Tr(n,"network-request-failed"))},SB(`${IB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw pm=null,e})}let pm=null;function T8(n){return pm=pm||E8(n),pm}const S8=new vf(5e3,15e3),I8="__/auth/iframe",C8="emulator/auth/iframe",R8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},A8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b8(n){const e=n.config;Ve(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?iw(e,C8):`https://${n.config.authDomain}/${I8}`,i={apiKey:e.apiKey,appName:n.name,v:Ol},r=A8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${_f(i).slice(1)}`}async function P8(n){const e=await T8(n),t=os().gapi;return Ve(t,n,"internal-error"),e.open({where:document.body,url:b8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:R8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Tr(n,"network-request-failed"),l=os().setTimeout(()=>{s(o)},S8.get());function u(){os().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const k8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N8=500,D8=600,M8="_blank",L8="http://localhost";class mR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O8(n,e,t,i=N8,r=D8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...k8,width:i.toString(),height:r.toString(),top:s,left:o},h=en().toLowerCase();t&&(l=bk(h)?M8:t),Rk(h)&&(e=e||L8,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[x,T])=>`${y}${x}=${T},`,"");if(pB(h)&&l!=="_self")return F8(e||"",l),new mR(null);const m=window.open(e||"",l,f);Ve(m,n,"popup-blocked");try{m.focus()}catch{}return new mR(m)}function F8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const V8="__/auth/handler",j8="emulator/auth/handler",z8=encodeURIComponent("fac");async function pR(n,e,t,i,r,s){Ve(n.config.authDomain,n,"auth-domain-config-required"),Ve(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ol,eventId:r};if(e instanceof lw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",jz(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof xf){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${z8}=${encodeURIComponent(u)}`:"";return`${U8(n)}?${_f(l).slice(1)}${h}`}function U8({config:n}){return n.emulator?iw(n,j8):`https://${n.authDomain}/${V8}`}const Y0="webStorageSupport";class B8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Bk,this._completeRedirectFn=d8,this._overrideRedirectResult=c8}async _openPopup(e,t,i,r){Ys(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await pR(e,t,i,Jv(),r);return O8(e,s,cw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await pR(e,t,i,Jv(),r);return $B(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Ys(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await P8(e),i=new g8(e);return t.register("authEvent",r=>(Ve(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Y0,{type:Y0},r=>{const s=r?.[0]?.[Y0];s!==void 0&&t(!!s),as(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=v8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mk()||Ak()||ow()}}const W8=B8;var yR="@firebase/auth",_R="1.12.0";class G8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function $8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function K8(n){El(new ia("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Ve(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Lk(n)},h=new EB(i,r,s,u);return AB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),El(new ia("auth-internal",e=>{const t=ny(e.getProvider("auth").getImmediate());return(i=>new G8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ss(yR,_R,$8(n)),ss(yR,_R,"esm2020")}const H8=300,X8=ck("authIdTokenMaxAge")||H8;let vR=null;const q8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>X8)return;const r=t?.token;vR!==r&&(vR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Y8(n=ew()){const e=ty(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RB(n,{popupRedirectResolver:W8,persistence:[e8,BB,Bk]}),i=ck("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=q8(s.toString());FB(t,o,()=>o(t.currentUser)),OB(t,l=>o(l))}}const r=ok("auth");return r&&bB(t,`http://${r}`),t}function Z8(){return document.getElementsByTagName("head")?.[0]??document}TB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Tr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",Z8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});K8("Browser");var Q8="firebase",J8="12.7.0";ss(Q8,J8,"app");var xR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hw;(function(){var n;function e(k,A){function L(){}L.prototype=A.prototype,k.F=A.prototype,k.prototype=new L,k.prototype.constructor=k,k.D=function(V,z,B){for(var O=Array(arguments.length-2),le=2;le<arguments.length;le++)O[le-2]=arguments[le];return A.prototype[z].apply(V,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,A,L){L||(L=0);const V=Array(16);if(typeof A=="string")for(var z=0;z<16;++z)V[z]=A.charCodeAt(L++)|A.charCodeAt(L++)<<8|A.charCodeAt(L++)<<16|A.charCodeAt(L++)<<24;else for(z=0;z<16;++z)V[z]=A[L++]|A[L++]<<8|A[L++]<<16|A[L++]<<24;A=k.g[0],L=k.g[1],z=k.g[2];let B=k.g[3],O;O=A+(B^L&(z^B))+V[0]+3614090360&4294967295,A=L+(O<<7&4294967295|O>>>25),O=B+(z^A&(L^z))+V[1]+3905402710&4294967295,B=A+(O<<12&4294967295|O>>>20),O=z+(L^B&(A^L))+V[2]+606105819&4294967295,z=B+(O<<17&4294967295|O>>>15),O=L+(A^z&(B^A))+V[3]+3250441966&4294967295,L=z+(O<<22&4294967295|O>>>10),O=A+(B^L&(z^B))+V[4]+4118548399&4294967295,A=L+(O<<7&4294967295|O>>>25),O=B+(z^A&(L^z))+V[5]+1200080426&4294967295,B=A+(O<<12&4294967295|O>>>20),O=z+(L^B&(A^L))+V[6]+2821735955&4294967295,z=B+(O<<17&4294967295|O>>>15),O=L+(A^z&(B^A))+V[7]+4249261313&4294967295,L=z+(O<<22&4294967295|O>>>10),O=A+(B^L&(z^B))+V[8]+1770035416&4294967295,A=L+(O<<7&4294967295|O>>>25),O=B+(z^A&(L^z))+V[9]+2336552879&4294967295,B=A+(O<<12&4294967295|O>>>20),O=z+(L^B&(A^L))+V[10]+4294925233&4294967295,z=B+(O<<17&4294967295|O>>>15),O=L+(A^z&(B^A))+V[11]+2304563134&4294967295,L=z+(O<<22&4294967295|O>>>10),O=A+(B^L&(z^B))+V[12]+1804603682&4294967295,A=L+(O<<7&4294967295|O>>>25),O=B+(z^A&(L^z))+V[13]+4254626195&4294967295,B=A+(O<<12&4294967295|O>>>20),O=z+(L^B&(A^L))+V[14]+2792965006&4294967295,z=B+(O<<17&4294967295|O>>>15),O=L+(A^z&(B^A))+V[15]+1236535329&4294967295,L=z+(O<<22&4294967295|O>>>10),O=A+(z^B&(L^z))+V[1]+4129170786&4294967295,A=L+(O<<5&4294967295|O>>>27),O=B+(L^z&(A^L))+V[6]+3225465664&4294967295,B=A+(O<<9&4294967295|O>>>23),O=z+(A^L&(B^A))+V[11]+643717713&4294967295,z=B+(O<<14&4294967295|O>>>18),O=L+(B^A&(z^B))+V[0]+3921069994&4294967295,L=z+(O<<20&4294967295|O>>>12),O=A+(z^B&(L^z))+V[5]+3593408605&4294967295,A=L+(O<<5&4294967295|O>>>27),O=B+(L^z&(A^L))+V[10]+38016083&4294967295,B=A+(O<<9&4294967295|O>>>23),O=z+(A^L&(B^A))+V[15]+3634488961&4294967295,z=B+(O<<14&4294967295|O>>>18),O=L+(B^A&(z^B))+V[4]+3889429448&4294967295,L=z+(O<<20&4294967295|O>>>12),O=A+(z^B&(L^z))+V[9]+568446438&4294967295,A=L+(O<<5&4294967295|O>>>27),O=B+(L^z&(A^L))+V[14]+3275163606&4294967295,B=A+(O<<9&4294967295|O>>>23),O=z+(A^L&(B^A))+V[3]+4107603335&4294967295,z=B+(O<<14&4294967295|O>>>18),O=L+(B^A&(z^B))+V[8]+1163531501&4294967295,L=z+(O<<20&4294967295|O>>>12),O=A+(z^B&(L^z))+V[13]+2850285829&4294967295,A=L+(O<<5&4294967295|O>>>27),O=B+(L^z&(A^L))+V[2]+4243563512&4294967295,B=A+(O<<9&4294967295|O>>>23),O=z+(A^L&(B^A))+V[7]+1735328473&4294967295,z=B+(O<<14&4294967295|O>>>18),O=L+(B^A&(z^B))+V[12]+2368359562&4294967295,L=z+(O<<20&4294967295|O>>>12),O=A+(L^z^B)+V[5]+4294588738&4294967295,A=L+(O<<4&4294967295|O>>>28),O=B+(A^L^z)+V[8]+2272392833&4294967295,B=A+(O<<11&4294967295|O>>>21),O=z+(B^A^L)+V[11]+1839030562&4294967295,z=B+(O<<16&4294967295|O>>>16),O=L+(z^B^A)+V[14]+4259657740&4294967295,L=z+(O<<23&4294967295|O>>>9),O=A+(L^z^B)+V[1]+2763975236&4294967295,A=L+(O<<4&4294967295|O>>>28),O=B+(A^L^z)+V[4]+1272893353&4294967295,B=A+(O<<11&4294967295|O>>>21),O=z+(B^A^L)+V[7]+4139469664&4294967295,z=B+(O<<16&4294967295|O>>>16),O=L+(z^B^A)+V[10]+3200236656&4294967295,L=z+(O<<23&4294967295|O>>>9),O=A+(L^z^B)+V[13]+681279174&4294967295,A=L+(O<<4&4294967295|O>>>28),O=B+(A^L^z)+V[0]+3936430074&4294967295,B=A+(O<<11&4294967295|O>>>21),O=z+(B^A^L)+V[3]+3572445317&4294967295,z=B+(O<<16&4294967295|O>>>16),O=L+(z^B^A)+V[6]+76029189&4294967295,L=z+(O<<23&4294967295|O>>>9),O=A+(L^z^B)+V[9]+3654602809&4294967295,A=L+(O<<4&4294967295|O>>>28),O=B+(A^L^z)+V[12]+3873151461&4294967295,B=A+(O<<11&4294967295|O>>>21),O=z+(B^A^L)+V[15]+530742520&4294967295,z=B+(O<<16&4294967295|O>>>16),O=L+(z^B^A)+V[2]+3299628645&4294967295,L=z+(O<<23&4294967295|O>>>9),O=A+(z^(L|~B))+V[0]+4096336452&4294967295,A=L+(O<<6&4294967295|O>>>26),O=B+(L^(A|~z))+V[7]+1126891415&4294967295,B=A+(O<<10&4294967295|O>>>22),O=z+(A^(B|~L))+V[14]+2878612391&4294967295,z=B+(O<<15&4294967295|O>>>17),O=L+(B^(z|~A))+V[5]+4237533241&4294967295,L=z+(O<<21&4294967295|O>>>11),O=A+(z^(L|~B))+V[12]+1700485571&4294967295,A=L+(O<<6&4294967295|O>>>26),O=B+(L^(A|~z))+V[3]+2399980690&4294967295,B=A+(O<<10&4294967295|O>>>22),O=z+(A^(B|~L))+V[10]+4293915773&4294967295,z=B+(O<<15&4294967295|O>>>17),O=L+(B^(z|~A))+V[1]+2240044497&4294967295,L=z+(O<<21&4294967295|O>>>11),O=A+(z^(L|~B))+V[8]+1873313359&4294967295,A=L+(O<<6&4294967295|O>>>26),O=B+(L^(A|~z))+V[15]+4264355552&4294967295,B=A+(O<<10&4294967295|O>>>22),O=z+(A^(B|~L))+V[6]+2734768916&4294967295,z=B+(O<<15&4294967295|O>>>17),O=L+(B^(z|~A))+V[13]+1309151649&4294967295,L=z+(O<<21&4294967295|O>>>11),O=A+(z^(L|~B))+V[4]+4149444226&4294967295,A=L+(O<<6&4294967295|O>>>26),O=B+(L^(A|~z))+V[11]+3174756917&4294967295,B=A+(O<<10&4294967295|O>>>22),O=z+(A^(B|~L))+V[2]+718787259&4294967295,z=B+(O<<15&4294967295|O>>>17),O=L+(B^(z|~A))+V[9]+3951481745&4294967295,k.g[0]=k.g[0]+A&4294967295,k.g[1]=k.g[1]+(z+(O<<21&4294967295|O>>>11))&4294967295,k.g[2]=k.g[2]+z&4294967295,k.g[3]=k.g[3]+B&4294967295}i.prototype.v=function(k,A){A===void 0&&(A=k.length);const L=A-this.blockSize,V=this.C;let z=this.h,B=0;for(;B<A;){if(z==0)for(;B<=L;)r(this,k,B),B+=this.blockSize;if(typeof k=="string"){for(;B<A;)if(V[z++]=k.charCodeAt(B++),z==this.blockSize){r(this,V),z=0;break}}else for(;B<A;)if(V[z++]=k[B++],z==this.blockSize){r(this,V),z=0;break}}this.h=z,this.o+=A},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var A=1;A<k.length-8;++A)k[A]=0;A=this.o*8;for(var L=k.length-8;L<k.length;++L)k[L]=A&255,A/=256;for(this.v(k),k=Array(16),A=0,L=0;L<4;++L)for(let V=0;V<32;V+=8)k[A++]=this.g[L]>>>V&255;return k};function s(k,A){var L=l;return Object.prototype.hasOwnProperty.call(L,k)?L[k]:L[k]=A(k)}function o(k,A){this.h=A;const L=[];let V=!0;for(let z=k.length-1;z>=0;z--){const B=k[z]|0;V&&B==A||(L[z]=B,V=!1)}this.g=L}var l={};function u(k){return-128<=k&&k<128?s(k,function(A){return new o([A|0],A<0?-1:0)}):new o([k|0],k<0?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return m;if(k<0)return S(h(-k));const A=[];let L=1;for(let V=0;k>=L;V++)A[V]=k/L|0,L*=4294967296;return new o(A,0)}function f(k,A){if(k.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(k.charAt(0)=="-")return S(f(k.substring(1),A));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=h(Math.pow(A,8));let V=m;for(let B=0;B<k.length;B+=8){var z=Math.min(8,k.length-B);const O=parseInt(k.substring(B,B+z),A);z<8?(z=h(Math.pow(A,z)),V=V.j(z).add(h(O))):(V=V.j(L),V=V.add(h(O)))}return V}var m=u(0),y=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-S(this).m();let k=0,A=1;for(let L=0;L<this.g.length;L++){const V=this.i(L);k+=(V>=0?V:4294967296+V)*A,A*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(T(this))return"0";if(I(this))return"-"+S(this).toString(k);const A=h(Math.pow(k,6));var L=this;let V="";for(;;){const z=R(L,A).g;L=b(L,z.j(A));let B=((L.g.length>0?L.g[0]:L.h)>>>0).toString(k);if(L=z,T(L))return B+V;for(;B.length<6;)B="0"+B;V=B+V}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function T(k){if(k.h!=0)return!1;for(let A=0;A<k.g.length;A++)if(k.g[A]!=0)return!1;return!0}function I(k){return k.h==-1}n.l=function(k){return k=b(this,k),I(k)?-1:T(k)?0:1};function S(k){const A=k.g.length,L=[];for(let V=0;V<A;V++)L[V]=~k.g[V];return new o(L,~k.h).add(y)}n.abs=function(){return I(this)?S(this):this},n.add=function(k){const A=Math.max(this.g.length,k.g.length),L=[];let V=0;for(let z=0;z<=A;z++){let B=V+(this.i(z)&65535)+(k.i(z)&65535),O=(B>>>16)+(this.i(z)>>>16)+(k.i(z)>>>16);V=O>>>16,B&=65535,O&=65535,L[z]=O<<16|B}return new o(L,L[L.length-1]&-2147483648?-1:0)};function b(k,A){return k.add(S(A))}n.j=function(k){if(T(this)||T(k))return m;if(I(this))return I(k)?S(this).j(S(k)):S(S(this).j(k));if(I(k))return S(this.j(S(k)));if(this.l(x)<0&&k.l(x)<0)return h(this.m()*k.m());const A=this.g.length+k.g.length,L=[];for(var V=0;V<2*A;V++)L[V]=0;for(V=0;V<this.g.length;V++)for(let z=0;z<k.g.length;z++){const B=this.i(V)>>>16,O=this.i(V)&65535,le=k.i(z)>>>16,me=k.i(z)&65535;L[2*V+2*z]+=O*me,N(L,2*V+2*z),L[2*V+2*z+1]+=B*me,N(L,2*V+2*z+1),L[2*V+2*z+1]+=O*le,N(L,2*V+2*z+1),L[2*V+2*z+2]+=B*le,N(L,2*V+2*z+2)}for(k=0;k<A;k++)L[k]=L[2*k+1]<<16|L[2*k];for(k=A;k<2*A;k++)L[k]=0;return new o(L,0)};function N(k,A){for(;(k[A]&65535)!=k[A];)k[A+1]+=k[A]>>>16,k[A]&=65535,A++}function M(k,A){this.g=k,this.h=A}function R(k,A){if(T(A))throw Error("division by zero");if(T(k))return new M(m,m);if(I(k))return A=R(S(k),A),new M(S(A.g),S(A.h));if(I(A))return A=R(k,S(A)),new M(S(A.g),A.h);if(k.g.length>30){if(I(k)||I(A))throw Error("slowDivide_ only works with positive integers.");for(var L=y,V=A;V.l(k)<=0;)L=D(L),V=D(V);var z=j(L,1),B=j(V,1);for(V=j(V,2),L=j(L,2);!T(V);){var O=B.add(V);O.l(k)<=0&&(z=z.add(L),B=O),V=j(V,1),L=j(L,1)}return A=b(k,z.j(A)),new M(z,A)}for(z=m;k.l(A)>=0;){for(L=Math.max(1,Math.floor(k.m()/A.m())),V=Math.ceil(Math.log(L)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),B=h(L),O=B.j(A);I(O)||O.l(k)>0;)L-=V,B=h(L),O=B.j(A);T(B)&&(B=y),z=z.add(B),k=b(k,O)}return new M(z,k)}n.B=function(k){return R(this,k).h},n.and=function(k){const A=Math.max(this.g.length,k.g.length),L=[];for(let V=0;V<A;V++)L[V]=this.i(V)&k.i(V);return new o(L,this.h&k.h)},n.or=function(k){const A=Math.max(this.g.length,k.g.length),L=[];for(let V=0;V<A;V++)L[V]=this.i(V)|k.i(V);return new o(L,this.h|k.h)},n.xor=function(k){const A=Math.max(this.g.length,k.g.length),L=[];for(let V=0;V<A;V++)L[V]=this.i(V)^k.i(V);return new o(L,this.h^k.h)};function D(k){const A=k.g.length+1,L=[];for(let V=0;V<A;V++)L[V]=k.i(V)<<1|k.i(V-1)>>>31;return new o(L,k.h)}function j(k,A){const L=A>>5;A%=32;const V=k.g.length-L,z=[];for(let B=0;B<V;B++)z[B]=A>0?k.i(B+L)>>>A|k.i(B+L+1)<<32-A:k.i(B+L);return new o(z,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,hw=o}).apply(typeof xR<"u"?xR:typeof self<"u"?self:typeof window<"u"?window:{});var Jg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Yk,Yh,Zk,ym,nx,Qk,Jk,eN;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jg=="object"&&Jg];for(var E=0;E<g.length;++E){var C=g[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(g,E){if(E)e:{var C=i;g=g.split(".");for(var F=0;F<g.length-1;F++){var q=g[F];if(!(q in C))break e;C=C[q]}g=g[g.length-1],F=C[g],E=E(F),E!=F&&E!=null&&e(C,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var C=[],F;for(F in E)Object.prototype.hasOwnProperty.call(E,F)&&C.push([F,E[F]]);return C}});var s=s||{},o=this||self;function l(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function u(g,E,C){return g.call.apply(g.bind,arguments)}function h(g,E,C){return h=u,h.apply(null,arguments)}function f(g,E){var C=Array.prototype.slice.call(arguments,1);return function(){var F=C.slice();return F.push.apply(F,arguments),g.apply(this,F)}}function m(g,E){function C(){}C.prototype=E.prototype,g.Z=E.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(F,q,ee){for(var de=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)de[ze-2]=arguments[ze];return E.prototype[q].apply(F,de)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const E=g.length;if(E>0){const C=Array(E);for(let F=0;F<E;F++)C[F]=g[F];return C}return[]}function T(g,E){for(let F=1;F<arguments.length;F++){const q=arguments[F];var C=typeof q;if(C=C!="object"?C:q?Array.isArray(q)?"array":C:"null",C=="array"||C=="object"&&typeof q.length=="number"){C=g.length||0;const ee=q.length||0;g.length=C+ee;for(let de=0;de<ee;de++)g[C+de]=q[de]}else g.push(q)}}class I{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function S(g){o.setTimeout(()=>{throw g},0)}function b(){var g=k;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class N{constructor(){this.h=this.g=null}add(E,C){const F=M.get();F.set(E,C),this.h?this.h.next=F:this.g=F,this.h=F}}var M=new I(()=>new R,g=>g.reset());class R{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let D,j=!1,k=new N,A=()=>{const g=Promise.resolve(void 0);D=()=>{g.then(L)}};function L(){for(var g;g=b();){try{g.h.call(g.g)}catch(C){S(C)}var E=M;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}j=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};o.addEventListener("test",C,E),o.removeEventListener("test",C,E)}catch{}return g})();function O(g){return/^[\s\xa0]*$/.test(g)}function le(g,E){z.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}m(le,z),le.prototype.init=function(g,E){const C=this.type=g.type,F=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(C=="mouseover"?E=g.fromElement:C=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&le.Z.h.call(this)},le.prototype.h=function(){le.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ue(g,E,C,F,q){this.listener=g,this.proxy=null,this.src=E,this.type=C,this.capture=!!F,this.ha=q,this.key=++ge,this.da=this.fa=!1}function Q(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function se(g,E,C){for(const F in g)E.call(C,g[F],F,g)}function ne(g,E){for(const C in g)E.call(void 0,g[C],C,g)}function G(g){const E={};for(const C in g)E[C]=g[C];return E}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(g,E){let C,F;for(let q=1;q<arguments.length;q++){F=arguments[q];for(C in F)g[C]=F[C];for(let ee=0;ee<$.length;ee++)C=$[ee],Object.prototype.hasOwnProperty.call(F,C)&&(g[C]=F[C])}}function pe(g){this.src=g,this.g={},this.h=0}pe.prototype.add=function(g,E,C,F,q){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const de=ke(g,E,F,q);return de>-1?(E=g[de],C||(E.fa=!1)):(E=new ue(E,this.src,ee,!!F,q),E.fa=C,g.push(E)),E};function xe(g,E){const C=E.type;if(C in g.g){var F=g.g[C],q=Array.prototype.indexOf.call(F,E,void 0),ee;(ee=q>=0)&&Array.prototype.splice.call(F,q,1),ee&&(Q(E),g.g[C].length==0&&(delete g.g[C],g.h--))}}function ke(g,E,C,F){for(let q=0;q<g.length;++q){const ee=g[q];if(!ee.da&&ee.listener==E&&ee.capture==!!C&&ee.ha==F)return q}return-1}var Le="closure_lm_"+(Math.random()*1e6|0),je={};function Ge(g,E,C,F,q){if(Array.isArray(E)){for(let ee=0;ee<E.length;ee++)Ge(g,E[ee],C,F,q);return null}return C=Pi(C),g&&g[me]?g.J(E,C,l(F)?!!F.capture:!1,q):ct(g,E,C,!1,F,q)}function ct(g,E,C,F,q,ee){if(!E)throw Error("Invalid event type");const de=l(q)?!!q.capture:!!q;let ze=dn(g);if(ze||(g[Le]=ze=new pe(g)),C=ze.add(E,C,F,de,ee),C.proxy)return C;if(F=er(),C.proxy=F,F.src=g,F.listener=C,g.addEventListener)B||(q=de),q===void 0&&(q=!1),g.addEventListener(E.toString(),F,q);else if(g.attachEvent)g.attachEvent(Kn(E.toString()),F);else if(g.addListener&&g.removeListener)g.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return C}function er(){function g(C){return E.call(g.src,g.listener,C)}const E=hn;return g}function fs(g,E,C,F,q){if(Array.isArray(E))for(var ee=0;ee<E.length;ee++)fs(g,E[ee],C,F,q);else F=l(F)?!!F.capture:!!F,C=Pi(C),g&&g[me]?(g=g.i,ee=String(E).toString(),ee in g.g&&(E=g.g[ee],C=ke(E,C,F,q),C>-1&&(Q(E[C]),Array.prototype.splice.call(E,C,1),E.length==0&&(delete g.g[ee],g.h--)))):g&&(g=dn(g))&&(E=g.g[E.toString()],g=-1,E&&(g=ke(E,C,F,q)),(C=g>-1?E[g]:null)&&$n(C))}function $n(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[me])xe(E.i,g);else{var C=g.type,F=g.proxy;E.removeEventListener?E.removeEventListener(C,F,g.capture):E.detachEvent?E.detachEvent(Kn(C),F):E.addListener&&E.removeListener&&E.removeListener(F),(C=dn(E))?(xe(C,g),C.h==0&&(C.src=null,E[Le]=null)):Q(g)}}}function Kn(g){return g in je?je[g]:je[g]="on"+g}function hn(g,E){if(g.da)g=!0;else{E=new le(E,this);const C=g.listener,F=g.ha||g.src;g.fa&&$n(g),g=C.call(F,E)}return g}function dn(g){return g=g[Le],g instanceof pe?g:null}var Hn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Pi(g){return typeof g=="function"?g:(g[Hn]||(g[Hn]=function(E){return g.handleEvent(E)}),g[Hn])}function _t(){V.call(this),this.i=new pe(this),this.M=this,this.G=null}m(_t,V),_t.prototype[me]=!0,_t.prototype.removeEventListener=function(g,E,C,F){fs(this,g,E,C,F)};function ut(g,E){var C,F=g.G;if(F)for(C=[];F;F=F.G)C.push(F);if(g=g.M,F=E.type||E,typeof E=="string")E=new z(E,g);else if(E instanceof z)E.target=E.target||g;else{var q=E;E=new z(F,g),ie(E,q)}q=!0;let ee,de;if(C)for(de=C.length-1;de>=0;de--)ee=E.g=C[de],q=nn(ee,F,!0,E)&&q;if(ee=E.g=g,q=nn(ee,F,!0,E)&&q,q=nn(ee,F,!1,E)&&q,C)for(de=0;de<C.length;de++)ee=E.g=C[de],q=nn(ee,F,!1,E)&&q}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const C=g.g[E];for(let F=0;F<C.length;F++)Q(C[F]);delete g.g[E],g.h--}}this.G=null},_t.prototype.J=function(g,E,C,F){return this.i.add(String(g),E,!1,C,F)},_t.prototype.K=function(g,E,C,F){return this.i.add(String(g),E,!0,C,F)};function nn(g,E,C,F){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let q=!0;for(let ee=0;ee<E.length;++ee){const de=E[ee];if(de&&!de.da&&de.capture==C){const ze=de.listener,jt=de.ha||de.src;de.fa&&xe(g.i,de),q=ze.call(jt,F)!==!1&&q}}return q&&!F.defaultPrevented}function ki(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function It(g){g.g=ki(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class no extends V{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ni(g){V.call(this),this.h=g,this.g={}}m(Ni,V);var Ar=[];function tr(g){se(g.g,function(E,C){this.g.hasOwnProperty(C)&&$n(E)},g),g.g={}}Ni.prototype.N=function(){Ni.Z.N.call(this),tr(this)},Ni.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var br=o.JSON.stringify,ua=o.JSON.parse,Pr=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Di(){}function Vl(){}var kr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gs(){z.call(this,"d")}m(gs,z);function io(){z.call(this,"c")}m(io,z);var On={},ms=null;function Nr(){return ms=ms||new _t}On.Ia="serverreachability";function Dr(g){z.call(this,On.Ia,g)}m(Dr,z);function Fn(g){const E=Nr();ut(E,new Dr(E))}On.STAT_EVENT="statevent";function Vn(g,E){z.call(this,On.STAT_EVENT,g),this.stat=E}m(Vn,z);function gt(g){const E=Nr();ut(E,new Vn(E,g))}On.Ja="timingevent";function ro(g,E){z.call(this,On.Ja,g),this.size=E}m(ro,z);function nr(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function Ft(){this.g=!0}Ft.prototype.ua=function(){this.g=!1};function Mi(g,E,C,F,q,ee){g.info(function(){if(g.g)if(ee){var de="",ze=ee.split("&");for(let ht=0;ht<ze.length;ht++){var jt=ze[ht].split("=");if(jt.length>1){const Gt=jt[0];jt=jt[1];const yi=Gt.split("_");de=yi.length>=2&&yi[1]=="type"?de+(Gt+"="+jt+"&"):de+(Gt+"=redacted&")}}}else de=null;else de=ee;return"XMLHTTP REQ ("+F+") [attempt "+q+"]: "+E+`
`+C+`
`+de})}function fn(g,E,C,F,q,ee,de){g.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+q+"]: "+E+`
`+C+`
`+ee+" "+de})}function Vt(g,E,C,F){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+mn(g,C)+(F?" "+F:"")})}function gn(g,E){g.info(function(){return"TIMEOUT: "+E})}Ft.prototype.info=function(){};function mn(g,E){if(!g.g)return E;if(!E)return null;try{const ee=JSON.parse(E);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var C=ee[g];if(!(C.length<2)){var F=C[1];if(Array.isArray(F)&&!(F.length<1)){var q=F[0];if(q!="noop"&&q!="stop"&&q!="close")for(let de=1;de<F.length;de++)F[de]=""}}}}return br(ee)}catch{return E}}var rn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},st={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Wt;function qt(){}m(qt,Di),qt.prototype.g=function(){return new XMLHttpRequest},Wt=new qt;function Li(g){return encodeURIComponent(String(g))}function jl(g){var E=1;g=g.split(":");const C=[];for(;E>0&&g.length;)C.push(g.shift()),E--;return g.length&&C.push(g.join(":")),C}function Oi(g,E,C,F){this.j=g,this.i=E,this.l=C,this.S=F||1,this.V=new Ni(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cf}function Cf(){this.i=null,this.g="",this.h=!1}var Rf={},ju={};function ir(g,E,C){g.M=1,g.A=ys(Fi(E)),g.u=C,g.R=!0,zu(g,null)}function zu(g,E){g.F=Date.now(),ha(g),g.B=Fi(g.A);var C=g.B,F=g.S;Array.isArray(F)||(F=[String(F)]),Yu(C.i,"t",F),g.C=0,C=g.j.L,g.h=new Cf,g.g=Ff(g.j,C?E:null,!g.u),g.P>0&&(g.O=new no(h(g.Y,g,g.g),g.P)),E=g.V,C=g.g,F=g.ba;var q="readystatechange";Array.isArray(q)||(q&&(Ar[0]=q.toString()),q=Ar);for(let ee=0;ee<q.length;ee++){const de=Ge(C,q[ee],F||E.handleEvent,!1,E.h||E);if(!de)break;E.g[de.key]=de}E=g.J?G(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Fn(),Mi(g.i,g.v,g.B,g.l,g.S,g.u)}Oi.prototype.ba=function(g){g=g.target;const E=this.O;E&&zr(g)==3?E.j():this.Y(g)},Oi.prototype.Y=function(g){try{if(g==this.g)e:{const ze=zr(this.g),jt=this.g.ya(),ht=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||Lf(this.g)))){this.K||ze!=4||jt==7||(jt==8||ht<=0?Fn(3):Fn(2)),zl(this);var E=this.g.ca();this.X=E;var C=Af(this);if(this.o=E==200,fn(this.i,this.v,this.B,this.l,this.S,ze,E),this.o){if(this.U&&!this.L){t:{if(this.g){var F,q=this.g;if((F=q.g?q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(F)){var ee=F;break t}}ee=null}if(g=ee)Vt(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,wt(this,g);else{this.o=!1,this.m=3,gt(12),ps(this),da(this);break e}}if(this.R){g=!0;let Gt;for(;!this.K&&this.C<C.length;)if(Gt=Pf(this,C),Gt==ju){ze==4&&(this.m=4,gt(14),g=!1),Vt(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==Rf){this.m=4,gt(15),Vt(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else Vt(this.i,this.l,Gt,null),wt(this,Gt);if(bf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||C.length!=0||this.h.h||(this.m=1,gt(16),g=!1),this.o=this.o&&g,!g)Vt(this.i,this.l,C,"[Invalid Chunked Response]"),ps(this),da(this);else if(C.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),wa(de),de.P=!0,gt(11))}}else Vt(this.i,this.l,C,null),wt(this,C);ze==4&&ps(this),this.o&&!this.K&&(ze==4?Yl(this.j,this):(this.o=!1,ha(this)))}else Qu(this.g),E==400&&C.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),ps(this),da(this)}}}catch{}};function Af(g){if(!bf(g))return g.g.la();const E=Lf(g.g);if(E==="")return"";let C="";const F=E.length,q=zr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ps(g),da(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<F;ee++)g.h.h=!0,C+=g.h.i.decode(E[ee],{stream:!(q&&ee==F-1)});return E.length=0,g.h.g+=C,g.C=0,g.h.g}function bf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Pf(g,E){var C=g.C,F=E.indexOf(`
`,C);return F==-1?ju:(C=Number(E.substring(C,F)),isNaN(C)?Rf:(F+=1,F+C>E.length?ju:(E=E.slice(F,F+C),g.C=F+C,E)))}Oi.prototype.cancel=function(){this.K=!0,ps(this)};function ha(g){g.T=Date.now()+g.H,Uu(g,g.H)}function Uu(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=nr(h(g.aa,g),E)}function zl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Oi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Fn(),gt(17)),ps(this),this.m=2,da(this)):Uu(this,this.T-g)};function da(g){g.j.I==0||g.K||Yl(g.j,g)}function ps(g){zl(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,tr(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function wt(g,E){try{var C=g.j;if(C.I!=0&&(C.g==g||Wu(C.h,g))){if(!g.L&&Wu(C.h,g)&&C.I==3){try{var F=C.Ba.g.parse(E)}catch{F=null}if(Array.isArray(F)&&F.length==3){var q=F;if(q[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)ql(C),mi(C);else break e;Wr(C),gt(18)}}else C.xa=q[1],0<C.xa-C.K&&q[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=nr(h(C.Va,C),6e3));fa(C.h)<=1&&C.ta&&(C.ta=void 0)}else pi(C,11)}else if((g.L||C.g==g)&&ql(C),!O(E))for(q=C.Ba.g.parse(E),E=0;E<q.length;E++){let ht=q[E];const Gt=ht[0];if(!(Gt<=C.K))if(C.K=Gt,ht=ht[1],C.I==2)if(ht[0]=="c"){C.M=ht[1],C.ba=ht[2];const yi=ht[3];yi!=null&&(C.ka=yi,C.j.info("VER="+C.ka));const Es=ht[4];Es!=null&&(C.za=Es,C.j.info("SVER="+C.za));const Gr=ht[5];Gr!=null&&typeof Gr=="number"&&Gr>0&&(F=1.5*Gr,C.O=F,C.j.info("backChannelRequestTimeoutMs_="+F)),F=C;const $r=g.g;if($r){const Jl=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jl){var ee=F.h;ee.g||Jl.indexOf("spdy")==-1&&Jl.indexOf("quic")==-1&&Jl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Bl(ee,ee.h),ee.h=null))}if(F.G){const th=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;th&&(F.wa=th,ot(F.J,F.G,th))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),F=C;var de=g;if(F.na=eh(F,F.L?F.ba:null,F.W),de.L){ga(F.h,de);var ze=de,jt=F.O;jt&&(ze.H=jt),ze.D&&(zl(ze),ha(ze)),F.g=de}else Rn(F);C.i.length>0&&ws(C)}else ht[0]!="stop"&&ht[0]!="close"||pi(C,7);else C.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?pi(C,7):Hl(C):ht[0]!="noop"&&C.l&&C.l.qa(ht),C.A=0)}}Fn(4)}catch{}}var Iy=class{constructor(g,E){this.g=g,this.map=E}};function Ul(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Bu(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function fa(g){return g.h?1:g.g?g.g.size:0}function Wu(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function Bl(g,E){g.g?g.g.add(E):g.h=E}function ga(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}Ul.prototype.cancel=function(){if(this.i=di(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function di(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const C of g.g.values())E=E.concat(C.G);return E}return x(g.i)}var kf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fi(g,E){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const F=g[C].indexOf("=");let q,ee=null;F>=0?(q=g[C].substring(0,F),ee=g[C].substring(F+1)):q=g[C],E(q,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Mr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Mr?(this.l=g.l,ma(this,g.j),this.o=g.o,this.g=g.g,Lr(this,g.u),this.h=g.h,so(this,Zu(g.i)),this.m=g.m):g&&(E=String(g).match(kf))?(this.l=!1,ma(this,E[1]||"",!0),this.o=pa(E[2]||""),this.g=pa(E[3]||"",!0),Lr(this,E[4]),this.h=pa(E[5]||"",!0),so(this,E[6]||"",!0),this.m=pa(E[7]||"")):(this.l=!1,this.i=new Xe(null,this.l))}Mr.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(ya(E,$u,!0),":");var C=this.g;return(C||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ya(E,$u,!0),"@"),g.push(Li(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ya(C,C.charAt(0)=="/"?_a:Ku,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ya(C,Hu)),g.join("")},Mr.prototype.resolve=function(g){const E=Fi(this);let C=!!g.j;C?ma(E,g.j):C=!!g.o,C?E.o=g.o:C=!!g.g,C?E.g=g.g:C=g.u!=null;var F=g.h;if(C)Lr(E,g.u);else if(C=!!g.h){if(F.charAt(0)!="/")if(this.g&&!this.h)F="/"+F;else{var q=E.h.lastIndexOf("/");q!=-1&&(F=E.h.slice(0,q+1)+F)}if(q=F,q==".."||q==".")F="";else if(q.indexOf("./")!=-1||q.indexOf("/.")!=-1){F=q.lastIndexOf("/",0)==0,q=q.split("/");const ee=[];for(let de=0;de<q.length;){const ze=q[de++];ze=="."?F&&de==q.length&&ee.push(""):ze==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),F&&de==q.length&&ee.push("")):(ee.push(ze),F=!0)}F=ee.join("/")}else F=q}return C?E.h=F:C=g.i.toString()!=="",C?so(E,Zu(g.i)):C=!!g.m,C&&(E.m=g.m),E};function Fi(g){return new Mr(g)}function ma(g,E,C){g.j=C?pa(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Lr(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function so(g,E,C){E instanceof Xe?(g.i=E,Gl(g.i,g.l)):(C||(E=ya(E,Cy)),g.i=new Xe(E,g.l))}function ot(g,E,C){g.i.set(E,C)}function ys(g){return ot(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ya(g,E,C){return typeof g=="string"?(g=encodeURI(g).replace(E,Gu),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Gu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var $u=/[#\/\?@]/g,Ku=/[#\?:]/g,_a=/[#\?]/g,Cy=/[#\?@]/g,Hu=/#/g;function Xe(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Or(g){g.g||(g.g=new Map,g.h=0,g.i&&fi(g.i,function(E,C){g.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}n=Xe.prototype,n.add=function(g,E){Or(this),this.i=null,g=Fr(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(E),this.h+=1,this};function Xu(g,E){Or(g),E=Fr(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Wl(g,E){return Or(g),E=Fr(g,E),g.g.has(E)}n.forEach=function(g,E){Or(this),this.g.forEach(function(C,F){C.forEach(function(q){g.call(E,q,F,this)},this)},this)};function qu(g,E){Or(g);let C=[];if(typeof E=="string")Wl(g,E)&&(C=C.concat(g.g.get(Fr(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)C=C.concat(g[E]);return C}n.set=function(g,E){return Or(this),this.i=null,g=Fr(this,g),Wl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=qu(this,g),g.length>0?String(g[0]):E):E};function Yu(g,E,C){Xu(g,E),C.length>0&&(g.i=null,g.g.set(Fr(g,E),x(C)),g.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let F=0;F<E.length;F++){var C=E[F];const q=Li(C);C=qu(this,C);for(let ee=0;ee<C.length;ee++){let de=q;C[ee]!==""&&(de+="="+Li(C[ee])),g.push(de)}}return this.i=g.join("&")};function Zu(g){const E=new Xe;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Fr(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Gl(g,E){E&&!g.j&&(Or(g),g.i=null,g.g.forEach(function(C,F){const q=F.toLowerCase();F!=q&&(Xu(this,F),Yu(this,q,C))},g)),g.j=E}function Vr(g,E){const C=new Ft;if(o.Image){const F=new Image;F.onload=f(pn,C,"TestLoadImage: loaded",!0,E,F),F.onerror=f(pn,C,"TestLoadImage: error",!1,E,F),F.onabort=f(pn,C,"TestLoadImage: abort",!1,E,F),F.ontimeout=f(pn,C,"TestLoadImage: timeout",!1,E,F),o.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=g}else E(!1)}function jr(g,E){const C=new Ft,F=new AbortController,q=setTimeout(()=>{F.abort(),pn(C,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:F.signal}).then(ee=>{clearTimeout(q),ee.ok?pn(C,"TestPingServer: ok",!0,E):pn(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(q),pn(C,"TestPingServer: error",!1,E)})}function pn(g,E,C,F,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),F(C)}catch{}}function va(){this.g=new Pr}function _s(g){this.i=g.Sb||null,this.h=g.ab||!1}m(_s,Di),_s.prototype.g=function(){return new gi(this.i,this.h)};function gi(g,E){_t.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(gi,_t),n=gi.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,rr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,oo(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,rr(this)),this.g&&(this.readyState=3,rr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Nf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Nf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?oo(this):rr(this),this.readyState==3&&Nf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,oo(this))},n.Na=function(g){this.g&&(this.response=g,oo(this))},n.ga=function(){this.g&&oo(this)};function oo(g){g.readyState=4,g.l=null,g.j=null,g.B=null,rr(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=E.next();return g.join(`\r
`)};function rr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(gi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Df(g){let E="";return se(g,function(C,F){E+=F,E+=":",E+=C,E+=`\r
`}),E}function $l(g,E,C){e:{for(F in C){var F=!1;break e}F=!0}F||(C=Df(C),typeof g=="string"?C!=null&&Li(C):ot(g,E,C))}function pt(g){_t.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(pt,_t);var Mf=/^https?$/i,Ry=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,C,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Wt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(ee){ao(this,ee);return}if(g=C||"",C=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var q in F)C.set(q,F[q]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const ee of F.keys())C.set(ee,F.get(ee));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(C.keys()).find(ee=>ee.toLowerCase()=="content-type"),q=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Ry,E,void 0)>=0)||F||q||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,de]of C)this.g.setRequestHeader(ee,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){ao(this,ee)}};function ao(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,lo(g),xs(g)}function lo(g){g.A||(g.A=!0,ut(g,"complete"),ut(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ut(this,"complete"),ut(this,"abort"),xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vs(this):this.Xa())},n.Xa=function(){vs(this)};function vs(g){if(g.h&&typeof s<"u"){if(g.v&&zr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ut(g,"readystatechange"),zr(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var C;if(!(C=E)){var F;if(F=ee===0){let de=String(g.D).match(kf)[1]||null;!de&&o.self&&o.self.location&&(de=o.self.location.protocol.slice(0,-1)),F=!Mf.test(de?de.toLowerCase():"")}C=F}if(C)ut(g,"complete"),ut(g,"success");else{g.o=6;try{var q=zr(g)>2?g.g.statusText:""}catch{q=""}g.l=q+" ["+g.ca()+"]",lo(g)}}finally{xs(g)}}}}function xs(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,E||ut(g,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function zr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return zr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ua(E)}};function Lf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Qu(g){const E={};g=(g.g&&zr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<g.length;F++){if(O(g[F]))continue;var C=jl(g[F]);const q=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ee=E[q]||[];E[q]=ee,ee.push(C)}ne(E,function(F){return F.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ur(g,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||E}function Kl(g){this.za=0,this.i=[],this.j=new Ft,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ur("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ur("baseRetryDelayMs",5e3,g),this.Za=Ur("retryDelaySeedMs",1e4,g),this.Ta=Ur("forwardChannelMaxRetries",2,g),this.va=Ur("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Ul(g&&g.concurrentRequestLimit),this.Ba=new va,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Kl.prototype,n.ka=8,n.I=1,n.connect=function(g,E,C,F){gt(0),this.W=g,this.H=E||{},C&&F!==void 0&&(this.H.OSID=C,this.H.OAID=F),this.F=this.X,this.J=eh(this,null,this.W),ws(this)};function Hl(g){if(Xl(g),g.I==3){var E=g.V++,C=Fi(g.J);if(ot(C,"SID",g.M),ot(C,"RID",E),ot(C,"TYPE","terminate"),Br(g,C),E=new Oi(g,g.j,E),E.M=2,E.A=ys(Fi(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=E.A,C=!0),C||(E.g=Ff(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ha(E)}Ea(g)}function mi(g){g.g&&(wa(g),g.g.cancel(),g.g=null)}function Xl(g){mi(g),g.v&&(o.clearTimeout(g.v),g.v=null),ql(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function ws(g){if(!Bu(g.h)&&!g.m){g.m=!0;var E=g.Ea;D||A(),j||(D(),j=!0),k.add(E,g),g.D=0}}function Of(g,E){return fa(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=nr(h(g.Ea,g,E),Zl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const q=new Oi(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=G(ee),ie(ee,this.U)):ee=this.U),this.u!==null||this.R||(q.J=ee,ee=null),this.S)e:{for(var E=0,C=0;C<this.i.length;C++){t:{var F=this.i[C];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(E+=F,E>4096){E=C;break e}if(E===4096||C===this.i.length-1){E=C+1;break e}}E=1e3}else E=1e3;E=Ju(this,q,E),C=Fi(this.J),ot(C,"RID",g),ot(C,"CVER",22),this.G&&ot(C,"X-HTTP-Session-Id",this.G),Br(this,C),ee&&(this.R?E="headers="+Li(Df(ee))+"&"+E:this.u&&$l(C,this.u,ee)),Bl(this.h,q),this.Ra&&ot(C,"TYPE","init"),this.S?(ot(C,"$req",E),ot(C,"SID","null"),q.U=!0,ir(q,C,null)):ir(q,C,E),this.I=2}}else this.I==3&&(g?xa(this,g):this.i.length==0||Bu(this.h)||xa(this))};function xa(g,E){var C;E?C=E.l:C=g.V++;const F=Fi(g.J);ot(F,"SID",g.M),ot(F,"RID",C),ot(F,"AID",g.K),Br(g,F),g.u&&g.o&&$l(F,g.u,g.o),C=new Oi(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),E&&(g.i=E.G.concat(g.i)),E=Ju(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Bl(g.h,C),ir(C,F,E)}function Br(g,E){g.H&&se(g.H,function(C,F){ot(E,F,C)}),g.l&&se({},function(C,F){ot(E,F,C)})}function Ju(g,E,C){C=Math.min(g.i.length,C);const F=g.l?h(g.l.Ka,g.l,g):null;e:{var q=g.i;let ze=-1;for(;;){const jt=["count="+C];ze==-1?C>0?(ze=q[0].g,jt.push("ofs="+ze)):ze=0:jt.push("ofs="+ze);let ht=!0;for(let Gt=0;Gt<C;Gt++){var ee=q[Gt].g;const yi=q[Gt].map;if(ee-=ze,ee<0)ze=Math.max(0,q[Gt].g-100),ht=!1;else try{ee="req"+ee+"_"||"";try{var de=yi instanceof Map?yi:Object.entries(yi);for(const[Es,Gr]of de){let $r=Gr;l(Gr)&&($r=br(Gr)),jt.push(ee+Es+"="+encodeURIComponent($r))}}catch(Es){throw jt.push(ee+"type="+encodeURIComponent("_badmap")),Es}}catch{F&&F(yi)}}if(ht){de=jt.join("&");break e}}de=void 0}return g=g.i.splice(0,C),E.G=g,de}function Rn(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;D||A(),j||(D(),j=!0),k.add(E,g),g.A=0}}function Wr(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=nr(h(g.Da,g),Zl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,co(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=nr(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),mi(this),co(this))};function wa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function co(g){g.g=new Oi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Fi(g.na);ot(E,"RID","rpc"),ot(E,"SID",g.M),ot(E,"AID",g.K),ot(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&ot(E,"TO",g.ia),ot(E,"TYPE","xmlhttp"),Br(g,E),g.u&&g.o&&$l(E,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=ys(Fi(E)),C.u=null,C.R=!0,zu(C,g)}n.Va=function(){this.C!=null&&(this.C=null,mi(this),Wr(this),gt(19))};function ql(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Yl(g,E){var C=null;if(g.g==E){ql(g),wa(g),g.g=null;var F=2}else if(Wu(g.h,E))C=E.G,ga(g.h,E),F=1;else return;if(g.I!=0){if(E.o)if(F==1){C=E.u?E.u.length:0,E=Date.now()-E.F;var q=g.D;F=Nr(),ut(F,new ro(F,C)),ws(g)}else Rn(g);else if(q=E.m,q==3||q==0&&E.X>0||!(F==1&&Of(g,E)||F==2&&Wr(g)))switch(C&&C.length>0&&(E=g.h,E.i=E.i.concat(C)),q){case 1:pi(g,5);break;case 4:pi(g,10);break;case 3:pi(g,6);break;default:pi(g,2)}}}function Zl(g,E){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*E}function pi(g,E){if(g.j.info("Error code "+E),E==2){var C=h(g.bb,g),F=g.Ua;const q=!F;F=new Mr(F||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ma(F,"https"),ys(F),q?Vr(F.toString(),C):jr(F.toString(),C)}else gt(2);g.I=0,g.l&&g.l.pa(E),Ea(g),Xl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Ea(g){if(g.I=0,g.ja=[],g.l){const E=di(g.h);(E.length!=0||g.i.length!=0)&&(T(g.ja,E),T(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function eh(g,E,C){var F=C instanceof Mr?Fi(C):new Mr(C);if(F.g!="")E&&(F.g=E+"."+F.g),Lr(F,F.u);else{var q=o.location;F=q.protocol,E=E?E+"."+q.hostname:q.hostname,q=+q.port;const ee=new Mr(null);F&&ma(ee,F),E&&(ee.g=E),q&&Lr(ee,q),C&&(ee.h=C),F=ee}return C=g.G,E=g.wa,C&&E&&ot(F,C,E),ot(F,"VER",g.ka),Br(g,F),F}function Ff(g,E,C){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new pt(new _s({ab:C})):new pt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vf(){}n=Vf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ql(){}Ql.prototype.g=function(g,E){return new yn(g,E)};function yn(g,E){_t.call(this),this.g=new Kl(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!O(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!O(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new uo(this)}m(yn,_t),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Hl(this.g)},yn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=br(g),g=C);E.i.push(new Iy(E.Ya++,g)),E.I==3&&ws(E)},yn.prototype.N=function(){this.g.l=null,delete this.j,Hl(this.g),delete this.g,yn.Z.N.call(this)};function jf(g){gs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const C in E){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}m(jf,gs);function zf(){io.call(this),this.status=1}m(zf,io);function uo(g){this.g=g}m(uo,Vf),uo.prototype.ra=function(){ut(this.g,"a")},uo.prototype.qa=function(g){ut(this.g,new jf(g))},uo.prototype.pa=function(g){ut(this.g,new zf)},uo.prototype.oa=function(){ut(this.g,"b")},Ql.prototype.createWebChannel=Ql.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,eN=function(){return new Ql},Jk=function(){return Nr()},Qk=On,nx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rn.NO_ERROR=0,rn.TIMEOUT=8,rn.HTTP_ERROR=6,ym=rn,st.COMPLETE="complete",Zk=st,Vl.EventType=kr,kr.OPEN="a",kr.CLOSE="b",kr.ERROR="c",kr.MESSAGE="d",_t.prototype.listen=_t.prototype.J,Yh=Vl,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Yk=pt}).apply(typeof Jg<"u"?Jg:typeof self<"u"?self:typeof window<"u"?window:{});const wR="@firebase/firestore",ER="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Fu="12.7.0";const Sl=new Q1("@firebase/firestore");function Fc(){return Sl.logLevel}function fe(n,...e){if(Sl.logLevel<=He.DEBUG){const t=e.map(dw);Sl.debug(`Firestore (${Fu}): ${n}`,...t)}}function Ti(n,...e){if(Sl.logLevel<=He.ERROR){const t=e.map(dw);Sl.error(`Firestore (${Fu}): ${n}`,...t)}}function sy(n,...e){if(Sl.logLevel<=He.WARN){const t=e.map(dw);Sl.warn(`Firestore (${Fu}): ${n}`,...t)}}function dw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ae(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,tN(n,i,t)}function tN(n,e,t){let i=`FIRESTORE (${Fu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ti(i),new Error(i)}function De(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||tN(e,r,i)}function St(n,e){return n}const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends hs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class nN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eW{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class tW{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class nW{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){De(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new cl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new cl,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new cl)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(De(typeof i.accessToken=="string",31837,{l:i}),new nN(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class iW{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class rW{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new iW(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class TR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sW{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){De(this.o===void 0,3512);const i=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new TR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(De(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new TR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function oW(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class iN{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=oW(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Ke(n,e){return n<e?-1:n>e?1:0}function ix(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return Z0(r)===Z0(s)?Ke(r,s):Z0(r)?1:-1}return Ke(n.length,e.length)}const aW=55296,lW=57343;function Z0(n){const e=n.charCodeAt(0);return e>=aW&&e<=lW}function _u(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function rN(n){return n+"\0"}const SR="__name__";class Yr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ae(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Yr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Yr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Ke(e.length,t.length)}static compareSegments(e,t){const i=Yr.isNumericId(e),r=Yr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Yr.extractNumericId(e).compare(Yr.extractNumericId(t)):ix(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hw.fromString(e.substring(4,e.length-2))}}class Rt extends Yr{construct(e,t,i){return new Rt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Rt(t)}static emptyPath(){return new Rt([])}}const cW=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends Yr{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return cW.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===SR}static keyField(){return new Bt([SR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Se(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Se(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Se(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Se(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Rt.fromString(e))}static fromName(e){return new Ee(Rt.fromString(e).popFirst(5))}static empty(){return new Ee(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Rt(e.slice()))}}function uW(n,e,t,i){if(e===!0&&i===!0)throw new Se(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function hW(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function dW(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae(12329,{type:typeof n})}function sN(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=dW(n);throw new Se(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ef(n,e){if(!hW(n))throw new Se(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Se(ae.INVALID_ARGUMENT,t);return!0}const IR=-62135596800,CR=1e6;class Nt{static now(){return Nt.fromMillis(Date.now())}static fromDate(e){return Nt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*CR);return new Nt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<IR)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/CR}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ef(e,Nt._jsonSchema))return new Nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-IR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Nt._jsonSchemaVersion="firestore/timestamp/1.0",Nt._jsonSchema={type:Xt("string",Nt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new Nt(0,0))}static max(){return new Je(new Nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Bd=-1;class op{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function rx(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}op.UNKNOWN_ID=-1;class _m{constructor(e,t){this.fieldPath=e,this.kind=t}}class Wd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Wd(0,Ai.min())}}function fW(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Je.fromTimestamp(i===1e9?new Nt(t+1,0):new Nt(t,i));return new Ai(r,Ee.empty(),e)}function oN(n){return new Ai(n.readTime,n.key,Bd)}class Ai{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ai(Je.min(),Ee.empty(),Bd)}static max(){return new Ai(Je.max(),Ee.empty(),Bd)}}function fw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:Ke(n.largestBatchId,e.largestBatchId))}const aN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function oy(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==aN)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,i)=>{t(e)}))}static reject(e){return new Z(((t,i)=>{i(e)}))}static waitFor(e){return new Z(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Z.resolve(!1);for(const i of e)t=t.next((r=>r?Z.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Z(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Z(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const wi="SimpleDb";class ay{static open(e,t,i,r){try{return new ay(t,e.transaction(r,i))}catch(s){throw new ad(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new cl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ad(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=gw(i.target.error);this.S.reject(new ad(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(wi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new mW(t)}}class ea{static delete(e){return fe(wi,"Removing database:",e),Ha(sk().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!gk())return!1;if(ea.F())return!0;const e=en(),t=ea.M(e),i=0<t&&t<10,r=cN(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,ea.M(en())===12.2&&Ti("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(wi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new ad(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Se(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Se(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new ad(e,o))},r.onupgradeneeded=s=>{fe(wi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{fe(wi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=ay.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Z.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(fe(wi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class gW{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ha(this.U.delete())}}class ad extends Se{constructor(e,t){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fl(n){return n.name==="IndexedDbTransactionError"}class mW{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(fe(wi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(fe(wi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ha(i)}add(e){return fe(wi,"ADD",this.store.name,e,e),Ha(this.store.add(e))}get(e){return Ha(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(wi,"GET",this.store.name,e,t),t)))}delete(e){return fe(wi,"DELETE",this.store.name,e),Ha(this.store.delete(e))}count(){return fe(wi,"COUNT",this.store.name),Ha(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Z(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Z(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){fe(wi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Z(((i,r)=>{t.onerror=s=>{const o=gw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Z(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new gW(l),h=t(l.primaryKey,l.value,u);if(h instanceof Z){const f=h.catch((m=>(u.done(),Z.reject(m))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ha(n){return new Z(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=gw(i.target.error);t(r)}}))}let RR=!1;function gw(n){const e=ea.M(en());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return RR||(RR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const ld="IndexBackfiller";class pW{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(ld,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(ld,`Documents written: ${t}`)}catch(t){Fl(t)?fe(ld,"Ignoring IndexedDB error during index backfill: ",t):await oy(t)}await this.re(6e4)}))}}class yW{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Z.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return fe(ld,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(fe(ld,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=oN(s);fw(o,i)>0&&(i=o)})),new Ai(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class vr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vr.ce=-1;const ul=-1;function ly(n){return n==null}function ap(n){return n===0&&1/n==-1/0}const lp="";function Wn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=AR(e)),e=_W(n.get(t),e);return AR(e)}function _W(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case lp:t+="";break;default:t+=s}}return t}function AR(n){return n+lp+""}function es(n){const e=n.length;if(De(e>=2,64408,{path:n}),e===2)return De(n.charAt(0)===lp&&n.charAt(1)==="",56145,{path:n}),Rt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(lp,s);switch((o<0||o>t)&&Ae(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Ae(61167,{path:n})}s=o+2}return new Rt(i)}const $a="remoteDocuments",Tf="owner",Rc="owner",Gd="mutationQueues",vW="userId",fr="mutations",bR="batchId",il="userMutationsIndex",PR=["userId","batchId"];function vm(n,e){return[n,Wn(e)]}function uN(n,e,t){return[n,Wn(e),t]}const xW={},vu="documentMutations",cp="remoteDocumentsV14",wW=["prefixPath","collectionGroup","readTime","documentId"],xm="documentKeyIndex",EW=["prefixPath","collectionGroup","documentId"],hN="collectionGroupIndex",TW=["collectionGroup","readTime","prefixPath","documentId"],$d="remoteDocumentGlobal",sx="remoteDocumentGlobalKey",xu="targets",dN="queryTargetsIndex",SW=["canonicalId","targetId"],wu="targetDocuments",IW=["targetId","path"],mw="documentTargetsIndex",CW=["path","targetId"],up="targetGlobalKey",hl="targetGlobal",Kd="collectionParents",RW=["collectionId","parent"],Eu="clientMetadata",AW="clientId",cy="bundles",bW="bundleId",uy="namedQueries",PW="name",pw="indexConfiguration",kW="indexId",ox="collectionGroupIndex",NW="collectionGroup",cd="indexState",DW=["indexId","uid"],fN="sequenceNumberIndex",MW=["uid","sequenceNumber"],ud="indexEntries",LW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gN="documentKeyIndex",OW=["indexId","uid","orderedDocumentKey"],hy="documentOverlays",FW=["userId","collectionPath","documentId"],ax="collectionPathOverlayIndex",VW=["userId","collectionPath","largestBatchId"],mN="collectionGroupOverlayIndex",jW=["userId","collectionGroup","largestBatchId"],yw="globals",zW="name",pN=[Gd,fr,vu,$a,xu,Tf,hl,wu,Eu,$d,Kd,cy,uy],UW=[...pN,hy],yN=[Gd,fr,vu,cp,xu,Tf,hl,wu,Eu,$d,Kd,cy,uy,hy],_N=yN,_w=[..._N,pw,cd,ud],BW=_w,vN=[..._w,yw],WW=vN;class lx extends lN{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tn(n,e){const t=St(n);return ea.O(t.le,e)}function kR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function vw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function GW(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ui{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new ui(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new ui(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new em(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new em(this.root,e,this.comparator,!1)}getReverseIterator(){return new em(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new em(this.root,e,this.comparator,!0)}}class em{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yt{constructor(e){this.comparator=e,this.data=new ui(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new NR(this.data.getIterator())}getIteratorFrom(e){return new NR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class NR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ac(n){return n.hasNext()?n.getNext():void 0}class js{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new js([])}unionWith(e){let t=new yt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _u(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class $W extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class hi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new $W("Invalid base64 string: "+s):s}})(e);return new hi(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new hi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hi.EMPTY_BYTE_STRING=new hi("");const KW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ra(n){if(De(!!n,39018),typeof n=="string"){let e=0;const t=KW.exec(n);if(De(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Tu(n){return typeof n=="string"?hi.fromBase64String(n):hi.fromUint8Array(n)}const xN="server_timestamp",wN="__type__",EN="__previous_value__",TN="__local_write_time__";function xw(n){return(n?.mapValue?.fields||{})[wN]?.stringValue===xN}function SN(n){const e=n.mapValue.fields[EN];return xw(e)?SN(e):e}function hp(n){const e=ra(n.mapValue.fields[TN].timestampValue);return new Nt(e.seconds,e.nanos)}class HW{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const dp="(default)";class Su{constructor(e,t){this.projectId=e,this.database=t||dp}static empty(){return new Su("","")}get isDefaultDatabase(){return this.database===dp}isEqual(e){return e instanceof Su&&e.projectId===this.projectId&&e.database===this.database}}const IN="__type__",CN="__max__",Xo={mapValue:{fields:{__type__:{stringValue:CN}}}},RN="__vector__",fp="value",wm={nullValue:"NULL_VALUE"};function Iu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?xw(n)?4:AN(n)?9007199254740991:dy(n)?10:11:Ae(28295,{value:n})}function ls(n,e){if(n===e)return!0;const t=Iu(n);if(t!==Iu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hp(n).isEqual(hp(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ra(r.timestampValue),l=ra(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Tu(r.bytesValue).isEqual(Tu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Ht(r.geoPointValue.latitude)===Ht(s.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Ht(r.integerValue)===Ht(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Ht(r.doubleValue),l=Ht(s.doubleValue);return o===l?ap(o)===ap(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return _u(n.arrayValue.values||[],e.arrayValue.values||[],ls);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(kR(o)!==kR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!ls(o[u],l[u])))return!1;return!0})(n,e);default:return Ae(52216,{left:n})}}function Hd(n,e){return(n.values||[]).find((t=>ls(t,e)))!==void 0}function sa(n,e){if(n===e)return 0;const t=Iu(n),i=Iu(e);if(t!==i)return Ke(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ke(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Ht(s.integerValue||s.doubleValue),u=Ht(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return DR(n.timestampValue,e.timestampValue);case 4:return DR(hp(n),hp(e));case 5:return ix(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=Tu(s),u=Tu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=Ke(l[h],u[h]);if(f!==0)return f}return Ke(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=Ke(Ht(s.latitude),Ht(o.latitude));return l!==0?l:Ke(Ht(s.longitude),Ht(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return MR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[fp]?.arrayValue,f=u[fp]?.arrayValue,m=Ke(h?.values?.length||0,f?.values?.length||0);return m!==0?m:MR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Xo.mapValue&&o===Xo.mapValue)return 0;if(s===Xo.mapValue)return 1;if(o===Xo.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const y=ix(u[m],f[m]);if(y!==0)return y;const x=sa(l[u[m]],h[f[m]]);if(x!==0)return x}return Ke(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Ae(23264,{he:t})}}function DR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ke(n,e);const t=ra(n),i=ra(e),r=Ke(t.seconds,i.seconds);return r!==0?r:Ke(t.nanos,i.nanos)}function MR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=sa(t[r],i[r]);if(s)return s}return Ke(t.length,i.length)}function Cu(n){return cx(n)}function cx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ra(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Tu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=cx(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${cx(t.fields[o])}`;return r+"}"})(n.mapValue):Ae(61005,{value:n})}function ww(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ux(n){return!!n&&"integerValue"in n}function Xd(n){return!!n&&"arrayValue"in n}function LR(n){return!!n&&"nullValue"in n}function OR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Q0(n){return!!n&&"mapValue"in n}function dy(n){return(n?.mapValue?.fields||{})[IN]?.stringValue===RN}function hd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return vw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=hd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hd(n.arrayValue.values[t]);return e}return{...n}}function AN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===CN}const bN={mapValue:{fields:{[IN]:{stringValue:RN},[fp]:{arrayValue:{}}}}};function XW(n){return"nullValue"in n?wm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ww(Su.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?dy(n)?bN:{mapValue:{}}:Ae(35942,{value:n})}function qW(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ww(Su.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?bN:"mapValue"in n?dy(n)?{mapValue:{}}:Xo:Ae(61959,{value:n})}function FR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function VR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Q0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hd(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=hd(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Q0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ls(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Q0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){vw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new yr(hd(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Je.min(),Je.min(),Je.min(),yr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Je.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Je.min(),Je.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Je.min(),Je.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ru{constructor(e,t){this.position=e,this.inclusive=t}}function jR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=sa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function zR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ls(n.position[t],e.position[t]))return!1;return!0}class gp{constructor(e,t="asc"){this.field=e,this.dir=t}}function YW(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class PN{}class Ye extends PN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new ZW(e,t,i):t==="array-contains"?new eG(e,i):t==="in"?new ON(e,i):t==="not-in"?new tG(e,i):t==="array-contains-any"?new nG(e,i):new Ye(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new QW(e,i):new JW(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sa(t,this.value)):t!==null&&Iu(this.value)===Iu(t)&&this.matchesComparison(sa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mt extends PN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new mt(e,t)}matches(e){return Au(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Au(n){return n.op==="and"}function hx(n){return n.op==="or"}function Ew(n){return kN(n)&&Au(n)}function kN(n){for(const e of n.filters)if(e instanceof mt)return!1;return!0}function dx(n){if(n instanceof Ye)return n.field.canonicalString()+n.op.toString()+Cu(n.value);if(Ew(n))return n.filters.map((e=>dx(e))).join(",");{const e=n.filters.map((t=>dx(t))).join(",");return`${n.op}(${e})`}}function NN(n,e){return n instanceof Ye?(function(i,r){return r instanceof Ye&&i.op===r.op&&i.field.isEqual(r.field)&&ls(i.value,r.value)})(n,e):n instanceof mt?(function(i,r){return r instanceof mt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&NN(o,r.filters[l])),!0):!1})(n,e):void Ae(19439)}function DN(n,e){const t=n.filters.concat(e);return mt.create(t,n.op)}function MN(n){return n instanceof Ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${Cu(t.value)}`})(n):n instanceof mt?(function(t){return t.op.toString()+" {"+t.getFilters().map(MN).join(" ,")+"}"})(n):"Filter"}class ZW extends Ye{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class QW extends Ye{constructor(e,t){super(e,"in",t),this.keys=LN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class JW extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=LN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function LN(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class eG extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xd(t)&&Hd(t.arrayValue,this.value)}}class ON extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Hd(this.value.arrayValue,t)}}class tG extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Hd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Hd(this.value.arrayValue,t)}}class nG extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Hd(this.value.arrayValue,i)))}}class iG{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function fx(n,e=null,t=[],i=[],r=null,s=null,o=null){return new iG(n,e,t,i,r,s,o)}function Il(n){const e=St(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>dx(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),ly(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Cu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Cu(i))).join(",")),e.Te=t}return e.Te}function Sf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!YW(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!NN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!zR(n.startAt,e.startAt)&&zR(n.endAt,e.endAt)}function rG(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function mp(n,e){return n.filters.filter((t=>t instanceof Ye&&t.field.isEqual(e)))}function UR(n,e,t){let i=wm,r=!0;for(const s of mp(n,e)){let o=wm,l=!0;switch(s.op){case"<":case"<=":o=XW(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=wm}FR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];FR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function BR(n,e,t){let i=Xo,r=!0;for(const s of mp(n,e)){let o=Xo,l=!0;switch(s.op){case">=":case">":o=qW(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Xo}VR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];VR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class fy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function sG(n,e,t,i,r,s,o,l){return new fy(n,e,t,i,r,s,o,l)}function FN(n){return new fy(n)}function WR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function oG(n){return n.collectionGroup!==null}function dd(n){const e=St(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new yt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new gp(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new gp(Bt.keyField(),i))}return e.Ie}function $s(n){const e=St(n);return e.Ee||(e.Ee=aG(e,dd(n))),e.Ee}function aG(n,e){if(n.limitType==="F")return fx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new gp(r.field,s)}));const t=n.endAt?new Ru(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ru(n.startAt.position,n.startAt.inclusive):null;return fx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function gx(n,e,t){return new fy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function VN(n,e){return Sf($s(n),$s(e))&&n.limitType===e.limitType}function jN(n){return`${Il($s(n))}|lt:${n.limitType}`}function Mh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>MN(r))).join(", ")}]`),ly(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Cu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Cu(r))).join(",")),`Target(${i})`})($s(n))}; limitType=${n.limitType})`}function gy(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of dd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=jR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,dd(i),r)||i.endAt&&!(function(o,l,u){const h=jR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,dd(i),r))})(n,e)}function lG(n){return(e,t)=>{let i=!1;for(const r of dd(n)){const s=cG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function cG(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?sa(u,h):Ae(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ae(19790,{direction:n.dir})}}class ca{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){vw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return GW(this.inner)}size(){return this.innerSize}}const uG=new ui(Ee.comparator);function rl(){return uG}const zN=new ui(Ee.comparator);function tm(...n){let e=zN;for(const t of n)e=e.insert(t.key,t);return e}function hG(n){let e=zN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ts(){return fd()}function UN(){return fd()}function fd(){return new ca((n=>n.toString()),((n,e)=>n.isEqual(e)))}const dG=new ui(Ee.comparator),fG=new yt(Ee.comparator);function Sn(...n){let e=fG;for(const t of n)e=e.add(t);return e}const gG=new yt(Ke);function mG(){return gG}function pG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ap(e)?"-0":e}}function yG(n){return{integerValue:""+n}}class my{constructor(){this._=void 0}}function _G(n,e,t){return n instanceof qd?(function(r,s){const o={fields:{[wN]:{stringValue:xN},[TN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&xw(s)&&(s=SN(s)),s&&(o.fields[EN]=s),{mapValue:o}})(t,e):n instanceof bu?BN(n,e):n instanceof Pu?WN(n,e):(function(r,s){const o=xG(r,s),l=GR(o)+GR(r.Ae);return ux(o)&&ux(r.Ae)?yG(l):pG(r.serializer,l)})(n,e)}function vG(n,e,t){return n instanceof bu?BN(n,e):n instanceof Pu?WN(n,e):t}function xG(n,e){return n instanceof Yd?(function(i){return ux(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class qd extends my{}class bu extends my{constructor(e){super(),this.elements=e}}function BN(n,e){const t=GN(e);for(const i of n.elements)t.some((r=>ls(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Pu extends my{constructor(e){super(),this.elements=e}}function WN(n,e){let t=GN(e);for(const i of n.elements)t=t.filter((r=>!ls(r,i)));return{arrayValue:{values:t}}}class Yd extends my{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function GR(n){return Ht(n.integerValue||n.doubleValue)}function GN(n){return Xd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class wG{constructor(e,t){this.field=e,this.transform=t}}function EG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof bu&&r instanceof bu||i instanceof Pu&&r instanceof Pu?_u(i.elements,r.elements,ls):i instanceof Yd&&r instanceof Yd?ls(i.Ae,r.Ae):i instanceof qd&&r instanceof qd})(n.transform,e.transform)}class TG{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Em(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class py{}function $N(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Tw(n.key,xr.none()):new If(n.key,n.data,xr.none());{const t=n.data,i=yr.empty();let r=new yt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Vu(n.key,i,new js(r.toArray()),xr.none())}}function SG(n,e,t){n instanceof If?(function(r,s,o){const l=r.value.clone(),u=KR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Vu?(function(r,s,o){if(!Em(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=KR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(KN(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function gd(n,e,t,i){return n instanceof If?(function(s,o,l,u){if(!Em(s.precondition,o))return l;const h=s.value.clone(),f=HR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Vu?(function(s,o,l,u){if(!Em(s.precondition,o))return l;const h=HR(s.fieldTransforms,u,o),f=o.data;return f.setAll(KN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,i):(function(s,o,l){return Em(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function $R(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&_u(i,r,((s,o)=>EG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class If extends py{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Vu extends py{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function KN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function KR(n,e,t){const i=new Map;De(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,vG(o,l,t[r]))}return i}function HR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,_G(s,o,e))}return i}class Tw extends py{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class HN extends py{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Sw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&SG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=gd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=gd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=UN();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=$N(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Je.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&_u(this.mutations,e.mutations,((t,i)=>$R(t,i)))&&_u(this.baseMutations,e.baseMutations,((t,i)=>$R(t,i)))}}class Iw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){De(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return dG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Iw(e,t,i,r)}}class Cw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Ze;function IG(n){switch(n){case ae.OK:return Ae(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Ae(15467,{code:n})}}function CG(n){if(n===void 0)return Ti("GRPC error has no .code"),ae.UNKNOWN;switch(n){case Kt.OK:return ae.OK;case Kt.CANCELLED:return ae.CANCELLED;case Kt.UNKNOWN:return ae.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return ae.INTERNAL;case Kt.UNAVAILABLE:return ae.UNAVAILABLE;case Kt.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Kt.NOT_FOUND:return ae.NOT_FOUND;case Kt.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Kt.ABORTED:return ae.ABORTED;case Kt.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Kt.DATA_LOSS:return ae.DATA_LOSS;default:return Ae(39323,{code:n})}}(Ze=Kt||(Kt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";new hw([4294967295,4294967295],0);const RG={asc:"ASCENDING",desc:"DESCENDING"},AG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bG={and:"AND",or:"OR"};class PG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function kG(n,e){return n.useProto3Json||ly(e)?e:{value:e}}function mx(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NG(n,e){return mx(n,e.toTimestamp())}function Sr(n){return De(!!n,49232),Je.fromTimestamp((function(t){const i=ra(t);return new Nt(i.seconds,i.nanos)})(n))}function XN(n,e){return px(n,e).canonicalString()}function px(n,e){const t=(function(r){return new Rt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function qN(n){const e=Rt.fromString(n);return De(BG(e),10190,{key:e.toString()}),e}function pp(n,e){return XN(n.databaseId,e.path)}function Tm(n,e){const t=qN(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(QN(t))}function YN(n,e){return XN(n.databaseId,e)}function ZN(n){const e=qN(n);return e.length===4?Rt.emptyPath():QN(e)}function DG(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function QN(n){return De(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function XR(n,e,t){return{name:pp(n,e),fields:t.value.mapValue.fields}}function MG(n,e,t){const i=Tm(n,e.name),r=Sr(e.updateTime),s=e.createTime?Sr(e.createTime):Je.min(),o=new yr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function yp(n,e){let t;if(e instanceof If)t={update:XR(n,e.key,e.value)};else if(e instanceof Tw)t={delete:pp(n,e.key)};else if(e instanceof Vu)t={update:XR(n,e.key,e.data),updateMask:UG(e.fieldMask)};else{if(!(e instanceof HN))return Ae(16599,{Vt:e.type});t={verify:pp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof qd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof bu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Pu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Yd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Ae(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:NG(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ae(27497)})(n,e.precondition)),t}function yx(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?xr.updateTime(Sr(s.updateTime)):s.exists!==void 0?xr.exists(s.exists):xr.none()})(e.currentDocument):xr.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)De(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new qd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new bu(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Pu(f)}else"increment"in l?u=new Yd(o,l.increment):Ae(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new wG(h,u)})(n,r))):[];if(e.update){e.update.name;const r=Tm(n,e.update.name),s=new yr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new js(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new Vu(r,s,o,t,i)}return new If(r,s,t,i)}if(e.delete){const r=Tm(n,e.delete);return new Tw(r,t)}if(e.verify){const r=Tm(n,e.verify);return new HN(r,t)}return Ae(1463,{proto:e})}function LG(n,e){return n&&n.length>0?(De(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Sr(r.updateTime):Sr(s);return o.isEqual(Je.min())&&(o=Sr(s)),new TG(o,r.transformResults||[])})(t,e)))):[]}function OG(n,e){return{documents:[YN(n,e.path)]}}function FG(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=YN(n,r);const s=(function(h){if(h.length!==0)return tD(mt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Vc(y.field),direction:VG(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=kG(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function JN(n){let e=ZN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){De(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){const y=eD(m);return y instanceof mt&&Ew(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((y=>(function(T){return new gp(jc(T.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(m){let y;return y=typeof m=="object"?m.value:m,ly(y)?null:y})(t.limit));let u=null;t.startAt&&(u=(function(m){const y=!!m.before,x=m.values||[];return new Ru(x,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const y=!m.before,x=m.values||[];return new Ru(x,y)})(t.endAt)),sG(e,r,o,s,l,"F",u,h)}function eD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=jc(t.unaryFilter.field);return Ye.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=jc(t.unaryFilter.field);return Ye.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=jc(t.unaryFilter.field);return Ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=jc(t.unaryFilter.field);return Ye.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ye.create(jc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return mt.create(t.compositeFilter.filters.map((i=>eD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}})(t.compositeFilter.op))})(n):Ae(30097,{filter:n})}function VG(n){return RG[n]}function jG(n){return AG[n]}function zG(n){return bG[n]}function Vc(n){return{fieldPath:n.canonicalString()}}function jc(n){return Bt.fromServerFormat(n.fieldPath)}function tD(n){return n instanceof Ye?(function(t){if(t.op==="=="){if(OR(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NAN"}};if(LR(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(OR(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NOT_NAN"}};if(LR(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vc(t.field),op:jG(t.op),value:t.value}}})(n):n instanceof mt?(function(t){const i=t.getFilters().map((r=>tD(r)));return i.length===1?i[0]:{compositeFilter:{op:zG(t.op),filters:i}}})(n):Ae(54877,{filter:n})}function UG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function BG(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Xc{constructor(e,t,i,r,s=Je.min(),o=Je.min(),l=hi.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Xc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class nD{constructor(e){this.yt=e}}function WG(n,e){let t;if(e.document)t=MG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Rl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Rl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new Nt(r[0],r[1]);return Je.fromTimestamp(s)})(e.readTime)),t}function qR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_p(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:pp(s,o.key),fields:o.data.value.mapValue.fields,updateTime:mx(s,o.version.toTimestamp()),createTime:mx(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cl(e.version)};else{if(!e.isUnknownDocument())return Ae(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cl(e.version)}}return i}function _p(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rl(n){const e=new Nt(n.seconds,n.nanoseconds);return Je.fromTimestamp(e)}function Xa(n,e){const t=(e.baseMutations||[]).map((s=>yx(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>yx(n.yt,s))),r=Nt.fromMillis(e.localWriteTimeMs);return new Sw(e.batchId,r,t,i)}function Zh(n){const e=Rl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Rl(n.lastLimboFreeSnapshotVersion):Je.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return De(o===1,1966,{count:o}),$s(FN(ZN(s.documents[0])))})(n.query):(function(s){return $s(JN(s))})(n.query),new Xc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,hi.fromBase64String(n.resumeToken))}function iD(n,e){const t=Cl(e.snapshotVersion),i=Cl(e.lastLimboFreeSnapshotVersion);let r;r=rG(e.target)?OG(n.yt,e.target):FG(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Il(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function rD(n){const e=JN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?gx(e,e.limit,"L"):e}function J0(n,e){return new Cw(e.largestBatchId,yx(n.yt,e.overlayMutation))}function YR(n,e){const t=e.path.lastSegment();return[n,Wn(e.path.popLast()),t]}function ZR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cl(i.readTime),documentKey:Wn(i.documentKey.path),largestBatchId:i.largestBatchId}}class GG{getBundleMetadata(e,t){return QR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Rl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return QR(e).put((function(r){return{bundleId:r.id,createTime:Cl(Sr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return JR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:rD(s.bundledQuery),readTime:Rl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return JR(e).put((function(r){return{name:r.name,readTime:Cl(Sr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function QR(n){return tn(n,cy)}function JR(n){return tn(n,uy)}class yy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new yy(e,i)}getOverlay(e,t){return Lh(e).get(YR(this.userId,t)).next((i=>i?J0(this.serializer,i):null))}getOverlays(e,t){const i=ts();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new Cw(t,o);r.push(this.St(e,l))})),Z.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Wn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Lh(e).Z(ax,l))})),Z.waitFor(s)}getOverlaysForCollection(e,t,i){const r=ts(),s=Wn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Lh(e).J(ax,o).next((l=>{for(const u of l){const h=J0(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=ts();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Lh(e).ee({index:mN,range:l},((u,h,f)=>{const m=J0(this.serializer,h);s.size()<r||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Lh(e).put((function(r,s,o){const[l,u,h]=YR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:yp(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Lh(n){return tn(n,hy)}class $G{bt(e){return tn(e,yw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?hi.fromUint8Array(i):hi.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class qa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){const i=Ht(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),ap(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ra(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Tu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?AN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):dy(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ae(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=fp,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}qa.Kt=new qa;const bc=255;function KG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function e2(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=KG(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class HG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=e2(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=e2(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(bc),this.sn(255)}_n(){this.an(bc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===bc?(this.sn(bc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===bc?(this.an(bc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class XG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class qG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Oh{constructor(){this.cn=new HG,this.ln=new XG(this.cn),this.hn=new qG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ya{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Ya(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Sm(this.En),directionalValue:Sm(this.dn),orderedDocumentKey:Sm(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Do(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=t2(n.En,e.En),t!==0?t:(t=t2(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function t2(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Sm(n){return fk()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function n2(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class i2{constructor(e){this.mn=new yt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(De(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=rx(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new yt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new _m(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new _m(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new _m(i.field,i.dir==="asc"?0:1)));return new op(op.UNKNOWN_ID,this.collectionId,t,Wd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function sD(n){if(De(n instanceof Ye||n instanceof mt,20012),n instanceof Ye){if(n instanceof ON){const t=n.value.arrayValue?.values?.map((i=>Ye.create(n.field,"==",i)))||[];return mt.create(t,"or")}return n}const e=n.filters.map((t=>sD(t)));return mt.create(e,n.op)}function YG(n){if(n.getFilters().length===0)return[];const e=xx(sD(n));return De(oD(e),7391),_x(e)||vx(e)?[e]:e.getFilters()}function _x(n){return n instanceof Ye}function vx(n){return n instanceof mt&&Ew(n)}function oD(n){return _x(n)||vx(n)||(function(t){if(t instanceof mt&&hx(t)){for(const i of t.getFilters())if(!_x(i)&&!vx(i))return!1;return!0}return!1})(n)}function xx(n){if(De(n instanceof Ye||n instanceof mt,34018),n instanceof Ye)return n;if(n.filters.length===1)return xx(n.filters[0]);const e=n.filters.map((i=>xx(i)));let t=mt.create(e,n.op);return t=vp(t),oD(t)?t:(De(t instanceof mt,64498),De(Au(t),40251),De(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Rw(i,r))))}function Rw(n,e){let t;return De(n instanceof Ye||n instanceof mt,38388),De(e instanceof Ye||e instanceof mt,25473),t=n instanceof Ye?e instanceof Ye?(function(r,s){return mt.create([r,s],"and")})(n,e):r2(n,e):e instanceof Ye?r2(e,n):(function(r,s){if(De(r.filters.length>0&&s.filters.length>0,48005),Au(r)&&Au(s))return DN(r,s.getFilters());const o=hx(r)?r:s,l=hx(r)?s:r,u=o.filters.map((h=>Rw(h,l)));return mt.create(u,"or")})(n,e),vp(t)}function r2(n,e){if(Au(e))return DN(e,n.getFilters());{const t=e.filters.map((i=>Rw(n,i)));return mt.create(t,"or")}}function vp(n){if(De(n instanceof Ye||n instanceof mt,11850),n instanceof Ye)return n;const e=n.getFilters();if(e.length===1)return vp(e[0]);if(kN(n))return n;const t=e.map((r=>vp(r))),i=[];return t.forEach((r=>{r instanceof Ye?i.push(r):r instanceof mt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:mt.create(i,n.op)}class ZG{constructor(){this.Cn=new Aw}addToCollectionParentIndex(e,t){return this.Cn.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(Ai.min())}updateCollectionGroup(e,t,i){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class Aw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new yt(Rt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new yt(Rt.comparator)).toArray()}}const s2="IndexedDbIndexManager",nm=new Uint8Array(0);class QG{constructor(e,t){this.databaseId=t,this.vn=new Aw,this.Fn=new ca((i=>Il(i)),((i,r)=>Sf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Wn(r)};return o2(e).put(s)}return Z.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[rN(t),""],!1,!0);return o2(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(es(o.parent))}return i}))}addFieldIndex(e,t){const i=Fh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=kc(e);return s.next((l=>{o.put(ZR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Fh(e),r=kc(e),s=Pc(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Fh(e),i=Pc(e),r=kc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Z.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new i2(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Pc(e);let r=!0;const s=new Map;return Z.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Sn();const l=[];return Z.forEach(s,((u,h)=>{fe(s2,`Using index ${(function(M){return`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map((R=>`${R.fieldPath}:${R.kind}`)).join(",")}`})(u)} to execute ${Il(t)}`);const f=(function(M,R){const D=rx(R);if(D===void 0)return null;for(const j of mp(M,D.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null})(h,u),m=(function(M,R){const D=new Map;for(const j of Ga(R))for(const k of mp(M,j.fieldPath))switch(k.op){case"==":case"in":D.set(j.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return D.set(j.fieldPath.canonicalString(),k.value),Array.from(D.values())}return null})(h,u),y=(function(M,R){const D=[];let j=!0;for(const k of Ga(R)){const A=k.kind===0?UR(M,k.fieldPath,M.startAt):BR(M,k.fieldPath,M.startAt);D.push(A.value),j&&(j=A.inclusive)}return new Ru(D,j)})(h,u),x=(function(M,R){const D=[];let j=!0;for(const k of Ga(R)){const A=k.kind===0?BR(M,k.fieldPath,M.endAt):UR(M,k.fieldPath,M.endAt);D.push(A.value),j&&(j=A.inclusive)}return new Ru(D,j)})(h,u),T=this.On(u,h,y),I=this.On(u,h,x),S=this.Nn(u,h,m),b=this.Bn(u.indexId,f,T,y.inclusive,I,x.inclusive,S);return Z.forEach(b,(N=>i.Y(N,t.limit).next((M=>{M.forEach((R=>{const D=Ee.fromSegments(R.documentKey);o.has(D)||(o=o.add(D),l.push(D))}))}))))})).next((()=>l))}return Z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=YG(mt.create(e.filters,"and")).map((i=>fx(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let m=0;m<u;++m){const y=t?this.Ln(t[m/h]):nm,x=this.kn(e,y,i[m%h],r),T=this.qn(e,y,s[m%h],o),I=l.map((S=>this.kn(e,y,S,!0)));f.push(...this.createRange(x,T,I))}return f}kn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new i2(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Z.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new yt(Bt.comparator),f=!1;for(const m of u.filters)for(const y of m.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const m of u.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Oh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);qa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Oh;return qa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Oh;return qa.Kt.Dt(ww(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Oh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Xd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);qa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Oh;u.seed(l.un()),qa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Ye&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Fh(e),r=kc(e);return(t?i.J(ox,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Z.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,m){const y=m?new Wd(m.sequenceNumber,new Ai(Rl(m.readTime),new Ee(es(m.documentKey)),m.largestBatchId)):Wd.empty(),x=f.fields.map((([T,I])=>new _m(Bt.fromServerFormat(T),I)));return new op(f.indexId,f.collectionGroup,x,y)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Ke(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Fh(e),s=kc(e);return this.Gn(e).next((o=>r.J(ox,IDBKeyRange.bound(t,t)).next((l=>Z.forEach(l,(u=>s.put(ZR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Z.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Z.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Z.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Z.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Pc(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Pc(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Pc(e);let s=new yt(Do);return r.ee({index:gN,range:IDBKeyRange.only([i.indexId,this.uid,Sm(this.$n(i,t))])},((o,l)=>{s=s.add(new Ya(i.indexId,t,n2(l.arrayValue),n2(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new yt(Do);const r=this.Qn(t,e);if(r==null)return i;const s=rx(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Xd(o))for(const l of o.arrayValue.values||[])i=i.add(new Ya(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Ya(t.indexId,e.key,nm,r));return i}Jn(e,t,i,r,s){fe(s2,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,m,y){const x=u.getIterator(),T=h.getIterator();let I=Ac(x),S=Ac(T);for(;I||S;){let b=!1,N=!1;if(I&&S){const M=f(I,S);M<0?N=!0:M>0&&(b=!0)}else I!=null?N=!0:b=!0;b?(m(S),S=Ac(T)):N?(y(I),I=Ac(x)):(I=Ac(x),S=Ac(T))}})(r,s,Do,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Z.waitFor(o)}Gn(e){let t=1;return kc(e).ee({index:fN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>Do(o,l))).filter(((o,l,u)=>!l||Do(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=Do(o,e),u=Do(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,nm,Ee.empty()),u=r[o+1].Vn(this.uid,nm,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Do(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(a2)}getMinOffset(e,t){return Z.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Ae(44426))))).next(a2)}}function o2(n){return tn(n,Kd)}function Pc(n){return tn(n,ud)}function Fh(n){return tn(n,pw)}function kc(n){return tn(n,cd)}function a2(n){De(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;fw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ai(e.readTime,e.documentKey,t)}const l2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aD=41943040;class ei{static withCacheSize(e){return new ei(e,ei.DEFAULT_COLLECTION_PERCENTILE,ei.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function lD(n,e,t){const i=n.store(fr),r=n.store(vu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,m,y)=>(l++,y.delete())));s.push(u.next((()=>{De(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const m=uN(e,f.key.path,t.batchId);s.push(r.delete(m)),h.push(f.key)}return Z.waitFor(s).next((()=>h))}function xp(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ae(14731);e=n.noDocument}return JSON.stringify(e).length}ei.DEFAULT_COLLECTION_PERCENTILE=10,ei.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ei.DEFAULT=new ei(aD,ei.DEFAULT_COLLECTION_PERCENTILE,ei.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ei.DISABLED=new ei(-1,0,0);class _y{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){De(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new _y(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).ee({index:il,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=zc(e),o=Mo(e);return o.add({}).next((l=>{De(typeof l=="number",49019);const u=new Sw(l,t,i,r),h=(function(x,T,I){const S=I.baseMutations.map((N=>yp(x.yt,N))),b=I.mutations.map((N=>yp(x.yt,N)));return{userId:T,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:S,mutations:b}})(this.serializer,this.userId,u),f=[];let m=new yt(((y,x)=>Ke(y.canonicalString(),x.canonicalString())));for(const y of r){const x=uN(this.userId,y.key.path,l);m=m.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,xW))}return m.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Z.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Mo(e).get(t).next((i=>i?(De(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Xa(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Mo(e).ee({index:il,range:r},((o,l,u)=>{l.userId===this.userId&&(De(l.batchId>=i,47524,{tr:i}),s=Xa(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ul;return Mo(e).ee({index:il,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ul],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).J(il,t).next((i=>i.map((r=>Xa(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=vm(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return zc(e).ee({range:r},((o,l,u)=>{const[h,f,m]=o,y=es(f);if(h===this.userId&&t.path.isEqual(y))return Mo(e).get(m).next((x=>{if(!x)throw Ae(61480,{nr:o,batchId:m});De(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:m}),s.push(Xa(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);const r=[];return t.forEach((s=>{const o=vm(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=zc(e).ee({range:l},((h,f,m)=>{const[y,x,T]=h,I=es(x);y===this.userId&&s.path.isEqual(I)?i=i.add(T):m.done()}));r.push(u)})),Z.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=vm(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new yt(Ke);return zc(e).ee({range:o},((u,h,f)=>{const[m,y,x]=u,T=es(y);m===this.userId&&i.isPrefixOf(T)?T.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Mo(e).get(s).next((o=>{if(o===null)throw Ae(35274,{batchId:s});De(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Xa(this.serializer,o))})))})),Z.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return lD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Z.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return zc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=es(s[1]);r.push(u)}else l.done()})).next((()=>{De(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return cD(e,this.userId,t)}_r(e){return uD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ul,lastStreamToken:""}))}}function cD(n,e,t){const i=vm(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return zc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,m,y]=l;f===e&&m===r&&(o=!0),h.done()})).next((()=>o))}function Mo(n){return tn(n,fr)}function zc(n){return tn(n,vu)}function uD(n){return tn(n,Gd)}class Al{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Al(0)}static cr(){return new Al(-1)}}class JG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Al(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Je.fromTimestamp(new Nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Nc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(De(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Nc(e).ee(((o,l)=>{const u=Zh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Z.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Nc(e).ee(((i,r)=>{const s=Zh(r);t(s)}))}lr(e){return c2(e).get(up).next((t=>(De(t!==null,2888),t)))}hr(e,t){return c2(e).put(up,t)}Pr(e,t){return Nc(e).put(iD(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Il(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Nc(e).ee({range:r,index:dN},((o,l,u)=>{const h=Zh(l);Sf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Go(e);return t.forEach((o=>{const l=Wn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Z.waitFor(r)}removeMatchingKeys(e,t,i){const r=Go(e);return Z.forEach(t,(s=>{const o=Wn(s.path);return Z.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Go(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Go(e);let s=Sn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=es(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Wn(t.path),r=IDBKeyRange.bound([i],[rN(i)],!1,!0);let s=0;return Go(e).ee({index:mw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Nc(e).get(t).next((i=>i?Zh(i):null))}}function Nc(n){return tn(n,xu)}function c2(n){return tn(n,hl)}function Go(n){return tn(n,wu)}const u2="LruGarbageCollector",e7=1048576;function h2([n,e],[t,i]){const r=Ke(n,t);return r===0?Ke(e,i):r}class t7{constructor(e){this.Ir=e,this.buffer=new yt(h2),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();h2(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class n7{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(u2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fl(t)?fe(u2,"Ignoring IndexedDB error during garbage collection: ",t):await oy(t)}await this.Vr(3e5)}))}}class i7{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(vr.ce);const i=new t7(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(l2)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),l2):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r)))).next((m=>(i=m,l=Date.now(),this.removeTargets(e,i,t)))).next((m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((m=>(h=Date.now(),Fc()<=He.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m}))))}}function r7(n,e){return new i7(n,e)}class s7{constructor(e,t){this.db=e,this.garbageCollector=r7(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return im(e,i)}removeReference(e,t,i){return im(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return im(e,t)}br(e,t){return(function(r,s){let o=!1;return uD(r).te((l=>cD(r,l,s).next((u=>(u&&(o=!0),Z.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Je.min()),Go(e).delete((function(m){return[0,Wn(m.path)]})(o)))))}));r.push(u)}})).next((()=>Z.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return im(e,t)}Sr(e,t){const i=Go(e);let r,s=vr.ce;return i.ee({index:mw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==vr.ce&&t(new Ee(es(r)),s),s=h,r=u):s=vr.ce})).next((()=>{s!==vr.ce&&t(new Ee(es(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function im(n,e){return Go(n).put((function(i,r){return{targetId:0,path:Wn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class hD{constructor(){this.changes=new ca((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class o7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Va(e).put(i)}removeEntry(e,t,i){return Va(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],_p(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Va(e).ee({index:xm,range:IDBKeyRange.only(Vh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Va(e).ee({index:xm,range:IDBKeyRange.only(Vh(t))},((r,s)=>{i={document:this.Cr(t,s),size:xp(s)}})).next((()=>i))}getEntries(e,t){let i=rl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=rl(),r=new ui(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,xp(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Z.resolve();let r=new yt(g2);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Vh(r.first()),Vh(r.last())),o=r.getIterator();let l=o.getNext();return Va(e).ee({index:xm,range:s},((u,h,f)=>{const m=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&g2(l,m)<0;)i(l,null),l=o.getNext();l&&l.isEqual(m)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Vh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),_p(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Va(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=rl();for(const m of h){const y=this.Cr(Ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);y.isFoundDocument()&&(gy(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=rl();const o=f2(t,i),l=f2(t,Ai.max());return Va(e).ee({index:hN,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const m=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(m.key,m),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new a7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return d2(e).get(sx).next((t=>(De(!!t,20021),t)))}Dr(e,t){return d2(e).put(sx,t)}Cr(e,t){if(t){const i=WG(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Je.min())))return i}return Tn.newInvalidDocument(e)}}function dD(n){return new o7(n)}class a7 extends hD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ca((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new yt(((s,o)=>Ke(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=qR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=xp(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=qR(this.Nr.serializer,o.convertToNoDocument(Je.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function d2(n){return tn(n,$d)}function Va(n){return tn(n,cp)}function Vh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function f2(n,e){const t=e.documentKey.path.toArray();return[n,_p(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function g2(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Ke(t[s],i[s]),r)return r;return r=Ke(t.length,i.length),r||(r=Ke(t[t.length-2],i[i.length-2]),r||Ke(t[t.length-1],i[i.length-1]))}class l7{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class fD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&gd(i.mutation,r,js.empty(),Nt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Sn()){const r=ts();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=tm();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=ts();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Sn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=rl();const o=fd(),l=(function(){return fd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Vu)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),gd(f.mutation,h,f.mutation.getFieldMask(),Nt.now())):o.set(h.key,js.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new l7(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=fd();let r=new ui(((o,l)=>o-l)),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||js.empty();f=l.applyToLocalView(h,f),i.set(u,f);const m=(r.get(l.batchId)||Sn()).add(u);r=r.insert(l.batchId,m)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,m=UN();f.forEach((y=>{if(!s.has(y)){const x=$N(t.get(y),i.get(y));x!==null&&m.set(y,x),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return Z.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):oG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Z.resolve(ts());let l=Bd,u=s;return o.next((h=>Z.forEach(h,((f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(f)?Z.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{u=u.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Sn()))).next((f=>({batchId:l,changes:hG(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=tm();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=tm();return this.indexManager.getCollectionParents(e,s).next((l=>Z.forEach(l,(u=>{const h=(function(m,y){return new fy(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((m,y)=>{o=o.insert(m,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=tm();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&gd(f.mutation,h,js.empty(),Nt.now()),gy(t,h)&&(l=l.insert(u,h))})),l}))}}class c7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Sr(r.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:rD(r.bundledQuery),readTime:Sr(r.readTime)}})(t)),Z.resolve()}}class u7{constructor(){this.overlays=new ui(Ee.comparator),this.qr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ts();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Z.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Z.resolve()}getOverlaysForCollection(e,t,i){const r=ts(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Z.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ui(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=ts(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=ts(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Z.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Cw(t,i));let s=this.qr.get(t);s===void 0&&(s=Sn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class h7{constructor(){this.sessionToken=hi.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}class bw{constructor(){this.Qr=new yt(cn.$r),this.Ur=new yt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1);let s=Sn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||Ke(e.Yr,t.Yr)}static Kr(e,t){return Ke(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class d7{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yt(cn.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,t){return Z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?ul:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ee(s),0);let l=new yt(Ke);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Z.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){De(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Z.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Z.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class f7{constructor(e){this.ri=e,this.docs=(function(){return new ui(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Z.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=rl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Z.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=rl();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||fw(oN(f),i)<=0||(r.has(f.key)||gy(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Ae(9500)}ii(e,t){return Z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new g7(this)}getSize(e){return Z.resolve(this.size)}}class g7 extends hD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class m7{constructor(e){this.persistence=e,this.si=new ca((t=>Il(t)),Sf),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.oi=0,this._i=new bw,this.targetCount=0,this.ai=Al.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Al(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Pr(t),Z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Z.waitFor(s).next((()=>r))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Z.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Z.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Z.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Z.resolve(i)}containsKey(e,t){return Z.resolve(this._i.containsKey(t))}}class gD{constructor(e,t){this.ui={},this.overlays={},this.ci=new vr(0),this.li=!1,this.li=!0,this.hi=new h7,this.referenceDelegate=e(this),this.Pi=new m7(this),this.indexManager=new ZG,this.remoteDocumentCache=(function(r){return new f7(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new nD(t),this.Ii=new c7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new u7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new d7(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe("MemoryPersistence","Starting transaction:",e);const r=new p7(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Z.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class p7 extends lN{constructor(e){super(),this.currentSequenceNumber=e}}class vy{constructor(e){this.persistence=e,this.Ri=new bw,this.Vi=null}static mi(e){return new vy(e)}get fi(){if(this.Vi)return this.Vi;throw Ae(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Z.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Je.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Z.or([()=>Z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class y7{constructor(e){this.serializer=e}k(e,t,i,r){const s=new ay("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(Tf)})(e),(function(u){u.createObjectStore(Gd,{keyPath:vW}),u.createObjectStore(fr,{keyPath:bR,autoIncrement:!0}).createIndex(il,PR,{unique:!0}),u.createObjectStore(vu)})(e),m2(e),(function(u){u.createObjectStore($a)})(e));let o=Z.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(wu),u.deleteObjectStore(xu),u.deleteObjectStore(hl)})(e),m2(e)),o=o.next((()=>(function(u){const h=u.store(hl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Je.min().toTimestamp(),targetCount:0};return h.put(up,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(fr).J().next((m=>{u.deleteObjectStore(fr),u.createObjectStore(fr,{keyPath:bR,autoIncrement:!0}).createIndex(il,PR,{unique:!0});const y=h.store(fr),x=m.map((T=>y.put(T)));return Z.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(Eu,{keyPath:AW})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore($d)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(cy,{keyPath:bW})})(e),(function(u){u.createObjectStore(uy,{keyPath:PW})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(hy,{keyPath:FW});h.createIndex(ax,VW,{unique:!1}),h.createIndex(mN,jW,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(cp,{keyPath:wW});h.createIndex(xm,EW),h.createIndex(hN,TW)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore($a)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(pw,{keyPath:kW,autoIncrement:!0}).createIndex(ox,NW,{unique:!1}),u.createObjectStore(cd,{keyPath:DW}).createIndex(fN,MW,{unique:!1}),u.createObjectStore(ud,{keyPath:LW}).createIndex(gN,OW,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(cd).clear()})).next((()=>{t.objectStore(ud).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(yw,{keyPath:zW})})(e)}))),i<18&&r>=18&&fk()&&(o=o.next((()=>{t.objectStore(cd).clear()})).next((()=>{t.objectStore(ud).clear()}))),o}wi(e){let t=0;return e.store($a).ee(((i,r)=>{t+=xp(r)})).next((()=>{const i={byteSize:t};return e.store($d).put(sx,i)}))}yi(e){const t=e.store(Gd),i=e.store(fr);return t.J().next((r=>Z.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ul],[s.userId,s.lastAcknowledgedBatchId]);return i.J(il,o).next((l=>Z.forEach(l,(u=>{De(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Xa(this.serializer,u);return lD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(wu),i=e.store($a);return e.store(hl).get(up).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Rt(o),h=(function(m){return[0,Wn(m)]})(u);s.push(t.get(h).next((f=>f?Z.resolve():(m=>t.put({targetId:0,path:Wn(m),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Z.waitFor(s)))}))}bi(e,t){e.createObjectStore(Kd,{keyPath:RW});const i=t.store(Kd),r=new Aw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Wn(u)})}};return t.store($a).ee({X:!0},((o,l)=>{const u=new Rt(o);return s(u.popLast())})).next((()=>t.store(vu).ee({X:!0},(([o,l,u],h)=>{const f=es(l);return s(f.popLast())}))))}Di(e){const t=e.store(xu);return t.ee(((i,r)=>{const s=Zh(r),o=iD(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store($a),r=[];return i.ee(((s,o)=>{const l=t.store(cp),u=(function(m){return m.document?new Ee(Rt.fromString(m.document.name).popFirst(5)):m.noDocument?Ee.fromSegments(m.noDocument.path):m.unknownDocument?Ee.fromSegments(m.unknownDocument.path):Ae(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Z.waitFor(r)))}Fi(e,t){const i=t.store(fr),r=dD(this.serializer),s=new gD(vy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Sn();Xa(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Z.forEach(l,((u,h)=>{const f=new wn(h),m=yy.wt(this.serializer,f),y=s.getIndexManager(f),x=_y.wt(f,this.serializer,y,s.referenceDelegate);return new fD(r,x,m,y).recalculateAndSaveOverlaysForDocumentKeys(new lx(t,vr.ce),u).next()}))}))}}function m2(n){n.createObjectStore(wu,{keyPath:IW}).createIndex(mw,CW,{unique:!0}),n.createObjectStore(xu,{keyPath:"targetId"}).createIndex(dN,SW,{unique:!0}),n.createObjectStore(hl)}const Lo="IndexedDbPersistence",ev=18e5,tv=5e3,nv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",_7="main";class Pw{constructor(e,t,i,r,s,o,l,u,h,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!Pw.v())throw new Se(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new s7(this,r),this.$i=t+_7,this.serializer=new nD(u),this.Ui=new ea(this.$i,this.Ni,new y7(this.serializer)),this.hi=new $G,this.Pi=new JG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=dD(this.serializer),this.Ii=new GG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Ti(Lo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,nv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new vr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>rm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Fl(e))return fe(Lo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(Lo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return jh(e).get(Rc).next((t=>Z.resolve(this.es(t))))}ts(e){return rm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,ev)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=tn(t,Eu);return i.J().next((r=>{const s=this.ss(r,ev),o=r.filter((l=>s.indexOf(l)===-1));return Z.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Z.resolve(!0):jh(e).get(Rc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,tv)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,nv);return!1}}return!(!this.networkEnabled||!this.inForeground)||rm(e).J().next((i=>this.ss(i,tv).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(Lo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Tf,Eu],(e=>{const t=new lx(e,vr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>rm(e).J().next((t=>this.ss(t,ev).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return _y.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new QG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return yy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe(Lo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?WW:u===17?vN:u===16?BW:u===15?_w:u===14?_N:u===13?yN:u===12?UW:u===11?pN:void Ae(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new lx(l,this.ci?this.ci.next():vr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Ti(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Se(ae.FAILED_PRECONDITION,aN);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return jh(e).get(Rc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,tv)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Se(ae.FAILED_PRECONDITION,nv)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return jh(e).put(Rc,t)}static v(){return ea.v()}Zi(e){const t=jh(e);return t.get(Rc).next((i=>this.es(i)?(fe(Lo,"Releasing primary lease."),t.delete(Rc)):Z.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Ti(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;dk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(Lo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ti(Lo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ti("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function jh(n){return tn(n,Tf)}function rm(n){return tn(n,Eu)}function v7(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class kw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new kw(e,t.fromCache,i,r)}}class x7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class mD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return dk()?8:cN(en())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new x7;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Fc()<=He.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",Mh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Fc()<=He.DEBUG&&fe("QueryEngine","Query:",Mh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Fc()<=He.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",Mh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$s(t))):Z.resolve())}ys(e,t){if(WR(t))return Z.resolve(null);let i=$s(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=gx(t,null,"F"),i=$s(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Sn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,gx(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return WR(t)||r.isEqual(Je.min())?Z.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Z.resolve(null):(Fc()<=He.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Mh(t)),this.vs(e,o,t,fW(r,Bd)).next((l=>l)))}))}Ds(e,t){let i=new yt(lG(e));return t.forEach(((r,s)=>{gy(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Fc()<=He.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",Mh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ai.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const w7="LocalStore";class E7{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ui(Ke),this.xs=new ca((s=>Il(s)),Sf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function pD(n,e,t,i){return new E7(n,e,t,i)}async function T7(n,e){const t=St(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Sn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function S7(n,e){const t=St(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const m=h.batch,y=m.keys();let x=Z.resolve();return y.forEach((T=>{x=x.next((()=>f.getEntry(u,T))).next((I=>{const S=h.docVersions.get(T);De(S!==null,48541),I.version.compareTo(S)<0&&(m.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,m)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Sn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function I7(n){const e=St(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function C7(n,e){const t=St(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ul),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class p2{constructor(){this.activeTargetIds=mG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yD{constructor(){this.Mo=new p2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new p2,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class R7{Oo(e){}shutdown(){}}const y2="ConnectivityMonitor";class _2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(y2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(y2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let sm=null;function wx(){return sm===null?sm=(function(){return 268435456+Math.round(2147483648*Math.random())})():sm++,"0x"+sm.toString(16)}const iv="RestConnection",A7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class b7{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===dp?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=wx(),l=this.zo(e,t.toUriEncodedString());fe(iv,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Ll(h);return this.Jo(e,l,u,i,f).then((m=>(fe(iv,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw sy(iv,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",i),m}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Fu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=A7[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class P7{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Nn="WebChannelConnection";class k7 extends b7{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=wx();return new Promise(((l,u)=>{const h=new Yk;h.setWithCredentials(!0),h.listenOnce(Zk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case ym.NO_ERROR:const m=h.getResponseJson();fe(Nn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case ym.TIMEOUT:fe(Nn,`RPC '${e}' ${o} timed out`),u(new Se(ae.DEADLINE_EXCEEDED,"Request time out"));break;case ym.HTTP_ERROR:const y=h.getStatus();if(fe(Nn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const T=x?.error;if(T&&T.status&&T.message){const I=(function(b){const N=b.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(N)>=0?N:ae.UNKNOWN})(T.status);u(new Se(I,T.message))}else u(new Se(ae.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Se(ae.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{fe(Nn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);fe(Nn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=wx(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=eN(),l=Jk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");fe(Nn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const m=o.createWebChannel(f,u);this.I_(m);let y=!1,x=!1;const T=new P7({Yo:S=>{x?fe(Nn,`Not sending because RPC '${e}' stream ${r} is closed:`,S):(y||(fe(Nn,`Opening RPC '${e}' stream ${r} transport.`),m.open(),y=!0),fe(Nn,`RPC '${e}' stream ${r} sending:`,S),m.send(S))},Zo:()=>m.close()}),I=(S,b,N)=>{S.listen(b,(M=>{try{N(M)}catch(R){setTimeout((()=>{throw R}),0)}}))};return I(m,Yh.EventType.OPEN,(()=>{x||(fe(Nn,`RPC '${e}' stream ${r} transport opened.`),T.o_())})),I(m,Yh.EventType.CLOSE,(()=>{x||(x=!0,fe(Nn,`RPC '${e}' stream ${r} transport closed`),T.a_(),this.E_(m))})),I(m,Yh.EventType.ERROR,(S=>{x||(x=!0,sy(Nn,`RPC '${e}' stream ${r} transport errored. Name:`,S.name,"Message:",S.message),T.a_(new Se(ae.UNAVAILABLE,"The operation could not be completed")))})),I(m,Yh.EventType.MESSAGE,(S=>{if(!x){const b=S.data[0];De(!!b,16349);const N=b,M=N?.error||N[0]?.error;if(M){fe(Nn,`RPC '${e}' stream ${r} received error:`,M);const R=M.status;let D=(function(A){const L=Kt[A];if(L!==void 0)return CG(L)})(R),j=M.message;D===void 0&&(D=ae.INTERNAL,j="Unknown error status: "+R+" with message "+M.message),x=!0,T.a_(new Se(D,j)),m.close()}else fe(Nn,`RPC '${e}' stream ${r} received:`,b),T.u_(b)}})),I(l,Qk.STAT_EVENT,(S=>{S.stat===nx.PROXY?fe(Nn,`RPC '${e}' stream ${r} detected buffering proxy`):S.stat===nx.NOPROXY&&fe(Nn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function N7(){return typeof window<"u"?window:null}function Im(){return typeof document<"u"?document:null}function _D(n){return new PG(n,!0)}class vD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const v2="PersistentStream";class D7{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(Ti(t.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Se(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(v2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(v2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class M7 extends D7{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=LG(e.writeResults,e.commitTime),i=Sr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=DG(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>yp(this.serializer,i)))};this.q_(t)}}class L7{}class O7 extends L7{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Se(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,px(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Se(ae.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,px(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(ae.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class F7{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ti(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const xy="RemoteStore";class V7{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Ey(this)&&(fe(xy,"Restarting streams for network reachability change."),await(async function(u){const h=St(u);h.Ea.add(4),await wy(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Nw(h)})(this))}))})),this.Ra=new F7(i,r)}}async function Nw(n){if(Ey(n))for(const e of n.da)await e(!0)}async function wy(n){for(const e of n.da)await e(!1)}function Ey(n){return St(n).Ea.size===0}async function xD(n,e,t){if(!Fl(e))throw e;n.Ea.add(1),await wy(n),n.Ra.set("Offline"),t||(t=()=>I7(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(xy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Nw(n)}))}function wD(n,e){return e().catch((t=>xD(n,t,e)))}async function Ty(n){const e=St(n),t=oa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ul;for(;j7(e);)try{const r=await C7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,z7(e,r)}catch(r){await xD(e,r)}ED(e)&&TD(e)}function j7(n){return Ey(n)&&n.Ta.length<10}function z7(n,e){n.Ta.push(e);const t=oa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function ED(n){return Ey(n)&&!oa(n).x_()&&n.Ta.length>0}function TD(n){oa(n).start()}async function U7(n){oa(n).ra()}async function B7(n){const e=oa(n);for(const t of n.Ta)e.ea(t.mutations)}async function W7(n,e,t){const i=n.Ta.shift(),r=Iw.from(i,e,t);await wD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Ty(n)}async function G7(n,e){e&&oa(n).X_&&await(async function(i,r){if((function(o){return IG(o)&&o!==ae.ABORTED})(r.code)){const s=i.Ta.shift();oa(i).B_(),await wD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Ty(i)}})(n,e),ED(n)&&TD(n)}async function $7(n,e){const t=St(n);e?(t.Ea.delete(2),await Nw(t)):e||(t.Ea.add(2),await wy(t),t.Ra.set("Unknown"))}function oa(n){return n.fa||(n.fa=(function(t,i,r){const s=St(t);return s.sa(),new M7(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:U7.bind(null,n),r_:G7.bind(null,n),ta:B7.bind(null,n),na:W7.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Ty(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(xy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Dw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new cl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Dw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function K7(n,e){if(Ti("AsyncQueue",`${e}: ${n}`),Fl(n))return new Se(ae.UNAVAILABLE,`${e}: ${n}`);throw n}class H7{constructor(){this.queries=x2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=St(t),s=r.queries;r.queries=x2(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Se(ae.ABORTED,"Firestore shutting down"))}}function x2(){return new ca((n=>jN(n)),VN)}function X7(n){n.Ca.forEach((e=>{e.next()}))}var w2,E2;(E2=w2||(w2={})).Ma="default",E2.Cache="cache";const q7="SyncEngine";class Y7{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ca((l=>jN(l)),VN),this.Iu=new Map,this.Eu=new Set,this.du=new ui(Ee.comparator),this.Au=new Map,this.Ru=new bw,this.Vu={},this.mu=new Map,this.fu=Al.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function T2(n,e,t){const i=St(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=St(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,m)=>{for(const y of m.Sa)y.va(l)&&(h=!0)})),h&&X7(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Z7(n,e){const t=St(n),i=e.batch.batchId;try{const r=await S7(t.localStore,e);ID(t,i,null),SD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Mw(t,r)}catch(r){await oy(r)}}async function Q7(n,e,t){const i=St(n);try{const r=await(function(o,l){const u=St(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((m=>(De(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);ID(i,e,t),SD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Mw(i,r)}catch(r){await oy(r)}}function SD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ID(n,e,t){const i=St(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Mw(n,e,t){const i=St(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=kw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=St(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>Z.forEach(h,(y=>Z.forEach(y.Es,(x=>f.persistence.referenceDelegate.addReference(m,y.targetId,x))).next((()=>Z.forEach(y.ds,(x=>f.persistence.referenceDelegate.removeReference(m,y.targetId,x)))))))))}catch(m){if(!Fl(m))throw m;fe(w7,"Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const x=f.Ms.get(y),T=x.snapshotVersion,I=x.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(y,I)}}})(i.localStore,s))}async function J7(n,e){const t=St(n);if(!t.currentUser.isEqual(e)){fe(q7,"User change. New user:",e.toKey());const i=await T7(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Se(ae.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Mw(t,i.Ls)}}function e$(n){const e=St(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q7.bind(null,e),e}class Ex{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_D(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return pD(this.persistence,new mD,e.initialUser,this.serializer)}Cu(e){return new gD(vy.mi,this.serializer)}Du(e){return new yD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ex.provider={build:()=>new Ex};class t$ extends Ex{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await e$(this.xu.syncEngine),await Ty(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return pD(this.persistence,new mD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new n7(i,e.asyncQueue,t)}Mu(e,t){const i=new yW(t,this.persistence);return new pW(e.asyncQueue,i)}Cu(e){const t=v7(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?ei.withCacheSize(this.cacheSizeBytes):ei.DEFAULT;return new Pw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,N7(),Im(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new yD}}class Tx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>T2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=J7.bind(null,this.syncEngine),await $7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new H7})()}createDatastore(e){const t=_D(e.databaseInfo.databaseId),i=(function(s){return new k7(s)})(e.databaseInfo);return(function(s,o,l,u){return new O7(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new V7(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>T2(this.syncEngine,t,0)),(function(){return _2.v()?new _2:new R7})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const m=new Y7(r,s,o,l,u,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=St(t);fe(xy,"RemoteStore shutting down."),i.Ea.add(5),await wy(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Tx.provider={build:()=>new Tx};const S2="FirestoreClient";class n${constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=iN.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{fe(S2,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(fe(S2,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=K7(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function CD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const I2=new Map;const RD="firestore.googleapis.com",C2=!0;class R2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=RD,this.ssl=C2}else this.host=e.host,this.ssl=e.ssl??C2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<e7)throw new Se(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uW("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class AD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new R2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new R2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new eW;switch(i.type){case"firstParty":return new rW(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=I2.get(t);i&&(fe("ComponentProvider","Removing Datastore"),I2.delete(t),i.terminate())})(this),Promise.resolve()}}function i$(n,e,t,i={}){n=sN(n,AD);const r=Ll(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(Y1(`https://${l}`),Z1("Firestore",!0)),s.host!==RD&&s.host!==l&&sy("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!wl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=uk(i.mockUserToken,n._app?.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Se(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(m)}n._authCredentials=new tW(new nN(h,f))}}class Lw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Lw(this.firestore,e,this._query)}}class ns{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ow(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ns(this.firestore,e,this._key)}toJSON(){return{type:ns._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ef(t,ns._jsonSchema))return new ns(e,i||null,new Ee(Rt.fromString(t.referencePath)))}}ns._jsonSchemaVersion="firestore/documentReference/1.0",ns._jsonSchema={type:Xt("string",ns._jsonSchemaVersion),referencePath:Xt("string")};class Ow extends Lw{constructor(e,t,i){super(e,t,FN(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ns(this.firestore,null,new Ee(e))}withConverter(e){return new Ow(this.firestore,e,this._path)}}const A2="AsyncQueue";class b2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vD(this,"async_queue_retry"),this._c=()=>{const i=Im();i&&fe(A2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Im();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Im();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new cl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Fl(e))throw e;fe(A2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ti("INTERNAL UNHANDLED ERROR: ",P2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Dw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Ae(47125,{Pc:P2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function P2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class bD extends AD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new b2,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new b2(e),this._firestoreClient=void 0,await e}}}function r$(n,e){const t=typeof n=="object"?n:ew(),i=typeof n=="string"?n:dp,r=ty(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=ak("firestore");s&&i$(r,...s)}return r}function s$(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new HW(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,CD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new n$(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function o$(n,e){sy("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return a$(n,Tx.provider,{build:i=>new t$(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function a$(n,e,t){if((n=sN(n,bD))._firestoreClient||n._terminated)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Se(ae.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},s$(n)}class Os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Os(hi.fromBase64String(e))}catch(t){throw new Se(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Os(hi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ef(e,Os._jsonSchema))return Os.fromBase64String(e.bytes)}}Os._jsonSchemaVersion="firestore/bytes/1.0",Os._jsonSchema={type:Xt("string",Os._jsonSchemaVersion),bytes:Xt("string")};class PD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class dl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dl._jsonSchemaVersion}}static fromJSON(e){if(Ef(e,dl._jsonSchema))return new dl(e.latitude,e.longitude)}}dl._jsonSchemaVersion="firestore/geoPoint/1.0",dl._jsonSchema={type:Xt("string",dl._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class fl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ef(e,fl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new fl(e.vectorValues);throw new Se(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fl._jsonSchemaVersion="firestore/vectorValue/1.0",fl._jsonSchema={type:Xt("string",fl._jsonSchemaVersion),vectorValues:Xt("object")};const l$=new RegExp("[~\\*/\\[\\]]");function c$(n,e,t){if(e.search(l$)>=0)throw k2(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new PD(...e.split("."))._internalPath}catch{throw k2(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function k2(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Se(ae.INVALID_ARGUMENT,s+n+o)}class kD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ns(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new u$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ND("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class u$ extends kD{data(){return super.data()}}function ND(n,e){return typeof e=="string"?c$(n,e):e instanceof PD?e._internalPath:e._delegate._internalPath}class om{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nu extends kD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Cm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(ND("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=nu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}nu._jsonSchemaVersion="firestore/documentSnapshot/1.0",nu._jsonSchema={type:Xt("string",nu._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class Cm extends nu{data(e={}){return super.data(e)}}class md{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new om(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Cm(this._firestore,this._userDataWriter,i.key,i,new om(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new Cm(r._firestore,r._userDataWriter,l.doc.key,l.doc,new om(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new Cm(r._firestore,r._userDataWriter,l.doc.key,l.doc,new om(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:h$(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=md._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iN.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function h$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:n})}}md._jsonSchemaVersion="firestore/querySnapshot/1.0",md._jsonSchema={type:Xt("string",md._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};(function(e,t=!0){(function(r){Fu=r})(Ol),El(new ia("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new bD(new nW(i.getProvider("auth-internal")),new sW(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Se(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Su(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),ss(wR,ER,e),ss(wR,ER,"esm2020")})();const DD="firebasestorage.googleapis.com",d$="storageBucket",f$=120*1e3,g$=600*1e3;class ds extends hs{constructor(e,t,i=0){super(rv(e),`Firebase Storage: ${t} (${rv(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var cs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(cs||(cs={}));function rv(n){return"storage/"+n}function m$(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(cs.UNKNOWN,n)}function p$(){return new ds(cs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function y$(){return new ds(cs.CANCELED,"User canceled the upload/download.")}function _$(n){return new ds(cs.INVALID_URL,"Invalid URL '"+n+"'.")}function v$(n){return new ds(cs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function N2(n){return new ds(cs.INVALID_ARGUMENT,n)}function MD(){return new ds(cs.APP_DELETED,"The Firebase app was deleted.")}function x$(n){return new ds(cs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class wr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=wr.makeFromUrl(e,t)}catch{return new wr(e,"")}if(i.path==="")return i;throw v$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(R){R.path_=decodeURIComponent(R.path)}const f="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${f}/b/${r}/o${y}`,"i"),T={bucket:1,path:3},I=t===DD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",b=new RegExp(`^https?://${I}/${r}/${S}`,"i"),M=[{regex:l,indices:u,postModify:s},{regex:x,indices:T,postModify:h},{regex:b,indices:{bucket:1,path:2},postModify:h}];for(let R=0;R<M.length;R++){const D=M[R],j=D.regex.exec(e);if(j){const k=j[D.indices.bucket];let A=j[D.indices.path];A||(A=""),i=new wr(k,A),D.postModify(i);break}}if(i==null)throw _$(e);return i}}class w${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function E$(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...S){h||(h=!0,e.apply(null,S))}function m(S){r=setTimeout(()=>{r=null,n(x,u())},S)}function y(){s&&clearTimeout(s)}function x(S,...b){if(h){y();return}if(S){y(),f.call(null,S,...b);return}if(u()||o){y(),f.call(null,S,...b);return}i<64&&(i*=2);let M;l===1?(l=2,M=0):M=(i+Math.random())*1e3,m(M)}let T=!1;function I(S){T||(T=!0,y(),!h&&(r!==null?(S||(l=2),clearTimeout(r),m(0)):S||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function T$(n){n(!1)}function S$(n){return n!==void 0}function D2(n,e,t,i){if(i<e)throw N2(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw N2(`Invalid value for '${n}'. Expected ${t} or less.`)}function I$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var wp;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(wp||(wp={}));function C$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class R${constructor(e,t,i,r,s,o,l,u,h,f,m,y=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=m,this.retry=y,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,I)=>{this.resolve_=T,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new am(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===wp.NO_ERROR,u=s.getStatus();if(!l||C$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===wp.ABORT;i(!1,new am(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new am(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());S$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=m$();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?MD():y$();o(u)}else{const u=p$();o(u)}};this.canceled_?t(!1,new am(!1,null,!0)):this.backoffId_=E$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&T$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class am{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function A$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function b$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function P$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function k$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function N$(n,e,t,i,r,s,o=!0,l=!1){const u=I$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return P$(f,e),A$(f,t),b$(f,s),k$(f,i),new R$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function D$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function M$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Ep{constructor(e,t){this._service=e,t instanceof wr?this._location=t:this._location=wr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ep(e,t)}get root(){const e=new wr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return M$(this._location.path)}get storage(){return this._service}get parent(){const e=D$(this._location.path);if(e===null)return null;const t=new wr(this._location.bucket,e);return new Ep(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw x$(e)}}function M2(n,e){const t=e?.[d$];return t==null?null:wr.makeFromBucketSpec(t,n)}function L$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Ll(e);r&&(Y1(`https://${n.host}/b`),Z1("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:uk(s,n.app.options.projectId))}class O${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=DD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=f$,this._maxUploadRetryTime=g$,this._requests=new Set,r!=null?this._bucket=wr.makeFromBucketSpec(r,this._host):this._bucket=M2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wr.makeFromBucketSpec(this._url,e):this._bucket=M2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){D2("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){D2("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Hi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ep(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new w$(MD());{const o=N$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const L2="@firebase/storage",O2="0.14.0";const LD="storage";function F$(n=ew(),e){n=to(n);const i=ty(n,LD).getImmediate({identifier:e}),r=ak("storage");return r&&V$(i,...r),i}function V$(n,e,t,i={}){L$(n,e,t,i)}function j$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new O$(t,i,r,e,Ol)}function z$(){El(new ia(LD,j$,"PUBLIC").setMultipleInstances(!0)),ss(L2,O2,""),ss(L2,O2,"esm2020")}z$();const U$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Fw=yk(U$),sv=Y8(Fw),B$=r$(Fw);F$(Fw);o$(B$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const W$="visvriend2024",G$=new Ls,OD=Rr()(pf((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===W$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await s8(sv,G$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await jB(sv),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{VB(sv,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),Vw="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",Zd=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function $$(n,e){let t=Zd[0],i=1/0;for(const r of Zd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function K$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Vw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function H$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Vw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function X$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Vw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function q$(n){const[e,t,i]=await Promise.all([K$(n),H$(n),X$(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function F2(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const Y$=Rr((n,e)=>({station:Zd[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=$$(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=F2(t):r=await q$(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=F2(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})}));function Z$({target:n}){const e=H.useRef(null),t=H.useRef(null),i=eo(s=>s.setMap),r=Qe(s=>s.showScaleBar);return H.useEffect(()=>{if(!e.current){const s=new V9({target:n,controls:[],view:new Qr({center:ml([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),H.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new U9({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const Q$=["OpenStreetMap","Luchtfoto"];function J$(){const n=H.useRef(null),e=H.useRef(!1);Z$({target:"map"});const t=eo(u=>u.map),i=Zo(u=>u.registerLayer),r=Zo(u=>u.setLayerVisibility),s=Qe(u=>u.defaultBackground),o=Qe(u=>u.gpsAutoStart),l=ri(u=>u.startTracking);return H.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=new M0({properties:{title:"OpenStreetMap",type:"base"},visible:!0,source:new r9}),h=new M0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new jv({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),f=new M0({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new jv({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(u),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",u),i("Luchtfoto",h),i("Labels Overlay",f),t.updateSize(),m();async function m(){const y=fz();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async T=>{try{const I=await T.factory();return I?{name:T.name,layer:I}:null}catch(I){return console.warn(`Failed to create ${T.name}:`,I),null}}))).forEach(T=>{if(T.status==="fulfilled"&&T.value){const{name:I,layer:S}=T.value;t.addLayer(S),i(I,S)}})}},[t,i]),H.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";Q$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),H.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),_.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const eK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tK=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),V2=n=>{const e=tK(n);return e.charAt(0).toUpperCase()+e.slice(1)},FD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),nK=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var iK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const rK=H.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>H.createElement("svg",{ref:u,...iK,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:FD("lucide",r),...!s&&!nK(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>H.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ie=(n,e)=>{const t=H.forwardRef(({className:i,...r},s)=>H.createElement(rK,{ref:s,iconNode:e,className:FD(`lucide-${eK(V2(n))}`,`lucide-${n}`,i),...r}));return t.displayName=V2(n),t};const sK=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],VD=Ie("anchor",sK);const oK=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],aK=Ie("book-open",oK);const lK=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],jw=Ie("camera",lK);const cK=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],jD=Ie("chart-column",cK);const uK=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Sx=Ie("check",uK);const hK=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],dK=Ie("chevron-left",hK);const fK=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],zD=Ie("chevron-right",fK);const gK=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],mK=Ie("chevron-up",gK);const pK=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ix=Ie("clock",pK);const yK=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],_K=Ie("cloud-lightning",yK);const vK=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],xK=Ie("cloud-rain",vK);const wK=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],EK=Ie("cloud-snow",wK);const TK=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],pd=Ie("cloud",TK);const SK=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Cx=Ie("droplets",SK);const IK=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],UD=Ie("external-link",IK);const CK=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],RK=Ie("eye-off",CK);const AK=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],bK=Ie("eye",AK);const PK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],kK=Ie("file-text",PK);const NK=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Zs=Ie("fish",NK);const DK=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],MK=Ie("grip-vertical",DK);const LK=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],OK=Ie("image-plus",LK);const FK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],zw=Ie("info",FK);const VK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Tp=Ie("layers",VK);const jK=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],zK=Ie("loader-circle",jK);const UK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],BK=Ie("locate-fixed",UK);const WK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],GK=Ie("lock",WK);const $K=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],KK=Ie("log-out",$K);const HK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],bl=Ie("map-pin",HK);const XK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Sy=Ie("map",XK);const qK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],YK=Ie("menu",qK);const ZK=[["path",{d:"M5 12h14",key:"1ays0h"}]],QK=Ie("minus",ZK);const JK=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],eH=Ie("moon",JK);const tH=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],yd=Ie("navigation",tH);const nH=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],BD=Ie("pause",nH);const iH=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],rH=Ie("person-standing",iH);const sH=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],WD=Ie("play",sH);const oH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],aH=Ie("plus",oH);const lH=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],cH=Ie("refresh-cw",lH);const uH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],hH=Ie("rotate-ccw",uH);const dH=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],fH=Ie("ruler",dH);const gH=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],mH=Ie("save",gH);const pH=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],yH=Ie("scale",pH);const _H=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],j2=Ie("search",_H);const vH=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xH=Ie("settings",vH);const wH=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],EH=Ie("ship",wH);const TH=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],SH=Ie("sparkles",TH);const IH=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Rx=Ie("star",IH);const CH=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],RH=Ie("sun",CH);const AH=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],bH=Ie("tag",AH);const PH=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],Uw=Ie("thermometer",PH);const kH=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],NH=Ie("trending-down",kH);const DH=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],MH=Ie("trending-up",DH);const LH=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],OH=Ie("user",LH);const FH=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Qd=Ie("waves",FH);const VH=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],Bw=Ie("wind",VH);const jH=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bi=Ie("x",jH);async function zH(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,m=r.getUint16(f)===18761,y=UH(r,f,m);e(y);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function UH(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let m=0;m<r;m++){const y=i+2+m*12;if(n.getUint16(y,t)===34853){s=e+n.getUint32(y+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let m=0;m<o;m++){const y=s+2+m*12,x=n.getUint16(y,t),T=n.getUint16(y+2,t),I=n.getUint32(y+4,t),S=y+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(S));break;case 2:u=z2(n,e+n.getUint32(S,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(S));break;case 4:f=z2(n,e+n.getUint32(S,t),3,t);break}}if(u&&f&&l&&h){const m=U2(u[0],u[1],u[2],l),y=U2(f[0],f[1],f[2],h);if(!isNaN(m)&&!isNaN(y))return{lat:m,lng:y}}return null}catch{return null}}function z2(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function U2(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const GD=200,BH=.7;async function WH(n,e=GD){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",BH)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function GH(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function $D(n){const e=await WH(n,GD),t=await GH(e);return{thumbnailBlob:e,thumbnailBase64:t}}function KD(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function $H(){const n=eo(M=>M.map),e=si(M=>M.openCatchForm),[t,i]=H.useState(null),[r,s]=H.useState(!1),[o,l]=H.useState(!1),u=H.useRef(null),h=H.useRef(null);H.useEffect(()=>{if(!n)return;const M=n.getViewport();if(!M)return;const R=600,D=15,j=O=>{if(O.touches.length!==1)return;const le=O.touches[0];h.current={x:le.clientX,y:le.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const me=window.__olMap;if(!me)return;const ge=M.getBoundingClientRect(),ue=[h.current.x-ge.left,h.current.y-ge.top],Q=me.getCoordinateFromPixel(ue);if(Q){const se=FI(Q);O.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:se}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},R)},k=O=>{if(!u.current||!h.current)return;const le=O.touches[0],me=le.clientX-h.current.x,ge=le.clientY-h.current.y;Math.sqrt(me*me+ge*ge)>D&&(clearTimeout(u.current),u.current=null)},A=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},L=O=>{r&&O.preventDefault()},V=O=>{O.button===0&&(h.current={x:O.clientX,y:O.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const le=window.__olMap;if(!le)return;const me=M.getBoundingClientRect(),ge=[h.current.x-me.left,h.current.y-me.top],ue=le.getCoordinateFromPixel(ge);if(ue){const Q=FI(ue);i({pixel:[h.current.x,h.current.y],coordinate:Q}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},R))},z=O=>{if(!u.current||!h.current)return;const le=O.clientX-h.current.x,me=O.clientY-h.current.y;Math.sqrt(le*le+me*me)>D&&(clearTimeout(u.current),u.current=null)},B=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return M.addEventListener("touchstart",j,{passive:!1}),M.addEventListener("touchmove",k,{passive:!0}),M.addEventListener("touchend",A),M.addEventListener("touchcancel",A),M.addEventListener("contextmenu",L),M.addEventListener("mousedown",V),M.addEventListener("mousemove",z),M.addEventListener("mouseup",B),M.addEventListener("mouseleave",B),()=>{M.removeEventListener("touchstart",j),M.removeEventListener("touchmove",k),M.removeEventListener("touchend",A),M.removeEventListener("touchcancel",A),M.removeEventListener("contextmenu",L),M.removeEventListener("mousedown",V),M.removeEventListener("mousemove",z),M.removeEventListener("mouseup",B),M.removeEventListener("mouseleave",B),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},m=()=>{s(!1),i(null),l(!1)},y=H.useRef(null),x=()=>{if(!t)return;const[M,R]=t.coordinate;e({location:{lat:R,lng:M},locationSource:"map"}),m()},T=()=>{y.current?.click()},I=async M=>{const R=M.target.files?.[0];if(!(!R||!t)){try{const D=await zH(R),{thumbnailBase64:j}=await $D(R),k={id:KD(),thumbnailBase64:j,createdAt:new Date().toISOString(),pendingUpload:!0};if(D)e({location:D,locationSource:"photo",photos:[k]});else{const[A,L]=t.coordinate;e({location:{lat:L,lng:A},locationSource:"map",photos:[k]})}}catch(D){console.error("Failed to process photo:",D);const[j,k]=t.coordinate;e({location:{lat:k,lng:j},locationSource:"map"})}M.target.value="",m()}},S=()=>{if(!t)return;const[M,R]=t.coordinate,D=`https://www.google.com/maps?q=${R},${M}`;window.open(D,"_blank"),m()},b=()=>{if(!t)return;const[M,R]=t.coordinate,D=`https://www.google.com/maps?layer=c&cbll=${R},${M}`;window.open(D,"_blank"),m()},N=M=>{const[R,D]=M;return`${D.toFixed(5)}N, ${R.toFixed(5)}E`};return _.jsx(Gn,{children:r&&t&&_.jsxs(_.Fragment,{children:[_.jsx(Me.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),_.jsxs(Me.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[_.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[_.jsx(bl,{size:16}),_.jsx("span",{className:"text-xs font-mono",children:N(t.coordinate)})]})}),_.jsxs("div",{className:"bg-white",children:[_.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(jw,{size:20,className:"text-green-500"}),_.jsx("span",{className:"font-medium",children:"Maak foto"})]}),_.jsxs("button",{onClick:x,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Zs,{size:20,className:"text-orange-500"}),_.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),_.jsxs("button",{onClick:b,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(rH,{size:20,className:"text-yellow-600"}),_.jsx("span",{className:"font-medium",children:"Street View"})]}),_.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(UD,{size:20,className:"text-blue-600"}),_.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),_.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:I,className:"hidden"}),_.jsx("div",{className:"bg-white",children:_.jsxs("button",{onClick:m,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[_.jsx(bi,{size:18}),_.jsx("span",{children:"Annuleren"})]})})]})]})})}function KH(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=ri(),s=H.useCallback(l=>{i(l)},[i]),o=H.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return H.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function HH(){const{tracking:n,toggle:e}=KH();return _.jsx(Me.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:_.jsx(BK,{size:22,strokeWidth:2})})}const XH="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function qH(){const n=eo(y=>y.map),e=ri(y=>y.position),t=ri(y=>y.accuracy),i=ri(y=>y.tracking),r=ri(y=>y.smoothHeading),s=Qe(y=>y.showAccuracyCircle),o=ri(y=>y.firstFix),l=ri(y=>y.resetFirstFix),u=H.useRef(null),h=H.useRef(null),f=H.useRef(null),m=H.useMemo(()=>y=>new Qi({image:new D1({src:XH,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return H.useEffect(()=>{if(!n||!i&&!e)return;const y=ml([5.1214,52.0907]);return u.current=new cu({geometry:new pl(y)}),u.current.setStyle(m(0)),h.current=new cu({geometry:new pl(y)}),f.current=new U1({source:new N1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,m]),H.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=ml([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,T=Math.min(t/x,80);h.current.setStyle(new Qi({image:new Dl({radius:T,fill:new Ir({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Qi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),H.useEffect(()=>{if(!u.current)return;const y=r!==null?r*Math.PI/180:0;u.current.setStyle(m(y))},[r,m]),null}function YH(){const n=eo(M=>M.map),[e,t]=H.useState(!1),[i,r]=H.useState(""),[s,o]=H.useState([]),[l,u]=H.useState(!1),[h,f]=H.useState(!1),m=H.useRef(null),y=H.useRef(null),x=H.useRef();H.useEffect(()=>{e&&m.current&&m.current.focus()},[e]),H.useEffect(()=>{if(!e)return;const M=R=>{y.current&&!y.current.contains(R.target)&&T()};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[e]),H.useEffect(()=>{if(!e)return;const M=R=>{R.key==="Escape"&&T()};return document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)},[e]),H.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const R=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();R.response?.docs&&o(R.response.docs)}catch(M){console.error("Search error:",M),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const T=()=>{t(!1),r(""),o([]),u(!1)},I=async M=>{try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(M)}`)).json();if(D.response?.docs?.[0]?.centroide_ll){const k=D.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(R){console.error("Lookup error:",R)}return null},S=async M=>{if(!n)return;const R=await I(M.id);R&&n.getView().animate({center:ml([R.lng,R.lat]),zoom:16,duration:1e3}),T()},b=async(M,R)=>{R.stopPropagation();const D=await I(M.id);if(D){const j=`https://www.google.com/maps?q=${D.lat},${D.lng}`;window.open(j,"_blank")}T()},N={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?_.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:N,children:[_.jsxs(Me.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[_.jsx(j2,{size:18,className:"search-icon"}),_.jsx("input",{ref:m,type:"text",value:i,onChange:M=>{r(M.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),_.jsx("button",{onClick:T,className:"search-clear",title:"Sluiten",children:_.jsx(bi,{size:18})})]}),_.jsx(Gn,{children:l&&s.length>0&&_.jsx(Me.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(M=>_.jsxs("li",{className:"search-result-item",children:[_.jsx("div",{className:"search-result-content",onClick:()=>S(M),children:_.jsx("span",{className:"search-result-text",children:M.weergavenaam})}),_.jsx("button",{className:"search-navigate-btn",onClick:R=>b(M,R),title:"Open in Google Maps",children:_.jsx(UD,{size:20})})]},M.id))})}),l&&h&&_.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):_.jsx(Me.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:N,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:_.jsx(j2,{size:22,className:"text-gray-600"})})}function ZH({size:n=18}){return _.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function QH(){const[n,e]=H.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=si(),{user:r,loading:s,signInWithGoogle:o,logout:l}=OD(),u=Qe(S=>S.showCatchButton),h=Qe(S=>S.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},m=()=>e(!1),y=()=>{m(),t()},x=()=>{m(),i()},T=()=>{m(),o()},I=()=>{m(),l()};return _.jsxs(_.Fragment,{children:[_.jsx(Me.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?_.jsx(bi,{size:22,className:"text-white"}):_.jsx(YK,{size:22,className:"text-gray-600"})}),_.jsx(Gn,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Me.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),_.jsxs(Me.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[_.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?_.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:_.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?_.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?_.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):_.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:_.jsx(OH,{size:16,className:"text-white"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),_.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),_.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:_.jsx(KK,{size:16})})]})}):_.jsxs("button",{onClick:T,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[_.jsx(ZH,{size:18}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),_.jsx("div",{className:"py-1",children:_.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[_.jsx(zw,{size:18,className:"text-blue-500"}),_.jsx("span",{children:"Info & handleiding"})]})}),_.jsx("div",{className:"py-1 border-t border-gray-100",children:_.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx(Zs,{size:18,className:"text-green-500"}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),_.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),_.jsx("div",{className:"mt-auto border-t border-gray-100",children:_.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[_.jsx(xH,{size:18,className:"text-gray-500"}),_.jsx("span",{children:"Instellingen"})]})}),_.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function JH(){const{infoPanelOpen:n,toggleInfoPanel:e}=si(),[t,i]=H.useState("info"),r=[{id:"info",label:"Info",icon:_.jsx(zw,{size:14})},{id:"functies",label:"Functies",icon:_.jsx(kK,{size:14})},{id:"handleiding",label:"Handleiding",icon:_.jsx(aK,{size:14})}];return _.jsx(Gn,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Me.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),_.jsxs(Me.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),_.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:_.jsx(bi,{size:18,className:"text-white",strokeWidth:2.5})})]}),_.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>_.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&_.jsx(eX,{}),t==="functies"&&_.jsx(tX,{}),t==="handleiding"&&_.jsx(nX,{}),_.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:_.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function eX(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),_.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),_.jsxs("ul",{className:"space-y-2 text-gray-600",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),_.jsxs("div",{className:"text-gray-600 space-y-2",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function tX(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Sy,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Zs,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Registreer soort, gewicht en lengte"}),_.jsx("li",{children:"Vismethode en aas bijhouden"}),_.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),_.jsx("li",{children:"GPS locatie per vangst"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(bl,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Markeer je beste visplekken"}),_.jsx("li",{children:"Voeg notities en ratings toe"}),_.jsx("li",{children:"Welke vis zit waar?"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(pd,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live weergegevens op je locatie"}),_.jsx("li",{children:"Windsnelheid en richting"}),_.jsx("li",{children:"Luchtdruk"}),_.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(yd,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live GPS tracking"}),_.jsx("li",{children:"Zoek adressen en plaatsen"}),_.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function nX(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),_.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),_.jsxs("li",{children:["Gebruik het ",_.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[_.jsxs("li",{children:["Gebruik de ",_.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),_.jsxs("li",{children:["Check de ",_.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),_.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),_.jsxs("li",{children:["Markeer succesvolle plekken als ",_.jsx("strong",{children:"favoriet"})]})]})]})]})}const iX=ml([5.1214,52.0907]),rX=8;function sX(){const n=eo(r=>r.map),e=Zo(r=>r.setLayerVisibility),t=ri(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:iX,zoom:rX,rotation:0,duration:500})};return _.jsx(Me.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:_.jsx(hH,{size:18,className:"text-gray-600"})})}const oX={Map:Sy,Fish:Zs,Anchor:VD,Layers:Tp,Star:Rx},aX={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},lX={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function cX(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=vz(),[r,s]=H.useState(!1),[o,l]=H.useState(null),[u,h]=H.useState(!1),[f,m]=H.useState(""),y=I=>{e(I),s(!1)},x=(I,S)=>{I.stopPropagation();const{useLayerStore:b}=require("../../store"),N=b.getState().visible,M=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(R=>N[R]);t(S,{layers:M}),l(S),setTimeout(()=>l(null),2e3)},T=()=>{f.trim()&&(i(f.trim()),m(""),h(!1))};return _.jsxs(_.Fragment,{children:[_.jsx(Me.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?_.jsx(mK,{size:20,className:"text-blue-600"}):_.jsx(Tp,{size:20,className:"text-gray-600"})}),_.jsx(Gn,{children:r&&_.jsxs(_.Fragment,{children:[_.jsx(Me.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),_.jsxs(Me.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),_.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const S=oX[I.icon]||Tp,b=aX[I.icon]||"text-blue-600",N=lX[I.icon]||"hover:bg-blue-50",M=o===I.id;return _.jsxs("button",{onClick:()=>y(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${N} rounded text-left transition-colors border-0 outline-none bg-transparent ${M?"bg-green-50":""}`,children:[_.jsx(S,{size:16,className:`${b} flex-shrink-0`}),_.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),M?_.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:_.jsx(Sx,{size:14,className:"text-green-500"})}):_.jsx("span",{onClick:R=>x(R,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:_.jsx(mH,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),_.jsx("div",{className:"border-t border-gray-200 p-2",children:u?_.jsxs("div",{className:"flex gap-1",children:[_.jsx("input",{type:"text",value:f,onChange:I=>m(I.target.value),onKeyDown:I=>{I.key==="Enter"&&T(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),_.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):_.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[_.jsx(aH,{size:14}),_.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const B2={lat:52.1326,lng:5.2913};function uX({size:n=18,className:e=""}){return _.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[_.jsx("path",{d:"M3 12h18"}),_.jsx("path",{d:"M21 12c-1.5 0-3-1-3-3s1.5-3 3-3"}),_.jsx("path",{d:"M21 12c-1.5 0-3 1-3 3s1.5 3 3 3"}),_.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),_.jsx("path",{d:"M8 12l2-3"}),_.jsx("path",{d:"M8 12l2 3"}),_.jsx("path",{d:"M12 12l2-3"}),_.jsx("path",{d:"M12 12l2 3"}),_.jsx("path",{d:"M16 12l1.5-2"}),_.jsx("path",{d:"M16 12l1.5 2"})]})}function W2({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return _.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[_.jsx("defs",{children:_.jsx("clipPath",{id:i,children:_.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),_.jsxs("g",{clipPath:`url(#${i})`,children:[_.jsx("path",{d:"M6.5 12c0-3.5 3-6 7-6 2.5 0 4.5 1 6 2.5.8.8 1.5 1.8 2 3-.5 1.2-1.2 2.2-2 3-1.5 1.5-3.5 2.5-6 2.5-4 0-7-2.5-7-5z"}),_.jsx("path",{d:"M2.5 12l3-3v6l-3-3z"}),_.jsx("circle",{cx:"17",cy:"11",r:"1",fill:"white"})]})]})}function hX({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1>=.5,s=[];for(let o=0;o<i&&o<e;o++)s.push(_.jsx(W2,{size:16,className:t},o));return r&&i<e&&s.push(_.jsx(W2,{size:16,className:t,clipPercent:50},"half")),_.jsx("div",{className:"flex items-center gap-0.5",children:s.length>0?s:_.jsx(uX,{size:18,className:t})})}function HD({phase:n,size:e=20}){const t=n<.5,i=n<.5?n*2:(1-n)*2;return _.jsx("div",{className:"relative rounded-full bg-gray-700 overflow-hidden",style:{width:e,height:e},children:_.jsx("div",{className:"absolute inset-0 bg-yellow-100",style:{clipPath:t?`inset(0 ${(1-i)*100}% 0 0)`:`inset(0 0 0 ${(1-i)*100}%)`}})})}function dX({activity:n,label:e}){const t=()=>n>=.8?"bg-green-500":n>=.6?"bg-lime-500":n>=.4?"bg-amber-500":"bg-red-400";return _.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-[10px] text-gray-500 w-12",children:e}),_.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full ${t()} transition-all`,style:{width:`${n*100}%`}})})]})}function Ww(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function Ax(n){const e=Ww(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=[i,(i+12)%24],l=[r,s];let u=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(u+=.3),o.forEach(h=>{const f=Math.abs(t-h);f<=1||f>=23?u+=.3:(f<=2||f>=22)&&(u+=.15)}),l.forEach(h=>{const f=Math.abs(t-h);f<=.5?u+=.15:f<=1&&(u+=.08)}),{major:o,minor:l,overall:Math.min(1,u)}}function fX({data:n,onClose:e}){if(n.length===0)return null;const t=n.map(S=>S.pressure),i=Math.min(...t)-2,r=Math.max(...t)+2,s=r-i,o=300,l=120,u={top:10,right:10,bottom:25,left:35},h=o-u.left-u.right,f=l-u.top-u.bottom,m=n.map((S,b)=>{const N=u.left+b/(n.length-1)*h,M=u.top+f-(S.pressure-i)/s*f;return{x:N,y:M,time:S.time,pressure:S.pressure}}),y=m.map((S,b)=>`${b===0?"M":"L"} ${S.x} ${S.y}`).join(" "),x=new Date,T=n.findIndex(S=>new Date(S.time)>=x)||Math.floor(n.length/3),I=S=>new Date(S).getHours().toString().padStart(2,"0")+":00";return _.jsx(Me.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(Me.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:S=>S.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(jD,{size:18,className:"text-blue-500"}),"Luchtdruk (72 uur)"]}),_.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:18,className:"text-gray-500"})})]}),_.jsxs("svg",{width:o,height:l,className:"w-full",children:[[0,.25,.5,.75,1].map(S=>{const b=u.top+S*f,N=Math.round(r-S*s);return _.jsxs("g",{children:[_.jsx("line",{x1:u.left,y1:b,x2:o-u.right,y2:b,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsx("text",{x:u.left-4,y:b+4,fontSize:"9",fill:"#9ca3af",textAnchor:"end",children:N})]},S)}),[0,Math.floor(n.length/3),Math.floor(2*n.length/3),n.length-1].map(S=>{if(S>=n.length)return null;const b=u.left+S/(n.length-1)*h;return _.jsx("text",{x:b,y:l-5,fontSize:"8",fill:"#9ca3af",textAnchor:"middle",children:I(n[S].time)},S)}),_.jsx("path",{d:`${m.slice(0,T+1).map((S,b)=>`${b===0?"M":"L"} ${S.x} ${S.y}`).join(" ")} L ${m[T]?.x||u.left} ${l-u.bottom} L ${u.left} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.15)"}),T<m.length-1&&_.jsx("path",{d:`${m.slice(T).map((S,b)=>`${b===0?"M":"L"} ${S.x} ${S.y}`).join(" ")} L ${m[m.length-1].x} ${l-u.bottom} L ${m[T].x} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),_.jsx("path",{d:y,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),m[T]&&_.jsxs(_.Fragment,{children:[_.jsx("line",{x1:m[T].x,y1:u.top,x2:m[T].x,y2:l-u.bottom,stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:m[T].x,cy:m[T].y,r:"4",fill:"#f59e0b"}),_.jsx("text",{x:m[T].x,y:u.top-2,fontSize:"8",fill:"#f59e0b",textAnchor:"middle",children:"Nu"})]})]}),_.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Dalende druk = vaak beter bijten"})]})})}function gX({onClose:n}){const e=new Date,t=Ww(e),i=Ax(e),r=Array.from({length:24},(l,u)=>{const h=new Date(e);return h.setHours(u,0,0,0),{hour:u,activity:Ax(h).overall}}),s=l=>l<.03||l>.97?"Nieuwe maan":l<.22?"Wassende sikkel":l<.28?"Eerste kwartier":l<.47?"Wassende maan":l<.53?"Volle maan":l<.72?"Afnemende maan":l<.78?"Laatste kwartier":"Afnemende sikkel",o=l=>`${l.toString().padStart(2,"0")}:00`;return _.jsx(Me.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Me.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full max-h-[80vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:l=>l.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(eH,{size:18,className:"text-blue-500"}),"Solunar Activiteit"]}),_.jsx("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"flex items-center gap-3 mb-4 p-3 bg-gray-50 rounded-lg",children:[_.jsx(HD,{phase:t,size:40}),_.jsxs("div",{children:[_.jsx("div",{className:"font-medium text-gray-800",children:s(t)}),_.jsxs("div",{className:"text-xs text-gray-500",children:[Math.round(t*100),"% cyclus"]})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Beste tijden vandaag"}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{className:"bg-green-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Major periodes"}),_.jsx("div",{className:"text-sm text-green-800",children:i.major.map(l=>o(l)).join(", ")})]}),_.jsxs("div",{className:"bg-amber-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-amber-600 font-medium",children:"Minor periodes"}),_.jsx("div",{className:"text-sm text-amber-800",children:i.minor.map(l=>o(l)).join(", ")})]})]})]}),_.jsxs("div",{className:"mb-3",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Activiteit per uur"}),_.jsx("div",{className:"flex items-end gap-0.5 h-16",children:r.map(({hour:l,activity:u})=>_.jsx("div",{className:`flex-1 rounded-t transition-all ${u>=.7?"bg-green-500":u>=.5?"bg-lime-500":u>=.3?"bg-amber-500":"bg-red-400"} ${l===e.getHours()?"ring-2 ring-blue-500":""}`,style:{height:`${u*100}%`},title:`${o(l)}: ${Math.round(u*100)}%`},l))}),_.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400 mt-1",children:[_.jsx("span",{children:"00:00"}),_.jsx("span",{children:"06:00"}),_.jsx("span",{children:"12:00"}),_.jsx("span",{children:"18:00"}),_.jsx("span",{children:"24:00"})]})]}),_.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Gebaseerd op maanfase en -positie"})]})})}function mX(){const{current:n,loading:e,fetchWeather:t,getFishingCondition:i,getFishingScore:r,pressureHistory:s,getPressureTrend:o}=jd(),l=ri(j=>j.position),u=Qe(j=>j.showWeatherWidget),[h,f]=H.useState(!1),[m,y]=H.useState(!1),x={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(H.useEffect(()=>{const j=l||B2;t(j.lat,j.lng)},[]),H.useEffect(()=>{l&&t(l.lat,l.lng)},[l,t]),H.useEffect(()=>{const j=l||B2,k=setInterval(()=>{t(j.lat,j.lng)},600*1e3);return()=>clearInterval(k)},[l,t]),!u||!n&&!e)return null;const T=i(),I=r?r():T==="excellent"?3:T==="good"?2:T==="moderate"?1:0,S=Ax(new Date),b=Ww(new Date),N=Math.min(3,I/2+S.overall*1.5),M=j=>j>=2.5?"text-green-500":j>=1.5?"text-lime-500":j>=.8?"text-amber-500":"text-red-500",R=j=>j>=2.5?"bg-green-50 border-green-200":j>=1.5?"bg-lime-50 border-lime-200":j>=.8?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200",D=j=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(j/45)%8];return _.jsxs(_.Fragment,{children:[_.jsx(Me.div,{className:`fixed left-2 z-[700] bg-white/95 backdrop-blur-sm rounded-xl shadow-sm p-3 min-w-[140px] border ${R(N)}`,style:x,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e?_.jsx("div",{className:"text-sm text-gray-500",children:"Laden..."}):n?_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between pb-2 border-b border-gray-100",children:[_.jsx(hX,{value:N,color:M(N)}),_.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-1 p-1 hover:bg-white/50 rounded transition-colors border-0 outline-none bg-transparent",title:"Solunar info",children:[_.jsx(HD,{phase:b,size:16}),_.jsx(zD,{size:12,className:"text-gray-400"})]})]}),_.jsx(dX,{activity:S.overall,label:"Activiteit"}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(Uw,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(Bw,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",D(n.windDirection)]})]}),_.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-500 transition-colors w-full border-0 outline-none bg-transparent p-0",children:[_.jsx(jD,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const j=o();return j==="rising"?_.jsx(MH,{size:14,className:"text-green-500 ml-auto"}):j==="falling"?_.jsx(NH,{size:14,className:"text-red-500 ml-auto"}):_.jsx(QK,{size:14,className:"text-gray-400 ml-auto"})})()]})]}):null}),_.jsx(Gn,{children:h&&s.length>0&&_.jsx(fX,{data:s,onClose:()=>f(!1)})}),_.jsx(Gn,{children:m&&_.jsx(gX,{onClose:()=>y(!1)})})]})}function pX({embedded:n=!1}){const e=jd(l=>l.current);if(!Qe(l=>l.showWindIndicator)&&!n||!e)return null;const i=Math.round(e.windSpeed),r=e.windDirection,s=()=>i<12?"#22c55e":i<20?"#84cc16":i<30?"#eab308":i<40?"#f97316":"#ef4444",o=()=>i<5?"Stil":i<12?"Zwak":i<20?"Matig":i<30?"Vrij krachtig":i<40?"Krachtig":"Hard";return _.jsxs(Me.div,{className:`${n?"":"fixed top-14 right-2 z-[700]"} bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2`,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[_.jsxs("div",{className:"relative w-16 h-16",children:[_.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-gray-200"}),_.jsx("span",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-0.5 text-[8px] font-bold text-gray-400",children:"N"}),_.jsx("span",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-0.5 text-[8px] font-bold text-gray-400",children:"Z"}),_.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-0.5 text-[8px] font-bold text-gray-400",children:"W"}),_.jsx("span",{className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-0.5 text-[8px] font-bold text-gray-400",children:"O"}),_.jsx(Me.div,{className:"absolute inset-2 flex items-center justify-center",style:{transform:`rotate(${r}deg)`},animate:{rotate:r},transition:{type:"spring",stiffness:100},children:_.jsx("svg",{viewBox:"0 0 24 24",className:"w-full h-full",style:{color:s()},children:_.jsx("path",{d:"M12 2l-6 10h4v10h4V12h4L12 2z",fill:"currentColor"})})}),_.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:_.jsx("div",{className:"bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm",children:_.jsx("span",{className:"text-xs font-bold",style:{color:s()},children:i})})})]}),_.jsx("div",{className:"text-center mt-1",children:_.jsx("span",{className:"text-[10px] text-gray-500",children:o()})})]})}const _d=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664}];function yX(n,e,t){const i=[],r=29.53058867,s=new Date("2000-01-06T18:14:00Z"),o=t.lng/15*60,l=745;for(let u=0;u<e;u++){const h=new Date(n);h.setDate(h.getDate()+u),h.setHours(0,0,0,0);const m=(h.getTime()-s.getTime())/(1e3*60*60*24)%r/r;let y=m*l*2%1440;y=(y+o)%1440;for(let x=0;x<4;x++){const T=x%2===0,I=x*(l/2);let S=y+I;const b=Math.floor(S/1440);S=S%1440;const N=Math.floor(S/60),M=Math.floor(S%60),R=new Date(h);R.setDate(R.getDate()+b),R.setHours(N,M,0,0);const D=Math.abs(Math.sin(m*Math.PI*2)),j=T?1.8:.4,k=D*.5;i.push({time:R,height:T?j+k:j-k*.5,type:T?"high":"low"})}}return i.sort((u,h)=>u.time.getTime()-h.time.getTime())}function _X(n,e){let t=_d[0],i=1/0;for(const r of _d){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}function bx(n,e){if(e.length<2)return 1;let t=e[0],i=e[1];for(let u=0;u<e.length-1;u++)if(e[u].time<=n&&e[u+1].time>n){t=e[u],i=e[u+1];break}const r=i.time.getTime()-t.time.getTime(),s=n.getTime()-t.time.getTime(),o=Math.max(0,Math.min(1,s/r)),l=(1-Math.cos(o*Math.PI))/2;return t.height+(i.height-t.height)*l}function vX({embedded:n=!1}){const[e,t]=H.useState(!1),[i,r]=H.useState(_d[5]),[s,o]=H.useState(new Date),[l,u]=H.useState(!1),h=ri(D=>D.position),f=Qe(D=>D.showTideWidget);H.useEffect(()=>{h&&r(_X(h.lat,h.lng))},[h]);const m=H.useMemo(()=>{const D=new Date;return D.setDate(D.getDate()-2),D.setHours(0,0,0,0),yX(D,5,i)},[i]);if(H.useEffect(()=>{if(!l)return;const D=setInterval(()=>{o(j=>{const k=new Date(j.getTime()+18e5),A=new Date;return A.setDate(A.getDate()+2),A.setHours(23,59,59,999),k>A?(u(!1),A):k})},100);return()=>clearInterval(D)},[l]),!f&&!n)return null;const y=new Date,x=bx(y,m);m.find(D=>D.time>y);const T=new Date;T.setDate(T.getDate()-2),T.setHours(0,0,0,0);const I=new Date;I.setDate(I.getDate()+2),I.setHours(23,59,59,999);const S=I.getTime()-T.getTime(),b=(s.getTime()-T.getTime())/S*100,N=D=>{const j=new Date(T.getTime()+D/100*S);o(j)},M=D=>{const j=new Date,k=Math.floor((D.getTime()-j.setHours(0,0,0,0))/(1440*60*1e3));return k===0?"Vandaag":k===1?"Morgen":k===-1?"Gisteren":k===2?"Overmorgen":k===-2?"Eergisteren":D.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"})},R=D=>D.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return _.jsxs(_.Fragment,{children:[_.jsxs(Me.button,{className:`${n?"":"fixed top-28 right-2 z-[700]"} bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none`,onClick:()=>t(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(Qd,{size:18,className:"text-blue-500"}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[80px]",children:i.name}),_.jsxs("div",{className:"text-xs font-medium text-blue-600",children:[x.toFixed(1),"m"]})]})]}),_.jsx(Gn,{children:e&&_.jsx(Me.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>t(!1),children:_.jsxs(Me.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:D=>D.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Qd,{size:20,className:"text-white"}),_.jsx("span",{className:"font-semibold text-white",children:"Getijden"})]}),_.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("select",{value:i.id,onChange:D=>{const j=_d.find(k=>k.id===D.target.value);j&&r(j)},className:"flex-1 p-2 border border-gray-200 rounded-lg text-sm bg-white",children:_d.map(D=>_.jsx("option",{value:D.id,children:D.name},D.id))})}),_.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-sm text-gray-500",children:M(s)}),_.jsx("div",{className:"text-2xl font-bold text-blue-600",children:R(s)})]}),_.jsxs("div",{className:"text-right",children:[_.jsx("div",{className:"text-sm text-gray-500",children:"Waterstand"}),_.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[bx(s,m).toFixed(2),"m"]})]})]})}),_.jsx(xX,{tides:m,selectedTime:s,minTime:T,maxTime:I,onTimeSelect:D=>o(D)}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[_.jsx("span",{children:M(T)}),_.jsx("span",{className:"font-medium text-blue-500",children:"Nu"}),_.jsx("span",{children:M(I)})]}),_.jsx("input",{type:"range",min:"0",max:"100",value:b,onChange:D=>N(parseFloat(D.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #93c5fd 0%, #93c5fd 40%, #3b82f6 40%, #3b82f6 ${b}%, #e5e7eb ${b}%, #e5e7eb 100%)`}})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("button",{onClick:()=>{const D=new Date(T);o(D)},className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(dK,{size:20})}),_.jsx("button",{onClick:()=>u(!l),className:"p-3 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors border-0 outline-none",children:l?_.jsx(BD,{size:20}):_.jsx(WD,{size:20})}),_.jsx("button",{onClick:()=>o(new Date),className:"px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none bg-transparent font-medium",children:"Nu"}),_.jsx("button",{onClick:()=>{const D=new Date(I);o(D)},className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(zD,{size:20})})]}),_.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[_.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Volgende getijden"}),_.jsx("div",{className:"grid grid-cols-4 gap-2",children:m.filter(D=>D.time>y).slice(0,4).map((D,j)=>_.jsxs("button",{onClick:()=>o(D.time),className:`p-2 rounded-lg text-center transition-colors border-0 outline-none ${D.type==="high"?"bg-green-50 hover:bg-green-100":"bg-red-50 hover:bg-red-100"}`,children:[_.jsx("div",{className:`text-[10px] font-medium ${D.type==="high"?"text-green-600":"text-red-600"}`,children:D.type==="high"?"HW":"LW"}),_.jsx("div",{className:"text-xs font-medium",children:R(D.time)}),_.jsxs("div",{className:"text-[10px] text-gray-500",children:[D.height.toFixed(1),"m"]})]},j))})]}),_.jsx("div",{className:"text-xs text-gray-400 text-center",children:"Bron: berekening gebaseerd op maanstand  Alleen ter indicatie"})]})]})})})]})}function xX({tides:n,selectedTime:e,minTime:t,maxTime:i,onTimeSelect:r}){const l={top:20,right:15,bottom:30,left:40},u=400-l.left-l.right,h=150-l.top-l.bottom,f=i.getTime()-t.getTime(),m=new Date,y=[],x=240;for(let R=0;R<=x;R++){const D=new Date(t.getTime()+R/x*f),j=bx(D,n),k=l.left+R/x*u,A=l.top+h-(j-.2)/2.3*h;y.push({x:k,y:A,time:D,height:j})}const T=y.map((R,D)=>`${D===0?"M":"L"} ${R.x} ${R.y}`).join(" "),I=l.left+(m.getTime()-t.getTime())/f*u,S=l.left+(e.getTime()-t.getTime())/f*u,b=y.find(R=>Math.abs(R.time.getTime()-e.getTime())<1800*1e3)?.y||l.top,N=[];for(let R=-2;R<=2;R++){const D=new Date;D.setDate(D.getDate()+R),D.setHours(0,0,0,0);const j=l.left+(D.getTime()-t.getTime())/f*u,k=R===0?"Vandaag":R===1?"Morgen":R===-1?"Gisteren":"";N.push({x:j,label:k})}const M=R=>{const D=R.currentTarget.getBoundingClientRect(),k=(R.clientX-D.left-l.left)/u;if(k>=0&&k<=1){const A=new Date(t.getTime()+k*f);r(A)}};return _.jsxs("svg",{width:400,height:150,className:"w-full cursor-crosshair",onClick:M,children:[[.5,1,1.5,2].map(R=>{const D=l.top+h-(R-.2)/2.3*h;return _.jsxs("g",{children:[_.jsx("line",{x1:l.left,y1:D,x2:400-l.right,y2:D,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsxs("text",{x:l.left-5,y:D+4,fontSize:"10",fill:"#9ca3af",textAnchor:"end",children:[R,"m"]})]},R)}),N.map((R,D)=>_.jsxs("g",{children:[_.jsx("line",{x1:R.x,y1:l.top,x2:R.x,y2:150-l.bottom,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"4,4"}),R.label&&_.jsx("text",{x:R.x+5,y:140,fontSize:"9",fill:"#6b7280",children:R.label})]},D)),_.jsx("path",{d:`${y.filter(R=>R.time<=m).map((R,D)=>`${D===0?"M":"L"} ${R.x} ${R.y}`).join(" ")} L ${I} ${150-l.bottom} L ${l.left} ${150-l.bottom} Z`,fill:"rgba(59, 130, 246, 0.2)"}),_.jsx("path",{d:`M ${I} ${y.find(R=>R.time>=m)?.y||l.top} ${y.filter(R=>R.time>m).map(R=>`L ${R.x} ${R.y}`).join(" ")} L ${400-l.right} ${150-l.bottom} L ${I} ${150-l.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),_.jsx("path",{d:T,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),n.map((R,D)=>{const j=l.left+(R.time.getTime()-t.getTime())/f*u,k=l.top+h-(R.height-.2)/2.3*h;return j<l.left||j>400-l.right?null:_.jsx("circle",{cx:j,cy:k,r:"4",fill:R.type==="high"?"#22c55e":"#ef4444",stroke:"white",strokeWidth:"2"},D)}),_.jsx("line",{x1:I,y1:l.top,x2:I,y2:150-l.bottom,stroke:"#f59e0b",strokeWidth:"2"}),_.jsx("text",{x:I,y:l.top-5,fontSize:"9",fill:"#f59e0b",textAnchor:"middle",fontWeight:"bold",children:"NU"}),_.jsx("line",{x1:S,y1:l.top,x2:S,y2:150-l.bottom,stroke:"#8b5cf6",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:S,cy:b,r:"6",fill:"#8b5cf6",stroke:"white",strokeWidth:"2"})]})}function G2(n){return n===0?_.jsx(RH,{size:16,className:"text-yellow-500"}):n<=3?_.jsx(pd,{size:16,className:"text-gray-400"}):n<=49?_.jsx(pd,{size:16,className:"text-gray-500"}):n<=69?_.jsx(xK,{size:16,className:"text-blue-500"}):n<=79?_.jsx(EK,{size:16,className:"text-cyan-500"}):n<=99?_.jsx(_K,{size:16,className:"text-purple-500"}):_.jsx(pd,{size:16,className:"text-gray-400"})}function wX(n){return n===0?"Helder":n<=3?"Bewolkt":n<=49?"Mist":n<=59?"Motregen":n<=69?"Regen":n<=79?"Sneeuw":n<=99?"Onweer":"Onbekend"}function EX({embedded:n=!1}){const e=jd(N=>N.hourlyForecast),t=jd(N=>N.getWeatherAtTime),i=Qe(N=>N.showForecastSlider),[r,s]=H.useState(!1),[o,l]=H.useState(0),[u,h]=H.useState(!1),f=new Date,m=e.findIndex(N=>new Date(N.time)>=f),y=o-24,x=new Date(f.getTime()+y*60*60*1e3),T=t(x);if(H.useEffect(()=>{if(!u)return;const N=setInterval(()=>{l(M=>M>=72?(h(!1),72):M+1)},200);return()=>clearInterval(N)},[u]),!i&&!n||e.length===0)return null;const I=N=>N.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),S=N=>{const M=new Date,R=new Date(M);R.setDate(R.getDate()+1);const D=new Date(M);return D.setDate(D.getDate()-1),N.toDateString()===M.toDateString()?"Vandaag":N.toDateString()===R.toDateString()?"Morgen":N.toDateString()===D.toDateString()?"Gisteren":N.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},b=N=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(N/45)%8];return _.jsxs(_.Fragment,{children:[_.jsxs(Me.button,{className:`${n?"":"fixed top-40 right-2 z-[700]"} bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none`,onClick:()=>s(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(Ix,{size:18,className:"text-blue-500"}),_.jsx("span",{className:"text-xs text-gray-600",children:"Forecast"})]}),_.jsx(Gn,{children:r&&_.jsx(Me.div,{className:"fixed inset-0 z-[2000] flex items-end justify-center bg-black/30",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1),children:_.jsxs(Me.div,{className:"bg-white rounded-t-2xl shadow-xl p-4 w-full max-w-md",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:N=>N.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(Ix,{size:18,className:"text-blue-500"}),"Weersvoorspelling"]}),_.jsx("button",{onClick:()=>s(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-lg font-bold text-gray-800",children:I(x)}),_.jsx("div",{className:"text-sm text-gray-500",children:S(x)})]}),T&&_.jsxs("div",{className:"flex items-center gap-2",children:[G2(T.weatherCode),_.jsx("span",{className:"text-sm text-gray-600",children:wX(T.weatherCode)})]})]}),T&&_.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-3",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Uw,{size:16,className:"text-orange-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(T.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Bw,{size:16,className:"text-blue-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(T.windSpeed)," km/u"]})]}),_.jsx("div",{className:"text-right text-sm text-gray-500",children:b(T.windDirection)})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[_.jsx("span",{children:"-24u"}),_.jsx("span",{className:"font-medium text-blue-500",children:"Nu"}),_.jsx("span",{children:"+48u"})]}),_.jsxs("div",{className:"relative",children:[_.jsx("input",{type:"range",min:"0",max:"72",value:o,onChange:N=>l(parseInt(N.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, #93c5fd 0%, #93c5fd ${24/72*100}%, #3b82f6 ${24/72*100}%, #3b82f6 ${o/72*100}%, #e5e7eb ${o/72*100}%, #e5e7eb 100%)`}}),_.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-1 h-4 bg-blue-600 rounded",style:{left:`${24/72*100}%`}})]})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("button",{onClick:()=>l(0),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Start"}),_.jsx("button",{onClick:()=>h(!u),className:"p-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors border-0 outline-none",children:u?_.jsx(BD,{size:16}):_.jsx(WD,{size:16})}),_.jsx("button",{onClick:()=>l(24),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Nu"})]}),_.jsx("div",{className:"mt-4 overflow-x-auto",children:_.jsx("div",{className:"flex gap-2 pb-2",children:e.slice(m,m+12).map((N,M)=>{const R=new Date(N.time),D=Math.abs(R.getTime()-x.getTime())<1800*1e3;return _.jsxs("button",{onClick:()=>{const j=(R.getTime()-f.getTime())/36e5;l(24+Math.round(j))},className:`flex flex-col items-center p-2 rounded-lg min-w-[50px] transition-colors border-0 outline-none ${D?"bg-blue-100":"bg-gray-50 hover:bg-gray-100"}`,children:[_.jsxs("span",{className:"text-[10px] text-gray-500",children:[R.getHours().toString().padStart(2,"0"),":00"]}),G2(N.weatherCode),_.jsxs("span",{className:"text-xs font-medium",children:[Math.round(N.temperature),""]})]},M)})})})]})})})]})}function TX({embedded:n=!1}){const[e,t]=H.useState(!1),{station:i,waterData:r,lastUpdated:s,isLoading:o,fetchData:l,setStation:u,setStationByPosition:h}=Y$(),f=ri(I=>I.position),m=Qe(I=>I.showWaterDataWidget);if(H.useEffect(()=>{f&&h(f.lat,f.lng)},[f,h]),H.useEffect(()=>{l();const I=setInterval(l,600*1e3);return()=>clearInterval(I)},[l,i]),!m&&!n)return null;const y=I=>I<8?"text-blue-600":I<14?"text-cyan-500":I<18?"text-green-500":"text-orange-500",x=I=>I<30?"Kalm":I<60?"Licht":I<100?"Matig":I<150?"Ruw":"Hoog",T=I=>I<30?"text-green-500":I<60?"text-green-400":I<100?"text-yellow-500":I<150?"text-orange-500":"text-red-500";return _.jsxs(_.Fragment,{children:[_.jsxs(Me.button,{className:`${n?"":"fixed top-52 right-2 z-[700]"} bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none`,onClick:()=>t(!0),whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,x:20},animate:{opacity:1,x:0},children:[_.jsx(Cx,{size:18,className:"text-cyan-500"}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[80px]",children:i?.name||"Water"}),r?.temperature!==void 0&&_.jsxs("div",{className:`text-xs font-medium ${y(r.temperature)}`,children:[r.temperature.toFixed(1),"C"]})]})]}),_.jsx(Gn,{children:e&&_.jsx(Me.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>t(!1),children:_.jsxs(Me.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-sm max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:I=>I.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-cyan-500 to-blue-500",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Cx,{size:20,className:"text-white"}),_.jsx("span",{className:"font-semibold text-white",children:"Waterdata"})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("button",{onClick:()=>l(),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",disabled:o,children:_.jsx(cH,{size:18,className:`text-white ${o?"animate-spin":""}`})}),_.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:20,className:"text-white"})})]})]}),_.jsxs("div",{className:"p-4 space-y-4",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("select",{value:i?.id||"",onChange:I=>{const S=Zd.find(b=>b.id===I.target.value);S&&u(S)},className:"flex-1 p-2 border border-gray-200 rounded-lg text-sm bg-white",children:Zd.map(I=>_.jsx("option",{value:I.id,children:I.name},I.id))})}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(Uw,{size:18,className:"text-cyan-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Watertemperatuur"})]}),r?.temperature!==void 0?_.jsxs("div",{className:`text-2xl font-bold ${y(r.temperature)}`,children:[r.temperature.toFixed(1),"C"]}):_.jsx("div",{className:"text-gray-400",children:"-"}),_.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:r?.temperature!==void 0&&(r.temperature<10?"Koud - minder activiteit":r.temperature<15?"Goed voor roofvis":"Warm - actieve vis")})]}),_.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(Qd,{size:18,className:"text-blue-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Golfhoogte"})]}),r?.waveHeight!==void 0?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:`text-2xl font-bold ${T(r.waveHeight)}`,children:[r.waveHeight," cm"]}),_.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:x(r.waveHeight)})]}):_.jsx("div",{className:"text-gray-400",children:"-"})]}),_.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(yd,{size:18,className:"text-green-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Stroomsnelheid"})]}),r?.currentSpeed!==void 0?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[r.currentSpeed," cm/s"]}),_.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:r.currentSpeed<20?"Zwak":r.currentSpeed<50?"Matig":"Sterk"})]}):_.jsx("div",{className:"text-gray-400",children:"-"})]}),_.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(yd,{size:18,className:"text-purple-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Stroomrichting"})]}),r?.currentDirection!==void 0?_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"w-8 h-8 flex items-center justify-center",style:{transform:`rotate(${r.currentDirection}deg)`},children:_.jsx(yd,{size:24,className:"text-purple-500",fill:"currentColor"})}),_.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[Math.round(r.currentDirection),""]})]}):_.jsx("div",{className:"text-gray-400",children:"-"})]})]}),r?.temperature!==void 0&&_.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[_.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Visactiviteit"}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full transition-all ${r.temperature<5?"w-1/6 bg-blue-500":r.temperature<10?"w-2/6 bg-cyan-500":r.temperature<15?"w-4/6 bg-green-500":r.temperature<20?"w-5/6 bg-yellow-500":"w-3/6 bg-orange-500"}`})}),_.jsx("span",{className:"text-xs text-gray-500",children:r.temperature<5?"Zeer laag":r.temperature<10?"Laag":r.temperature<15?"Goed":r.temperature<20?"Uitstekend":"Goed"})]})]}),_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx(zw,{size:12}),_.jsx("span",{children:"Bron: Rijkswaterstaat"})]}),s&&_.jsxs("span",{children:["Bijgewerkt: ",s.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]})]})]})]})})})]})}function SX(){const n=Qe(I=>I.showWindIndicator),e=Qe(I=>I.showTideWidget),t=Qe(I=>I.showForecastSlider),i=Qe(I=>I.showWaterDataWidget),[r,s]=H.useState(["wind","tide","forecast","waterData"]),[o,l]=H.useState(!1),u=H.useRef(null),h={wind:n,tide:e,forecast:t,waterData:i},f={wind:_.jsx(pX,{embedded:!0}),tide:_.jsx(vX,{embedded:!0}),forecast:_.jsx(EX,{embedded:!0}),waterData:_.jsx(TX,{embedded:!0})},m=r.filter(I=>h[I]),y=()=>{u.current=setTimeout(()=>{l(!0)},500)},x=()=>{u.current&&(clearTimeout(u.current),u.current=null)},T=()=>{setTimeout(()=>l(!1),100)};return m.length===0?null:_.jsx("div",{className:"fixed right-2 z-[700]",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:_.jsx(GV,{axis:"y",values:m,onReorder:I=>{const S=r.map(b=>h[b]?I.shift():b);s(S)},className:"flex flex-col gap-1.5",children:_.jsx(Gn,{children:m.map(I=>_.jsxs(XV,{value:I,dragListener:o,onMouseDown:y,onMouseUp:x,onMouseLeave:x,onTouchStart:y,onTouchEnd:x,onDragEnd:T,className:`relative ${o?"cursor-grab":""}`,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},whileDrag:{scale:1.02,boxShadow:"0 4px 20px rgba(0,0,0,0.15)"},children:[o&&_.jsx("div",{className:"absolute -left-6 top-1/2 -translate-y-1/2 text-gray-400",children:_.jsx(MK,{size:16})}),f[I]]},I))})})})}const Sp=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],IX=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],CX=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],ov=5;function RX({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=H.useRef(null),s=H.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=ov-n.length,m=Array.from(h).slice(0,f);for(const y of m)try{const{thumbnailBase64:x}=await $D(y),T={id:KD(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(T)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<ov;return _.jsxs("div",{className:"space-y-2",children:[_.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",ov,")"]}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>_.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[_.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&_.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:_.jsx(bi,{size:12,className:"text-white"})}),u.pendingUpload&&_.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&_.jsxs(_.Fragment,{children:[_.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[_.jsx(jw,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),_.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[_.jsx(OK,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),_.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),_.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const AX={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function bX(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,m=0,y=0,x=0,T=0,I=0;const S=h.length/4;for(let R=0;R<h.length;R+=4){const D=h[R],j=h[R+1],k=h[R+2];f+=D,m+=j,j>D&&j>k&&y++,D>100&&j>80&&j<150&&k<100&&x++,D>150&&j>150&&k>150&&T++,D<80&&j<80&&k<80&&I++}const b=[];y/S>.2&&b.push("green"),x/S>.2&&b.push("brown"),T/S>.2&&b.push("silver"),I/S>.3&&b.push("dark");const N=f/S,M=m/S;N>150&&M>100&&M<180&&b.push("gold"),e(b)},t.src=n})}function PX(n){const e=[];for(const[t,i]of Object.entries(AX)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function kX(n){try{const e=await bX(n),t=PX(e);if(t.length===0)return{species:"",confidence:0,suggestions:Sp.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:Sp.slice(0,5).map(t=>t.name)}}}function NX(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function DX({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=ek(ie=>ie.addCatch),s=jd(ie=>ie.current),o=ri(ie=>ie.position),[l,u]=H.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=H.useState(t||(o?"gps":null)),[m,y]=H.useState(""),[x,T]=H.useState(""),[I,S]=H.useState(""),[b,N]=H.useState(""),[M,R]=H.useState(""),[D,j]=H.useState(""),[k,A]=H.useState(i),[L,V]=H.useState(!1),[z,B]=H.useState([]),[O,le]=H.useState(0),me=async ie=>{if(A(pe=>[...pe,ie]),ie.dataUrl&&!m){V(!0);try{const pe=await kX(ie.dataUrl);if(B(pe.suggestions),le(pe.confidence),pe.species&&pe.confidence>.4){y(pe.species);const xe=NX(pe.species)}}catch(pe){console.error("AI recognition failed:",pe)}finally{V(!1)}}},ge=ie=>{y(ie),B([])},ue=ie=>{A(pe=>pe.filter(xe=>xe.id!==ie))},Q=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},se=ie=>{if(ie.preventDefault(),!m||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:m,weight:x?parseInt(x):void 0,length:I?parseInt(I):void 0,photos:k.length>0?k:void 0,method:b||"Anders",bait:M||void 0,notes:D||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},G=(()=>{switch(h){case"gps":return{icon:yd,label:"GPS",color:"text-blue-500"};case"photo":return{icon:jw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:Sy,label:"Kaart",color:"text-orange-500"};default:return{icon:bl,label:"Locatie",color:"text-gray-500"}}})(),$=G.icon;return _.jsx(Me.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Me.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ie=>ie.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Zs,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(bi,{size:20})})]}),_.jsxs("form",{onSubmit:se,className:"p-4 space-y-4",children:[_.jsx("div",{className:"space-y-2",children:l?_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx($,{size:16,className:G.color}),_.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),_.jsx("span",{className:`text-xs ${G.color} font-medium`,children:G.label})]}):_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(bl,{size:16}),_.jsx("span",{children:"Geen locatie"})]}),o&&_.jsx("button",{type:"button",onClick:Q,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",L&&_.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[_.jsx(zK,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),_.jsx(Gn,{children:z.length>0&&!m&&_.jsxs(Me.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[_.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[_.jsx(SH,{size:12}),_.jsxs("span",{children:["AI suggesties ",O>.3?`(${Math.round(O*100)}% zeker)`:""]})]}),_.jsx("div",{className:"flex flex-wrap gap-1",children:z.map(ie=>_.jsx("button",{type:"button",onClick:()=>ge(ie),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:ie},ie))})]})}),_.jsxs("select",{value:m,onChange:ie=>{y(ie.target.value),B([])},className:"form-select",required:!0,children:[_.jsx("option",{value:"",children:"Selecteer vissoort..."}),Sp.map(ie=>_.jsx("option",{value:ie.name,children:ie.name},ie.name))]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(yH,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),_.jsx("input",{type:"number",value:x,onChange:ie=>T(ie.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(fH,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),_.jsx("input",{type:"number",value:I,onChange:ie=>S(ie.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),_.jsxs("select",{value:b,onChange:ie=>N(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer methode..."}),IX.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),_.jsxs("select",{value:M,onChange:ie=>R(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer aas..."}),CX.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:D,onChange:ie=>j(ie.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),_.jsx(RX,{photos:k,onAddPhoto:me,onRemovePhoto:ue}),_.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function MX(){const n=si(h=>h.catchFormOpen),e=si(h=>h.catchFormLocation),t=si(h=>h.catchFormLocationSource),i=si(h=>h.catchFormInitialPhotos),r=si(h=>h.openCatchForm),s=si(h=>h.closeCatchForm),o=ri(h=>h.position),l=Qe(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return _.jsxs(_.Fragment,{children:[l&&_.jsx(Me.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:_.jsx(Zs,{size:22,strokeWidth:2})}),_.jsx(Gn,{children:n&&_.jsx(DX,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function LX(){const n=eo(r=>r.map),e=ek(r=>r.catches),t=H.useRef(null),i=H.useRef(null);return H.useEffect(()=>{if(n)return i.current=new N1,t.current=new U1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),H.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=ml([r.location.lng,r.location.lat]),o=new cu({geometry:new pl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Qi({image:new Dl({radius:14,fill:new Ir({color:"#22c55e"}),stroke:new Du({color:"#fff",width:2})}),text:new uf({text:l,font:"bold 12px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function OX(){const n=eo(r=>r.map),e=tk(r=>r.spots),t=H.useRef(null),i=H.useRef(null);return H.useEffect(()=>{if(n)return i.current=new N1,t.current=new U1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),H.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=ml([r.location.lng,r.location.lat]),o=new cu({geometry:new pl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Qi({image:new Dl({radius:12,fill:new Ir({color:l}),stroke:new Du({color:"#fff",width:2})}),text:new uf({text:"",font:"bold 14px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function FX({onClose:n,initialLocation:e}){const t=tk(S=>S.addSpot),[i,r]=H.useState(""),[s,o]=H.useState(""),[l,u]=H.useState([]),[h,f]=H.useState(""),[m,y]=H.useState(3),x=e,T=S=>{u(b=>b.includes(S)?b.filter(N=>N!==S):[...b,S])},I=S=>{if(S.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:m}),n()};return _.jsx(Me.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Me.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:S=>S.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Rx,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(bi,{size:20})})]}),_.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[x&&_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[_.jsx(bl,{size:16}),_.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),_.jsx("input",{type:"text",value:i,onChange:S=>r(S.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),_.jsx("input",{type:"text",value:s,onChange:S=>o(S.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),_.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(S=>_.jsx("button",{type:"button",onClick:()=>y(S),className:"p-1 border-0 outline-none bg-transparent",children:_.jsx(Rx,{size:28,className:S<=m?"text-yellow-400 fill-yellow-400":"text-gray-300"})},S))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:Sp.slice(0,12).map(S=>_.jsx("button",{type:"button",onClick:()=>T(S.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(S.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.name))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:h,onChange:S=>f(S.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),_.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const VX=[{name:"Aanlegsteigers",icon:VD,color:"#2196F3"},{name:"Boothellingen",icon:EH,color:"#4CAF50"},{name:"Dieptekaart",icon:Qd,color:"#00BCD4"},{name:"Viswater",icon:bl,color:"#9C27B0"}],$2=[{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function jX(){const[n,e]=H.useState(!1),t=Zo(l=>l.visible),i=Zo(l=>l.toggleLayer),r=Zo(l=>l.setLayerVisibility),s=l=>{$2.forEach(u=>{r(u.name,u.name===l)}),l==="Luchtfoto"?r("Labels Overlay",!0):r("Labels Overlay",!1)},o=()=>{r("Labels Overlay",!t["Labels Overlay"])};return _.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[_.jsx(Me.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:_.jsx(Tp,{size:22})}),_.jsx(Gn,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Me.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),_.jsxs(Me.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg overflow-hidden min-w-[200px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})}),_.jsxs("div",{className:"p-2",children:[_.jsxs("div",{className:"mb-2 pb-2 border-b border-gray-100",children:[_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Achtergrond"}),_.jsx("div",{className:"flex gap-1",children:$2.map(l=>_.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[l.name]?"bg-blue-500 text-white":"bg-transparent text-gray-600 hover:bg-blue-50"}`,onClick:()=>s(l.name),children:l.label},l.name))}),t.Luchtfoto&&_.jsxs("button",{onClick:o,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[_.jsxs("span",{className:"flex items-center gap-1.5",children:[_.jsx(bH,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&_.jsx(Sx,{size:12})]})]}),_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Kaartlagen"}),_.jsx("div",{className:"space-y-0.5",children:VX.map(l=>{const u=l.icon,h=t[l.name];return _.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors border-0 outline-none ${h?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>i(l.name),children:[_.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center transition-colors",style:{backgroundColor:h?l.color:"#e5e7eb"},children:_.jsx(u,{size:14,className:"text-white"})}),_.jsx("span",{className:`text-sm ${h?"text-blue-700":"text-gray-600"}`,children:l.name}),_.jsx("div",{className:"ml-auto",children:_.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center transition-all",style:{backgroundColor:h?"#3b82f6":"transparent",border:h?"2px solid #3b82f6":"2px solid #93c5fd"},children:h&&_.jsx(Sx,{size:10,className:"text-white",strokeWidth:3})})})]},l.name)})})]})]})]})})]})}function zX(){const n=si(R=>R.settingsPanelOpen),e=si(R=>R.toggleSettingsPanel),t=Qe(R=>R.showCatchButton),i=Qe(R=>R.setShowCatchButton),r=Qe(R=>R.showCatches),s=Qe(R=>R.setShowCatches),o=Qe(R=>R.showFavoriteSpots),l=Qe(R=>R.setShowFavoriteSpots),u=Qe(R=>R.defaultBackground),h=Qe(R=>R.setDefaultBackground),f=Qe(R=>R.showWeatherWidget),m=Qe(R=>R.setShowWeatherWidget),y=Qe(R=>R.showWindIndicator),x=Qe(R=>R.setShowWindIndicator),T=Qe(R=>R.showTideWidget),I=Qe(R=>R.setShowTideWidget),S=Qe(R=>R.showForecastSlider),b=Qe(R=>R.setShowForecastSlider),N=Qe(R=>R.showWaterDataWidget),M=Qe(R=>R.setShowWaterDataWidget);return n?_.jsx(Me.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(Me.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:R=>R.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),_.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:_.jsx(bi,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),_.jsx(Oo,{icon:_.jsx(Zs,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),_.jsx(Oo,{icon:_.jsx(Zs,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),_.jsx(Oo,{icon:_.jsx(bl,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:_.jsx(Sy,{size:18,className:"text-gray-500"})}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),_.jsxs("select",{value:u,onChange:R=>h(R.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[_.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),_.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer & Water"}),_.jsx(Oo,{icon:_.jsx(pd,{size:18,className:"text-blue-400"}),label:"Weer widget",description:"Temperatuur, wind, luchtdruk en solunar",checked:f,onChange:m}),_.jsx(Oo,{icon:_.jsx(Bw,{size:18,className:"text-cyan-500"}),label:"Wind kompas",description:"Windrichting en snelheid indicator",checked:y,onChange:x}),_.jsx(Oo,{icon:_.jsx(Qd,{size:18,className:"text-blue-500"}),label:"Getijden",description:"Hoog- en laagwater tijden",checked:T,onChange:I}),_.jsx(Oo,{icon:_.jsx(Ix,{size:18,className:"text-purple-500"}),label:"Weersvoorspelling",description:"Tijdslider met 72 uur forecast",checked:S,onChange:b}),_.jsx(Oo,{icon:_.jsx(Cx,{size:18,className:"text-cyan-500"}),label:"Waterdata (RWS)",description:"Temperatuur, golven, stroming",checked:N,onChange:M})]})]}),_.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function Oo({icon:n,label:e,description:t,checked:i,onChange:r}){return _.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),_.jsx("p",{className:"text-xs text-gray-400",children:t})]}),_.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function UX({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=OD(),[l,u]=H.useState(""),[h,f]=H.useState(!1),[m,y]=H.useState(!1),[x,T]=H.useState(null);if(H.useEffect(()=>{o()},[o]),s)return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:_.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return _.jsx(_.Fragment,{children:n});const I=b=>{b.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},S=async()=>{try{T(null),await i()}catch{T("Google login mislukt"),setTimeout(()=>T(null),3e3)}};return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:_.jsxs(Me.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[_.jsxs("div",{className:"flex flex-col items-center mb-6",children:[_.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:_.jsx(Zs,{size:40,className:"text-white"})}),_.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),_.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),_.jsxs(Me.button,{onClick:S,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&_.jsx(Me.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),_.jsxs("div",{className:"flex items-center gap-3 my-4",children:[_.jsx("div",{className:"flex-1 h-px bg-gray-200"}),_.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),_.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),_.jsxs("form",{onSubmit:I,className:"space-y-4",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:_.jsx(GK,{size:20})}),_.jsx("input",{type:m?"text":"password",value:l,onChange:b=>u(b.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),_.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?_.jsx(RK,{size:20}):_.jsx(bK,{size:20})})]}),h&&_.jsx(Me.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),_.jsx(Me.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),_.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function BX(){const n=si(i=>i.spotFormOpen),e=si(i=>i.spotFormLocation),t=si(i=>i.closeSpotForm);return _.jsx(UX,{children:_.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[_.jsx(J$,{}),_.jsx(qH,{}),_.jsx(LX,{}),_.jsx(OX,{}),_.jsx($H,{}),_.jsx(mX,{}),_.jsx(SX,{}),_.jsx(YH,{}),_.jsx(QH,{}),_.jsx(cX,{}),_.jsx(sX,{}),_.jsx(jX,{}),_.jsx(MX,{}),_.jsx(HH,{}),_.jsx(JH,{}),_.jsx(zX,{}),_.jsx(Gn,{children:n&&_.jsx(FX,{onClose:t,initialLocation:e||void 0})})]})})}const WX="1.2.10";console.log(`%c VisApp v${WX}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");cL.createRoot(document.getElementById("root")).render(_.jsx(BX,{}));export{nq as $,qb as A,bt as B,Dl as C,it as D,We as E,Ir as F,Yj as G,Lp as H,ij as I,gl as J,Kb as K,Xb as L,YX as M,zm as N,i4 as O,QX as P,Yb as Q,qc as R,Qi as S,e9 as T,pl as U,N1 as V,Rb as W,HX as X,XX as Y,ZX as Z,iq as _,U1 as a,UI as a0,H4 as a1,X4 as a2,tq as a3,eq as a4,Nd as a5,JX as a6,qX as a7,gr as a8,cu as a9,nt as aa,hm as ab,jm as ac,dP as ad,Lv as ae,lu as af,Zj as ag,Du as b,Bn as c,sq as d,Ji as e,ci as f,ft as g,IC as h,d1 as i,D6 as j,M0 as k,w1 as l,al as m,h1 as n,Cb as o,$b as p,Hb as q,KX as r,t4 as s,Bp as t,WI as u,Hc as v,BI as w,n4 as x,S1 as y,T1 as z};
//# sourceMappingURL=index-C0mppojt.js.map
